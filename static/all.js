var Ext=Ext||{};Ext._startTime=(new Date).getTime(),function(){var a=this,b=Object.prototype,c=b.toString,d=!0,e={toString:1},f=function(){},g=function(){var a=g.caller.caller;return a.$owner.prototype[a.$name].apply(this,arguments)},h;Ext.global=a;for(h in e)d=null;d&&(d=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"]),Ext.enumerables=d,Ext.apply=function(a,b,c){c&&Ext.apply(a,c);if(a&&b&&typeof b=="object"){var e,f,g;for(e in b)a[e]=b[e];if(d)for(f=d.length;f--;)g=d[f],b.hasOwnProperty(g)&&(a[g]=b[g])}return a},Ext.buildSettings=Ext.apply({baseCSSPrefix:"x-",scopeResetCSS:!1},Ext.buildSettings||{}),Ext.apply(Ext,{name:Ext.sandboxName||"Ext",emptyFn:f,emptyString:new String,baseCSSPrefix:Ext.buildSettings.baseCSSPrefix,applyIf:function(a,b){var c;if(a)for(c in b)a[c]===undefined&&(a[c]=b[c]);return a},iterate:function(a,b,c){if(Ext.isEmpty(a))return;c===undefined&&(c=a),Ext.isIterable(a)?Ext.Array.each.call(Ext.Array,a,b,c):Ext.Object.each.call(Ext.Object,a,b,c)}}),Ext.apply(Ext,{extend:function(){var a=b.constructor,c=function(a){for(var b in a){if(!a.hasOwnProperty(b))continue;this[b]=a[b]}};return function(b,d,e){Ext.isObject(d)&&(e=d,d=b,b=e.constructor!==a?e.constructor:function(){d.apply(this,arguments)});var f=function(){},g,h=d.prototype;return f.prototype=h,g=b.prototype=new f,g.constructor=b,b.superclass=h,h.constructor===a&&(h.constructor=d),b.override=function(a){Ext.override(b,a)},g.override=c,g.proto=g,b.override(e),b.extend=function(a){return Ext.extend(b,a)},b}}(),override:function(a,b){if(a.$isClass)a.override(b);else if(typeof a=="function")Ext.apply(a.prototype,b);else{var c=a.self,d,e;if(c&&c.$isClass)for(d in b)b.hasOwnProperty(d)&&(e=b[d],typeof e=="function"&&(e.$name=d,e.$owner=c,e.$previous=a.hasOwnProperty(d)?a[d]:g),a[d]=e);else Ext.apply(a,b)}return a}}),Ext.apply(Ext,{valueFrom:function(a,b,c){return Ext.isEmpty(a,c)?b:a},typeOf:function(a){var b,d;if(a===null)return"null";b=typeof a;if(b==="undefined"||b==="string"||b==="number"||b==="boolean")return b;d=c.call(a);switch(d){case"[object Array]":return"array";case"[object Date]":return"date";case"[object Boolean]":return"boolean";case"[object Number]":return"number";case"[object RegExp]":return"regexp"}if(b==="function")return"function";if(b==="object")return a.nodeType!==undefined?a.nodeType===3?/\S/.test(a.nodeValue)?"textnode":"whitespace":"element":"object"},isEmpty:function(a,b){return a===null||a===undefined||(b?!1:a==="")||Ext.isArray(a)&&a.length===0},isArray:"isArray"in Array?Array.isArray:function(a){return c.call(a)==="[object Array]"},isDate:function(a){return c.call(a)==="[object Date]"},isObject:c.call(null)==="[object Object]"?function(a){return a!==null&&a!==undefined&&c.call(a)==="[object Object]"&&a.ownerDocument===undefined}:function(a){return c.call(a)==="[object Object]"},isSimpleObject:function(a){return a instanceof Object&&a.constructor===Object},isPrimitive:function(a){var b=typeof a;return b==="string"||b==="number"||b==="boolean"},isFunction:typeof document!="undefined"&&typeof document.getElementsByTagName("body")=="function"?function(a){return c.call(a)==="[object Function]"}:function(a){return typeof a=="function"},isNumber:function(a){return typeof a=="number"&&isFinite(a)},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isString:function(a){return typeof a=="string"},isBoolean:function(a){return typeof a=="boolean"},isElement:function(a){return a?a.nodeType===1:!1},isTextNode:function(a){return a?a.nodeName==="#text":!1},isDefined:function(a){return typeof a!="undefined"},isIterable:function(a){var b=typeof a,c=!1;return a&&b!="string"&&(b=="function"?Ext.isSafari&&(c=a instanceof NodeList||a instanceof HTMLCollection):c=!0),c?a.length!==undefined:!1}}),Ext.apply(Ext,{clone:function(a){var b,e,f,g,h,i;if(a===null||a===undefined)return a;if(a.nodeType&&a.cloneNode)return a.cloneNode(!0);b=c.call(a);if(b==="[object Date]")return new Date(a.getTime());if(b==="[object Array]"){e=a.length,h=[];while(e--)h[e]=Ext.clone(a[e])}else if(b==="[object Object]"&&a.constructor===Object){h={};for(i in a)h[i]=Ext.clone(a[i]);if(d)for(f=d.length;f--;)g=d[f],h[g]=a[g]}return h||a},getUniqueGlobalNamespace:function(){var a=this.uniqueGlobalNamespace,b;if(a===undefined){b=0;do a="ExtBox"+ ++b;while(Ext.global[a]!==undefined);Ext.global[a]=Ext,this.uniqueGlobalNamespace=a}return a},functionFactoryCache:{},cacheableFunctionFactory:function(){var a=this,b=Array.prototype.slice.call(arguments),c=a.functionFactoryCache,d,e,f;return Ext.isSandboxed&&(f=b.length,f>0&&(f--,b[f]="var Ext=window."+Ext.name+";"+b[f])),d=b.join(""),e=c[d],e||(e=Function.prototype.constructor.apply(Function.prototype,b),c[d]=e),e},functionFactory:function(){var a=this,b=Array.prototype.slice.call(arguments),c;return Ext.isSandboxed&&(c=b.length,c>0&&(c--,b[c]="var Ext=window."+Ext.name+";"+b[c])),Function.prototype.constructor.apply(Function.prototype,b)},Logger:{verbose:f,log:f,info:f,warn:f,error:function(a){throw new Error(a)},deprecate:f}}),Ext.type=Ext.typeOf}(),Ext.globalEval=Ext.global.execScript?function(a){execScript(a)}:function($$code){(function(){eval($$code)})()},function(){var a="4.1.0",b;Ext.Version=b=Ext.extend(Object,{constructor:function(a){var c,d;return a instanceof b?a:(this.version=this.shortVersion=String(a).toLowerCase().replace(/_/g,".").replace(/[\-+]/g,""),d=this.version.search(/([^\d\.])/),d!==-1&&(this.release=this.version.substr(d,a.length),this.shortVersion=this.version.substr(0,d)),this.shortVersion=this.shortVersion.replace(/[^\d]/g,""),c=this.version.split("."),this.major=parseInt(c.shift()||0,10),this.minor=parseInt(c.shift()||0,10),this.patch=parseInt(c.shift()||0,10),this.build=parseInt(c.shift()||0,10),this)},toString:function(){return this.version},valueOf:function(){return this.version},getMajor:function(){return this.major||0},getMinor:function(){return this.minor||0},getPatch:function(){return this.patch||0},getBuild:function(){return this.build||0},getRelease:function(){return this.release||""},isGreaterThan:function(a){return b.compare(this.version,a)===1},isGreaterThanOrEqual:function(a){return b.compare(this.version,a)>=0},isLessThan:function(a){return b.compare(this.version,a)===-1},isLessThanOrEqual:function(a){return b.compare(this.version,a)<=0},equals:function(a){return b.compare(this.version,a)===0},match:function(a){return a=String(a),this.version.substr(0,a.length)===a},toArray:function(){return[this.getMajor(),this.getMinor(),this.getPatch(),this.getBuild(),this.getRelease()]},getShortVersion:function(){return this.shortVersion},gt:function(){return this.isGreaterThan.apply(this,arguments)},lt:function(){return this.isLessThan.apply(this,arguments)},gtEq:function(){return this.isGreaterThanOrEqual.apply(this,arguments)},ltEq:function(){return this.isLessThanOrEqual.apply(this,arguments)}}),Ext.apply(b,{releaseValueMap:{dev:-6,alpha:-5,a:-5,beta:-4,b:-4,rc:-3,"#":-2,p:-1,pl:-1},getComponentValue:function(a){return a?isNaN(a)?this.releaseValueMap[a]||a:parseInt(a,10):0},compare:function(a,c){var d,e,f;a=(new b(a)).toArray(),c=(new b(c)).toArray();for(f=0;f<Math.max(a.length,c.length);f++){d=this.getComponentValue(a[f]),e=this.getComponentValue(c[f]);if(d<e)return-1;if(d>e)return 1}return 0}}),Ext.apply(Ext,{versions:{},lastRegisteredVersion:null,setVersion:function(a,c){return Ext.versions[a]=new b(c),Ext.lastRegisteredVersion=Ext.versions[a],this},getVersion:function(a){return a===undefined?Ext.lastRegisteredVersion:Ext.versions[a]},deprecate:function(a,c,d,e){b.compare(Ext.getVersion(a),c)<1&&d.call(e)}}),Ext.setVersion("core",a)}(),Ext.String=function(){var a=/^[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+|[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u2028\u2029\u202f\u205f\u3000]+$/g,b=/('|\\)/g,c=/\{(\d+)\}/g,d=/([-.*+?\^${}()|\[\]\/\\])/g,e=/^\s+|\s+$/g,f=/\s+/,g=/(^[^a-z]*|[^\w])/gi,h,i,j,k,l=function(a,b){return h[b]},m=function(a,b){return b in i?i[b]:String.fromCharCode(parseInt(b.substr(2),10))};return{createVarName:function(a){return a.replace(g,"")},htmlEncode:function(a){return a?String(a).replace(j,l):a},htmlDecode:function(a){return a?String(a).replace(k,m):a},addCharacterEntities:function(a){var b=[],c=[],d,e;for(d in a)e=a[d],i[d]=e,h[e]=d,b.push(e),c.push(d);j=new RegExp("("+b.join("|")+")","g"),k=new RegExp("("+c.join("|")+"|&#[0-9]{1,5};)","g")},resetCharacterEntities:function(){h={},i={},this.addCharacterEntities({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'"})},urlAppend:function(a,b){return Ext.isEmpty(b)?a:a+(a.indexOf("?")===-1?"?":"&")+b},trim:function(b){return b.replace(a,"")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},uncapitalize:function(a){return a.charAt(0).toLowerCase()+a.substr(1)},ellipsis:function(a,b,c){if(a&&a.length>b){if(c){var d=a.substr(0,b-2),e=Math.max(d.lastIndexOf(" "),d.lastIndexOf("."),d.lastIndexOf("!"),d.lastIndexOf("?"));if(e!==-1&&e>=b-15)return d.substr(0,e)+"..."}return a.substr(0,b-3)+"..."}return a},escapeRegex:function(a){return a.replace(d,"\\$1")},escape:function(a){return a.replace(b,"\\$1")},toggle:function(a,b,c){return a===b?c:b},leftPad:function(a,b,c){var d=String(a);c=c||" ";while(d.length<b)d=c+d;return d},format:function(a){var b=Ext.Array.toArray(arguments,1);return a.replace(c,function(a,c){return b[c]})},repeat:function(a,b,c){for(var d=[],e=b;e--;)d.push(a);return d.join(c||"")},splitWords:function(a){return a&&typeof a=="string"?a.replace(e,"").split(f):a||[]}}}(),Ext.String.resetCharacterEntities(),Ext.htmlEncode=Ext.String.htmlEncode,Ext.htmlDecode=Ext.String.htmlDecode,Ext.urlAppend=Ext.String.urlAppend,Ext.Number=new function(){var a=this,b=.9.toFixed()!=="1",c=Math;Ext.apply(this,{constrain:function(a,b,c){var d=parseFloat(a);return d<b?b:d>c?c:d},snap:function(b,c,d,e){var f;return b===undefined||b<d?d||0:(c&&(f=b%c,f!==0&&(b-=f,f*2>=c?b+=c:f*2<-c&&(b-=c))),a.constrain(b,d,e))},snapInRange:function(b,c,d,e){var f;return d=d||0,b===undefined||b<d?d:(c&&(f=(b-d)%c)&&(b-=f,f*=2,f>=c&&(b+=c)),e!==undefined&&b>(e=a.snapInRange(e,c,d))&&(b=e),b)},toFixed:b?function(a,b){b=b||0;var d=c.pow(10,b);return(c.round(a*d)/d).toFixed(b)}:function(a,b){return a.toFixed(b)},from:function(a,b){return isFinite(a)&&(a=parseFloat(a)),isNaN(a)?b:a},randomInt:function(a,b){return c.floor(c.random()*(b-a+1)+a)}}),Ext.num=function(){return a.from.apply(this,arguments)}},function(){function q(a,b){return b<0?Math.max(0,a.length+b):Math.min(a.length,b)}function r(a,b,c,d){var e=d?d.length:0,f=a.length,g=q(a,b),h,i,j,k,l,m;if(g===f)e&&a.push.apply(a,d);else{h=Math.min(c,f-g),i=g+h,j=i+e-h,k=f-i,l=f-h;if(j<i)for(m=0;m<k;++m)a[j+m]=a[i+m];else if(j>i)for(m=k;m--;)a[j+m]=a[i+m];if(e&&g===l)a.length=l,a.push.apply(a,d);else{a.length=l+e;for(m=0;m<e;++m)a[g+m]=d[m]}}return a}function s(a,b,c,d){return d&&d.length?b<a.length?a.splice.apply(a,[b,c].concat(d)):a.push.apply(a,d):a.splice(b,c),a}function t(a,b,c){return r(a,b,c)}function u(a,b,c){return a.splice(b,c),a}function v(a,c,d){var e=q(a,c),f=a.slice(c,q(a,e+d));return arguments.length<4?r(a,e,d):r(a,e,d,b.call(arguments,3)),f}function w(a){return a.splice.apply(a,b.call(arguments,1))}var a=Array.prototype,b=a.slice,c=function(){var a=[],b,c=20;if(!a.splice)return!1;while(c--)a.push("A");return a.splice(15,0,"F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","F"),b=a.length,a.splice(13,0,"XXX"),b+1!=a.length?!1:!0}(),d="forEach"in a,e="map"in a,f="indexOf"in a,g="every"in a,h="some"in a,i="filter"in a,j=function(){var a=[1,2,3,4,5].sort(function(){return 0});return a[0]===1&&a[1]===2&&a[2]===3&&a[3]===4&&a[4]===5}(),k=!0,l,m,n,o;try{typeof document!="undefined"&&b.call(document.getElementsByTagName("body"))}catch(p){k=!1}m=c?u:t,n=c?s:r,o=c?w:v,l=Ext.Array={each:function(a,b,c,d){a=l.from(a);var e,f=a.length;if(d!==!0){for(e=0;e<f;e++)if(b.call(c||a[e],a[e],e,a)===!1)return e}else for(e=f-1;e>-1;e--)if(b.call(c||a[e],a[e],e,a)===!1)return e;return!0},forEach:d?function(a,b,c){return a.forEach(b,c)}:function(a,b,c){var d=0,e=a.length;for(;d<e;d++)b.call(c,a[d],d,a)},indexOf:f?function(a,b,c){return a.indexOf(b,c)}:function(a,b,c){var d,e=a.length;for(d=c<0?Math.max(0,e+c):c||0;d<e;d++)if(a[d]===b)return d;return-1},contains:f?function(a,b){return a.indexOf(b)!==-1}:function(a,b){var c,d;for(c=0,d=a.length;c<d;c++)if(a[c]===b)return!0;return!1},toArray:function(a,c,d){if(!a||!a.length)return[];typeof a=="string"&&(a=a.split(""));if(k)return b.call(a,c||0,d||a.length);var e=[],f;c=c||0,d=d?d<0?a.length+d:d:a.length;for(f=c;f<d;f++)e.push(a[f]);return e},pluck:function(a,b){var c=[],d,e,f;for(d=0,e=a.length;d<e;d++)f=a[d],c.push(f[b]);return c},map:e?function(a,b,c){return a.map(b,c)}:function(a,b,c){var d=[],e=0,f=a.length;for(;e<f;e++)d[e]=b.call(c,a[e],e,a);return d},every:g?function(a,b,c){return a.every(b,c)}:function(a,b,c){var d=0,e=a.length;for(;d<e;++d)if(!b.call(c,a[d],d,a))return!1;return!0},some:h?function(a,b,c){return a.some(b,c)}:function(a,b,c){var d=0,e=a.length;for(;d<e;++d)if(b.call(c,a[d],d,a))return!0;return!1},clean:function(a){var b=[],c=0,d=a.length,e;for(;c<d;c++)e=a[c],Ext.isEmpty(e)||b.push(e);return b},unique:function(a){var b=[],c=0,d=a.length,e;for(;c<d;c++)e=a[c],l.indexOf(b,e)===-1&&b.push(e);return b},filter:i?function(a,b,c){return a.filter(b,c)}:function(a,b,c){var d=[],e=0,f=a.length;for(;e<f;e++)b.call(c,a[e],e,a)&&d.push(a[e]);return d},from:function(a,c){if(a===undefined||a===null)return[];if(Ext.isArray(a))return c?b.call(a):a;var d=typeof a;return a&&a.length!==undefined&&d!=="string"&&(d!=="function"||!a.apply)?l.toArray(a):[a]},remove:function(a,b){var c=l.indexOf(a,b);return c!==-1&&m(a,c,1),a},include:function(a,b){l.contains(a,b)||a.push(b)},clone:function(a){return b.call(a)},merge:function(){var a=b.call(arguments),c=[],d,e;for(d=0,e=a.length;d<e;d++)c=c.concat(a[d]);return l.unique(c)},intersect:function(){var a=[],c=b.call(arguments),d,e,f,g,h,i,j,k,n,o,p,q,r;if(!c.length)return a;d=c.length;for(p=h=0;p<d;p++){i=c[p];if(!g||i.length<g.length)g=i,h=p}g=l.unique(g),m(c,h,1),j=g.length,d=c.length;for(p=0;p<j;p++){k=g[p],o=0;for(q=0;q<d;q++){e=c[q],f=e.length;for(r=0;r<f;r++){n=e[r];if(k===n){o++;break}}}o===d&&a.push(k)}return a},difference:function(a,c){var d=b.call(a),e=d.length,f,g,h;for(f=0,h=c.length;f<h;f++)for(g=0;g<e;g++)d[g]===c[f]&&(m(d,g,1),g--,e--);return d},slice:[1,2].slice(1,undefined).length?function(a,c,d){return b.call(a,c,d)}:function(a,c,d){return typeof c=="undefined"?b.call(a):typeof d=="undefined"?b.call(a,c):b.call(a,c,d)},sort:j?function(a,b){return b?a.sort(b):a.sort()}:function(a,b){var c=a.length,d=0,e,f,g,h;for(;d<c;d++){g=d;for(f=d+1;f<c;f++)b?(e=b(a[f],a[g]),e<0&&(g=f)):a[f]<a[g]&&(g=f);g!==d&&(h=a[d],a[d]=a[g],a[g]=h)}return a},flatten:function(a){function c(a){var d,e,f;for(d=0,e=a.length;d<e;d++)f=a[d],Ext.isArray(f)?c(f):b.push(f);return b}var b=[];return c(a)},min:function(a,b){var c=a[0],d,e,f;for(d=0,e=a.length;d<e;d++)f=a[d],b?b(c,f)===1&&(c=f):f<c&&(c=f);return c},max:function(a,b){var c=a[0],d,e,f;for(d=0,e=a.length;d<e;d++)f=a[d],b?b(c,f)===-1&&(c=f):f>c&&(c=f);return c},mean:function(a){return a.length>0?l.sum(a)/a.length:undefined},sum:function(a){var b=0,c,d,e;for(c=0,d=a.length;c<d;c++)e=a[c],b+=e;return b},toMap:function(a,b,c){var d={},e=a.length;if(!b)while(e--)d[a[e]]=e+1;else if(typeof b=="string")while(e--)d[a[e][b]]=e+1;else while(e--)d[b.call(c,a[e])]=e+1;return d},erase:m,insert:function(a,b,c){return n(a,b,0,c)},replace:n,splice:o,push:function(a){var b=arguments.length,c=1,d;a===undefined?a=[]:Ext.isArray(a)||(a=[a]);for(;c<b;c++)d=arguments[c],Array.prototype.push[Ext.isArray(d)?"apply":"call"](a,d);return a}},Ext.each=l.each,l.union=l.merge,Ext.min=l.min,Ext.max=l.max,Ext.sum=l.sum,Ext.mean=l.mean,Ext.flatten=l.flatten,Ext.clean=l.clean,Ext.unique=l.unique,Ext.pluck=l.pluck,Ext.toArray=function(){return l.toArray.apply(l,arguments)}}(),Ext.Function={flexSetter:function(a){return function(b,c){var d,e;if(b===null)return this;if(typeof b!="string"){for(d in b)b.hasOwnProperty(d)&&a.call(this,d,b[d]);if(Ext.enumerables)for(e=Ext.enumerables.length;e--;)d=Ext.enumerables[e],b.hasOwnProperty(d)&&a.call(this,d,b[d])}else a.call(this,b,c);return this}},bind:function(a,b,c,d){if(arguments.length===2)return function(){return a.apply(b,arguments)};var e=a,f=Array.prototype.slice;return function(){var a=c||arguments;return d===!0?(a=f.call(arguments,0),a=a.concat(c)):typeof d=="number"&&(a=f.call(arguments,0),Ext.Array.insert(a,d,c)),e.apply(b||Ext.global,a)}},pass:function(a,b,c){return Ext.isArray(b)||(Ext.isIterable(b)?b=Ext.Array.clone(b):b=b!==undefined?[b]:[]),function(){var d=[].concat(b);return d.push.apply(d,arguments),a.apply(c||this,d)}},alias:function(a,b){return function(){return a[b].apply(a,arguments)}},clone:function(a){return function(){return a.apply(this,arguments)}},createInterceptor:function(a,b,c,d){var e=a;return Ext.isFunction(b)?function(){var e=this,f=arguments;return b.target=e,b.method=a,b.apply(c||e||Ext.global,f)!==!1?a.apply(e||Ext.global,f):d||null}:a},createDelayed:function(a,b,c,d,e){if(c||d)a=Ext.Function.bind(a,c,d,e);return function(){var c=this,d=Array.prototype.slice.call(arguments);setTimeout(function(){a.apply(c,d)},b)}},defer:function(a,b,c,d,e){return a=Ext.Function.bind(a,c,d,e),b>0?setTimeout(Ext.supports.TimeoutActualLateness?function(){a()}:a,b):(a(),0)},createSequence:function(a,b,c){return b?function(){var d=a.apply(this,arguments);return b.apply(c||this,arguments),d}:a},createBuffered:function(a,b,c,d){var e;return function(){var f=d||Array.prototype.slice.call(arguments,0),g=c||this;e&&clearTimeout(e),e=setTimeout(function(){a.apply(g,f)},b)}},createThrottled:function(a,b,c){var d,e,f,g,h=function(){a.apply(c||this,f),d=(new Date).getTime()};return function(){e=(new Date).getTime()-d,f=arguments,clearTimeout(g),!d||e>=b?h():g=setTimeout(h,b-e)}},interceptBefore:function(a,b,c,d){var e=a[b]||Ext.emptyFn;return a[b]=function(){var a=c.apply(d||this,arguments);return e.apply(this,arguments),a}},interceptAfter:function(a,b,c,d){var e=a[b]||Ext.emptyFn;return a[b]=function(){return e.apply(this,arguments),c.apply(d||this,arguments)}}},Ext.defer=Ext.Function.alias(Ext.Function,"defer"),Ext.pass=Ext.Function.alias(Ext.Function,"pass"),Ext.bind=Ext.Function.alias(Ext.Function,"bind"),function(){var a=function(){},b=Ext.Object={chain:function(b){a.prototype=b;var c=new a;return a.prototype=null,c},toQueryObjects:function(a,c,d){var e=b.toQueryObjects,f=[],g,h;if(Ext.isArray(c))for(g=0,h=c.length;g<h;g++)d?f=f.concat(e(a+"["+g+"]",c[g],!0)):f.push({name:a,value:c[g]});else if(Ext.isObject(c))for(g in c)c.hasOwnProperty(g)&&(d?f=f.concat(e(a+"["+g+"]",c[g],!0)):f.push({name:a,value:c[g]}));else f.push({name:a,value:c});return f},toQueryString:function(a,c){var d=[],e=[],f,g,h,i,j;for(f in a)a.hasOwnProperty(f)&&(d=d.concat(b.toQueryObjects(f,a[f],c)));for(g=0,h=d.length;g<h;g++)i=d[g],j=i.value,Ext.isEmpty(j)?j="":Ext.isDate(j)&&(j=Ext.Date.toString(j)),e.push(encodeURIComponent(i.name)+"="+encodeURIComponent(String(j)));return e.join("&")},fromQueryString:function(a,b){var c=a.replace(/^\?/,"").split("&"),d={},e,f,g,h,i,j,k,l,m,n,o,p,q,r;for(i=0,j=c.length;i<j;i++){k=c[i];if(k.length>0){f=k.split("="),g=decodeURIComponent(f[0]),h=f[1]!==undefined?decodeURIComponent(f[1]):"";if(!b)d.hasOwnProperty(g)?(Ext.isArray(d[g])||(d[g]=[d[g]]),d[g].push(h)):d[g]=h;else{n=g.match(/(\[):?([^\]]*)\]/g),o=g.match(/^([^\[]+)/),g=o[0],p=[];if(n===null){d[g]=h;continue}for(l=0,m=n.length;l<m;l++)q=n[l],q=q.length===2?"":q.substring(1,q.length-1),p.push(q);p.unshift(g),e=d;for(l=0,m=p.length;l<m;l++){q=p[l];if(l===m-1)Ext.isArray(e)&&q===""?e.push(h):e[q]=h;else{if(e[q]===undefined||typeof e[q]=="string")r=p[l+1],e[q]=Ext.isNumeric(r)||r===""?[]:{};e=e[q]}}}}}return d},each:function(a,b,c){for(var d in a)if(a.hasOwnProperty(d)&&b.call(c||a,d,a[d],a)===!1)return},merge:function(a){var c=1,d=arguments.length,e=b.merge,f=Ext.clone,g,h,i,j;for(;c<d;c++){g=arguments[c];for(h in g)i=g[h],i&&i.constructor===Object?(j=a[h],j&&j.constructor===Object?e(j,i):a[h]=f(i)):a[h]=i}return a},mergeIf:function(a){var b=1,c=arguments.length,d=Ext.clone,e,f,g;for(;b<c;b++){e=arguments[b];for(f in e)f in a||(g=e[f],g&&g.constructor===Object?a[f]=d(g):a[f]=g)}return a},getKey:function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return c;return null},getValues:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},getKeys:typeof Object.keys=="function"?function(a){return a?Object.keys(a):[]}:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b},getSize:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},classify:function(a){var c=a,d=[],e={},f=function(){var a=0,b=d.length,c;for(;a<b;a++)c=d[a],this[c]=new e[c]},g,h;for(g in a)a.hasOwnProperty(g)&&(h=a[g],h&&h.constructor===Object&&(d.push(g),e[g]=b.classify(h)));return f.prototype=c,f}};Ext.merge=Ext.Object.merge,Ext.mergeIf=Ext.Object.mergeIf,Ext.urlEncode=function(){var a=Ext.Array.from(arguments),c="";return typeof a[1]=="string"&&(c=a[1]+"&",a[1]=!1),c+b.toQueryString.apply(b,a)},Ext.urlDecode=function(){return b.fromQueryString.apply(b,arguments)}}(),function(){function a(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/\{(\d+)\}/g,function(a,d){return b[d]})}Ext.Date={now:Date.now||function(){return+(new Date)},toString:function(a){var b=Ext.String.leftPad;return a.getFullYear()+"-"+b(a.getMonth()+1,2,"0")+"-"+b(a.getDate(),2,"0")+"T"+b(a.getHours(),2,"0")+":"+b(a.getMinutes(),2,"0")+":"+b(a.getSeconds(),2,"0")},getElapsed:function(a,b){return Math.abs(a-(b||new Date))},useStrict:!1,formatCodeToRegex:function(c,d){var e=b.parseCodes[c];return e&&(e=typeof e=="function"?e():e,b.parseCodes[c]=e),e?Ext.applyIf({c:e.c?a(e.c,d||"{0}"):e.c},e):{g:0,c:null,s:Ext.String.escapeRegex(c)}},parseFunctions:{MS:function(a,b){var c=new RegExp("\\/Date\\(([-+])?(\\d+)(?:[+-]\\d{4})?\\)\\/"),d=(a||"").match(c);return d?new Date(((d[1]||"")+d[2])*1):null}},parseRegexes:[],formatFunctions:{MS:function(){return"\\/Date("+this.getTime()+")\\/"}},y2kYear:50,MILLI:"ms",SECOND:"s",MINUTE:"mi",HOUR:"h",DAY:"d",MONTH:"mo",YEAR:"y",defaults:{},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNumbers:{January:0,Jan:0,February:1,Feb:1,March:2,Mar:2,April:3,Apr:3,May:4,June:5,Jun:5,July:6,Jul:6,August:7,Aug:7,September:8,Sep:8,October:9,Oct:9,November:10,Nov:10,December:11,Dec:11},defaultFormat:"m/d/Y",getShortMonthName:function(a){return Ext.Date.monthNames[a].substring(0,3)},getShortDayName:function(a){return Ext.Date.dayNames[a].substring(0,3)},getMonthNumber:function(a){return Ext.Date.monthNumbers[a.substring(0,1).toUpperCase()+a.substring(1,3).toLowerCase()]},formatContainsHourInfo:function(){var a=/(\\.)/g,b=/([gGhHisucUOPZ]|MS)/;return function(e){return b.test(e.replace(a,""))}}(),formatContainsDateInfo:function(){var a=/(\\.)/g,b=/([djzmnYycU]|MS)/;return function(e){return b.test(e.replace(a,""))}}(),unescapeFormat:function(){var a=/\\/gi;return function(b){return b.replace(a,"")}}(),formatCodes:{d:"Ext.String.leftPad(this.getDate(), 2, '0')",D:"Ext.Date.getShortDayName(this.getDay())",j:"this.getDate()",l:"Ext.Date.dayNames[this.getDay()]",N:"(this.getDay() ? this.getDay() : 7)",S:"Ext.Date.getSuffix(this)",w:"this.getDay()",z:"Ext.Date.getDayOfYear(this)",W:"Ext.String.leftPad(Ext.Date.getWeekOfYear(this), 2, '0')",F:"Ext.Date.monthNames[this.getMonth()]",m:"Ext.String.leftPad(this.getMonth() + 1, 2, '0')",M:"Ext.Date.getShortMonthName(this.getMonth())",n:"(this.getMonth() + 1)",t:"Ext.Date.getDaysInMonth(this)",L:"(Ext.Date.isLeapYear(this) ? 1 : 0)",o:"(this.getFullYear() + (Ext.Date.getWeekOfYear(this) == 1 && this.getMonth() > 0 ? +1 : (Ext.Date.getWeekOfYear(this) >= 52 && this.getMonth() < 11 ? -1 : 0)))",Y:"Ext.String.leftPad(this.getFullYear(), 4, '0')",y:"('' + this.getFullYear()).substring(2, 4)",a:"(this.getHours() < 12 ? 'am' : 'pm')",A:"(this.getHours() < 12 ? 'AM' : 'PM')",g:"((this.getHours() % 12) ? this.getHours() % 12 : 12)",G:"this.getHours()",h:"Ext.String.leftPad((this.getHours() % 12) ? this.getHours() % 12 : 12, 2, '0')",H:"Ext.String.leftPad(this.getHours(), 2, '0')",i:"Ext.String.leftPad(this.getMinutes(), 2, '0')",s:"Ext.String.leftPad(this.getSeconds(), 2, '0')",u:"Ext.String.leftPad(this.getMilliseconds(), 3, '0')",O:"Ext.Date.getGMTOffset(this)",P:"Ext.Date.getGMTOffset(this, true)",T:"Ext.Date.getTimezone(this)",Z:"(this.getTimezoneOffset() * -60)",c:function(){var a,c,d,e,f;for(a="Y-m-dTH:i:sP",c=[],d=0,e=a.length;d<e;++d)f=a.charAt(d),c.push(f=="T"?"'T'":b.getFormatCode(f));return c.join(" + ")},U:"Math.round(this.getTime() / 1000)"},isValid:function(a,c,d,e,f,g,h){e=e||0,f=f||0,g=g||0,h=h||0;var i=b.add(new Date(a<100?100:a,c-1,d,e,f,g,h),b.YEAR,a<100?a-100:0);return a==i.getFullYear()&&c==i.getMonth()+1&&d==i.getDate()&&e==i.getHours()&&f==i.getMinutes()&&g==i.getSeconds()&&h==i.getMilliseconds()},parse:function(a,c,d){var e=b.parseFunctions;return e[c]==null&&b.createParser(c),e[c](a,Ext.isDefined(d)?d:b.useStrict)},parseDate:function(a,c,d){return b.parse(a,c,d)},getFormatCode:function(a){var c=b.formatCodes[a];return c&&(c=typeof c=="function"?c():c,b.formatCodes[a]=c),c||"'"+Ext.String.escape(a)+"'"},createFormat:function(a){var c=[],d=!1,e="",f;for(f=0;f<a.length;++f)e=a.charAt(f),!d&&e=="\\"?d=!0:d?(d=!1,c.push("'"+Ext.String.escape(e)+"'")):c.push(b.getFormatCode(e));b.formatFunctions[a]=Ext.functionFactory("return "+c.join("+"))},createParser:function(){var c=["var dt, y, m, d, h, i, s, ms, o, z, zz, u, v,","def = Ext.Date.defaults,","results = String(input).match(Ext.Date.parseRegexes[{0}]);","if(results){","{1}","if(u != null){","v = new Date(u * 1000);","}else{","dt = Ext.Date.clearTime(new Date);","y = Ext.Number.from(y, Ext.Number.from(def.y, dt.getFullYear()));","m = Ext.Number.from(m, Ext.Number.from(def.m - 1, dt.getMonth()));","d = Ext.Number.from(d, Ext.Number.from(def.d, dt.getDate()));","h  = Ext.Number.from(h, Ext.Number.from(def.h, dt.getHours()));","i  = Ext.Number.from(i, Ext.Number.from(def.i, dt.getMinutes()));","s  = Ext.Number.from(s, Ext.Number.from(def.s, dt.getSeconds()));","ms = Ext.Number.from(ms, Ext.Number.from(def.ms, dt.getMilliseconds()));","if(z >= 0 && y >= 0){","v = Ext.Date.add(new Date(y < 100 ? 100 : y, 0, 1, h, i, s, ms), Ext.Date.YEAR, y < 100 ? y - 100 : 0);","v = !strict? v : (strict === true && (z <= 364 || (Ext.Date.isLeapYear(v) && z <= 365))? Ext.Date.add(v, Ext.Date.DAY, z) : null);","}else if(strict === true && !Ext.Date.isValid(y, m + 1, d, h, i, s, ms)){","v = null;","}else{","v = Ext.Date.add(new Date(y < 100 ? 100 : y, m, d, h, i, s, ms), Ext.Date.YEAR, y < 100 ? y - 100 : 0);","}","}","}","if(v){","if(zz != null){","v = Ext.Date.add(v, Ext.Date.SECOND, -v.getTimezoneOffset() * 60 - zz);","}else if(o){","v = Ext.Date.add(v, Ext.Date.MINUTE, -v.getTimezoneOffset() + (sn == '+'? -1 : 1) * (hr * 60 + mn));","}","}","return v;"].join("\n");return function(d){var e=b.parseRegexes.length,f=1,g=[],h=[],i=!1,j="",k=0,l=d.length,m=[],n;for(;k<l;++k)j=d.charAt(k),!i&&j=="\\"?i=!0:i?(i=!1,h.push(Ext.String.escape(j))):(n=b.formatCodeToRegex(j,f),f+=n.g,h.push(n.s),n.g&&n.c&&(n.calcAtEnd?m.push(n.c):g.push(n.c)));g=g.concat(m),b.parseRegexes[e]=new RegExp("^"+h.join("")+"$","i"),b.parseFunctions[d]=Ext.functionFactory("input","strict",a(c,e,g.join("")))}}(),parseCodes:{d:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|0[1-9])"},j:{g:1,c:"d = parseInt(results[{0}], 10);\n",s:"(3[0-1]|[1-2][0-9]|[1-9])"},D:function(){for(var a=[],c=0;c<7;a.push(b.getShortDayName(c)),++c);return{g:0,c:null,s:"(?:"+a.join("|")+")"}},l:function(){return{g:0,c:null,s:"(?:"+b.dayNames.join("|")+")"}},N:{g:0,c:null,s:"[1-7]"},S:{g:0,c:null,s:"(?:st|nd|rd|th)"},w:{g:0,c:null,s:"[0-6]"},z:{g:1,c:"z = parseInt(results[{0}], 10);\n",s:"(\\d{1,3})"},W:{g:0,c:null,s:"(?:\\d{2})"},F:function(){return{g:1,c:"m = parseInt(Ext.Date.getMonthNumber(results[{0}]), 10);\n",s:"("+b.monthNames.join("|")+")"}},M:function(){for(var a=[],c=0;c<12;a.push(b.getShortMonthName(c)),++c);return Ext.applyIf({s:"("+a.join("|")+")"},b.formatCodeToRegex("F"))},m:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|0[1-9])"},n:{g:1,c:"m = parseInt(results[{0}], 10) - 1;\n",s:"(1[0-2]|[1-9])"},t:{g:0,c:null,s:"(?:\\d{2})"},L:{g:0,c:null,s:"(?:1|0)"},o:function(){return b.formatCodeToRegex("Y")},Y:{g:1,c:"y = parseInt(results[{0}], 10);\n",s:"(\\d{4})"},y:{g:1,c:"var ty = parseInt(results[{0}], 10);\ny = ty > Ext.Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"},a:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(am|pm|AM|PM)",calcAtEnd:!0},A:{g:1,c:"if (/(am)/i.test(results[{0}])) {\nif (!h || h == 12) { h = 0; }\n} else { if (!h || h < 12) { h = (h || 0) + 12; }}",s:"(AM|PM|am|pm)",calcAtEnd:!0},g:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|[0-9])"},G:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|1[0-9]|[0-9])"},h:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(1[0-2]|0[1-9])"},H:{g:1,c:"h = parseInt(results[{0}], 10);\n",s:"(2[0-3]|[0-1][0-9])"},i:{g:1,c:"i = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},s:{g:1,c:"s = parseInt(results[{0}], 10);\n",s:"([0-5][0-9])"},u:{g:1,c:"ms = results[{0}]; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n",s:"(\\d+)"},O:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(3,5) / 60),","mn = o.substring(3,5) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{4})"},P:{g:1,c:["o = results[{0}];","var sn = o.substring(0,1),","hr = o.substring(1,3)*1 + Math.floor(o.substring(4,6) / 60),","mn = o.substring(4,6) % 60;","o = ((-12 <= (hr*60 + mn)/60) && ((hr*60 + mn)/60 <= 14))? (sn + Ext.String.leftPad(hr, 2, '0') + Ext.String.leftPad(mn, 2, '0')) : null;\n"].join("\n"),s:"([+-]\\d{2}:\\d{2})"},T:{g:0,c:null,s:"[A-Z]{1,4}"},Z:{g:1,c:"zz = results[{0}] * 1;\nzz = (-43200 <= zz && zz <= 50400)? zz : null;\n",s:"([+-]?\\d{1,5})"},c:function(){var a=[],c=[b.formatCodeToRegex("Y",1),b.formatCodeToRegex("m",2),b.formatCodeToRegex("d",3),b.formatCodeToRegex("H",4),b.formatCodeToRegex("i",5),b.formatCodeToRegex("s",6),{c:"ms = results[7] || '0'; ms = parseInt(ms, 10)/Math.pow(10, ms.length - 3);\n"},{c:["if(results[8]) {","if(results[8] == 'Z'){","zz = 0;","}else if (results[8].indexOf(':') > -1){",b.formatCodeToRegex("P",8).c,"}else{",b.formatCodeToRegex("O",8).c,"}","}"].join("\n")}],d,e;for(d=0,e=c.length;d<e;++d)a.push(c[d].c);return{g:1,c:a.join(""),s:[c[0].s,"(?:","-",c[1].s,"(?:","-",c[2].s,"(?:","(?:T| )?",c[3].s,":",c[4].s,"(?::",c[5].s,")?","(?:(?:\\.|,)(\\d+))?","(Z|(?:[-+]\\d{2}(?::)?\\d{2}))?",")?",")?",")?"].join("")}},U:{g:1,c:"u = parseInt(results[{0}], 10);\n",s:"(-?\\d+)"}},dateFormat:function(a,c){return b.format(a,c)},isEqual:function(a,b){return a&&b?a.getTime()===b.getTime():!a&&!b},format:function(a,c){var d=b.formatFunctions;return Ext.isDate(a)?(d[c]==null&&b.createFormat(c),d[c].call(a)+""):""},getTimezone:function(a){return a.toString().replace(/^.* (?:\((.*)\)|([A-Z]{1,4})(?:[\-+][0-9]{4})?(?: -?\d+)?)$/,"$1$2").replace(/[^A-Z]/g,"")},getGMTOffset:function(a,b){var c=a.getTimezoneOffset();return(c>0?"-":"+")+Ext.String.leftPad(Math.floor(Math.abs(c)/60),2,"0")+(b?":":"")+Ext.String.leftPad(Math.abs(c%60),2,"0")},getDayOfYear:function(a){var c=0,d=Ext.Date.clone(a),e=a.getMonth(),f;for(f=0,d.setDate(1),d.setMonth(0);f<e;d.setMonth(++f))c+=b.getDaysInMonth(d);return c+a.getDate()-1},getWeekOfYear:function(){var a=864e5,b=7*a;return function(e){var f=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()+3)/a,g=Math.floor(f/7),h=(new Date(g*b)).getUTCFullYear();return g-Math.floor(Date.UTC(h,0,7)/b)+1}}(),isLeapYear:function(a){var b=a.getFullYear();return(b&3)==0&&!!(b%100||b%400==0&&b)},getFirstDayOfMonth:function(a){var b=(a.getDay()-(a.getDate()-1))%7;return b<0?b+7:b},getLastDayOfMonth:function(a){return b.getLastDateOfMonth(a).getDay()},getFirstDateOfMonth:function(a){return new Date(a.getFullYear(),a.getMonth(),1)},getLastDateOfMonth:function(a){return new Date(a.getFullYear(),a.getMonth(),b.getDaysInMonth(a))},getDaysInMonth:function(){var a=[31,28,31,30,31,30,31,31,30,31,30,31];return function(d){var e=d.getMonth();return e==1&&b.isLeapYear(d)?29:a[e]}}(),getSuffix:function(a){switch(a.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},clone:function(a){return new Date(a.getTime())},isDST:function(a){return(new Date(a.getFullYear(),0,1)).getTimezoneOffset()!=a.getTimezoneOffset()},clearTime:function(a,c){if(c)return Ext.Date.clearTime(Ext.Date.clone(a));var d=a.getDate(),e,f;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);if(a.getDate()!=d){for(e=1,f=b.add(a,Ext.Date.HOUR,e);f.getDate()!=d;e++,f=b.add(a,Ext.Date.HOUR,e));a.setDate(d),a.setHours(f.getHours())}return a},add:function(a,b,c){var d=Ext.Date.clone(a),e=Ext.Date,f;if(!b||c===0)return d;switch(b.toLowerCase()){case Ext.Date.MILLI:d.setMilliseconds(d.getMilliseconds()+c);break;case Ext.Date.SECOND:d.setSeconds(d.getSeconds()+c);break;case Ext.Date.MINUTE:d.setMinutes(d.getMinutes()+c);break;case Ext.Date.HOUR:d.setHours(d.getHours()+c);break;case Ext.Date.DAY:d.setDate(d.getDate()+c);break;case Ext.Date.MONTH:f=a.getDate(),f>28&&(f=Math.min(f,Ext.Date.getLastDateOfMonth(Ext.Date.add(Ext.Date.getFirstDateOfMonth(a),Ext.Date.MONTH,c)).getDate())),d.setDate(f),d.setMonth(a.getMonth()+c);break;case Ext.Date.YEAR:f=a.getDate(),f>28&&(f=Math.min(f,Ext.Date.getLastDateOfMonth(Ext.Date.add(Ext.Date.getFirstDateOfMonth(a),Ext.Date.YEAR,c)).getDate())),d.setDate(f),d.setFullYear(a.getFullYear()+c)}return d},between:function(a,b,c){var d=a.getTime();return b.getTime()<=d&&d<=c.getTime()},compat:function(){var a=window.Date,c,d,e=["useStrict","formatCodeToRegex","parseFunctions","parseRegexes","formatFunctions","y2kYear","MILLI","SECOND","MINUTE","HOUR","DAY","MONTH","YEAR","defaults","dayNames","monthNames","monthNumbers","getShortMonthName","getShortDayName","getMonthNumber","formatCodes","isValid","parseDate","getFormatCode","createFormat","createParser","parseCodes"],f=["dateFormat","format","getTimezone","getGMTOffset","getDayOfYear","getWeekOfYear","isLeapYear","getFirstDayOfMonth","getLastDayOfMonth","getDaysInMonth","getSuffix","clone","isDST","clearTime","add","between"],g=e.length,h=f.length,i,j,k;for(k=0;k<g;k++)i=e[k],a[i]=b[i];for(c=0;c<h;c++)j=f[c],a.prototype[j]=function(){var a=Array.prototype.slice.call(arguments);return a.unshift(this),b[j].apply(b,a)}}};var b=Ext.Date}(),function(a){var b=[],c=function(){};Ext.apply(c,{$className:"Ext.Base",$isClass:!0,create:function(){return Ext.create.apply(Ext,[this].concat(Array.prototype.slice.call(arguments,0)))},extend:function(a){var b=a.prototype,c,d,e,f,g,h;d=this.prototype=Ext.Object.chain(b),d.self=this,this.superclass=d.superclass=b;if(!a.$isClass){c=Ext.Base.prototype;for(e in c)e in d&&(d[e]=c[e])}h=b.$inheritableStatics;if(h)for(e=0,f=h.length;e<f;e++)g=h[e],this.hasOwnProperty(g)||(this[g]=a[g]);a.$onExtended&&(this.$onExtended=a.$onExtended.slice()),d.config=new d.configClass,d.initConfigList=d.initConfigList.slice(),d.initConfigMap=Ext.clone(d.initConfigMap),d.configMap=Ext.Object.chain(d.configMap)},$onExtended:[],triggerExtended:function(){var a=this.$onExtended,b=a.length,c,d;if(b>0)for(c=0;c<b;c++)d=a[c],d.fn.apply(d.scope||this,arguments)},onExtended:function(a,b){return this.$onExtended.push({fn:a,scope:b}),this},addConfig:function(a,b){var c=this.prototype,d=Ext.Class.configNameCache,e=c.configMap,f=c.initConfigList,g=c.initConfigMap,h=c.config,i,j,k;for(j in a)a.hasOwnProperty(j)&&(e[j]||(e[j]=!0),k=a[j],i=d[j].initialized,!g[j]&&k!==null&&!c[i]&&(g[j]=!0,f.push(j)));b?Ext.merge(h,a):Ext.mergeIf(h,a),c.configClass=Ext.Object.classify(h)},addStatics:function(a){var b,c;for(c in a)a.hasOwnProperty(c)&&(b=a[c],this[c]=b);return this},addInheritableStatics:function(a){var b,c,d=this.prototype,e,f;b=d.$inheritableStatics,c=d.$hasInheritableStatics,b||(b=d.$inheritableStatics=[],c=d.$hasInheritableStatics={});for(e in a)a.hasOwnProperty(e)&&(f=a[e],this[e]=f,c[e]||(c[e]=!0,b.push(e)));return this},addMembers:function(a){var b=this.prototype,c=Ext.enumerables,d=[],e,f,g,h;for(g in a)d.push(g);c&&d.push.apply(d,c);for(e=0,f=d.length;e<f;e++)g=d[e],a.hasOwnProperty(g)&&(h=a[g],typeof h=="function"&&!h.$isClass&&h!==Ext.emptyFn&&(h.$owner=this,h.$name=g),b[g]=h);return this},addMember:function(a,b){return typeof b=="function"&&!b.$isClass&&b!==Ext.emptyFn&&(b.$owner=this,b.$name=a),this.prototype[a]=b,this},implement:function(){this.addMembers.apply(this,arguments)},borrow:function(a,b){var c=this.prototype,d=a.prototype,e,f,g,h,i;b=Ext.Array.from(b);for(e=0,f=b.length;e<f;e++)g=b[e],i=d[g],typeof i=="function"?(h=Ext.Function.clone(i),h.$owner=this,h.$name=g,c[g]=h):c[g]=i;return this},override:function(a){var b=this,c=Ext.enumerables,d=b.prototype,e=Ext.Function.clone,f,g,h,i,j,k;arguments.length===2&&(f=a,a={},a[f]=arguments[1],c=null);do{j=[],i=null;for(f in a)f=="statics"?i=a[f]:f=="config"?b.addConfig(a[f],!0):j.push(f);c&&j.push.apply(j,c);for(g=j.length;g--;)f=j[g],a.hasOwnProperty(f)&&(h=a[f],typeof h=="function"&&!h.$className&&h!==Ext.emptyFn&&(typeof h.$owner!="undefined"&&(h=e(h)),h.$owner=b,h.$name=f,k=d[f],k&&(h.$previous=k)),d[f]=h);d=b,a=i}while(a);return this},callParent:function(a){var c;return(c=this.callParent.caller)&&(c.$previous||(c=c.$owner?c:c.caller)&&c.$owner.superclass.$class[c.$name]).apply(this,a||b)},mixin:function(a,b){var c=b.prototype,d=this.prototype,e;typeof c.onClassMixedIn!="undefined"&&c.onClassMixedIn.call(b,this),d.hasOwnProperty("mixins")||("mixins"in d?d.mixins=Ext.Object.chain(d.mixins):d.mixins={});for(e in c)e==="mixins"?Ext.merge(d.mixins,c[e]):typeof d[e]=="undefined"&&e!="mixinId"&&e!="config"&&(d[e]=c[e]);"config"in c&&this.addConfig(c.config,!1),d.mixins[a]=c},getName:function(){return Ext.getClassName(this)},createAlias:a(function(a,b){this.override(a,function(){return this[b].apply(this,arguments)})}),addXtype:function(a){var b=this.prototype,c=b.xtypesMap,d=b.xtypes,e=b.xtypesChain;return b.hasOwnProperty("xtypesMap")||(c=b.xtypesMap=Ext.merge({},b.xtypesMap||{}),d=b.xtypes=b.xtypes?[].concat(b.xtypes):[],e=b.xtypesChain=b.xtypesChain?[].concat(b.xtypesChain):[],b.xtype=a),c[a]||(c[a]=!0,d.push(a),e.push(a),Ext.ClassManager.setAlias(this,"widget."+a)),this}}),c.implement({isInstance:!0,$className:"Ext.Base",configClass:Ext.emptyFn,initConfigList:[],configMap:{},initConfigMap:{},statics:function(){var a=this.statics.caller,b=this.self;return a?a.$owner:b},callParent:function(a){var c,d=(c=this.callParent.caller)&&(c.$previous||(c=c.$owner?c:c.caller)&&c.$owner.superclass[c.$name]);return d.apply(this,a||b)},self:c,constructor:function(){return this},initConfig:function(a){var b=a,c=Ext.Class.configNameCache,d=new this.configClass,e=this.initConfigList,f=this.configMap,g,h,i,j,k;this.initConfig=Ext.emptyFn,this.initialConfig=b||{},this.config=a=b?Ext.merge(d,a):d;if(b){e=e.slice();for(j in b)f[j]&&b[j]!==null&&(e.push(j),this[c[j].initialized]=!1)}for(h=0,i=e.length;h<i;h++)j=e[h],g=c[j],k=g.initialized,this[k]||(this[k]=!0,this[g.set].call(this,a[j]));return this},hasConfig:function(a){return Boolean(this.configMap[a])},setConfig:function(a,b){if(!a)return this;var c=Ext.Class.configNameCache,d=this.config,e=this.configMap,f=this.initialConfig,g,h;b=Boolean(b);for(g in a){if(b&&f.hasOwnProperty(g))continue;h=a[g],d[g]=h,e[g]&&this[c[g].set](h)}return this},getConfig:function(a){var b=Ext.Class.configNameCache;return this[b[a].get]()},getInitialConfig:function(a){var b=this.config;return a?b[a]:b},onConfigUpdate:function(a,b,c){var d=this.self,e,f,g,h,i,j;a=Ext.Array.from(a),c=c||this;for(e=0,f=a.length;e<f;e++)g=a[e],h="update"+Ext.String.capitalize(g),i=this[h]||Ext.emptyFn,j=function(){i.apply(this,arguments),c[b].apply(c,arguments)},j.$name=h,j.$owner=d,this[h]=j},destroy:function(){this.destroy=Ext.emptyFn}}),c.prototype.callOverridden=c.prototype.callParent,Ext.Base=c}(Ext.Function.flexSetter),function(){function f(a){function b(){return this.constructor.apply(this,arguments)||null}return b}var a,b=Ext.Base,c=[],d,e;for(d in b)b.hasOwnProperty(d)&&c.push(d);e=c.length,Ext.Class=a=function(b,c,d){return typeof b!="function"&&(d=c,c=b,b=null),c||(c={}),b=a.create(b,c),a.process(b,c,d),b},Ext.apply(a,{onBeforeCreated:function(a,b,c){a.addMembers(b),c.onCreated.call(a,a)},create:function(a,d){var h,i;a||(a=f());for(i=0;i<e;i++)h=c[i],a[h]=b[h];return a},process:function(b,c,d){var e=c.preprocessors||a.defaultPreprocessors,f=this.preprocessors,g={onBeforeCreated:this.onBeforeCreated},h=[],i,j,k,l,m,n,o,p;delete c.preprocessors;for(k=0,l=e.length;k<l;k++){i=e[k];if(typeof i=="string"){i=f[i],j=i.properties;if(j===!0)h.push(i.fn);else if(j)for(m=0,n=j.length;m<n;m++){o=j[m];if(c.hasOwnProperty(o)){h.push(i.fn);break}}}else h.push(i)}g.onCreated=d?d:Ext.emptyFn,g.preprocessors=h,this.doProcess(b,c,g)},doProcess:function(a,b,c){var d=this,e=c.preprocessors.shift();if(!e){c.onBeforeCreated.apply(d,arguments);return}e.call(d,a,b,c,d.doProcess)!==!1&&d.doProcess(a,b,c)},preprocessors:{},registerPreprocessor:function(a,b,c,d,e){return d||(d="last"),c||(c=[a]),this.preprocessors[a]={name:a,properties:c||!1,fn:b},this.setDefaultPreprocessorPosition(a,d,e),this},getPreprocessor:function(a){return this.preprocessors[a]},getPreprocessors:function(){return this.preprocessors},defaultPreprocessors:[],getDefaultPreprocessors:function(){return this.defaultPreprocessors},setDefaultPreprocessors:function(a){return this.defaultPreprocessors=Ext.Array.from(a),this},setDefaultPreprocessorPosition:function(a,b,c){var d=this.defaultPreprocessors,e;if(typeof b=="string"){if(b==="first")return d.unshift(a),this;if(b==="last")return d.push(a),this;b=b==="after"?1:-1}return e=Ext.Array.indexOf(d,c),e!==-1&&Ext.Array.splice(d,Math.max(0,e+b),0,a),this},configNameCache:{},getConfigNameMap:function(a){var b=this.configNameCache,c=b[a],d;return c||(d=a.charAt(0).toUpperCase()+a.substr(1),c=b[a]={internal:a,initialized:"_is"+d+"Initialized",apply:"apply"+d,update:"update"+d,set:"set"+d,get:"get"+d,doSet:"doSet"+d,changeEvent:a.toLowerCase()+"change"}),c}}),a.registerPreprocessor("extend",function(a,b){var c=Ext.Base,d=c.prototype,e=b.extend,f,g,h;delete b.extend,e&&e!==Object?f=e:f=c,g=f.prototype;if(!f.$isClass)for(h in d)g[h]||(g[h]=d[h]);a.extend(f),a.triggerExtended.apply(a,arguments),b.onClassExtended&&(a.onExtended(b.onClassExtended,a),delete b.onClassExtended)},!0),a.registerPreprocessor("statics",function(a,b){a.addStatics(b.statics),delete b.statics}),a.registerPreprocessor("inheritableStatics",function(a,b){a.addInheritableStatics(b.inheritableStatics),delete b.inheritableStatics}),a.registerPreprocessor("config",function(b,c){var d=c.config,e=b.prototype;delete c.config,Ext.Object.each(d,function(b,d){var f=a.getConfigNameMap(b),g=f.internal,h=f.initialized,j=f.apply,l=f.update,m=f.set,n=f.get,o=m in e||c.hasOwnProperty(m),p=j in e||c.hasOwnProperty(j),q=l in e||c.hasOwnProperty(l),r,s;d===null||!o&&!p&&!q?(e[g]=d,e[h]=!0):e[h]=!1,o||(c[m]=function(a){var b=this[g],c=this[j],d=this[l];return this[h]||(this[h]=!0),c&&(a=c.call(this,a,b)),typeof a!="undefined"&&(this[g]=a,d&&a!==b&&d.call(this,a,b)),this});if(!(n in e)||c.hasOwnProperty(n))s=c[n]||!1,s?r=function(){return s.apply(this,arguments)}:r=function(){return this[g]},c[n]=function(){var a;return this[h]||(this[h]=!0,this[m](this.config[b])),a=this[n],"$previous"in a?a.$previous=r:this[n]=r,r.apply(this,arguments)}}),b.addConfig(d,!0)}),a.registerPreprocessor("mixins",function(a,b,c){var d=b.mixins,e,f,g,h;delete b.mixins,Ext.Function.interceptBefore(c,"onCreated",function(){if(d instanceof Array)for(g=0,h=d.length;g<h;g++)f=d[g],e=f.prototype.mixinId||f.$className,a.mixin(e,f);else for(var b in d)d.hasOwnProperty(b)&&a.mixin(b,d[b])})}),Ext.extend=function(b,c,d){arguments.length===2&&Ext.isObject(c)&&(d=c,c=b,b=null);var e;if(!c)throw new Error("[Ext.extend] Attempting to extend from a class which has not been loaded on the page.");return d.extend=c,d.preprocessors=["extend","statics","inheritableStatics","mixins","config"],b?e=new a(b,d):e=new a(d),e.prototype.override=function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},e}}(),function(a,b,c,d,e){var f=Ext.ClassManager={classes:{},existCache:{},namespaceRewrites:[{from:"Ext.",to:Ext}],maps:{alternateToName:{},aliasToName:{},nameToAliases:{},nameToAlternates:{}},enableNamespaceParseCache:!0,namespaceParseCache:{},instantiators:[],isCreated:function(a){var b=this.existCache,c,d,f,g,h;if(this.classes[a]||b[a])return!0;g=e,h=this.parseNamespace(a);for(c=0,d=h.length;c<d;c++){f=h[c];if(typeof f!="string")g=f;else{if(!g||!g[f])return!1;g=g[f]}}return b[a]=!0,this.triggerCreated(a),!0},createdListeners:[],nameCreatedListeners:{},triggerCreated:function(a){var b=this.createdListeners,c=this.nameCreatedListeners,d=this.maps.nameToAlternates[a],e=[a],f,g,h,i,j,k;for(f=0,g=b.length;f<g;f++)j=b[f],j.fn.call(j.scope,a);d&&e.push.apply(e,d);for(f=0,g=e.length;f<g;f++){k=e[f],b=c[k];if(b){for(h=0,i=b.length;h<i;h++)j=b[h],j.fn.call(j.scope,k);delete c[k]}}},onCreated:function(a,b,c){var d=this.createdListeners,e=this.nameCreatedListeners,f={fn:a,scope:b};if(c){if(this.isCreated(c)){a.call(b,c);return}e[c]||(e[c]=[]),e[c].push(f)}else d.push(f)},parseNamespace:function(a){var b=this.namespaceParseCache,c,d,f,g,h,i,j,k,l;if(this.enableNamespaceParseCache&&b.hasOwnProperty(a))return b[a];c=[],d=this.namespaceRewrites,f=e,g=a;for(k=0,l=d.length;k<l;k++){h=d[k],i=h.from,j=h.to;if(g===i||g.substring(0,i.length)===i){g=g.substring(i.length),typeof j!="string"?f=j:c=c.concat(j.split("."));break}}return c.push(f),c=c.concat(g.split(".")),this.enableNamespaceParseCache&&(b[a]=c),c},setNamespace:function(a,b){var c=e,d=this.parseNamespace(a),f=d.length-1,g=d[f],h,i;for(h=0;h<f;h++)i=d[h],typeof i!="string"?c=i:(c[i]||(c[i]={}),c=c[i]);return c[g]=b,c[g]},createNamespaces:function(){var a=e,b,c,d,f,g,h;for(d=0,g=arguments.length;d<g;d++){b=this.parseNamespace(arguments[d]);for(f=0,h=b.length;f<h;f++)c=b[f],typeof c!="string"?a=c:(a[c]||(a[c]={}),a=a[c])}return a},set:function(a,b){var c=this,d=c.maps,e=d.nameToAlternates,f=c.getName(b),g;return c.classes[a]=c.setNamespace(a,b),f&&f!==a&&(d.alternateToName[a]=f,g=e[f]||(e[f]=[]),g.push(a)),this},get:function(a){var b=this.classes,c,d,f,g,h;if(b[a])return b[a];c=e,d=this.parseNamespace(a);for(g=0,h=d.length;g<h;g++){f=d[g];if(typeof f!="string")c=f;else{if(!c||!c[f])return null;c=c[f]}}return c},setAlias:function(a,b){var c=this.maps.aliasToName,d=this.maps.nameToAliases,e;return typeof a=="string"?e=a:e=this.getName(a),b&&c[b]!==e&&(c[b]=e),d[e]||(d[e]=[]),b&&Ext.Array.include(d[e],b),this},getByAlias:function(a){return this.get(this.getNameByAlias(a))},getNameByAlias:function(a){return this.maps.aliasToName[a]||""},getNameByAlternate:function(a){return this.maps.alternateToName[a]||""},getAliasesByName:function(a){return this.maps.nameToAliases[a]||[]},getName:function(a){return a&&a.$className||""},getClass:function(a){return a&&a.self||null},create:function(b,c,d){return c.$className=b,new a(c,function(){var a=c.postprocessors||f.defaultPostprocessors,e=f.postprocessors,g=[],k,l,m,n,o,p,q;delete c.postprocessors;for(l=0,m=a.length;l<m;l++){k=a[l];if(typeof k=="string"){k=e[k],p=k.properties;if(p===!0)g.push(k.fn);else if(p)for(n=0,o=p.length;n<o;n++){q=p[n];if(c.hasOwnProperty(q)){g.push(k.fn);break}}}else g.push(k)}c.postprocessors=g,c.createdFn=d,f.processCreate(b,this,c)})},processCreate:function(a,b,c){var d=this,e=c.postprocessors.shift(),f=c.createdFn;if(!e){d.set(a,b),f&&f.call(b,b),d.triggerCreated(a);return}e.call(d,a,b,c,d.processCreate)!==!1&&d.processCreate(a,b,c)},createOverride:function(a,b,c){var d=this,e=b.override,f=b.requires,g=b.uses,h=function(){var p,q;f?(q=f,f=null,Ext.Loader.require(q,h)):(p=d.get(e),delete b.override,delete b.requires,delete b.uses,Ext.override(p,b),d.triggerCreated(a),g&&Ext.Loader.addUsedClasses(g),c&&c.call(p))};return d.existCache[a]=!0,d.onCreated(h,d,e),d},instantiateByAlias:function(){var a=arguments[0],b=c.call(arguments),d=this.getNameByAlias(a);return d||(d=this.maps.aliasToName[a],Ext.syncRequire(d)),b[0]=d,this.instantiate.apply(this,b)},instantiate:function(){var a=arguments[0],b=typeof a,d=c.call(arguments,1),e=a,f,h;return b!="function"?(b!="string"&&d.length===0&&(d=[a],a=a.xclass),h=this.get(a)):h=a,h||(f=this.getNameByAlias(a),f&&(a=f,h=this.get(a))),h||(f=this.getNameByAlternate(a),f&&(a=f,h=this.get(a))),h||(Ext.syncRequire(a),h=this.get(a)),this.getInstantiator(d.length)(h,d)},dynInstantiate:function(a,b){return b=d(b,!0),b.unshift(a),this.instantiate.apply(this,b)},getInstantiator:function(a){var b=this.instantiators,c,d,e;c=b[a];if(!c){d=a,e=[];for(d=0;d<a;d++)e.push("a["+d+"]");c=b[a]=new Function("c","a","return new c("+e.join(",")+")")}return c},postprocessors:{},defaultPostprocessors:[],registerPostprocessor:function(a,b,c,d,e){return d||(d="last"),c||(c=[a]),this.postprocessors[a]={name:a,properties:c||!1,fn:b},this.setDefaultPostprocessorPosition(a,d,e),this},setDefaultPostprocessors:function(a){return this.defaultPostprocessors=d(a),this},setDefaultPostprocessorPosition:function(a,b,c){var d=this.defaultPostprocessors,e;if(typeof b=="string"){if(b==="first")return d.unshift(a),this;if(b==="last")return d.push(a),this;b=b==="after"?1:-1}return e=Ext.Array.indexOf(d,c),e!==-1&&Ext.Array.splice(d,Math.max(0,e+b),0,a),this},getNamesByExpression:function(a){var b=this.maps.nameToAliases,c=[],d,e,f,g,h,i,j;if(a.indexOf("*")!==-1){a=a.replace(/\*/g,"(.*?)"),h=new RegExp("^"+a+"$");for(d in b)if(b.hasOwnProperty(d)){f=b[d];if(d.search(h)!==-1)c.push(d);else for(i=0,j=f.length;i<j;i++){e=f[i];if(e.search(h)!==-1){c.push(d);break}}}}else g=this.getNameByAlias(a),g?c.push(g):(g=this.getNameByAlternate(a),g?c.push(g):c.push(a));return c}};f.registerPostprocessor("alias",function(a,c,d){var e=d.alias,f,g;for(f=0,g=e.length;f<g;f++)b=e[f],this.setAlias(c,b)},["xtype","alias"]),f.registerPostprocessor("singleton",function(a,b,c,d){return d.call(this,a,new b,c),!1}),f.registerPostprocessor("alternateClassName",function(a,b,c){var d=c.alternateClassName,e,f,g;d instanceof Array||(d=[d]);for(e=0,f=d.length;e<f;e++)g=d[e],this.set(g,b)}),Ext.apply(Ext,{create:b(f,"instantiate"),widget:function(a,b){var c=a,d,e,g,h;return typeof c!="string"?(b=a,c=b.xtype):b=b||{},b.isComponent?b:(d="widget."+c,e=f.getNameByAlias(d),e||(h=!0),g=f.get(e),h||!g?f.instantiateByAlias(d,b):new g(b))},createByAlias:b(f,"instantiateByAlias"),define:function(a,b,c){return b.override?f.createOverride.apply(f,arguments):f.create.apply(f,arguments)},getClassName:b(f,"getName"),getDisplayName:function(a){if(a){if(a.displayName)return a.displayName;if(a.$name&&a.$class)return Ext.getClassName(a.$class)+"#"+a.$name;if(a.$className)return a.$className}return"Anonymous"},getClass:b(f,"getClass"),namespace:b(f,"createNamespaces")}),Ext.createWidget=Ext.widget,Ext.ns=Ext.namespace,a.registerPreprocessor("className",function(a,b){b.$className&&(a.$className=b.$className)},!0,"first"),a.registerPreprocessor("alias",function(a,b){var c=a.prototype,e=d(b.xtype),f=d(b.alias),g="widget.",h=g.length,i=Array.prototype.slice.call(c.xtypesChain||[]),j=Ext.merge({},c.xtypesMap||{}),k,l,m,n;for(k=0,l=f.length;k<l;k++)m=f[k],m.substring(0,h)===g&&(n=m.substring(h),Ext.Array.include(e,n));a.xtype=b.xtype=e[0],b.xtypes=e;for(k=0,l=e.length;k<l;k++)n=e[k],j[n]||(j[n]=!0,i.push(n));b.xtypesChain=i,b.xtypesMap=j,Ext.Function.interceptAfter(b,"onClassCreated",function(){var a=c.mixins,b,d;for(b in a)if(a.hasOwnProperty(b)){d=a[b],e=d.xtypes;if(e)for(k=0,l=e.length;k<l;k++)n=e[k],j[n]||(j[n]=!0,i.push(n))}});for(k=0,l=e.length;k<l;k++)n=e[k],Ext.Array.include(f,g+n);b.alias=f},["xtype","alias"])}(Ext.Class,Ext.Function.alias,Array.prototype.slice,Ext.Array.from,Ext.global),Ext.Loader=new function(){var a=this,b=Ext.ClassManager,c=Ext.Class,d=Ext.Function.flexSetter,e=Ext.Function.alias,f=Ext.Function.pass,g=Ext.Function.defer,h=Ext.Array.erase,i=["extend","mixins","requires"],j={},k=[],l=/\/\.\//g,m=/\./g;Ext.apply(a,{isInHistory:j,history:k,config:{enabled:!1,scriptChainDelay:!1,disableCaching:!0,disableCachingParam:"_dc",garbageCollect:!1,paths:{Ext:"."},preserveScripts:!0,scriptCharset:undefined},setConfig:function(b,c){return Ext.isObject(b)&&arguments.length===1?Ext.merge(a.config,b):a.config[b]=Ext.isObject(c)?Ext.merge(a.config[b],c):c,a},getConfig:function(b){return b?a.config[b]:a.config},setPath:d(function(b,c){return a.config.paths[b]=c,a}),getPath:function(b){var c="",d=a.config.paths,e=a.getPrefix(b);if(e.length>0){if(e===b)return d[e];c=d[e],b=b.substring(e.length+1)}return c.length>0&&(c+="/"),c.replace(l,"/")+b.replace(m,"/")+".js"},getPrefix:function(b){var c=a.config.paths,d,e="";if(c.hasOwnProperty(b))return b;for(d in c)c.hasOwnProperty(d)&&d+"."===b.substring(0,d.length+1)&&d.length>e.length&&(e=d);return e},isAClassNameWithAKnownPrefix:function(b){var c=a.getPrefix(b);return c!==""&&c!==b},require:function(a,b,c,d){b&&b.call(c)},syncRequire:function(){},exclude:function(b){return{require:function(c,d,e){return a.require(c,d,e,b)},syncRequire:function(c,d,e){return a.syncRequire(c,d,e,b)}}},onReady:function(a,b,c,d){var e;c!==!1&&Ext.onDocumentReady&&(e=a,a=function(){Ext.onDocumentReady(e,b,d)}),a.call(b)}});var n=[],o={},p={},q={},r={},s=[],t=[],u={};Ext.apply(a,{documentHead:typeof document!="undefined"&&(document.head||document.getElementsByTagName("head")[0]),isLoading:!1,queue:n,isClassFileLoaded:o,isFileLoaded:p,readyListeners:s,optionalRequires:t,requiresMap:u,numPendingFiles:0,numLoadedFiles:0,hasFileLoadError:!1,classNameToFilePathMap:q,scriptsLoading:0,syncModeEnabled:!1,scriptElements:r,refreshQueue:function(){var c=n.length,d,e,f,g;if(!c&&!a.scriptsLoading)return a.triggerReady();for(d=0;d<c;d++){e=n[d];if(e){g=e.requires;if(g.length>a.numLoadedFiles)continue;for(f=0;f<g.length;)b.isCreated(g[f])?h(g,f,1):f++;if(e.requires.length===0){h(n,d,1),e.callback.call(e.scope),a.refreshQueue();break}}}return a},injectScriptElement:function(b,c,d,e,f){var h=document.createElement("script"),i=!1,j=a.config,k=function(){i||(i=!0,h.onload=h.onreadystatechange=h.onerror=null,typeof j.scriptChainDelay=="number"?g(c,j.scriptChainDelay,e):c.call(e),a.cleanupScriptElement(h,j.preserveScripts===!1,j.garbageCollect))},l=function(b){g(d,1,e),a.cleanupScriptElement(h,j.preserveScripts===!1,j.garbageCollect)};return h.type="text/javascript",h.onerror=l,f=f||j.scriptCharset,f&&(h.charset=f),"addEventListener"in h?h.onload=k:"readyState"in h?h.onreadystatechange=function(){(this.readyState=="loaded"||this.readyState=="complete")&&k()}:h.onload=k,h.src=b,(a.documentHead||document.getElementsByTagName("head")[0]).appendChild(h),h},removeScriptElement:function(b){return r[b]&&(a.cleanupScriptElement(r[b],!0,!!a.getConfig("garbageCollect")),delete r[b]),a},cleanupScriptElement:function(b,c,d){var e;b.onload=b.onreadystatechange=b.onerror=null;if(c){Ext.removeNode(b);if(d)for(e in b)try{b[e]=null,delete b[e]}catch(f){}}return a},loadScript:function(b){var c=a.getConfig(),d=typeof b=="string",e=d?b:b.url,f=!d&&b.onError,g=!d&&b.onLoad,h=!d&&b.scope,i=function(){a.numPendingFiles--,a.scriptsLoading--,f&&f.call(h,"Failed loading '"+e+"', please verify that the file exists"),a.numPendingFiles+a.scriptsLoading===0&&a.refreshQueue()},j=function(){a.numPendingFiles--,a.scriptsLoading--,g&&g.call(h),a.numPendingFiles+a.scriptsLoading===0&&a.refreshQueue()},k;a.isLoading=!0,a.numPendingFiles++,a.scriptsLoading++,k=c.disableCaching?e+"?"+c.disableCachingParam+"="+Ext.Date.now():e,r[e]=a.injectScriptElement(k,j,i)},loadScriptFile:function(b,c,d,e,f){if(p[b])return a;var g=a.getConfig(),h=b+(g.disableCaching?"?"+g.disableCachingParam+"="+Ext.Date.now():""),i=!1,j,k,l;e=e||a,a.isLoading=!0;if(!f)l=function(){},r[b]=a.injectScriptElement(h,c,l,e);else{typeof XMLHttpRequest!="undefined"?j=new XMLHttpRequest:j=new ActiveXObject("Microsoft.XMLHTTP");try{j.open("GET",h,!1),j.send(null)}catch(m){i=!0}k=j.status===1223?204:j.status===0&&(self.location||{}).protocol=="file:"?200:j.status,i=i||k===0,!i&&(k>=200&&k<300||k===304)&&(Ext.globalEval(j.responseText+"\n//@ sourceURL="+b),c.call(e)),j=null}},syncRequire:function(){var b=a.syncModeEnabled;b||(a.syncModeEnabled=!0),a.require.apply(a,arguments),b||(a.syncModeEnabled=!1),a.refreshQueue()},require:function(c,d,e,g){var h={},i={},j=[],k=[],l=[],m=[],p,r,s,t,u,v,w,x,y,z,A;if(g){g=typeof g=="string"?[g]:g;for(x=0,z=g.length;x<z;x++){u=g[x];if(typeof u=="string"&&u.length>0){j=b.getNamesByExpression(u);for(y=0,A=j.length;y<A;y++)h[j[y]]=!0}}}c=typeof c=="string"?[c]:c?c:[],d?d.length>0?p=function(){var a=[],c,e;for(c=0,e=m.length;c<e;c++)a.push(b.get(m[c]));return d.apply(this,a)}:p=d:p=Ext.emptyFn,e=e||Ext.global;for(x=0,z=c.length;x<z;x++){t=c[x];if(typeof t=="string"&&t.length>0){k=b.getNamesByExpression(t),A=k.length;for(y=0;y<A;y++)w=k[y],h[w]!==!0&&(m.push(w),!b.isCreated(w)&&!i[w]&&(i[w]=!0,l.push(w)))}}if(l.length>0){if(!a.config.enabled)throw new Error("Ext.Loader is not enabled, so dependencies cannot be resolved dynamically. Missing required class"+(l.length>1?"es":"")+": "+l.join(", "));r=a.syncModeEnabled,r||n.push({requires:l.slice(),callback:p,scope:e}),z=l.length;for(x=0;x<z;x++)v=l[x],s=a.getPath(v),r&&o.hasOwnProperty(v)&&(a.numPendingFiles--,a.removeScriptElement(s),delete o[v]),o.hasOwnProperty(v)||(o[v]=!1,q[v]=s,a.numPendingFiles++,a.loadScriptFile(s,f(a.onFileLoaded,[v,s],a),f(a.onFileLoadError,[v,s],a),a,r));if(r){p.call(e);if(z===1)return b.get(v)}return a}return p.call(e),a},onFileLoaded:function(b,c){a.numLoadedFiles++,o[b]=!0,p[c]=!0,a.numPendingFiles--,a.numPendingFiles===0&&a.refreshQueue()},onFileLoadError:function(b,c,d,e){a.numPendingFiles--,a.hasFileLoadError=!0},addUsedClasses:function(b){var c,d,e;if(b){b=typeof b=="string"?[b]:b;for(d=0,e=b.length;d<e;d++)c=b[d],typeof c=="string"&&!Ext.Array.contains(t,c)&&t.push(c)}return a},triggerReady:function(){var b,c,d=t;if(a.isLoading){a.isLoading=!1;if(d.length!==0)return d=d.slice(),t.length=0,a.require(d,a.triggerReady,a),a}while(s.length&&!a.isLoading)b=s.shift(),b.fn.call(b.scope);return a},onReady:function(b,c,d,e){var f;d!==!1&&Ext.onDocumentReady&&(f=b,b=function(){Ext.onDocumentReady(f,c,e)}),a.isLoading?s.push({fn:b,scope:c}):b.call(c)},historyPush:function(b){return b&&o.hasOwnProperty(b)&&!j[b]&&(j[b]=!0,k.push(b)),a}}),Ext.disableCacheBuster=function(a,b){var c=new Date;c.setTime(c.getTime()+(a?3650:-1)*24*60*60*1e3),c=c.toGMTString(),document.cookie="ext-cache=1; expires="+c+"; path="+(b||"/")},Ext.require=e(a,"require"),Ext.syncRequire=e(a,"syncRequire"),Ext.exclude=e(a,"exclude"),Ext.onReady=function(b,c,d){a.onReady(b,c,!0,d)},c.registerPreprocessor("loader",function(c,d,e,f){var g=this,h=[],j,k=b.getName(c),l,m,n,o,p,q,r,s,t;for(l=0,n=i.length;l<n;l++){q=i[l];if(d.hasOwnProperty(q)){r=d[q];if(typeof r=="string")h.push(r);else if(r instanceof Array)for(m=0,o=r.length;m<o;m++)p=r[m],typeof p=="string"&&h.push(p);else if(typeof r!="function")for(m in r)r.hasOwnProperty(m)&&(p=r[m],typeof p=="string"&&h.push(p))}}if(h.length===0)return;return a.require(h,function(){for(l=0,n=i.length;l<n;l++){q=i[l];if(d.hasOwnProperty(q)){r=d[q];if(typeof r=="string")d[q]=b.get(r);else if(r instanceof Array)for(m=0,o=r.length;m<o;m++)p=r[m],typeof p=="string"&&(d[q][m]=b.get(p));else if(typeof r!="function")for(var a in r)r.hasOwnProperty(a)&&(p=r[a],typeof p=="string"&&(d[q][a]=b.get(p)))}}f.call(g,c,d,e)}),!1},!0,"after","className"),b.registerPostprocessor("uses",function(b,c,d){var e=d.uses;e&&a.addUsedClasses(e)}),b.onCreated(a.historyPush)},Ext.Error=Ext.extend(Error,{statics:{ignore:!1,raise:function(a){a=a||{},Ext.isString(a)&&(a={msg:a});var b=this.raise.caller,c;b&&(b.$name&&(a.sourceMethod=b.$name),b.$owner&&(a.sourceClass=b.$owner.$className));if(Ext.Error.handle(a)!==!0)throw c=Ext.Error.prototype.toString.call(a),Ext.log({msg:c,level:"error",dump:a,stack:!0}),new Ext.Error(a)},handle:function(){return Ext.Error.ignore}},name:"Ext.Error",constructor:function(a){Ext.isString(a)&&(a={msg:a});var b=this;Ext.apply(b,a),b.message=b.message||b.msg},toString:function(){var a=this,b=a.sourceClass?a.sourceClass:"",c=a.sourceMethod?"."+a.sourceMethod+"(): ":"",d=a.msg||"(No description provided)";return b+c+d}}),Ext.deprecated=function(a){return Ext.emptyFn},Ext.JSON=new function(){var me=this,encodingFunction,decodingFunction,useNative=null,useHasOwn=!!{}.hasOwnProperty,isNative=function(){return useNative===null&&(useNative=Ext.USE_NATIVE_JSON&&window.JSON&&JSON.toString()=="[object JSON]"),useNative},pad=function(a){return a<10?"0"+a:a},doDecode=function(json){return eval("("+json+")")},doEncode=function(a,b){return a===null||a===undefined?"null":Ext.isDate(a)?Ext.JSON.encodeDate(a):Ext.isString(a)?encodeString(a):typeof a=="number"?isFinite(a)?String(a):"null":Ext.isBoolean(a)?String(a):a.toJSON?a.toJSON():Ext.isArray(a)?encodeArray(a,b):Ext.isObject(a)?encodeObject(a,b):typeof a=="function"?"null":"undefined"},m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\","":"\\u000b"},charToReplace=/[\\\"\x00-\x1f\x7f-\uffff]/g,encodeString=function(a){return'"'+a.replace(charToReplace,function(a){var b=m[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"'},encodeArray=function(a,b){var c=["[",""],d=a.length,e;for(e=0;e<d;e+=1)c.push(doEncode(a[e]),",");return c[c.length-1]="]",c.join("")},encodeObject=function(a,b){var c=["{",""],d;for(d in a)(!useHasOwn||a.hasOwnProperty(d))&&c.push(doEncode(d),":",doEncode(a[d]),",");return c[c.length-1]="}",c.join("")};me.encodeValue=doEncode,me.encodeDate=function(a){return'"'+a.getFullYear()+"-"+pad(a.getMonth()+1)+"-"+pad(a.getDate())+"T"+pad(a.getHours())+":"+pad(a.getMinutes())+":"+pad(a.getSeconds())+'"'},me.encode=function(a){return encodingFunction||(encodingFunction=isNative()?JSON.stringify:me.encodeValue),encodingFunction(a)},me.decode=function(a,b){decodingFunction||(decodingFunction=isNative()?JSON.parse:doDecode);try{return decodingFunction(a)}catch(c){if(b===!0)return null;Ext.Error.raise({sourceClass:"Ext.JSON",sourceMethod:"decode",msg:"You're trying to decode an invalid JSON String: "+a})}}},Ext.encode=Ext.JSON.encode,Ext.decode=Ext.JSON.decode,Ext.apply(Ext,{userAgent:navigator.userAgent.toLowerCase(),cache:{},idSeed:1e3,windowId:"ext-window",documentId:"ext-document",isReady:!1,enableGarbageCollector:!0,enableListenerCollection:!0,addCacheEntry:function(a,b,c){c=c||b.dom;var d=a||b&&b.id||c.id,e=Ext.cache[d]||(Ext.cache[d]={data:{},events:{},dom:c,skipGarbageCollection:!!c.getElementById||!!c.navigator});return b&&(b.$cache=e,e.el=b),e},id:function(a,b){var c=this,d="";return a=Ext.getDom(a,!0)||{},a===document?a.id=c.documentId:a===window&&(a.id=c.windowId),a.id||(c.isSandboxed&&(d=Ext.sandboxName.toLowerCase()+"-"),a.id=d+(b||"ext-gen")+ ++Ext.idSeed),a.id},escapeId:function(){var a=/^[a-zA-Z_][a-zA-Z0-9_\-]*$/i,b=/([\W]{1})/g,c=/^(\d)/g,d=function(a,b){return"\\"+b},e=function(a,b){return"\\00"+b.charCodeAt(0).toString(16)+" "};return function(f){return a.test(f)?f:f.replace(b,d).replace(c,e)}}(),getBody:function(){var a;return function(){return a||(a=Ext.get(document.body))}}(),getHead:function(){var a;return function(){return a||(a=Ext.get(document.getElementsByTagName("head")[0]))}}(),getDoc:function(){var a;return function(){return a||(a=Ext.get(document))}}(),getCmp:function(a){return Ext.ComponentManager.get(a)},getOrientation:function(){return window.innerHeight>window.innerWidth?"portrait":"landscape"},destroy:function(){var a=arguments.length,b,c;for(b=0;b<a;b++)c=arguments[b],c&&(Ext.isArray(c)?this.destroy.apply(this,c):Ext.isFunction(c.destroy)?c.destroy():c.dom&&c.remove())},callback:function(a,b,c,d){Ext.isFunction(a)&&(c=c||[],b=b||window,d?Ext.defer(a,d,b,c):a.apply(b,c))},htmlEncode:function(a){return Ext.String.htmlEncode(a)},htmlDecode:function(a){return Ext.String.htmlDecode(a)},urlAppend:function(a,b){return Ext.String.urlAppend(a,b)}}),Ext.ns=Ext.namespace,window.undefined=window.undefined,function(){var a=function(a){return a.test(Ext.userAgent)},b=document.compatMode=="CSS1Compat",c=function(a,b){var c;return a&&(c=b.exec(Ext.userAgent))?parseFloat(c[1]):0},d=document.documentMode,e=a(/opera/),f=e&&a(/version\/10\.5/),g=a(/\bchrome\b/),h=a(/webkit/),i=!g&&a(/safari/),j=i&&a(/applewebkit\/4/),k=i&&a(/version\/3/),l=i&&a(/version\/4/),m=i&&a(/version\/5\.0/),n=i&&a(/version\/5/),o=!e&&a(/msie/),p=o&&(a(/msie 7/)&&d!=8&&d!=9||d==7),q=o&&(a(/msie 8/)&&d!=7&&d!=9||d==8),r=o&&(a(/msie 9/)&&d!=7&&d!=8||d==9),s=o&&a(/msie 6/),t=!h&&a(/gecko/),u=t&&a(/rv:1\.9/),v=t&&a(/rv:2\.0/),w=t&&a(/rv:5\./),x=t&&a(/rv:10\./),y=u&&a(/rv:1\.9\.0/),z=u&&a(/rv:1\.9\.1/),A=u&&a(/rv:1\.9\.2/),B=a(/windows|win32/),C=a(/macintosh|mac os x/),D=a(/linux/),E=null,F=c(!0,/\bchrome\/(\d+\.\d+)/),G=c(!0,/\bfirefox\/(\d+\.\d+)/),H=c(o,/msie (\d+\.\d+)/),I=c(e,/version\/(\d+\.\d+)/),J=c(i,/version\/(\d+\.\d+)/),K=c(h,/webkit\/(\d+\.\d+)/),L=/^https/i.test(window.location.protocol),M;try{document.execCommand("BackgroundImageCache",!1,!0)}catch(N){}M=function(){},M.info=M.warn=M.error=Ext.emptyFn,Ext.setVersion("extjs","4.1.0"),Ext.apply(Ext,{SSL_SECURE_URL:L&&o?"javascript:''":"about:blank",scopeResetCSS:Ext.buildSettings.scopeResetCSS,resetCls:Ext.buildSettings.baseCSSPrefix+"reset",enableNestedListenerRemoval:!1,USE_NATIVE_JSON:!1,getDom:function(a,b){if(!a||!document)return null;if(a.dom)return a.dom;if(typeof a=="string"){var c=Ext.getElementById(a);return c&&o&&b?a==c.getAttribute("id")?c:null:c}return a},removeNode:s||p||q?function(){var a;return function(b){if(b&&b.tagName.toUpperCase()!="BODY"){Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(b):Ext.EventManager.removeAll(b);var c=Ext.cache,d=b.id;c[d]&&(delete c[d].dom,delete c[d]),b.tagName.toUpperCase()!="IFRAME"&&(q&&b.parentNode&&b.parentNode.removeChild(b),a=a||document.createElement("div"),a.appendChild(b),a.innerHTML="")}}}():function(a){if(a&&a.parentNode&&a.tagName.toUpperCase()!="BODY"){Ext.enableNestedListenerRemoval?Ext.EventManager.purgeElement(a):Ext.EventManager.removeAll(a);var b=Ext.cache,c=a.id;b[c]&&(delete b[c].dom,delete b[c]),a.parentNode.removeChild(a)}},isStrict:b,isIEQuirks:o&&!b,isOpera:e,isOpera10_5:f,isWebKit:h,isChrome:g,isSafari:i,isSafari3:k,isSafari4:l,isSafari5:n,isSafari5_0:m,isSafari2:j,isIE:o,isIE6:s,isIE7:p,isIE8:q,isIE9:r,isGecko:t,isGecko3:u,isGecko4:v,isGecko5:w,isGecko10:x,isFF3_0:y,isFF3_5:z,isFF3_6:A,isFF4:4<=G&&G<5,isFF5:5<=G&&G<6,isFF10:10<=G&&G<11,isLinux:D,isWindows:B,isMac:C,chromeVersion:F,firefoxVersion:G,ieVersion:H,operaVersion:I,safariVersion:J,webKitVersion:K,isSecure:L,BLANK_IMAGE_URL:s||p?"//www.sencha.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",value:function(a,b,c){return Ext.isEmpty(a,c)?b:a},escapeRe:function(a){return a.replace(/([-.*+?\^${}()|\[\]\/\\])/g,"\\$1")},addBehaviors:function(a){if(!Ext.isReady)Ext.onReady(function(){Ext.addBehaviors(a)});else{var b={},c,d,e;for(d in a)(c=d.split("@"))[1]&&(e=c[0],b[e]||(b[e]=Ext.select(e)),b[e].on(c[1],a[d]));b=null}},getScrollbarSize:function(a){if(!Ext.isReady)return{};if(a||!E){var b=document.body,c=document.createElement("div");c.style.width=c.style.height="100px",c.style.overflow="scroll",c.style.position="absolute",b.appendChild(c),E={width:c.offsetWidth-c.clientWidth,height:c.offsetHeight-c.clientHeight},b.removeChild(c)}return E},getScrollBarWidth:function(a){var b=Ext.getScrollbarSize(a);return b.width+2},copyTo:function(a,b,c,d){typeof c=="string"&&(c=c.split(/[,;\s]/));var e,f=c.length,g;for(e=0;e<f;e++){g=c[e];if(d||b.hasOwnProperty(g))a[g]=b[g]}return a},destroyMembers:function(a){for(var b=1,c=arguments,d=c.length;b<d;b++)Ext.destroy(a[c[b]]),delete a[c[b]]},log:M,partition:function(a,b){var c=[[],[]],d,e,f=a.length;for(d=0;d<f;d++)e=a[d],c[b&&b(e,d,a)||!b&&e?0:1].push(e);return c},invoke:function(a,b){var c=[],d=Array.prototype.slice.call(arguments,2),e,f,g=a.length;for(e=0;e<g;e++)f=a[e],f&&typeof f[b]=="function"?c.push(f[b].apply(f,d)):c.push(undefined);return c},zip:function(){var a=Ext.partition(arguments,function(a){return typeof a!="function"}),b=a[0],c=a[1][0],d=Ext.max(Ext.pluck(b,"length")),e=[],f,g,h;for(f=0;f<d;f++){e[f]=[];if(c)e[f]=c.apply(c,Ext.pluck(b,f));else for(g=0,h=b.length;g<h;g++)e[f].push(b[g][f])}return e},toSentence:function(a,b){var c=a.length,d,e;return c<=1?a[0]:(d=a.slice(0,c-1),e=a[c-1],Ext.util.Format.format("{0} {1} {2}",d.join(", "),b||"and",e))},useShims:s})}(),Ext.application=function(a){Ext.require("Ext.app.Application"),Ext.onReady(function(){new Ext.app.Application(a)})},function(){Ext.ns("Ext.util"),Ext.util.Format={};var a=Ext.util.Format,b=/<\/?[^>]+>/gi,c=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,d=/\r?\n/g,e=/[^\d\.]/g,f;Ext.apply(a,{thousandSeparator:",",decimalSeparator:".",currencyPrecision:2,currencySign:"$",currencyAtEnd:!1,undef:function(a){return a!==undefined?a:""},defaultValue:function(a,b){return a!==undefined&&a!==""?a:b},substr:"ab".substr(-1)!="b"?function(a,b,c){var d=String(a);return b<0?d.substr(Math.max(d.length+b,0),c):d.substr(b,c)}:function(a,b,c){return String(a).substr(b,c)},lowercase:function(a){return String(a).toLowerCase()},uppercase:function(a){return String(a).toUpperCase()},usMoney:function(b){return a.currency(b,"$",2)},currency:function(b,c,d,e){var f="",h=",0",i=0;b-=0,b<0&&(b=-b,f="-"),d=Ext.isDefined(d)?d:a.currencyPrecision,h+=h+(d>0?".":"");for(;i<d;i++)h+="0";return b=a.number(b,h),(e||a.currencyAtEnd)===!0?Ext.String.format("{0}{1}{2}",f,b,c||a.currencySign):Ext.String.format("{0}{1}{2}",f,c||a.currencySign,b)},date:function(a,b){return a?(Ext.isDate(a)||(a=new Date(Date.parse(a))),Ext.Date.dateFormat(a,b||Ext.Date.defaultFormat)):""},dateRenderer:function(b){return function(c){return a.date(c,b)}},stripTags:function(a){return a?String(a).replace(b,""):a},stripScripts:function(a){return a?String(a).replace(c,""):a},fileSize:function(a){return a<1024?a+" bytes":a<1048576?Math.round(a*10/1024)/10+" KB":Math.round(a*10/1048576)/10+" MB"},math:function(){var a={};return function(b,c){return a[c]||(a[c]=Ext.functionFactory("v","return v "+c+";")),a[c](b)}}(),round:function(a,b){var c=Number(a);return typeof b=="number"&&(b=Math.pow(10,b),c=Math.round(a*b)/b),c},number:function(b,c){if(!c)return b;b=Ext.Number.from(b,NaN);if(isNaN(b))return"";var d=a.thousandSeparator,h=a.decimalSeparator,i=!1,j=b<0,k,l,m,n,o,p,q,r,s;b=Math.abs(b),c.substr(c.length-2)=="/i"?(f||(f=new RegExp("[^\\d\\"+a.decimalSeparator+"]","g")),c=c.substr(0,c.length-2),i=!0,k=c.indexOf(d)!=-1,l=c.replace(f,"").split(h)):(k=c.indexOf(",")!=-1,l=c.replace(e,"").split(".")),l.length>2||(l.length>1?b=Ext.Number.toFixed(b,l[1].length):b=Ext.Number.toFixed(b,0)),m=b.toString(),l=m.split(".");if(k){n=l[0],o=[],p=n.length,q=Math.floor(p/3),r=n.length%3||3;for(s=0;s<p;s+=r)s!==0&&(r=3),o[o.length]=n.substr(s,r),q-=1;m=o.join(d),l[1]&&(m+=h+l[1])}else l[1]&&(m=l[0]+h+l[1]);return j&&(j=m.replace(/[^1-9]/g,"")!==""),(j?"-":"")+c.replace(/[\d,?\.?]+/,m)},numberRenderer:function(b){return function(c){return a.number(c,b)}},plural:function(a,b,c){return a+" "+(a==1?b:c?c:b+"s")},nl2br:function(a){return Ext.isEmpty(a)?"":a.replace(d,"<br/>")},capitalize:Ext.String.capitalize,ellipsis:Ext.String.ellipsis,format:Ext.String.format,htmlDecode:Ext.String.htmlDecode,htmlEncode:Ext.String.htmlEncode,leftPad:Ext.String.leftPad,trim:Ext.String.trim,parseBox:function(a){a=Ext.isEmpty(a)?"":a,Ext.isNumber(a)&&(a=a.toString());var b=a.split(" "),c=b.length;return c==1?b[1]=b[2]=b[3]=b[0]:c==2?(b[2]=b[0],b[3]=b[1]):c==3&&(b[3]=b[1]),{top:parseInt(b[0],10)||0,right:parseInt(b[1],10)||0,bottom:parseInt(b[2],10)||0,left:parseInt(b[3],10)||0}},escapeRegex:function(a){return a.replace(/([\-.*+?\^${}()|\[\]\/\\])/g,"\\$1")}})}(),Ext.define("Ext.util.TaskRunner",{interval:10,timerId:null,constructor:function(a){var b=this;typeof a=="number"?b.interval=a:a&&Ext.apply(b,a),b.tasks=[],b.timerFn=Ext.Function.bind(b.onTick,b)},newTask:function(a){var b=new Ext.util.TaskRunner.Task(a);return b.manager=this,b},start:function(a){var b=this,c=(new Date).getTime();return a.pending||(b.tasks.push(a),a.pending=!0),a.stopped=!1,a.taskStartTime=c,a.taskRunTime=a.fireOnStart!==!1?0:a.taskStartTime,a.taskRunCount=0,b.firing||(a.fireOnStart!==!1?b.startTimer(0,c):b.startTimer(a.interval,c)),a},stop:function(a){return a.stopped||(a.stopped=!0,a.onStop&&a.onStop.call(a.scope||a,a)),a},stopAll:function(){Ext.each(this.tasks,this.stop,this)},firing:!1,nextExpires:1e+99,onTick:function(){var a=this,b=a.tasks,c=(new Date).getTime(),d=1e+99,e=b.length,f,g,h,i,j,k;a.timerId=null,a.firing=!0;for(h=0;h<e||h<(e=b.length);++h){i=b[h];if(!(k=i.stopped)){f=i.taskRunTime+i.interval;if(f<=c){j=1;try{j=i.run.apply(i.scope||i,i.args||[++i.taskRunCount])}catch(l){try{i.onError&&(j=i.onError.call(i.scope||i,i,l))}catch(m){}}i.taskRunTime=c,j===!1||i.taskRunCount===i.repeat?(a.stop(i),k=!0):(k=i.stopped,f=c+i.interval)}!k&&i.duration&&i.duration<=c-i.taskStartTime&&(a.stop(i),k=!0)}k?(i.pending=!1,g||(g=b.slice(0,h))):(g&&g.push(i),d>f&&(d=f))}g&&(a.tasks=g),a.firing=!1,a.tasks.length&&a.startTimer(d-c,(new Date).getTime())},startTimer:function(a,b){var c=this,d=b+a,e=c.timerId;e&&c.nextExpires-d>c.interval&&(clearTimeout(e),e=null),e||(a<c.interval&&(a=c.interval),c.timerId=setTimeout(c.timerFn,a),c.nextExpires=d)}},function(){var a=this,b=a.prototype;b.destroy=b.stopAll,Ext.util.TaskManager=Ext.TaskManager=new a,a.Task=new Ext.Class({isTask:!0,stopped:!0,fireOnStart:!1,constructor:function(a){Ext.apply(this,a)},restart:function(a){a!==undefined&&(this.interval=a),this.manager.start(this)},start:function(a){this.stopped&&this.restart(a)},stop:function(){this.manager.stop(this)}}),b=a.Task.prototype,b.destroy=b.stop}),Ext.define("Ext.perf.Accumulator",function(){function e(a,b){a.sum+=b,a.min=Math.min(a.min,b),a.max=Math.max(a.max,b)}function f(b){var c=b?b:d()-this.time,f=this,g=f.accum;++g.count,--g.depth||e(g.total,c),e(g.pure,c-f.childTime),a=f.parent,a&&(++a.accum.childCount,a.childTime+=c)}function g(){return{min:Number.MAX_VALUE,max:0,sum:0}}function h(a,b){return function(){var c=a.enter(),d=b.apply(this,arguments);return c.leave(),d}}function i(a){return Math.round(a*100)/100}function j(a,b,c,d){var e={avg:0,min:d.min,max:d.max,sum:0};return a&&(c=c||0,e.sum=d.sum-b*c,e.avg=e.sum/a),e}var a=null,b=Ext.global.chrome,c,d=function(){d=function(){return(new Date).getTime()};var a,c;if(Ext.isChrome&&b&&b.Interval)a=new b.Interval,a.start(),d=function(){return a.microseconds()/1e3};else if(window.ActiveXObject)try{c=new ActiveXObject("SenchaToolbox.Toolbox"),Ext.senchaToolbox=c,d=function(){return c.milliseconds}}catch(e){}else Date.now&&(d=Date.now);return Ext.perf.getTimestamp=Ext.perf.Accumulator.getTimestamp=d,d()};return{constructor:function(a){var b=this;b.count=b.childCount=b.depth=b.maxDepth=0,b.pure=g(),b.total=g(),b.name=a},statics:{getTimestamp:d},format:function(a){c||(c=new Ext.XTemplate(["{name} - {count} call(s)",'<tpl if="count">','<tpl if="childCount">'," ({childCount} children)","</tpl>",'<tpl if="depth - 1">'," ({depth} deep)","</tpl>",'<tpl for="times">',", {type}: {[this.time(values.sum)]} msec (","avg={[this.time(values.sum / parent.count)]}",")","</tpl>","</tpl>"].join(""),{time:function(a){return Math.round(a*100)/100}}));var b=this.getData(a);return b.name=this.name,b.pure.type="Pure",b.total.type="Total",b.times=[b.pure,b.total],c.apply(b)},getData:function(a){var b=this;return{count:b.count,childCount:b.childCount,depth:b.maxDepth,pure:j(b.count,b.childCount,a,b.pure),total:j(b.count,b.childCount,a,b.total)}},enter:function(){var b=this,c={accum:b,leave:f,childTime:0,parent:a};return++b.depth,b.maxDepth<b.depth&&(b.maxDepth=b.depth),a=c,c.time=d(),c},monitor:function(a,b,c){var d=this.enter();c?a.apply(b,c):a.call(b),d.leave()},report:function(){Ext.log(this.format())},tap:function(a,b){var c=this,d=typeof b=="string"?[b]:b,e,f,g,i,j,k,l,m;return m=function(){if(typeof a=="string"){e=Ext.global,i=a.split(".");for(g=0,j=i.length;g<j;++g)e=e[i[g]]}else e=a;for(g=0,j=d.length;g<j;++g)k=d[g],f=k.charAt(0)=="!",f?k=k.substring(1):f=!(k in e.prototype),l=f?e:e.prototype,l[k]=h(c,l[k])},Ext.ClassManager.onCreated(m,c,a),c}}}(),function(){Ext.perf.getTimestamp=this.getTimestamp}),Ext.define("Ext.perf.Monitor",{singleton:!0,alternateClassName:"Ext.Perf",requires:["Ext.perf.Accumulator"],constructor:function(){this.accumulators=[],this.accumulatorsByName={}},calibrate:function(){var a=new Ext.perf.Accumulator("$"),b=a.total,c=Ext.perf.Accumulator.getTimestamp,d=0,e,f,g;g=c();do e=a.enter(),e.leave(),++d;while(b.sum<100);return f=c(),(f-g)/d},get:function(a){var b=this,c=b.accumulatorsByName[a];return c||(b.accumulatorsByName[a]=c=new Ext.perf.Accumulator(a),b.accumulators.push(c)),c},enter:function(a){return this.get(a).enter()},monitor:function(a,b,c){this.get(a).monitor(b,c)},report:function(){var a=this,b=a.accumulators,c=a.calibrate();b.sort(function(a,b){return a.name<b.name?-1:b.name<a.name?1:0}),a.updateGC(),Ext.log("Calibration: "+Math.round(c*100)/100+" msec/sample"),Ext.each(b,function(a){Ext.log(a.format(c))})},getData:function(a){var b={},c=this.accumulators;return Ext.each(c,function(c){if(a||c.count)b[c.name]=c.getData()}),b},updateGC:function(){var a=this.accumulatorsByName.GC,b=Ext.senchaToolbox,c;a&&(a.count=b.garbageCollectionCounter||0,a.count&&(c=a.pure,a.total.sum=c.sum=b.garbageCollectionMilliseconds,c.min=c.max=c.sum/a.count,c=a.total,c.min=c.max=c.sum/a.count))},watchGC:function(){Ext.perf.getTimestamp();var a=Ext.senchaToolbox;a&&(this.get("GC"),a.watchGarbageCollector(!1))},setup:function(a){a||(a={render:{"Ext.AbstractComponent":"render"},layout:{"Ext.layout.Context":"run"}}),this.currentConfig=a;var b,c,d,e,f;for(b in a)if(a.hasOwnProperty(b)){c=a[b],d=Ext.Perf.get(b);for(e in c)c.hasOwnProperty(e)&&(f=c[e],d.tap(e,f))}this.watchGC()}}),Ext.is={init:function(a){var b=this.platforms,c=b.length,d,e;a=a||window.navigator;for(d=0;d<c;d++)e=b[d],this[e.identity]=e.regex.test(a[e.property]);this.Desktop=this.Mac||this.Windows||this.Linux&&!this.Android,this.Tablet=this.iPad,this.Phone=!this.Desktop&&!this.Tablet,this.iOS=this.iPhone||this.iPad||this.iPod,this.Standalone=!!window.navigator.standalone},platforms:[{property:"platform",regex:/iPhone/i,identity:"iPhone"},{property:"platform",regex:/iPod/i,identity:"iPod"},{property:"userAgent",regex:/iPad/i,identity:"iPad"},{property:"userAgent",regex:/Blackberry/i,identity:"Blackberry"},{property:"userAgent",regex:/Android/i,identity:"Android"},{property:"platform",regex:/Mac/i,identity:"Mac"},{property:"platform",regex:/Win/i,identity:"Windows"},{property:"platform",regex:/Linux/i,identity:"Linux"}]},Ext.is.init(),function(){var a=function(a,b){var c=a.ownerDocument.defaultView,d=(c?c.getComputedStyle(a,null):a.currentStyle)||a.style;return d[b]};Ext.supports={init:function(){var a=this,b=document,c=a.tests,d=c.length,e=d&&Ext.isReady&&b.createElement("div"),f,g=[];e&&(e.innerHTML=['<div style="height:30px;width:50px;">','<div style="height:20px;width:20px;"></div>',"</div>",'<div style="width: 200px; height: 200px; position: relative; padding: 5px;">','<div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></div>',"</div>",'<div style="position: absolute; left: 10%; top: 10%;"></div>','<div style="float:left; background-color:transparent;"></div>'].join(""),b.body.appendChild(e));while(d--)f=c[d],e||f.early?a[f.identity]=f.fn.call(a,b,e):g.push(f);e&&b.body.removeChild(e),a.tests=g},PointerEvents:"pointerEvents"in document.documentElement.style,CSS3BoxShadow:"boxShadow"in document.documentElement.style||"WebkitBoxShadow"in document.documentElement.style||"MozBoxShadow"in document.documentElement.style,ClassList:!!document.documentElement.classList,OrientationChange:typeof window.orientation!="undefined"&&"onorientationchange"in window,DeviceMotion:"ondevicemotion"in window,Touch:"ontouchstart"in window&&!Ext.is.Desktop,TimeoutActualLateness:function(){setTimeout(function(){Ext.supports.TimeoutActualLateness=arguments.length!==0},0)}(),tests:[{identity:"Transitions",fn:function(b,c){var d=["webkit","Moz","o","ms","khtml"],e="TransitionEnd",f=[d[0]+e,"transitionend",d[2]+e,d[3]+e,d[4]+e],g=d.length,h=0,i=!1;for(;h<g;h++)if(a(c,d[h]+"TransitionProperty")){Ext.supports.CSS3Prefix=d[h],Ext.supports.CSS3TransitionEnd=f[h],i=!0;break}return i}},{identity:"RightMargin",fn:function(a,b){var c=a.defaultView;return!c||c.getComputedStyle(b.firstChild.firstChild,null).marginRight=="0px"}},{identity:"DisplayChangeInputSelectionBug",early:!0,fn:function(){var a=Ext.webKitVersion;return 0<a&&a<533}},{identity:"DisplayChangeTextAreaSelectionBug",early:!0,fn:function(){var a=Ext.webKitVersion;return 0<a&&a<534.24}},{identity:"TransparentColor",fn:function(a,b,c){return c=a.defaultView,!c||c.getComputedStyle(b.lastChild,null).backgroundColor=="transparent"}},{identity:"ComputedStyle",fn:function(a,b,c){return c=a.defaultView,c&&c.getComputedStyle}},{identity:"Svg",fn:function(a){return!!a.createElementNS&&!!a.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}},{identity:"Canvas",fn:function(a){return!!a.createElement("canvas").getContext}},{identity:"Vml",fn:function(a){var b=a.createElement("div");return b.innerHTML="<!--[if vml]><br/><br/><![endif]-->",b.childNodes.length==2}},{identity:"Float",fn:function(a,b){return!!b.lastChild.style.cssFloat}},{identity:"AudioTag",fn:function(a){return!!a.createElement("audio").canPlayType}},{identity:"History",fn:function(){var a=window.history;return!!a&&!!a.pushState}},{identity:"CSS3DTransform",fn:function(){return typeof WebKitCSSMatrix!="undefined"&&(new WebKitCSSMatrix).hasOwnProperty("m41")}},{identity:"CSS3LinearGradient",fn:function(a,b){var c="background-image:",d="-webkit-gradient(linear, left top, right bottom, from(black), to(white))",e="linear-gradient(left top, black, white)",f="-moz-"+e,g="-o-"+e,h=[c+d,c+e,c+f,c+g];return b.style.cssText=h.join(";"),(""+b.style.backgroundImage).indexOf("gradient")!==-1}},{identity:"CSS3BorderRadius",fn:function(a,b){var c=["borderRadius","BorderRadius","MozBorderRadius","WebkitBorderRadius","OBorderRadius","KhtmlBorderRadius"],d=!1,e;for(e=0;e<c.length;e++)if(document.body.style[c[e]]!==undefined)return!0;return d}},{identity:"GeoLocation",fn:function(){return typeof navigator!="undefined"&&typeof navigator.geolocation!="undefined"||typeof google!="undefined"&&typeof google.gears!="undefined"}},{identity:"MouseEnterLeave",fn:function(a,b){return"onmouseenter"in b&&"onmouseleave"in b}},{identity:"MouseWheel",fn:function(a,b){return"onmousewheel"in b}},{identity:"Opacity",fn:function(a,b){return Ext.isIE6||Ext.isIE7||Ext.isIE8?!1:(b.firstChild.style.cssText="opacity:0.73",b.firstChild.style.opacity=="0.73")}},{identity:"Placeholder",fn:function(a){return"placeholder"in a.createElement("input")}},{identity:"Direct2DBug",fn:function(){return Ext.isString(document.body.style.msTransformOrigin)}},{identity:"BoundingClientRect",fn:function(a,b){return Ext.isFunction(b.getBoundingClientRect)}},{identity:"IncludePaddingInWidthCalculation",fn:function(a,b){return b.childNodes[1].firstChild.offsetWidth==210}},{identity:"IncludePaddingInHeightCalculation",fn:function(a,b){return b.childNodes[1].firstChild.offsetHeight==210}},{identity:"ArraySort",fn:function(){var a=[1,2,3,4,5].sort(function(){return 0});return a[0]===1&&a[1]===2&&a[2]===3&&a[3]===4&&a[4]===5}},{identity:"Range",fn:function(){return!!document.createRange}},{identity:"CreateContextualFragment",fn:function(){var a=Ext.supports.Range?document.createRange():!1;return a&&!!a.createContextualFragment}},{identity:"WindowOnError",fn:function(){return Ext.isIE||Ext.isGecko||Ext.webKitVersion>=534.16}},{identity:"TextAreaMaxLength",fn:function(){var a=document.createElement("textarea");return"maxlength"in a}},{identity:"GetPositionPercentage",fn:function(b,c){return a(c.childNodes[2],"left")=="10%"}}]}}(),Ext.supports.init(),Ext.util.DelayedTask=function(a,b,c){var d=this,e,f=function(){clearInterval(e),e=null,a.apply(b,c||[])};this.delay=function(h,i,j,k){d.cancel(),a=i||a,b=j||b,c=k||c,e=setInterval(f,h)},this.cancel=function(){e&&(clearInterval(e),e=null)}},Ext.require("Ext.util.DelayedTask",function(){Ext.util.Event=Ext.extend(Object,function(){function a(a,b,c,d){return function(){c.target===arguments[0]&&a.apply(d,arguments)}}function b(a,b,c,d){return b.task=new Ext.util.DelayedTask,function(){b.task.delay(c.buffer,a,d,Ext.Array.toArray(arguments))}}function c(a,b,c,d){return function(){var f=new Ext.util.DelayedTask;b.tasks||(b.tasks=[]),b.tasks.push(f),f.delay(c.delay||10,a,d,Ext.Array.toArray(arguments))}}function d(a,b,c,d){return function(){var c=b.ev;return c.removeListener(b.fn,d)&&c.observable&&c.observable.hasListeners[c.name]--,a.apply(d,arguments)}}return{isEvent:!0,constructor:function(a,b){this.name=b,this.observable=a,this.listeners=[]},addListener:function(a,b,c){var d=this,e;b=b||d.observable,d.isListening(a,b)||(e=d.createListener(a,b,c),d.firing&&(d.listeners=d.listeners.slice(0)),d.listeners.push(e))},createListener:function(e,f,g){g=g||{},f=f||this.observable;var h={fn:e,scope:f,o:g,ev:this},i=e;return g.single&&(i=d(i,h,g,f)),g.target&&(i=a(i,h,g,f)),g.delay&&(i=c(i,h,g,f)),g.buffer&&(i=b(i,h,g,f)),h.fireFn=i,h},findListener:function(a,b){var c=this.listeners,d=c.length,e,f;while(d--){e=c[d];if(e){f=e.scope;if(e.fn==a&&(f==b||f==this.observable))return d}}return-1},isListening:function(a,b){return this.findListener(a,b)!==-1},removeListener:function(a,b){var c=this,d,e,f;d=c.findListener(a,b);if(d!=-1){e=c.listeners[d],c.firing&&(c.listeners=c.listeners.slice(0)),e.task&&(e.task.cancel(),delete e.task),f=e.tasks&&e.tasks.length;if(f){while(f--)e.tasks[f].cancel();delete e.tasks}return Ext.Array.erase(c.listeners,d,1),!0}return!1},clearListeners:function(){var a=this.listeners,b=a.length;while(b--)this.removeListener(a[b].fn,a[b].scope)},fire:function(){var a=this,b=a.listeners,c=b.length,d,e,f;if(c>0){a.firing=!0;for(d=0;d<c;d++){f=b[d],e=arguments.length?Array.prototype.slice.call(arguments,0):[],f.o&&e.push(f.o);if(f&&f.fireFn.apply(f.scope||a.observable,e)===!1)return a.firing=!1}}return a.firing=!1,!0}}}())}),Ext.EventManager=new function(){var a=this,b=document,c=window,d=function(){function g(a){d.push(c+a)}var a=b.body||b.getElementsByTagName("body")[0],c=Ext.baseCSSPrefix,d=[c+"body"],e=[],f;return a?(f=a.parentNode,Ext.isIE&&(g("ie"),Ext.isIE6?g("ie6"):(g("ie7p"),Ext.isIE7?g("ie7"):(g("ie8p"),Ext.isIE8?g("ie8"):(g("ie9p"),Ext.isIE9&&g("ie9")))),(Ext.isIE6||Ext.isIE7)&&g("ie7m"),(Ext.isIE6||Ext.isIE7||Ext.isIE8)&&g("ie8m"),(Ext.isIE7||Ext.isIE8)&&g("ie78")),Ext.isGecko&&(g("gecko"),Ext.isGecko3&&g("gecko3"),Ext.isGecko4&&g("gecko4"),Ext.isGecko5&&g("gecko5")),Ext.isOpera&&g("opera"),Ext.isWebKit&&g("webkit"),Ext.isSafari&&(g("safari"),Ext.isSafari2&&g("safari2"),Ext.isSafari3&&g("safari3"),Ext.isSafari4&&g("safari4"),Ext.isSafari5&&g("safari5"),Ext.isSafari5_0&&g("safari5_0")),Ext.isChrome&&g("chrome"),Ext.isMac&&g("mac"),Ext.isLinux&&g("linux"),Ext.supports.CSS3BorderRadius||g("nbr"),Ext.supports.CSS3LinearGradient||g("nlg"),Ext.scopeResetCSS||g("reset"),f&&(Ext.isStrict&&(Ext.isIE6||Ext.isIE7)?Ext.isBorderBox=!1:Ext.isBorderBox=!0,Ext.isBorderBox&&e.push(c+"border-box"),Ext.isStrict?e.push(c+"strict"):e.push(c+"quirks"),Ext.fly(f,"_internal").addCls(e)),Ext.fly(a,"_internal").addCls(d),!0):!1};Ext.apply(a,{hasBoundOnReady:!1,hasFiredReady:!1,deferReadyEvent:1,onReadyChain:[],readyEvent:function(){var a=new Ext.util.Event;return a.fire=function(){Ext._beforeReadyTime=Ext._beforeReadyTime||(new Date).getTime(),a.self.prototype.fire.apply(a,arguments),Ext._afterReadytime=(new Date).getTime()},a}(),idleEvent:new Ext.util.Event,isReadyPaused:function(){return/[?&]ext-pauseReadyFire\b/i.test(location.search)&&!Ext._continueFireReady},bindReadyEvent:function(){if(a.hasBoundOnReady)return;b.readyState=="complete"?a.onReadyEvent({type:b.readyState||"body"}):(document.addEventListener("DOMContentLoaded",a.onReadyEvent,!1),window.addEventListener("load",a.onReadyEvent,!1),a.hasBoundOnReady=!0)},onReadyEvent:function(b){b&&b.type&&a.onReadyChain.push(b.type),a.hasBoundOnReady&&(document.removeEventListener("DOMContentLoaded",a.onReadyEvent,!1),window.removeEventListener("load",a.onReadyEvent,!1)),Ext.isReady||a.fireDocReady()},fireDocReady:function(){Ext.isReady||(Ext._readyTime=(new Date).getTime(),Ext.isReady=!0,Ext.supports.init(),a.onWindowUnload(),a.readyEvent.onReadyChain=a.onReadyChain,Ext.isNumber(a.deferReadyEvent)?(Ext.Function.defer(a.fireReadyEvent,a.deferReadyEvent),a.hasDocReadyTimer=!0):a.fireReadyEvent())},fireReadyEvent:function(){var b=a.readyEvent;a.hasDocReadyTimer=!1,a.isFiring=!0;while(b.listeners.length&&!a.isReadyPaused())b.fire();a.isFiring=!1,a.hasFiredReady=!0},onDocumentReady:function(b,c,d){d=d||{},d.single=!0,a.readyEvent.addListener(b,c,d),!a.isFiring&&!a.hasDocReadyTimer&&(Ext.isReady?a.fireReadyEvent():a.bindReadyEvent())},stoppedMouseDownEvent:new Ext.util.Event,propRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate|freezeEvent)$/,getId:function(a){var d;return a=Ext.getDom(a),a===b||a===c?d=a===b?Ext.documentId:Ext.windowId:d=Ext.id(a),Ext.cache[d]||Ext.addCacheEntry(d,null,a),d},prepareListenerConfig:function(b,c,d){var e=a.propRe,f,g,h;for(f in c)c.hasOwnProperty(f)&&(e.test(f)||(g=c[f],typeof g=="function"?h=[b,f,g,c.scope,c]:h=[b,f,g.fn,g.scope,g],d?a.removeListener.apply(a,h):a.addListener.apply(a,h)))},mouseEnterLeaveRe:/mouseenter|mouseleave/,normalizeEvent:function(b,c){return a.mouseEnterLeaveRe.test(b)&&!Ext.supports.MouseEnterLeave?(c&&(c=Ext.Function.createInterceptor(c,a.contains)),b=b=="mouseenter"?"mouseover":"mouseout"):b=="mousewheel"&&!Ext.supports.MouseWheel&&!Ext.isOpera&&(b="DOMMouseScroll"),{eventName:b,fn:c}},contains:function(b){var c=b.browserEvent.currentTarget,d=a.getRelatedTarget(b);if(c&&c.firstChild)while(d){if(d===c)return!1;d=d.parentNode,d&&d.nodeType!=1&&(d=null)}return!0},addListener:function(c,d,e,f,g){if(typeof d!="string"){a.prepareListenerConfig(c,d);return}var h=c.dom||Ext.getDom(c),i,j;g=g||{},i=a.normalizeEvent(d,e),j=a.createListenerWrap(h,d,i.fn,f,g),h.attachEvent?h.attachEvent("on"+i.eventName,j):h.addEventListener(i.eventName,j,g.capture||!1),h==b&&d=="mousedown"&&a.stoppedMouseDownEvent.addListener(j),a.getEventListenerCache(c.dom?c:h,d).push({fn:e,wrap:j,scope:f})},removeListener:function(c,d,e,f){if(typeof d!="string"){a.prepareListenerConfig(c,d,!0);return}var g=Ext.getDom(c),h=c.dom?c:Ext.get(g),i=a.getEventListenerCache(h,d),j=a.normalizeEvent(d).eventName,k=i.length,l,m,n,o;while(k--){m=i[k];if(m&&(!e||m.fn==e)&&(!f||m.scope===f)){n=m.wrap,n.task&&(clearTimeout(n.task),delete n.task),l=n.tasks&&n.tasks.length;if(l){while(l--)clearTimeout(n.tasks[l]);delete n.tasks}g.detachEvent?g.detachEvent("on"+j,n):g.removeEventListener(j,n,!1),n&&g==b&&d=="mousedown"&&a.stoppedMouseDownEvent.removeListener(n),Ext.Array.erase(i,k,1)}}},removeAll:function(b){var c=b.dom?b:Ext.get(b),d,e,f;if(!c)return;d=c.$cache||c.getCache(),e=d.events;for(f in e)e.hasOwnProperty(f)&&a.removeListener(c,f);d.events={}},purgeElement:function(b,c){var d=Ext.getDom(b),e=0,f;c?a.removeListener(b,c):a.removeAll(b);if(d&&d.childNodes)for(f=b.childNodes.length;e<f;e++)a.purgeElement(b.childNodes[e],c)},createListenerWrap:function(b,c,d,e,f){f=f||{};var g,h,i=/\\/g,j=function(o,p){h||(g=["if(!"+Ext.name+") {return;}"],f.buffer||f.delay||f.freezeEvent?g.push("e = new X.EventObjectImpl(e, "+(f.freezeEvent?"true":"false")+");"):g.push("e = X.EventObject.setEvent(e);"),f.delegate?(g.push('var t = e.getTarget("'+(f.delegate+"").replace(i,"\\\\")+'", this);'),g.push("if(!t) {return;}")):g.push("var t = e.target;"),f.target&&g.push("if(e.target !== options.target) {return;}"),f.stopEvent?g.push("e.stopEvent();"):(f.preventDefault&&g.push("e.preventDefault();"),f.stopPropagation&&g.push("e.stopPropagation();")),f.normalized===!1&&g.push("e = e.browserEvent;"),f.buffer&&(g.push("(wrap.task && clearTimeout(wrap.task));"),g.push("wrap.task = setTimeout(function() {")),f.delay&&(g.push("wrap.tasks = wrap.tasks || [];"),g.push("wrap.tasks.push(setTimeout(function() {")),g.push("fn.call(scope || dom, e, t, options);"),f.single&&g.push("evtMgr.removeListener(dom, ename, fn, scope);"),c!=="mousemove"&&(g.push("if (evtMgr.idleEvent.listeners.length) {"),g.push("evtMgr.idleEvent.fire();"),g.push("}")),f.delay&&g.push("}, "+f.delay+"));"),f.buffer&&g.push("}, "+f.buffer+");"),h=Ext.cacheableFunctionFactory("e","options","fn","scope","ename","dom","wrap","args","X","evtMgr",g.join("\n"))),h.call(b,o,f,d,e,c,b,j,p,Ext,a)};return j},getEventListenerCache:function(b,c){var d,e;return b?(b.$cache?d=b.$cache:d=Ext.cache[a.getId(b)],e=d.events||(d.events={}),e[c]||(e[c]=[])):[]},mouseLeaveRe:/(mouseout|mouseleave)/,mouseEnterRe:/(mouseover|mouseenter)/,stopEvent:function(b){a.stopPropagation(b),a.preventDefault(b)},stopPropagation:function(a){a=a.browserEvent||a,a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},preventDefault:function(a){a=a.browserEvent||a;if(a.preventDefault)a.preventDefault();else{a.returnValue=!1;try{if(a.ctrlKey||a.keyCode>111&&a.keyCode<124)a.keyCode=-1}catch(b){}}},getRelatedTarget:function(b){b=b.browserEvent||b;var c=b.relatedTarget;return c||(a.mouseLeaveRe.test(b.type)?c=b.toElement:a.mouseEnterRe.test(b.type)&&(c=b.fromElement)),a.resolveTextNode(c)},getPageX:function(b){return a.getPageXY(b)[0]},getPageY:function(b){return a.getPageXY(b)[1]},getPageXY:function(a){a=a.browserEvent||a;var c=a.pageX,d=a.pageY,e=b.documentElement,f=b.body;return!c&&c!==0&&(c=a.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),d=a.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),[c,d]},getTarget:function(b){return b=b.browserEvent||b,a.resolveTextNode(b.target||b.srcElement)},resolveTextNode:Ext.isGecko?function(a){if(!a)return;var b=HTMLElement.prototype.toString.call(a);if(b=="[xpconnect wrapped native prototype]"||b=="[object XULElement]")return;return a.nodeType==3?a.parentNode:a}:function(a){return a&&a.nodeType==3?a.parentNode:a},curWidth:0,curHeight:0,onWindowResize:function(b,d,e){var f=a.resizeEvent;f||(a.resizeEvent=f=new Ext.util.Event,a.on(c,"resize",a.fireResize,null,{buffer:100})),f.addListener(b,d,e)},fireResize:function(){var b=Ext.Element.getViewWidth(),c=Ext.Element.getViewHeight();if(a.curHeight!=c||a.curWidth!=b)a.curHeight=c,a.curWidth=b,a.resizeEvent.fire(b,c)},removeResizeListener:function(b,c){var d=a.resizeEvent;d&&d.removeListener(b,c)},onWindowUnload:function(b,d,e){var f=a.unloadEvent;f||(a.unloadEvent=f=new Ext.util.Event,a.addListener(c,"unload",a.fireUnload)),b&&f.addListener(b,d,e)},fireUnload:function(){try{b=c=undefined;var d,e,f,g,h;a.unloadEvent.fire();if(Ext.isGecko3){d=Ext.ComponentQuery.query("gridview"),e=0,f=d.length;for(;e<f;e++)d[e].scrollToTop()}h=Ext.cache;for(g in h)h.hasOwnProperty(g)&&a.removeAll(g)}catch(i){}},removeUnloadListener:function(b,c){var d=a.unloadEvent;d&&d.removeListener(b,c)},useKeyDown:Ext.isWebKit?parseInt(navigator.userAgent.match(/AppleWebKit\/(\d+)/)[1],10)>=525:!(Ext.isGecko&&!Ext.isWindows||Ext.isOpera),getKeyEvent:function(){return a.useKeyDown?"keydown":"keypress"}}),!("addEventListener"in document)&&document.attachEvent&&Ext.apply(a,{pollScroll:function(){var b=!0;try{document.documentElement.doScroll("left")}catch(c){b=!1}return b?a.onReadyEvent({type:"doScroll"}):a.scrollTimeout=setTimeout(a.pollScroll,20),b},scrollTimeout:null,readyStatesRe:/complete/i,checkReadyState:function(){var b=document.readyState;a.readyStatesRe.test(b)&&a.onReadyEvent({type:b})},bindReadyEvent:function(){var c=!0;if(a.hasBoundOnReady)return;try{c=!window.frameElement}catch(d){}if(!c||!b.documentElement.doScroll)a.pollScroll=Ext.emptyFn;if(a.pollScroll()===!0)return;b.readyState=="complete"?a.onReadyEvent({type:"already "+(b.readyState||"body")}):(b.attachEvent("onreadystatechange",a.checkReadyState),window.attachEvent("onload",a.onReadyEvent),a.hasBoundOnReady=!0)},onReadyEvent:function(b){b&&b.type&&a.onReadyChain.push(b.type),a.hasBoundOnReady&&(document.detachEvent("onreadystatechange",a.checkReadyState),window.detachEvent("onload",a.onReadyEvent)),Ext.isNumber(a.scrollTimeout)&&(clearTimeout(a.scrollTimeout),delete a.scrollTimeout),Ext.isReady||a.fireDocReady()},onReadyChain:[]}),Ext.onReady=function(a,b,c){Ext.Loader.onReady(a,b,!0,c)},Ext.onDocumentReady=a.onDocumentReady,a.on=a.addListener,a.un=a.removeListener,Ext.onReady(d)},Ext.define("Ext.EventObjectImpl",{uses:["Ext.util.Point"],BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,RETURN:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,WHEEL_SCALE:function(){var a;return Ext.isGecko?a=3:Ext.isMac?(Ext.isSafari&&Ext.webKitVersion>=532?a=120:a=12,a*=3):a=120,a}(),clickRe:/(dbl)?click/,safariKeys:{3:13,63234:37,63235:39,63232:38,63233:40,63276:33,63277:34,63272:46,63273:36,63275:35},btnMap:Ext.isIE?{1:0,4:1,2:2}:{0:0,1:1,2:2},constructor:function(a,b){a&&this.setEvent(a.browserEvent||a,b)},setEvent:function(a,b){var c=this,d,e;return a==c||a&&a.browserEvent?a:(c.browserEvent=a,a?(d=a.button?c.btnMap[a.button]:a.which?a.which-1:-1,c.clickRe.test(a.type)&&d==-1&&(d=0),e={type:a.type,button:d,shiftKey:a.shiftKey,ctrlKey:a.ctrlKey||a.metaKey||!1,altKey:a.altKey,keyCode:a.keyCode,charCode:a.charCode,target:Ext.EventManager.getTarget(a),relatedTarget:Ext.EventManager.getRelatedTarget(a),currentTarget:a.currentTarget,xy:b?c.getXY():null}):e={button:-1,shiftKey:!1,ctrlKey:!1,altKey:!1,keyCode:0,charCode:0,target:null,xy:[0,0]},Ext.apply(c,e),c)},stopEvent:function(){this.stopPropagation(),this.preventDefault()},preventDefault:function(){this.browserEvent&&Ext.EventManager.preventDefault(this.browserEvent)},stopPropagation:function(){var a=this.browserEvent;a&&(a.type=="mousedown"&&Ext.EventManager.stoppedMouseDownEvent.fire(this),Ext.EventManager.stopPropagation(a))},getCharCode:function(){return this.charCode||this.keyCode},getKey:function(){return this.normalizeKey(this.keyCode||this.charCode)},normalizeKey:function(a){return Ext.isWebKit?this.safariKeys[a]||a:a},getPageX:function(){return this.getX()},getPageY:function(){return this.getY()},getX:function(){return this.getXY()[0]},getY:function(){return this.getXY()[1]},getXY:function(){return this.xy||(this.xy=Ext.EventManager.getPageXY(this.browserEvent)),this.xy},getTarget:function(a,b,c){return a?Ext.fly(this.target).findParent(a,b,c):c?Ext.get(this.target):this.target},getRelatedTarget:function(a,b,c){return a?Ext.fly(this.relatedTarget).findParent(a,b,c):c?Ext.get(this.relatedTarget):this.relatedTarget},correctWheelDelta:function(a){var b=this.WHEEL_SCALE,c=Math.round(a/b);return!c&&a&&(c=a<0?-1:1),c},getWheelDeltas:function(){var a=this,b=a.browserEvent,c=0,d=0;return Ext.isDefined(b.wheelDeltaX)?(c=b.wheelDeltaX,d=b.wheelDeltaY):b.wheelDelta?d=b.wheelDelta:b.detail&&(d=-b.detail,d>100?d=3:d<-100&&(d=-3),Ext.isDefined(b.axis)&&b.axis===b.HORIZONTAL_AXIS&&(c=d,d=0)),{x:a.correctWheelDelta(c),y:a.correctWheelDelta(d)}},getWheelDelta:function(){var a=this.getWheelDeltas();return a.y},within:function(a,b,c){if(a){var d=b?this.getRelatedTarget():this.getTarget(),e;if(d)return e=Ext.fly(a).contains(d),!e&&c&&(e=d==Ext.getDom(a)),e}return!1},isNavKeyPress:function(){var a=this,b=this.normalizeKey(a.keyCode);return b>=33&&b<=40||b==a.RETURN||b==a.TAB||b==a.ESC},isSpecialKey:function(){var a=this.normalizeKey(this.keyCode);return this.type=="keypress"&&this.ctrlKey||this.isNavKeyPress()||a==this.BACKSPACE||a>=16&&a<=20||a>=44&&a<=46},getPoint:function(){var a=this.getXY();return new Ext.util.Point(a[0],a[1])},hasModifier:function(){return this.ctrlKey||this.altKey||this.shiftKey||this.metaKey},injectEvent:function(){function d(b,c){var d=b!="mousemove";return function(e,f){var j=f.getXY(),k=a.createMouseEvent(e.ownerDocument,b,!0,d,c,j[0],j[1],f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,f.relatedTarget);a.fireEvent(e,b,k)}}function e(a,b){}var a,b={},c;return!Ext.isIE&&document.createEvent?a={createHtmlEvent:function(a,b,c,d){var e=a.createEvent("HTMLEvents");return e.initEvent(b,c,d),e},createMouseEvent:function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=a.createEvent("MouseEvents"),o=a.defaultView||window;return n.initMouseEvent?n.initMouseEvent(b,c,d,o,e,f,g,f,g,h,i,j,k,l,m):(n=a.createEvent("UIEvents"),n.initEvent(b,c,d),n.view=o,n.detail=e,n.screenX=f,n.screenY=g,n.clientX=f,n.clientY=g,n.ctrlKey=h,n.altKey=i,n.metaKey=k,n.shiftKey=j,n.button=l,n.relatedTarget=m),n},createUIEvent:function(a,b,c,d,e){var f=a.createEvent("UIEvents"),g=a.defaultView||window;return f.initUIEvent(b,c,d,g,e),f},fireEvent:function(a,b,c){a.dispatchEvent(c)},fixTarget:function(a){return a==window&&!a.dispatchEvent?document:a}}:document.createEventObject&&(c={0:1,1:4,2:2},a={createHtmlEvent:function(a,b,c,d){var e=a.createEventObject();return e.bubbles=c,e.cancelable=d,e},createMouseEvent:function(a,b,d,e,f,g,h,i,j,k,l,m,n){var o=a.createEventObject();return o.bubbles=d,o.cancelable=e,o.detail=f,o.screenX=g,o.screenY=h,o.clientX=g,o.clientY=h,o.ctrlKey=i,o.altKey=j,o.shiftKey=k,o.metaKey=l,o.button=c[m]||m,o.relatedTarget=n,o},createUIEvent:function(a,b,c,d,e){var f=a.createEventObject();return f.bubbles=c,f.cancelable=d,f},fireEvent:function(a,b,c){a.fireEvent("on"+b,c)},fixTarget:function(a){return a==document?document.documentElement:a}}),Ext.Object.each({load:[!1,!1],unload:[!1,!1],select:[!0,!1],change:[!0,!1],submit:[!0,!0],reset:[!0,!1],resize:[!0,!1],scroll:[!0,!1]},function(c,d){var e=d[0],f=d[1];b[c]=function(b,d){var j=a.createHtmlEvent(c,e,f);a.fireEvent(b,c,j)}}),Ext.each(["click","dblclick","mousedown","mouseup","mouseover","mousemove","mouseout"],function(a){b[a]=d(a,1)}),Ext.Object.each({focusin:[!0,!1],focusout:[!0,!1],activate:[!0,!0],focus:[!1,!1],blur:[!1,!1]},function(c,d){var e=d[0],f=d[1];b[c]=function(b,d){var j=a.createUIEvent(b.ownerDocument,c,e,f,1);a.fireEvent(b,c,j)}}),a||(b={},a={fixTarget:function(a){return a}}),function(c){var d=this,f=b[d.type]||e,g=c?c.dom||c:d.getTarget();g=a.fixTarget(g),f(g,d)}}()},function(){Ext.EventObject=new Ext.EventObjectImpl}),Ext.define("Ext.dom.AbstractQuery",{select:function(a,b){var c=[],d,e,f,g,h;b=b||document,typeof b=="string"&&(b=document.getElementById(b)),a=a.split(",");for(e=0,g=a.length;e<g;e++)if(typeof a[e]=="string")if(typeof a[e][0]=="@")d=b.getAttributeNode(a[e].substring(1)),c.push(d);else{d=b.querySelectorAll(a[e]);for(f=0,h=d.length;f<h;f++)c.push(d[f])}return c},selectNode:function(a,b){return this.select(a,b)[0]},is:function(a,b){return typeof a=="string"&&(a=document.getElementById(a)),this.select(b).indexOf(a)!==-1}}),Ext.define("Ext.dom.AbstractHelper",{emptyTags:/^(?:br|frame|hr|img|input|link|meta|range|spacer|wbr|area|param|col)$/i,confRe:/tag|children|cn|html|tpl|tplData$/i,endRe:/end/i,attribXlat:{cls:"class",htmlFor:"for"},closeTags:{},decamelizeName:function(){function c(a,b,c){return b+"-"+c.toLowerCase()}var a=/([a-z])([A-Z])/g,b={};return function(d){return b[d]||(b[d]=d.replace(a,c))}}(),generateMarkup:function(a,b){var c=this,d,e,f,g,h;if(typeof a=="string")b.push(a);else if(Ext.isArray(a))for(g=0;g<a.length;g++)a[g]&&c.generateMarkup(a[g],b);else{f=a.tag||"div",b.push("<",f);for(d in a)a.hasOwnProperty(d)&&(e=a[d],c.confRe.test(d)||(typeof e=="object"?(b.push(" ",d,'="'),c.generateStyles(e,b).push('"')):b.push(" ",c.attribXlat[d]||d,'="',e,'"')));c.emptyTags.test(f)?b.push("/>"):(b.push(">"),(e=a.tpl)&&e.applyOut(a.tplData,b),(e=a.html)&&b.push(e),(e=a.cn||a.children)&&c.generateMarkup(e,b),h=c.closeTags,b.push(h[f]||(h[f]="</"+f+">")))}return b},generateStyles:function(a,b){var c=b||[],d;for(d in a)a.hasOwnProperty(d)&&c.push(this.decamelizeName(d),":",a[d],";");return b||c.join("")},markup:function(a){if(typeof a=="string")return a;var b=this.generateMarkup(a,[]);return b.join("")},applyStyles:function(a,b){if(b){var c=0,d,e;a=Ext.fly(a),typeof b=="function"&&(b=b.call());if(typeof b=="string"){b=Ext.util.Format.trim(b).split(/\s*(?::|;)\s*/);for(d=b.length;c<d;)a.setStyle(b[c++],b[c++])}else Ext.isObject(b)&&a.setStyle(b)}},insertHtml:function(a,b,c){var d={},e,f,g,h,i,j;return a=a.toLowerCase(),d.beforebegin=["BeforeBegin","previousSibling"],d.afterend=["AfterEnd","nextSibling"],g=b.ownerDocument.createRange(),f="setStart"+(this.endRe.test(a)?"After":"Before"),d[a]?(g[f](b),h=g.createContextualFragment(c),b.parentNode.insertBefore(h,a=="beforebegin"?b:b.nextSibling),b[(a=="beforebegin"?"previous":"next")+"Sibling"]):(i=(a=="afterbegin"?"first":"last")+"Child",b.firstChild?(g[f](b[i]),h=g.createContextualFragment(c),a=="afterbegin"?b.insertBefore(h,b.firstChild):b.appendChild(h)):b.innerHTML=c,b[i])},insertBefore:function(a,b,c){return this.doInsert(a,b,c,"beforebegin")},insertAfter:function(a,b,c){return this.doInsert(a,b,c,"afterend","nextSibling")},insertFirst:function(a,b,c){return this.doInsert(a,b,c,"afterbegin","firstChild")},append:function(a,b,c){return this.doInsert(a,b,c,"beforeend","",!0)},overwrite:function(a,b,c){return a=Ext.getDom(a),a.innerHTML=this.markup(b),c?Ext.get(a.firstChild):a.firstChild},doInsert:function(a,b,c,d,e,f){var g=this.insertHtml(d,Ext.getDom(a),this.markup(b));return c?Ext.get(g,!0):g}}),function(){var a=window.document,b=/^\s+|\s+$/g,c=/\s/;Ext.cache||(Ext.cache={}),Ext.define("Ext.dom.AbstractElement",{inheritableStatics:{get:function(b){var c=this,d=Ext.dom.Element,e,f,g,h;if(!b)return null;if(typeof b=="string")return b==Ext.windowId?d.get(window):b==Ext.documentId?d.get(a):(e=Ext.cache[b],e&&e.skipGarbageCollection?(f=e.el,f):(g=a.getElementById(b))?(e&&e.el?(f=e.el,f.dom=g):f=new d(g,!!e),f):null);return b.tagName?((h=b.id)||(h=Ext.id(b)),e=Ext.cache[h],e&&e.el?(f=Ext.cache[h].el,f.dom=b):f=new d(b,!!e),f):b instanceof c?(b!=c.docEl&&b!=c.winEl&&(b.dom=a.getElementById(b.id)||b.dom),b):b.isComposite?b:Ext.isArray(b)?c.select(b):b===a?(c.docEl||(c.docEl=Ext.Object.chain(d.prototype),c.docEl.dom=a,c.docEl.id=Ext.id(a),c.addToCache(c.docEl)),c.docEl):b===window?(c.winEl||(c.winEl=Ext.Object.chain(d.prototype),c.winEl.dom=window,c.winEl.id=Ext.id(window),c.addToCache(c.winEl)),c.winEl):null},addToCache:function(a,b){return a&&Ext.addCacheEntry(b,a),a},addMethods:function(){this.override.apply(this,arguments)},mergeClsList:function(){var a,d={},e,f,g,h,i,j=[],k=!1;for(e=0,f=arguments.length;e<f;e++){a=arguments[e],Ext.isString(a)&&(a=a.replace(b,"").split(c));if(a)for(g=0,h=a.length;g<h;g++)i=a[g],d[i]||(e&&(k=!0),d[i]=!0)}for(i in d)j.push(i);return j.changed=k,j},removeCls:function(a,d){var e={},f,g,h,i=[],j=!1;if(a){Ext.isString(a)&&(a=a.replace(b,"").split(c));for(f=0,g=a.length;f<g;f++)e[a[f]]=!0}if(d){Ext.isString(d)&&(d=d.split(c));for(f=0,g=d.length;f<g;f++)h=d[f],e[h]&&(j=!0,delete e[h])}for(h in e)i.push(h);return i.changed=j,i},VISIBILITY:1,DISPLAY:2,OFFSETS:3,ASCLASS:4},constructor:function(b,c){var d=this,e=typeof b=="string"?a.getElementById(b):b,f;if(!e)return null;f=e.id;if(!c&&f&&Ext.cache[f])return Ext.cache[f].el;d.dom=e,d.id=f||Ext.id(e),d.self.addToCache(d)},set:function(a,b){var c=this.dom,d,e;for(d in a)a.hasOwnProperty(d)&&(e=a[d],d=="style"?this.applyStyles(e):d=="cls"?c.className=e:b!==!1?e===undefined?c.removeAttribute(d):c.setAttribute(d,e):c[d]=e);return this},defaultUnit:"px",is:function(a){return Ext.DomQuery.is(this.dom,a)},getValue:function(a){var b=this.dom.value;return a?parseInt(b,10):b},remove:function(){var a=this,b=a.dom;b&&(Ext.removeNode(b),delete a.dom)},contains:function(a){if(!a)return!1;var b=this,c=a.dom||a;return c===b.dom||Ext.dom.AbstractElement.isAncestor(b.dom,c)},getAttribute:function(a,b){var c=this.dom;return c.getAttributeNS(b,a)||c.getAttribute(b+":"+a)||c.getAttribute(a)||c[a]},update:function(a){return this.dom&&(this.dom.innerHTML=a),this},setHTML:function(a){return this.dom&&(this.dom.innerHTML=a),this},getHTML:function(){return this.dom?this.dom.innerHTML:""},hide:function(){return this.setVisible(!1),this},show:function(){return this.setVisible(!0),this},setVisible:function(a,b){var c=this,d=c.self,e=c.getVisibilityMode(),f=Ext.baseCSSPrefix;switch(e){case d.VISIBILITY:c.removeCls([f+"hidden-display",f+"hidden-offsets"]),c[a?"removeCls":"addCls"](f+"hidden-visibility");break;case d.DISPLAY:c.removeCls([f+"hidden-visibility",f+"hidden-offsets"]),c[a?"removeCls":"addCls"](f+"hidden-display");break;case d.OFFSETS:c.removeCls([f+"hidden-visibility",f+"hidden-display"]),c[a?"removeCls":"addCls"](f+"hidden-offsets")}return c},getVisibilityMode:function(){var a=(this.$cache||this.getCache()).data,b=a.visibilityMode;return b===undefined&&(a.visibilityMode=b=this.self.DISPLAY),b},setVisibilityMode:function(a){return(this.$cache||this.getCache()).data.visibilityMode=a,this},getCache:function(){var a=this,b=a.dom.id||Ext.id(a.dom);return a.$cache=Ext.cache[b]||Ext.addCacheEntry(b,null,a.dom),a.$cache}},function(){var b=this;Ext.getDetachedBody=function(){var c=b.detachedBodyEl;return c||(c=a.createElement("div"),b.detachedBodyEl=c=new b.Fly(c),c.isDetachedBody=!0),c},Ext.getElementById=function(c){var e=a.getElementById(c),f;return!e&&(f=b.detachedBodyEl)&&(e=f.dom.querySelector("#"+Ext.escapeId(c))),e},Ext.get=function(a){return Ext.dom.Element.get(a)},this.addStatics({Fly:new Ext.Class({extend:b,isFly:!0,constructor:function(a){this.dom=a},attach:function(a){return this.dom=a,this.$cache=a.id?Ext.cache[a.id]:null,this}}),_flyweights:{},fly:function(a,c){var e=null,f=b._flyweights;return c=c||"_global",a=Ext.getDom(a),a&&(e=f[c]||(f[c]=new b.Fly),e.dom=a,e.$cache=a.id?Ext.cache[a.id]:null),e}}),Ext.fly=function(){return b.fly.apply(b,arguments)},function(b){b.destroy=b.remove,a.querySelector?b.getById=function(b,c){var d=a.getElementById(b)||this.dom.querySelector("#"+Ext.escapeId(b));return c?d:d?Ext.get(d):null}:b.getById=function(b,c){var d=a.getElementById(b);return c?d:d?Ext.get(d):null}}(this.prototype)})}(),Ext.dom.AbstractElement.addInheritableStatics({unitRe:/\d+(px|em|%|en|ex|pt|in|cm|mm|pc)$/i,camelRe:/(-[a-z])/gi,cssRe:/([a-z0-9\-]+)\s*:\s*([^;\s]+(?:\s*[^;\s]+)*);?/gi,opacityRe:/alpha\(opacity=(.*)\)/i,propertyCache:{},defaultUnit:"px",borders:{l:"border-left-width",r:"border-right-width",t:"border-top-width",b:"border-bottom-width"},paddings:{l:"padding-left",r:"padding-right",t:"padding-top",b:"padding-bottom"},margins:{l:"margin-left",r:"margin-right",t:"margin-top",b:"margin-bottom"},addUnits:function(a,b){return typeof a=="number"?a+(b||this.defaultUnit||"px"):a===""||a=="auto"||a===undefined||a===null?a||"":this.unitRe.test(a)?a:a||""},isAncestor:function(a,b){var c=!1;a=Ext.getDom(a),b=Ext.getDom(b);if(a&&b){if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(b)&16);while(b=b.parentNode)c=b==a||c}return c},parseBox:function(a){typeof a!="string"&&(a=a.toString());var b=a.split(" "),c=b.length;return c==1?b[1]=b[2]=b[3]=b[0]:c==2?(b[2]=b[0],b[3]=b[1]):c==3&&(b[3]=b[1]),{top:parseFloat(b[0])||0,right:parseFloat(b[1])||0,bottom:parseFloat(b[2])||0,left:parseFloat(b[3])||0}},unitizeBox:function(a,b){var c=this.addUnits,d=this.parseBox(a);return c(d.top,b)+" "+c(d.right,b)+" "+c(d.bottom,b)+" "+c(d.left,b)},camelReplaceFn:function(a,b){return b.charAt(1).toUpperCase()},normalize:function(a){return a=="float"&&(a=Ext.supports.Float?"cssFloat":"styleFloat"),this.propertyCache[a]||(this.propertyCache[a]=a.replace(this.camelRe,this.camelReplaceFn))},getDocumentHeight:function(){return Math.max(Ext.isStrict?document.documentElement.scrollHeight:document.body.scrollHeight,this.getViewportHeight())},getDocumentWidth:function(){return Math.max(Ext.isStrict?document.documentElement.scrollWidth:document.body.scrollWidth,this.getViewportWidth())},getViewportHeight:function(){return window.innerHeight},getViewportWidth:function(){return window.innerWidth},getViewSize:function(){return{width:window.innerWidth,height:window.innerHeight}},getOrientation:function(){return Ext.supports.OrientationChange?window.orientation==0?"portrait":"landscape":window.innerHeight>window.innerWidth?"portrait":"landscape"},fromPoint:function(a,b){return Ext.get(document.elementFromPoint(a,b))},parseStyles:function(a){var b={},c=this.cssRe,d;if(a){c.lastIndex=0;while(d=c.exec(a))b[d[1]]=d[2]}return b}}),function(){function g(a,b,c){return function(){a.selectionStart=b,a.selectionEnd=c}}var a=document,b=Ext.dom.AbstractElement,c=null,d=a.compatMode=="CSS1Compat",e,f=function(a){return e||(e=new b.Fly),e.attach(a),e};!("activeElement"in a)&&a.addEventListener&&a.addEventListener("focus",function(b){b&&b.target&&(c=b.target==a?null:b.target)},!0),b.addInheritableStatics({getActiveElement:function(){return a.activeElement||c},getRightMarginFixCleaner:function(b){var d=Ext.supports,e=d.DisplayChangeInputSelectionBug,f=d.DisplayChangeTextAreaSelectionBug,i,j,k,l;if(e||f){i=a.activeElement||c,j=i&&i.tagName;if(f&&j=="TEXTAREA"||e&&j=="INPUT"&&i.type=="text")if(Ext.dom.Element.isAncestor(b,i)){k=i.selectionStart,l=i.selectionEnd;if(Ext.isNumber(k)&&Ext.isNumber(l))return g(i,k,l)}}return Ext.emptyFn},getViewWidth:function(a){return a?Ext.dom.Element.getDocumentWidth():Ext.dom.Element.getViewportWidth()},getViewHeight:function(a){return a?Ext.dom.Element.getDocumentHeight():Ext.dom.Element.getViewportHeight()},getDocumentHeight:function(){return Math.max(d?a.documentElement.scrollHeight:a.body.scrollHeight,Ext.dom.Element.getViewportHeight())},getDocumentWidth:function(){return Math.max(d?a.documentElement.scrollWidth:a.body.scrollWidth,Ext.dom.Element.getViewportWidth())},getViewportHeight:function(){return Ext.isIE?Ext.isStrict?a.documentElement.clientHeight:a.body.clientHeight:self.innerHeight},getViewportWidth:function(){return!Ext.isStrict&&!Ext.isOpera?a.body.clientWidth:Ext.isIE?a.documentElement.clientWidth:self.innerWidth},getY:function(a){return Ext.dom.Element.getXY(a)[1]},getX:function(a){return Ext.dom.Element.getXY(a)[0]},getXY:function(b){var c=a.body,d=a.documentElement,e=0,g=0,h=[0,0],i=Math.round,j,k;b=Ext.getDom(b);if(b!=a&&b!=c){if(Ext.isIE)try{j=b.getBoundingClientRect(),g=d.clientTop||c.clientTop,e=d.clientLeft||c.clientLeft}catch(l){j={left:0,top:0}}else j=b.getBoundingClientRect();k=f(document).getScroll(),h=[i(j.left+k.left-e),i(j.top+k.top-g)]}return h},setXY:function(a,b){(a=Ext.fly(a,"_setXY")).position();var c=a.translatePoints(b),d=a.dom.style,e;for(e in c)isNaN(c[e])||(d[e]=c[e]+"px")},setX:function(a,b){Ext.dom.Element.setXY(a,[b,!1])},setY:function(a,b){Ext.dom.Element.setXY(a,[!1,b])},serializeForm:function(a){var b=a.elements||(document.forms[a]||Ext.getDom(a)).elements,c=!1,d=encodeURIComponent,e="",f=b.length,g,h,i,j,k,l,m,n,o;for(l=0;l<f;l++){g=b[l],h=g.name,i=g.type,j=g.options;if(!g.disabled&&h)if(/select-(one|multiple)/i.test(i)){n=j.length;for(m=0;m<n;m++)o=j[m],o.selected&&(k=o.hasAttribute?o.hasAttribute("value"):o.getAttributeNode("value").specified,e+=Ext.String.format("{0}={1}&",d(h),d(k?o.value:o.text)))}else/file|undefined|reset|button/i.test(i)||(!/radio|checkbox/i.test(i)||!!g.checked)&&(i!="submit"||!c)&&(e+=d(h)+"="+d(g.value)+"&",c=/submit/i.test(i))}return e.substr(0,e.length-1)}})}(),Ext.dom.AbstractElement.override({getAnchorXY:function(a,b,c){a=(a||"tl").toLowerCase(),c=c||{};var d=this,e=d.dom==document.body||d.dom==document,f=c.width||e?window.innerWidth:d.getWidth(),g=c.height||e?window.innerHeight:d.getHeight(),h,i=Math.round,j=d.getXY(),k=e?0:b?0:j[0],l=e?0:b?0:j[1],m={c:[i(f*.5),i(g*.5)],t:[i(f*.5),0],l:[0,i(g*.5)],r:[f,i(g*.5)],b:[i(f*.5),g],tl:[0,0],bl:[0,g],br:[f,g],tr:[f,0]};return h=m[a],[h[0]+k,h[1]+l]},alignToRe:/^([a-z]+)-([a-z]+)(\?)?$/,getAlignToXY:function(a,b,c,d){d=!!d,a=Ext.get(a),c=c||[0,0],!b||b=="?"?b="tl-bl?":!/-/.test(b)&&b!==""&&(b="tl-"+b),b=b.toLowerCase();var e=this,f=b.match(this.alignToRe),g=window.innerWidth,h=window.innerHeight,i="",j="",k,l,m,n,o,p,q,r,s,t,u,v,w,x;if(!f)throw"Element.alignTo with an invalid alignment "+b;return i=f[1],j=f[2],x=!!f[3],k=e.getAnchorXY(i,!0),l=a.getAnchorXY(j,d),m=l[0]-k[0]+c[0],n=l[1]-k[1]+c[1],x&&(u=e.getWidth(),v=e.getHeight(),w=a.getPageBox(),r=i.charAt(0),q=i.charAt(i.length-1),t=j.charAt(0),s=j.charAt(j.length-1),p=r=="t"&&t=="b"||r=="b"&&t=="t",o=q=="r"&&s=="l"||q=="l"&&s=="r",m+u>g&&(m=o?w.left-u:g-u),m<0&&(m=o?w.right:0),n+v>h&&(n=p?w.top-v:h-v),n<0&&(n=p?w.bottom:0)),[m,n]},getAnchor:function(){var a=(this.$cache||this.getCache()).data,b;if(!this.dom)return;return b=a._anchor,b||(b=a._anchor={}),b},adjustForConstraints:function(a,b){var c=this.getConstrainVector(b,a);return c&&(a[0]+=c[0],a[1]+=c[1]),a}}),Ext.dom.AbstractElement.addMethods({appendChild:function(a){return Ext.get(a).appendTo(this)},appendTo:function(a){return Ext.getDom(a).appendChild(this.dom),this},insertBefore:function(a){return a=Ext.getDom(a),a.parentNode.insertBefore(this.dom,a),this},insertAfter:function(a){return a=Ext.getDom(a),a.parentNode.insertBefore(this.dom,a.nextSibling),this},insertFirst:function(a,b){return a=a||{},a.nodeType||a.dom||typeof a=="string"?(a=Ext.getDom(a),this.dom.insertBefore(a,this.dom.firstChild),b?a:Ext.get(a)):this.createChild(a,this.dom.firstChild,b)},insertSibling:function(a,b,c){var d=this,e=(b||"before").toLowerCase()=="after",f,g,h,i;if(Ext.isArray(a)){g=d,h=a.length;for(i=0;i<h;i++)f=Ext.fly(g,"_internal").insertSibling(a[i],b,c),e&&(g=f);return f}return a=a||{},a.nodeType||a.dom?(f=d.dom.parentNode.insertBefore(Ext.getDom(a),e?d.dom.nextSibling:d.dom),c||(f=Ext.get(f))):e&&!d.dom.nextSibling?f=Ext.core.DomHelper.append(d.dom.parentNode,a,!c):f=Ext.core.DomHelper[e?"insertAfter":"insertBefore"](d.dom,a,!c),f},replace:function(a){return a=Ext.get(a),this.insertBefore(a),a.remove(),this},replaceWith:function(a){var b=this;return a.nodeType||a.dom||typeof a=="string"?(a=Ext.get(a),b.dom.parentNode.insertBefore(a,b.dom)):a=Ext.core.DomHelper.insertBefore(b.dom,a),delete Ext.cache[b.id],Ext.removeNode(b.dom),b.id=Ext.id(b.dom=a),Ext.dom.AbstractElement.addToCache(b.isFlyweight?new Ext.dom.AbstractElement(b.dom):b),b},createChild:function(a,b,c){return a=a||{tag:"div"},b?Ext.core.DomHelper.insertBefore(b,a,c!==!0):Ext.core.DomHelper[this.dom.firstChild?"append":"insertFirst"](this.dom,a,c!==!0)},wrap:function(a,b){var c=Ext.core.DomHelper.insertBefore(this.dom,a||{tag:"div"},!b),d=c.dom||c;return d.appendChild(this.dom),c},insertHtml:function(a,b,c){var d=Ext.core.DomHelper.insertHtml(a,this.dom,b);return c?Ext.get(d):d}}),function(){var a=Ext.dom.AbstractElement;a.override({getX:function(a){return this.getXY(a)[0]},getY:function(a){return this.getXY(a)[1]},getXY:function(){var a=window.webkitConvertPointFromNodeToPage(this.dom,new WebKitPoint(0,0));return[a.x,a.y]},getOffsetsTo:function(a){var b=this.getXY(),c=Ext.fly(a,"_internal").getXY();return[b[0]-c[0],b[1]-c[1]]},setX:function(a){return this.setXY([a,this.getY()])},setY:function(a){return this.setXY([this.getX(),a])},setLeft:function(b){return this.setStyle("left",a.addUnits(b)),this},setTop:function(b){return this.setStyle("top",a.addUnits(b)),this},setRight:function(b){return this.setStyle("right",a.addUnits(b)),this},setBottom:function(b){return this.setStyle("bottom",a.addUnits(b)),this},setXY:function(a){var b=this,c,d,e;arguments.length>1&&(a=[a,arguments[1]]),c=b.translatePoints(a),d=b.dom.style;for(e in c){if(!c.hasOwnProperty(e))continue;isNaN(c[e])||(d[e]=c[e]+"px")}return b},getLeft:function(a){return parseInt(this.getStyle("left"),10)||0},getRight:function(a){return parseInt(this.getStyle("right"),10)||0},getTop:function(a){return parseInt(this.getStyle("top"),10)||0},getBottom:function(a){return parseInt(this.getStyle("bottom"),10)||0},translatePoints:function(a,b){b=isNaN(a[1])?b:a[1],a=isNaN(a[0])?a:a[0];var c=this,d=c.isStyle("position","relative"),e=c.getXY(),f=parseInt(c.getStyle("left"),10),g=parseInt(c.getStyle("top"),10);return f=isNaN(f)?d?0:c.dom.offsetLeft:f,g=isNaN(g)?d?0:c.dom.offsetTop:g,{left:a-e[0]+f,top:b-e[1]+g}},setBox:function(a){var b=this,c=a.width,d=a.height,e=a.top,f=a.left;return f!==undefined&&b.setLeft(f),e!==undefined&&b.setTop(e),c!==undefined&&b.setWidth(c),d!==undefined&&b.setHeight(d),this},getBox:function(a,b){var c=this,d=c.dom,e=d.offsetWidth,f=d.offsetHeight,g,h,i,j,k,l;return b?a?g=[0,0]:g=[parseInt(c.getStyle("left"),10)||0,parseInt(c.getStyle("top"),10)||0]:g=c.getXY(),a?(i=c.getBorderWidth.call(c,"l")+c.getPadding.call(c,"l"),j=c.getBorderWidth.call(c,"r")+c.getPadding.call(c,"r"),k=c.getBorderWidth.call(c,"t")+c.getPadding.call(c,"t"),l=c.getBorderWidth.call(c,"b")+c.getPadding.call(c,"b"),h={x:g[0]+i,y:g[1]+k,0:g[0]+i,1:g[1]+k,width:e-(i+j),height:f-(k+l)}):h={x:g[0],y:g[1],0:g[0],1:g[1],width:e,height:f},h.left=h.x,h.top=h.y,h.right=h.x+h.width,h.bottom=h.y+h.height,h},getPageBox:function(a){var b=this,c=b.dom,d=c.offsetWidth,e=c.offsetHeight,f=b.getXY(),g=f[1],h=f[0]+d,i=f[1]+e,j=f[0];return c?a?new Ext.util.Region(g,h,i,j):{left:j,top:g,width:d,height:e,right:h,bottom:i}:new Ext.util.Region}})}(),function(){var a=Ext.dom.AbstractElement,b=document.defaultView,c=Ext.Array,d=/^\s+|\s+$/g,e=/\w/g,f=/\s+/,g=/^(?:transparent|(?:rgba[(](?:\s*\d+\s*[,]){3}\s*0\s*[)]))$/i,h=Ext.supports.ClassList,i="padding",j="margin",k="border",l="-left",m="-right",n="-top",o="-bottom",p="-width",q={l:k+l+p,r:k+m+p,t:k+n+p,b:k+o+p},r={l:i+l,r:i+m,t:i+n,b:i+o},s={l:j+l,r:j+m,t:j+n,b:j+o};a.override({styleHooks:{},addStyles:function(a,b){var c=0,d=(a||"").match(e),f,g=d.length,h,i=[];if(g==1)c=Math.abs(parseFloat(this.getStyle(b[d[0]]))||0);else if(g){for(f=0;f<g;f++)h=d[f],i.push(b[h]);i=this.getStyle(i);for(f=0;f<g;f++)h=d[f],c+=Math.abs(parseFloat(i[b[h]])||0)}return c},addCls:h?function(a){var b=this,c=b.dom,e,g,h,i,j;typeof a=="string"&&(a=a.replace(d,"").split(f));if(c&&a&&!!(i=a.length))if(!c.className)c.className=a.join(" ");else{e=c.classList;for(h=0;h<i;++h)j=a[h],j&&(e.contains(j)||(g?g.push(j):(g=c.className.replace(d,""),g=g?[g,j]:[j])));g&&(c.className=g.join(" "))}return b}:function(a){var b=this,c=b.dom,d,e;return c&&a&&a.length&&(e=Ext.Element.mergeClsList(c.className,a),e.changed&&(c.className=e.join(" "))),b},removeCls:function(a){var b=this,c=b.dom,e,g;return typeof a=="string"&&(a=a.replace(d,"").split(f)),c&&c.className&&a&&!!(e=a.length)&&(e==1&&h?a[0]&&c.classList.remove(a[0]):(g=Ext.Element.removeCls(c.className,a),g.changed&&(c.className=g.join(" ")))),b},radioCls:function(a){var b=this.dom.parentNode.childNodes,c,d,e;a=Ext.isArray(a)?a:[a];for(d=0,e=b.length;d<e;d++)c=b[d],c&&c.nodeType==1&&Ext.fly(c,"_internal").removeCls(a);return this.addCls(a)},toggleCls:h?function(a){var b=this,c=b.dom;return c&&(a=a.replace(d,""),a&&c.classList.toggle(a)),b}:function(a){var b=this;return b.hasCls(a)?b.removeCls(a):b.addCls(a)},hasCls:h?function(a){var b=this.dom;return b&&a?b.classList.contains(a):!1}:function(a){var b=this.dom;return b?a&&(" "+b.className+" ").indexOf(" "+a+" ")!=-1:!1},replaceCls:function(a,b){return this.removeCls(a).addCls(b)},isStyle:function(a,b){return this.getStyle(a)==b},getStyle:function(b,c){var d=this,e=d.dom,f=typeof b!="string",g=d.styleHooks,h=b,i=h,j=1,k,l,m,n,o,p,q;if(f){m={},h=i[0],q=0;if(!(j=i.length))return m}if(!e||e.documentElement)return m||"";k=e.style,c?p=k:(p=e.ownerDocument.defaultView.getComputedStyle(e,null),p||(c=!0,p=k));do{n=g[h],n||(g[h]=n={name:a.normalize(h)}),n.get?o=n.get(e,d,c,p):(l=n.name,o=p[l]);if(!f)return o;m[h]=o,h=i[++q]}while(q<j);return m},getStyles:function(){var a=Ext.Array.slice(arguments),b=a.length,c;return b&&typeof a[b-1]=="boolean"&&(c=a.pop()),this.getStyle(a,c)},isTransparent:function(a){var b=this.getStyle(a);return b?g.test(b):!1},setStyle:function(b,c){var d=this,e=d.dom,f=d.styleHooks,g=e.style,h=b,i;if(typeof h=="string")i=f[h],i||(f[h]=i={name:a.normalize(h)}),c=c==null?"":c,i.set?i.set(e,c,d):g[i.name]=c,i.afterSet&&i.afterSet(e,c,d);else for(h in b)b.hasOwnProperty(h)&&(i=f[h],i||(f[h]=i={name:a.normalize(h)}),c=b[h],c=c==null?"":c,i.set?i.set(e,c,d):g[i.name]=c,i.afterSet&&i.afterSet(e,c,d));return d},getHeight:function(a){var b=this.dom,c=a?b.clientHeight-this.getPadding("tb"):b.offsetHeight;return c>0?c:0},getWidth:function(a){var b=this.dom,c=a?b.clientWidth-this.getPadding("lr"):b.offsetWidth;return c>0?c:0},setWidth:function(b){var c=this;return c.dom.style.width=a.addUnits(b),c},setHeight:function(b){var c=this;return c.dom.style.height=a.addUnits(b),c},getBorderWidth:function(a){return this.addStyles(a,q)},getPadding:function(a){return this.addStyles(a,r)},margins:s,applyStyles:function(b){if(b){var c,d,e=this.dom;typeof b=="function"&&(b=b.call());if(typeof b=="string"){b=Ext.util.Format.trim(b).split(/\s*(?::|;)\s*/);for(c=0,d=b.length;c<d;)e.style[a.normalize(b[c++])]=b[c++]}else typeof b=="object"&&this.setStyle(b)}},setSize:function(b,c){var d=this,e=d.dom.style;return Ext.isObject(b)&&(c=b.height,b=b.width),e.width=a.addUnits(b),e.height=a.addUnits(c),d},getViewSize:function(){var b=document,c=this.dom;return c==b||c==b.body?{width:a.getViewportWidth(),height:a.getViewportHeight()}:{width:c.clientWidth,height:c.clientHeight}},getSize:function(a){var b=this.dom;return{width:Math.max(0,a?b.clientWidth-this.getPadding("lr"):b.offsetWidth),height:Math.max(0,a?b.clientHeight-this.getPadding("tb"):b.offsetHeight)}},repaint:function(){var a=this.dom;return this.addCls(Ext.baseCSSPrefix+"repaint"),setTimeout(function(){Ext.fly(a).removeCls(Ext.baseCSSPrefix+"repaint")},1),this},getMargin:function(a){var b=this,c={t:"top",l:"left",r:"right",b:"bottom"},d,e,f;if(!a){f=[];for(d in b.margins)b.margins.hasOwnProperty(d)&&f.push(b.margins[d]);e=b.getStyle(f);if(e&&typeof e=="object")for(d in b.margins)b.margins.hasOwnProperty(d)&&(e[c[d]]=parseFloat(e[b.margins[d]])||0);return e}return b.addStyles.call(b,a,b.margins)},mask:function(a,b,c){var d=this,e=d.dom,f=(d.$cache||d.getCache()).data,g=f.mask,h,i,j="",k=Ext.baseCSSPrefix;d.addCls(k+"masked"),d.getStyle("position")=="static"&&d.addCls(k+"masked-relative"),g&&g.remove(),b&&typeof b=="string"?j=" "+b:j=" "+k+"mask-gray",h=d.createChild({cls:k+"mask"+(c!==!1?"":" "+k+"mask-gray"),html:a?'<div class="'+(b||k+"mask-message")+'">'+a+"</div>":""}),i=d.getSize(),f.mask=h,e===document.body&&(i.height=window.innerHeight,d.orientationHandler&&Ext.EventManager.unOrientationChange(d.orientationHandler,d),d.orientationHandler=function(){i=d.getSize(),i.height=window.innerHeight,h.setSize(i)},Ext.EventManager.onOrientationChange(d.orientationHandler,d)),h.setSize(i),Ext.is.iPad&&Ext.repaint()},unmask:function(){var a=this,b=(a.$cache||a.getCache()).data,c=b.mask,d=Ext.baseCSSPrefix;c&&(c.remove(),delete b.mask),a.removeCls([d+"masked",d+"masked-relative"]),a.dom===document.body&&(Ext.EventManager.unOrientationChange(a.orientationHandler,a),delete a.orientationHandler)}}),a.populateStyleMap=function(b,c){var d=["margin-","padding-","border-width-"],e=["before","after"],f,g,h,i;for(f=d.length;f--;)for(i=2;i--;)g=d[f]+e[i],b[a.normalize(g)]=b[g]={name:a.normalize(d[f]+c[i])}},Ext.onReady(function(){function i(a,b,c,d){var e=d[this.name]||"";return g.test(e)?"transparent":e}function j(a,b,c,d){var e=d.marginRight,f,g;return e!="0px"&&(f=a.style,g=f.display,f.display="inline-block",e=(c?d:a.ownerDocument.defaultView.getComputedStyle(a,null)).marginRight,f.display=g),e}function k(b,c,d,e){var f=e.marginRight,g,h,i;return f!="0px"&&(g=b.style,h=a.getRightMarginFixCleaner(b),i=g.display,g.display="inline-block",f=(d?e:b.ownerDocument.defaultView.getComputedStyle(b,"")).marginRight,g.display=i,h()),f}var b=Ext.supports,c,d,e,f,h;c=a.prototype.styleHooks,a.populateStyleMap(c,["left","right"]),b.init&&b.init(),b.RightMargin||(c.marginRight=c["margin-right"]={name:"marginRight",get:b.DisplayChangeInputSelectionBug||b.DisplayChangeTextAreaSelectionBug?k:j});if(!b.TransparentColor){d=["background-color","border-color","color","outline-color"];for(e=d.length;e--;)f=d[e],h=a.normalize(f),c[f]=c[h]={name:h,get:i}}})}(),Ext.dom.AbstractElement.override({findParent:function(a,b,c){var d=this.dom,e=document.documentElement,f=0,g;b=b||50,isNaN(b)&&(g=Ext.getDom(b),b=Number.MAX_VALUE);while(d&&d.nodeType==1&&f<b&&d!=e&&d!=g){if(Ext.DomQuery.is(d,a))return c?Ext.get(d):d;f++,d=d.parentNode}return null},findParentNode:function(a,b,c){var d=Ext.fly(this.dom.parentNode,"_internal");return d?d.findParent(a,b,c):null},up:function(a,b){return this.findParentNode(a,b,!0)},select:function(a,b){return Ext.dom.Element.select(a,this.dom,b)},query:function(a){return Ext.DomQuery.select(a,this.dom)},down:function(a,b){var c=Ext.DomQuery.selectNode(a,this.dom);return b?c:Ext.get(c)},child:function(a,b){var c,d=this,e;return e=Ext.id(d.dom),e=e.replace(/[\.:]/g,"\\$0"),c=Ext.DomQuery.selectNode("#"+e+" > "+a,d.dom),b?c:Ext.get(c)},parent:function(a,b){return this.matchNode("parentNode","parentNode",a,b)},next:function(a,b){return this.matchNode("nextSibling","nextSibling",a,b)},prev:function(a,b){return this.matchNode("previousSibling","previousSibling",a,b)},first:function(a,b){return this.matchNode("nextSibling","firstChild",a,b)},last:function(a,b){return this.matchNode("previousSibling","lastChild",a,b)},matchNode:function(a,b,c,d){if(!this.dom)return null;var e=this.dom[b];while(e){if(e.nodeType==1&&(!c||Ext.DomQuery.is(e,c)))return d?e:Ext.get(e);e=e[a]}return null},isAncestor:function(a){return this.self.isAncestor.call(this.self,this.dom,a)}}),function(){var a="afterbegin",b="afterend",c="beforebegin",d="beforeend",e="<table>",f="</table>",g=e+"<tbody>",h="</tbody>"+f,i=g+"<tr>",j="</tr>"+h,k=document.createElement("div"),l=["BeforeBegin","previousSibling"],m=["AfterEnd","nextSibling"],n={beforebegin:l,afterend:m},o={beforebegin:l,afterend:m,afterbegin:["AfterBegin","firstChild"],beforeend:["BeforeEnd","lastChild"]};Ext.define("Ext.dom.Helper",{extend:"Ext.dom.AbstractHelper",tableRe:/^table|tbody|tr|td$/i,tableElRe:/td|tr|tbody/i,useDom:!1,createDom:function(a,b){var c,d=document,e,f,g,h,i,j;if(Ext.isArray(a)){c=d.createDocumentFragment();for(i=0,j=a.length;i<j;i++)this.createDom(a[i],c)}else if(typeof a=="string")c=d.createTextNode(a);else{c=d.createElement(a.tag||"div"),e=!!c.setAttribute;for(f in a)this.confRe.test(f)||(g=a[f],f=="cls"?c.className=g:e?c.setAttribute(f,g):c[f]=g);Ext.DomHelper.applyStyles(c,a.style),(h=a.children||a.cn)?this.createDom(h,c):a.html&&(c.innerHTML=a.html)}return b&&b.appendChild(c),c},ieTable:function(a,b,c,d){k.innerHTML=[b,c,d].join("");var e=-1,f=k,g;while(++e<a)f=f.firstChild;g=f.nextSibling;if(g){f=document.createDocumentFragment();while(g)f.appendChild(g),g=g.nextSibling}return f},insertIntoTable:function(k,l,m,n){var o,p,q=l==c,r=l==a,s=l==d,t=l==b;if(k=="td"&&(r||s)||!this.tableElRe.test(k)&&(q||t))return null;p=q?m:t?m.nextSibling:r?m.firstChild:null;if(q||t)m=m.parentNode;return k=="td"||k=="tr"&&(s||r)?o=this.ieTable(4,i,n,j):k=="tbody"&&(s||r)||k=="tr"&&(q||t)?o=this.ieTable(3,g,n,h):o=this.ieTable(2,e,n,f),m.insertBefore(o,p),o},createContextualFragment:function(a){var b=document.createDocumentFragment(),c,d;k.innerHTML=a,d=k.childNodes,c=d.length;while(c--)b.appendChild(d[0]);return b},applyStyles:function(a,b){b&&(a=Ext.fly(a),typeof b=="function"&&(b=b.call()),typeof b=="string"&&(b=Ext.dom.Element.parseStyles(b)),typeof b=="object"&&a.setStyle(b))},createHtml:function(a){return this.markup(a)},doInsert:function(a,b,c,d,e,f){a=a.dom||Ext.getDom(a);var g;return this.useDom?(g=this.createDom(b,null),f?a.appendChild(g):(e=="firstChild"?a:a.parentNode).insertBefore(g,a[e]||a)):g=this.insertHtml(d,a,this.markup(b)),c?Ext.get(g,!0):g},overwrite:function(a,b,c){var d;a=Ext.getDom(a),b=this.markup(b);if(Ext.isIE&&this.tableRe.test(a.tagName)){while(a.firstChild)a.removeChild(a.firstChild);return b?(d=this.insertHtml("afterbegin",a,b),c?Ext.get(d):d):null}return a.innerHTML=b,c?Ext.get(a.firstChild):a.firstChild},insertHtml:function(b,d,e){var f,g,h,i,j;b=b.toLowerCase();if(!d.insertAdjacentHTML)return d.nodeType===3&&(b=b==="afterbegin"?"beforebegin":b,b=b==="beforeend"?"afterend":b),g=Ext.supports.CreateContextualFragment?d.ownerDocument.createRange():undefined,i="setStart"+(this.endRe.test(b)?"After":"Before"),n[b]?(g?(g[i](d),j=g.createContextualFragment(e)):j=this.createContextualFragment(e),d.parentNode.insertBefore(j,b==c?d:d.nextSibling),d[(b==c?"previous":"next")+"Sibling"]):(h=(b==a?"first":"last")+"Child",d.firstChild?(g?(g[i](d[h]),j=g.createContextualFragment(e)):j=this.createContextualFragment(e),b==a?d.insertBefore(j,d.firstChild):d.appendChild(j)):d.innerHTML=e,d[h]);if(Ext.isIE&&this.tableRe.test(d.tagName)&&(j=this.insertIntoTable(d.tagName.toLowerCase(),b,d,e)))return j;if(f=o[b])return d.insertAdjacentHTML(f[0],e),d[f[1]]},createTemplate:function(a){var b=this.markup(a);return new Ext.Template(b)}},function(){Ext.ns("Ext.core"),Ext.DomHelper=Ext.core.DomHelper=new this})}(),Ext.ns("Ext.core"),Ext.dom.Query=Ext.core.DomQuery=Ext.DomQuery=function(){function child(a,b){var c=0,d=a.firstChild;while(d){if(d.nodeType==1&&++c==b)return d;d=d.nextSibling}return null}function next(a){while((a=a.nextSibling)&&a.nodeType!=1);return a}function prev(a){while((a=a.previousSibling)&&a.nodeType!=1);return a}function children(a){var b=a.firstChild,c=-1,d;while(b)d=b.nextSibling,b.nodeType==3&&!nonSpace.test(b.nodeValue)?a.removeChild(b):b.nodeIndex=++c,b=d;return this}function byClassName(a,b){b=unescapeCssSelector(b);if(!b)return a;var c=[],d=-1,e,f;for(e=0,f;f=a[e];e++)(" "+f.className+" ").indexOf(b)!=-1&&(c[++d]=f);return c}function attrValue(a,b){return!a.tagName&&typeof a.length!="undefined"&&(a=a[0]),a?b=="for"?a.htmlFor:b=="class"||b=="className"?a.className:a.getAttribute(b)||a[b]:null}function getNodes(a,b,c){var d=[],e=-1,f,g,h,i,j,k,l,m,n;if(!a)return d;c=c||"*",typeof a.getElementsByTagName!="undefined"&&(a=[a]);if(!b)for(g=0,h;h=a[g];g++){f=h.getElementsByTagName(c);for(i=0,j;j=f[i];i++)d[++e]=j}else if(b=="/"||b==">"){l=c.toUpperCase();for(g=0,h,k;h=a[g];g++){k=h.childNodes;for(i=0,n;n=k[i];i++)if(n.nodeName==l||n.nodeName==c||c=="*")d[++e]=n}}else if(b=="+"){l=c.toUpperCase();for(g=0,m;m=a[g];g++){while((m=m.nextSibling)&&m.nodeType!=1);m&&(m.nodeName==l||m.nodeName==c||c=="*")&&(d[++e]=m)}}else if(b=="~"){l=c.toUpperCase();for(g=0,m;m=a[g];g++)while(m=m.nextSibling)if(m.nodeName==l||m.nodeName==c||c=="*")d[++e]=m}return d}function concat(a,b){if(b.slice)return a.concat(b);for(var c=0,d=b.length;c<d;c++)a[a.length]=b[c];return a}function byTag(a,b){if(a.tagName||a==document)a=[a];if(!b)return a;var c=[],d=-1,e,f;b=b.toLowerCase();for(e=0,f;f=a[e];e++)f.nodeType==1&&f.tagName.toLowerCase()==b&&(c[++d]=f);return c}function byId(a,b){b=unescapeCssSelector(b);if(a.tagName||a==document)a=[a];if(!b)return a;var c=[],d=-1,e,f;for(e=0,f;f=a[e];e++)if(f&&f.id==b)return c[++d]=f,c;return c}function byAttribute(a,b,c,d,e){var f=[],g=-1,h=e=="{",i=Ext.DomQuery.operators[d],j,k,l,m,n;c=unescapeCssSelector(c);for(m=0,n;n=a[m];m++){if(n.nodeType!=1)continue;l||(k=Ext.DomQuery.isXml(n),l=!0),k?j=n.getAttribute(b):h?j=Ext.DomQuery.getStyle(n,b):b=="class"||b=="className"?j=n.className:b=="for"?j=n.htmlFor:b=="href"?j=n.getAttribute("href",2):j=n.getAttribute(b);if(i&&i(j,c)||!i&&j)f[++g]=n}return f}function byPseudo(a,b,c){return c=unescapeCssSelector(c),Ext.DomQuery.pseudos[b](a,c)}function nodupIEXml(a){var b=++key,c,d,e,f;a[0].setAttribute("_nodup",b),c=[a[0]];for(d=1,e=a.length;d<e;d++)f=a[d],!f.getAttribute("_nodup")!=b&&(f.setAttribute("_nodup",b),c[c.length]=f);for(d=0,e=a.length;d<e;d++)a[d].removeAttribute("_nodup");return c}function nodup(a){if(!a)return[];var b=a.length,c,d,e=a,f,g=-1,h,i;if(!b||typeof a.nodeType!="undefined"||b==1)return a;if(isIE&&typeof a[0].selectSingleNode!="undefined")return nodupIEXml(a);h=++key,a[0]._nodup=h;for(d=1;c=a[d];d++){if(c._nodup==h){e=[];for(i=0;i<d;i++)e[++g]=a[i];for(i=d+1;f=a[i];i++)f._nodup!=h&&(f._nodup=h,e[++g]=f);return e}c._nodup=h}return e}function quickDiffIEXml(a,b){var c=++key,d=[],e,f;for(e=0,f=a.length;e<f;e++)a[e].setAttribute("_qdiff",c);for(e=0,f=b.length;e<f;e++)b[e].getAttribute("_qdiff")!=c&&(d[d.length]=b[e]);for(e=0,f=a.length;e<f;e++)a[e].removeAttribute("_qdiff");return d}function quickDiff(a,b){var c=a.length,d=++key,e=[],f,g;if(!c)return b;if(isIE&&typeof a[0].selectSingleNode!="undefined")return quickDiffIEXml(a,b);for(f=0;f<c;f++)a[f]._qdiff=d;for(f=0,g=b.length;f<g;f++)b[f]._qdiff!=d&&(e[e.length]=b[f]);return e}function quickId(a,b,c,d){if(a==c){d=unescapeCssSelector(d);var e=c.ownerDocument||c;return e.getElementById(d)}return a=getNodes(a,b,"*"),byId(a,d)}var cache={},simpleCache={},valueCache={},nonSpace=/\S/,trimRe=/^\s+|\s+$/g,tplRe=/\{(\d+)\}/g,modeRe=/^(\s?[\/>+~]\s?|\s|$)/,tagTokenRe=/^(#)?([\w\-\*\\]+)/,nthRe=/(\d*)n\+?(\d*)/,nthRe2=/\D/,startIdRe=/^\s*\#/,isIE=window.ActiveXObject?!0:!1,key=30803,longHex=/\\([0-9a-fA-F]{6})/g,shortHex=/\\([0-9a-fA-F]{1,6})\s{0,1}/g,nonHex=/\\([^0-9a-fA-F]{1})/g,escapes=/\\/g,num,hasEscapes,longHexToChar=function(a,b){return String.fromCharCode(parseInt(b,16))},shortToLongHex=function(a,b){while(b.length<6)b="0"+b;return"\\"+b},charToLongHex=function(a,b){return num=b.charCodeAt(0).toString(16),num.length===1&&(num="0"+num),"\\0000"+num},unescapeCssSelector=function(a){return hasEscapes?a.replace(longHex,longHexToChar):a};return eval("var batch = 30803;"),{getStyle:function(a,b){return Ext.fly(a).getStyle(b)},compile:function(path,type){type=type||"select";var fn=["var f = function(root){\n var mode; ++batch; var n = root || document;\n"],mode,lastPath,matchers=Ext.DomQuery.matchers,matchersLn=matchers.length,modeMatch,lmode=path.match(modeRe),tokenMatch,matched,j,t,m;hasEscapes=path.indexOf("\\")>-1,hasEscapes&&(path=path.replace(shortHex,shortToLongHex).replace(nonHex,charToLongHex).replace(escapes,"\\\\")),lmode&&lmode[1]&&(fn[fn.length]='mode="'+lmode[1].replace(trimRe,"")+'";',path=path.replace(lmode[1],""));while(path.substr(0,1)=="/")path=path.substr(1);while(path&&lastPath!=path){lastPath=path,tokenMatch=path.match(tagTokenRe),type=="select"?tokenMatch?(tokenMatch[1]=="#"?fn[fn.length]='n = quickId(n, mode, root, "'+tokenMatch[2]+'");':fn[fn.length]='n = getNodes(n, mode, "'+tokenMatch[2]+'");',path=path.replace(tokenMatch[0],"")):path.substr(0,1)!="@"&&(fn[fn.length]='n = getNodes(n, mode, "*");'):tokenMatch&&(tokenMatch[1]=="#"?fn[fn.length]='n = byId(n, "'+tokenMatch[2]+'");':fn[fn.length]='n = byTag(n, "'+tokenMatch[2]+'");',path=path.replace(tokenMatch[0],""));while(!(modeMatch=path.match(modeRe))){matched=!1;for(j=0;j<matchersLn;j++){t=matchers[j],m=path.match(t.re);if(m){fn[fn.length]=t.select.replace(tplRe,function(a,b){return m[b]}),path=path.replace(m[0],""),matched=!0;break}}matched||Ext.Error.raise({sourceClass:"Ext.DomQuery",sourceMethod:"compile",msg:'Error parsing selector. Parsing failed at "'+path+'"'})}modeMatch[1]&&(fn[fn.length]='mode="'+modeMatch[1].replace(trimRe,"")+'";',path=path.replace(modeMatch[1],""))}return fn[fn.length]="return nodup(n);\n}",eval(fn.join("")),f},jsSelect:function(a,b,c){b=b||document,typeof b=="string"&&(b=document.getElementById(b));var d=a.split(","),e=[],f,g,h,i;for(f=0,g=d.length;f<g;f++)h=d[f].replace(trimRe,""),cache[h]||(cache[h]=Ext.DomQuery.compile(h,c),cache[h]||Ext.Error.raise({sourceClass:"Ext.DomQuery",sourceMethod:"jsSelect",msg:h+" is not a valid selector"})),i=cache[h](b),i&&i!=document&&(e=e.concat(i));return d.length>1?nodup(e):e},isXml:function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1},select:document.querySelectorAll?function(a,b,c){b=b||document;if(!Ext.DomQuery.isXml(b))try{return b.parentNode&&b.nodeType!==9&&a.indexOf(",")===-1&&!startIdRe.test(a)&&(a="#"+Ext.escapeId(Ext.id(b))+" "+a,b=b.parentNode),Ext.Array.toArray(b.querySelectorAll(a))}catch(d){}return Ext.DomQuery.jsSelect.call(this,a,b,c)}:function(a,b,c){return Ext.DomQuery.jsSelect.call(this,a,b,c)},selectNode:function(a,b){return Ext.DomQuery.select(a,b)[0]},selectValue:function(a,b,c){a=a.replace(trimRe,""),valueCache[a]||(valueCache[a]=Ext.DomQuery.compile(a,"select"));var d=valueCache[a](b),e;return d=d[0]?d[0]:d,typeof d.normalize=="function"&&d.normalize(),e=d&&d.firstChild?d.firstChild.nodeValue:null,e===null||e===undefined||e===""?c:e},selectNumber:function(a,b,c){var d=Ext.DomQuery.selectValue(a,b,c||0);return parseFloat(d)},is:function(a,b){typeof a=="string"&&(a=document.getElementById(a));var c=Ext.isArray(a),d=Ext.DomQuery.filter(c?a:[a],b);return c?d.length==a.length:d.length>0},filter:function(a,b,c){b=b.replace(trimRe,""),simpleCache[b]||(simpleCache[b]=Ext.DomQuery.compile(b,"simple"));var d=simpleCache[b](a);return c?quickDiff(d,a):d},matchers:[{re:/^\.([\w\-\\]+)/,select:'n = byClassName(n, " {1} ");'},{re:/^\:([\w\-]+)(?:\(((?:[^\s>\/]*|.*?))\))?/,select:'n = byPseudo(n, "{1}", "{2}");'},{re:/^(?:([\[\{])(?:@)?([\w\-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'},{re:/^#([\w\-\\]+)/,select:'n = byId(n, "{1}");'},{re:/^@([\w\-]+)/,select:'return {firstChild:{nodeValue:attrValue(n, "{1}")}};'}],operators:{"=":function(a,b){return a==b},"!=":function(a,b){return a!=b},"^=":function(a,b){return a&&a.substr(0,b.length)==b},"$=":function(a,b){return a&&a.substr(a.length-b.length)==b},"*=":function(a,b){return a&&a.indexOf(b)!==-1},"%=":function(a,b){return a%b==0},"|=":function(a,b){return a&&(a==b||a.substr(0,b.length+1)==b+"-")},"~=":function(a,b){return a&&(" "+a+" ").indexOf(" "+b+" ")!=-1}},pseudos:{"first-child":function(a){var b=[],c=-1,d,e,f;for(e=0;f=d=a[e];e++){while((d=d.previousSibling)&&d.nodeType!=1);d||(b[++c]=f)}return b},"last-child":function(a){var b=[],c=-1,d,e,f;for(e=0;f=d=a[e];e++){while((d=d.nextSibling)&&d.nodeType!=1);d||(b[++c]=f)}return b},"nth-child":function(a,b){var c=[],d=-1,e=nthRe.exec(b=="even"&&"2n"||b=="odd"&&"2n+1"||!nthRe2.test(b)&&"n+"+b||b),f=(e[1]||1)-0,g=e[2]-0,h,i,j,k,l;for(h=0;i=a[h];h++){l=i.parentNode;if(batch!=l._batch){j=0;for(k=l.firstChild;k;k=k.nextSibling)k.nodeType==1&&(k.nodeIndex=++j);l._batch=batch}if(f==1){if(g==0||i.nodeIndex==g)c[++d]=i}else(i.nodeIndex+g)%f==0&&(c[++d]=i)}return c},"only-child":function(a){var b=[],c=-1,d,e;for(d=0;e=a[d];d++)!prev(e)&&!next(e)&&(b[++c]=e);return b},empty:function(a){var b=[],c=-1,d,e,f,g,h,i;for(d=0,e;e=a[d];d++){f=e.childNodes,g=0,i=!0;while(h=f[g]){++g;if(h.nodeType==1||h.nodeType==3){i=!1;break}}i&&(b[++c]=e)}return b},contains:function(a,b){var c=[],d=-1,e,f;for(e=0;f=a[e];e++)(f.textContent||f.innerText||f.text||"").indexOf(b)!=-1&&(c[++d]=f);return c},nodeValue:function(a,b){var c=[],d=-1,e,f;for(e=0;f=a[e];e++)f.firstChild&&f.firstChild.nodeValue==b&&(c[++d]=f);return c},checked:function(a){var b=[],c=-1,d,e;for(d=0;e=a[d];d++)e.checked==1&&(b[++c]=e);return b},not:function(a,b){return Ext.DomQuery.filter(a,b,!0)},any:function(a,b){var c=b.split("|"),d=[],e=-1,f,g,h,i;for(g=0;h=a[g];g++)for(i=0;f=c[i];i++)if(Ext.DomQuery.is(h,f)){d[++e]=h;break}return d},odd:function(a){return this["nth-child"](a,"odd")},even:function(a){return this["nth-child"](a,"even")},nth:function(a,b){return a[b-1]||[]},first:function(a){return a[0]||[]},last:function(a){return a[a.length-1]||[]},has:function(a,b){var c=Ext.DomQuery.select,d=[],e=-1,f,g;for(f=0;g=a[f];f++)c(b,g).length>0&&(d[++e]=g);return d},next:function(a,b){var c=Ext.DomQuery.is,d=[],e=-1,f,g,h;for(f=0;g=a[f];f++)h=next(g),h&&c(h,b)&&(d[++e]=g);return d},prev:function(a,b){var c=Ext.DomQuery.is,d=[],e=-1,f,g,h;for(f=0;g=a[f];f++)h=prev(g),h&&c(h,b)&&(d[++e]=g);return d}}}}(),Ext.query=Ext.DomQuery.select,function(){var a="hidden",b=document,c="visibility",d="display",e="none",f=Ext.baseCSSPrefix+"masked",g=Ext.baseCSSPrefix+"masked-relative",h=Ext.baseCSSPrefix+"mask-msg",i=/^body/i,j,k=Ext.isStrict?{select:1}:{input:1,select:1,textarea:1},l=function(a){var b=[],c=-1,d,e;for(d=0;e=a[d];d++)if(e.scrollTop>0||e.scrollLeft>0)b[++c]=e;return b},m=Ext.define("Ext.dom.Element",{extend:"Ext.dom.AbstractElement",alternateClassName:["Ext.Element","Ext.core.Element"],addUnits:function(){return this.self.addUnits.apply(this.self,arguments)},focus:function(a,c){var d=this,e,f;c=c||d.dom,f=(c.ownerDocument||b).body||b.body;try{Number(a)?Ext.defer(d.focus,a,d,[null,c]):(c.offsetHeight>m.getViewHeight()&&(e=f.scrollTop),c.focus(),e!==undefined&&(f.scrollTop=e))}catch(g){}return d},blur:function(){try{this.dom.blur()}catch(a){}return this},isBorderBox:function(){var a=Ext.isBorderBox;return a&&(a=!((this.dom.tagName||"").toLowerCase()in k)),a},hover:function(a,b,c,d){var e=this;return e.on("mouseenter",a,c||e.dom,d),e.on("mouseleave",b,c||e.dom,d),e},getAttributeNS:function(a,b){return this.getAttribute(b,a)},getAttribute:Ext.isIE&&(!Ext.isIE9||b.documentMode!==9)?function(a,b){var c=this.dom,d;return b?(d=typeof c[b+":"+a],d!="undefined"&&d!="unknown"?c[b+":"+a]||null:null):(a==="for"&&(a="htmlFor"),c[a]||null)}:function(a,b){var c=this.dom;return b?c.getAttributeNS(b,a)||c.getAttribute(b+":"+a):c.getAttribute(a)||c[a]||null},cacheScrollValues:function(){var a=this,b,c,d,e=[],f=function(){for(d=0;d<b.length;d++)c=b[d],c.scrollLeft=e[d][0],c.scrollTop=e[d][1]};Ext.DomQuery.pseudos.isScrolled||(Ext.DomQuery.pseudos.isScrolled=l),b=a.query(":isScrolled");for(d=0;d<b.length;d++)c=b[d],e[d]=[c.scrollLeft,c.scrollTop];return f},autoBoxAdjust:!0,isVisible:function(b){var f=this,g=f.dom,h=g.ownerDocument.documentElement;j||(j=new m.Fly);while(g!==h){if(!g||g.nodeType===11||j.attach(g).isStyle(c,a)||j.isStyle(d,e))return!1;if(!b)break;g=g.parentNode}return!0},isDisplayed:function(){return!this.isStyle(d,e)},enableDisplayMode:function(a){var b=this;return b.setVisibilityMode(m.DISPLAY),Ext.isEmpty(a)||((b.$cache||b.getCache()).data.originalDisplay=a),b},mask:function(a,c,d){var e=this,j=e.dom,k=j.style.setExpression,l=(e.$cache||e.getCache()).data,m=l.maskEl,n=l.maskMsg;return(!i.test(j.tagName)||e.getStyle("position")!="static")&&e.addCls(g),m&&m.remove(),n&&n.remove(),Ext.DomHelper.append(j,[{cls:Ext.baseCSSPrefix+"mask"},{cls:c?h+" "+c:h,cn:{tag:"div",html:a||""}}]),n=Ext.get(j.lastChild),m=Ext.get(n.dom.previousSibling),l.maskMsg=n,l.maskEl=m,e.addCls(f),m.setDisplayed(!0),typeof a=="string"?(n.setDisplayed(!0),n.center(e)):n.setDisplayed(!1),!Ext.supports.IncludePaddingInWidthCalculation&&k&&m.dom.style.setExpression("width",'this.parentNode.clientWidth + "px"'),!Ext.supports.IncludePaddingInHeightCalculation&&k?m.dom.style.setExpression("height","this.parentNode."+(j==b.body?"scrollHeight":"offsetHeight")+' + "px"'):Ext.isIE&&(!Ext.isIE7||!Ext.isStrict)&&e.getStyle("height")=="auto"&&m.setSize(undefined,d||e.getHeight()),m},unmask:function(){var a=this,b=(a.$cache||a.getCache()).data,c=b.maskEl,d=b.maskMsg,e;c&&(e=c.dom.style,e.clearExpression&&(e.clearExpression("width"),e.clearExpression("height")),c&&(c.remove(),delete b.maskEl),d&&(d.remove(),delete b.maskMsg),a.removeCls([f,g]))},isMasked:function(){var a=this,b=(a.$cache||a.getCache()).data,c=b.maskEl,d=b.maskMsg,e=!1;return c&&c.isVisible()&&(d&&d.center(a),e=!0),e},createShim:function(){var a=b.createElement("iframe"),c;return a.frameBorder="0",a.className=Ext.baseCSSPrefix+"shim",a.src=Ext.SSL_SECURE_URL,c=Ext.get(this.dom.parentNode.insertBefore(a,this.dom)),c.autoBoxAdjust=!1,c},addKeyListener:function(a,b,c){var d;return typeof a!="object"||Ext.isArray(a)?d={target:this,key:a,fn:b,scope:c}:d={target:this,key:a.key,shift:a.shift,ctrl:a.ctrl,alt:a.alt,fn:b,scope:c},new Ext.util.KeyMap(d)},addKeyMap:function(a){return new Ext.util.KeyMap(Ext.apply({target:this},a))},on:function(a,b,c,d){return Ext.EventManager.on(this,a,b,c||this,d),this},un:function(a,b,c){return Ext.EventManager.un(this,a,b,c||this),this},removeAllListeners:function(){return Ext.EventManager.removeAll(this),this},purgeAllListeners:function(){return Ext.EventManager.purgeElement(this),this}},function(){function l(){if(!Ext.enableGarbageCollector)clearInterval(c.collectorThreadId);else{var b,d,e,f;for(b in a){if(!a.hasOwnProperty(b))continue;e=a[b];if(e.skipGarbageCollection)continue;d=e.dom;if(!d.parentNode||!d.offsetParent&&!Ext.getElementById(b))d&&Ext.enableListenerCollection&&Ext.EventManager.removeAll(d),delete a[b]}if(Ext.isIE){f={};for(b in a){if(!a.hasOwnProperty(b))continue;f[b]=a[b]}a=Ext.cache=f}}}var a=Ext.cache,c=this,d=Ext.dom.AbstractElement,e=/a|button|embed|iframe|img|input|object|select|textarea/i,f=/\S/,g=/(?:<script([^>]*)?>)((\n|\r|.)*?)(?:<\/script>)/ig,h=/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/ig,i=/\ssrc=([\'\"])(.*?)\1/i,j=/\stype=([\'\"])(.*?)\1/i,k=!(Ext.isIE6||Ext.isIE7||Ext.isIE8);c.boxMarkup='<div class="{0}-tl"><div class="{0}-tr"><div class="{0}-tc"></div></div></div><div class="{0}-ml"><div class="{0}-mr"><div class="{0}-mc"></div></div></div><div class="{0}-bl"><div class="{0}-br"><div class="{0}-bc"></div></div></div>',c.collectorThreadId=setInterval(l,3e4),c.addMethods({monitorMouseLeave:function(a,b,c){var d=this,e,f={mouseleave:function(f){e=setTimeout(Ext.Function.bind(b,c||d,[f]),a)},mouseenter:function(){clearTimeout(e)},freezeEvent:!0};return d.on(f),f},swallowEvent:function(a,b){function f(a){a.stopPropagation(),b&&a.preventDefault()}var c=this,d,e;if(Ext.isArray(a)){e=a.length;for(d=0;d<e;d++)c.on(a[d],f);return c}return c.on(a,f),c},relayEvent:function(a,b){this.on(a,function(c){b.fireEvent(a,c)})},clean:function(a){var b=this,c=b.dom,d=(b.$cache||b.getCache()).data,e=c.firstChild,g=-1,h;if(d.isCleaned&&a!==!0)return b;while(e)h=e.nextSibling,e.nodeType==3?f.test(e.nodeValue)?h&&h.nodeType==3&&(e.appendData(Ext.String.trim(h.data)),c.removeChild(h),h=e.nextSibling,e.nodeIndex=++g):c.removeChild(e):(Ext.fly(e).clean(),e.nodeIndex=++g),e=h;return d.isCleaned=!0,b},load:function(a){return this.getLoader().load(a),this},getLoader:function(){var a=this,b=(a.$cache||a.getCache()).data,c=b.loader;return c||(b.loader=c=new Ext.ElementLoader({target:a})),c},update:function(a,c,d){var e=this,f,k,l;return e.dom?(a=a||"",k=e.dom,c!==!0?(k.innerHTML=a,Ext.callback(d,e),e):(f=Ext.id(),a+='<span id="'+f+'"></span>',l=setInterval(function(){var c,h,k,m,n,o,p;if(!(o=b.getElementById(f)))return!1;clearInterval(l),Ext.removeNode(o),c=Ext.getHead().dom;while(h=g.exec(a))k=h[1],m=k?k.match(i):!1,m&&m[2]?(p=b.createElement("script"),p.src=m[2],n=k.match(j),n&&n[2]&&(p.type=n[2]),c.appendChild(p)):h[2]&&h[2].length>0&&(window.execScript?window.execScript(h[2]):window.eval(h[2]));Ext.callback(d,e)},20),k.innerHTML=a.replace(h,""),e)):e},removeAllListeners:function(){return this.removeAnchor(),Ext.EventManager.removeAll(this.dom),this},createProxy:function(a,b,c){a=typeof a=="object"?a:{tag:"div",cls:a};var d=this,e=b?Ext.DomHelper.append(b,a,!0):Ext.DomHelper.insertBefore(d.dom,a,!0);return e.setVisibilityMode(m.DISPLAY),e.hide(),c&&d.setBox&&d.getBox&&e.setBox(d.getBox()),e},getScopeParent:function(){var a=this.dom.parentNode;return Ext.scopeResetCSS?a.parentNode:a},needsTabIndex:function(){if(this.dom)return this.dom.nodeName==="a"&&!this.dom.href?!0:!e.test(this.dom.nodeName)},focusable:function(){var a=this.dom,b=a.nodeName,c=!1;if(!a.disabled)if(e.test(b)){if(b!=="a"||a.href)c=!0}else c=!isNaN(a.tabIndex);return c&&this.isVisible(!0)}}),Ext.isIE&&(c.prototype.getById=function(d,e){var f=this.dom,g,h,i;if(f){h=k&&b.getElementById(d)||f.all[d];if(h)return e?i=h:(g=a[d],g&&g.el?(i=g.el,i.dom=h):i=new m(h)),i}return e?Ext.getDom(d):c.get(d)}),c.createAlias({addListener:"on",removeListener:"un",clearListeners:"removeAllListeners"}),c.Fly=d.Fly=new Ext.Class({extend:c,constructor:function(a){this.dom=a},attach:d.Fly.prototype.attach}),Ext.isIE?Ext.getElementById=function(a){var c=b.getElementById(a),e;return!c&&(e=d.detachedBodyEl)&&(c=e.dom.all[a]),c}:b.querySelector||(Ext.getDetachedBody=Ext.getBody,Ext.getElementById=function(a){return b.getElementById(a)})})}(),Ext.dom.Element.override(function(){var a=document,b=window,c=/^([a-z]+)-([a-z]+)(\?)?$/,d=Math.round;return{getAnchorXY:function(b,c,e){b=(b||"tl").toLowerCase(),e=e||{};var f=this,g=f.dom==a.body||f.dom==a,h=e.width||g?Ext.dom.Element.getViewWidth():f.getWidth(),i=e.height||g?Ext.dom.Element.getViewHeight():f.getHeight(),j,k=f.getXY(),l=f.getScroll(),m=g?l.left:c?0:k[0],n=g?l.top:c?0:k[1];switch(b){case"tl":j=[0,0];break;case"bl":j=[0,i];break;case"tr":j=[h,0];break;case"c":j=[d(h*.5),d(i*.5)];break;case"t":j=[d(h*.5),0];break;case"l":j=[0,d(i*.5)];break;case"r":j=[h,d(i*.5)];break;case"b":j=[d(h*.5),i];break;case"br":j=[h,i]}return[j[0]+m,j[1]+n]},getAlignToXY:function(b,d,e){b=Ext.get(b),!!b&&!!b.dom,e=e||[0,0],d=(!d||d=="?"?"tl-bl?":!/-/.test(d)&&d!==""?"tl-"+d:d||"tl-bl").toLowerCase();var f=this,g,h,i,j,k,l,m,n=Ext.dom.Element.getViewWidth()-10,o=Ext.dom.Element.getViewHeight()-10,p,q,r,s,t,u,v=a.documentElement,w=a.body,x=v.scrollLeft||w.scrollLeft||0,y=v.scrollTop||w.scrollTop||0,z,A,B,C=d.match(c);return A=C[1],B=C[2],z=!!C[3],g=f.getAnchorXY(A,!0),h=b.getAnchorXY(B,!1),i=h[0]-g[0]+e[0],j=h[1]-g[1]+e[1],z&&(k=f.getWidth(),l=f.getHeight(),m=b.getRegion(),p=A.charAt(0),q=A.charAt(A.length-1),r=B.charAt(0),s=B.charAt(B.length-1),t=p=="t"&&r=="b"||p=="b"&&r=="t",u=q=="r"&&s=="l"||q=="l"&&s=="r",i+k>n+x&&(i=u?m.left-k:n+x-k),i<x&&(i=u?m.right:x),j+l>o+y&&(j=t?m.top-l:o+y-l),j<y&&(j=t?m.bottom:y)),[i,j]},anchorTo:function(a,c,d,e,f,g){var h=this,i=h.dom,j=!Ext.isEmpty(f),k=function(){Ext.fly(i).alignTo(a,c,d,e),Ext.callback(g,Ext.fly(i))},l=this.getAnchor();return this.removeAnchor(),Ext.apply(l,{fn:k,scroll:j}),Ext.EventManager.onWindowResize(k,null),j&&Ext.EventManager.on(b,"scroll",k,null,{buffer:isNaN(f)?50:f}),k.call(h),h},removeAnchor:function(){var a=this,c=this.getAnchor();return c&&c.fn&&(Ext.EventManager.removeResizeListener(c.fn),c.scroll&&Ext.EventManager.un(b,"scroll",c.fn),delete c.fn),a},getAlignVector:function(a,b,c){var d=this,e=d.getXY(),f=d.getAlignToXY(a,b,c);return a=Ext.get(a),f[0]-=e[0],f[1]-=e[1],f},alignTo:function(a,b,c,d){var e=this;return e.setXY(e.getAlignToXY(a,b,c),e.anim&&!!d?e.anim(d):!1)},getConstrainVector:function(a,b){a instanceof Ext.util.Region||(a=Ext.get(a).getViewRegion());var c=this.getRegion(),d=[0,0],e=this.shadow&&this.shadow.offset,f=!1;return b&&c.translateBy(b[0]-c.x,b[1]-c.y),e&&a.adjust(0,-e,-e,e),c.right>a.right&&(f=!0,d[0]=a.right-c.right),c.left+d[0]<a.left&&(f=!0,d[0]=a.left-c.left),c.bottom>a.bottom&&(f=!0,d[1]=a.bottom-c.bottom),c.top+d[1]<a.top&&(f=!0,d[1]=a.top-c.top),f?d:!1},getCenterXY:function(){return this.getAlignToXY(a,"c-c")},center:function(b){return this.alignTo(b||a,"c-c")}}}()),Ext.dom.Element.override({animate:function(a){var b=this,c,d,e=b.dom.id||Ext.id(b.dom);return Ext.fx.Manager.hasFxBlock(e)||(a.listeners&&(c=a.listeners,delete a.listeners),a.internalListeners&&(a.listeners=a.internalListeners,delete a.internalListeners),d=new Ext.fx.Anim(b.anim(a)),c&&d.on(c),Ext.fx.Manager.queueFx(d)),b},anim:function(a){if(!Ext.isObject(a))return a?{}:!1;var b=this,c=a.duration||Ext.fx.Anim.prototype.duration,d=a.easing||"ease",e;return a.stopAnimation&&b.stopAnimation(),Ext.applyIf(a,Ext.fx.Manager.getFxDefaults(b.id)),Ext.fx.Manager.setFxDefaults(b.id,{delay:0}),e={target:b.dom,remove:a.remove,alternate:a.alternate||!1,duration:c,easing:d,callback:a.callback,listeners:a.listeners,iterations:a.iterations||1,scope:a.scope,block:a.block,concurrent:a.concurrent,delay:a.delay||0,paused:!0,keyframes:a.keyframes,from:a.from||{},to:Ext.apply({},a)},Ext.apply(e.to,a.to),delete e.to.to,delete e.to.from,delete e.to.remove,delete e.to.alternate,delete e.to.keyframes,delete e.to.iterations,delete e.to.listeners,delete e.to.target,delete e.to.paused,delete e.to.callback,delete e.to.scope,delete e.to.duration,delete e.to.easing,delete e.to.concurrent,delete e.to.block,delete e.to.stopAnimation,delete e.to.delay,e},slideIn:function(a,b,c){var d=this,e=d.dom.style,f,g,h,i;return a=a||"t",b=b||{},f=function(){var f=this,k=b.listeners,l,m,n,o;c||d.fixDisplay(),l=d.getBox(),a!="t"&&a!="b"||l.height!==0?(a=="l"||a=="r")&&l.width===0&&(l.width=d.dom.scrollWidth):l.height=d.dom.scrollHeight,m=d.getStyles("width","height","left","right","top","bottom","position","z-index",!0),d.setSize(l.width,l.height),b.preserveScroll&&(h=d.cacheScrollValues()),o=d.wrap({id:Ext.id()+"-anim-wrap-for-"+d.id,style:{visibility:c?"visible":"hidden"}}),i=o.dom.parentNode,o.setPositioning(d.getPositioning()),o.isStyle("position","static")&&o.position("relative"),d.clearPositioning("auto"),o.clip(),h&&h(),d.setStyle({visibility:"",position:"absolute"}),c&&o.setSize(l.width,l.height);switch(a){case"t":n={from:{width:l.width+"px",height:"0px"},to:{width:l.width+"px",height:l.height+"px"}},e.bottom="0px";break;case"l":n={from:{width:"0px",height:l.height+"px"},to:{width:l.width+"px",height:l.height+"px"}},e.right="0px";break;case"r":n={from:{x:l.x+l.width,width:"0px",height:l.height+"px"},to:{x:l.x,width:l.width+"px",height:l.height+"px"}};break;case"b":n={from:{y:l.y+l.height,width:l.width+"px",height:"0px"},to:{y:l.y,width:l.width+"px",height:l.height+"px"}};break;case"tl":n={from:{x:l.x,y:l.y,width:"0px",height:"0px"},to:{width:l.width+"px",height:l.height+"px"}},e.bottom="0px",e.right="0px";break;case"bl":n={from:{x:l.x+l.width,width:"0px",height:"0px"},to:{x:l.x,width:l.width+"px",height:l.height+"px"}},e.right="0px";break;case"br":n={from:{x:l.x+l.width,y:l.y+l.height,width:"0px",height:"0px"},to:{x:l.x,y:l.y,width:l.width+"px",height:l.height+"px"}};break;case"tr":n={from:{y:l.y+l.height,width:"0px",height:"0px"},to:{y:l.y,width:l.width+"px",height:l.height+"px"}},e.bottom="0px"}o.show(),g=Ext.apply({},b),delete g.listeners,g=new Ext.fx.Anim(Ext.applyIf(g,{target:o,duration:500,easing:"ease-out",from:c?n.to:n.from,to:c?n.from:n.to})),g.on("afteranimate",function(){d.setStyle(m),c&&(b.useDisplay?d.setDisplayed(!1):d.hide()),o.dom&&(o.dom.parentNode?o.dom.parentNode.insertBefore(d.dom,o.dom):i.appendChild(d.dom),o.remove()),h&&h(),f.end()}),k&&g.on(k)},d.animate({duration:b.duration?Math.max(b.duration,500)*2:1e3,listeners:{beforeanimate:f}}),d},slideOut:function(a,b){return this.slideIn(a,b,!0)},puff:function(a){var b=this,c,d=b.getBox(),e=b.getStyles("width","height","left","right","top","bottom","position","z-index","font-size","opacity",!0);return a=Ext.applyIf(a||{},{easing:"ease-out",duration:500,useDisplay:!1}),c=function(){b.clearOpacity(),b.show(),this.to={width:d.width*2,height:d.height*2,x:d.x-d.width/2,y:d.y-d.height/2,opacity:0,fontSize:"200%"},this.on("afteranimate",function(){b.dom&&(a.useDisplay?b.setDisplayed(!1):b.hide(),b.setStyle(e),a.callback.call(a.scope))})},b.animate({duration:a.duration,easing:a.easing,listeners:{beforeanimate:{fn:c}}}),b},switchOff:function(a){var b=this,c;return a=Ext.applyIf(a||{},{easing:"ease-in",duration:500,remove:!1,useDisplay:!1}),c=function(){var c=this,d=b.getSize(),e=b.getXY(),f,g;b.clearOpacity(),b.clip(),g=b.getPositioning(),f=new Ext.fx.Animator({target:b,duration:a.duration,easing:a.easing,keyframes:{33:{opacity:.3},66:{height:1,y:e[1]+d.height/2},100:{width:1,x:e[0]+d.width/2}}}),f.on("afteranimate",function(){a.useDisplay?b.setDisplayed(!1):b.hide(),b.clearOpacity(),b.setPositioning(g),b.setSize(d),c.end()})},b.animate({duration:Math.max(a.duration,500)*2,listeners:{beforeanimate:{fn:c}}}),b},frame:function(a,b,c){var d=this,e;return a=a||"#C3DAF9",b=b||1,c=c||{},e=function(){d.show();var e=this,f=d.getBox(),g=Ext.getBody().createChild({id:d.id+"-anim-proxy",style:{position:"absolute","pointer-events":"none","z-index":35e3,border:"0px solid "+a}}),h;h=new Ext.fx.Anim({target:g,duration:c.duration||1e3,iterations:b,from:{top:f.y,left:f.x,borderWidth:0,opacity:1,height:f.height,width:f.width},to:{top:f.y-20,left:f.x-20,borderWidth:10,opacity:0,height:f.height+40,width:f.width+40}}),h.on("afteranimate",function(){g.remove(),e.end()})},d.animate({duration:Math.max(c.duration,500)*2||2e3,listeners:{beforeanimate:{fn:e}}}),d},ghost:function(a,b){var c=this,d;return a=a||"b",d=function(){var b=c.getWidth(),d=c.getHeight(),e=c.getXY(),f=c.getPositioning(),g={opacity:0};switch(a){case"t":g.y=e[1]-d;break;case"l":g.x=e[0]-b;break;case"r":g.x=e[0]+b;break;case"b":g.y=e[1]+d;break;case"tl":g.x=e[0]-b,g.y=e[1]-d;break;case"bl":g.x=e[0]-b,g.y=e[1]+d;break;case"br":g.x=e[0]+b,g.y=e[1]+d;break;case"tr":g.x=e[0]+b,g.y=e[1]-d}this.to=g,this.on("afteranimate",function(){c.dom&&(c.hide(),c.clearOpacity(),c.setPositioning(f))})},c.animate(Ext.applyIf(b||{},{duration:500,easing:"ease-out",listeners:{beforeanimate:{fn:d}}})),c},highlight:function(a,b){var c=this,d=c.dom,e={},f,g,h,i,j,k;return b=b||{},i=b.listeners||{},h=b.attr||"backgroundColor",e[h]=a||"ffff9c",b.to?g=b.to:(g={},g[h]=b.endColor||c.getColor(h,"ffffff","")),b.listeners=Ext.apply(Ext.apply({},i),{beforeanimate:function(){f=d.style[h],c.clearOpacity(),c.show(),j=i.beforeanimate;if(j)return k=j.fn||j,k.apply(j.scope||i.scope||window,arguments)},afteranimate:function(){d&&(d.style[h]=f),j=i.afteranimate,j&&(k=j.fn||j,k.apply(j.scope||i.scope||window,arguments))}}),c.animate(Ext.apply({},b,{duration:1e3,easing:"ease-in",from:e,to:g})),c},pause:function(a){var b=this;return Ext.fx.Manager.setFxDefaults(b.id,{delay:a}),b},fadeIn:function(a){var b=this;return b.animate(Ext.apply({},a,{opacity:1,internalListeners:{beforeanimate:function(a){b.isStyle("display","none")?b.setDisplayed(""):b.show()}}})),this},fadeOut:function(a){var b=this;return a=Ext.apply({opacity:0,internalListeners:{afteranimate:function(c){var d=b.dom;d&&c.to.opacity===0&&(a.useDisplay?b.setDisplayed(!1):b.hide())}}},a),b.animate(a),b},scale:function(a,b,c){return this.animate(Ext.apply({},c,{width:a,height:b})),this},shift:function(a){return this.animate(a),this}}),Ext.dom.Element.override({initDD:function(a,b,c){var d=new Ext.dd.DD(Ext.id(this.dom),a,b);return Ext.apply(d,c)},initDDProxy:function(a,b,c){var d=new Ext.dd.DDProxy(Ext.id(this.dom),a,b);return Ext.apply(d,c)},initDDTarget:function(a,b,c){var d=new Ext.dd.DDTarget(Ext.id(this.dom),a,b);return Ext.apply(d,c)}}),function(){var a=Ext.dom.Element,b="visibility",c="display",d="none",e="hidden",f="visible",g="offsets",h="asclass",i="nosize",j="originalDisplay",k="visibilityMode",l="isVisible",m=Ext.baseCSSPrefix+"hide-offsets",n=function(a){var b=(a.$cache||a.getCache()).data,c=b[j];return c===undefined&&(b[j]=c=""),c},o=function(b){var c=(b.$cache||b.getCache()).data,d=c[k];return d===undefined&&(c[k]=d=a.VISIBILITY),d};a.override({originalDisplay:"",visibilityMode:1,setVisible:function(d,f){var j=this,k=j.dom,n=o(j);if(typeof f=="string"){switch(f){case c:n=a.DISPLAY;break;case b:n=a.VISIBILITY;break;case g:n=a.OFFSETS;break;case i:case h:n=a.ASCLASS}j.setVisibilityMode(n),f=!1}if(!f||!j.anim){if(n==a.DISPLAY)return j.setDisplayed(d);n==a.OFFSETS?j[d?"removeCls":"addCls"](m):n==a.VISIBILITY?(j.fixDisplay(),k.style.visibility=d?"":e):n==a.ASCLASS&&j[d?"removeCls":"addCls"](j.visibilityCls||a.visibilityCls)}else d&&(j.setOpacity(.01),j.setVisible(!0)),Ext.isObject(f)||(f={duration:350,easing:"ease-in"}),j.animate(Ext.applyIf({callback:function(){d||j.setVisible(!1).setOpacity(1)},to:{opacity:d?1:0}},f));return(j.$cache||j.getCache()).data[l]=d,j},hasMetrics:function(){var b=o(this);return this.isVisible()||b==a.OFFSETS||b==a.VISIBILITY},toggle:function(a){var b=this;return b.setVisible(!b.isVisible(),b.anim(a)),b},setDisplayed:function(a){return typeof a=="boolean"&&(a=a?n(this):d),this.setStyle(c,a),this},fixDisplay:function(){var a=this;a.isStyle(c,d)&&(a.setStyle(b,e),a.setStyle(c,n(a)),a.isStyle(c,d)&&a.setStyle(c,"block"))},hide:function(a){return typeof a=="string"?(this.setVisible(!1,a),this):(this.setVisible(!1,this.anim(a)),this)},show:function(a){return typeof a=="string"?(this.setVisible(!0,a),this):(this.setVisible(!0,this.anim(a)),this)}})}(),function(){var a=Ext.dom.Element,b="left",c="right",d="top",e="bottom",f="position",g="static",h="relative",i="auto",j="z-index",k="BODY",l="padding",m="border",n="-left",o="-right",p="-top",q="-bottom",r="-width",s={l:m+n+r,r:m+o+r,t:m+p+r,b:m+q+r},t={l:l+n,r:l+o,t:l+p,b:l+q},u=[t.l,t.r,t.t,t.b],v=[s.l,s.r,s.t,s.b],w=["position","top","left"];a.override({getX:function(){return a.getX(this.dom)},getY:function(){return a.getY(this.dom)},getXY:function(){return a.getXY(this.dom)},getOffsetsTo:function(a){var b=this.getXY(),c=Ext.fly(a,"_internal").getXY();return[b[0]-c[0],b[1]-c[1]]},setX:function(a,b){return this.setXY([a,this.getY()],b)},setY:function(a,b){return this.setXY([this.getX(),a],b)},setLeft:function(a){return this.setStyle(b,this.addUnits(a)),this},setTop:function(a){return this.setStyle(d,this.addUnits(a)),this},setRight:function(a){return this.setStyle(c,this.addUnits(a)),this},setBottom:function(a){return this.setStyle(e,this.addUnits(a)),this},setXY:function(b,c){var d=this;return!c||!d.anim?a.setXY(d.dom,b):(Ext.isObject(c)||(c={}),d.animate(Ext.applyIf({to:{x:b[0],y:b[1]}},c))),d},getLeft:function(a){return a?parseFloat(this.getStyle(b))||0:this.getX()},getRight:function(a){var b=this;return a?b.getLeft(!0)+b.getWidth()||0:b.getX()+b.getWidth()},getTop:function(a){return a?parseFloat(this.getStyle(d))||0:this.getY()},getBottom:function(a){var b=this;return a?b.getTop(!0)+b.getHeight()||0:b.getY()+b.getHeight()},translatePoints:function(a,b){var c=this,d=c.getStyle(w),e=d.position=="relative",f=parseFloat(d.left),g=parseFloat(d.top),h=c.getXY();return Ext.isArray(a)&&(b=a[1],a=a[0]),isNaN(f)&&(f=e?0:c.dom.offsetLeft),isNaN(g)&&(g=e?0:c.dom.offsetTop),f=typeof a=="number"?a-h[0]+f:undefined,g=typeof b=="number"?b-h[1]+g:undefined,{left:f,top:g}},setBox:function(a,b,c){var d=this,e=a.width,f=a.height;return b&&!d.autoBoxAdjust&&!d.isBorderBox()&&(e-=d.getBorderWidth("lr")+d.getPadding("lr"),f-=d.getBorderWidth("tb")+d.getPadding("tb")),d.setBounds(a.x,a.y,e,f,c),d},getBox:function(a,c){var e=this,f,g,h,i,j,k,l,m,n,o,p,q;return c?(f=e.getStyle([b,d]),f=[parseFloat(f.left)||0,parseFloat(f.top)||0]):f=e.getXY(),o=e.getWidth(),p=e.getHeight(),a?(i=e.getStyle(u),j=e.getStyle(v),k=(parseFloat(j[s.l])||0)+(parseFloat(i[t.l])||0),l=(parseFloat(j[s.r])||0)+(parseFloat(i[t.r])||0),m=(parseFloat(j[s.t])||0)+(parseFloat(i[t.t])||0),n=(parseFloat(j[s.b])||0)+(parseFloat(i[t.b])||0),q={x:f[0]+k,y:f[1]+m,0:f[0]+k,1:f[1]+m,width:o-(k+l),height:p-(m+n)}):q={x:f[0],y:f[1],0:f[0],1:f[1],width:o,height:p},q.right=q.x+q.width,q.bottom=q.y+q.height,q},getPageBox:function(a){var b=this,c=b.dom,d=c.nodeName==k,e=d?Ext.dom.AbstractElement.getViewWidth():c.offsetWidth,f=d?Ext.dom.AbstractElement.getViewHeight():c.offsetHeight,g=b.getXY(),h=g[1],i=g[0]+e,j=g[1]+f,l=g[0];return a?new Ext.util.Region(h,i,j,l):{left:l,top:h,width:e,height:f,right:i,bottom:j}},setLocation:function(a,b,c){return this.setXY([a,b],c)},moveTo:function(a,b,c){return this.setXY([a,b],c)},position:function(a,b,c,d){var e=this;!a&&e.isStyle(f,g)?e.setStyle(f,h):a&&e.setStyle(f,a),b&&e.setStyle(j,b),(c||d)&&e.setXY([c||!1,d||!1])},clearPositioning:function(a){return a=a||"",this.setStyle({left:a,right:a,top:a,bottom:a,"z-index":"",position:g}),this},getPositioning:function(){var a=this.getStyle([b,d,f,c,e,j]);return a[c]=a[b]?"":a[c],a[e]=a[d]?"":a[e],a},setPositioning:function(a){var b=this,c=b.dom.style;return b.setStyle(a),a.right==i&&(c.right=""),a.bottom==i&&(c.bottom=""),b},move:function(a,b,c){var d=this,e=d.getXY(),f=e[0],g=e[1],h=[f-b,g],i=[f+b,g],j=[f,g-b],k=[f,g+b],l={l:h,left:h,r:i,right:i,t:j,top:j,up:j,b:k,bottom:k,down:k};a=a.toLowerCase(),d.moveTo(l[a][0],l[a][1],c)},setLeftTop:function(b,c){var d=this.dom.style;return d.left=a.addUnits(b),d.top=a.addUnits(c),this},getRegion:function(){return this.getPageBox(!0)},getViewRegion:function(){var a=this,b=a.dom.nodeName==k,c,d,e,f,g,h;return b?(c=a.getScroll(),f=c.left,e=c.top,g=Ext.dom.AbstractElement.getViewportWidth(),h=Ext.dom.AbstractElement.getViewportHeight()):(d=a.getXY(),f=d[0]+a.getBorderWidth("l")+a.getPadding("l"),e=d[1]+a.getBorderWidth("t")+a.getPadding("t"),g=a.getWidth(!0),h=a.getHeight(!0)),new Ext.util.Region(e,f+g,e+h,f)},setBounds:function(a,b,c,d,e){var f=this;return!e||!f.anim?(f.setSize(c,d),f.setLocation(a,b)):(Ext.isObject(e)||(e={}),f.animate(Ext.applyIf({to:{x:a,y:b,width:f.adjustWidth(c),height:f.adjustHeight(d)}},e))),f},setRegion:function(a,b){return this.setBounds(a.left,a.top,a.right-a.left,a.bottom-a.top,b)}})}(),Ext.dom.Element.override({isScrollable:function(){var a=this.dom;return a.scrollHeight>a.clientHeight||a.scrollWidth>a.clientWidth},getScroll:function(){var a=this.dom,b=document,c=b.body,d=b.documentElement,e,f,g;return a==b||a==c?(Ext.isIE&&Ext.isStrict?(e=d.scrollLeft,f=d.scrollTop):(e=window.pageXOffset,f=window.pageYOffset),g={left:e||(c?c.scrollLeft:0),top:f||(c?c.scrollTop:0)}):g={left:a.scrollLeft,top:a.scrollTop},g},scrollBy:function(a,b,c){var d=this,e=d.dom;return a.length?(c=b,b=a[1],a=a[0]):typeof a!="number"&&(c=b,b=a.y,a=a.x),a&&d.scrollTo("left",Math.max(Math.min(e.scrollLeft+a,e.scrollWidth-e.clientWidth),0),c),b&&d.scrollTo("top",Math.max(Math.min(e.scrollTop+b,e.scrollHeight-e.clientHeight),0),c),d},scrollTo:function(a,b,c){var d=/top/i.test(a),e=this,f=e.dom,g={},h;return!c||!e.anim?(h="scroll"+(d?"Top":"Left"),f[h]=b):(Ext.isObject(c)||(c={}),g["scroll"+(d?"Top":"Left")]=b,e.animate(Ext.applyIf({to:g},c))),e},scrollIntoView:function(a,b){a=Ext.getDom(a)||Ext.getBody().dom;var c=this.dom,d=this.getOffsetsTo(a),e=d[0]+a.scrollLeft,f=d[1]+a.scrollTop,g=f+c.offsetHeight,h=e+c.offsetWidth,i=a.clientHeight,j=parseInt(a.scrollTop,10),k=parseInt(a.scrollLeft,10),l=j+i,m=k+a.clientWidth;return c.offsetHeight>i||f<j?a.scrollTop=f:g>l&&(a.scrollTop=g-i),a.scrollTop=a.scrollTop,b!==!1&&(c.offsetWidth>a.clientWidth||e<k?a.scrollLeft=e:h>m&&(a.scrollLeft=h-a.clientWidth),a.scrollLeft=a.scrollLeft),this},scrollChildIntoView:function(a,b){Ext.fly(a,"_scrollChildIntoView").scrollIntoView(this,b)},scroll:function(a,b,c){if(!this.isScrollable())return!1;var d=this.dom,e=d.scrollLeft,f=d.scrollTop,g=d.scrollWidth,h=d.scrollHeight,i=d.clientWidth,j=d.clientHeight,k=!1,l,m={l:Math.min(e+b,g-i),r:l=Math.max(e-b,0),t:Math.max(f-b,0),b:Math.min(f+b,h-j)};return m.d=m.b,m.u=m.t,a=a.substr(0,1),(l=m[a])>-1&&(k=!0,this.scrollTo(a=="l"||a=="r"?"left":"top",l,this.anim(c))),k}}),function(){var a=Ext.dom.Element,b=document.defaultView,c=/table-row|table-.*-group/,d="_internal",e="hidden",f="height",g="width",h="isClipped",i="overflow",j="overflow-x",k="overflow-y",l="originalClip",m=/#document|body/i,n,o,p,q,r;if(!b||!b.getComputedStyle)a.prototype.getStyle=function(b,c){var d=this,e=d.dom,f=typeof b!="string",g=d.styleHooks,h=b,i=h,j=1,k=c,l,m,n,o,p,q,r;if(f){n={},h=i[0],r=0;if(!(j=i.length))return n}if(!e||e.documentElement)return n||"";m=e.style,c?q=m:(q=e.currentStyle,q||(k=!0,q=m));do{o=g[h],o||(g[h]=o={name:a.normalize(h)});if(o.get)p=o.get(e,d,k,q);else{l=o.name;if(o.canThrow)try{p=q[l]}catch(s){p=""}else p=q?q[l]:""}if(!f)return p;n[h]=p,h=i[++r]}while(r<j);return n};a.override({getHeight:function(a,b){var c=this,d=c.dom,e=c.isStyle("display","none"),g,h;return e?0:(g=Math.max(d.offsetHeight,d.clientHeight)||0,Ext.supports.Direct2DBug&&(h=c.adjustDirect2DDimension(f),b?g+=h:h>0&&h<.5&&g++),a&&(g-=c.getBorderWidth("tb")+c.getPadding("tb")),g<0?0:g)},getWidth:function(a,b){var c=this,d=c.dom,e=c.isStyle("display","none"),f,h,i;return e?0:(Ext.supports.BoundingClientRect?(f=d.getBoundingClientRect(),h=f.right-f.left,h=b?h:Math.ceil(h)):h=d.offsetWidth,h=Math.max(h,d.clientWidth)||0,Ext.supports.Direct2DBug&&(i=c.adjustDirect2DDimension(g),b?h+=i:i>0&&i<.5&&h++),a&&(h-=c.getBorderWidth("lr")+c.getPadding("lr")),h<0?0:h)},setWidth:function(a,b){var c=this;return a=c.adjustWidth(a),!b||!c.anim?c.dom.style.width=c.addUnits(a):(Ext.isObject(b)||(b={}),c.animate(Ext.applyIf({to:{width:a}},b))),c},setHeight:function(a,b){var c=this;return a=c.adjustHeight(a),!b||!c.anim?c.dom.style.height=c.addUnits(a):(Ext.isObject(b)||(b={}),c.animate(Ext.applyIf({to:{height:a}},b))),c},applyStyles:function(a){return Ext.DomHelper.applyStyles(this.dom,a),this},setSize:function(a,b,c){var d=this;return Ext.isObject(a)&&(c=b,b=a.height,a=a.width),a=d.adjustWidth(a),b=d.adjustHeight(b),!c||!d.anim?(d.dom.style.width=d.addUnits(a),d.dom.style.height=d.addUnits(b)):(c===!0&&(c={}),d.animate(Ext.applyIf({to:{width:a,height:b}},c))),d},getViewSize:function(){var b=this,c=b.dom,d=m.test(c.nodeName),e;return d?e={width:a.getViewWidth(),height:a.getViewHeight()}:e={width:c.clientWidth,height:c.clientHeight},e},getSize:function(a){return{width:this.getWidth(a),height:this.getHeight(a)}},adjustWidth:function(a){var b=this,c=typeof a=="number";return c&&b.autoBoxAdjust&&!b.isBorderBox()&&(a-=b.getBorderWidth("lr")+b.getPadding("lr")),c&&a<0?0:a},adjustHeight:function(a){var b=this,c=typeof a=="number";return c&&b.autoBoxAdjust&&!b.isBorderBox()&&(a-=b.getBorderWidth("tb")+b.getPadding("tb")),c&&a<0?0:a},getColor:function(a,b,c){var d=this.getStyle(a),e=c||c===""?c:"#",f,g,h=0;if(!d||/transparent|inherit/.test(d))return b;if(/^r/.test(d)){d=d.slice(4,d.length-1).split(","),g=d.length;for(;h<g;h++)f=parseInt(d[h],10),e+=(f<16?"0":"")+f.toString(16)}else d=d.replace("#",""),e+=d.length==3?d.replace(/^(\w)(\w)(\w)$/,"$1$1$2$2$3$3"):d;return e.length>5?e.toLowerCase():b},setOpacity:function(a,b){var c=this;return c.dom?(!b||!c.anim?c.setStyle("opacity",a):(typeof b!="object"&&(b={duration:350,easing:"ease-in"}),c.animate(Ext.applyIf({to:{opacity:a}},b))),c):c},clearOpacity:function(){return this.setOpacity("")},adjustDirect2DDimension:function(a){var b=this,d=b.dom,e=b.getStyle("display"),f=d.style.display,h=d.style.position,i=a===g?0:1,j=d.currentStyle,k;return e==="inline"&&(d.style.display="inline-block"),d.style.position=e.match(c)?"absolute":"static",k=(parseFloat(j[a])||parseFloat(j.msTransformOrigin.split(" ")[i])*2)%1,d.style.position=h,e==="inline"&&(d.style.display=f),k},clip:function(){var a=this,b=(a.$cache||a.getCache()).data,c;return b[h]||(b[h]=!0,c=a.getStyle([i,j,k]),b[l]={o:c[i],x:c[j],y:c[k]},a.setStyle(i,e),a.setStyle(j,e),a.setStyle(k,e)),a},unclip:function(){var a=this,b=(a.$cache||a.getCache()).data,c;return b[h]&&(b[h]=!1,c=b[l],c.o&&a.setStyle(i,c.o),c.x&&a.setStyle(j,c.x),c.y&&a.setStyle(k,c.y)),a},boxWrap:function(b){b=b||Ext.baseCSSPrefix+"box";var c=Ext.get(this.insertHtml("beforeBegin","<div class='"+b+"'>"+Ext.String.format(a.boxMarkup,b)+"</div>"));return Ext.DomQuery.selectNode("."+b+"-mc",c.dom).appendChild(this.dom),c},getComputedHeight:function(){var a=this,b=Math.max(a.dom.offsetHeight,a.dom.clientHeight);return b||(b=parseFloat(a.getStyle(f))||0,a.isBorderBox()||(b+=a.getFrameWidth("tb"))),b},getComputedWidth:function(){var a=this,b=Math.max(a.dom.offsetWidth,a.dom.clientWidth);return b||(b=parseFloat(a.getStyle(g))||0,a.isBorderBox()||(b+=a.getFrameWidth("lr"))),b},getFrameWidth:function(a,b){return b&&this.isBorderBox()?0:this.getPadding(a)+this.getBorderWidth(a)},addClsOnOver:function(a,b,c){var e=this,f=e.dom,g=Ext.isFunction(b);return e.hover(function(){if(g&&b.call(c||e,e)===!1)return;Ext.fly(f,d).addCls(a)},function(){Ext.fly(f,d).removeCls(a)}),e},addClsOnFocus:function(a,b,c){var e=this,f=e.dom,g=Ext.isFunction(b);return e.on("focus",function(){if(g&&b.call(c||e,e)===!1)return!1;Ext.fly(f,d).addCls(a)}),e.on("blur",function(){Ext.fly(f,d).removeCls(a)}),e},addClsOnClick:function(a,b,c){var e=this,f=e.dom,g=Ext.isFunction(b);return e.on("mousedown",function(){if(g&&b.call(c||e,e)===!1)return!1;Ext.fly(f,d).addCls(a);var h=Ext.getDoc(),i=function(){Ext.fly(f,d).removeCls(a),h.removeListener("mouseup",i)};h.on("mouseup",i)}),e},getStyleSize:function(){var b=this,c=this.dom,d=m.test(c.nodeName),e,h,i;return d?{width:a.getViewWidth(),height:a.getViewHeight()}:(e=b.getStyle([f,g],!0),e.width&&e.width!="auto"&&(h=parseFloat(e.width),b.isBorderBox()&&(h-=b.getFrameWidth("lr"))),e.height&&e.height!="auto"&&(i=parseFloat(e.height),b.isBorderBox()&&(i-=b.getFrameWidth("tb"))),{width:h||b.getWidth(!0),height:i||b.getHeight(!0)})},selectable:function(){var a=this;return a.dom.unselectable="off",a.on("selectstart",function(a){return a.stopPropagation(),!0}),a.applyStyles("-moz-user-select: text; -khtml-user-select: text;"),a.removeCls(Ext.baseCSSPrefix+"unselectable"),a},unselectable:function(){var a=this;return a.dom.unselectable="on",a.swallowEvent("selectstart",!0),a.applyStyles("-moz-user-select:-moz-none;-khtml-user-select:none;"),a.addCls(Ext.baseCSSPrefix+"unselectable"),a}}),a.prototype.styleHooks=n=Ext.dom.AbstractElement.prototype.styleHooks,Ext.isIE6&&(n.fontSize=n["font-size"]={name:"fontSize",canThrow:!0});if(Ext.isIEQuirks||Ext.isIE&&Ext.ieVersion<=8){function s(a,b,c,d){return d[this.styleName]=="none"?"0px":d[this.name]}o=["Top","Right","Bottom","Left"],p=o.length;while(p--)q=o[p],r="border"+q+"Width",n["border-"+q.toLowerCase()+"-width"]=n[r]={name:r,styleName:"border"+q+"Style",get:s}}}(),Ext.onReady(function(){var a=/alpha\(opacity=(.*)\)/i,b=/^\s+|\s+$/g,c=Ext.dom.Element.prototype.styleHooks;c.opacity={name:"opacity",afterSet:function(a,b,c){c.isLayer&&c.onOpacitySet(b)}},!Ext.supports.Opacity&&Ext.isIE&&Ext.apply(c.opacity,{get:function(b){var c=b.style.filter,d,e;if(c.match){d=c.match(a);if(d){e=parseFloat(d[1]);if(!isNaN(e))return e?e/100:0}}return 1},set:function(c,d){var e=c.style,f=e.filter.replace(a,"").replace(b,"");e.zoom=1,typeof d=="number"&&d>=0&&d<1?(d*=100,e.filter=f+(f.length?" ":"")+"alpha(opacity="+d+")"):e.filter=f}})}),Ext.dom.Element.override({select:function(a){return Ext.dom.Element.select(a,!1,this.dom)}}),Ext.define("Ext.dom.CompositeElementLite",{alternateClassName:"Ext.CompositeElementLite",requires:["Ext.dom.Element"],statics:{importElementMethods:function(){var a,b=Ext.dom.Element.prototype,c=this.prototype;for(a in b)typeof b[a]=="function"&&function(a){c[a]=c[a]||function(){return this.invoke(a,arguments)}}.call(c,a)}},constructor:function(a,b){this.elements=[],this.add(a,b),this.el=new Ext.dom.AbstractElement.Fly},isComposite:!0,getElement:function(a){return this.el.attach(a)},transformElement:function(a){return Ext.getDom(a)},getCount:function(){return this.elements.length},add:function(a,b){var c=this.elements,d,e;if(!a)return this;typeof a=="string"?a=Ext.dom.Element.selectorFunction(a,b):a.isComposite?a=a.elements:Ext.isIterable(a)||(a=[a]);for(d=0,e=a.length;d<e;++d)c.push(this.transformElement(a[d]));return this},invoke:function(a,b){var c=this.elements,d=c.length,e,f;a=Ext.dom.Element.prototype[a];for(f=0;f<d;f++)e=c[f],e&&a.apply(this.getElement(e),b);return this},item:function(a){var b=this.elements[a],c=null;return b&&(c=this.getElement(b)),c},addListener:function(a,b,c,d){var e=this.elements,f=e.length,g,h;for(g=0;g<f;g++)h=e[g],h&&Ext.EventManager.on(h,a,b,c||h,d);return this},each:function(a,b){var c=this,d=c.elements,e=d.length,f,g;for(f=0;f<e;f++){g=d[f];if(g){g=this.getElement(g);if(a.call(b||g,g,c,f)===!1)break}}return c},fill:function(a){var b=this;return b.elements=[],b.add(a),b},filter:function(a){var b=this,c=b.elements,d=c.length,e=[],f=0,g=typeof a=="function",h,i;for(;f<d;f++)i=c[f],h=!1,i&&(i=b.getElement(i),g?h=a.call(i,i,b,f)!==!1:h=i.is(a),h&&e.push(b.transformElement(i)));return b.elements=e,b},indexOf:function(a){return Ext.Array.indexOf(this.elements,this.transformElement(a))},replaceElement:function(a,b,c){var d=isNaN(a)?this.indexOf(a):a,e;return d>-1&&(b=Ext.getDom(b),c&&(e=this.elements[d],e.parentNode.insertBefore(b,e),Ext.removeNode(e)),Ext.Array.splice(this.elements,d,1,b)),this},clear:function(){this.elements=[]},addElements:function(a,b){if(!a)return this;typeof a=="string"&&(a=Ext.dom.Element.selectorFunction(a,b));var c=this.elements,d=a.length,e;for(e=0;e<d;e++)c.push(Ext.get(a[e]));return this},first:function(){return this.item(0)},last:function(){return this.item(this.getCount()-1)},contains:function(a){return this.indexOf(a)!=-1},removeElement:function(a,b){a=[].concat(a);var c=this,d=c.elements,e=a.length,f,g,h;for(h=0;h<e;h++){f=a[h];if(g=d[f]||d[f=c.indexOf(f)])b&&(g.dom?g.remove():Ext.removeNode(g)),Ext.Array.erase(d,f,1)}return c}},function(){this.importElementMethods(),this.prototype.on=this.prototype.addListener,Ext.DomQuery&&(Ext.dom.Element.selectorFunction=Ext.DomQuery.select),Ext.dom.Element.select=function(a,b){var c;return typeof a=="string"?c=Ext.dom.Element.selectorFunction(a,b):a.length!==undefined&&(c=a),new Ext.CompositeElementLite(c)},Ext.select=function(){return Ext.dom.Element.select.apply(Ext.dom.Element,arguments)}}),Ext.define("Ext.dom.CompositeElement",{alternateClassName:"Ext.CompositeElement",extend:"Ext.dom.CompositeElementLite",getElement:function(a){return a},transformElement:function(a){return Ext.get(a)}},function(){Ext.dom.Element.select=function(a,b,c){var d;return typeof a=="string"?d=Ext.dom.Element.selectorFunction(a,c):a.length!==undefined&&(d=a),b===!0?new Ext.CompositeElement(d):new Ext.CompositeElementLite(d)}}),Ext.select=Ext.Element.select,Ext.define("Ext.AbstractPlugin",{disabled:!1,constructor:function(a){Ext.apply(this,a)},getCmp:function(){return this.cmp},init:Ext.emptyFn,destroy:Ext.emptyFn,enable:function(){this.disabled=!1},disable:function(){this.disabled=!0}}),Ext.define("Ext.ComponentQuery",{singleton:!0,uses:["Ext.ComponentManager"]},function(){var a=this,b=["var r = [],","i = 0,","it = items,","l = it.length,","c;","for (; i < l; i++) {","c = it[i];","if (c.{0}) {","r.push(c);","}","}","return r;"].join(""),c=function(a,b){return b.method.apply(this,[a].concat(b.args))},d=function(a,b){var c=[],d=0,e=a.length,f,g=b!==">";for(;d<e;d++)f=a[d],f.getRefItems&&(c=c.concat(f.getRefItems(g)));return c},e=function(a){var b=[],c=0,d=a.length,e;for(;c<d;c++){e=a[c];while(!!(e=e.ownerCt||e.floatParent))b.push(e)}return b},f=function(a,b,c){if(b==="*")return a.slice();var d=[],e=0,f=a.length,g;for(;e<f;e++)g=a[e],g.isXType(b,c)&&d.push(g);return d},g=function(a,b){var c=Ext.Array,d=[],e=0,f=a.length,g;for(;e<f;e++)g=a[e],g.hasCls(b)&&d.push(g);return d},h=function(a,b,c,d){var e=[],f=0,g=a.length,h;for(;f<g;f++)h=a[f],(d?String(h[b])===d:!!h[b])&&e.push(h);return e},i=function(a,b){var c=[],d=0,e=a.length,f;for(;d<e;d++)f=a[d],f.getItemId()===b&&c.push(f);return c},j=function(b,c,d){return a.pseudos[c](b,d)},k=/^(\s?([>\^])\s?|\s|$)/,l=/^(#)?([\w\-]+|\*)(?:\((true|false)\))?/,m=[{re:/^\.([\w\-]+)(?:\((true|false)\))?/,method:f},{re:/^(?:[\[](?:@)?([\w\-]+)\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]])/,method:h},{re:/^#([\w\-]+)/,method:i},{re:/^\:([\w\-]+)(?:\(((?:\{[^\}]+\})|(?:(?!\{)[^\s>\/]*?(?!\})))\))?/,method:j},{re:/^(?:\{([^\}]+)\})/,method:b}];a.Query=Ext.extend(Object,{constructor:function(a){a=a||{},Ext.apply(this,a)},execute:function(a){var b=this.operations,f=0,g=b.length,h,i;a?Ext.isArray(a)?i=a:a.isMixedCollection&&(i=a.items):i=Ext.ComponentManager.all.getArray();for(;f<g;f++){h=b[f],h.mode==="^"?i=e(i||[a]):h.mode?i=d(i||[a],h.mode):i=c(i||d([a]),h);if(f===g-1)return i}return[]},is:function(a){var b=this.operations,d=Ext.isArray(a)?a:[a],e=d.length,f=b[b.length-1],g,h;d=c(d,f);if(d.length===e){if(b.length>1)for(h=0,g=d.length;h<g;h++)if(Ext.Array.indexOf(this.execute(),d[h])===-1)return!1;return!0}return!1}}),Ext.apply(this,{cache:{},pseudos:{not:function(a,b){var c=Ext.ComponentQuery,d=0,e=a.length,f=[],g=-1,h;for(;d<e;++d)h=a[d],c.is(h,b)||(f[++g]=h);return f},last:function(a){return a[a.length-1]}},query:function(a,b){var c=a.split(","),d=c.length,e=0,f=[],g=[],h={},i,j,k;for(;e<d;e++)a=Ext.String.trim(c[e]),i=this.cache[a]||(this.cache[a]=this.parse(a)),f=f.concat(i.execute(b));if(d>1){j=f.length;for(e=0;e<j;e++)k=f[e],h[k.id]||(g.push(k),h[k.id]=!0);f=g}return f},is:function(a,b){if(!b)return!0;var c=b.split(","),d=c.length,e=0,f;for(;e<d;e++){b=Ext.String.trim(c[e]),f=this.cache[b]||(this.cache[b]=this.parse(b));if(f.is(a))return!0}},parse:function(b){var c=[],d=m.length,e,h,j,n,o,p,q,r;while(b&&e!==b){e=b,h=b.match(l),h&&(j=h[1],j==="#"?c.push({method:i,args:[Ext.String.trim(h[2])]}):j==="."?c.push({method:g,args:[Ext.String.trim(h[2])]}):c.push({method:f,args:[Ext.String.trim(h[2]),Boolean(h[3])]}),b=b.replace(h[0],""));while(!(n=b.match(k)))for(p=0;b&&p<d;p++){q=m[p],o=b.match(q.re),r=q.method;if(o){c.push({method:Ext.isString(q.method)?Ext.functionFactory("items",Ext.String.format.apply(Ext.String,[r].concat(o.slice(1)))):q.method,args:o.slice(1)}),b=b.replace(o[0],"");break}p===d-1&&Ext.Error.raise('Invalid ComponentQuery selector: "'+arguments[0]+'"')}n[1]&&(c.push({mode:n[2]||n[1]}),b=b.replace(n[0],""))}return new a.Query({operations:c})}})}),Ext.define("Ext.Template",{requires:["Ext.dom.Helper","Ext.util.Format"],inheritableStatics:{from:function(a,b){return a=Ext.getDom(a),new this(a.value||a.innerHTML,b||"")}},constructor:function(a){var b=this,c=arguments,d=[],e=0,f=c.length,g;b.initialConfig={},f===1&&Ext.isArray(a)&&(c=a,f=c.length);if(f>1)for(;e<f;e++)g=c[e],typeof g=="object"?(Ext.apply(b.initialConfig,g),Ext.apply(b,g)):d.push(g);else d.push(a);b.html=d.join(""),b.compiled&&b.compile()},isTemplate:!0,disableFormats:!1,re:/\{([\w\-]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?\}/g,apply:function(a){function g(b,f,g,h){return g&&c?(h?h=[a[f]].concat(Ext.functionFactory("return ["+h+"];")()):h=[a[f]],g.substr(0,5)=="this."?e[g.substr(5)].apply(e,h):d[g].apply(d,h)):a[f]!==undefined?a[f]:""}var b=this,c=b.disableFormats!==!0,d=Ext.util.Format,e=b,f;return b.compiled?b.compiled(a).join(""):(f=b.html.replace(b.re,g),f)},applyOut:function(a,b){var c=this;return c.compiled?b.push.apply(b,c.compiled(a)):b.push(c.apply(a)),b},applyTemplate:function(){return this.apply.apply(this,arguments)},set:function(a,b){var c=this;return c.html=a,c.compiled=null,b?c.compile():c},compileARe:/\\/g,compileBRe:/(\r\n|\n)/g,compileCRe:/'/g,compile:function(){function fn(a,b,c,d){return c&&useFormat?(d=d?","+d:"",c.substr(0,5)!="this."?c="fm."+c+"(":c="this."+c.substr(5)+"("):(d="",c="(values['"+b+"'] == undefined ? '' : "),"',"+c+"values['"+b+"']"+d+") ,'"}var me=this,fm=Ext.util.Format,useFormat=me.disableFormats!==!0,body,bodyReturn;return bodyReturn=me.html.replace(me.compileARe,"\\\\").replace(me.compileBRe,"\\n").replace(me.compileCRe,"\\'").replace(me.re,fn),body="this.compiled = function(values){ return ['"+bodyReturn+"'];};",eval(body),me},insertFirst:function(a,b,c){return this.doInsert("afterBegin",a,b,c)},insertBefore:function(a,b,c){return this.doInsert("beforeBegin",a,b,c)},insertAfter:function(a,b,c){return this.doInsert("afterEnd",a,b,c)},append:function(a,b,c){return this.doInsert("beforeEnd",a,b,c)},doInsert:function(a,b,c,d){var e=Ext.DomHelper.insertHtml(a,Ext.getDom(b),this.apply(c));return d?Ext.get(e):e},overwrite:function(a,b,c){var d=Ext.DomHelper.overwrite(Ext.getDom(a),this.apply(b));return c?Ext.get(d):d}}),Ext.define("Ext.XTemplateParser",{constructor:function(a){Ext.apply(this,a)},doTpl:Ext.emptyFn,parse:function(a){var b=this,c=a.length,d={elseif:"elif"},e=b.topRe,f=b.actionsRe,g,h,i,j,k,l,m,n,o,p,q,r;b.level=0,b.stack=h=[];for(g=0;g<c;g=p){e.lastIndex=g,j=e.exec(a);if(!j){b.doText(a.substring(g,c));break}o=j.index,p=e.lastIndex,g<o&&b.doText(a.substring(g,o));if(j[1])p=a.indexOf("%}",o+2),b.doEval(a.substring(o+2,p)),p+=2;else if(j[2])p=a.indexOf("]}",o+2),b.doExpr(a.substring(o+2,p)),p+=2;else if(j[3])b.doTag(j[3]);else if(j[4]){q=null;while((n=f.exec(j[4]))!==null)i=n[2]||n[3],i&&(i=Ext.String.htmlDecode(i),k=n[1],k=d[k]||k,q=q||{},l=q[k],typeof l=="string"?q[k]=[l,i]:l?q[k].push(i):q[k]=i);if(!q)b.elseRe.test(j[4])?b.doElse():b.defaultRe.test(j[4])?b.doDefault():(b.doTpl(),h.push({type:"tpl"}));else if(q["if"])b.doIf(q["if"],q),h.push({type:"if"});else if(q["switch"])b.doSwitch(q["switch"],q),h.push({type:"switch"});else if(q["case"])b.doCase(q["case"],q);else if(q.elif)b.doElseIf(q.elif,q);else if(q["for"]){++b.level;if(r=b.propRe.exec(j[4]))q.propName=r[1]||r[2];b.doFor(q["for"],q),h.push({type:"for",actions:q})}else q.exec&&(b.doExec(q.exec,q),h.push({type:"exec",actions:q}))}else j[0].length===5?h.push({type:"tpl"}):(m=h.pop(),b.doEnd(m.type,m.actions),m.type=="for"&&--b.level)}},topRe:/(?:(\{\%)|(\{\[)|\{([^{}]*)\})|(?:<tpl([^>]*)\>)|(?:<\/tpl>)/g,actionsRe:/\s*(elif|elseif|if|for|exec|switch|case|eval)\s*\=\s*(?:(?:"([^"]*)")|(?:'([^']*)'))\s*/g,propRe:/prop=(?:(?:"([^"]*)")|(?:'([^']*)'))/,defaultRe:/^\s*default\s*$/,elseRe:/^\s*else\s*$/}),Ext.define("Ext.chart.Callout",{constructor:function(a){a.callouts&&(a.callouts.styles=Ext.applyIf(a.callouts.styles||{},{color:"#000",font:"11px Helvetica, sans-serif"}),this.callouts=Ext.apply(this.callouts||{},a.callouts),this.calloutsArray=[])},renderCallouts:function(){if(!this.callouts)return;var a=this,b=a.items,c=a.chart.animate,d=a.callouts,e=d.styles,f=a.calloutsArray,g=a.chart.store,h=g.getCount(),i=b.length/h,j=[],k,l,m,n,o,p,q,r;for(k=0,l=0;k<h;k++)for(m=0;m<i;m++){o=b[l],p=f[l],q=g.getAt(k),r=d.filter(q);if(!r&&!p){l++;continue}p||(f[l]=p=a.onCreateCallout(q,o,k,r,m,l));for(n in p)p[n]&&p[n].setAttributes&&p[n].setAttributes(e,!0);if(!r)for(n in p)p[n]&&(p[n].setAttributes?p[n].setAttributes({hidden:!0},!0):p[n].setVisible&&p[n].setVisible(!1));d.renderer(p,q),a.onPlaceCallout(p,q,o,k,r,c,m,l,j),j.push(p),l++}this.hideCallouts(l)},onCreateCallout:function(a,b,c,d){var e=this,f=e.calloutsGroup,g=e.callouts,h=g.styles,i=h.width,j=h.height,k=e.chart,l=k.surface,m={lines:!1};return m.lines=l.add(Ext.apply({},{type:"path",path:"M0,0",stroke:e.getLegendColor()||"#555"},h)),g.items&&(m.panel=new Ext.Panel({style:"position: absolute;",width:i,height:j,items:g.items,renderTo:k.el})),m},hideCallouts:function(a){var b=this.calloutsArray,c=b.length,d,e;while(c-->a){d=b[c];for(e in d)d[e]&&d[e].hide(!0)}}}),Ext.define("Ext.chart.Navigation",{constructor:function(){this.originalStore=this.store},setZoom:function(a){var b=this,c=b.axes,d=c.items,e,f,g,h=b.chartBBox,i=1/h.width,j=1/h.height,k={x:a.x*i,y:a.y*j,width:a.width*i,height:a.height*j},l,m,n;for(e=0,f=d.length;e<f;e++)g=d[e],l=g.calcEnds(),g.position=="bottom"||g.position=="top"?(m=(l.to-l.from)*k.x+l.from,n=(l.to-l.from)*k.width+m,g.minimum=m,g.maximum=n):(n=(l.to-l.from)*(1-k.y)+l.from,m=n-(l.to-l.from)*k.height,g.minimum=m,g.maximum=n);b.redraw(!1)},restoreZoom:function(){this.originalStore&&(this.store=this.substore=this.originalStore,this.redraw(!0))}}),Ext.define("Ext.chart.Shape",{singleton:!0,circle:function(a,b){return a.add(Ext.apply({type:"circle",x:b.x,y:b.y,stroke:null,radius:b.radius},b))},line:function(a,b){return a.add(Ext.apply({type:"rect",x:b.x-b.radius,y:b.y-b.radius,height:2*b.radius,width:2*b.radius/5},b))},square:function(a,b){return a.add(Ext.applyIf({type:"rect",x:b.x-b.radius,y:b.y-b.radius,height:2*b.radius,width:2*b.radius,radius:null},b))},triangle:function(a,b){return b.radius*=1.75,a.add(Ext.apply({type:"path",stroke:null,path:"M".concat(b.x,",",b.y,"m0-",b.radius*.58,"l",b.radius*.5,",",b.radius*.87,"-",b.radius,",0z")},b))},diamond:function(a,b){var c=b.radius;return c*=1.5,a.add(Ext.apply({type:"path",stroke:null,path:["M",b.x,b.y-c,"l",c,c,-c,c,-c,-c,c,-c,"z"]},b))},cross:function(a,b){var c=b.radius;return c/=1.7,a.add(Ext.apply({type:"path",stroke:null,path:"M".concat(b.x-c,",",b.y,"l",[-c,-c,c,-c,c,c,c,-c,c,c,-c,c,c,c,-c,c,-c,-c,-c,c,-c,-c,"z"])},b))},plus:function(a,b){var c=b.radius/1.3;return a.add(Ext.apply({type:"path",stroke:null,path:"M".concat(b.x-c/2,",",b.y-c/2,"l",[0,-c,c,0,0,c,c,0,0,c,-c,0,0,c,-c,0,0,-c,-c,0,0,-c,"z"])},b))},arrow:function(a,b){var c=b.radius;return a.add(Ext.apply({type:"path",path:"M".concat(b.x-c*.7,",",b.y-c*.4,"l",[c*.6,0,0,-c*.4,c,c*.8,-c,c*.8,0,-c*.4,-c*.6,0],"z")},b))},drop:function(a,b,c,d,e,f){e=e||30,f=f||0,a.add({type:"path",path:["M",b,c,"l",e,0,"A",e*.4,e*.4,0,1,0,b+e*.7,c-e*.7,"z"],fill:"#000",stroke:"none",rotate:{degrees:22.5-f,x:b,y:c}}),f=(f+90)*Math.PI/180,a.add({type:"text",x:b+e*Math.sin(f)-10,y:c+e*Math.cos(f)+5,text:d,"font-size":e*12/40,stroke:"none",fill:"#fff"})}}),Ext.define("Ext.data.IdGenerator",{isGenerator:!0,constructor:function(a){var b=this;Ext.apply(b,a),b.id&&(Ext.data.IdGenerator.all[b.id]=b)},getRecId:function(a){return a.modelName+"-"+a.internalId},statics:{all:{},get:function(a){var b,c,d;if(typeof a=="string")c=d=a,a=null;else{if(a.isGenerator)return a;c=a.id||a.type,d=a.type}return b=this.all[c],b||(b=Ext.create("idgen."+d,a)),b}}}),Ext.define("Ext.data.JsonP",{singleton:!0,statics:{requestCount:0,requests:{}},timeout:3e4,disableCaching:!0,disableCachingParam:"_dc",callbackKey:"callback",request:function(a){a=Ext.apply({},a);var b=this,c=Ext.isDefined(a.disableCaching)?a.disableCaching:b.disableCaching,d=a.disableCachingParam||b.disableCachingParam,e=++b.statics().requestCount,f=a.callbackName||"callback"+e,g=a.callbackKey||b.callbackKey,h=Ext.isDefined(a.timeout)?a.timeout:b.timeout,i=Ext.apply({},a.params),j=a.url,k=Ext.name,l,m;return i[g]=k+".data.JsonP."+f,c&&(i[d]=(new Date).getTime()),m=b.createScript(j,i,a),b.statics().requests[e]=l={url:j,params:i,script:m,id:e,scope:a.scope,success:a.success,failure:a.failure,callback:a.callback,callbackKey:g,callbackName:f},h>0&&(l.timeout=setTimeout(Ext.bind(b.handleTimeout,b,[l]),h)),b.setupErrorHandling(l),b[f]=Ext.bind(b.handleResponse,b,[l],!0),b.loadScript(l),l},abort:function(a){var b=this,c=b.statics().requests,d;if(a)a.id||(a=c[a]),b.handleAbort(a);else for(d in c)c.hasOwnProperty(d)&&b.abort(c[d])},setupErrorHandling:function(a){a.script.onerror=Ext.bind(this.handleError,this,[a])},handleAbort:function(a){a.errorType="abort",this.handleResponse(null,a)},handleError:function(a){a.errorType="error",this.handleResponse(null,a)},cleanupErrorHandling:function(a){a.script.onerror=null},handleTimeout:function(a){a.errorType="timeout",this.handleResponse(null,a)},handleResponse:function(a,b){var c=!0;b.timeout&&clearTimeout(b.timeout),delete this[b.callbackName],delete this.statics().requests[b.id],this.cleanupErrorHandling(b),Ext.fly(b.script).remove(),b.errorType?(c=!1,Ext.callback(b.failure,b.scope,[b.errorType])):Ext.callback(b.success,b.scope,[a]),Ext.callback(b.callback,b.scope,[c,a,b.errorType])},createScript:function(a,b,c){var d=document.createElement("script");return d.setAttribute("src",Ext.urlAppend(a,Ext.Object.toQueryString(b))),d.setAttribute("async",!0),d.setAttribute("type","text/javascript"),d},loadScript:function(a){Ext.getHead().appendChild(a.script)}}),Ext.define("Ext.data.Operation",{synchronous:!0,action:undefined,filters:undefined,sorters:undefined,groupers:undefined,start:undefined,limit:undefined,batch:undefined,callback:undefined,scope:undefined,started:!1,running:!1,complete:!1,success:undefined,exception:!1,error:undefined,actionCommitRecordsRe:/^(?:create|update)$/i,actionSkipSyncRe:/^destroy$/i,constructor:function(a){Ext.apply(this,a||{})},commitRecords:function(a){var b=this,c,d,e,f,g;if(!b.actionSkipSyncRe.test(b.action)){e=b.records;if(e&&e.length){if(e.length>1){c=new Ext.util.MixedCollection,c.addAll(a);for(d=e.length;d--;)g=e[d],f=c.findBy(b.matchClientRec,g),g.copyFrom(f)}else g=e[0],f=a[0],f&&(g.phantom||g.getId()===f.getId())&&g.copyFrom(f);if(b.actionCommitRecordsRe.test(b.action))for(d=e.length;d--;)e[d].commit()}}},matchClientRec:function(a){var b=this,c=b.getId();return c&&a.getId()===c?!0:a.internalId===b.internalId},setStarted:function(){this.started=!0,this.running=!0},setCompleted:function(){this.complete=!0,this.running=!1},setSuccessful:function(){this.success=!0},setException:function(a){this.exception=!0,this.success=!1,this.running=!1,this.error=a},hasException:function(){return this.exception===!0},getError:function(){return this.error},getRecords:function(){var a=this.getResultSet();return this.records||(a?a.records:null)},getResultSet:function(){return this.resultSet},isStarted:function(){return this.started===!0},isRunning:function(){return this.running===!0},isComplete:function(){return this.complete===!0},wasSuccessful:function(){return this.isComplete()&&this.success===!0},setBatch:function(a){this.batch=a},allowWrite:function(){return this.action!="read"}}),Ext.define("Ext.data.Request",{action:undefined,params:undefined,method:"GET",url:undefined,constructor:function(a){Ext.apply(this,a)}}),Ext.define("Ext.data.ResultSet",{loaded:!0,count:0,total:0,success:!1,constructor:function(a){Ext.apply(this,a),this.totalRecords=this.total,a.count===undefined&&(this.count=this.records.length)}}),Ext.define("Ext.data.SequentialIdGenerator",{extend:"Ext.data.IdGenerator",alias:"idgen.sequential",constructor:function(){var a=this;a.callParent(arguments),a.parts=[a.prefix,""]},prefix:"",seed:1,generate:function(){var a=this,b=a.parts;return b[1]=a.seed++,b.join("")}}),Ext.define("Ext.data.SortTypes",{singleton:!0,none:function(a){return a},stripTagsRE:/<\/?[^>]+>/gi,asText:function(a){return String(a).replace(this.stripTagsRE,"")},asUCText:function(a){return String(a).toUpperCase().replace(this.stripTagsRE,"")},asUCString:function(a){return String(a).toUpperCase()},asDate:function(a){return a?Ext.isDate(a)?a.getTime():Date.parse(String(a)):0},asFloat:function(a){var b=parseFloat(String(a).replace(/,/g,""));return isNaN(b)?0:b},asInt:function(a){var b=parseInt(String(a).replace(/,/g,""),10);return isNaN(b)?0:b}}),Ext.define("Ext.data.Types",{singleton:!0,requires:["Ext.data.SortTypes"]},function(){var a=Ext.data.SortTypes;Ext.apply(Ext.data.Types,{stripRe:/[\$,%]/g,AUTO:{sortType:a.none,type:"auto"},STRING:{convert:function(a){var b=this.useNull?null:"";return a===undefined||a===null?b:String(a)},sortType:a.asUCString,type:"string"},INT:{convert:function(a){return a!==undefined&&a!==null&&a!==""?parseInt(String(a).replace(Ext.data.Types.stripRe,""),10):this.useNull?null:0},sortType:a.none,type:"int"},FLOAT:{convert:function(a){return a!==undefined&&a!==null&&a!==""?parseFloat(String(a).replace(Ext.data.Types.stripRe,""),10):this.useNull?null:0},sortType:a.none,type:"float"},BOOL:{convert:function(a){return!this.useNull||a!==undefined&&a!==null&&a!==""?a===!0||a==="true"||a==1:null},sortType:a.none,type:"bool"},DATE:{convert:function(a){var b=this.dateFormat,c;return a?Ext.isDate(a)?a:b?b=="timestamp"?new Date(a*1e3):b=="time"?new Date(parseInt(a,10)):Ext.Date.parse(a,b):(c=Date.parse(a),c?new Date(c):null):null},sortType:a.asDate,type:"date"}}),Ext.apply(Ext.data.Types,{BOOLEAN:this.BOOL,INTEGER:this.INT,NUMBER:this.FLOAT})}),Ext.define("Ext.data.UuidGenerator",function(){function e(a,b){var c=a.toString(16);return c.length>b?c=c.substring(c.length-b):c.length<b&&(c=Ext.String.leftPad(c,b,"0")),c}function f(a,b){var c=Math.random()*(b-a+1);return Math.floor(c)+a}function g(a){if(typeof a=="number"){var b=Math.floor(a/d);return{lo:Math.floor(a-b*d),hi:b}}return a}var a=Math.pow(2,14),b=Math.pow(2,16),c=Math.pow(2,28),d=Math.pow(2,32);return{extend:"Ext.data.IdGenerator",alias:"idgen.uuid",id:"uuid",version:4,constructor:function(){var a=this;a.callParent(arguments),a.parts=[],a.init()},generate:function(){var a=this,b=a.parts,c=a.timestamp;return b[0]=e(c.lo,8),b[1]=e(c.hi&65535,4),b[2]=e(c.hi>>>16&4095|a.version<<12,4),b[3]=e(128|a.clockSeq>>>8&63,2)+e(a.clockSeq&255,2),b[4]=e(a.salt.hi,4)+e(a.salt.lo,8),a.version==4?a.init():(++c.lo,c.lo>=d&&(c.lo=0,++c.hi)),b.join("-").toLowerCase()},getRecId:function(a){return a.getId()},init:function(){var e=this,i,j;e.version==4?(e.clockSeq=f(0,a-1),i=e.salt||(e.salt={}),j=e.timestamp||(e.timestamp={}),i.lo=f(0,d-1),i.hi=f(0,b-1),j.lo=f(0,d-1),j.hi=f(0,c-1)):(e.salt=g(e.salt),e.timestamp=g(e.timestamp),e.salt.hi|=256)},reconfigure:function(a){Ext.apply(this,a),this.init()}}}()),Ext.define("Ext.data.validations",{singleton:!0,presenceMessage:"must be present",lengthMessage:"is the wrong length",formatMessage:"is the wrong format",inclusionMessage:"is not included in the list of acceptable values",exclusionMessage:"is not an acceptable value",emailMessage:"is not a valid email address",emailRe:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,presence:function(a,b){return arguments.length===1&&(b=a),!!b||b===0},length:function(a,b){if(b===undefined||b===null)return!1;var c=b.length,d=a.min,e=a.max;return d&&c<d||e&&c>e?!1:!0},email:function(a,b){return Ext.data.validations.emailRe.test(b)},format:function(a,b){return!!a.matcher&&!!a.matcher.test(b)},inclusion:function(a,b){return a.list&&Ext.Array.indexOf(a.list,b)!=-1},exclusion:function(a,b){return a.list&&Ext.Array.indexOf(a.list,b)==-1}}),Ext.define("Ext.data.association.Association",{alternateClassName:"Ext.data.Association",primaryKey:"id",defaultReaderType:"json",statics:{AUTO_ID:1e3,create:function(a){if(!a.isAssociation){Ext.isString(a)&&(a={type:a});switch(a.type){case"belongsTo":return new Ext.data.association.BelongsTo(a);case"hasMany":return new Ext.data.association.HasMany(a);case"hasOne":return new Ext.data.association.HasOne(a);default:}}return a}},constructor:function(a){Ext.apply(this,a);var b=Ext.ModelManager.types,c=a.ownerModel,d=a.associatedModel,e=b[c],f=b[d],g;this.ownerModel=e,this.associatedModel=f,Ext.applyIf(this,{ownerName:c,associatedName:d}),this.associationId="association"+ ++this.statics().AUTO_ID},getReader:function(){var a=this,b=a.reader,c=a.associatedModel;return b&&(Ext.isString(b)&&(b={type:b}),b.isReader?b.setModel(c):Ext.applyIf(b,{model:c,type:a.defaultReaderType}),a.reader=Ext.createByAlias("reader."+b.type,b)),a.reader||null}}),Ext.define("Ext.data.association.BelongsTo",{extend:"Ext.data.association.Association",alternateClassName:"Ext.data.BelongsToAssociation",alias:"association.belongsto",constructor:function(a){this.callParent(arguments);var b=this,c=b.ownerModel.prototype,d=b.associatedName,e=b.getterName||"get"+d,f=b.setterName||"set"+d;Ext.applyIf(b,{name:d,foreignKey:d.toLowerCase()+"_id",instanceName:d+"BelongsToInstance",associationKey:d.toLowerCase()}),c[e]=b.createGetter(),c[f]=b.createSetter()},createSetter:function(){var a=this,b=a.foreignKey;return function(a,c,d){a&&a.isModel&&(a=a.getId()),this.set(b,a),Ext.isFunction(c)&&(c={callback:c,scope:d||this});if(Ext.isObject(c))return this.save(c)}},createGetter:function(){var a=this,b=a.associatedName,c=a.associatedModel,d=a.foreignKey,e=a.primaryKey,f=a.instanceName;return function(a,h){a=a||{};var i=this,j=i.get(d),k,l,m;return a.reload===!0||i[f]===undefined?(l=Ext.ModelManager.create({},b),l.set(e,j),typeof a=="function"&&(a={callback:a,scope:h||i}),k=a.success,a.success=function(a){i[f]=a,k&&k.apply(this,arguments)},c.load(j,a),i[f]=l,l):(l=i[f],m=[l],h=h||a.scope||i,Ext.callback(a,h,m),Ext.callback(a.success,h,m),Ext.callback(a.failure,h,m),Ext.callback(a.callback,h,m),l)}},read:function(a,b,c){a[this.instanceName]=b.read([c]).records[0]}}),Ext.define("Ext.data.association.HasOne",{extend:"Ext.data.association.Association",alternateClassName:"Ext.data.HasOneAssociation",alias:"association.hasone",constructor:function(a){this.callParent(arguments);var b=this,c=b.ownerModel.prototype,d=b.associatedName,e=b.getterName||"get"+d,f=b.setterName||"set"+d;Ext.applyIf(b,{name:d,foreignKey:d.toLowerCase()+"_id",instanceName:d+"HasOneInstance",associationKey:d.toLowerCase()}),c[e]=b.createGetter(),c[f]=b.createSetter()},createSetter:function(){var a=this,b=a.ownerModel,c=a.foreignKey;return function(a,b,d){a&&a.isModel&&(a=a.getId()),this.set(c,a),Ext.isFunction(b)&&(b={callback:b,scope:d||this});if(Ext.isObject(b))return this.save(b)}},createGetter:function(){var a=this,b=a.ownerModel,c=a.associatedName,d=a.associatedModel,e=a.foreignKey,f=a.primaryKey,g=a.instanceName;return function(a,b){a=a||{};var i=this,j=i.get(e),k,l,m;return a.reload===!0||i[g]===undefined?(l=Ext.ModelManager.create({},c),l.set(f,j),typeof a=="function"&&(a={callback:a,scope:b||i}),k=a.success,a.success=function(a){i[g]=a,k&&k.call(this,arguments)},d.load(j,a),i[g]=l,l):(l=i[g],m=[l],b=b||i,Ext.callback(a,b,m),Ext.callback(a.success,b,m),Ext.callback(a.failure,b,m),Ext.callback(a.callback,b,m),l)}},read:function(a,b,c){var d=this.associatedModel.prototype.associations.findBy(function(b){return b.type==="belongsTo"&&b.associatedName===a.$className}),e=b.read([c]).records[0];a[this.instanceName]=e,d&&(e[d.instanceName]=a)}}),Ext.define("Ext.data.writer.Writer",{alias:"writer.base",alternateClassName:["Ext.data.DataWriter","Ext.data.Writer"],writeAllFields:!0,nameProperty:"name",isWriter:!0,constructor:function(a){Ext.apply(this,a)},write:function(a){var b=a.operation,c=b.records||[],d=c.length,e=0,f=[];for(;e<d;e++)f.push(this.getRecordData(c[e],b));return this.writeRecords(a,f)},getRecordData:function(a,b){var c=a.phantom===!0,d=this.writeAllFields||c,e=this.nameProperty,f=a.fields,g=f.items,h={},i=a.clientIdProperty,j,k,l,m,n,o;if(d){o=g.length;for(n=0;n<o;n++)l=g[n],l.persist&&(k=l[e]||l.name,h[k]=a.get(l.name))}else{j=a.getChanges();for(m in j)j.hasOwnProperty(m)&&(l=f.get(m),k=l[e]||l.name,h[k]=j[m])}return c?i&&b&&b.records.length>1&&(h[i]=a.internalId):h[a.idProperty]=a.getId(),h}}),Ext.define("Ext.data.writer.Xml",{extend:"Ext.data.writer.Writer",alternateClassName:"Ext.data.XmlWriter",alias:"writer.xml",documentRoot:"xmlData",defaultDocumentRoot:"xmlData",header:"",record:"record",writeRecords:function(a,b){var c=this,d=[],e=0,f=b.length,g=c.documentRoot,h=c.record,i=b.length!==1,j,k;d.push(c.header||""),!g&&i&&(g=c.defaultDocumentRoot),g&&d.push("<",g,">");for(;e<f;++e){j=b[e],d.push("<",h,">");for(k in j)j.hasOwnProperty(k)&&d.push("<",k,">",j[k],"</",k,">");d.push("</",h,">")}return g&&d.push("</",g,">"),a.xmlData=d.join(""),a}}),Ext.define("Ext.direct.RemotingMethod",{constructor:function(a){var b=this,c=Ext.isDefined(a.params)?a.params:a.len,d,e,f,g;b.name=a.name,b.formHandler=a.formHandler;if(Ext.isNumber(c))b.len=c,b.ordered=!0;else{b.params=[],e=c.length;for(f=0;f<e;f++)g=c[f],d=Ext.isObject(g)?g.name:g,b.params.push(d)}},getArgs:function(a,b,c){var d=[],e,f;if(this.ordered){if(this.len>0)if(b)for(e=0,f=b.length;e<f;e++)d.push(a[b[e]]);else c&&d.push(a)}else d.push(a);return d},getCallData:function(a){var b=this,c=null,d=b.len,e=b.params,f,g,h;if(b.ordered)f=a[d],g=a[d+1],d!==0&&(c=a.slice(0,d));else{c=Ext.apply({},a[0]),f=a[1],g=a[2];for(h in c)c.hasOwnProperty(h)&&(Ext.Array.contains(e,h)||delete c[h])}return{data:c,callback:f,scope:g}}}),Ext.define("Ext.direct.Transaction",{alias:"direct.transaction",alternateClassName:"Ext.Direct.Transaction",statics:{TRANSACTION_ID:0},constructor:function(a){var b=this;Ext.apply(b,a),b.id=b.tid=++b.self.TRANSACTION_ID,b.retryCount=0},send:function(){this.provider.queueTransaction(this)},retry:function(){this.retryCount++,this.send()},getProvider:function(){return this.provider}}),Ext.define("Ext.draw.Color",{colorToHexRe:/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/,rgbRe:/\s*rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)\s*/,hexRe:/\s*#([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)([0-9a-fA-F][0-9a-fA-F]?)\s*/,lightnessFactor:.2,constructor:function(a,b,c){var d=this,e=Ext.Number.constrain;d.r=e(a,0,255),d.g=e(b,0,255),d.b=e(c,0,255)},getRed:function(){return this.r},getGreen:function(){return this.g},getBlue:function(){return this.b},getRGB:function(){var a=this;return[a.r,a.g,a.b]},getHSL:function(){var a=this,b=a.r/255,c=a.g/255,d=a.b/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=e-f,h,i=0,j=.5*(e+f);return f!=e&&(i=j<.5?g/(e+f):g/(2-e-f),b==e?h=60*(c-d)/g:c==e?h=120+60*(d-b)/g:h=240+60*(b-c)/g,h<0&&(h+=360),h>=360&&(h-=360)),[h,i,j]},getLighter:function(a){var b=this.getHSL();return a=a||this.lightnessFactor,b[2]=Ext.Number.constrain(b[2]+a,0,1),this.fromHSL(b[0],b[1],b[2])},getDarker:function(a){return a=a||this.lightnessFactor,this.getLighter(-a)},toString:function(){var a=this,b=Math.round,c=b(a.r).toString(16),d=b(a.g).toString(16),e=b(a.b).toString(16);return c=c.length==1?"0"+c:c,d=d.length==1?"0"+d:d,e=e.length==1?"0"+e:e,["#",c,d,e].join("")},toHex:function(a){Ext.isArray(a)&&(a=a[0]);if(!Ext.isString(a))return"";if(a.substr(0,1)==="#")return a;var b=this.colorToHexRe.exec(a),c,d,e,f;return Ext.isArray(b)?(c=parseInt(b[2],10),d=parseInt(b[3],10),e=parseInt(b[4],10),f=e|d<<8|c<<16,b[1]+"#"+("000000"+f.toString(16)).slice(-6)):a},fromString:function(a){var b,c,d,e,f=parseInt;return a.length!=4&&a.length!=7||a.substr(0,1)!=="#"?(b=a.match(this.rgbRe),b&&(c=b[1],d=b[2],e=b[3])):(b=a.match(this.hexRe),b&&(c=f(b[1],16)>>0,d=f(b[2],16)>>0,e=f(b[3],16)>>0,a.length==4&&(c+=c*16,d+=d*16,e+=e*16))),typeof c=="undefined"?undefined:new Ext.draw.Color(c,d,e)},getGrayscale:function(){return this.r*.3+this.g*.59+this.b*.11},fromHSL:function(a,b,c){var d,e,f,g,h=[],i=Math.abs,j=Math.floor;if(b==0||a==null)h=[c,c,c];else{a/=60,d=b*(1-i(2*c-1)),e=d*(1-i(a-2*j(a/2)-1)),f=c-d/2;switch(j(a)){case 0:h=[d,e,0];break;case 1:h=[e,d,0];break;case 2:h=[0,d,e];break;case 3:h=[0,e,d];break;case 4:h=[e,0,d];break;case 5:h=[d,0,e]}h=[h[0]+f,h[1]+f,h[2]+f]}return new Ext.draw.Color(h[0]*255,h[1]*255,h[2]*255)}},function(){var a=this.prototype;this.addStatics({fromHSL:function(){return a.fromHSL.apply(a,arguments)},fromString:function(){return a.fromString.apply(a,arguments)},toHex:function(){return a.toHex.apply(a,arguments)}})}),Ext.define("Ext.draw.Draw",{singleton:!0,requires:["Ext.draw.Color"],pathToStringRE:/,?([achlmqrstvxz]),?/gi,pathCommandRE:/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,pathValuesRE:/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig,stopsRE:/^(\d+%?)$/,radian:Math.PI/180,availableAnimAttrs:{along:"along",blur:null,"clip-rect":"csv",cx:null,cy:null,fill:"color","fill-opacity":null,"font-size":null,height:null,opacity:null,path:"path",r:null,rotation:"csv",rx:null,ry:null,scale:"csv",stroke:"color","stroke-opacity":null,"stroke-width":null,translation:"csv",width:null,x:null,y:null},is:function(a,b){return b=String(b).toLowerCase(),b=="object"&&a===Object(a)||b=="undefined"&&typeof a==b||b=="null"&&a===null||b=="array"&&Array.isArray&&Array.isArray(a)||Object.prototype.toString.call(a).toLowerCase().slice(8,-1)==b},ellipsePath:function(a){var b=a.attr;return Ext.String.format("M{0},{1}A{2},{3},0,1,1,{0},{4}A{2},{3},0,1,1,{0},{1}z",b.x,b.y-b.ry,b.rx,b.ry,b.y+b.ry)},rectPath:function(a){var b=a.attr;return b.radius?Ext.String.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",b.x+b.radius,b.y,b.width-b.radius*2,b.radius,-b.radius,b.height-b.radius*2,b.radius*2-b.width,b.radius*2-b.height):Ext.String.format("M{0},{1}L{2},{1},{2},{3},{0},{3}z",b.x,b.y,b.width+b.x,b.height+b.y)},path2string:function(){return this.join(",").replace(Ext.draw.Draw.pathToStringRE,"$1")},pathToString:function(a){return a.join(",").replace(Ext.draw.Draw.pathToStringRE,"$1")},parsePathString:function(a){if(!a)return null;var b={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},c=[],d=this;return d.is(a,"array")&&d.is(a[0],"array")&&(c=d.pathClone(a)),c.length||String(a).replace(d.pathCommandRE,function(a,e,f){var g=[],h=e.toLowerCase();f.replace(d.pathValuesRE,function(a,b){b&&g.push(+b)}),h=="m"&&g.length>2&&(c.push([e].concat(Ext.Array.splice(g,0,2))),h="l",e=e=="m"?"l":"L");while(g.length>=b[h]){c.push([e].concat(Ext.Array.splice(g,0,b[h])));if(!b[h])break}}),c.toString=d.path2string,c},mapPath:function(a,b){if(!b)return a;var c,d,e,f,g,h,i;a=this.path2curve(a);for(e=0,f=a.length;e<f;e++){i=a[e];for(g=1,h=i.length;g<h-1;g+=2)c=b.x(i[g],i[g+1]),d=b.y(i[g],i[g+1]),i[g]=c,i[g+1]=d}return a},pathClone:function(a){var b=[],c,d,e,f;if(!this.is(a,"array")||!this.is(a&&a[0],"array"))a=this.parsePathString(a);for(e=0,f=a.length;e<f;e++){b[e]=[];for(c=0,d=a[e].length;c<d;c++)b[e][c]=a[e][c]}return b.toString=this.path2string,b},pathToAbsolute:function(a){if(!this.is(a,"array")||!this.is(a&&a[0],"array"))a=this.parsePathString(a);var b=[],c=0,d=0,e=0,f=0,g=0,h=a.length,i,j,k,l;h&&a[0][0]=="M"&&(c=+a[0][1],d=+a[0][2],e=c,f=d,g++,b[0]=["M",c,d]);for(;g<h;g++){i=b[g]=[],j=a[g];if(j[0]!=j[0].toUpperCase()){i[0]=j[0].toUpperCase();switch(i[0]){case"A":i[1]=j[1],i[2]=j[2],i[3]=j[3],i[4]=j[4],i[5]=j[5],i[6]=+(j[6]+c),i[7]=+(j[7]+d);break;case"V":i[1]=+j[1]+d;break;case"H":i[1]=+j[1]+c;break;case"M":e=+j[1]+c,f=+j[2]+d;default:k=1,l=j.length;for(;k<l;k++)i[k]=+j[k]+(k%2?c:d)}}else{k=0,l=j.length;for(;k<l;k++)b[g][k]=j[k]}switch(i[0]){case"Z":c=e,d=f;break;case"H":c=i[1];break;case"V":d=i[1];break;case"M":j=b[g],l=j.length,e=j[l-2],f=j[l-1];default:j=b[g],l=j.length,c=j[l-2],d=j[l-1]}}return b.toString=this.path2string,b},pathToRelative:function(a){if(!this.is(a,"array")||!this.is(a&&a[0],"array"))a=this.parsePathString(a);var b=[],c=0,d=0,e=0,f=0,g=0,h,i,j,k,l,m,n,o,p;a[0][0]=="M"&&(c=a[0][1],d=a[0][2],e=c,f=d,g++,b.push(["M",c,d]));for(j=g,n=a.length;j<n;j++){h=b[j]=[],i=a[j];if(i[0]!=i[0].toLowerCase()){h[0]=i[0].toLowerCase();switch(h[0]){case"a":h[1]=i[1],h[2]=i[2],h[3]=i[3],h[4]=i[4],h[5]=i[5],h[6]=+(i[6]-c).toFixed(3),h[7]=+(i[7]-d).toFixed(3);break;case"v":h[1]=+(i[1]-d).toFixed(3);break;case"m":e=i[1],f=i[2];default:for(k=1,o=i.length;k<o;k++)h[k]=+(i[k]-(k%2?c:d)).toFixed(3)}}else{h=b[j]=[],i[0]=="m"&&(e=i[1]+c,f=i[2]+d);for(l=0,p=i.length;l<p;l++)b[j][l]=i[l]}m=b[j].length;switch(b[j][0]){case"z":c=e,d=f;break;case"h":c+=+b[j][m-1];break;case"v":d+=+b[j][m-1];break;default:c+=+b[j][m-2],d+=+b[j][m-1]}}return b.toString=this.path2string,b},path2curve:function(a){var b=this,c=b.pathToAbsolute(a),d=c.length,e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f,g,h,i;for(f=0;f<d;f++){c[f]=b.command2curve(c[f],e);if(c[f].length>7){c[f].shift(),i=c[f];while(i.length)Ext.Array.splice(c,f++,0,["C"].concat(Ext.Array.splice(i,0,6)));Ext.Array.erase(c,f,1),d=c.length,f--}g=c[f],h=g.length,e.x=g[h-2],e.y=g[h-1],e.bx=parseFloat(g[h-4])||e.x,e.by=parseFloat(g[h-3])||e.y}return c},interpolatePaths:function(a,b){var c=this,d=c.pathToAbsolute(a),e=c.pathToAbsolute(b),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=function(a,b){if(a[b].length>7){a[b].shift();var c=a[b];while(c.length)Ext.Array.splice(a,b++,0,["C"].concat(Ext.Array.splice(c,0,6)));Ext.Array.erase(a,b,1),k=Math.max(d.length,e.length||0)}},i=function(a,b,c,f,g){a&&b&&a[g][0]=="M"&&b[g][0]!="M"&&(Ext.Array.splice(b,g,0,["M",f.x,f.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],k=Math.max(d.length,e.length||0))},j,k,l,m,n,o;for(j=0,k=Math.max(d.length,e.length||0);j<k;j++)d[j]=c.command2curve(d[j],f),h(d,j),e[j]=c.command2curve(e[j],g),h(e,j),i(d,e,f,g,j),i(e,d,g,f,j),l=d[j],m=e[j],n=l.length,o=m.length,f.x=l[n-2],f.y=l[n-1],f.bx=parseFloat(l[n-4])||f.x,f.by=parseFloat(l[n-3])||f.y,g.bx=parseFloat(m[o-4])||g.x,g.by=parseFloat(m[o-3])||g.y,g.x=m[o-2],g.y=m[o-1];return[d,e]},command2curve:function(a,b){var c=this;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];a[0]!="T"&&a[0]!="Q"&&(b.qx=b.qy=null);switch(a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"].concat(c.arc2curve.apply(c,[b.x,b.y].concat(a.slice(1))));break;case"S":a=["C",b.x+(b.x-(b.bx||b.x)),b.y+(b.y-(b.by||b.y))].concat(a.slice(1));break;case"T":b.qx=b.x+(b.x-(b.qx||b.x)),b.qy=b.y+(b.y-(b.qy||b.y)),a=["C"].concat(c.quadratic2curve(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"].concat(c.quadratic2curve(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"].concat(b.x,b.y,a[1],a[2],a[1],a[2]);break;case"H":a=["C"].concat(b.x,b.y,a[1],b.y,a[1],b.y);break;case"V":a=["C"].concat(b.x,b.y,b.x,a[1],b.x,a[1]);break;case"Z":a=["C"].concat(b.x,b.y,b.X,b.Y,b.X,b.Y)}return a},quadratic2curve:function(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]},rotate:function(a,b,c){var d=Math.cos(c),e=Math.sin(c),f=a*d-b*e,g=a*e+b*d;return{x:f,y:g}},arc2curve:function(a,b,c,d,e,f,g,h,i,j){var k=this,l=Math.PI,m=k.radian,n=l*120/180,o=m*(+e||0),p=[],q=Math,r=q.cos,s=q.sin,t=q.sqrt,u=q.abs,v=q.asin,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$;j?(H=j[0],I=j[1],F=j[2],G=j[3]):(w=k.rotate(a,b,-o),a=w.x,b=w.y,w=k.rotate(h,i,-o),h=w.x,i=w.y,x=r(m*e),y=s(m*e),z=(a-h)/2,A=(b-i)/2,B=z*z/(c*c)+A*A/(d*d),B>1&&(B=t(B),c=B*c,d=B*d),C=c*c,D=d*d,E=(f==g?-1:1)*t(u((C*D-C*A*A-D*z*z)/(C*A*A+D*z*z))),F=E*c*A/d+(a+h)/2,G=E*-d*z/c+(b+i)/2,H=v(((b-G)/d).toFixed(7)),I=v(((i-G)/d).toFixed(7)),H=a<F?l-H:H,I=h<F?l-I:I,H<0&&(H=l*2+H),I<0&&(I=l*2+I),g&&H>I&&(H-=l*2),!g&&I>H&&(I-=l*2)),J=I-H,u(J)>n&&(Y=I,Z=h,$=i,I=H+n*(g&&I>H?1:-1),h=F+c*r(I),i=G+d*s(I),p=k.arc2curve(h,i,c,d,e,0,g,Z,$,[I,Y,F,G])),J=I-H,K=r(H),L=s(H),M=r(I),N=s(I),O=q.tan(J/4),P=4/3*c*O,Q=4/3*d*O,R=[a,b],S=[a+P*L,b-Q*K],T=[h+P*N,i-Q*M],U=[h,i],S[0]=2*R[0]-S[0],S[1]=2*R[1]-S[1];if(j)return[S,T,U].concat(p);p=[S,T,U].concat(p).join().split(","),V=[],X=p.length;for(W=0;W<X;W++)V[W]=W%2?k.rotate(p[W-1],p[W],o).y:k.rotate(p[W],p[W+1],o).x;return V},rotateAndTranslatePath:function(a){var b=a.rotation.degrees,c=a.rotation.x,d=a.rotation.y,e=a.translation.x,f=a.translation.y,g,h,i,j,k,l=[];if(!b&&!e&&!f)return this.pathToAbsolute(a.attr.path);e=e||0,f=f||0,g=this.pathToAbsolute(a.attr.path);for(h=g.length;h--;){i=l[h]=g[h].slice();if(i[0]=="A")j=this.rotatePoint(i[6],i[7],b,c,d),i[6]=j.x+e,i[7]=j.y+f;else{k=1;while(i[k+1]!=null)j=this.rotatePoint(i[k],i[k+1],b,c,d),i[k]=j.x+e,i[k+1]=j.y+f,k+=2}}return l},rotatePoint:function(a,b,c,d,e){if(!c)return{x:a,y:b};d=d||0,e=e||0,a-=d,b-=e,c*=this.radian;var f=Math.cos(c),g=Math.sin(c);return{x:a*f-b*g+d,y:a*g+b*f+e}},pathDimensions:function(a){if(!a||!(a+""))return{x:0,y:0,width:0,height:0};a=this.path2curve(a);var b=0,c=0,d=[],e=[],f=0,g=a.length,h,i,j,k;for(;f<g;f++)h=a[f],h[0]=="M"?(b=h[1],c=h[2],d.push(b),e.push(c)):(k=this.curveDim(b,c,h[1],h[2],h[3],h[4],h[5],h[6]),d=d.concat(k.min.x,k.max.x),e=e.concat(k.min.y,k.max.y),b=h[5],c=h[6]);return i=Math.min.apply(0,d),j=Math.min.apply(0,e),{x:i,y:j,path:a,width:Math.max.apply(0,d)-i,height:Math.max.apply(0,e)-j}},intersectInside:function(a,b,c){return(c[0]-b[0])*(a[1]-b[1])>(c[1]-b[1])*(a[0]-b[0])},intersectIntersection:function(a,b,c,d){var e=[],f=c[0]-d[0],g=c[1]-d[1],h=a[0]-b[0],i=a[1]-b[1],j=c[0]*d[1]-c[1]*d[0],k=a[0]*b[1]-a[1]*b[0],l=1/(f*i-g*h);return e[0]=(j*h-k*f)*l,e[1]=(j*i-k*g)*l,e},intersect:function(a,b){var c=this,d=0,e=b.length,f=b[e-1],g=a,h,i,j,k,l,m,n;for(;d<e;++d){h=b[d],m=g,g=[],i=m[m.length-1],n=0,l=m.length;for(;n<l;n++)j=m[n],c.intersectInside(j,f,h)?(c.intersectInside(i,f,h)||g.push(c.intersectIntersection(i,j,f,h)),g.push(j)):c.intersectInside(i,f,h)&&g.push(c.intersectIntersection(i,j,f,h)),i=j;f=h}return g},bezier:function(a,b,c,d,e){if(e===0)return a;if(e===1)return d;var f=1-e,g=f*f*f,h=e/f;return g*(a+h*(3*b+h*(3*c+d*h)))},bezierDim:function(a,b,c,d){var e=[],f,g,h,i,j,k,l,m,n,o;a+3*c==d+3*b?(f=a-b,f/=2*(a-b-b+c),f<1&&f>0&&e.push(f)):(g=a-3*b+3*c-d,h=2*(a-b-b+c),i=a-b,j=h*h-4*g*i,k=g+g,j===0?(f=h/k,f<1&&f>0&&e.push(f)):j>0&&(l=Math.sqrt(j),f=(l+h)/k,f<1&&f>0&&e.push(f),f=(h-l)/k,f<1&&f>0&&e.push(f))),m=Math.min(a,d),n=Math.max(a,d);for(o=0;o<e.length;o++)m=Math.min(m,this.bezier(a,b,c,d,e[o])),n=Math.max(n,this.bezier(a,b,c,d,e[o]));return[m,n]},curveDim:function(a,b,c,d,e,f,g,h){var i=this.bezierDim(a,c,e,g),j=this.bezierDim(b,d,f,h);return{min:{x:i[0],y:j[0]},max:{x:i[1],y:j[1]}}},getAnchors:function(a,b,c,d,e,f,g){g=g||4;var h=Math,i=h.PI,j=i/2,k=h.abs,l=h.sin,m=h.cos,n=h.atan,o,p,q,r,s,t,u,v,w;o=(c-a)/g,p=(e-c)/g,d>=b&&d>=f||d<=b&&d<=f?q=r=j:(q=n((c-a)/k(d-b)),b<d&&(q=i-q),r=n((e-c)/k(d-f)),f<d&&(r=i-r)),w=j-(q+r)%(i*2)/2,w>j&&(w-=i),q+=w,r+=w,s=c-o*l(q),t=d+o*m(q),u=c+p*l(r),v=d+p*m(r);if(d>b&&t<b||d<b&&t>b)s+=k(b-t)*(s-c)/(t-d),t=b;if(d>f&&v<f||d<f&&v>f)u-=k(f-v)*(u-c)/(v-d),v=f;return{x1:s,y1:t,x2:u,y2:v}},smooth:function(a,b){var c=this.path2curve(a),d=[c[0]],e=c[0][1],f=c[0][2],g,h,i=1,j=c.length,k=1,l=e,m=f,n=0,o=0,p,q,r,s,t,u,v;for(;i<j;i++){p=c[i],q=p.length,r=c[i-1],s=r.length,t=c[i+1],u=t&&t.length;if(p[0]=="M"){l=p[1],m=p[2],g=i+1;while(c[g][0]!="C")g++;n=c[g][5],o=c[g][6],d.push(["M",l,m]),k=d.length,e=l,f=m;continue}p[q-2]!=l||p[q-1]!=m||!!t&&t[0]!="M"?!t||t[0]=="M"?h={x1:p[q-2],y1:p[q-1]}:h=this.getAnchors(r[s-2],r[s-1],p[q-2],p[q-1],t[u-2],t[u-1],b):(v=d[k].length,h=this.getAnchors(r[s-2],r[s-1],l,m,d[k][v-2],d[k][v-1],b),d[k][1]=h.x2,d[k][2]=h.y2),d.push(["C",e,f,h.x1,h.y1,p[q-2],p[q-1]]),e=h.x2,f=h.y2}return d},findDotAtSegment:function(a,b,c,d,e,f,g,h,i){var j=1-i;return{x:Math.pow(j,3)*a+Math.pow(j,2)*3*i*c+j*3*i*i*e+Math.pow(i,3)*g,y:Math.pow(j,3)*b+Math.pow(j,2)*3*i*d+j*3*i*i*f+Math.pow(i,3)*h}},snapEnds:function(a,b,c,d){if(Ext.isDate(a))return this.snapEndsByDate(a,b,c);var e=(b-a)/c,f=Math.floor(Math.log(e)/Math.LN10)+1,g=Math.pow(10,f),h,i=Math.round(e%g*Math.pow(10,2-f)),j=[[0,15],[20,4],[30,2],[40,4],[50,9],[60,4],[70,2],[80,4],[100,15]],k=0,l,m,n,o,p=1e9,q=j.length;h=a=Math.floor(a/g)*g;if(d){for(n=0;n<q;n++)l=j[n][0],m=l-i<0?1e6:(l-i)/j[n][1],m<p&&(o=l,p=m);e=Math.floor(e*Math.pow(10,-f))*Math.pow(10,f)+o*Math.pow(10,f-2);while(h<b)h+=e,k++;b=+h.toFixed(10)}else k=c;return{from:a,to:b,power:f,step:e,steps:k}},snapEndsByDate:function(a,b,c,d){var e=!1,f=[[Ext.Date.MILLI,[1,2,3,5,10,20,30,50,100,200,300,500]],[Ext.Date.SECOND,[1,2,3,5,10,15,30]],[Ext.Date.MINUTE,[1,2,3,5,10,20,30]],[Ext.Date.HOUR,[1,2,3,4,6,12]],[Ext.Date.DAY,[1,2,3,7,14]],[Ext.Date.MONTH,[1,2,3,4,6]]],g=f.length,h=!1,i,j,k,l;for(l=0;l<g;l++){i=f[l];if(!h)for(j=0;j<i[1].length;j++)if(b<Ext.Date.add(a,i[0],i[1][j]*c)){e=[i[0],i[1][j]],h=!0;break}}return e||(k=this.snapEnds(a.getFullYear(),b.getFullYear()+1,c,d),e=[Date.YEAR,Math.round(k.step)]),this.snapEndsByDateAndStep(a,b,e,d)},snapEndsByDateAndStep:function(a,b,c,d){var e=[a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()],f=0,g,h;if(d)g=a;else switch(c[0]){case Ext.Date.MILLI:g=new Date(e[0],e[1],e[2],e[3],e[4],e[5],Math.floor(e[6]/c[1])*c[1]);break;case Ext.Date.SECOND:g=new Date(e[0],e[1],e[2],e[3],e[4],Math.floor(e[5]/c[1])*c[1],0);break;case Ext.Date.MINUTE:g=new Date(e[0],e[1],e[2],e[3],Math.floor(e[4]/c[1])*c[1],0,0);break;case Ext.Date.HOUR:g=new Date(e[0],e[1],e[2],Math.floor(e[3]/c[1])*c[1],0,0,0);break;case Ext.Date.DAY:g=new Date(e[0],e[1],Math.floor(e[2]-1/c[1])*c[1]+1,0,0,0,0);break;case Ext.Date.MONTH:g=new Date(e[0],Math.floor(e[1]/c[1])*c[1],1,0,0,0,0);break;default:g=new Date(Math.floor(e[0]/c[1])*c[1],0,1,0,0,0,0)}h=g;while(h<b)h=Ext.Date.add(h,c[0],c[1]),f++;return d&&(h=b),{from:+g,to:+h,step:(h-g)/f,steps:f}},sorter:function(a,b){return a.offset-b.offset},rad:function(a){return a%360*Math.PI/180},degrees:function(a){return a*180/Math.PI%360},withinBox:function(a,b,c){return c=c||{},a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height},parseGradient:function(a){var b=this,c=a.type||"linear",d=a.angle||0,e=b.radian,f=a.stops,g=[],h,i,j,k;c=="linear"&&(i=[0,0,Math.cos(d*e),Math.sin(d*e)],j=1/(Math.max(Math.abs(i[2]),Math.abs(i[3]))||1),i[2]*=j,i[3]*=j,i[2]<0&&(i[0]=-i[2],i[2]=0),i[3]<0&&(i[1]=-i[3],i[3]=0));for(h in f)f.hasOwnProperty(h)&&b.stopsRE.test(h)&&(k={offset:parseInt(h,10),color:Ext.draw.Color.toHex(f[h].color)||"#ffffff",opacity:f[h].opacity||1},g.push(k));return Ext.Array.sort(g,b.sorter),c=="linear"?{id:a.id,type:c,vector:i,stops:g}:{id:a.id,type:c,centerX:a.centerX,centerY:a.centerY,focalX:a.focalX,focalY:a.focalY,radius:a.radius,vector:i,stops:g}}}),Ext.define("Ext.draw.Matrix",{requires:["Ext.draw.Draw"],constructor:function(a,b,c,d,e,f){a!=null?this.matrix=[[a,c,e],[b,d,f],[0,0,1]]:this.matrix=[[1,0,0],[0,1,0],[0,0,1]]},add:function(a,b,c,d,e,f){var g=this,h=[[],[],[]],i=[[a,c,e],[b,d,f],[0,0,1]],j,k,l,m;for(j=0;j<3;j++)for(k=0;k<3;k++){m=0;for(l=0;l<3;l++)m+=g.matrix[j][l]*i[l][k];h[j][k]=m}g.matrix=h},prepend:function(a,b,c,d,e,f){var g=this,h=[[],[],[]],i=[[a,c,e],[b,d,f],[0,0,1]],j,k,l,m;for(j=0;j<3;j++)for(k=0;k<3;k++){m=0;for(l=0;l<3;l++)m+=i[j][l]*g.matrix[l][k];h[j][k]=m}g.matrix=h},invert:function(){var a=this.matrix,b=a[0][0],c=a[1][0],d=a[0][1],e=a[1][1],f=a[0][2],g=a[1][2],h=b*e-c*d;return new Ext.draw.Matrix(e/h,-c/h,-d/h,b/h,(d*g-e*f)/h,(c*f-b*g)/h)},clone:function(){var a=this.matrix,b=a[0][0],c=a[1][0],d=a[0][1],e=a[1][1],f=a[0][2],g=a[1][2];return new Ext.draw.Matrix(b,c,d,e,f,g)},translate:function(a,b){this.prepend(1,0,0,1,a,b)},scale:function(a,b,c,d){var e=this;b==null&&(b=a),e.add(1,0,0,1,c,d),e.add(a,0,0,b,0,0),e.add(1,0,0,1,-c,-d)},rotate:function(a,b,c){a=Ext.draw.Draw.rad(a);var d=this,e=+Math.cos(a).toFixed(9),f=+Math.sin(a).toFixed(9);d.add(e,f,-f,e,b,c),d.add(1,0,0,1,-b,-c)},x:function(a,b){var c=this.matrix;return a*c[0][0]+b*c[0][1]+c[0][2]},y:function(a,b){var c=this.matrix;return a*c[1][0]+b*c[1][1]+c[1][2]},get:function(a,b){return+this.matrix[a][b].toFixed(4)},toString:function(){var a=this;return[a.get(0,0),a.get(0,1),a.get(1,0),a.get(1,1),0,0].join()},toSvg:function(){var a=this;return"matrix("+[a.get(0,0),a.get(1,0),a.get(0,1),a.get(1,1),a.get(0,2),a.get(1,2)].join()+")"},toFilter:function(a,b){var c=this;return a=a||0,b=b||0,"progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', filterType='bilinear', M11="+c.get(0,0)+", M12="+c.get(0,1)+", M21="+c.get(1,0)+", M22="+c.get(1,1)+", Dx="+(c.get(0,2)+a)+", Dy="+(c.get(1,2)+b)+")"},offset:function(){var a=this.matrix;return[(a[0][2]||0).toFixed(4),(a[1][2]||0).toFixed(4)]},split:function(){function a(a){return a[0]*a[0]+a[1]*a[1]}function b(b){var c=Math.sqrt(a(b));b[0]/=c,b[1]/=c}var c=this.matrix,d={translateX:c[0][2],translateY:c[1][2]},e;return e=[[c[0][0],c[0][1]],[c[1][1],c[1][1]]],d.scaleX=Math.sqrt(a(e[0])),b(e[0]),d.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*d.shear,e[1][1]-e[0][1]*d.shear],d.scaleY=Math.sqrt(a(e[1])),b(e[1]),d.shear/=d.scaleY,d.rotate=Math.asin(-e[0][1]),d.isSimple=!+d.shear.toFixed(9)&&(d.scaleX.toFixed(9)==d.scaleY.toFixed(9)||!d.rotate),d}}),Ext.define("Ext.draw.engine.ImageExporter",{singleton:!0,statics:function(){var a={"image/png":1,"image/jpeg":1},b=function(b){return b.hasOwnProperty("width")&&(j=b.width),b.hasOwnProperty("height")&&(k=b.height),!b.hasOwnProperty("type")||!a[b.type]?!1:(i=b.type,d&&f&&e&&g&&h?!0:(d=d||Ext.get(document.createElement("form")),d.set({action:"http://svg.sencha.io",method:"POST"}),f=f||Ext.get(document.createElement("input")),f.set({name:"svg",type:"hidden"}),e=e||Ext.get(document.createElement("input")),e.set({name:"type",type:"hidden"}),g=g||Ext.get(document.createElement("input")),g.set({name:"width",type:"hidden"}),h=h||Ext.get(document.createElement("input")),h.set({name:"height",type:"hidden"}),d.appendChild(f),d.appendChild(e),d.appendChild(g),d.appendChild(h),Ext.getBody().appendChild(d),!0))},c=function(a){var b=Ext.draw.engine.SvgExporter.self.generate({},a);g.set({value:j||a.width}),h.set({value:k||a.height}),i&&e.set({value:i}),f.set({value:b}),d.dom.submit()},d,e,f,g,h,i,j,k;return{generate:function(a,d){if(!b(a))return!1;c(d)}}}()}),Ext.define("Ext.draw.engine.SvgExporter",{singleton:!0,statics:function(){var a,b,c,d,e=function(e){a=e,b=a.length,c=a.width,d=a.height},f={path:function(a){var b=a.attr,c=b.path,d="",e,f,g;if(Ext.isArray(c[0])){g=c.length;for(f=0;f<g;f++)d+=c[f].join(" ")}else Ext.isArray(c)?d=c.join(" "):d=c.replace(/,/g," ");return e=i({d:d,fill:b.fill||"none",stroke:b.stroke,"fill-opacity":b.opacity,"stroke-width":b["stroke-width"],"stroke-opacity":b["stroke-opacity"],"z-index":b.zIndex,transform:a.matrix.toSvg()}),"<path "+e+"/>"},text:function(a){var b=a.attr,c=/(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)\s('*.*'*)/,d=c.exec(b.font),e=d&&d[1]||"12",f=d&&d[3]||"Arial",g=b.text,h=Ext.isFF3_0||Ext.isFF3_5?2:4,j="",k;return a.getBBox(),j+='<tspan x="'+(b.x||"")+'" dy="',j+=e/h+'">',j+=Ext.htmlEncode(g)+"</tspan>",k=i({x:b.x,y:b.y,"font-size":e,"font-family":f,"font-weight":b["font-weight"],"text-anchor":b["text-anchor"],fill:b.fill||"#000","fill-opacity":b.opacity,transform:a.matrix.toSvg()}),"<text "+k+">"+j+"</text>"},rect:function(a){var b=a.attr,c=i({x:b.x,y:b.y,rx:b.rx,ry:b.ry,width:b.width,height:b.height,fill:b.fill||"none","fill-opacity":b.opacity,stroke:b.stroke,"stroke-opacity":b["stroke-opacity"],"stroke-width":b["stroke-width"],transform:a.matrix&&a.matrix.toSvg()});return"<rect "+c+"/>"},circle:function(a){var b=a.attr,c=i({cx:b.x,cy:b.y,r:b.radius,fill:b.translation.fill||b.fill||"none","fill-opacity":b.opacity,stroke:b.stroke,"stroke-opacity":b["stroke-opacity"],"stroke-width":b["stroke-width"],transform:a.matrix.toSvg()});return"<circle "+c+" />"},image:function(a){var b=a.attr,c=i({x:b.x-(b.width/2>>0),y:b.y-(b.height/2>>0),width:b.width,height:b.height,"xlink:href":b.src,transform:a.matrix.toSvg()});return"<image "+c+" />"}},g=function(){var a='<?xml version="1.0" standalone="yes"?>';return a+='<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',a},h=function(){var b='<svg width="'+c+'px" height="'+d+'px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">',e="",g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;i=a.items.items,h=i.length,k=function(a){var b=a.childNodes,c=b.length,d=0,e,f,g="",h,i,j,l;for(;d<c;d++){h=b[d],i=h.attributes,j=h.tagName,g+="<"+j;for(f=0,e=i.length;f<e;f++)l=i.item(f),g+=" "+l.name+'="'+l.value+'"';g+=">",h.childNodes.length>0&&(g+=k(h)),g+="</"+j+">"}return g};if(a.getDefs)e=k(a.getDefs());else{n=a.gradientsColl,n&&(o=n.keys,p=n.items,q=0,r=o.length);for(;q<r;q++){s=o[q],t=p[q],j=a.gradientsColl.getByKey(s),e+='<linearGradient id="'+s+'" x1="0" y1="0" x2="1" y2="1">';var A=j.colors.replace(/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,"rgb($1|$2|$3)");A=A.replace(/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,([\d\.]+)\)/g,"rgba($1|$2|$3|$4)"),l=A.split(",");for(u=0,w=l.length;u<w;u++)m=l[u].split(" "),A=Ext.draw.Color.fromString(m[1].replace(/\|/g,",")),e+='<stop offset="'+m[0]+'" stop-color="'+A.toString()+'" stop-opacity="1"></stop>';e+="</linearGradient>"}}b+="<defs>"+e+"</defs>",b+=f.rect({attr:{width:"100%",height:"100%",fill:"#fff",stroke:"none",opacity:"0"}}),x=new Array(h);for(u=0;u<h;u++)x[u]=u;x.sort(function(a,b){return y=i[a].attr.zIndex||0,z=i[b].attr.zIndex||0,y==z?a-b:y-z});for(u=0;u<h;u++)g=i[x[u]],g.attr.hidden||(b+=f[g.type](g));return b+="</svg>",b},i=function(a){var b="",c;for(c in a)a.hasOwnProperty(c)&&a[c]!=null&&(b+=c+'="'+a[c]+'" ');return b};return{generate:function(a,b){return e(b),g()+h()}}}()}),Ext.define("Ext.fx.CubicBezier",{singleton:!0,cubicBezierAtTime:function(a,b,c,d,e,f){function m(a){return((i*a+h)*a+g)*a}function n(a,b){var c=o(a,b);return((l*c+k)*c+j)*c}function o(a,b){var c,d,e,f,j,k;for(e=a,k=0;k<8;k++){f=m(e)-a;if(Math.abs(f)<b)return e;j=(3*i*e+2*h)*e+g;if(Math.abs(j)<1e-6)break;e-=f/j}c=0,d=1,e=a;if(e<c)return c;if(e>d)return d;while(c<d){f=m(e);if(Math.abs(f-a)<b)return e;a>f?c=e:d=e,e=(d-c)/2+c}return e}var g=3*b,h=3*(d-b)-g,i=1-g-h,j=3*c,k=3*(e-c)-j,l=1-j-k;return n(a,1/(200*f))},cubicBezier:function(a,b,c,d){var e=function(e){return Ext.fx.CubicBezier.cubicBezierAtTime(e,a,b,c,d,1)};return e.toCSS3=function(){return"cubic-bezier("+[a,b,c,d].join(",")+")"},e.reverse=function(){return Ext.fx.CubicBezier.cubicBezier(1-c,1-d,1-a,1-b)},e}}),Ext.define("Ext.fx.PropertyHandler",{requires:["Ext.draw.Draw"],statics:{defaultHandler:{pixelDefaultsRE:/width|height|top$|bottom$|left$|right$/i,unitRE:/^(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)*$/,scrollRE:/^scroll/i,computeDelta:function(a,b,c,d,e){c=typeof c=="number"?c:1;var f=this.unitRE,g=f.exec(a),h,i;return g&&(a=g[1],i=g[2],!this.scrollRE.test(e)&&!i&&this.pixelDefaultsRE.test(e)&&(i="px")),a=+a||0,g=f.exec(b),g&&(b=g[1],i=g[2]||i),b=+b||0,h=d!=null?d:a,{from:a,delta:(b-h)*c,units:i}},get:function(a,b,c,d,e){var f=a.length,g=[],h,i,j,k,l;for(h=0;h<f;h++){d&&(i=d[h][1].from);if(Ext.isArray(a[h][1])&&Ext.isArray(b)){j=[],k=0,l=a[h][1].length;for(;k<l;k++)j.push(this.computeDelta(a[h][1][k],b[k],c,i,e));g.push([a[h][0],j])}else g.push([a[h][0],this.computeDelta(a[h][1],b,c,i,e)])}return g},set:function(a,b){var c=a.length,d=[],e,f,g,h,i;for(e=0;e<c;e++){f=a[e][1];if(Ext.isArray(f)){g=[],i=0,h=f.length;for(;i<h;i++)g.push(f[i].from+f[i].delta*b+(f[i].units||0));d.push([a[e][0],g])}else d.push([a[e][0],f.from+f.delta*b+(f.units||0)])}return d}},stringHandler:{computeDelta:function(a,b,c,d,e){return{from:a,delta:b}},get:function(a,b,c,d,e){var f=a.length,g=[],h,i,j,k,l;for(h=0;h<f;h++)g.push([a[h][0],this.computeDelta(a[h][1],b,c,i,e)]);return g},set:function(a,b){var c=a.length,d=[],e,f,g,h,i;for(e=0;e<c;e++)f=a[e][1],d.push([a[e][0],f.delta]);return d}},color:{rgbRE:/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,hexRE:/^#?([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})$/i,hex3RE:/^#?([0-9A-F]{1})([0-9A-F]{1})([0-9A-F]{1})$/i,parseColor:function(a,b){b=typeof b=="number"?b:1;var c=!1,d=[this.hexRE,this.rgbRE,this.hex3RE],e=d.length,f,g,h,i;for(i=0;i<e;i++){h=d[i],g=i%2===0?16:10,f=h.exec(a);if(f&&f.length===4){i===2&&(f[1]+=f[1],f[2]+=f[2],f[3]+=f[3]),c={red:parseInt(f[1],g),green:parseInt(f[2],g),blue:parseInt(f[3],g)};break}}return c||a},computeDelta:function(a,b,c,d){a=this.parseColor(a),b=this.parseColor(b,c);var e=d?d:a,f=typeof e,g=typeof b;return f=="string"||f=="undefined"||g=="string"||g=="undefined"?b||e:{from:a,delta:{red:Math.round((b.red-e.red)*c),green:Math.round((b.green-e.green)*c),blue:Math.round((b.blue-e.blue)*c)}}},get:function(a,b,c,d){var e=a.length,f=[],g,h;for(g=0;g<e;g++)d&&(h=d[g][1].from),f.push([a[g][0],this.computeDelta(a[g][1],b,c,h)]);return f},set:function(a,b){var c=a.length,d=[],e,f,g,h,i;for(e=0;e<c;e++){f=a[e][1];if(f){h=f.from,i=f.delta,f=typeof f=="object"&&"red"in f?"rgb("+f.red+", "+f.green+", "+f.blue+")":f,f=typeof f=="object"&&f.length?f[0]:f;if(typeof f=="undefined")return[];g=typeof f=="string"?f:"rgb("+[(h.red+Math.round(i.red*b))%256,(h.green+Math.round(i.green*b))%256,(h.blue+Math.round(i.blue*b))%256].join(",")+")",d.push([a[e][0],g])}}return d}},object:{interpolate:function(a,b){b=typeof b=="number"?b:1;var c={},d;for(d in a)c[d]=parseFloat(a[d])*b;return c},computeDelta:function(a,b,c,d){a=this.interpolate(a),b=this.interpolate(b,c);var e=d?d:a,f={},g;for(g in b)f[g]=b[g]-e[g];return{from:a,delta:f}},get:function(a,b,c,d){var e=a.length,f=[],g,h;for(g=0;g<e;g++)d&&(h=d[g][1].from),f.push([a[g][0],this.computeDelta(a[g][1],b,c,h)]);return f},set:function(a,b){var c=a.length,d=[],e={},f,g,h,i,j;for(f=0;f<c;f++){i=a[f][1],g=i.from,h=i.delta;for(j in g)e[j]=g[j]+h[j]*b;d.push([a[f][0],e])}return d}},path:{computeDelta:function(a,b,c,d){c=typeof c=="number"?c:1;var e;return a=+a||0,b=+b||0,e=d!=null?d:a,{from:a,delta:(b-e)*c}},forcePath:function(a){return!Ext.isArray(a)&&!Ext.isArray(a[0])&&(a=Ext.draw.Draw.parsePathString(a)),a},get:function(a,b,c,d){var e=this.forcePath(b),f=[],g=a.length,h,i,j,k,l,m,n,o,p;for(j=0;j<g;j++){p=this.forcePath(a[j][1]),k=Ext.draw.Draw.interpolatePaths(p,e),p=k[0],e=k[1],h=p.length,o=[];for(m=0;m<h;m++){k=[p[m][0]],i=p[m].length;for(n=1;n<i;n++)l=d&&d[0][1][m][n].from,k.push(this.computeDelta(p[m][n],e[m][n],c,l));o.push(k)}f.push([a[j][0],o])}return f},set:function(a,b){var c=a.length,d=[],e,f,g,h,i,j,k,l;for(e=0;e<c;e++){j=a[e][1],h=[],k=j.length;for(f=0;f<k;f++){i=[j[f][0]],l=j[f].length;for(g=1;g<l;g++)i.push(j[f][g].from+j[f][g].delta*b);h.push(i.join(","))}d.push([a[e][0],h.join(",")])}return d}}}},function(){var a=["outlineColor","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fill","stroke"],b=a.length,c=0,d;for(;c<b;c++)d=a[c],this[d]=this.color;a=["cursor"],b=a.length,c=0;for(;c<b;c++)d=a[c],this[d]=this.stringHandler}),Ext.define("Ext.fx.target.Target",{isAnimTarget:!0,constructor:function(a){this.target=a,this.id=this.getId()},getId:function(){return this.target.id}}),Ext.define("Ext.layout.ClassList",function(){var a=Ext.String.splitWords,b=Ext.Array.toMap;return{dirty:!1,constructor:function(c){this.owner=c,this.map=b(this.classes=a(c.el.className))},add:function(a){var b=this;b.map[a]||(b.map[a]=!0,b.classes.push(a),b.dirty||(b.dirty=!0,b.owner.markDirty()))},addMany:function(b){Ext.each(a(b),this.add,this)},contains:function(a){return this.map[a]},flush:function(){this.owner.el.className=this.classes.join(" "),this.dirty=!1},remove:function(a){var b=this;b.map[a]&&(delete b.map[a],b.classes=Ext.Array.filter(b.classes,function(b){return b!=a}),b.dirty||(b.dirty=!0,b.owner.markDirty()))},removeMany:function(c){var d=this,e=b(a(c));d.classes=Ext.Array.filter(d.classes,function(a){return e[a]?(delete d.map[a],d.dirty||(d.dirty=!0,d.owner.markDirty()),!1):!0})}}}()),Ext.define("Ext.layout.ContextItem",{requires:["Ext.layout.ClassList"],heightModel:null,widthModel:null,sizeModel:null,boxChildren:null,boxParent:null,children:[],dirty:null,dirtyCount:0,hasRawContent:!0,isContextItem:!0,isTopLevel:!1,consumersContentHeight:0,consumersContentWidth:0,consumersContainerHeight:0,consumersContainerWidth:0,consumersHeight:0,consumersWidth:0,ownerCtContext:null,remainingChildLayouts:0,remainingComponentChildLayouts:0,remainingContainerChildLayouts:0,wrapsComponent:!1,constructor:function(a){var b=this,c=a.target,d,e;Ext.apply(b,a),d=b.el,b.id=d.id,b.lastBox=d.lastBox,b.blocks={},b.domBlocks={},b.triggers={},b.domTriggers={},b.flushedProps={},b.props={},b.state={},b.styles={},c.isComponent&&(b.wrapsComponent=!0,b.sizeModel=e=c.getSizeModel(b.ownerCtContext&&b.ownerCtContext.sizeModel),b.widthModel=e.width,b.heightModel=e.height,b.frameBodyContext=b.getEl("frameBody"))},init:function(a){var b=this,c,d;a?(b.ownerCtContext=a,b.isBoxParent=b.target.ownerLayout.isItemBoxParent(b),d=b.widthModel,d.shrinkWrap?(c=a.isBoxParent?a:a.boxParent,c&&c.addBoxChild(b)):d.natural&&(b.boxParent=a)):b.isTopLevel=!0},initAnimatePolicy:function(){var a=this,b=a.target,c=a.ownerCtContext;c&&c.isTopLevel?a.animatePolicy=b.ownerLayout.getAnimatePolicy(a):!c&&b.isCollapsingOrExpanding&&b.animCollapse&&(a.animatePolicy=b.componentLayout.getAnimatePolicy(a)),a.animatePolicy&&a.context.queueAnimation(a)},noFraming:{left:0,top:0,right:0,bottom:0,width:0,height:0},addCls:function(a){this.getClassList().addMany(a)},removeCls:function(a){this.getClassList().removeMany(a)},addBlock:function(a,b,c){var d=this,e=d[a],f=e[c]||(e[c]={});f[b.id]||(f[b.id]=b,++b.blockCount,++d.context.blockCount)},addBoxChild:function(a){var b=this,c,d=a.widthModel;a.boxParent=this,a.measuresBox=d.shrinkWrap?a.hasRawContent:d.natural,a.measuresBox&&(c=b.boxChildren,c?c.push(a):b.boxChildren=[a])},addTrigger:function(a,b){var c=this,d=b?c.domTriggers:c.triggers,e=c.context,f=e.currentLayout,g=d[a]||(d[a]={});g[f.id]||(g[f.id]=f,++f.triggerCount,g=e.triggers[b?"dom":"data"],(g[f.id]||(g[f.id]=[])).push({item:this,prop:a}),c.props[a]!==undefined&&(!b||!(c.dirty&&a in c.dirty))&&++f.firedTriggers)},boxChildMeasured:function(){var a=this,b=a.state,c=b.boxesMeasured=(b.boxesMeasured||0)+1;c==a.boxChildren.length&&(b.clearBoxWidth=1,++a.context.progressCount,a.markDirty())},borderNames:["border-top-width","border-right-width","border-bottom-width","border-left-width"],marginNames:["margin-top","margin-right","margin-bottom","margin-left"],paddingNames:["padding-top","padding-right","padding-bottom","padding-left"],trblNames:["top","right","bottom","left"],cacheMissHandlers:{borderInfo:function(a){var b=a.getStyles(a.borderNames,a.trblNames);return b.width=b.left+b.right,b.height=b.top+b.bottom,b},marginInfo:function(a){var b=a.getStyles(a.marginNames,a.trblNames);return b.width=b.left+b.right,b.height=b.top+b.bottom,b},paddingInfo:function(a){var b=a.frameBodyContext||a,c=b.getStyles(a.paddingNames,a.trblNames);return c.width=c.left+c.right,c.height=c.top+c.bottom,c}},checkCache:function(a){return this.cacheMissHandlers[a](this)},clearAllBlocks:function(a){var b=this[a],c;if(b)for(c in b)this.clearBlocks(a,c)},clearBlocks:function(a,b){var c=this[a],d=c&&c[b],e,f,g;if(d){delete c[b],e=this.context;for(g in d)f=d[g],--e.blockCount,!--f.blockCount&&!f.pending&&!f.done&&e.queueLayout(f)}},block:function(a,b){this.addBlock("blocks",a,b)},domBlock:function(a,b){this.addBlock("domBlocks",a,b)},doInvalidate:function(a){var b=this,c=b.props,d=b.dirty,e=b.target.ownerLayout;b.dirty=b.invalid=!1,b.props={},b.state={},b.clearAllBlocks("blocks"),b.clearAllBlocks("domBlocks"),b.wrapsComponent&&(a?(b.widthModel=b.sizeModel.width,b.heightModel=b.sizeModel.height):(b.recoverProp("x",c,d),b.recoverProp("y",c,d),b.widthModel.calculated&&b.recoverProp("width",c,d),b.heightModel.calculated&&b.recoverProp("height",c,d))),e&&e.manageMargins&&(b.recoverProp("margin-top",c,d),b.recoverProp("margin-right",c,d),b.recoverProp("margin-bottom",c,d),b.recoverProp("margin-left",c,d))},fireTriggers:function(a,b){var c=this[a][b],d=this.context,e,f;if(c)for(f in c)e=c[f],++e.firedTriggers,!e.done&&!e.blockCount&&!e.pending&&d.queueLayout(e)},flush:function(){var a=this,b=a.dirty,c=a.state,d=a.el;a.dirtyCount=0,a.classList&&a.classList.dirty&&a.classList.flush(),"attributes"in a&&(d.set(a.attributes),delete a.attributes),"innerHTML"in a&&(d.innerHTML=a.innerHTML,delete a.innerHTML),c.clearBoxWidth&&(c.clearBoxWidth=0,a.el.setStyle("width",null),--c.blocks||a.context.queueItemLayouts(a)),b&&(delete a.dirty,a.writeProps(b,!0))},flushAnimations:function(){var a=this,b=a.lastBox,c,d,e,f,g,h,i,j,k,l,m;if(b){c=a.target,d=c.layout&&c.layout.animate,d&&(e=Ext.isNumber(d)?d:d.duration),f=Ext.Object.getKeys(a.animatePolicy),g=Ext.apply({},{from:{},to:{},duration:e||Ext.fx.Anim.prototype.duration},d);for(h=0,i=0,j=f.length;i<j;i++)k=f[i],l=b[k],m=a.peek(k),l!=m&&(k=a.translateProps[k]||k,g.from[k]=l,g.to[k]=m,++h);h&&(a.isCollapsingOrExpanding===1?c.componentLayout.undoLayout(a):a.writeProps(g.from),a.el.animate(g),Ext.fx.Manager.getFxQueue(a.el.id)[0].on({afteranimate:function(){a.isCollapsingOrExpanding===1?(c.componentLayout.redoLayout(a),c.afterCollapse(!0)):a.isCollapsingOrExpanding===2&&c.afterExpand(!0)}}))}},getBorderInfo:function(){var a=this,b=a.borderInfo;return b||(a.borderInfo=b=a.checkCache("borderInfo")),b},getClassList:function(){return this.classList||(this.classList=new Ext.layout.ClassList(this))},getEl:function(a,b){var c=this,d,e,f;if(a){if(a.dom)e=a;else{d=c.target,b&&(d=b),e=d[a];if(typeof e=="function"){e=e.call(d);if(e===c.el)return this}}e&&(f=c.context.getEl(c,e))}return f||null},getFraming:function(){var a=this;return a.framingInfo||(a.framingInfo=a.target.frameSize||a.noFraming),a.framingInfo},getFrameInfo:function(){var a=this,b=a.frameInfo,c,d;return b||(c=a.getFraming(),d=a.getBorderInfo(),a.frameInfo=b={top:c.top+d.top,right:c.right+d.right,bottom:c.bottom+d.bottom,left:c.left+d.left,width:c.width+d.width,height:c.height+d.height}),b},getMarginInfo:function(){var a=this,b=a.marginInfo,c,d,e,f,g;return b||(a.wrapsComponent?(c=a.target,f=c.ownerLayout,g=f?f.id:null,d=f&&f.manageMargins,b=c.margin$,b&&b.ownerId!==g&&(b=null),b||(b=a.parseMargins(c.margin)||a.checkCache("marginInfo"),d&&(e=a.parseMargins(c.margins,f.defaultMargins),e&&(b={top:b.top+e.top,right:b.right+e.right,bottom:b.bottom+e.bottom,left:b.left+e.left}),a.setProp("margin-top",0),a.setProp("margin-right",0),a.setProp("margin-bottom",0),a.setProp("margin-left",0)),b.ownerId=g,c.margin$=b),b.width=b.left+b.right,b.height=b.top+b.bottom):b=a.checkCache("marginInfo"),a.marginInfo=b),b},clearMarginCache:function(){delete this.marginInfo,delete this.target.margin$},getPaddingInfo:function(){var a=this,b=a.paddingInfo;return b||(a.paddingInfo=b=a.checkCache("paddingInfo")),b},getProp:function(a){var b=this,c=b.props[a];return b.addTrigger(a),c},getDomProp:function(a){var b=this,c=b.dirty&&a in b.dirty?undefined:b.props[a];return b.addTrigger(a,!0),c},getStyle:function(a){var b=this,c=b.styles,d,e;return a in c?e=c[a]:(d=b.styleInfo[a],e=b.el.getStyle(a),d&&d.parseInt&&(e=parseInt(e,10)||0),c[a]=e),e},getStyles:function(a,b){var c=this,d=c.styles,e={},f=0,g=a.length,h,i,j,k,l,m,n,o;b=b||a;for(h=0;h<g;++h)k=a[h],k in d?(e[b[h]]=d[k],++f,h&&f==1&&(i=a.slice(0,h),j=b.slice(0,h))):f&&((i||(i=[])).push(k),(j||(j=[])).push(b[h]));if(f<g){i=i||a,j=j||b,m=c.styleInfo,n=c.el.getStyle(i);for(h=i.length;h--;)k=i[h],l=m[k],o=n[k],l&&l.parseInt&&(o=parseInt(o,10)||0),e[j[h]]=o,d[k]=o}return e},hasProp:function(a){var b=this.getProp(a);return typeof b!="undefined"},hasDomProp:function(a){var b=this.getDomProp(a);return typeof b!="undefined"},invalidate:function(a){this.invalid=!0,this.context.queueInvalidate(this,a)},markDirty:function(){++this.dirtyCount==1&&this.context.queueFlush(this)},onBoxMeasured:function(){var a=this.boxParent,b=this.state;a&&a.widthModel.shrinkWrap&&!b.boxMeasured&&this.measuresBox&&(b.boxMeasured=1,a.boxChildMeasured())},parseMargins:function(a,b){a===!0&&(a=5);var c=typeof a,d;if(c=="string"||c=="number")d=Ext.util.Format.parseBox(a);else if(a||b)d={top:0,right:0,bottom:0,left:0},b&&Ext.apply(d,this.parseMargins(b)),Ext.apply(d,a);return d},peek:function(a){return this.props[a]},recoverProp:function(a,b,c){var d=this,e=d.props,f;a in b&&(e[a]=b[a],c&&a in c&&(f=d.dirty||(d.dirty={}),f[a]=c[a]))},redo:function(a){var b=this,c,d,e;b.revertProps(b.props);if(a&&b.wrapsComponent){if(b.childItems)for(e=0,c=b.childItems,d=c.length;e<d;e++)c[e].redo(a);for(e=0,c=b.children,d=c.length;e<d;e++)c[e].redo()}},revertProps:function(a){var b,c=this.flushedProps,d={};for(b in a)c.hasOwnProperty(b)&&(d[b]=a[b]);this.writeProps(d)},setAttribute:function(a,b){var c=this;c.attributes||(c.attributes={}),c.attributes[a]=b,c.markDirty()},setBox:function(a){var b=this;"left"in a&&b.setProp("x",a.left),"top"in a&&b.setProp("y",a.top),b.setSize(a.width,a.height)},setContentHeight:function(a,b){return!b&&this.hasRawContent?1:this.setProp("contentHeight",a)},setContentWidth:function(a,b){return!b&&this.hasRawContent?1:this.setProp("contentWidth",a)},setContentSize:function(a,b,c){return this.setContentWidth(a,c)+this.setContentHeight(b,c)==2},setProp:function(a,b,c){var d=this,e=typeof b,f,g;if(e=="undefined"||e==="number"&&isNaN(b))return 0;if(d.props[a]===b)return 1;d.props[a]=b,++d.context.progressCount;if(c===!1)d.fireTriggers("domTriggers",a),d.clearBlocks("domBlocks",a);else{g=d.styleInfo[a];if(g){d.dirty||(d.dirty={});if(a=="width"||a=="height")f=d.isBorderBoxValue,f==null&&(d.isBorderBoxValue=f=!!d.el.isBorderBox()),f||(d.borderInfo||d.getBorderInfo(),d.paddingInfo||d.getPaddingInfo());d.dirty[a]=b,d.markDirty()}}return d.fireTriggers("triggers",a),d.clearBlocks("blocks",a),1},setHeight:function(a,b){var c=this,d=c.target,e,f,g;a<0&&(a=0);if(!c.wrapsComponent){if(!c.setProp("height",a,b))return NaN}else{a=Ext.Number.constrain(a,d.minHeight||0,d.maxHeight);if(!c.setProp("height",a,b))return NaN;e=c.frameBodyContext,e&&(f=c.getFrameInfo(),e.setHeight(a-f.height,b))}return a},setWidth:function(a,b){var c=this,d=c.target,e,f,g;a<0&&(a=0);if(!c.wrapsComponent){if(!c.setProp("width",a,b))return NaN}else{a=Ext.Number.constrain(a,d.minWidth||0,d.maxWidth);if(!c.setProp("width",a,b))return NaN;e=c.frameBodyContext,e&&(f=c.getFrameInfo(),e.setWidth(a-f.width,b))}return a},setSize:function(a,b,c){this.setWidth(a,c),this.setHeight(b,c)},translateProps:{x:"left",y:"top"},undo:function(a){var b=this,c,d,e;b.revertProps(b.lastBox);if(a&&b.wrapsComponent){if(b.childItems)for(e=0,c=b.childItems,d=c.length;e<d;e++)c[e].undo(a);for(e=0,c=b.children,d=c.length;e<d;e++)c[e].undo()}},unsetProp:function(a){var b=this.dirty;delete this.props[a],b&&delete b[a]},writeProps:function(a,b){if(!a||typeof a!="object")return;var c=this,d=c.el,e={},f=0,g=c.styleInfo,h,i,j,k="x"in a,l="y"in a,m=a.x,n=a.y,o=a.width,p=a.height,q=c.isBorderBoxValue,r=c.target,s=Math.max,t=0,u=0;"displayed"in a&&d.setDisplayed(a.displayed);for(i in a)b&&(c.fireTriggers("domTriggers",i),c.clearBlocks("domBlocks",i),c.flushedProps[i]=1),h=g[i],h&&h.dom&&(h.suffix&&(j=parseInt(a[i],10))?e[i]=j+h.suffix:e[i]=a[i],++f);if(k||l)r.isComponent?r.setPosition(m||c.props.x,n||c.props.y):(k&&(e.left=m+"px",++f),l&&(e.top=n+"px",++f));!q&&(o>0||p>0)&&(c.frameBodyContext||(t=c.paddingInfo.width,u=c.paddingInfo.height),o&&(o=s(parseInt(o,10)-(c.borderInfo.width+t),0),e.width=o+"px",++f),p&&(p=s(parseInt(p,10)-(c.borderInfo.height+u),0),e.height=p+"px",++f)),f&&d.setStyle(e)}},function(){var a={dom:!0,parseInt:!0,suffix:"px"},b={dom:!0},c={dom:!1};this.prototype.styleInfo={childrenDone:c,componentChildrenDone:c,containerChildrenDone:c,containerLayoutDone:c,displayed:c,done:c,x:c,y:c,left:a,top:a,right:a,bottom:a,width:a,height:a,"border-top-width":a,"border-right-width":a,"border-bottom-width":a,"border-left-width":a,"margin-top":a,"margin-right":a,"margin-bottom":a,"margin-left":a,"padding-top":a,"padding-right":a,"padding-bottom":a,"padding-left":a,"line-height":b,display:b}}),Ext.define("Ext.util.Bindable",{bindStore:function(a,b){var c=this,d=c.store;return!b&&c.store&&(a!==d&&d.autoDestroy?d.destroyStore():c.unbindStoreListeners(d),c.onUnbindStore(d,b)),a&&(a=Ext.data.StoreManager.lookup(a),c.bindStoreListeners(a),c.onBindStore(a,b)),c.store=a||null,c},getStore:function(){return this.store},unbindStoreListeners:function(a){var b=this.storeListeners;b&&a.un(b)},bindStoreListeners:function(a){var b=this,c=Ext.apply({},b.getStoreListeners());c.scope||(c.scope=b),b.storeListeners=c,a.on(c)},getStoreListeners:Ext.emptyFn,onUnbindStore:Ext.emptyFn,onBindStore:Ext.emptyFn}),Ext.define("Ext.util.ElementContainer",{childEls:[],constructor:function(){var a=this,b;a.hasOwnProperty("childEls")&&(b=a.childEls,delete a.childEls,a.addChildEls.apply(a,b))},destroy:function(){var a=this,b=a.getChildEls(),c,d,e,f;for(e=b.length;e--;)d=b[e],typeof d!="string"&&(d=d.name),c=a[d],c&&(a[d]=null,c.remove())},addChildEls:function(){var a=this,b=arguments;a.hasOwnProperty("childEls")?a.childEls.push.apply(a.childEls,b):a.childEls=a.getChildEls().concat(Array.prototype.slice.call(b)),a.prune(a.childEls,!1)},applyChildEls:function(a,b){var c=this,d=c.getChildEls(),e,f,g,h,i;e=(b||c.id)+"-";for(g=d.length;g--;)f=d[g],typeof f=="string"?i=a.getById(e+f):((h=f.select)?i=Ext.select(h,!0,a.dom):(h=f.selectNode)?i=Ext.get(Ext.DomQuery.selectNode(h,a.dom)):i=a.getById(f.id||e+f.itemId),f=f.name),c[f]=i},getChildEls:function(){var a=this,b;return a.hasOwnProperty("childEls")?a.childEls:(b=a.self,b.$childEls||a.getClassChildEls(b))},getClassChildEls:function(a){var b=this,c=a.$childEls,d,e,f,g,h,i,j,k,l,m,n;if(!c){m=a.superclass,m?(m=m.self,k=[m.$childEls||b.getClassChildEls(m)],n=m.prototype.mixins||{}):(k=[],n={}),l=a.prototype,i=l.mixins;for(j in i)i.hasOwnProperty(j)&&!n.hasOwnProperty(j)&&(h=i[j].self,k.push(h.$childEls||b.getClassChildEls(h)));k.push(l.hasOwnProperty("childEls")&&l.childEls);for(e=0,f=k.length;e<f;++e)d=k[e],d&&d.length&&(c?(g||(g=!0,c=c.slice(0)),c.push.apply(c,d)):c=d);a.$childEls=c=c?b.prune(c,!g):[]}return c},prune:function(a,b){var c=a.length,d={},e;while(c--)e=a[c],typeof e!="string"&&(e=e.name),d[e]?(b&&(b=!1,a=a.slice(0)),Ext.Array.erase(a,c,1)):d[e]=1;return a},removeChildEls:function(a){var b=this,c=b.getChildEls(),d=b.childEls=[],e,f,g;for(f=0,e=c.length;f<e;++f)g=c[f],a(g)||d.push(g)}}),Ext.define("Ext.util.Filter",{anyMatch:!1,exactMatch:!1,caseSensitive:!1,constructor:function(a){var b=this;Ext.apply(b,a),b.filter=b.filter||b.filterFn,b.filter===undefined&&(b.property!==undefined&&b.value!==undefined&&(b.filter=b.createFilterFn()),b.filterFn=b.filter)},createFilterFn:function(){var a=this,b=a.createValueMatcher(),c=a.property;return function(d){var e=a.getRoot.call(a,d)[c];return b===null?e===null:b.test(e)}},getRoot:function(a){var b=this.root;return b===undefined?a:a[b]},createValueMatcher:function(){var a=this,b=a.value,c=a.anyMatch,d=a.exactMatch,e=a.caseSensitive,f=Ext.String.escapeRegex;return b===null?b:(b.exec||(b=String(b),c===!0?b=f(b):(b="^"+f(b),d===!0&&(b+="$")),b=new RegExp(b,e?"":"i")),b)}}),Ext.define("Ext.util.Inflector",{singleton:!0,plurals:[[/(quiz)$/i,"$1zes"],[/^(ox)$/i,"$1en"],[/([m|l])ouse$/i,"$1ice"],[/(matr|vert|ind)ix|ex$/i,"$1ices"],[/(x|ch|ss|sh)$/i,"$1es"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(hive)$/i,"$1s"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/sis$/i,"ses"],[/([ti])um$/i,"$1a"],[/(buffal|tomat|potat)o$/i,"$1oes"],[/(bu)s$/i,"$1ses"],[/(alias|status|sex)$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(ax|test)is$/i,"$1es"],[/^person$/,"people"],[/^man$/,"men"],[/^(child)$/,"$1ren"],[/s$/i,"s"],[/$/,"s"]],singulars:[[/(quiz)zes$/i,"$1"],[/(matr)ices$/i,"$1ix"],[/(vert|ind)ices$/i,"$1ex"],[/^(ox)en/i,"$1"],[/(alias|status)es$/i,"$1"],[/(octop|vir)i$/i,"$1us"],[/(cris|ax|test)es$/i,"$1is"],[/(shoe)s$/i,"$1"],[/(o)es$/i,"$1"],[/(bus)es$/i,"$1"],[/([m|l])ice$/i,"$1ouse"],[/(x|ch|ss|sh)es$/i,"$1"],[/(m)ovies$/i,"$1ovie"],[/(s)eries$/i,"$1eries"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/([lr])ves$/i,"$1f"],[/(tive)s$/i,"$1"],[/(hive)s$/i,"$1"],[/([^f])ves$/i,"$1fe"],[/(^analy)ses$/i,"$1sis"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/i,"$1$2sis"],[/([ti])a$/i,"$1um"],[/(n)ews$/i,"$1ews"],[/people$/i,"person"],[/s$/i,""]],uncountable:["sheep","fish","series","species","money","rice","information","equipment","grass","mud","offspring","deer","means"],singular:function(a,b){this.singulars.unshift([a,b])},plural:function(a,b){this.plurals.unshift([a,b])},clearSingulars:function(){this.singulars=[]},clearPlurals:function(){this.plurals=[]},isTransnumeral:function(a){return Ext.Array.indexOf(this.uncountable,a)!=-1},pluralize:function(a){if(this.isTransnumeral(a))return a;var b=this.plurals,c=b.length,d,e,f;for(f=0;f<c;f++){d=b[f],e=d[0];if(e==a||e.test&&e.test(a))return a.replace(e,d[1])}return a},singularize:function(a){if(this.isTransnumeral(a))return a;var b=this.singulars,c=b.length,d,e,f;for(f=0;f<c;f++){d=b[f],e=d[0];if(e==a||e.test&&e.test(a))return a.replace(e,d[1])}return a},classify:function(a){return Ext.String.capitalize(this.singularize(a))},ordinalize:function(a){var b=parseInt(a,10),c=b%10,d=b%100;if(11<=d&&d<=13)return a+"th";switch(c){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd";default:return a+"th"}}},function(){var a={alumnus:"alumni",cactus:"cacti",focus:"foci",nucleus:"nuclei",radius:"radii",stimulus:"stimuli",ellipsis:"ellipses",paralysis:"paralyses",oasis:"oases",appendix:"appendices",index:"indexes",beau:"beaux",bureau:"bureaux",tableau:"tableaux",woman:"women",child:"children",man:"men",corpus:"corpora",criterion:"criteria",curriculum:"curricula",genus:"genera",memorandum:"memoranda",phenomenon:"phenomena",foot:"feet",goose:"geese",tooth:"teeth",antenna:"antennae",formula:"formulae",nebula:"nebulae",vertebra:"vertebrae",vita:"vitae"},b;for(b in a)this.plural(b,a[b]),this.singular(a[b],b)}),Ext.define("Ext.util.Memento",function(){function a(a,b,c,d){a[d?d+c:c]=b[c]}function b(a,b,c){delete a[c]}function c(a,b,c,e){var f=e?e+c:c,g=a[f];(g||a.hasOwnProperty(f))&&d(b,c,g)}function d(a,b,c){Ext.isDefined(c)?a[b]=c:delete a[b]}function e(a,b,c,d,e){if(b)if(Ext.isArray(d)){var f,g=d.length;for(f=0;f<g;f++)a(b,c,d[f],e)}else a(b,c,d,e)}return{data:null,target:null,constructor:function(a,b){a&&(this.target=a,b&&this.capture(b))},capture:function(b,c,d){var f=this;e(a,f.data||(f.data={}),c||f.target,b,d)},remove:function(a){e(b,this.data,null,a)},restore:function(a,b,d,f){e(c,this.data,d||this.target,a,f),b!==!1&&this.remove(a)},restoreAll:function(a,b){var c=this,e=b||this.target,f=c.data,g;for(g in f)f.hasOwnProperty(g)&&d(e,g,f[g]);a!==!1&&delete c.data}}}()),Ext.define("Ext.util.Observable",{requires:["Ext.util.Event"],statics:{releaseCapture:function(a){a.fireEvent=this.prototype.fireEvent},capture:function(a,b,c){a.fireEvent=Ext.Function.createInterceptor(a.fireEvent,b,c)},observe:function(a,b){return a&&(a.isObservable||(Ext.applyIf(a,new this),this.capture(a.prototype,a.fireEvent,a)),Ext.isObject(b)&&a.on(b)),a},prepareClass:function(a,b){if(!a.HasListeners){var c=Ext.util.Observable,d=function(){},e=a.superclass.HasListeners||b&&b.HasListeners||c.HasListeners;a.prototype.HasListeners=a.HasListeners=d,d.prototype=a.hasListeners=new e}}},isObservable:!0,constructor:function(a){var b=this;Ext.apply(b,a),b.hasListeners||(b.hasListeners=new b.HasListeners),b.events=b.events||{},b.listeners&&(b.on(b.listeners),b.listeners=null),b.bubbleEvents&&b.enableBubble(b.bubbleEvents)},onClassExtended:function(a){a.HasListeners||Ext.util.Observable.prepareClass(a)},eventOptionsRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate|element|vertical|horizontal|freezeEvent)$/,addManagedListener:function(a,b,c,d,e){var f=this,g=f.managedListeners=f.managedListeners||[],h;if(typeof b!="string"){e=b;for(b in e)e.hasOwnProperty(b)&&(h=e[b],f.eventOptionsRe.test(b)||f.addManagedListener(a,b,h.fn||h,h.scope||e.scope,h.fn?h:e))}else g.push({item:a,ename:b,fn:c,scope:d,options:e}),a.on(b,c,d,e)},removeManagedListener:function(a,b,c,d){var e=this,f,g,h,i,j;if(typeof b!="string"){f=b;for(b in f)f.hasOwnProperty(b)&&(g=f[b],e.eventOptionsRe.test(b)||e.removeManagedListener(a,b,g.fn||g,g.scope||f.scope))}h=e.managedListeners?e.managedListeners.slice():[];for(j=0,i=h.length;j<i;j++)e.removeManagedListenerItem(!1,h[j],a,b,c,d)},fireEvent:function(a){a=a.toLowerCase();var b=this,c=b.events,d=c&&c[a],e=!0;return d&&b.hasListeners[a]&&(e=b.continueFireEvent(a,Ext.Array.slice(arguments,1),d.bubble)),e},continueFireEvent:function(a,b,c){var d=this,e,f,g=!0;do{if(d.eventsSuspended)return(e=d.eventQueue)&&e.push([a,b,c]),g;f=d.events[a];if(f&&f!=1&&(g=f.fire.apply(f,b))===!1)break}while(c&&(d=d.getBubbleParent()));return g},getBubbleParent:function(){var a=this,b=a.getBubbleTarget&&a.getBubbleTarget();return b&&b.isObservable?b:null},addListener:function(a,b,c,d){var e=this,f,g,h;if(typeof a!="string"){d=a;for(a in d)d.hasOwnProperty(a)&&(f=d[a],e.eventOptionsRe.test(a)||e.addListener(a,f.fn||f,f.scope||d.scope,f.fn?f:d))}else a=a.toLowerCase(),e.events[a]=e.events[a]||!0,g=e.events[a]||!0,Ext.isBoolean(g)&&(e.events[a]=g=new Ext.util.Event(e,a)),typeof b=="string"&&(b=c[b]||e[b]),g.addListener(b,c,Ext.isObject(d)?d:{}),h=e.hasListeners,h.hasOwnProperty(a)?++h[a]:h[a]=1},removeListener:function(a,b,c){var d=this,e,f,g;if(typeof a!="string"){g=a;for(a in g)g.hasOwnProperty(a)&&(e=g[a],d.eventOptionsRe.test(a)||d.removeListener(a,e.fn||e,e.scope||g.scope))}else a=a.toLowerCase(),f=d.events[a],f&&f.isEvent&&(f.removeListener(b,c),--d.hasListeners[a]||delete d.hasListeners[a])},clearListeners:function(){var a=this.events,b,c;for(c in a)a.hasOwnProperty(c)&&(b=a[c],b.isEvent&&b.clearListeners());this.clearManagedListeners()},clearManagedListeners:function(){var a=this.managedListeners||[],b=0,c=a.length;for(;b<c;b++)this.removeManagedListenerItem(!0,a[b]);this.managedListeners=[]},removeManagedListenerItem:function(a,b,c,d,e,f){if(a||b.item===c&&b.ename===d&&(!e||b.fn===e)&&(!f||b.scope===f))b.item.un(b.ename,b.fn,b.scope),a||Ext.Array.remove(this.managedListeners,b)},addEvents:function(a){var b=this,c=b.events||(b.events={}),d,e,f;if(typeof a=="string")for(e=arguments,f=e.length;f--;)d=e[f],c[d]||(c[d]=!0);else Ext.applyIf(b.events,a)},hasListener:function(a){return!!this.hasListeners[a.toLowerCase()]},suspendEvents:function(a){this.eventsSuspended=!0,a&&!this.eventQueue&&(this.eventQueue=[])},resumeEvents:function(){var a=this,b=a.eventQueue,c,d;a.eventsSuspended=!1,delete a.eventQueue;if(b){c=b.length;for(d=0;d<c;d++)a.continueFireEvent.apply(a,b[d])}},relayEvents:function(a,b,c){c=c||"";var d=this,e=b.length,f=0,g,h;for(;f<e;f++)g=b[f],h=c+g,d.events[h]=d.events[h]||!0,a.on(g,d.createRelayer(h))},createRelayer:function(a,b){var c=this;return function(){return c.fireEvent.apply(c,[a].concat(Array.prototype.slice.apply(arguments,b||[0,-1])))}},enableBubble:function(a){if(a){var b=this,c=typeof a=="string"?arguments:a,d=c.length,e=b.events,f,g,h;for(h=0;h<d;++h){f=c[h].toLowerCase(),g=e[f];if(!g||typeof g=="boolean")e[f]=g=new Ext.util.Event(b,f);b.hasListeners[f]=(b.hasListeners[f]||0)+1,g.bubble=!0}}}},function(){function e(a){var b=(this.methodEvents=this.methodEvents||{})[a],c,d,e,f=this,g;return b||(this.methodEvents[a]=b={},b.originalFn=this[a],b.methodName=a,b.before=[],b.after=[],g=function(a,b,g){(d=a.apply(b||f,g))!==undefined&&(typeof d=="object"?(d.returnValue!==undefined?c=d.returnValue:c=d,e=!!d.cancel):d===!1?e=!0:c=d)},this[a]=function(){var a=Array.prototype.slice.call(arguments,0),m,n,o;c=d=undefined,e=!1;for(n=0,o=b.before.length;n<o;n++){m=b.before[n],g(m.fn,m.scope,a);if(e)return c}(d=b.originalFn.apply(f,a))!==undefined&&(c=d);for(n=0,o=b.after.length;n<o;n++){m=b.after[n],g(m.fn,m.scope,a);if(e)return c}return c}),b}var a=this,b=a.prototype,c=function(){},d=function(b){if(!b.HasListeners){var c=b.prototype;a.prepareClass(b,this),b.onExtended(function(b){a.prepareClass(b)}),c.onClassMixedIn?Ext.override(b,{onClassMixedIn:function(a){d.call(this,a),this.callParent(arguments)}}):c.onClassMixedIn=function(a){d.call(this,a)}}};c.prototype={},b.HasListeners=a.HasListeners=c,a.createAlias({on:"addListener",un:"removeListener",mon:"addManagedListener",mun:"removeManagedListener"}),a.observeClass=a.observe,Ext.apply(b,{onClassMixedIn:d,beforeMethod:function(a,b,c){e.call(this,a).before.push({fn:b,scope:c})},afterMethod:function(a,b,c){e.call(this,a).after.push({fn:b,scope:c})},removeMethodListener:function(a,b,c){var d=this.getMethodEvent(a),e,f;for(e=0,f=d.before.length;e<f;e++)if(d.before[e].fn==b&&d.before[e].scope==c){Ext.Array.erase(d.before,e,1);return}for(e=0,f=d.after.length;e<f;e++)if(d.after[e].fn==b&&d.after[e].scope==c){Ext.Array.erase(d.after,e,1);return}},toggleEventLogging:function(a){Ext.util.Observable[a?"capture":"releaseCapture"](this,function(a){Ext.isDefined(Ext.global.console)&&Ext.global.console.log(a,arguments)})}})}),Ext.define("Ext.util.Offset",{statics:{fromObject:function(a){return new this(a.x,a.y)}},constructor:function(a,b){return this.x=a!=null&&!isNaN(a)?a:0,this.y=b!=null&&!isNaN(b)?b:0,this},copy:function(){return new Ext.util.Offset(this.x,this.y)},copyFrom:function(a){this.x=a.x,this.y=a.y},toString:function(){return"Offset["+this.x+","+this.y+"]"},equals:function(a){return this.x==a.x&&this.y==a.y},round:function(a){if(!isNaN(a)){var b=Math.pow(10,a);this.x=Math.round(this.x*b)/b,this.y=Math.round(this.y*b)/b}else this.x=Math.round(this.x),this.y=Math.round(this.y)},isZero:function(){return this.x==0&&this.y==0}}),Ext.define("Ext.util.ProtoElement",function(){var a=Ext.String.splitWords,b=Ext.Array.toMap;return{isProtoEl:!0,clsProp:"cls",styleProp:"style",removedProp:"removed",styleIsText:!1,constructor:function(c){var d=this;Ext.apply(d,c),d.classList=a(d.cls),d.classMap=b(d.classList),delete d.cls,Ext.isFunction(d.style)?(d.styleFn=d.style,delete d.style):typeof d.style=="string"?d.style=Ext.Element.parseStyles(d.style):d.style&&(d.style=Ext.apply({},d.style))},flush:function(){this.flushClassList=[],this.removedClasses={},delete this.style},addCls:function(b){var c=this,d=a(b),e=d.length,f=c.classList,g=c.classMap,h=c.flushClassList,i=0,j;for(;i<e;++i)j=d[i],g[j]||(g[j]=!0,f.push(j),h&&(h.push(j),delete c.removedClasses[j]));return c},hasCls:function(a){return a in this.classMap},removeCls:function(c){var d=this,e=d.classList,f=d.classList=[],g=b(a(c)),h=e.length,i=d.classMap,j=d.removedClasses,k,l;for(k=0;k<h;++k)l=e[k],g[l]?(j&&i[l]&&(j[l]=!0,Ext.Array.remove(d.flushClassList,l)),delete i[l]):f.push(l);return d},setStyle:function(a,b){var c=this,d=c.style||(c.style={});return typeof a=="string"?arguments.length===1?c.setStyle(Ext.Element.parseStyles(a)):d[a]=b:Ext.apply(d,a),c},writeTo:function(a){var b=this,c=b.flushClassList||b.classList,d=b.removedClasses,e;return b.styleFn?(e=Ext.apply({},b.styleFn()),Ext.apply(e,b.style)):e=b.style,a[b.clsProp]=c.join(" "),e&&(a[b.styleProp]=b.styleIsText?Ext.DomHelper.generateStyles(e):e),d&&(d=Ext.Object.getKeys(d),d.length&&(a[b.removedProp]=d.join(" "))),a}}}()),Ext.define("Ext.util.Queue",{constructor:function(){this.clear()},add:function(a){var b=this,c=b.getKey(a);return b.map[c]||(++b.length,b.items.push(a),b.map[c]=a),a},clear:function(){var a=this,b=a.items;return a.items=[],a.map={},a.length=0,b},contains:function(a){var b=this.getKey(a);return this.map.hasOwnProperty(b)},getCount:function(){return this.length},getKey:function(a){return a.id},remove:function(a){var b=this,c=b.getKey(a),d=b.items,e;return b.map[c]&&(e=Ext.Array.indexOf(d,a),Ext.Array.erase(d,e,1),delete b.map[c],--b.length),a}}),Ext.define("Ext.util.Region",{requires:["Ext.util.Offset"],statics:{getRegion:function(a){return Ext.fly(a).getPageBox(!0)},from:function(a){return new this(a.top,a.right,a.bottom,a.left)}},constructor:function(a,b,c,d){var e=this;e.y=e.top=e[1]=a,e.right=b,e.bottom=c,e.x=e.left=e[0]=d},contains:function(a){var b=this;return a.x>=b.x&&a.right<=b.right&&a.y>=b.y&&a.bottom<=b.bottom},intersect:function(a){var b=this,c=Math.max(b.y,a.y),d=Math.min(b.right,a.right),e=Math.min(b.bottom,a.bottom),f=Math.max(b.x,a.x);return e>c&&d>f?new this.self(c,d,e,f):!1},union:function(a){var b=this,c=Math.min(b.y,a.y),d=Math.max(b.right,a.right),e=Math.max(b.bottom,a.bottom),f=Math.min(b.x,a.x);return new this.self(c,d,e,f)},constrainTo:function(a){var b=this,c=Ext.Number.constrain;return b.top=b.y=c(b.top,a.y,a.bottom),b.bottom=c(b.bottom,a.y,a.bottom),b.left=b.x=c(b.left,a.x,a.right),b.right=c(b.right,a.x,a.right),b},adjust:function(a,b,c,d){var e=this;return e.top=e.y+=a,e.left=e.x+=d,e.right+=b,e.bottom+=c,e},getOutOfBoundOffset:function(a,b){if(!Ext.isObject(a))return a=="x"?this.getOutOfBoundOffsetX(b):this.getOutOfBoundOffsetY(b);b=a;var c=new Ext.util.Offset;return c.x=this.getOutOfBoundOffsetX(b.x),c.y=this.getOutOfBoundOffsetY(b.y),c},getOutOfBoundOffsetX:function(a){return a<=this.x?this.x-a:a>=this.right?this.right-a:0},getOutOfBoundOffsetY:function(a){return a<=this.y?this.y-a:a>=this.bottom?this.bottom-a:0},isOutOfBound:function(a,b){return Ext.isObject(a)?(b=a,this.isOutOfBoundX(b.x)||this.isOutOfBoundY(b.y)):a=="x"?this.isOutOfBoundX(b):this.isOutOfBoundY(b)},isOutOfBoundX:function(a){return a<this.x||a>this.right},isOutOfBoundY:function(a){return a<this.y||a>this.bottom},restrict:function(a,b,c){if(Ext.isObject(a)){var d;return c=b,b=a,b.copy?d=b.copy():d={x:b.x,y:b.y},d.x=this.restrictX(b.x,c),d.y=this.restrictY(b.y,c),d}return a=="x"?this.restrictX(b,c):this.restrictY(b,c)},restrictX:function(a,b){return b||(b=1),a<=this.x?a-=(a-this.x)*b:a>=this.right&&(a-=(a-this.right)*b),a},restrictY:function(a,b){return b||(b=1),a<=this.y?a-=(a-this.y)*b:a>=this.bottom&&(a-=(a-this.bottom)*b),a},getSize:function(){return{width:this.right-this.x,height:this.bottom-this.y}},copy:function(){return new this.self(this.y,this.right,this.bottom,this.x)},copyFrom:function(a){var b=this;return b.top=b.y=b[1]=a.y,b.right=a.right,b.bottom=a.bottom,b.left=b.x=b[0]=a.x,this},toString:function(){return"Region["+this.top+","+this.right+","+this.bottom+","+this.left+"]"},translateBy:function(a,b){arguments.length==1&&(b=a.y,a=a.x);var c=this;return c.top=c.y+=b,c.right+=a,c.bottom+=b,c.left=c.x+=a,c},round:function(){var a=this;return a.top=a.y=Math.round(a.y),a.right=Math.round(a.right),a.bottom=Math.round(a.bottom),a.left=a.x=Math.round(a.x),a},equals:function(a){return this.top==a.top&&this.right==a.right&&this.bottom==a.bottom&&this.left==a.left}}),Ext.define("Ext.util.Renderable",{requires:["Ext.dom.Element"],frameCls:Ext.baseCSSPrefix+"frame",frameIdRegex:/[\-]frame\d+[TMB][LCR]$/,frameElementCls:{tl:[],tc:[],tr:[],ml:[],mc:[],mr:[],bl:[],bc:[],br:[]},frameElNames:["TL","TC","TR","ML","MC","MR","BL","BC","BR"],frameTpl:["{%this.renderDockedItems(out,values,0);%}",'<tpl if="top">','<tpl if="left"><div id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>" style="background-position: {tl}; padding-left: {frameWidth}px" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>" style="background-position: {tr}; padding-right: {frameWidth}px" role="presentation"></tpl>','<div id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>" style="background-position: {tc}; height: {frameWidth}px" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>",'<tpl if="left"><div id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>" style="background-position: {ml}; padding-left: {frameWidth}px" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>" style="background-position: {mr}; padding-right: {frameWidth}px" role="presentation"></tpl>','<div id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</div>",'<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>','<tpl if="bottom">','<tpl if="left"><div id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>" style="background-position: {bl}; padding-left: {frameWidth}px" role="presentation"></tpl>','<tpl if="right"><div id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>" style="background-position: {br}; padding-right: {frameWidth}px" role="presentation"></tpl>','<div id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>" style="background-position: {bc}; height: {frameWidth}px" role="presentation"></div>','<tpl if="right"></div></tpl>','<tpl if="left"></div></tpl>',"</tpl>","{%this.renderDockedItems(out,values,1);%}"],frameTableTpl:["{%this.renderDockedItems(out,values,0);%}","<table><tbody>",'<tpl if="top">',"<tr>",'<tpl if="left"><td id="{fgid}TL" class="{frameCls}-tl {baseCls}-tl {baseCls}-{ui}-tl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tl</tpl>" style="background-position: {tl}; padding-left:{frameWidth}px" role="presentation"></td></tpl>','<td id="{fgid}TC" class="{frameCls}-tc {baseCls}-tc {baseCls}-{ui}-tc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tc</tpl>" style="background-position: {tc}; height: {frameWidth}px" role="presentation"></td>','<tpl if="right"><td id="{fgid}TR" class="{frameCls}-tr {baseCls}-tr {baseCls}-{ui}-tr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-tr</tpl>" style="background-position: {tr}; padding-left: {frameWidth}px" role="presentation"></td></tpl>',"</tr>","</tpl>","<tr>",'<tpl if="left"><td id="{fgid}ML" class="{frameCls}-ml {baseCls}-ml {baseCls}-{ui}-ml<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-ml</tpl>" style="background-position: {ml}; padding-left: {frameWidth}px" role="presentation"></td></tpl>','<td id="{fgid}MC" class="{frameCls}-mc {baseCls}-mc {baseCls}-{ui}-mc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mc</tpl>" style="background-position: 0 0;" role="presentation">',"{%this.applyRenderTpl(out, values)%}","</td>",'<tpl if="right"><td id="{fgid}MR" class="{frameCls}-mr {baseCls}-mr {baseCls}-{ui}-mr<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-mr</tpl>" style="background-position: {mr}; padding-left: {frameWidth}px" role="presentation"></td></tpl>',"</tr>",'<tpl if="bottom">',"<tr>",'<tpl if="left"><td id="{fgid}BL" class="{frameCls}-bl {baseCls}-bl {baseCls}-{ui}-bl<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bl</tpl>" style="background-position: {bl}; padding-left: {frameWidth}px" role="presentation"></td></tpl>','<td id="{fgid}BC" class="{frameCls}-bc {baseCls}-bc {baseCls}-{ui}-bc<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-bc</tpl>" style="background-position: {bc}; height: {frameWidth}px" role="presentation"></td>','<tpl if="right"><td id="{fgid}BR" class="{frameCls}-br {baseCls}-br {baseCls}-{ui}-br<tpl for="uiCls"> {parent.baseCls}-{parent.ui}-{.}-br</tpl>" style="background-position: {br}; padding-left: {frameWidth}px" role="presentation"></td></tpl>',"</tr>","</tpl>","</tbody></table>","{%this.renderDockedItems(out,values,1);%}"],afterRender:function(){var a=this,b={},c=a.protoEl,d=a.getTargetEl(),e;a.finishRenderChildren(),a.styleHtmlContent&&d.addCls(a.styleHtmlCls),c.writeTo(b),e=b.removed,e&&d.removeCls(e),e=b.cls,e.length&&d.addCls(e),e=b.style,b.style&&d.setStyle(e),a.protoEl=null,a.ownerCt||a.updateLayout()},afterFirstLayout:function(a,b){var c=this,d=Ext.isDefined(c.x),e=Ext.isDefined(c.y),f,g;c.floating&&(!d||!e)&&(c.floatParent?(g=c.el.getAlignToXY(c.floatParent.getTargetEl(),"c-c"),f=c.floatParent.getTargetEl().translatePoints(g[0],g[1])):(g=c.el.getAlignToXY(c.container,"c-c"),f=c.container.translatePoints(g[0],g[1])),c.x=d?c.x:f.left,c.y=e?c.y:f.top,d=e=!0),(d||e)&&c.setPosition(c.x,c.y),c.onBoxReady(a,b),c.hasListeners.boxready&&c.fireEvent("boxready",c,a,b)},onBoxReady:Ext.emptyFn,applyRenderSelectors:function(){var a=this,b=a.renderSelectors,c=a.el,d=c.dom,e;a.applyChildEls(c);if(b)for(e in b)b.hasOwnProperty(e)&&b[e]&&(a[e]=Ext.get(Ext.DomQuery.selectNode(b[e],d)))},beforeRender:function(){var a=this,b=a.getTargetEl(),c=a.getComponentLayout();a.frame=a.frame||a.alwaysFramed,c.initialized||c.initLayout(),b&&(b.setStyle(a.getOverflowStyle()),a.overflowStyleSet=!0),a.setUI(a.ui),a.disabled&&a.disable(!0)},doApplyRenderTpl:function(a,b){var c=b.$comp,d;c.rendered||(d=c.initRenderTpl(),d.applyOut(b.renderData,a))},doAutoRender:function(){var a=this;a.rendered||(a.floating?a.render(document.body):a.render(Ext.isBoolean(a.autoRender)?Ext.getBody():a.autoRender))},doRenderContent:function(a,b){var c=b.$comp;c.html&&(Ext.DomHelper.generateMarkup(c.html,a),delete c.html),c.tpl&&(c.tpl.isTemplate||(c.tpl=new Ext.XTemplate(c.tpl)),c.data&&(c.tpl.applyOut(c.data,a),delete c.data))},doRenderFramingDockedItems:function(a,b,c){var d=b.$comp;!d.rendered&&d.doRenderDockedItems&&(b.renderData.$skipDockedItems=!0,d.doRenderDockedItems.call(this,a,b,c))},finishRender:function(a){var b=this,c,d,e,f,g,h;!b.el||b.$pid?(b.container?f=b.container.getById(b.id,!0):f=Ext.getDom(b.id),b.el?(delete b.$pid,b.el.dom||b.wrapPrimaryEl(b.el),f.parentNode.insertBefore(b.el.dom,f),Ext.removeNode(f)):b.wrapPrimaryEl(f)):b.rendering||(c=b.initRenderTpl(),c&&(d=b.initRenderData(),c.insertFirst(b.getTargetEl(),d))),b.container||(b.container=Ext.get(b.el.dom.parentNode)),b.ctCls&&b.container.addCls(b.ctCls),b.onRender(b.container,a),b.overflowStyleSet||b.getTargetEl().setStyle(b.getOverflowStyle()),b.el.setVisibilityMode(Ext.Element[b.hideMode.toUpperCase()]),b.overCls&&b.el.hover(b.addOverCls,b.removeOverCls,b),b.hasListeners.render&&b.fireEvent("render",b),b.contentEl&&(g=Ext.baseCSSPrefix,h=g+"hide-",e=Ext.get(b.contentEl),e.removeCls([g+"hidden",h+"display",h+"offsets",h+"nosize"]),b.getTargetEl().appendChild(e.dom)),b.afterRender(),b.hasListeners.afterrender&&b.fireEvent("afterrender",b),b.initEvents(),b.hidden&&b.el.hide()},finishRenderChildren:function(){var a=this.getComponentLayout();a.finishRender()},getElConfig:function(){var a=this,b=a.autoEl,c=a.getFrameInfo(),d={tag:"div",id:a.id,tpl:c?a.initFramingTpl(c.table):a.initRenderTpl()},e,f,g,h,i;a.initStyles(a.protoEl),a.protoEl.writeTo(d),a.protoEl.flush(),Ext.isString(b)?d.tag=b:Ext.apply(d,b);if(d.tpl)if(c){f=a.frameElNames,g=f.length,i=a.id+"-frame1",a.frameGenId=1,d.tplData=Ext.apply({},{$comp:a,fgid:i,ui:a.ui,uiCls:a.uiCls,frameCls:a.frameCls,baseCls:a.baseCls,frameWidth:c.maxWidth,top:!!c.top,left:!!c.left,right:!!c.right,bottom:!!c.bottom,renderData:a.initRenderData()},a.getFramePositions(c));for(e=0;e<g;e++)h=f[e],a.addChildEls({name:"frame"+h,id:i+h});a.addChildEls({name:"frameBody",id:i+"MC"})}else d.tplData=a.initRenderData();return d},initFramingTpl:function(a){var b=a?this.getTpl("frameTableTpl"):this.getTpl("frameTpl");return b&&!b.applyRenderTpl&&this.setupFramingTpl(b),b},setupFramingTpl:function(a){a.applyRenderTpl=this.doApplyRenderTpl,a.renderDockedItems=this.doRenderFramingDockedItems},getInsertPosition:function(a){return a!==undefined&&(Ext.isNumber(a)?a=this.container.dom.childNodes[a]:a=Ext.getDom(a)),a},getRenderTree:function(){var a=this;return!a.hasListeners.beforerender||a.fireEvent("beforerender",a)!==!1?(a.beforeRender(),a.rendering=!0,a.el?{tag:"div",id:a.$pid=Ext.id()}:a.getElConfig()):null},initContainer:function(a){var b=this;return!a&&b.el&&(a=b.el.dom.parentNode,b.allowDomMove=!1),b.container=a.dom?a:Ext.get(a),b.container},initRenderData:function(){var a=this;return Ext.apply({$comp:a,id:a.id,ui:a.ui,uiCls:a.uiCls,baseCls:a.baseCls,componentCls:a.componentCls,frame:a.frame},a.renderData)},initRenderTpl:function(){var a=this.getTpl("renderTpl");return a&&!a.renderContent&&this.setupRenderTpl(a),a},onRender:function(a,b){var c=this,d=c.x,e=c.y,f,g,h,i=c.el;Ext.scopeResetCSS&&!c.ownerCt&&(i.dom==Ext.getBody().dom?i.parent().addCls(Ext.resetCls):c.resetEl=i.wrap({cls:Ext.resetCls})),c.applyRenderSelectors(),delete c.rendering,c.rendered=!0,f=null,d!==undefined&&(f=f||{},f.x=d),e!==undefined&&(f=f||{},f.y=e),!c.getFrameInfo()&&Ext.isBorderBox&&(g=c.width,h=c.height,typeof g=="number"&&(f=f||{},f.width=g),typeof h=="number"&&(f=f||{},f.height=h)),c.lastBox=c.el.lastBox=f},render:function(a,b){var c=this,d=c.el&&(c.el=Ext.get(c.el)),e,f;Ext.suspendLayouts(),a=c.initContainer(a),f=c.getInsertPosition(b),d?(c.initStyles(d),c.allowDomMove!==!1&&(f?a.dom.insertBefore(d.dom,f):a.dom.appendChild(d.dom))):(e=c.getRenderTree(),e&&(f?d=Ext.DomHelper.insertBefore(f,e):d=Ext.DomHelper.append(a,e),c.wrapPrimaryEl(d))),d&&c.finishRender(b),Ext.resumeLayouts(!a.isDetachedBody)},ensureAttachedToBody:function(a){var b=this,c;while(b.ownerCt)b=b.ownerCt;b.container.isDetachedBody&&(b.container=c=Ext.getBody(),c.appendChild(b.el.dom),a&&b.updateLayout(),(typeof b.x=="number"||typeof b.y=="number")&&b.setPosition(b.x,b.y))},setupRenderTpl:function(a){a.renderBody=a.renderContent=this.doRenderContent},wrapPrimaryEl:function(a){this.el=Ext.get(a,!0)},initFrame:function(){if(Ext.supports.CSS3BorderRadius||!this.frame)return;var a=this,b=a.getFrameInfo(),c,d,e,f,g=a.frameElNames,h=g.length,i;if(b){c=b.maxWidth,d=a.getFrameTpl(b.table),a.frameGenId=e=(a.frameGenId||0)+1,e=a.id+"-frame"+e,d.insertFirst(a.el,Ext.apply({$comp:a,fgid:e,ui:a.ui,uiCls:a.uiCls,frameCls:a.frameCls,baseCls:a.baseCls,frameWidth:c,top:!!b.top,left:!!b.left,right:!!b.right,bottom:!!b.bottom},a.getFramePositions(b))),a.frameBody=a.el.down("."+a.frameCls+"-mc"),a.removeChildEls(function(b){return b.id&&a.frameIdRegex.test(b.id)});for(f=0;f<h;f++)i=g[f],a["frame"+i]=a.el.getById(e+i)}},updateFrame:function(){if(Ext.supports.CSS3BorderRadius||!this.frame)return;var a=this,b=this.frameSize&&this.frameSize.table,c=this.frameTL,d=this.frameBL,e=this.frameML,f=this.frameMC,g;this.initFrame(),f?a.frame&&(g=this.frameMC.dom.className,f.insertAfter(this.frameMC),this.frameMC.remove(),this.frameBody=this.frameMC=f,f.dom.className=g,b?a.el.query("> table")[1].remove():(c&&c.remove(),d&&d.remove(),e&&e.remove())):a.frame&&this.applyRenderSelectors()},getFrameInfo:function(){if(Ext.supports.CSS3BorderRadius||!this.frame)return!1;var a=this,b=a.frameInfoCache,c=a.el||a.protoEl,d=c.dom?c.dom.className:c.classList.join(" "),e=b[d],f,g,h,i;return e==null&&(f=Ext.fly(a.getStyleProxy(d),"frame-style-el"),g=f.getStyle("background-position-x"),h=f.getStyle("background-position-y"),!g&&!h&&(i=f.getStyle("background-position").split(" "),g=i[0],h=i[1]),e=a.calculateFrame(g,h),e&&c.setStyle("background-image","none"),b[d]=e),a.frame=!!e,a.frameSize=e,e},calculateFrame:function(a,b){if(parseInt(a,10)>=1e6&&parseInt(b,10)>=1e6){var c=Math.max,d=parseInt(a.substr(3,2),10),e=parseInt(a.substr(5,2),10),f=parseInt(b.substr(3,2),10),g=parseInt(b.substr(5,2),10),h={table:a.substr(0,3)=="110",vertical:b.substr(0,3)=="110",top:c(d,e),right:c(e,f),bottom:c(g,f),left:c(d,g)};return h.maxWidth=c(h.top,h.right,h.bottom,h.left),h.width=h.left+h.right,h.height=h.top+h.bottom,h}return!1},getStyleProxy:function(a){var b=this.styleProxyEl||(Ext.AbstractComponent.prototype.styleProxyEl=Ext.getBody().createChild({style:{position:"absolute",top:"-10000px"}},null,!0));return b.className=a,b},getFramePositions:function(a){var b=this,c=a.maxWidth,d=b.dock,e,f,g,h,i;return a.vertical?(f="0 -"+c*0+"px",g="0 -"+c*1+"px",d&&d=="right"&&(f="right -"+c*0+"px",g="right -"+c*1+"px"),e={tl:"0 -"+c*0+"px",tr:"0 -"+c*1+"px",bl:"0 -"+c*2+"px",br:"0 -"+c*3+"px",ml:"-"+c*1+"px 0",mr:"right 0",tc:f,bc:g}):(h="-"+c*0+"px 0",i="right 0",d&&d=="bottom"&&(h="left bottom",i="right bottom"),e={tl:"0 -"+c*2+"px",tr:"right -"+c*3+"px",bl:"0 -"+c*4+"px",br:"right -"+c*5+"px",ml:h,mr:i,tc:"0 -"+c*0+"px",bc:"0 -"+c*1+"px"}),e},getFrameTpl:function(a){return this.getTpl(a?"frameTableTpl":"frameTpl")},frameInfoCache:{}}),Ext.define("Ext.util.Sorter",{direction:"ASC",constructor:function(a){var b=this;Ext.apply(b,a),b.updateSortFunction()},createSortFunction:function(a){var b=this,c=b.property,d=b.direction||"ASC",e=d.toUpperCase()=="DESC"?-1:1;return function(c,d){return e*a.call(b,c,d)}},defaultSorterFn:function(a,b){var c=this,d=c.transform,e=c.getRoot(a)[c.property],f=c.getRoot(b)[c.property];return d&&(e=d(e),f=d(f)),e>f?1:e<f?-1:0},getRoot:function(a){return this.root===undefined?a:a[this.root]},setDirection:function(a){var b=this;b.direction=a,b.updateSortFunction()},toggle:function(){var a=this;a.direction=Ext.String.toggle(a.direction,"ASC","DESC"),a.updateSortFunction()},updateSortFunction:function(a){var b=this;a=a||b.sorterFn||b.defaultSorterFn,b.sort=b.createSortFunction(a)}}),Ext.define("Ext.Action",{constructor:function(a){this.initialConfig=a,this.itemId=a.itemId=a.itemId||a.id||Ext.id(),this.items=[]},isAction:!0,setText:function(a){this.initialConfig.text=a,this.callEach("setText",[a])},getText:function(){return this.initialConfig.text},setIconCls:function(a){this.initialConfig.iconCls=a,this.callEach("setIconCls",[a])},getIconCls:function(){return this.initialConfig.iconCls},setDisabled:function(a){this.initialConfig.disabled=a,this.callEach("setDisabled",[a])},enable:function(){this.setDisabled(!1)},disable:function(){this.setDisabled(!0)},isDisabled:function(){return this.initialConfig.disabled},setHidden:function(a){this.initialConfig.hidden=a,this.callEach("setVisible",[!a])},show:function(){this.setHidden(!1)},hide:function(){this.setHidden(!0)},isHidden:function(){return this.initialConfig.hidden},setHandler:function(a,b){this.initialConfig.handler=a,this.initialConfig.scope=b,this.callEach("setHandler",[a,b])},each:function(a,b){Ext.each(this.items,a,b)},callEach:function(a,b){var c=this.items,d=0,e=c.length;for(;d<e;d++)c[d][a].apply(c[d],b)},addComponent:function(a){this.items.push(a),a.on("destroy",this.removeComponent,this)},removeComponent:function(a){Ext.Array.remove(this.items,a)},execute:function(){this.initialConfig.handler.apply(this.initialConfig.scope||Ext.global,arguments)}}),Ext.define("Ext.Layer",{extend:"Ext.Element",uses:["Ext.Shadow"],statics:{shims:[]},isLayer:!0,constructor:function(a,b){a=a||{};var c=this,d=Ext.DomHelper,e=a.parentEl,f=e?Ext.getDom(e):document.body,g=a.hideMode;b&&(c.dom=Ext.getDom(b)),c.dom?(c.addCls(Ext.baseCSSPrefix+"layer"),c.dom.parentNode||f.appendChild(c.dom)):c.dom=d.append(f,a.dh||{tag:"div",cls:Ext.baseCSSPrefix+"layer"}),a.id?c.id=c.dom.id=a.id:c.id=Ext.id(c.dom),Ext.Element.addToCache(c),a.cls&&c.addCls(a.cls),c.constrain=a.constrain!==!1,g?(c.setVisibilityMode(Ext.Element[g.toUpperCase()]),c.visibilityMode==Ext.Element.ASCLASS&&(c.visibilityCls=a.visibilityCls)):a.useDisplay?c.setVisibilityMode(Ext.Element.DISPLAY):c.setVisibilityMode(Ext.Element.VISIBILITY),a.shadow?(c.shadowOffset=a.shadowOffset||4,c.shadow=new Ext.Shadow({offset:c.shadowOffset,mode:a.shadow}),c.disableShadow()):c.shadowOffset=0,c.useShim=a.shim!==!1&&Ext.useShims,a.hidden===!0?c.hide():c.show()},getZIndex:function(){return parseInt((this.getShim()||this).getStyle("z-index"),10)},getShim:function(){var a=this,b,c;return a.useShim?(a.shim||(b=a.self.shims.shift(),b||(b=a.createShim(),b.enableDisplayMode("block"),b.hide()),c=a.dom.parentNode,b.dom.parentNode!=c&&c.insertBefore(b.dom,a.dom),a.shim=b),a.shim):null},hideShim:function(){var a=this;a.shim&&(a.shim.setDisplayed(!1),a.self.shims.push(a.shim),delete a.shim)},disableShadow:function(){var a=this;a.shadow&&!a.shadowDisabled&&(a.shadowDisabled=!0,a.shadow.hide(),a.lastShadowOffset=a.shadowOffset,a.shadowOffset=0)},enableShadow:function(a){var b=this;b.shadow&&b.shadowDisabled&&(b.shadowDisabled=!1,b.shadowOffset=b.lastShadowOffset,delete b.lastShadowOffset,a&&b.sync(!0))},sync:function(a){var b=this,c=b.shadow,d,e,f,g,h,i,j,k,l;return!b.updating&&b.isVisible()&&(c||b.useShim)&&(g=b.getShim(),h=b.getLeft(!0),i=b.getTop(!0),j=b.dom.offsetWidth,k=b.dom.offsetHeight,c&&!b.shadowDisabled?(a&&!c.isVisible()?c.show(b):c.realign(h,i,j,k),g&&(l=g.getStyle("z-index"),l>b.zindex&&b.shim.setStyle("z-index",b.zindex-2),g.show(),c.isVisible()?(d=c.el.getXY(),e=g.dom.style,f=c.el.getSize(),Ext.supports.CSS3BoxShadow&&(f.height+=6,f.width+=4,d[0]-=2,d[1]-=4),e.left=d[0]+"px",e.top=d[1]+"px",e.width=f.width+"px",e.height=f.height+"px"):(g.setSize(j,k),g.setLeftTop(h,i)))):g&&(l=g.getStyle("z-index"),l>b.zindex&&b.shim.setStyle("z-index",b.zindex-2),g.show(),g.setSize(j,k),g.setLeftTop(h,i))),b},remove:function(){this.hideUnders(),this.callParent()},beginUpdate:function(){this.updating=!0},endUpdate:function(){this.updating=!1,this.sync(!0)},hideUnders:function(){this.shadow&&this.shadow.hide(),this.hideShim()},constrainXY:function(){if(this.constrain){var a=Ext.Element.getViewWidth(),b=Ext.Element.getViewHeight(),c=Ext.getDoc().getScroll(),d=this.getXY(),e=d[0],f=d[1],g=this.shadowOffset,h=this.dom.offsetWidth+g,i=this.dom.offsetHeight+g,j=!1;e+h>a+c.left&&(e=a-h-g,j=!0),f+i>b+c.top&&(f=b-i-g,j=!0),e<c.left&&(e=c.left,j=!0),f<c.top&&(f=c.top,j=!0),j&&(Ext.Layer.superclass.setXY.call(this,[e,f]),this.sync())}return this},getConstrainOffset:function(){return this.shadowOffset},setVisible:function(a,b,c,d,e){var f=this,g;return g=function(){a&&f.sync(!0),d&&d()},a||f.hideUnders(!0),f.callParent([a,b,c,d,e]),b||g(),f},beforeFx:function(){return this.beforeAction(),this.callParent(arguments)},afterFx:function(){this.callParent(arguments),this.sync(this.isVisible())},beforeAction:function(){!this.updating&&this.shadow&&this.shadow.hide()},setLeft:function(a){return this.callParent(arguments),this.sync()},setTop:function(a){return this.callParent(arguments),this.sync()},setLeftTop:function(a,b){return this.callParent(arguments),this.sync()},setXY:function(a,b,c,d,e){var f=this;return d=f.createCB(d),f.fixDisplay(),f.beforeAction(),f.callParent([a,b,c,d,e]),b||d(),f},createCB:function(a){var b=this,c=b.shadow&&b.shadow.isVisible();return function(){b.constrainXY(),b.sync(c),a&&a()}},setX:function(a,b,c,d,e){return this.setXY([a,this.getY()],b,c,d,e),this},setY:function(a,b,c,d,e){return this.setXY([this.getX(),a],b,c,d,e),this},setSize:function(a,b,c,d,e,f){var g=this;return e=g.createCB(e),g.beforeAction(),g.callParent([a,b,c,d,e,f]),c||e(),g},setWidth:function(a,b,c,d,e){var f=this;return d=f.createCB(d),f.beforeAction(),f.callParent([a,b,c,d,e]),b||d(),f},setHeight:function(a,b,c,d,e){var f=this;return d=f.createCB(d),f.beforeAction(),f.callParent([a,b,c,d,e]),b||d(),f},setBounds:function(a,b,c,d,e,f,g,h){var i=this;return g=i.createCB(g),i.beforeAction(),e?i.callParent([a,b,c,d,e,f,g,h]):(Ext.Layer.superclass.setXY.call(i,[a,b]),Ext.Layer.superclass.setSize.call(i,c,d),g()),i},setZIndex:function(a){var b=this;return b.zindex=a,b.getShim()&&b.shim.setStyle("z-index",a++),b.shadow&&b.shadow.setZIndex(a++),b.setStyle("z-index",a)},onOpacitySet:function(a){var b=this.shadow;b&&b.setOpacity(a)}}),Ext.define("Ext.ShadowPool",{singleton:!0,requires:["Ext.DomHelper"],markup:function(){return Ext.String.format('<div class="{0}{1}-shadow" role="presentation"></div>',Ext.baseCSSPrefix,Ext.isIE&&!Ext.supports.CSS3BoxShadow?"ie":"css")}(),shadows:[],pull:function(){var a=this.shadows.shift();return a||(a=Ext.get(Ext.DomHelper.insertHtml("beforeBegin",document.body.firstChild,this.markup)),a.autoBoxAdjust=!1),a},push:function(a){this.shadows.push(a)},reset:function(){var a=[].concat(this.shadows),b,c=a.length;for(b=0;b<c;b++)a[b].remove();this.shadows=[]}}),Ext.define("Ext.ZIndexManager",{alternateClassName:"Ext.WindowGroup",statics:{zBase:9e3},constructor:function(a){var b=this;b.list={},b.zIndexStack=[],b.front=null,a?a.isContainer?(a.on("resize",b._onContainerResize,b),b.zseed=Ext.Number.from(b.rendered?a.getEl().getStyle("zIndex"):undefined,b.getNextZSeed()),b.targetEl=a.getTargetEl(),b.container=a):(Ext.EventManager.onWindowResize(b._onContainerResize,b),b.zseed=b.getNextZSeed(),b.targetEl=Ext.get(a)):(Ext.EventManager.onWindowResize(b._onContainerResize,b),b.zseed=b.getNextZSeed(),Ext.onDocumentReady(function(){b.targetEl=Ext.getBody()}))},getNextZSeed:function(){return Ext.ZIndexManager.zBase+=1e4},setBase:function(a){this.zseed=a;var b=this.assignZIndices();return this._activateLast(),b},assignZIndices:function(){var a=this.zIndexStack,b=a.length,c=0,d=this.zseed,e;for(;c<b;c++)e=a[c],e&&!e.hidden&&(d=e.setZIndex(d));return this._activateLast(),d},_setActiveChild:function(a,b){var c=this.front;a!==c&&(c&&!c.destroying&&c.setActive(!1,a),this.front=a,a&&a!=b&&(a.setActive(!0),a.modal&&this._showModalMask(a)))},onComponentHide:function(a){a.setActive(!1),this._activateLast()},_activateLast:function(){var a=this,b=a.zIndexStack,c=b.length-1,d=a.front,e;a.front=undefined;for(;c>=0&&b[c].hidden;--c);if(e=b[c]){a._setActiveChild(e,d);if(e.modal)return}for(;c>=0;--c){e=b[c];if(e.isVisible()&&e.modal){a._showModalMask(e);return}}a._hideModalMask()},_showModalMask:function(a){var b=this,c=a.el.getStyle("zIndex")-4,d=a.floatParent?a.floatParent.getTargetEl():a.container,e=d.getBox();d.dom===document.body&&(e.height=Math.max(document.body.scrollHeight,Ext.dom.Element.getDocumentHeight()),e.width=Math.max(document.body.scrollWidth,e.width)),b.mask||(b.mask=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"mask"}),b.mask.setVisibilityMode(Ext.Element.DISPLAY),b.mask.on("click",b._onMaskClick,b)),b.mask.maskTarget=d,d.addCls(Ext.baseCSSPrefix+"body-masked"),b.mask.setBox(e),b.mask.setStyle("zIndex",c),b.mask.show()},_hideModalMask:function(){var a=this.mask;a&&a.isVisible()&&(a.maskTarget.removeCls(Ext.baseCSSPrefix+"body-masked"),a.maskTarget=undefined,a.hide())},_onMaskClick:function(){this.front&&this.front.focus()},_onContainerResize:function(){var a=this.mask,b,c;a&&a.isVisible()&&(a.hide(),b=a.maskTarget,b.dom===document.body?c={height:Math.max(document.body.scrollHeight,Ext.dom.Element.getDocumentHeight()),width:Math.max(document.body.scrollWidth,document.documentElement.clientWidth)}:c=b.getViewSize(!0),a.setSize(c),a.show())},register:function(a){var b=this;a.zIndexManager&&a.zIndexManager.unregister(a),a.zIndexManager=b,b.list[a.id]=a,b.zIndexStack.push(a),a.on("hide",b.onComponentHide,b)},unregister:function(a){var b=this,c=b.list;delete a.zIndexManager,c&&c[a.id]&&(delete c[a.id],a.un("hide",b.onComponentHide),Ext.Array.remove(b.zIndexStack,a),b._activateLast())},get:function(a){return a.isComponent?a:this.list[a]},bringToFront:function(a){var b=this,c=!1,d=b.zIndexStack;return a=b.get(a),a!==b.front&&(Ext.Array.remove(d,a),a.preventBringToFront?d.unshift(a):d.push(a),b.assignZIndices(),c=!0,this.front=a),c&&a.modal&&b._showModalMask(a),c},sendToBack:function(a){var b=this;return a=b.get(a),Ext.Array.remove(b.zIndexStack,a),b.zIndexStack.unshift(a),b.assignZIndices(),this._activateLast(),a},hideAll:function(){var a=this.list,b,c;for(c in a)a.hasOwnProperty(c)&&(b=a[c],b.isComponent&&b.isVisible()&&b.hide())},hide:function(){var a=0,b=this.zIndexStack,c=b.length,d;this.tempHidden=[];for(;a<c;a++)d=b[a],d.isVisible()&&(this.tempHidden.push(d),d.el.hide())},show:function(){var a=0,b=this.tempHidden,c=b?b.length:0,d;for(;a<c;a++)d=b[a],d.el.show(),d.setPosition(d.x,d.y);delete this.tempHidden},getActive:function(){return this.front},getBy:function(a,b){var c=[],d=0,e=this.zIndexStack,f=e.length,g;for(;d<f;d++)g=e[d],a.call(b||g,g)!==!1&&c.push(g);return c},each:function(a,b){var c=this.list,d,e;for(d in c)if(c.hasOwnProperty(d)){e=c[d];if(e.isComponent&&a.call(b||e,e)===!1)return}},eachBottomUp:function(a,b){var c=this.zIndexStack,d=0,e=c.length,f;for(;d<e;d++){f=c[d];if(f.isComponent&&a.call(b||f,f)===!1)return}},eachTopDown:function(a,b){var c=this.zIndexStack,d=c.length,e;for(;d-->0;){e=c[d];if(e.isComponent&&a.call(b||e,e)===!1)return}},destroy:function(){var a=this,b=a.list,c,d;for(d in b)b.hasOwnProperty(d)&&(c=b[d],c.isComponent&&c.destroy());delete a.zIndexStack,delete a.list,delete a.container,delete a.targetEl}},function(){Ext.WindowManager=Ext.WindowMgr=new this}),Ext.define("Ext.dd.DragDropManager",{singleton:!0,requires:["Ext.util.Region"],uses:["Ext.tip.QuickTipManager"],alternateClassName:["Ext.dd.DragDropMgr","Ext.dd.DDM"],ids:{},handleIds:{},dragCurrent:null,dragOvers:{},deltaX:0,deltaY:0,preventDefault:!0,stopPropagation:!0,initialized:!1,locked:!1,init:function(){this.initialized=!0},POINT:0,INTERSECT:1,mode:0,notifyOccluded:!1,_execOnAll:function(a,b){var c,d,e;for(c in this.ids)for(d in this.ids[c]){e=this.ids[c][d];if(!this.isTypeOfDD(e))continue;e[a].apply(e,b)}},_onLoad:function(){this.init();var a=Ext.EventManager;a.on(document,"mouseup",this.handleMouseUp,this,!0),a.on(document,"mousemove",this.handleMouseMove,this,!0),a.on(window,"unload",this._onUnload,this,!0),a.on(window,"resize",this._onResize,this,!0)},_onResize:function(a){this._execOnAll("resetConstraints",[])},lock:function(){this.locked=!0},unlock:function(){this.locked=!1},isLocked:function(){return this.locked},locationCache:{},useCache:!0,clickPixelThresh:3,clickTimeThresh:350,dragThreshMet:!1,clickTimeout:null,startX:0,startY:0,regDragDrop:function(a,b){this.initialized||this.init(),this.ids[b]||(this.ids[b]={}),this.ids[b][a.id]=a},removeDDFromGroup:function(a,b){this.ids[b]||(this.ids[b]={});var c=this.ids[b];c&&c[a.id]&&delete c[a.id]},_remove:function(a){for(var b in a.groups)b&&this.ids[b]&&this.ids[b][a.id]&&delete this.ids[b][a.id];delete this.handleIds[a.id]},regHandle:function(a,b){this.handleIds[a]||(this.handleIds[a]={}),this.handleIds[a][b]=b},isDragDrop:function(a){return this.getDDById(a)?!0:!1},getRelated:function(a,b){var c=[],d,e,f;for(d in a.groups)for(e in this.ids[d]){f=this.ids[d][e];if(!this.isTypeOfDD(f))continue;if(!b||f.isTarget)c[c.length]=f}return c},isLegalTarget:function(a,b){var c=this.getRelated(a,!0),d,e;for(d=0,e=c.length;d<e;++d)if(c[d].id==b.id)return!0;return!1},isTypeOfDD:function(a){return a&&a.__ygDragDrop},isHandle:function(a,b){return this.handleIds[a]&&this.handleIds[a][b]},getDDById:function(a){var b=this,c,d;for(c in this.ids){d=this.ids[c][a];if(d instanceof Ext.dd.DDTarget)return d}return null},handleMouseDown:function(a,b){Ext.tip.QuickTipManager&&Ext.tip.QuickTipManager.ddDisable(),this.dragCurrent&&this.handleMouseUp(a),this.currentTarget=a.getTarget(),this.dragCurrent=b;var c=b.getEl();this.startX=a.getPageX(),this.startY=a.getPageY(),this.deltaX=this.startX-c.offsetLeft,this.deltaY=this.startY-c.offsetTop,this.dragThreshMet=!1,this.clickTimeout=setTimeout(function(){var a=Ext.dd.DragDropManager;a.startDrag(a.startX,a.startY)},this.clickTimeThresh)},startDrag:function(a,b){clearTimeout(this.clickTimeout),this.dragCurrent&&(this.dragCurrent.b4StartDrag(a,b),this.dragCurrent.startDrag(a,b)),this.dragThreshMet=!0},handleMouseUp:function(a){Ext.tip&&Ext.tip.QuickTipManager&&Ext.tip.QuickTipManager.ddEnable();if(!this.dragCurrent)return;clearTimeout(this.clickTimeout),this.dragThreshMet&&this.fireEvents(a,!0),this.stopDrag(a),this.stopEvent(a)},stopEvent:function(a){this.stopPropagation&&a.stopPropagation(),this.preventDefault&&a.preventDefault()},stopDrag:function(a){this.dragCurrent&&(this.dragThreshMet&&(this.dragCurrent.b4EndDrag(a),this.dragCurrent.endDrag(a)),this.dragCurrent.onMouseUp(a)),this.dragCurrent=null,this.dragOvers={}},handleMouseMove:function(a){if(!this.dragCurrent)return!0;if(Ext.isIE&&a.button!==0&&a.button!==1&&a.button!==2)return this.stopEvent(a),this.handleMouseUp(a);var b,c;return this.dragThreshMet||(b=Math.abs(this.startX-a.getPageX()),c=Math.abs(this.startY-a.getPageY()),(b>this.clickPixelThresh||c>this.clickPixelThresh)&&this.startDrag(this.startX,this.startY)),this.dragThreshMet&&(this.dragCurrent.b4Drag(a),this.dragCurrent.onDrag(a),this.dragCurrent.moveOnly||this.fireEvents(a,!1)),this.stopEvent(a),!0},fireEvents:function(a,b){var c=this,d=c.dragCurrent,e=a.getPoint(),f,g,h=[],i=[],j=[],k=[],l=[],m=[],n,o,p,q;if(!d||d.isLocked())return;for(o in c.dragOvers){f=c.dragOvers[o];if(!c.isTypeOfDD(f))continue;this.isOverTarget(e,f,c.mode)||j.push(f),i[o]=!0,delete c.dragOvers[o]}for(q in d.groups){if("string"!=typeof q)continue;for(o in c.ids[q])f=c.ids[q][o],c.isTypeOfDD(f)&&(g=f.getEl())&&f.isTarget&&!f.isLocked()&&Ext.fly(g).isVisible(!0)&&(f!=d||d.ignoreSelf===!1)&&((f.zIndex=c.getZIndex(g))!==-1&&(n=!0),h.push(f))}n&&Ext.Array.sort(h,c.byZIndex);for(o=0,p=h.length;o<p;o++){f=h[o];if(c.isOverTarget(e,f,c.mode)){b?l.push(f):(i[f.id]?k.push(f):m.push(f),c.dragOvers[f.id]=f);if(!c.notifyOccluded)break}}if(c.mode)j.length&&(d.b4DragOut(a,j),d.onDragOut(a,j)),m.length&&d.onDragEnter(a,m),k.length&&(d.b4DragOver(a,k),d.onDragOver(a,k)),l.length&&(d.b4DragDrop(a,l),d.onDragDrop(a,l));else{for(o=0,p=j.length;o<p;++o)d.b4DragOut(a,j[o].id),d.onDragOut(a,j[o].id);for(o=0,p=m.length;o<p;++o)d.onDragEnter(a,m[o].id);for(o=0,p=k.length;o<p;++o)d.b4DragOver(a,k[o].id),d.onDragOver(a,k[o].id);for(o=0,p=l.length;o<p;++o)d.b4DragDrop(a,l[o].id),d.onDragDrop(a,l[o].id)}b&&!l.length&&d.onInvalidDrop(a)},getZIndex:function(a){var b=document.body,c,d=-1;a=Ext.getDom(a);while(a!==b)isNaN(c=Number(Ext.fly(a).getStyle("zIndex")))||(d=c),a=a.parentNode;return d},byZIndex:function(a,b){return a.zIndex<b.zIndex},getBestMatch:function(a){var b=null,c=a.length,d,e;if(c==1)b=a[0];else for(d=0;d<c;++d){e=a[d];if(e.cursorIsOver){b=e;break}if(!b||b.overlap.getArea()<e.overlap.getArea())b=e}return b},refreshCache:function(a){var b,c,d,e;for(b in a){if("string"!=typeof b)continue;for(c in this.ids[b])d=this.ids[b][c],this.isTypeOfDD(d)&&(e=this.getLocation(d),e?this.locationCache[d.id]=e:delete this.locationCache[d.id])}},verifyEl:function(a){if(a){var b;if(Ext.isIE)try{b=a.offsetParent}catch(c){}else b=a.offsetParent;if(b)return!0}return!1},getLocation:function(a){if(!this.isTypeOfDD(a))return null;if(a.getRegion)return a.getRegion();var b=a.getEl(),c,d,e,f,g,h,i,j,k;try{c=Ext.Element.getXY(b)}catch(l){}return c?(d=c[0],e=d+b.offsetWidth,f=c[1],g=f+b.offsetHeight,h=f-a.padding[0],i=e+a.padding[1],j=g+a.padding[2],k=d-a.padding[3],new Ext.util.Region(h,i,j,k)):null},isOverTarget:function(a,b,c){var d=this.locationCache[b.id],e,f,g,h,i;if(!d||!this.useCache)d=this.getLocation(b),this.locationCache[b.id]=d;return d?(b.cursorIsOver=d.contains(a),e=this.dragCurrent,!e||!e.getTargetCoord||!c&&!e.constrainX&&!e.constrainY?b.cursorIsOver:(b.overlap=null,f=e.getTargetCoord(a.x,a.y),g=e.getDragEl(),h=new Ext.util.Region(f.y,f.x+g.offsetWidth,f.y+g.offsetHeight,f.x),i=h.intersect(d),i?(b.overlap=i,c?!0:b.cursorIsOver):!1)):!1},_onUnload:function(a,b){Ext.dd.DragDropManager.unregAll()},unregAll:function(){this.dragCurrent&&(this.stopDrag(),this.dragCurrent=null),this._execOnAll("unreg",[]);for(var a in this.elementCache)delete this.elementCache[a];this.elementCache={},this.ids={}},elementCache:{},getElWrapper:function(a){var b=this.elementCache[a];if(!b||!b.el)b=this.elementCache[a]=new this.ElementWrapper(Ext.getDom(a));return b},getElement:function(a){return Ext.getDom(a)},getCss:function(a){var b=Ext.getDom(a);return b?b.style:null},ElementWrapper:function(a){this.el=a||null,this.id=this.el&&a.id,this.css=this.el&&a.style},getPosX:function(a){return Ext.Element.getX(a)},getPosY:function(a){return Ext.Element.getY(a)},swapNode:function(a,b){if(a.swapNode)a.swapNode(b);else{var c=b.parentNode,d=b.nextSibling;d==a?c.insertBefore(a,b):b==a.nextSibling?c.insertBefore(b,a):(a.parentNode.replaceChild(b,a),c.insertBefore(a,d))}},getScroll:function(){var a=window.document,b=a.documentElement,c=a.body,d=0,e=0;return Ext.isGecko4?(d=window.scrollYOffset,e=window.scrollXOffset):b&&(b.scrollTop||b.scrollLeft)?(d=b.scrollTop,e=b.scrollLeft):c&&(d=c.scrollTop,e=c.scrollLeft),{top:d,left:e}},getStyle:function(a,b){return Ext.fly(a).getStyle(b)},getScrollTop:function(){return this.getScroll().top},getScrollLeft:function(){return this.getScroll().left},moveToEl:function(a,b){var c=Ext.Element.getXY(b);Ext.Element.setXY(a,c)},numericSort:function(a,b){return a-b},_timeoutCount:0,_addListeners:function(){document?this._onLoad():this._timeoutCount<=2e3&&(setTimeout(this._addListeners,10),document&&document.body&&(this._timeoutCount+=1))},handleWasClicked:function(a,b){if(this.isHandle(b,a.id))return!0;var c=a.parentNode;while(c){if(this.isHandle(b,c.id))return!0;c=c.parentNode}return!1}},function(){this._addListeners()}),Ext.define("Ext.dd.DragTracker",{uses:["Ext.util.Region"],mixins:{observable:"Ext.util.Observable"},active:!1,trackOver:!1,tolerance:5,autoStart:!1,constructor:function(a){Ext.apply(this,a),this.addEvents("mouseover","mouseout","mousedown","mouseup","mousemove","beforedragstart","dragstart","dragend","drag"),this.dragRegion=new Ext.util.Region(0,0,0,0),this.el&&this.initEl(this.el),this.mixins.observable.constructor.call(this),this.disabled&&this.disable()},initEl:function(a){this.el=Ext.get(a),this.handle=Ext.get(this.delegate),this.delegate=this.handle?undefined:this.delegate,this.handle||(this.handle=this.el),this.mon(this.handle,{mousedown:this.onMouseDown,delegate:this.delegate,scope:this}),(this.trackOver||this.overCls)&&this.mon(this.handle,{mouseover:this.onMouseOver,mouseout:this.onMouseOut,delegate:this.delegate,scope:this})},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1},destroy:function(){this.clearListeners(),delete this.el},onMouseOver:function(a,b){var c=this;!c.disabled&&(Ext.EventManager.contains(a)||c.delegate)&&(c.mouseIsOut=!1,c.overCls&&c.el.addCls(c.overCls),c.fireEvent("mouseover",c,a,c.delegate?a.getTarget(c.delegate,b):c.handle))},onMouseOut:function(a){this.mouseIsDown?this.mouseIsOut=!0:(this.overCls&&this.el.removeCls(this.overCls),this.fireEvent("mouseout",this,a))},onMouseDown:function(a,b){if(this.disabled||a.dragTracked)return;this.dragTarget=this.delegate?b:this.handle.dom,this.startXY=this.lastXY=a.getXY(),this.startRegion=Ext.fly(this.dragTarget).getRegion();if(this.fireEvent("mousedown",this,a)===!1||this.fireEvent("beforedragstart",this,a)===!1||this.onBeforeStart(a)===!1)return;this.mouseIsDown=!0,a.dragTracked=!0,this.preventDefault!==!1&&a.preventDefault(),Ext.getDoc().on({scope:this,mouseup:this.onMouseUp,mousemove:this.onMouseMove,selectstart:this.stopSelect}),this.autoStart&&(this.timer=Ext.defer(this.triggerStart,this.autoStart===!0?1e3:this.autoStart,this,[a]))},onMouseMove:function(a,b){if(this.active&&Ext.isIE&&!a.browserEvent.button){a.preventDefault(),this.onMouseUp(a);return}a.preventDefault();var c=a.getXY(),d=this.startXY;this.lastXY=c;if(!this.active){if(!(Math.max(Math.abs(d[0]-c[0]),Math.abs(d[1]-c[1]))>this.tolerance))return;this.triggerStart(a)}this.fireEvent("mousemove",this,a)===!1?this.onMouseUp(a):(this.onDrag(a),this.fireEvent("drag",this,a))},onMouseUp:function(a){this.mouseIsDown=!1,this.mouseIsOut&&(this.mouseIsOut=!1,this.onMouseOut(a)),a.preventDefault(),this.fireEvent("mouseup",this,a),this.endDrag(a)},endDrag:function(a){var b=Ext.getDoc(),c=this.active;b.un("mousemove",this.onMouseMove,this),b.un("mouseup",this.onMouseUp,this),b.un("selectstart",this.stopSelect,this),this.clearStart(),this.active=!1,c&&(this.onEnd(a),this.fireEvent("dragend",this,a)),delete this._constrainRegion,delete Ext.EventObject.dragTracked},triggerStart:function(a){this.clearStart(),this.active=!0,this.onStart(a),this.fireEvent("dragstart",this,a)},clearStart:function(){this.timer&&(clearTimeout(this.timer),delete this.timer)},stopSelect:function(a){return a.stopEvent(),!1},onBeforeStart:function(a){},onStart:function(a){},onDrag:function(a){},onEnd:function(a){},getDragTarget:function(){return this.dragTarget},getDragCt:function(){return this.el},getConstrainRegion:function(){if(this.constrainTo){if(this.constrainTo instanceof Ext.util.Region)return this.constrainTo;this._constrainRegion||(this._constrainRegion=Ext.fly(this.constrainTo).getViewRegion())}else this._constrainRegion||(this._constrainRegion=this.getDragCt().getViewRegion());return this._constrainRegion},getXY:function(a){return a?this.constrainModes[a](this,this.lastXY):this.lastXY},getOffset:function(a){var b=this.getXY(a),c=this.startXY;return[b[0]-c[0],b[1]-c[1]]},constrainModes:{point:function(a,b){var c=a.dragRegion,d=a.getConstrainRegion();return d?(c.x=c.left=c[0]=c.right=b[0],c.y=c.top=c[1]=c.bottom=b[1],c.constrainTo(d),[c.left,c.top]):b},dragTarget:function(a,b){var c=a.startXY,d=a.startRegion.copy(),e=a.getConstrainRegion(),f;return e?(d.translateBy(b[0]-c[0],b[1]-c[1]),d.right>e.right&&(b[0]+=f=e.right-d.right,d.left+=f),d.left<e.left&&(b[0]+=e.left-d.left),d.bottom>e.bottom&&(b[1]+=f=e.bottom-d.bottom,d.top+=f),d.top<e.top&&(b[1]+=e.top-d.top),b):b}}}),Ext.define("Ext.dd.Registry",{singleton:!0,constructor:function(){this.elements={},this.handles={},this.autoIdSeed=0},getId:function(a,b){if(typeof a=="string")return a;var c=a.id;return!c&&b!==!1&&(c="extdd-"+ ++this.autoIdSeed,a.id=c),c},register:function(a,b){b=b||{},typeof a=="string"&&(a=document.getElementById(a)),b.ddel=a,this.elements[this.getId(a)]=b,b.isHandle!==!1&&(this.handles[b.ddel.id]=b);if(b.handles){var c=b.handles,d,e;for(d=0,e=c.length;d<e;d++)this.handles[this.getId(c[d])]=b}},unregister:function(a){var b=this.getId(a,!1),c=this.elements[b],d,e,f;if(c){delete this.elements[b];if(c.handles){d=c.handles;for(e=0,f=d.length;e<f;e++)delete this.handles[this.getId(d[e],!1)]}}},getHandle:function(a){return typeof a!="string"&&(a=a.id),this.handles[a]},getHandleFromEvent:function(a){var b=a.getTarget();return b?this.handles[b.id]:null},getTarget:function(a){return typeof a!="string"&&(a=a.id),this.elements[a]},getTargetFromEvent:function(a){var b=a.getTarget();return b?this.elements[b.id]||this.handles[b.id]:null}}),Ext.define("Ext.dd.ScrollManager",{singleton:!0,requires:["Ext.dd.DragDropManager"],constructor:function(){var a=Ext.dd.DragDropManager;a.fireEvents=Ext.Function.createSequence(a.fireEvents,this.onFire,this),a.stopDrag=Ext.Function.createSequence(a.stopDrag,this.onStop,this),this.doScroll=Ext.Function.bind(this.doScroll,this),this.ddmInstance=a,this.els={},this.dragEl=null,this.proc={}},onStop:function(a){var b=Ext.dd.ScrollManager;b.dragEl=null,b.clearProc()},triggerRefresh:function(){this.ddmInstance.dragCurrent&&this.ddmInstance.refreshCache(this.ddmInstance.dragCurrent.groups)},doScroll:function(){if(this.ddmInstance.dragCurrent){var a=this.proc,b=a.el,c=a.el.ddScrollConfig,d=c?c.increment:this.increment;this.animate?b.scroll(a.dir,d,!0,this.animDuration,this.triggerRefresh):b.scroll(a.dir,d)&&this.triggerRefresh()}},clearProc:function(){var a=this.proc;a.id&&clearInterval(a.id),a.id=0,a.el=null,a.dir=""},startProc:function(a,b){this.clearProc(),this.proc.el=a,this.proc.dir=b;var c=a.ddScrollConfig?a.ddScrollConfig.ddGroup:undefined,d=a.ddScrollConfig&&a.ddScrollConfig.frequency?a.ddScrollConfig.frequency:this.frequency;if(c===undefined||this.ddmInstance.dragCurrent.ddGroup==c)this.proc.id=setInterval(this.doScroll,d)},onFire:function(a,b){if(b||!this.ddmInstance.dragCurrent)return;if(!this.dragEl||this.dragEl!=this.ddmInstance.dragCurrent)this.dragEl=this.ddmInstance.dragCurrent,this.refreshCache();var c=a.getXY(),d=a.getPoint(),e=this.proc,f=this.els,g,h,i,j;for(g in f){h=f[g],i=h._region,j=h.ddScrollConfig?h.ddScrollConfig:this;if(i&&i.contains(d)&&h.isScrollable()){if(i.bottom-d.y<=j.vthresh){e.el!=h&&this.startProc(h,"down");return}if(i.right-d.x<=j.hthresh){e.el!=h&&this.startProc(h,"left");return}if(d.y-i.top<=j.vthresh){e.el!=h&&this.startProc(h,"up");return}if(d.x-i.left<=j.hthresh){e.el!=h&&this.startProc(h,"right");return}}}this.clearProc()},register:function(a){if(Ext.isArray(a))for(var b=0,c=a.length;b<c;b++)this.register(a[b]);else a=Ext.get(a),this.els[a.id]=a},unregister:function(a){if(Ext.isArray(a))for(var b=0,c=a.length;b<c;b++)this.unregister(a[b]);else a=Ext.get(a),delete this.els[a.id]},vthresh:25,hthresh:25,increment:100,frequency:500,animate:!0,animDuration:.4,ddGroup:undefined,refreshCache:function(){var a=this.els,b;for(b in a)typeof a[b]=="object"&&(a[b]._region=a[b].getRegion())}}),Ext.define("Ext.form.FieldAncestor",{initFieldAncestor:function(){var a=this,b=a.onFieldAncestorSubtreeChange;a.addEvents("fieldvaliditychange","fielderrorchange"),a.on("add",b,a),a.on("remove",b,a),a.initFieldDefaults()},initFieldDefaults:function(){this.fieldDefaults||(this.fieldDefaults={})},onFieldAncestorSubtreeChange:function(a,b){function e(a){var b=a.isFieldLabelable,f=a.isFormField;b||f?(b&&c["onLabelable"+(d?"Added":"Removed")](a),f&&c["onField"+(d?"Added":"Removed")](a)):a.isContainer&&Ext.Array.forEach(a.getRefItems(),e)}var c=this,d=!!b.ownerCt;e(b)},onLabelableAdded:function(a){var b=this;b.mon(a,"errorchange",b.handleFieldErrorChange,b,{buffer:10}),a.setFieldDefaults(b.fieldDefaults)},onFieldAdded:function(a){var b=this;b.mon(a,"validitychange",b.handleFieldValidityChange,b)},onLabelableRemoved:function(a){var b=this;b.mun(a,"errorchange",b.handleFieldErrorChange,b)},onFieldRemoved:function(a){var b=this;b.mun(a,"validitychange",b.handleFieldValidityChange,b)},handleFieldValidityChange:function(a,b){var c=this;c.fireEvent("fieldvaliditychange",c,a,b),c.onFieldValidityChange(a,b)},handleFieldErrorChange:function(a,b){var c=this;c.fireEvent("fielderrorchange",c,a,b),c.onFieldErrorChange(a,b)},onFieldValidityChange:Ext.emptyFn,onFieldErrorChange:Ext.emptyFn}),Ext.define("Ext.form.action.Action",{alternateClassName:"Ext.form.Action",submitEmptyText:!0,constructor:function(a){a&&Ext.apply(this,a);var b=a.params;Ext.isString(b)&&(this.params=Ext.Object.fromQueryString(b))},run:Ext.emptyFn,onFailure:function(a){this.response=a,this.failureType=Ext.form.action.Action.CONNECT_FAILURE,this.form.afterAction(this,!1)},processResponse:function(a){return this.response=a,!a.responseText&&!a.responseXML?!0:this.result=this.handleResponse(a)},getUrl:function(){return this.url||this.form.url},getMethod:function(){return(this.method||this.form.method||"POST").toUpperCase()},getParams:function(){return Ext.apply({},this.params,this.form.baseParams)},createCallback:function(){var a=this,b,c=a.form;return{success:a.onSuccess,failure:a.onFailure,scope:a,timeout:this.timeout*1e3||c.timeout*1e3,upload:c.fileUpload?a.onSuccess:b}},statics:{CLIENT_INVALID:"client",SERVER_INVALID:"server",CONNECT_FAILURE:"connect",LOAD_FAILURE:"load"}}),Ext.define("Ext.form.action.Submit",{extend:"Ext.form.action.Action",alternateClassName:"Ext.form.Action.Submit",alias:"formaction.submit",type:"submit",run:function(){var a=this.form;this.clientValidation===!1||a.isValid()?this.doSubmit():(this.failureType=Ext.form.action.Action.CLIENT_INVALID,a.afterAction(this,!1))},doSubmit:function(){var a,b=Ext.apply(this.createCallback(),{url:this.getUrl(),method:this.getMethod(),headers:this.headers});this.form.hasUpload()?(a=b.form=this.buildForm(),b.isUpload=!0):b.params=this.getParams(),Ext.Ajax.request(b),a&&Ext.removeNode(a)},getParams:function(){var a=!1,b=this.callParent(),c=this.form.getValues(a,a,this.submitEmptyText!==a);return Ext.apply({},c,b)},buildForm:function(){function q(b,c){a.push({tag:"input",type:"hidden",name:b,value:Ext.String.htmlEncode(c)})}var a=[],b,c,d=this.form,e=this.getParams(),f=[],g=d.getFields().items,h,i=g.length,j,k,l,m,n,o,p;for(h=0;h<i;h++)j=g[h],j.isFileUpload()&&f.push(j);for(k in e)if(e.hasOwnProperty(k)){l=e[k];if(Ext.isArray(l)){n=l.length;for(m=0;m<n;m++)q(k,l[m])}else q(k,l)}b={tag:"form",action:this.getUrl(),method:this.getMethod(),target:this.target||"_self",style:"display:none",cn:a},f.length&&(b.encoding=b.enctype="multipart/form-data"),c=Ext.DomHelper.append(Ext.getBody(),b),p=f.length;for(o=0;o<p;o++)j=f[o],j.rendered&&c.appendChild(j.extractFileInput());return c},onSuccess:function(a){var b=this.form,c=!0,d=this.processResponse(a);d!==!0&&!d.success&&(d.errors&&b.markInvalid(d.errors),this.failureType=Ext.form.action.Action.SERVER_INVALID,c=!1),b.afterAction(this,c)},handleResponse:function(a){var b=this.form,c=b.errorReader,d,e,f,g,h;if(c){d=c.read(a),h=d.records,e=[];if(h)for(f=0,g=h.length;f<g;f++)e[f]=h[f].data;return e.length<1&&(e=null),{success:d.success,errors:e}}return Ext.decode(a.responseText)}}),Ext.define("Ext.form.field.Field",{isFormField:!0,disabled:!1,submitValue:!0,validateOnChange:!0,suspendCheckChange:0,initField:function(){this.addEvents("change","validitychange","dirtychange"),this.initValue()},initValue:function(){var a=this;a.originalValue=a.lastValue=a.value,a.suspendCheckChange++,a.setValue(a.value),a.suspendCheckChange--},getName:function(){return this.name},getValue:function(){return this.value},setValue:function(a){var b=this;return b.value=a,b.checkChange(),b},isEqual:function(a,b){return String(a)===String(b)},isEqualAsString:function(a,b){return String(Ext.value(a,""))===String(Ext.value(b,""))},getSubmitData:function(){var a=this,b=null;return!a.disabled&&a.submitValue&&!a.isFileUpload()&&(b={},b[a.getName()]=""+a.getValue()),b},getModelData:function(){var a=this,b=null;return!a.disabled&&!a.isFileUpload()&&(b={},b[a.getName()]=a.getValue()),b},reset:function(){var a=this;a.setValue(a.originalValue),a.clearInvalid(),delete a.wasValid},resetOriginalValue:function(){this.originalValue=this.getValue(),this.checkDirty()},checkChange:function(){if(!this.suspendCheckChange){var a=this,b=a.getValue(),c=a.lastValue;!a.isEqual(b,c)&&!a.isDestroyed&&(a.lastValue=b,a.fireEvent("change",a,b,c),a.onChange(b,c))}},onChange:function(a,b){this.validateOnChange&&this.validate(),this.checkDirty()},isDirty:function(){var a=this;return!a.disabled&&!a.isEqual(a.getValue(),a.originalValue)},checkDirty:function(){var a=this,b=a.isDirty();b!==a.wasDirty&&(a.fireEvent("dirtychange",a,b),a.onDirtyChange(b),a.wasDirty=b)},onDirtyChange:Ext.emptyFn,getErrors:function(a){return[]},isValid:function(){var a=this;return a.disabled||Ext.isEmpty(a.getErrors())},validate:function(){var a=this,b=a.isValid();return b!==a.wasValid&&(a.wasValid=b,a.fireEvent("validitychange",a,b)),b},batchChanges:function(a){try{this.suspendCheckChange++,a()}catch(b){throw b}finally{this.suspendCheckChange--}this.checkChange()},isFileUpload:function(){return!1},extractFileInput:function(){return null},markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn}),Ext.define("Ext.form.field.VTypes",function(){var a=/^[a-zA-Z_]+$/,b=/^[a-zA-Z0-9_]+$/,c=/^(\w+)([\-+.][\w]+)*@(\w[\-\w]*\.){1,5}([A-Za-z]){2,6}$/,d=/(((^https?)|(^ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;return{singleton:!0,alternateClassName:"Ext.form.VTypes",email:function(a){return c.test(a)},emailText:'This field should be an e-mail address in the format "user@example.com"',emailMask:/[a-z0-9_\.\-@\+]/i,url:function(a){return d.test(a)},urlText:'This field should be a URL in the format "http://www.example.com"',alpha:function(b){return a.test(b)},alphaText:"This field should only contain letters and _",alphaMask:/[a-z_]/i,alphanum:function(a){return b.test(a)},alphanumText:"This field should only contain letters, numbers and _",alphanumMask:/[a-z0-9_]/i}}()),Ext.define("Ext.grid.LockingView",{mixins:{observable:"Ext.util.Observable"},eventRelayRe:/^(beforeitem|beforecontainer|item|container|cell)/,constructor:function(a){var b=this,c=[],d=b.eventRelayRe,e=a.locked.getView(),f=a.normal.getView(),g,h;Ext.apply(b,{lockedView:e,normalView:f,lockedGrid:a.locked,normalGrid:a.normal,panel:a.panel}),b.mixins.observable.constructor.call(b,a),g=e.events;for(h in g)g.hasOwnProperty(h)&&d.test(h)&&c.push(h);b.relayEvents(e,c),b.relayEvents(f,c),f.on({scope:b,itemmouseleave:b.onItemMouseLeave,itemmouseenter:b.onItemMouseEnter}),e.on({scope:b,itemmouseleave:b.onItemMouseLeave,itemmouseenter:b.onItemMouseEnter})},getGridColumns:function(){var a=this.lockedGrid.headerCt.getGridColumns();return a.concat(this.normalGrid.headerCt.getGridColumns())},getEl:function(a){return this.getViewForColumn(a).getEl()},getViewForColumn:function(a){var b=this.lockedView,c;return b.headerCt.cascade(function(b){if(b===a)return c=!0,!1}),c?b:this.normalView},onItemMouseEnter:function(a,b){var c=this,d=c.lockedView,e=c.normalView,f;a.trackOver&&(a!==d&&(e=d),f=e.getNode(b),e.highlightItem(f))},onItemMouseLeave:function(a,b){var c=this,d=c.lockedView,e=c.normalView;a.trackOver&&(a!==d&&(e=d),e.clearHighlight())},relayFn:function(a,b){b=b||[];var c=this.lockedView;c[a].apply(c,b||[]),c=this.normalView,c[a].apply(c,b||[])},getSelectionModel:function(){return this.panel.getSelectionModel()},getStore:function(){return this.panel.store},getNode:function(a){return this.normalView.getNode(a)},getCell:function(a,b){var c=this.getViewForColumn(b),d;return d=c.getNode(a),Ext.fly(d).down(b.getCellSelector())},getRecord:function(a){var b=this.lockedView.getRecord(a);return a||(b=this.normalView.getRecord(a)),b},addElListener:function(a,b,c){this.relayFn("addElListener",arguments)},refreshNode:function(){this.relayFn("refreshNode",arguments)},refresh:function(){this.relayFn("refresh",arguments)},bindStore:function(){this.relayFn("bindStore",arguments)},addRowCls:function(){this.relayFn("addRowCls",arguments)},removeRowCls:function(){this.relayFn("removeRowCls",arguments)}}),Ext.define("Ext.grid.PagingScroller",{percentageFromEdge:.35,numFromEdge:2,trailingBufferZone:5,leadingBufferZone:15,scrollToLoadBuffer:200,viewSize:0,rowHeight:21,tableStart:0,tableEnd:0,constructor:function(a){var b=this;b.variableRowHeight=a.variableRowHeight,b.bindView(a.view),Ext.apply(b,a),b.callParent(arguments)},bindView:function(a){var b=this,c={scroll:{fn:b.onViewScroll,element:"el",scope:b},render:b.onViewRender,resize:b.onViewResize,boxready:{fn:b.onViewResize,scope:b,single:!0},refresh:b.onViewRefresh,scope:b},d={guaranteedrange:b.onGuaranteedRange,scope:b},e={reconfigure:b.onGridReconfigure,scope:b};b.variableRowHeight&&(c.beforerefresh=b.beforeViewRefresh),b.view&&(b.view.el.un("scroll",b.onViewScroll,b),b.view.un(c),b.store.un(d),b.grid&&b.grid.un(e),delete b.view.refreshSize),b.view=a,b.grid=b.view.up("tablepanel"),b.store=a.store,a.rendered&&(b.viewSize=b.store.viewSize=Math.ceil(a.getHeight()/b.rowHeight)+b.trailingBufferZone+b.numFromEdge*2+b.leadingBufferZone),b.view.refreshSize=Ext.Function.createInterceptor(b.view.refreshSize,b.beforeViewrefreshSize,b),b.position=0,b.grid?b.grid.on(e):b.view.on({added:function(){b.grid=b.view.up("tablepanel"),b.grid.on(e)},single:!0}),b.view.on(b.viewListeners=c),b.store.on(d)},onGridReconfigure:function(a){this.bindView(a.view)},onViewRender:function(){var a=this,b=a.view.el;b.setStyle("position","relative"),a.stretcher=b.createChild({style:{position:"absolute",width:"1px",height:0,top:0,left:0}},b.dom.firstChild)},onViewResize:function(a,b,c){var d=this,e;e=Math.ceil(c/d.rowHeight)+d.trailingBufferZone+d.numFromEdge*2+d.leadingBufferZone,e>d.viewSize&&(d.viewSize=d.store.viewSize=e,d.handleViewScroll(d.lastScrollDirection||1))},beforeViewRefresh:function(){var a=this,b=a.view,c,d=a.lastScrollDirection;a.commonRecordIndex=undefined,d&&a.previousStart!==undefined&&a.scrollProportion===undefined?(c=b.getNodes(),d===1?a.tableStart<=a.previousEnd&&(a.commonRecordIndex=c.length-1):d===-1&&a.tableEnd>=a.previousStart&&(a.commonRecordIndex=0),a.scrollOffset=-b.el.getOffsetsTo(c[a.commonRecordIndex])[1],a.commonRecordIndex-=a.tableStart-a.previousStart):a.scrollOffset=undefined},onViewRefresh:function(){var a=this,b=a.store,c,d=a.view,e=d.el,f=e.dom,g,h,i,j=e.child("table",!0),k,l;a.disabled=!0;if(b.getCount()===b.getTotalCount()||b.isFiltered()&&!b.remoteFilter){a.stretcher.setHeight(0),a.position=f.scrollTop=0,j.style.position="absolute";return}a.stretcher.setHeight(c=a.getScrollHeight()),l=f.scrollTop,a.isScrollRefresh=l>0;if(a.scrollProportion!==undefined)a.scrollProportion=l/(c-j.offsetHeight),j.style.position="absolute",j.style.top=(a.scrollProportion?c*a.scrollProportion-j.offsetHeight*a.scrollProportion:0)+"px";else{j.style.position="absolute",j.style.top=(k=(a.tableStart||0)*a.rowHeight)+"px";if(a.scrollOffset)g=d.getNodes(),h=-e.getOffsetsTo(g[a.commonRecordIndex])[1],i=h-a.scrollOffset,a.position=l+=i;else if(k>l||k+j.offsetHeight<l+f.clientHeight)a.lastScrollDirection=-1,a.position=f.scrollTop=k}a.disabled=!1},beforeViewrefreshSize:function(){if(this.isScrollRefresh)return this.isScrollRefresh=!1},onGuaranteedRange:function(a,b,c){var d=this,e=d.store;if(a.length&&d.visibleStart<a[0].index)return;d.previousStart=d.tableStart,d.previousEnd=d.tableEnd,d.tableStart=b,d.tableEnd=c,e.loadRecords(a)},onViewScroll:function(a,b){var c=this,d=c.view,e=c.position;c.position=d.el.dom.scrollTop,c.disabled||(c.lastScrollDirection=c.position>e?1:-1,e!==c.position&&c.handleViewScroll(c.lastScrollDirection))},handleViewScroll:function(a){var b=this,c=b.store,d=b.view,e=b.viewSize,f=c.getTotalCount(),g=f-e,h=b.getFirstVisibleRowIndex(),i=b.getLastVisibleRowIndex(),j,k;f>=e&&(b.scrollProportion=undefined,a==-1?h!==undefined?h<b.tableStart+b.numFromEdge&&(j=Math.max(0,i+b.trailingBufferZone-e)):(b.scrollProportion=d.el.dom.scrollTop/(d.el.dom.scrollHeight-d.el.dom.clientHeight),j=Math.max(0,f*b.scrollProportion-e/2-b.numFromEdge-(b.leadingBufferZone+b.trailingBufferZone)/2)):h!==undefined?i>b.tableEnd-b.numFromEdge&&(j=Math.max(0,h-b.trailingBufferZone)):(b.scrollProportion=d.el.dom.scrollTop/(d.el.dom.scrollHeight-d.el.dom.clientHeight),j=f*b.scrollProportion-e/2-b.numFromEdge-(b.leadingBufferZone+b.trailingBufferZone)/2),j!==undefined&&(j>g?(j=g&-2,k=f-1):(j&=-2,k=j+e-1),c.rangeCached(j,k)?(b.cancelLoad(),c.guaranteeRange(j,k)):b.attemptLoad(j,k)))},getFirstVisibleRowIndex:function(){var a=this,b=a.store,c=a.view,d=c.el.dom.scrollTop,e,f,g,h;if(!a.variableRowHeight)return Math.floor(d/a.rowHeight);e=c.getNodes(),f=b.getCount();for(g=0;g<f;g++){h=Ext.fly(e[g]).getOffsetsTo(c.el)[1]+e[g].offsetHeight;if(h>c.el.dom.clientHeight)return;if(h>0)return g+a.tableStart}},getLastVisibleRowIndex:function(){var a=this,b=a.store,c=a.view,d=c.el.dom.clientHeight,e,f,g,h;if(!a.variableRowHeight)return a.getFirstVisibleRowIndex()+Math.ceil(d/a.rowHeight)+1;e=c.getNodes(),f=b.getCount();for(g=f-1;g>=0;g--){h=Ext.fly(e[g]).getOffsetsTo(c.el)[1];if(h<0)return;if(h<d)return g+a.tableStart}},getScrollHeight:function(){var a=this,b=a.view,c,d,e=a.store,f=0,g=!a.hasOwnProperty("rowHeight");return a.variableRowHeight?(c=a.view.el.down("table",!0),g?(a.initialTableHeight=c.offsetHeight,a.rowHeight=a.initialTableHeight/a.store.getCount()):f=c.offsetHeight-a.initialTableHeight):g&&(d=b.el.down(b.getItemSelector()),d&&(a.rowHeight=d.getHeight(!1,!0))),Math.floor(e.getTotalCount()*a.rowHeight)+f},attemptLoad:function(a,b){var c=this;c.scrollToLoadBuffer?(c.loadTask||(c.loadTask=new Ext.util.DelayedTask(c.doAttemptLoad,c,[])),c.loadTask.delay(c.scrollToLoadBuffer,c.doAttemptLoad,c,[a,b])):c.store.guaranteeRange(a,b)},cancelLoad:function(){this.loadTask&&this.loadTask.cancel()},doAttemptLoad:function(a,b){this.store.guaranteeRange(a,b)},destroy:function(){var a=this,b=a.viewListeners.scroll;a.store.un({guaranteedrange:a.onGuaranteedRange,scope:a}),a.view.un(a.viewListeners),a.view.rendered&&(a.stretcher.remove(),a.view.el.un("scroll",b.fn,b.scope))}}),Ext.define("Ext.grid.feature.Feature",{extend:"Ext.util.Observable",alias:"feature.feature",isFeature:!0,disabled:!1,hasFeatureEvent:!0,eventPrefix:null,eventSelector:null,view:null,grid:null,collectData:!1,init:Ext.emptyFn,getFeatureTpl:function(){return""},getFireEventArgs:function(a,b,c,d){return[a,b,c,d]},attachEvents:function(){},getFragmentTpl:Ext.emptyFn,mutateMetaRowTpl:Ext.emptyFn,getMetaRowTplFragments:function(){return{}},getTableFragments:function(){return{}},getAdditionalData:function(a,b,c,d){return{}},enable:function(){this.disabled=!1},disable:function(){this.disabled=!0}}),Ext.define("Ext.grid.feature.Grouping",{extend:"Ext.grid.feature.Feature",alias:"feature.grouping",eventPrefix:"group",eventSelector:"."+Ext.baseCSSPrefix+"grid-group-hd",bodySelector:"."+Ext.baseCSSPrefix+"grid-group-body",constructor:function(){var a=this;a.collapsedState={},a.callParent(arguments)},groupHeaderTpl:"{columnName}: {name}",depthToIndent:17,collapsedCls:Ext.baseCSSPrefix+"grid-group-collapsed",hdCollapsedCls:Ext.baseCSSPrefix+"grid-group-hd-collapsed",groupByText:"Group By This Field",showGroupsText:"Show in Groups",hideGroupedHeader:!1,startCollapsed:!1,enableGroupingMenu:!0,enableNoGroups:!0,enable:function(){var a=this,b=a.view,c=b.store,d;a.lastGroupField=a.getGroupField(),a.lastGroupIndex&&c.group(a.lastGroupIndex),a.callParent(),d=a.view.headerCt.getMenu().down("#groupToggleMenuItem"),d.setChecked(!0,!0),a.refreshIf()},disable:function(){var a=this,b=a.view,c=b.store,d=c.remoteGroup,e,f;f=c.groupers.first(),f&&(a.lastGroupIndex=f.property,a.block(),c.clearGrouping(),a.unblock()),a.callParent(),e=a.view.headerCt.getMenu().down("#groupToggleMenuItem"),e.setChecked(!0,!0),e.setChecked(!1,!0),d||b.refresh()},refreshIf:function(){this.blockRefresh!==!0&&(this.grid.ownerCt&&this.grid.ownerCt.lockable?this.grid.ownerCt.view.refresh():this.view.refresh())},getFeatureTpl:function(a,b,c,d){var e=this;return["<tpl if=\"typeof rows !== 'undefined'\">",'<tr id="{groupHeaderId}" class="'+Ext.baseCSSPrefix+"grid-group-hd "+(e.startCollapsed?e.hdCollapsedCls:"")+' {hdCollapsedCls}"><td class="'+Ext.baseCSSPrefix+'grid-cell" colspan="'+b.columns.length+'" {[this.indentByDepth(values)]}><div class="'+Ext.baseCSSPrefix+'grid-cell-inner"><div class="'+Ext.baseCSSPrefix+'grid-group-title">{collapsed}{[this.renderGroupHeaderTpl(values)]}</div></div></td></tr>','<tr id="{groupBodyId}" class="'+Ext.baseCSSPrefix+"grid-group-body "+(e.startCollapsed?e.collapsedCls:"")+' {collapsedCls}"><td colspan="'+b.columns.length+'">{[this.recurse(values)]}</td></tr>',"</tpl>"].join("")},getFragmentTpl:function(){var a=this;return{indentByDepth:a.indentByDepth,depthToIndent:a.depthToIndent,renderGroupHeaderTpl:function(b){return Ext.XTemplate.getTpl(a,"groupHeaderTpl").apply(b)}}},indentByDepth:function(a){return'style="padding-left:'+(a.depth||0)*this.depthToIndent+'px;"'},destroy:function(){delete this.view,delete this.prunedHeader},attachEvents:function(){var a=this,b=a.view;b.on({scope:a,groupclick:a.onGroupClick,rowfocus:a.onRowFocus}),b.mon(b.store,{scope:a,groupchange:a.onGroupChange,remove:a.onRemove,add:a.onAdd,update:a.onUpdate}),a.enableGroupingMenu&&a.injectGroupingMenu(),a.pruneGroupedHeader(),a.lastGroupField=a.getGroupField(),a.block(),a.onGroupChange(),a.unblock()},onAdd:function(a,b){var c=this,d=c.view,e=c.getGroupField(),f=0,g=b.length,h,i,j,k,l;if(d.rendered){i={},h={};for(;f<g;++f)l=b[f].get(e),i[l]===undefined&&(i[l]=0),i[l]+=1;j=a.getGroups();for(f=0,g=j.length;f<g;++f)l=j[f],h[l.name]=l.children.length;for(l in i)if(i[l]===h[l]){k=!0;break}k&&d.refresh()}},onUpdate:function(a,b,c,d){var e=this.view;(e.rendered&&!d||Ext.Array.contains(d,this.getGroupField()))&&e.refresh()},onRemove:function(a,b){var c=this,d=c.getGroupField(),e=b.get(d),f=c.view;f.rendered&&a.findExact(d,e)===-1&&c.view.refresh()},injectGroupingMenu:function(){var a=this,b=a.view,c=b.headerCt;c.showMenuBy=a.showMenuBy,c.getMenuItems=a.getMenuItems()},showMenuBy:function(a,b){var c=this.getMenu(),d=c.down("#groupMenuItem"),e=b.groupable===!1?"disable":"enable";d[e](),Ext.grid.header.Container.prototype.showMenuBy.apply(this,arguments)},getMenuItems:function(){var a=this,b=a.groupByText,c=a.disabled||!a.getGroupField(),d=a.showGroupsText,e=a.enableNoGroups,f=Ext.Function.bind(a.onGroupMenuItemClick,a),g=Ext.Function.bind(a.onGroupToggleMenuItemClick,a);return function(){var a=Ext.grid.header.Container.prototype.getMenuItems.call(this);return a.push("-",{iconCls:Ext.baseCSSPrefix+"group-by-icon",itemId:"groupMenuItem",text:b,handler:f}),e&&a.push({itemId:"groupToggleMenuItem",text:d,checked:!c,checkHandler:g}),a}},onGroupMenuItemClick:function(a,b){var c=this,d=a.parentMenu,e=d.activeHeader,f=c.view,g=f.store,h=g.remoteGroup;delete c.lastGroupIndex,c.block(),c.enable(),g.group(e.dataIndex),c.pruneGroupedHeader(),c.unblock(),h||f.refresh()},block:function(){this.blockRefresh=this.view.blockRefresh=!0},unblock:function(){this.blockRefresh=this.view.blockRefresh=!1},onGroupToggleMenuItemClick:function(a,b){this[b?"enable":"disable"]()},pruneGroupedHeader:function(){var a=this,b=a.getGroupedHeader();a.hideGroupedHeader&&b&&(a.prunedHeader&&a.prunedHeader.show(),a.prunedHeader=b,b.hide())},getGroupedHeader:function(){var a=this.getGroupField(),b=this.view.headerCt;return a?b.down("[dataIndex="+a+"]"):null},getGroupField:function(){var a=this.view.store.groupers.first();return a?a.property:""},onRowFocus:function(a){var b=this.view.getNode(a),c=Ext.fly(b).up("."+this.collapsedCls);c&&this.expand(c)},expand:function(a,b){var c=this,d=c.view,e,f=c.lockingPartner;Ext.isString(a)?e=Ext.fly(c.getGroupBodyId(a),"_grouping"):(e=Ext.fly(a,"_grouping"),a=c.getGroupName(e)),c.collapsedState[a]&&(e.removeCls(c.collapsedCls),e.prev().removeCls(c.hdCollapsedCls),b!==!0&&d.refreshSize(),d.fireEvent("groupexpand"),c.collapsedState[a]=!1,f&&f.expand(a,b))},expandAll:function(){var a=this,b=a.view,c=b.el.select(a.eventSelector).elements,d,e=c.length;for(d=0;d<e;d++)a.expand(Ext.fly(c[d]).next(),!0);b.refreshSize()},collapse:function(a,b){var c=this,d=c.view,e,f=c.lockingPartner;Ext.isString(a)?e=Ext.fly(c.getGroupBodyId(a),"_grouping"):(e=Ext.fly(a,"_grouping"),a=c.getGroupName(e)),c.collapsedState[a]||(e.addCls(c.collapsedCls),e.prev().addCls(c.hdCollapsedCls),b!==!0&&d.refreshSize(),d.fireEvent("groupcollapse"),c.collapsedState[a]=!0,f&&f.collapse(a,b))},collapseAll:function(){var a=this,b=a.view,c=b.el.select(a.eventSelector).elements,d,e=c.length;for(d=0;d<e;d++)a.collapse(Ext.fly(c[d]).next(),!0);b.refreshSize()},onGroupChange:function(){var a=this,b=a.getGroupField(),c,d,e;a.hideGroupedHeader&&(a.lastGroupField&&(c=a.getMenuItem(a.lastGroupField),c&&c.setChecked(!0)),b&&(d=a.view.headerCt.getVisibleGridColumns(),e=d.length===1&&d[0].dataIndex==b,c=a.getMenuItem(b),c&&!e&&c.setChecked(!1))),a.blockRefresh!==!0&&a.view.refresh(),a.lastGroupField=b},getMenuItem:function(a){var b=this.view,c=b.headerCt.down("gridcolumn[dataIndex="+a+"]"),d=b.headerCt.getMenu();return c?d.down("menuitem[headerId="+c.id+"]"):null},onGroupClick:function(a,b,c,d){var e=this;e.collapsedState[c]?e.expand(c):e.collapse(c)},getMetaRowTplFragments:function(){return{isRow:this.isRow,closeRow:this.closeRow}},isRow:function(){return"<tpl if=\"typeof rows === 'undefined'\">"},closeRow:function(){return"</tpl>"},mutateMetaRowTpl:function(a){a.unshift("{[this.isRow()]}"),a.push("{[this.closeRow()]}")},getAdditionalData:function(a,b,c,d){var e=this.view,f=e.headerCt,g=f.items.getAt(0),h={},i;return g&&(i=g.id+"-tdAttr",h[i]=this.indentByDepth(a)+" "+(d[i]?d[i]:""),h.collapsed="true",h.data=c.getData()),h},getGroupRows:function(a,b,c,d){var e=this,f=a.children,g=a.rows=[],h=e.view,i=e.getGroupedHeader(),j=e.getGroupField(),k=-1,l,m=b.length,n;a.viewId=h.id;for(l=0;l<m;l++)n=b[l],n.get(j)==a.name&&(k=l),Ext.Array.indexOf(f,n)!=-1&&g.push(Ext.apply(c[l],{depth:1}));return a.groupHeaderId=e.getGroupHeaderId(a.name),a.groupBodyId=e.getGroupBodyId(a.name),a.fullWidth=d,a.columnName=i?i.text:j,a.groupValue=a.name,i&&k>-1&&(a.name=a.renderedValue=c[k][i.id]),e.collapsedState[a.name]&&(a.collapsedCls=e.collapsedCls,a.hdCollapsedCls=e.hdCollapsedCls),a},getGroupHeaderId:function(a){return this.view.id+"-hd-"+a},getGroupBodyId:function(a){return this.view.id+"-bd-"+a},getGroupName:function(a){var b=this,c;c=Ext.fly(a).findParent(b.eventSelector);if(c)return c.id.split(this.view.id+"-hd-")[1];c=Ext.fly(a).findParent(b.bodySelector);if(c)return c.id.split(this.view.id+"-bd-")[1]},collectData:function(a,b,c,d,e){var f=this,g=f.view.store,h,i,j,k;if(!f.disabled&&g.isGrouped()){i=g.getGroups(),j=i.length;for(h=0;h<j;h++)k=i[h],f.getGroupRows(k,a,b,d);return{rows:i,fullWidth:d}}return e},getFireEventArgs:function(a,b,c,d){return[a,b,c,this.getGroupName(c),d]}}),Ext.define("Ext.grid.feature.RowBody",{extend:"Ext.grid.feature.Feature",alias:"feature.rowbody",rowBodyHiddenCls:Ext.baseCSSPrefix+"grid-row-body-hidden",rowBodyTrCls:Ext.baseCSSPrefix+"grid-rowbody-tr",rowBodyTdCls:Ext.baseCSSPrefix+"grid-cell-rowbody",rowBodyDivCls:Ext.baseCSSPrefix+"grid-rowbody",eventPrefix:"rowbody",eventSelector:"."+Ext.baseCSSPrefix+"grid-rowbody-tr",getRowBody:function(a){return['<tr class="'+this.rowBodyTrCls+' {rowBodyCls}">','<td class="'+this.rowBodyTdCls+'" colspan="{rowBodyColspan}">','<div class="'+this.rowBodyDivCls+'">{rowBody}</div>',"</td>","</tr>"].join("")},getMetaRowTplFragments:function(){return{getRowBody:this.getRowBody,rowBodyTrCls:this.rowBodyTrCls,rowBodyTdCls:this.rowBodyTdCls,rowBodyDivCls:this.rowBodyDivCls}},mutateMetaRowTpl:function(a){a.push("{[this.getRowBody(values)]}")},getAdditionalData:function(a,b,c,d){var e=this.view.headerCt,f=e.getColumnCount();return{rowBody:"",rowBodyCls:this.rowBodyCls,rowBodyColspan:f}}}),Ext.define("Ext.grid.feature.RowWrap",{extend:"Ext.grid.feature.Feature",alias:"feature.rowwrap",hasFeatureEvent:!1,init:function(){this.disabled||this.enable()},getRowSelector:function(){return"tr:has(> "+this.view.cellSelector+")"},enable:function(){var a=this,b=a.view;a.callParent(),a.savedRowSelector=b.rowSelector,b.rowSelector=a.getRowSelector(),b.onHeaderResize=Ext.Function.createSequence(b.onHeaderResize,a.onHeaderResize,a)},disable:function(){var a=this,b=a.view,c=a.savedRowSelector;a.callParent(),c&&(b.rowSelector=c),delete a.savedRowSelector,delete b.onHeaderResize},mutateMetaRowTpl:function(a){var b=Ext.baseCSSPrefix;a[0]=a[0].replace(b+"grid-row",""),a[0]=a[0].replace("{[this.embedRowCls()]}",""),a.unshift('<table class="'+b+"grid-table "+b+'grid-table-resizer" style="width: {[this.embedFullWidth()]}px;">'),a.unshift('<tr class="'+b+'grid-row {[this.embedRowCls()]}"><td colspan="{[this.embedColSpan()]}"><div class="'+b+'grid-rowwrap-div">'),a.push("</table>"),a.push("</div></td></tr>")},embedColSpan:function(){return"{colspan}"},embedFullWidth:function(){return"{fullWidth}"},getAdditionalData:function(a,b,c,d){var e=this.view.headerCt,f=e.getColumnCount(),g=e.getFullWidth(),h=e.query("gridcolumn"),i=h.length,j=0,k={colspan:f,fullWidth:g},l,m,n;for(;j<i;j++)l=h[j].id,m=l+"-tdCls",n=Ext.baseCSSPrefix+"grid-col-resizer-"+l,k[m]=n+" "+(d[m]?d[m]:""),k[l+"-tdAttr"]=' style="width: '+(h[j].hidden?0:h[j].getDesiredWidth())+'px;" ',d[l+"-tdAttr"]&&(k[l+"-tdAttr"]+=d[l+"-tdAttr"]);return k},getMetaRowTplFragments:function(){return{embedFullWidth:this.embedFullWidth,embedColSpan:this.embedColSpan}},onHeaderResize:function(a,b,c){var d=this.view.el;d&&d.select("td."+Ext.baseCSSPrefix+"grid-col-resizer-"+a.id).setWidth(b)}}),Ext.define("Ext.grid.plugin.DragDrop",{extend:"Ext.AbstractPlugin",alias:"plugin.gridviewdragdrop",uses:["Ext.view.DragZone","Ext.grid.ViewDropZone"],dragText:"{0} selected row{1}",ddGroup:"GridDD",enableDrop:!0,enableDrag:!0,init:function(a){a.on("render",this.onViewRender,this,{single:!0})},destroy:function(){Ext.destroy(this.dragZone,this.dropZone)},enable:function(){var a=this;a.dragZone&&a.dragZone.unlock(),a.dropZone&&a.dropZone.unlock(),a.callParent()},disable:function(){var a=this;a.dragZone&&a.dragZone.lock(),a.dropZone&&a.dropZone.lock(),a.callParent()},onViewRender:function(a){var b=this;b.enableDrag&&(b.dragZone=new Ext.view.DragZone({view:a,ddGroup:b.dragGroup||b.ddGroup,dragText:b.dragText})),b.enableDrop&&(b.dropZone=new Ext.grid.ViewDropZone({view:a,ddGroup:b.dropGroup||b.ddGroup}))}}),Ext.define("Ext.grid.plugin.HeaderResizer",{extend:"Ext.util.Observable",requires:["Ext.dd.DragTracker","Ext.util.Region"],alias:"plugin.gridheaderresizer",disabled:!1,config:{dynamic:!1},colHeaderCls:Ext.baseCSSPrefix+"column-header",minColWidth:40,maxColWidth:1e3,wResizeCursor:"col-resize",eResizeCursor:"col-resize",init:function(a){this.headerCt=a,a.on("render",this.afterHeaderRender,this,{single:!0})},destroy:function(){this.tracker&&this.tracker.destroy()},afterHeaderRender:function(){var a=this.headerCt,b=a.el;a.mon(b,"mousemove",this.onHeaderCtMouseMove,this),this.tracker=new Ext.dd.DragTracker({disabled:this.disabled,onBeforeStart:Ext.Function.bind(this.onBeforeStart,this),onStart:Ext.Function.bind(this.onStart,this),onDrag:Ext.Function.bind(this.onDrag,this),onEnd:Ext.Function.bind(this.onEnd,this),tolerance:3,autoStart:300,el:b})},onHeaderCtMouseMove:function(a,b){var c=this,d,e,f,g,h,i;c.headerCt.dragging?c.activeHd&&(c.activeHd.el.dom.style.cursor="",delete c.activeHd):(e=a.getTarget("."+c.colHeaderCls,3,!0),e&&(f=Ext.getCmp(e.id),f.isOnLeftEdge(a)?(g=f.previousNode("gridcolumn:not([hidden]):not([isGroupHeader])"),g&&(i=c.headerCt.up("tablepanel"),h=g.up("tablepanel"),h===i||i.ownerCt.isXType("tablepanel")&&i.ownerCt.view.lockedGrid===h||(g=null))):f.isOnRightEdge(a)?g=f:g=null,g?(g.isGroupHeader&&(d=g.getGridColumns(),g=d[d.length-1]),g&&!g.fixed&&g.resizable!==!1&&!c.disabled&&(c.activeHd=g,f.el.dom.style.cursor=c.eResizeCursor)):(f.el.dom.style.cursor="",delete c.activeHd)))},onBeforeStart:function(a){var b=a.getTarget();return this.dragHd=this.activeHd,!!this.dragHd&&!Ext.fly(b).hasCls(Ext.baseCSSPrefix+"column-header-trigger")&&!this.headerCt.dragging?(this.tracker.constrainTo=this.getConstrainRegion(),!0):(this.headerCt.dragging=!1,!1)},getConstrainRegion:function(){var a=this,b=a.dragHd.el,c=Ext.util.Region.getRegion(b),d;return a.headerCt.forceFit&&(d=a.dragHd.nextNode("gridcolumn:not([hidden]):not([isGroupHeader])")),c.adjust(0,a.headerCt.forceFit?d?d.getWidth()-a.minColWidth:0:a.maxColWidth-b.getWidth(),0,a.minColWidth)},onStart:function(a){var b=this,c=b.dragHd,d=c.el,e=d.getWidth(),f=b.headerCt,g=a.getTarget(),h,i,j,k,l,m,n,o,p,q,r,s;b.dragHd&&!Ext.fly(g).hasCls(Ext.baseCSSPrefix+"column-header-trigger")&&(f.dragging=!0),b.origWidth=e,b.dynamic||(h=d.getXY(),i=f.up("[scrollerOwner]"),j=b.dragHd.up(":not([isGroupHeader])"),k=j.up(),l=i.getLhsMarker(),m=i.getRhsMarker(),n=m.parent(),o=n.getLeft(!0),p=n.getTop(!0),q=n.translatePoints(h),r=k.body.getHeight()+f.getHeight(),s=q.top-p,l.setTop(s),m.setTop(s),l.setHeight(r),m.setHeight(r),l.setLeft(q.left-o),m.setLeft(q.left+e-o))},onDrag:function(a){if(!this.dynamic){var b=this.tracker.getXY("point"),c=this.headerCt.up("[scrollerOwner]"),d=c.getRhsMarker(),e=d.parent(),f=e.translatePoints(b),g=e.getLeft(!0);d.setLeft(f.left-g)}else this.doResize()},onEnd:function(a){this.headerCt.dragging=!1;if(this.dragHd){if(!this.dynamic){var b=this.dragHd,c=this.headerCt.up("[scrollerOwner]"),d=c.getLhsMarker(),e=c.getRhsMarker(),f=-9999;d.setLeft(f),e.setLeft(f)}this.doResize()}},doResize:function(){if(this.dragHd){var a=this.dragHd,b,c=this.tracker.getOffset("point");a.flex&&delete a.flex,Ext.suspendLayouts(),a.setWidth(this.origWidth+c[0]),this.headerCt.forceFit&&(b=a.nextNode("gridcolumn:not([hidden]):not([isGroupHeader])"),b&&(delete b.flex,b.setWidth(b.getWidth()-c[0]))),Ext.resumeLayouts(!0)}},disable:function(){this.disabled=!0,this.tracker&&this.tracker.disable()},enable:function(){this.disabled=!1,this.tracker&&this.tracker.enable()}}),Ext.define("Ext.layout.container.boxOverflow.None",{alternateClassName:"Ext.layout.boxOverflow.None",constructor:function(a,b){this.layout=a,Ext.apply(this,b)},handleOverflow:Ext.emptyFn,clearOverflow:Ext.emptyFn,beginLayout:Ext.emptyFn,beginLayoutCycle:Ext.emptyFn,finishedLayout:Ext.emptyFn,completeLayout:function(a){var b=this,c=a.state.boxPlan,d;c&&c.tooNarrow?(d=b.handleOverflow(a),d&&d.reservedSpace&&b.layout.publishInnerCtSize(a,d.reservedSpace)):b.clearOverflow()},onRemove:Ext.emptyFn,getItem:function(a){return this.layout.owner.getComponent(a)},getOwnerType:function(a){var b="";return a.is("toolbar")?b="toolbar":a.is("tabbar")?b="tabbar":b=a.getXType(),b},getPrefixConfig:Ext.emptyFn,getSuffixConfig:Ext.emptyFn,getOverflowCls:function(){return""}}),Ext.define("Ext.panel.Proxy",{alternateClassName:"Ext.dd.PanelProxy",moveOnDrag:!0,constructor:function(a,b){var c=this;c.panel=a,c.id=c.panel.id+"-ddproxy",Ext.apply(c,b)},insertProxy:!0,setStatus:Ext.emptyFn,reset:Ext.emptyFn,update:Ext.emptyFn,stop:Ext.emptyFn,sync:Ext.emptyFn,getEl:function(){return this.ghost.el},getGhost:function(){return this.ghost},getProxy:function(){return this.proxy},hide:function(){var a=this;a.ghost&&(a.proxy&&(a.proxy.remove(),delete a.proxy),a.panel.unghost(null,a.moveOnDrag),delete a.ghost)},show:function(){var a=this,b;a.ghost||(b=a.panel.getSize(),a.panel.el.setVisibilityMode(Ext.Element.DISPLAY),a.ghost=a.panel.ghost(),a.insertProxy&&(a.proxy=a.panel.el.insertSibling({cls:Ext.baseCSSPrefix+"panel-dd-spacer"}),a.proxy.setSize(b)))},repair:function(a,b,c){this.hide(),Ext.callback(b,c||this)},moveProxy:function(a,b){this.proxy&&a.insertBefore(this.proxy.dom,b)}}),Ext.define("Ext.resizer.Resizer",{mixins:{observable:"Ext.util.Observable"},uses:["Ext.resizer.ResizeTracker","Ext.Component"],alternateClassName:"Ext.Resizable",handleCls:Ext.baseCSSPrefix+"resizable-handle",pinnedCls:Ext.baseCSSPrefix+"resizable-pinned",overCls:Ext.baseCSSPrefix+"resizable-over",wrapCls:Ext.baseCSSPrefix+"resizable-wrap",dynamic:!0,handles:"s e se",height:null,width:null,heightIncrement:0,widthIncrement:0,minHeight:20,minWidth:20,maxHeight:1e4,maxWidth:1e4,pinned:!1,preserveRatio:!1,transparent:!1,possiblePositions:{n:"north",s:"south",e:"east",w:"west",se:"southeast",sw:"southwest",nw:"northwest",ne:"northeast"},constructor:function(a){var b=this,c,d,e,f=b.handles,g,h,i,j=0,k,l=[],m,n,o;b.addEvents("beforeresize","resizedrag","resize");if(Ext.isString(a)||Ext.isElement(a)||a.dom)c=a,a=arguments[1]||{},a.target=c;b.mixins.observable.constructor.call(b,a),c=b.target,c?c.isComponent?(b.el=c.getEl(),c.minWidth&&(b.minWidth=c.minWidth),c.minHeight&&(b.minHeight=c.minHeight),c.maxWidth&&(b.maxWidth=c.maxWidth),c.maxHeight&&(b.maxHeight=c.maxHeight),c.floating&&(b.hasOwnProperty("handles")||(b.handles="n ne e se s sw w nw"))):b.el=b.target=Ext.get(c):b.target=b.el=Ext.get(b.el),e=b.el.dom.tagName.toUpperCase();if(e=="TEXTAREA"||e=="IMG"||e=="TABLE")b.originalTarget=b.target,d=b.el,o=d.getBox(),b.target=b.el=b.el.wrap({cls:b.wrapCls,id:b.el.id+"-rzwrap",style:d.getStyles("margin-top","margin-bottom")}),b.el.setPositioning(d.getPositioning()),d.clearPositioning(),b.el.setBox(o),d.setStyle("position","absolute");b.el.position(),b.pinned&&b.el.addCls(b.pinnedCls),b.resizeTracker=new Ext.resizer.ResizeTracker({disabled:b.disabled,target:b.target,constrainTo:b.constrainTo,overCls:b.overCls,throttle:b.throttle,originalTarget:b.originalTarget,delegate:"."+b.handleCls,dynamic:b.dynamic,preserveRatio:b.preserveRatio,heightIncrement:b.heightIncrement,widthIncrement:b.widthIncrement,minHeight:b.minHeight,maxHeight:b.maxHeight,minWidth:b.minWidth,maxWidth:b.maxWidth}),b.resizeTracker.on({mousedown:b.onBeforeResize,drag:b.onResize,dragend:b.onResizeEnd,scope:b}),b.handles=="all"&&(b.handles="n s e w ne nw se sw"),f=b.handles=b.handles.split(/ |\s*?[,;]\s*?/),h=b.possiblePositions,i=f.length,g=b.handleCls+" "+(b.target.isComponent?b.target.baseCls+"-handle ":"")+b.handleCls+"-",m=Ext.isIE6?' style="height:'+b.el.getHeight()+'px"':"";for(;j<i;j++)f[j]&&h[f[j]]&&(k=h[f[j]],k==="east"||k==="west"?n=m:n="",l.push('<div id="'+b.el.id+"-"+k+'-handle" class="'+g+k+" "+Ext.baseCSSPrefix+'unselectable"'+n+"></div>"));Ext.DomHelper.append(b.el,l.join(""));for(j=0;j<i;j++)f[j]&&h[f[j]]&&(k=h[f[j]],b[k]=b.el.getById(b.el.id+"-"+k+"-handle"),b[k].region=k,b[k].unselectable(),b.transparent&&b[k].setOpacity(0));Ext.isNumber(b.width)&&(b.width=Ext.Number.constrain(b.width,b.minWidth,b.maxWidth)),Ext.isNumber(b.height)&&(b.height=Ext.Number.constrain(b.height,b.minHeight,b.maxHeight));if(b.width!==null||b.height!==null)b.originalTarget&&(b.originalTarget.setWidth(b.width),b.originalTarget.setHeight(b.height)),b.resizeTo(b.width,b.height);b.forceHandlesHeight()},disable:function(){this.resizeTracker.disable()},enable:function(){this.resizeTracker.enable()},onBeforeResize:function(a,b){var c=this.el.getBox();return this.fireEvent("beforeresize",this,c.width,c.height,b)},onResize:function(a,b){var c=this,d=c.el.getBox();return c.forceHandlesHeight(),c.fireEvent("resizedrag",c,d.width,d.height,b)},onResizeEnd:function(a,b){var c=this,d=c.el.getBox();return c.forceHandlesHeight(),c.fireEvent("resize",c,d.width,d.height,b)},resizeTo:function(a,b){var c=this;c.target.setSize(a,b),c.fireEvent("resize",c,a,b,null)},getEl:function(){return this.el},getTarget:function(){return this.target},destroy:function(){var a=0,b=this.handles,c=b.length,d=this.possiblePositions;for(;a<c;a++)this[d[b[a]]].remove()},forceHandlesHeight:function(){var a=this,b;Ext.isIE6&&(b=a.east,b&&b.setHeight(a.el.getHeight()),b=a.west,b&&b.setHeight(a.el.getHeight()),a.el.repaint())}}),Ext.define("Ext.resizer.ResizeTracker",{extend:"Ext.dd.DragTracker",dynamic:!0,preserveRatio:!1,constrainTo:null,proxyCls:Ext.baseCSSPrefix+"resizable-proxy",constructor:function(a){var b=this,c,d,e;a.el||(a.target.isComponent?b.el=a.target.getEl():b.el=a.target),this.callParent(arguments),b.preserveRatio&&b.minWidth&&b.minHeight&&(c=b.minWidth/b.el.getWidth(),d=b.minHeight/b.el.getHeight(),d>c?b.minWidth=b.el.getWidth()*d:b.minHeight=b.el.getHeight()*c),b.throttle&&(e=Ext.Function.createThrottled(function(){Ext.resizer.ResizeTracker.prototype.resize.apply(b,arguments)},b.throttle),b.resize=function(a,c,d){d?Ext.resizer.ResizeTracker.prototype.resize.apply(b,arguments):e.apply(null,arguments)})},onBeforeStart:function(a){this.startBox=this.el.getBox()},getDynamicTarget:function(){var a=this,b=a.target;return a.dynamic?b:(a.proxy||(a.proxy=a.createProxy(b)),a.proxy.show(),a.proxy)},createProxy:function(a){var b,c=this.proxyCls,d;return a.isComponent?b=a.getProxy().addCls(c):(d=Ext.getBody(),Ext.scopeResetCSS&&(d=Ext.getBody().createChild({cls:Ext.resetCls})),b=a.createProxy({tag:"div",cls:c,id:a.id+"-rzproxy"},d)),b.removeCls(Ext.baseCSSPrefix+"proxy-el"),b},onStart:function(a){this.activeResizeHandle=Ext.get(this.getDragTarget().id),this.dynamic||this.resize(this.startBox,{horizontal:"none",vertical:"none"})},onDrag:function(a){(this.dynamic||this.proxy)&&this.updateDimensions(a)},updateDimensions:function(a,b){var c=this,d=c.activeResizeHandle.region,e=c.getOffset(c.constrainTo?"dragTarget":null),f=c.startBox,g,h=0,i=0,j,k,l=0,m=0,n,o=e[0]<0?"right":"left",p=e[1]<0?"down":"up",q,r,s,t,u;switch(d){case"south":i=e[1],r=2;break;case"north":i=-e[1],m=-i,r=2;break;case"east":h=e[0],r=1;break;case"west":h=-e[0],l=-h,r=1;break;case"northeast":i=-e[1],m=-i,h=e[0],q=[f.x,f.y+f.height],r=3;break;case"southeast":i=e[1],h=e[0],q=[f.x,f.y],r=3;break;case"southwest":h=-e[0],l=-h,i=e[1],q=[f.x+f.width,f.y],r=3;break;case"northwest":i=-e[1],m=-i,h=-e[0],l=-h,q=[f.x+f.width,f.y+f.height],r=3}s={width:f.width+h,height:f.height+i,x:f.x+l,y:f.y+m},j=Ext.Number.snap(s.width,c.widthIncrement),k=Ext.Number.snap(s.height,c.heightIncrement);if(j!=s.width||k!=s.height){switch(d){case"northeast":s.y-=k-s.height;break;case"north":s.y-=k-s.height;break;case"southwest":s.x-=j-s.width;break;case"west":s.x-=j-s.width;break;case"northwest":s.x-=j-s.width,s.y-=k-s.height}s.width=j,s.height=k}s.width<c.minWidth||s.width>c.maxWidth?(s.width=Ext.Number.constrain(s.width,c.minWidth,c.maxWidth),l&&(s.x=f.x+(f.width-s.width))):c.lastX=s.x,s.height<c.minHeight||s.height>c.maxHeight?(s.height=Ext.Number.constrain(s.height,c.minHeight,c.maxHeight),m&&(s.y=f.y+(f.height-s.height))):c.lastY=s.y;if(c.preserveRatio||a.shiftKey)g=c.startBox.width/c.startBox.height,t=Math.min(Math.max(c.minHeight,s.width/g),c.maxHeight),u=Math.min(Math.max(c.minWidth,s.height*g),c.maxWidth),r==1?s.height=t:r==2?s.width=u:(n=Math.abs(q[0]-this.lastXY[0])/Math.abs(q[1]-this.lastXY[1]),n>g?s.height=t:s.width=u,d=="northeast"?s.y=f.y-(s.height-f.height):d=="northwest"?(s.y=f.y-(s.height-f.height),s.x=f.x-(s.width-f.width)):d=="southwest"&&(s.x=f.x-(s.width-f.width)));i===0&&(p="none"),h===0&&(o="none"),c.resize(s,{horizontal:o,vertical:p},b)},getResizeTarget:function(a){return a?this.target:this.getDynamicTarget()},resize:function(a,b,c){var d=this.getResizeTarget(c);d.isComponent?(d.setSize(a.width,a.height),d.floating&&d.setPagePosition(a.x,a.y)):d.setBox(a),d=this.originalTarget,d&&(this.dynamic||c)&&(d.isComponent?(d.setSize(a.width,a.height),d.floating&&d.setPagePosition(a.x,a.y)):d.setBox(a))},onEnd:function(a){this.updateDimensions(a,!0),this.proxy&&this.proxy.hide()}}),Ext.define("Ext.resizer.SplitterTracker",{extend:"Ext.dd.DragTracker",requires:["Ext.util.Region"],enabled:!0,overlayCls:Ext.baseCSSPrefix+"resizable-overlay",createDragOverlay:function(){var a;a=this.overlay=Ext.getBody().createChild({cls:this.overlayCls,html:"&#160;"}),a.unselectable(),a.setSize(Ext.Element.getViewWidth(!0),Ext.Element.getViewHeight(!0)),a.show()},getPrevCmp:function(){var a=this.getSplitter();return a.previousSibling()},getNextCmp:function(){var a=this.getSplitter();return a.nextSibling()},onBeforeStart:function(a){var b=this,c=b.getPrevCmp(),d=b.getNextCmp(),e=b.getSplitter().collapseEl,f=a.getTarget(),g;return e&&f===b.getSplitter().collapseEl.dom?!1:d.collapsed||c.collapsed?!1:(b.prevBox=c.getEl().getBox(),b.nextBox=d.getEl().getBox(),b.constrainTo=g=b.calculateConstrainRegion(),g?(b.createDragOverlay(),g):!1)},onStart:function(a){var b=this.getSplitter();b.addCls(b.baseCls+"-active")},calculateConstrainRegion:function(){var a=this,b=a.getSplitter(),c=b.getWidth(),d=b.defaultSplitMin,e=b.orientation,f=a.prevBox,g=a.getPrevCmp(),h=a.nextBox,i=a.getNextCmp(),j,k;return e==="vertical"?(j=new Ext.util.Region(f.y,(g.maxWidth?f.x+g.maxWidth:h.right-(i.minWidth||d))+c,f.bottom,f.x+(g.minWidth||d)),k=new Ext.util.Region(h.y,h.right-(i.minWidth||d),h.bottom,(i.maxWidth?h.right-i.maxWidth:f.x+(f.minWidth||d))-c)):(j=new Ext.util.Region(f.y+(g.minHeight||d),f.right,(g.maxHeight?f.y+g.maxHeight:h.bottom-(i.minHeight||d))+c,f.x),k=new Ext.util.Region((i.maxHeight?h.bottom-i.maxHeight:f.y+(g.minHeight||d))-c,h.right,h.bottom-(i.minHeight||d),h.x)),j.intersect(k)},performResize:function(a,b){var c=this,d=c.getSplitter(),e=d.orientation,f=c.getPrevCmp(),g=c.getNextCmp(),h=d.ownerCt,i=h.query(">[flex]"),j=i.length,k=0,l,m,n=0;for(;k<j;k++)m=i[k].getWidth(),n+=m,i[k].flex=m;b=b||c.getOffset("dragTarget"),e==="vertical"?(b=b[0],l="width"):(l="height",b=b[1]),f&&(m=c.prevBox[l]+b,f.flex?f.flex=m:f[l]=m),g&&(m=c.nextBox[l]-b,g.flex?g.flex=m:g[l]=m),h.updateLayout()},endDrag:function(){var a=this;a.overlay&&(a.overlay.remove(),delete a.overlay),a.callParent(arguments)},onEnd:function(a){var b=this,c=b.getSplitter();c.removeCls(c.baseCls+"-active"),b.performResize(a,b.getOffset("dragTarget"))},onDrag:function(a){var b=this,c=b.getOffset("dragTarget"),d=b.getSplitter(),e=d.getEl(),f=d.orientation;f==="vertical"?e.setX(b.startRegion.left+c[0]):e.setY(b.startRegion.top+c[1])},getSplitter:function(){return this.splitter}}),Ext.define("Ext.slider.Thumb",{requires:["Ext.dd.DragTracker","Ext.util.Format"],topZIndex:1e4,constructor:function(a){var b=this;Ext.apply(b,a||{},{cls:Ext.baseCSSPrefix+"slider-thumb",constrain:!1}),b.callParent([a])},render:function(){var a=this;a.el=a.slider.innerEl.insertFirst(a.getElConfig()),a.onRender()},onRender:function(){this.disabled&&this.disable(),this.initEvents()},getElConfig:function(){var a=this,b=a.slider,c={};return c[b.vertical?"bottom":"left"]=b.calculateThumbPosition(b.normalizeValue(a.value))+"%",{style:c,id:this.id,cls:this.cls}},move:function(a,b){var c=this.el,d=this.slider.vertical?"bottom":"left",e,f;a+="%",b?(e={},e[d]=a,Ext.supports.GetPositionPercentage||(f={},f[d]=c.dom.style[d]),new Ext.fx.Anim({target:c,duration:350,from:f,to:e})):c.dom.style[d]=a},bringToFront:function(){this.el.setStyle("zIndex",this.topZIndex)},sendToBack:function(){this.el.setStyle("zIndex","")},enable:function(){var a=this;a.disabled=!1,a.el&&a.el.removeCls(a.slider.disabledCls)},disable:function(){var a=this;a.disabled=!0,a.el&&a.el.addCls(a.slider.disabledCls)},initEvents:function(){var a=this,b=a.el;a.tracker=new Ext.dd.DragTracker({onBeforeStart:Ext.Function.bind(a.onBeforeDragStart,a),onStart:Ext.Function.bind(a.onDragStart,a),onDrag:Ext.Function.bind(a.onDrag,a),onEnd:Ext.Function.bind(a.onDragEnd,a),tolerance:3,autoStart:300,overCls:Ext.baseCSSPrefix+"slider-thumb-over"}),a.tracker.initEl(b)},onBeforeDragStart:function(a){return this.disabled?!1:(this.slider.promoteThumb(this),!0)},onDragStart:function(a){var b=this;b.el.addCls(Ext.baseCSSPrefix+"slider-thumb-drag"),b.dragging=b.slider.dragging=!0,b.dragStartValue=b.value,b.slider.fireEvent("dragstart",b.slider,a,b)},onDrag:function(a){var b=this,c=b.slider,d=b.index,e=b.getValueFromTracker(),f,g;e!==undefined&&(b.constrain&&(f=c.thumbs[d+1],g=c.thumbs[d-1],g!==undefined&&e<=g.value&&(e=g.value),f!==undefined&&e>=f.value&&(e=f.value)),c.setValue(d,e,!1),c.fireEvent("drag",c,a,b))},getValueFromTracker:function(){var a=this.slider,b=a.getTrackpoint(this.tracker.getXY());if(b!==undefined)return a.reversePixelValue(b)},onDragEnd:function(a){var b=this,c=b.slider,d=b.value;b.el.removeCls(Ext.baseCSSPrefix+"slider-thumb-drag"),b.dragging=c.dragging=!1,c.fireEvent("dragend",c,a),b.dragStartValue!=d&&c.fireEvent("changecomplete",c,d,b)},destroy:function(){Ext.destroy(this.tracker)}}),Ext.define("Ext.tree.plugin.TreeViewDragDrop",{extend:"Ext.AbstractPlugin",alias:"plugin.treeviewdragdrop",uses:["Ext.tree.ViewDragZone","Ext.tree.ViewDropZone"],dragText:"{0} selected node{1}",allowParentInserts:!1,allowContainerDrops:!1,appendOnly:!1,ddGroup:"TreeDD",expandDelay:1e3,enableDrop:!0,enableDrag:!0,nodeHighlightColor:"c3daf9",nodeHighlightOnDrop:Ext.enableFx,nodeHighlightOnRepair:Ext.enableFx,init:function(a){a.on("render",this.onViewRender,this,{single:!0})},destroy:function(){Ext.destroy(this.dragZone,this.dropZone)},onViewRender:function(a){var b=this;b.enableDrag&&(b.dragZone=new Ext.tree.ViewDragZone({view:a,ddGroup:b.dragGroup||b.ddGroup,dragText:b.dragText,repairHighlightColor:b.nodeHighlightColor,repairHighlight:b.nodeHighlightOnRepair})),b.enableDrop&&(b.dropZone=new Ext.tree.ViewDropZone({view:a,ddGroup:b.dropGroup||b.ddGroup,allowContainerDrops:b.allowContainerDrops,appendOnly:b.appendOnly,allowParentInserts:b.allowParentInserts,expandDelay:b.expandDelay,dropHighlightColor:b.nodeHighlightColor,dropHighlight:b.nodeHighlightOnDrop}))}}),Ext.define("Ext.util.Animate",{uses:["Ext.fx.Manager","Ext.fx.Anim"],animate:function(a){var b=this;return Ext.fx.Manager.hasFxBlock(b.id)?b:(Ext.fx.Manager.queueFx(new Ext.fx.Anim(b.anim(a))),this)},anim:function(a){if(!Ext.isObject(a))return a?{}:!1;var b=this;return a.stopAnimation&&b.stopAnimation(),Ext.applyIf(a,Ext.fx.Manager.getFxDefaults(b.id)),Ext.apply({target:b,paused:!0},a)},stopFx:Ext.Function.alias(Ext.util.Animate,"stopAnimation"),stopAnimation:function(){return Ext.fx.Manager.stopAnimation(this.id),this},syncFx:function(){return Ext.fx.Manager.setFxDefaults(this.id,{concurrent:!0}),this},sequenceFx:function(){return Ext.fx.Manager.setFxDefaults(this.id,{concurrent:!1}),this},hasActiveFx:Ext.Function.alias(Ext.util.Animate,"getActiveAnimation"),getActiveAnimation:function(){return Ext.fx.Manager.getActiveAnimation(this.id)}},function(){Ext.applyIf(Ext.Element.prototype,this.prototype),Ext.CompositeElementLite.importElementMethods()}),Ext.define("Ext.util.ClickRepeater",{extend:"Ext.util.Observable",constructor:function(a,b){var c=this;c.el=Ext.get(a),c.el.unselectable(),Ext.apply(c,b),c.callParent(),c.addEvents("mousedown","click","mouseup"),c.disabled||(c.disabled=!0,c.enable()),c.handler&&c.on("click",c.handler,c.scope||c)},interval:20,delay:250,preventDefault:!0,stopDefault:!1,timer:0,enable:function(){this.disabled&&(this.el.on("mousedown",this.handleMouseDown,this),Ext.isIE&&this.el.on("dblclick",this.handleDblClick,this),(this.preventDefault||this.stopDefault)&&this.el.on("click",this.eventOptions,this)),this.disabled=!1},disable:function(a){if(a||!this.disabled)clearTimeout(this.timer),this.pressedCls&&this.el.removeCls(this.pressedCls),Ext.getDoc().un("mouseup",this.handleMouseUp,this),this.el.removeAllListeners();this.disabled=!0},setDisabled:function(a){this[a?"disable":"enable"]()},eventOptions:function(a){this.preventDefault&&a.preventDefault(),this.stopDefault&&a.stopEvent()},destroy:function(){this.disable(!0),Ext.destroy(this.el),this.clearListeners()},handleDblClick:function(a){clearTimeout(this.timer),this.el.blur(),this.fireEvent("mousedown",this,a),this.fireEvent("click",this,a)},handleMouseDown:function(a){clearTimeout(this.timer),this.el.blur(),this.pressedCls&&this.el.addCls(this.pressedCls),this.mousedownTime=new Date,Ext.getDoc().on("mouseup",this.handleMouseUp,this),this.el.on("mouseout",this.handleMouseOut,this),this.fireEvent("mousedown",this,a),this.fireEvent("click",this,a),this.accelerate&&(this.delay=400),a=new Ext.EventObjectImpl(a),this.timer=Ext.defer(this.click,this.delay||this.interval,this,[a])},click:function(a){this.fireEvent("click",this,a),this.timer=Ext.defer(this.click,this.accelerate?this.easeOutExpo(Ext.Date.getElapsed(this.mousedownTime),400,-390,12e3):this.interval,this,[a])},easeOutExpo:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},handleMouseOut:function(){clearTimeout(this.timer),this.pressedCls&&this.el.removeCls(this.pressedCls),this.el.on("mouseover",this.handleMouseReturn,this)},handleMouseReturn:function(){this.el.un("mouseover",this.handleMouseReturn,this),this.pressedCls&&this.el.addCls(this.pressedCls),this.click()},handleMouseUp:function(a){clearTimeout(this.timer),this.el.un("mouseover",this.handleMouseReturn,this),this.el.un("mouseout",this.handleMouseOut,this),Ext.getDoc().un("mouseup",this.handleMouseUp,this),this.pressedCls&&this.el.removeCls(this.pressedCls),this.fireEvent("mouseup",this,a)}}),Ext.define("Ext.util.ComponentDragger",{extend:"Ext.dd.DragTracker",autoStart:500,constructor:function(a,b){this.comp=a,this.initialConstrainTo=b.constrainTo,this.callParent([b])},onStart:function(a){var b=this,c=b.comp;this.startPosition=c.el.getXY(),c.ghost&&!c.liveDrag&&(b.proxy=c.ghost(),b.dragTarget=b.proxy.header.el);if(b.constrain||b.constrainDelegate)b.constrainTo=b.calculateConstrainRegion();c.beginDrag&&c.beginDrag()},calculateConstrainRegion:function(){var a=this,b=a.comp,c=a.initialConstrainTo,d,e,f=b.el.shadow?b.el.shadow.offset:0;return c instanceof Ext.util.Region||(c=Ext.fly(c).getViewRegion()),f&&c.adjust(0,-f,-f,f),a.constrainDelegate||(d=Ext.fly(a.dragTarget).getRegion(),e=a.proxy?a.proxy.el.getRegion():b.el.getRegion(),c.adjust(d.top-e.top,d.right-e.right,d.bottom-e.bottom,d.left-e.left)),c},onDrag:function(a){var b=this,c=b.proxy&&!b.comp.liveDrag?b.proxy:b.comp,d=b.getOffset(b.constrain||b.constrainDelegate?"dragTarget":null);c.setPagePosition(b.startPosition[0]+d[0],b.startPosition[1]+d[1])},onEnd:function(a){var b=this.comp;this.proxy&&!b.liveDrag&&b.unghost(),b.endDrag&&b.endDrag()}}),Ext.define("Ext.util.Cookies",{singleton:!0,set:function(a,b){var c=arguments,d=arguments.length,e=d>2?c[2]:null,f=d>3?c[3]:"/",g=d>4?c[4]:null,h=d>5?c[5]:!1;document.cookie=a+"="+escape(b)+(e===null?"":"; expires="+e.toGMTString())+(f===null?"":"; path="+f)+(g===null?"":"; domain="+g)+(h===!0?"; secure":"")},get:function(a){var b=a+"=",c=b.length,d=document.cookie.length,e=0,f=0;while(e<d){f=e+c;if(document.cookie.substring(e,f)==b)return this.getCookieVal(f);e=document.cookie.indexOf(" ",e)+1;if(e===0)break}return null},clear:function(a,b){this.get(a)&&(b=b||"/",document.cookie=a+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path="+b)},getCookieVal:function(a){var b=document.cookie.indexOf(";",a);return b==-1&&(b=document.cookie.length),unescape(document.cookie.substring(a,b))}}),Ext.define("Ext.util.CSS",function(){var a=null,b=document,c=/(-[a-z])/gi,d=function(a,b){return b.charAt(1).toUpperCase()};return{singleton:!0,constructor:function(){this.rules={},this.initialized=!1},createStyleSheet:function(a,c){var d,e=b.getElementsByTagName("head")[0],f=b.createElement("style");f.setAttribute("type","text/css"),c&&f.setAttribute("id",c);if(Ext.isIE)e.appendChild(f),d=f.styleSheet,d.cssText=a;else{try{f.appendChild(b.createTextNode(a))}catch(g){f.cssText=a}e.appendChild(f),d=f.styleSheet?f.styleSheet:f.sheet||b.styleSheets[b.styleSheets.length-1]}return this.cacheStyleSheet(d),d},removeStyleSheet:function(a){var b=document.getElementById(a);b&&b.parentNode.removeChild(b)},swapStyleSheet:function(a,b){var c=document,d;this.removeStyleSheet(a),d=c.createElement("link"),d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("id",a),d.setAttribute("href",b),c.getElementsByTagName("head")[0].appendChild(d)},refreshCache:function(){return this.getRules(!0)},cacheStyleSheet:function(b){a||(a={});try{var c=b.cssRules||b.rules,d,e=c.length-1,f,g;for(;e>=0;--e){d=c[e].selectorText;if(d){d=d.split(","),g=d.length;for(f=0;f<g;f++)a[Ext.String.trim(d[f]).toLowerCase()]=c[e]}}}catch(h){}},getRules:function(c){if(a===null||c){a={};var d=b.styleSheets,e=0,f=d.length;for(;e<f;e++)try{d[e].disabled||this.cacheStyleSheet(d[e])}catch(g){}}return a},getRule:function(a,b){var c=this.getRules(b),d;if(!Ext.isArray(a))return c[a.toLowerCase()];for(d=0;d<a.length;d++)if(c[a[d]])return c[a[d].toLowerCase()];return null},updateRule:function(a,b,e){var f,g;if(!Ext.isArray(a)){f=this.getRule(a);if(f)return f.style[b.replace(c,d)]=e,!0}else for(g=0;g<a.length;g++)if(this.updateRule(a[g],b,e))return!0;return!1}}}()),Ext.define("Ext.util.Floating",{uses:["Ext.Layer","Ext.window.Window"],focusOnToFront:!0,shadow:"sides",constructor:function(a){var b=this;b.el=new Ext.Layer(Ext.apply({hideMode:b.hideMode,hidden:b.hidden,shadow:typeof b.shadow!="undefined"?b.shadow:"sides",shadowOffset:b.shadowOffset,constrain:!1,shim:b.shim===!1?!1:undefined},b.floating),a),b.floating=!0,b.registerWithOwnerCt()},registerWithOwnerCt:function(){var a=this;a.zIndexParent&&a.zIndexParent.unregisterFloatingItem(a),a.zIndexParent=a.up("[floating]"),a.setFloatParent(a.ownerCt),delete a.ownerCt,a.zIndexParent?a.zIndexParent.registerFloatingItem(a):Ext.WindowManager.register(a)},setFloatParent:function(a){var b=this;b.floatParent&&b.mun(b.floatParent,{hide:b.onFloatParentHide,show:b.onFloatParentShow,scope:b}),b.floatParent=a,a&&b.mon(b.floatParent,{hide:b.onFloatParentHide,show:b.onFloatParentShow,scope:b}),(b.constrain||b.constrainHeader)&&!b.constrainTo&&(b.constrainTo=a?a.getTargetEl():b.container)},onAfterFloatLayout:function(){this.syncShadow()},onFloatParentHide:function(){var a=this;a.hideOnParentHide!==!1&&a.isVisible()&&(a.hide(),a.showOnParentShow=!0)},onFloatParentShow:function(){this.showOnParentShow&&(delete this.showOnParentShow,this.show())},setZIndex:function(a){var b=this;return b.el.setZIndex(a),a+=10,b.floatingItems&&(a=Math.floor(b.floatingItems.setBase(a)/100)*100+1e4),a},doConstrain:function(a){var b=this,c=b.getConstrainVector(a),d;c&&(d=b.getPosition(),d[0]+=c[0],d[1]+=c[1],b.setPosition(d))},getConstrainVector:function(a){var b=this;if(b.constrain||b.constrainHeader)return a=a||b.floatParent&&b.floatParent.getTargetEl()||b.container||b.el.getScopeParent(),(b.constrainHeader?b.header.el:b.el).getConstrainVector(a)},alignTo:function(a,b,c){return this.setPagePosition(this.el.getAlignToXY(a.el||a,b,c)),this},toFront:function(a){var b=this;return b.zIndexParent&&b.bringParentToFront!==!1&&b.zIndexParent.toFront(!0),Ext.isDefined(a)||(a=!b.focusOnToFront),a&&(b.preventFocusOnActivate=!0),b.zIndexManager.bringToFront(b)&&(a||b.focus(!1,!0)),delete b.preventFocusOnActivate,b},setActive:function(a,b){var c=this;a?(c.el.shadow&&!c.maximized&&c.el.enableShadow(!0),c.modal&&!c.preventFocusOnActivate&&c.focus(!1,!0),c.fireEvent("activate",c)):(c.isWindow&&b&&b.isWindow&&c.el.disableShadow(),c.fireEvent("deactivate",c))},toBack:function(){return this.zIndexManager.sendToBack(this),this},center:function(){var a=this,b;return a.isVisible()?(b=a.el.getAlignToXY(a.container,"c-c"),a.setPagePosition(b)):a.needsCenter=!0,a},onFloatShow:function(){this.needsCenter&&this.center(),delete this.needsCenter},syncShadow:function(){this.floating&&this.el.sync(!0)},fitContainer:function(){var a=this.floatParent,b=a?a.getTargetEl():this.container,c=b.getViewSize(!1);this.setSize(c)}}),Ext.define("Ext.util.History",{singleton:!0,alternateClassName:"Ext.History",mixins:{observable:"Ext.util.Observable"},useTopWindow:!0,fieldId:Ext.baseCSSPrefix+"history-field",iframeId:Ext.baseCSSPrefix+"history-frame",constructor:function(){var a=this;a.oldIEMode=Ext.isIE6||Ext.isIE7||!Ext.isStrict&&Ext.isIE8,a.iframe=null,a.hiddenField=null,a.ready=!1,a.currentToken=null,a.mixins.observable.constructor.call(a)},getHash:function(){var a=window.location.href,b=a.indexOf("#");return b>=0?a.substr(b+1):null},setHash:function(a){var b=this,c=b.useTopWindow?window.top:window;try{c.location.hash=a}catch(d){}},doSave:function(){this.hiddenField.value=this.currentToken},handleStateChange:function(a){this.currentToken=a,this.fireEvent("change",a)},updateIFrame:function(a){var b='<html><body><div id="state">'+Ext.util.Format.htmlEncode(a)+"</div></body></html>",c;try{return c=this.iframe.contentWindow.document,c.open(),c.write(b),c.close(),!0}catch(d){return!1}},checkIFrame:function(){var a=this,b=a.iframe.contentWindow,c,d,e,f;if(!b||!b.document){Ext.Function.defer(this.checkIFrame,10,this);return}c=b.document,d=c.getElementById("state"),e=d?d.innerText:null,f=a.getHash(),Ext.TaskManager.start({run:function(){var c=b.document,d=c.getElementById("state"),h=d?d.innerText:null,i=a.getHash();h!==e?(e=h,a.handleStateChange(h),a.setHash(h),f=h,a.doSave()):i!==f&&(f=i,a.updateIFrame(i))},interval:50,scope:a}),a.ready=!0,a.fireEvent("ready",a)},startUp:function(){var a=this,b;a.currentToken=a.hiddenField.value||this.getHash(),a.oldIEMode?a.checkIFrame():(b=a.getHash(),Ext.TaskManager.start({run:function(){var c=a.getHash();c!==b&&(b=c,a.handleStateChange(b),a.doSave())},interval:50,scope:a}),a.ready=!0,a.fireEvent("ready",a))},init:function(a,b){var c=this,d=Ext.DomHelper;if(c.ready){Ext.callback(a,b,[c]);return}if(!Ext.isReady){Ext.onReady(function(){c.init(a,b)});return}c.hiddenField=Ext.getDom(c.fieldId),c.hiddenField||(c.hiddenField=Ext.getBody().createChild({id:Ext.id(),tag:"form",cls:Ext.baseCSSPrefix+"hide-display",children:[{tag:"input",type:"hidden",id:c.fieldId}]},!1,!0).firstChild),c.oldIEMode&&(c.iframe=Ext.getDom(c.iframeId),c.iframe||(c.iframe=d.append(c.hiddenField.parentNode,{tag:"iframe",id:c.iframeId}))),c.addEvents("ready","change"),a&&c.on("ready",a,b,{single:!0}),c.startUp()},add:function(a,b){var c=this;return b!==!1&&c.getToken()===a?!0:c.oldIEMode?c.updateIFrame(a):(c.setHash(a),!0)},back:function(){window.history.go(-1)},forward:function(){window.history.go(1)},getToken:function(){return this.ready?this.currentToken:this.getHash()}}),Ext.define("Ext.util.KeyMap",{alternateClassName:"Ext.KeyMap",eventName:"keydown",constructor:function(a){var b=this;if(arguments.length!==1||typeof a=="string"||a.dom||a.tagName||a===document||a.isComponent){b.legacyConstructor.apply(b,arguments);return}Ext.apply(b,a),b.bindings=[],b.target.isComponent||(b.target=Ext.get(b.target)),b.binding?b.addBinding(b.binding):a.key&&b.addBinding(a),b.enable()},legacyConstructor:function(a,b,c){var d=this;Ext.apply(d,{target:Ext.get(a),eventName:c||d.eventName,bindings:[]}),b&&d.addBinding(b),d.enable()},addBinding:function(a){var b=a.key,c=!1,d,e,f,g,h;if(Ext.isArray(a)){for(g=0,h=a.length;g<h;g++)this.addBinding(a[g]);return}if(Ext.isString(b)){e=[],f=b.toUpperCase();for(g=0,h=f.length;g<h;++g)e.push(f.charCodeAt(g));b=e,c=!0}Ext.isArray(b)||(b=[b]);if(!c)for(g=0,h=b.length;g<h;++g)d=b[g],Ext.isString(d)&&(b[g]=d.toUpperCase().charCodeAt(0));this.bindings.push(Ext.apply({keyCode:b},a))},handleKeyDown:function(a){var b=this,c,d,e;if(this.enabled){c=this.bindings,d=0,e=c.length,a=b.processEvent.apply(b||b.processEventScope,arguments);if(!a.getKey)return a;for(;d<e;++d)this.processBinding(c[d],a)}},processEvent:function(a){return a},processBinding:function(a,b){if(this.checkModifiers(a,b)){var c=b.getKey(),d=a.fn||a.handler,e=a.scope||this,f=a.keyCode,g=a.defaultEventAction,h,i,j=new Ext.EventObjectImpl(b);for(h=0,i=f.length;h<i;++h)if(c===f[h]){d.call(e,c,b)!==!0&&g&&j[g]();break}}},checkModifiers:function(a,b){var c=["shift","ctrl","alt"],d=0,e=c.length,f,g;for(;d<e;++d){g=c[d],f=a[g];if(f!==undefined&&f!==b[g+"Key"])return!1}return!0},on:function(a,b,c){var d,e,f,g;Ext.isObject(a)&&!Ext.isArray(a)?(d=a.key,e=a.shift,f=a.ctrl,g=a.alt):d=a,this.addBinding({key:d,shift:e,ctrl:f,alt:g,fn:b,scope:c})},isEnabled:function(){return this.enabled},enable:function(){var a=this;a.enabled||(a.target.on(a.eventName,a.handleKeyDown,a),a.enabled=!0)},disable:function(){var a=this;a.enabled&&(a.target.removeListener(a.eventName,a.handleKeyDown,a),a.enabled=!1)},setDisabled:function(a){a?this.disable():this.enable()},destroy:function(a){var b=this;b.bindings=[],b.disable(),a===!0&&(b.target.isComponent?b.target.destroy():b.target.remove()),delete b.target}}),Ext.define("Ext.util.KeyNav",{alternateClassName:"Ext.KeyNav",requires:["Ext.util.KeyMap"],statics:{keyOptions:{left:37,right:39,up:38,down:40,space:32,pageUp:33,pageDown:34,del:46,backspace:8,home:36,end:35,enter:13,esc:27,tab:9}},constructor:function(a){var b=this;if(arguments.length===2){b.legacyConstructor.apply(b,arguments);return}b.setConfig(a)},legacyConstructor:function(a,b){this.setConfig(Ext.apply({target:a},b))},setConfig:function(a){var b=this,c={target:a.target,eventName:b.getKeyEvent("forceKeyDown"in a?a.forceKeyDown:b.forceKeyDown,a.eventName)},d,e,f,g,h;b.map&&b.map.destroy(),a.processEvent&&(c.processEvent=a.processEvent,c.processEventScope=a.processEventScope||b),d=b.map=new Ext.util.KeyMap(c),e=Ext.util.KeyNav.keyOptions,f=a.scope||b;for(g in e)e.hasOwnProperty(g)&&(h=a[g])&&(typeof h=="function"&&(h={handler:h,defaultAction:a.defaultEventAction!==undefined?a.defaultEventAction:b.defaultEventAction}),d.addBinding({key:e[g],handler:Ext.Function.bind(b.handleEvent,h.scope||f,h.handler||h.fn,!0),defaultEventAction:h.defaultEventAction!==undefined?h.defaultAction:b.defaultEventAction}));d.disable(),a.disabled||d.enable()},handleEvent:function(a,b,c){return c.call(this,b)},disabled:!1,defaultEventAction:"stopEvent",forceKeyDown:!1,eventName:"keypress",destroy:function(a){this.map.destroy(a),delete this.map},enable:function(){this.map.enable(),this.disabled=!1},disable:function(){this.map.disable(),this.disabled=!0},setDisabled:function(a){this.map.setDisabled(a),this.disabled=a},getKeyEvent:function(a,b){return a||Ext.EventManager.useKeyDown&&!b?"keydown":b||this.eventName}}),Ext.define("Ext.util.TextMetrics",{statics:{shared:null,measure:function(a,b,c){var d=this,e=d.shared;return e||(e=d.shared=new d(a,c)),e.bind(a),e.setFixedWidth(c||"auto"),e.getSize(b)},destroy:function(){var a=this;Ext.destroy(a.shared),a.shared=null}},constructor:function(a,b){var c=this.measure=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"textmetrics"});this.el=Ext.get(a),c.position("absolute"),c.setLeftTop(-1e3,-1e3),c.hide(),b&&c.setWidth(b)},getSize:function(a){var b=this.measure,c;return b.update(a),c=b.getSize(),b.update(""),c},bind:function(a){var b=this;b.el=Ext.get(a),b.measure.setStyle(b.el.getStyles("font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"))},setFixedWidth:function(a){this.measure.setWidth(a)},getWidth:function(a){return this.measure.dom.style.width="auto",this.getSize(a).width},getHeight:function(a){return this.getSize(a).height},destroy:function(){var a=this;a.measure.remove(),delete a.el,delete a.measure}},function(){Ext.Element.addMethods({getTextWidth:function(a,b,c){return Ext.Number.constrain(Ext.util.TextMetrics.measure(this.dom,Ext.value(a,this.dom.innerHTML,!0)).width,b||0,c||1e6)}})}),Ext.define("Ext.ElementLoader",{mixins:{observable:"Ext.util.Observable"},uses:["Ext.data.Connection","Ext.Ajax"],statics:{Renderer:{Html:function(a,b,c){return a.getTarget().update(b.responseText,c.scripts===!0),!0}}},url:null,params:null,baseParams:null,autoLoad:!1,target:null,loadMask:!1,ajaxOptions:null,scripts:!1,isLoader:!0,constructor:function(a){var b=this,c;a=a||{},Ext.apply(b,a),b.setTarget(b.target),b.addEvents("beforeload","exception","load"),b.mixins.observable.constructor.call(b),b.autoLoad&&(c=b.autoLoad,c===!0&&(c={}),b.load(c))},setTarget:function(a){var b=this;a=Ext.get(a),b.target&&b.target!=a&&b.abort(),b.target=a},getTarget:function(){return this.target||null},abort:function(){var a=this.active;a!==undefined&&(Ext.Ajax.abort(a.request),a.mask&&this.removeMask(),delete this.active)},removeMask:function(){this.target.unmask()},addMask:function(a){this.target.mask(a===!0?null:a)},load:function(a){a=Ext.apply({},a);var b=this,c=b.target,d=Ext.isDefined(a.loadMask)?a.loadMask:b.loadMask,e=Ext.apply({},a.params),f=Ext.apply({},a.ajaxOptions),g=a.callback||b.callback,h=a.scope||b.scope||b,i;Ext.applyIf(f,b.ajaxOptions),Ext.applyIf(a,f),Ext.applyIf(e,b.params),Ext.apply(e,b.baseParams),Ext.applyIf(a,{url:b.url}),Ext.apply(a,{scope:b,params:e,callback:b.onComplete});if(b.fireEvent("beforeload",b,a)===!1)return;d&&b.addMask(d),i=Ext.Ajax.request(a),b.active={request:i,options:a,mask:d,scope:h,callback:g,success:a.success||b.success,failure:a.failure||b.failure,renderer:a.renderer||b.renderer,scripts:Ext.isDefined(a.scripts)?a.scripts:b.scripts},b.setOptions(b.active,a)},setOptions:Ext.emptyFn,onComplete:function(a,b,c){var d=this,e=d.active,f=e.scope,g=d.getRenderer(e.renderer);b&&(b=g.call(d,d,c,e)!==!1),b?(Ext.callback(e.success,f,[d,c,a]),d.fireEvent("load",d,c,a)):(Ext.callback(e.failure,f,[d,c,a]),d.fireEvent("exception",d,c,a)),Ext.callback(e.callback,f,[d,b,c,a]),e.mask&&d.removeMask(),delete d.active},getRenderer:function(a){return Ext.isFunction(a)?a:this.statics().Renderer.Html},startAutoRefresh:function(a,b){var c=this;c.stopAutoRefresh(),c.autoRefresh=setInterval(function(){c.load(b)},a)},stopAutoRefresh:function(){clearInterval(this.autoRefresh),delete this.autoRefresh},isAutoRefreshing:function(){return Ext.isDefined(this.autoRefresh)},destroy:function(){var a=this;a.stopAutoRefresh(),delete a.target,a.abort(),a.clearListeners()}}),Ext.define("Ext.ComponentLoader",{extend:"Ext.ElementLoader",statics:{Renderer:{Data:function(a,b,c){var d=!0;try{a.getTarget().update(Ext.decode(b.responseText))}catch(e){d=!1}return d},Component:function(a,b,c){var d=!0,e=a.getTarget(),f=[];try{f=Ext.decode(b.responseText)}catch(g){d=!1}return d&&(e.suspendLayouts(),c.removeAll&&e.removeAll(),e.add(f),e.resumeLayouts(!0)),d}}},target:null,loadMask:!1,renderer:"html",setTarget:function(a){var b=this;Ext.isString(a)&&(a=Ext.getCmp(a)),b.target&&b.target!=a&&b.abort(),b.target=a},removeMask:function(){this.target.setLoading(!1)},addMask:function(a){this.target.setLoading(a)},setOptions:function(a,b){a.removeAll=Ext.isDefined(b.removeAll)?b.removeAll:this.removeAll},getRenderer:function(a){if(Ext.isFunction(a))return a;var b=this.statics().Renderer;switch(a){case"component":return b.Component;case"data":return b.Data;default:return Ext.ElementLoader.Renderer.Html}}}),Ext.define("Ext.XTemplateCompiler",{extend:"Ext.XTemplateParser",useEval:Ext.isGecko,useIndex:Ext.isIE6||Ext.isIE7,useFormat:!0,propNameRe:/^[\w\d\$]*$/,compile:function(a){var b=this,c=b.generate(a);return b.useEval?b.evalTpl(c):(new Function("Ext",c))(Ext)},generate:function(a){var b=this,c="var fm=Ext.util.Format,ts=Object.prototype.toString;",d;return b.maxLevel=0,b.body=["var c0=values, a0="+b.createArrayTest(0)+", p0=parent, n0=xcount, i0=xindex, v;\n"],b.definitions?typeof b.definitions=="string"?b.definitions=[b.definitions,c]:b.definitions.push(c):b.definitions=[c],b.switches=[],b.parse(a),b.definitions.push((b.useEval?"$=":"return")+" function ("+b.fnArgs+") {",b.body.join(""),"}"),d=b.definitions.join("\n"),b.definitions.length=b.body.length=b.switches.length=0,delete b.definitions,delete b.body,delete b.switches,d},doText:function(a){var b=this,c=b.body;a=a.replace(b.aposRe,"\\'").replace(b.newLineRe,"\\n"),b.useIndex?c.push("out[out.length]='",a,"'\n"):c.push("out.push('",a,"')\n")},doExpr:function(a){var b=this.body;b.push("if ((v="+a+")!==undefined) out"),this.useIndex?b.push("[out.length]=v+''\n"):b.push(".push(v+'')\n")},doTag:function(a){this.doExpr(this.parseTag(a))},doElse:function(){this.body.push("} else {\n")},doEval:function(a){this.body.push(a,"\n")},doIf:function(a,b){var c=this;a==="."?c.body.push("if (values) {\n"):c.propNameRe.test(a)?c.body.push("if (",c.parseTag(a),") {\n"):c.body.push("if (",c.addFn(a),c.callFn,") {\n"),b.exec&&c.doExec(b.exec)},doElseIf:function(a,b){var c=this;a==="."?c.body.push("else if (values) {\n"):c.propNameRe.test(a)?c.body.push("} else if (",c.parseTag(a),") {\n"):c.body.push("} else if (",c.addFn(a),c.callFn,") {\n"),b.exec&&c.doExec(b.exec)},doSwitch:function(a){var b=this;a==="."?b.body.push("switch (values) {\n"):b.propNameRe.test(a)?b.body.push("switch (",b.parseTag(a),") {\n"):b.body.push("switch (",b.addFn(a),b.callFn,") {\n"),b.switches.push(0)},doCase:function(a){var b=this,c=Ext.isArray(a)?a:[a],d=b.switches.length-1,e,f;b.switches[d]?b.body.push("break;\n"):b.switches[d]++;for(f=0,d=c.length;f<d;++f)e=b.intRe.exec(c[f]),c[f]=e?e[1]:"'"+c[f].replace(b.aposRe,"\\'")+"'";b.body.push("case ",c.join(": case "),":\n")},doDefault:function(){var a=this,b=a.switches.length-1;a.switches[b]?a.body.push("break;\n"):a.switches[b]++,a.body.push("default:\n")},doEnd:function(a,b){var c=this,d=c.level-1;a=="for"?(b.exec&&c.doExec(b.exec),c.body.push("}\n"),c.body.push("parent=p",d,";values=r",d+1,";xcount=n",d,";xindex=i",d,"\n")):(a=="if"||a=="switch")&&c.body.push("}\n")},doFor:function(a,b){var c=this,d,e=c.level,f=e-1,g="p"+e,h;a==="."?d="values":c.propNameRe.test(a)?d=c.parseTag(a):d=c.addFn(a)+c.callFn,c.maxLevel<e&&(c.maxLevel=e,c.body.push("var ")),a=="."?h="c"+e:h="a"+f+"?c"+f+"[i"+f+"]:p"+e,c.body.push("i",e,"=0,n",e,"=0,c",e,"=",d,",a",e,"=",c.createArrayTest(e),",p",e,"=c",f,",r",e,"=values;\n","parent=",h,"\n","if (c",e,"){if(a",e,"){n",e,"=c",e,".length;}else if (c",e,".isMixedCollection){c",e,"=c",e,".items;n",e,"=c",e,".length;}else if(c",e,".isStore){c",e,"=c",e,".data.items;n",e,"=c",e,".length;}else{c",e,"=[c",e,"];n",e,"=1;}}\n","for (xcount=n",e,";i",e,"<n"+e+";++i",e,"){\n","values=c",e,"[i",e,"]"),b.propName&&c.body.push(".",b.propName),c.body.push("\n","xindex=i",e,"+1\n")},createArrayTest:"isArray"in Array?function(a){return"Array.isArray(c"+a+")"}:function(a){return"ts.call(c"+a+')==="[object Array]"'},doExec:function(a,b){var c=this,d="f"+c.definitions.length;c.definitions.push("function "+d+"("+c.fnArgs+") {"," try { with(values) {","  "+a," }} catch(e) {","}","}"),c.body.push(d+c.callFn+"\n")},addFn:function(a){var b=this,c="f"+b.definitions.length;return a==="."?b.definitions.push("function "+c+"("+b.fnArgs+") {"," return values","}"):a===".."?b.definitions.push("function "+c+"("+b.fnArgs+") {"," return parent","}"):b.definitions.push("function "+c+"("+b.fnArgs+") {"," try { with(values) {","  return("+a+")"," }} catch(e) {","}","}"),c},parseTag:function(a){var b=this,c=b.tagRe.exec(a),d=c[1],e=c[2],f=c[3],g=c[4],h;return d=="."?(b.validTypes||(b.definitions.push("var validTypes={string:1,number:1,boolean:1};"),b.validTypes=!0),h='validTypes[typeof values] || ts.call(values) === "[object Date]" ? values : ""'):d=="#"?h="xindex":d.substr(0,7)=="parent."?h=d:isNaN(d)&&d.indexOf("-")==-1&&d.indexOf(".")!=-1?h="values."+d:h="values['"+d+"']",g&&(h="("+h+g+")"),!e||!b.useFormat?h:(f=f?","+f:"",e.substr(0,5)!="this."?e="fm."+e+"(":e+="(",e+h+f+")")},evalTpl:function($){return eval($),$},newLineRe:/\r\n|\r|\n/g,aposRe:/[']/g,intRe:/^\s*(\d+)\s*$/,tagRe:/([\w-\.\#]+)(?:\:([\w\.]*)(?:\((.*?)?\))?)?(\s?[\+\-\*\/]\s?[\d\.\+\-\*\/\(\)]+)?/},function(){var a=this.prototype;a.fnArgs="out,values,parent,xindex,xcount",a.callFn=".call(this,"+a.fnArgs+")"}),Ext.define("Ext.XTemplate",{extend:"Ext.Template",requires:"Ext.XTemplateCompiler",apply:function(a){return this.applyOut(a,[]).join("")},applyOut:function(a,b){var c=this,d;c.fn||(d=new Ext.XTemplateCompiler({useFormat:c.disableFormats!==!0,definitions:c.definitions}),c.fn=d.compile(c.html));try{c.fn.call(c,b,a,{},1,1)}catch(e){}return b},compile:function(){return this},statics:{getTpl:function(a,b){var c=a[b],d;if(c&&!c.isTemplate){c=Ext.ClassManager.dynInstantiate("Ext.XTemplate",c);if(a.hasOwnProperty(b))a[b]=c;else for(d=a.self.prototype;d;d=d.superclass)if(d.hasOwnProperty(b)){d[b]=c;break}}return c||null}}}),Ext.define("Ext.app.Controller",{mixins:{observable:"Ext.util.Observable"},onClassExtended:function(a,b,c){var d=Ext.getClassName(a),e=d.match(/^(.*)\.controller\./),f,g,h,i,j;e!==null&&(f=Ext.Loader.getPrefix(d)||e[1],g=c.onBeforeCreated,h=[],i=["model","view","store"],c.onBeforeCreated=function(a,b){var c,d,e,l,m,n,o;for(c=0,d=i.length;c<d;c++){e=i[c],j=f+"."+e+".",l=Ext.Array.from(b[e+"s"]);for(m=0,n=l.length;m<n;m++)o=l[m],o.indexOf(".")!==-1&&(Ext.ClassManager.isCreated(o)||Ext.Loader.isAClassNameWithAKnownPrefix(o))?h.push(o):h.push(j+o)}Ext.require(h,Ext.Function.pass(g,arguments,this))})},constructor:function(a){this.mixins.observable.constructor.call(this,a),Ext.apply(this,a||{}),this.createGetters("model",this.models),this.createGetters("store",this.stores),this.createGetters("view",this.views),this.refs&&this.ref(this.refs)},init:function(a){},onLaunch:function(a){},createGetters:function(a,b){a=Ext.String.capitalize(a);var c=0,d=b?b.length:0,e,f,g,h,i;for(;c<d;c++){e="get",f=b[c],g=f.split("."),i=g.length;for(h=0;h<i;h++)e+=Ext.String.capitalize(g[h]);e+=a,this[e]||(this[e]=Ext.Function.pass(this["get"+a],[f],this)),this[e](f)}},ref:function(a){a=Ext.Array.from(a);var b=this,c=0,d=a.length,e,f,g;for(;c<d;c++)e=a[c],f=e.ref,g="get"+Ext.String.capitalize(f),b[g]||(b[g]=Ext.Function.pass(b.getRef,[f,e],b)),b.references=b.references||[],b.references.push(f.toLowerCase())},addRef:function(a){return this.ref([a])},getRef:function(a,b,c){this.refCache=this.refCache||{},b=b||{},c=c||{},Ext.apply(b,c);if(b.forceCreate)return Ext.ComponentManager.create(b,"component");var d=this,e=d.refCache[a];return e||(d.refCache[a]=e=Ext.ComponentQuery.query(b.selector)[0],!e&&b.autoCreate&&(d.refCache[a]=e=Ext.ComponentManager.create(b,"component")),e&&e.on("beforedestroy",function(){d.refCache[a]=null})),e},hasRef:function(a){return this.references&&this.references.indexOf(a.toLowerCase())!==-1},control:function(a,b){this.application.control(a,b,this)},getController:function(a){return this.application.getController(a)},getStore:function(a){return this.application.getStore(a)},getModel:function(a){return this.application.getModel(a)},getView:function(a){return this.application.getView(a)}}),Ext.define("Ext.chart.Label",{requires:["Ext.draw.Color"],colorStringRe:/url\s*\(\s*#([^\/)]+)\s*\)/,constructor:function(a){var b=this;b.label=Ext.applyIf(b.label||{},{display:"none",color:"#000",field:"name",minMargin:50,font:"11px Helvetica, sans-serif",orientation:"horizontal",renderer:function(a){return a}}),b.label.display!=="none"&&(b.labelsGroup=b.chart.surface.getGroup(b.seriesId+"-labels"))},renderLabels:function(){var a=this,b=a.chart,c=b.gradients,d=a.items,e=b.animate,f=a.label,g=f.display,h=f.color,i=[].concat(f.field),j=a.labelsGroup,k=(j||0)&&j.length,l=a.chart.getChartStore(),m=l.getCount(),n=(d||0)&&d.length,o=n/m,p=(c||0)&&c.length,q=Ext.draw.Color,r=[],s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J;if(g=="none")return;if(n==0)while(k--)r.push(k);else{for(t=0,u=0,v=0;t<m;t++){w=0;for(x=0;x<o;x++){C=d[u],D=j.getAt(v),E=l.getAt(t);while(this.__excludes&&this.__excludes[w])w++;!C&&D&&(D.hide(!0),v++);if(C&&i[x]){D||(D=a.onCreateLabel(E,C,t,g,x,w)),a.onPlaceLabel(D,E,C,t,g,e,x,w),v++;if(f.contrast&&C.sprite){F=C.sprite,F._endStyle?J=F._endStyle.fill:F._to?J=F._to.fill:J=F.attr.fill,J=J||F.attr.fill,G=q.fromString(J);if(J&&!G){J=J.match(a.colorStringRe)[1];for(y=0;y<p;y++){s=c[y];if(s.id==J){B=0,z=0;for(A in s.stops)B++,z+=q.fromString(s.stops[A].color).getGrayscale();H=z/B/255;break}}}else H=G.getGrayscale()/255;D.isOutside&&(H=1),I=q.fromString(D.attr.color||D.attr.fill).getHSL(),I[2]=H>.5?.2:.8,D.setAttributes({fill:String(q.fromHSL.apply({},I))},!0)}}u++,w++}}k=j.length;while(k>v)r.push(v),v++}a.hideLabels(r)},hideLabels:function(a){var b=this.labelsGroup,c=!!a&&a.length;if(!b)return;if(c===!1){c=b.getCount();while(c--)b.getAt(c).hide(!0)}else while(c--)b.getAt(a[c]).hide(!0)}}),Ext.define("Ext.chart.theme.Theme",{requires:["Ext.draw.Color"],theme:"Base",themeAttrs:!1,initTheme:function(a){var b=this,c=Ext.chart.theme,d,e;if(a){a=a.split(":");for(d in c)if(d==a[0]){e=a[1]=="gradients",b.themeAttrs=new c[d]({useGradients:e}),e&&(b.gradients=b.themeAttrs.gradients),b.themeAttrs.background&&(b.background=b.themeAttrs.background);return}}}},function(){(function(){Ext.chart.theme=function(a,b){a=a||{};var c=0,d=+(new Date),e,f,g,h,i,j,k,l,m=[],n,o;a.baseColor&&(n=Ext.draw.Color.fromString(a.baseColor),o=n.getHSL()[2],o<.15?n=n.getLighter(.3):o<.3?n=n.getLighter(.15):o>.85?n=n.getDarker(.3):o>.7&&(n=n.getDarker(.15)),a.colors=[n.getDarker(.3).toString(),n.getDarker(.15).toString(),n.toString(),n.getLighter(.15).toString(),n.getLighter(.3).toString()],delete a.baseColor);if(a.colors){f=a.colors.slice(),i=b.markerThemes,h=b.seriesThemes,e=f.length,b.colors=f;for(;c<e;c++)g=f[c],k=i[c]||{},j=h[c]||{},k.fill=j.fill=k.stroke=j.stroke=g,i[c]=k,h[c]=j;b.markerThemes=i.slice(0,e),b.seriesThemes=h.slice(0,e)}for(l in b)l in a&&(Ext.isObject(a[l])&&Ext.isObject(b[l])?Ext.apply(b[l],a[l]):b[l]=a[l]);if(a.useGradients){f=b.colors||function(){var a=[];for(c=0,h=b.seriesThemes,e=h.length;c<e;c++)a.push(h[c].fill||h[c].stroke);return a}();for(c=0,e=f.length;c<e;c++)n=Ext.draw.Color.fromString(f[c]),n&&(g=n.getDarker(.1).toString(),n=n.toString(),l="theme-"+n.substr(1)+"-"+g.substr(1)+"-"+d,m.push({id:l,angle:45,stops:{0:{color:n.toString()},100:{color:g.toString()}}}),f[c]="url(#"+l+")");b.gradients=m,b.colors=f}Ext.apply(this,b)}})()}),Ext.define("Ext.chart.theme.Base",{requires:["Ext.chart.theme.Theme"],constructor:function(a){Ext.chart.theme.call(this,a,{background:!1,axis:{stroke:"#444","stroke-width":1},axisLabelTop:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:function(a){return a}},axisLabelRight:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:function(a){return a}},axisLabelBottom:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:function(a){return a}},axisLabelLeft:{fill:"#444",font:"12px Arial, Helvetica, sans-serif",spacing:2,padding:5,renderer:function(a){return a}},axisTitleTop:{font:"bold 18px Arial",fill:"#444"},axisTitleRight:{font:"bold 18px Arial",fill:"#444",rotate:{x:0,y:0,degrees:270}},axisTitleBottom:{font:"bold 18px Arial",fill:"#444"},axisTitleLeft:{font:"bold 18px Arial",fill:"#444",rotate:{x:0,y:0,degrees:270}},series:{"stroke-width":0},seriesLabel:{font:"12px Arial",fill:"#333"},marker:{stroke:"#555",radius:3,size:3},colors:["#94ae0a","#115fa6","#a61120","#ff8809","#ffd13e","#a61187","#24ad9a","#7c7474","#a66111"],seriesThemes:[{fill:"#115fa6"},{fill:"#94ae0a"},{fill:"#a61120"},{fill:"#ff8809"},{fill:"#ffd13e"},{fill:"#a61187"},{fill:"#24ad9a"},{fill:"#7c7474"},{fill:"#115fa6"},{fill:"#94ae0a"},{fill:"#a61120"},{fill:"#ff8809"},{fill:"#ffd13e"},{fill:"#a61187"},{fill:"#24ad9a"},{fill:"#7c7474"},{fill:"#a66111"}],markerThemes:[{fill:"#115fa6",type:"circle"},{fill:"#94ae0a",type:"cross"},{fill:"#115fa6",type:"plus"},{fill:"#94ae0a",type:"circle"},{fill:"#a61120",type:"cross"}]})}},function(){var a=["#b1da5a","#4ce0e7","#e84b67","#da5abd","#4d7fe6","#fec935"],b=["Green","Sky","Red","Purple","Blue","Yellow"],c=0,d=0,e=a.length,f=Ext.chart.theme,g=[["#f0a50a","#c20024","#2044ba","#810065","#7eae29"],["#6d9824","#87146e","#2a9196","#d39006","#1e40ac"],["#fbbc29","#ce2e4e","#7e0062","#158b90","#57880e"],["#ef5773","#fcbd2a","#4f770d","#1d3eaa","#9b001f"],["#7eae29","#fdbe2a","#910019","#27b4bc","#d74dbc"],["#44dce1","#0b2592","#996e05","#7fb325","#b821a1"]],h=g.length;for(;c<e;c++)f[b[c]]=function(a){return Ext.extend(f.Base,{constructor:function(b){f.Base.prototype.constructor.call(this,Ext.apply({baseColor:a},b))}})}(a[c]);for(c=0;c<h;c++)f["Category"+(c+1)]=function(a){return Ext.extend(f.Base,{constructor:function(b){f.Base.prototype.constructor.call(this,Ext.apply({colors:a},b))}})}(g[c])}),Ext.define("Ext.data.Batch",{mixins:{observable:"Ext.util.Observable"},autoStart:!1,pauseOnException:!1,current:-1,total:0,isRunning:!1,isComplete:!1,hasException:!1,constructor:function(a){var b=this;b.mixins.observable.constructor.call(b,a),b.operations=[],b.exceptions=[]},add:function(a){return this.total++,a.setBatch(this),this.operations.push(a),this},start:function(a){var b=this;return b.isRunning?b:(b.exceptions.length=0,b.hasException=!1,b.isRunning=!0,b.runOperation(Ext.isDefined(a)?a:b.current+1))},retry:function(){return this.start(this.current)},runNextOperation:function(){return this.runOperation(this.current+1)},pause:function(){return this.isRunning=!1,this},runOperation:function(a){var b=this,c=b.operations,d=c[a],e;return d===undefined?(b.isRunning=!1,b.isComplete=!0,b.fireEvent("complete",b,c[c.length-1])):(b.current=a,e=function(a){var c=a.hasException();c&&(b.hasException=!0,b.exceptions.push(a),b.fireEvent("exception",b,a)),c&&b.pauseOnException?b.pause():(a.setCompleted(),b.fireEvent("operationcomplete",b,a),b.runNextOperation())},d.setStarted(),b.proxy[d.action](d,e,b)),b}}),Ext.define("Ext.data.Connection",{mixins:{observable:"Ext.util.Observable"},statics:{requestId:0},url:null,async:!0,method:null,username:"",password:"",disableCaching:!0,withCredentials:!1,cors:!1,disableCachingParam:"_dc",timeout:3e4,useDefaultHeader:!0,defaultPostHeader:"application/x-www-form-urlencoded; charset=UTF-8",useDefaultXhrHeader:!0,defaultXhrHeader:"XMLHttpRequest",constructor:function(a){a=a||{},Ext.apply(this,a),this.requests={},this.mixins.observable.constructor.call(this)},request:function(a){a=a||{};var b=this,c=a.scope||window,d=a.username||b.username,e=a.password||b.password||"",f,g,h,i,j;return b.fireEvent("beforerequest",b,a)!==!1?(g=b.setOptions(a,c),b.isFormUpload(a)?(b.upload(a.form,g.url,g.data,a),null):((a.autoAbort||b.autoAbort)&&b.abort(),f=a.async!==!1?a.async||b.async:!1,j=b.openRequest(a,g,f,d,e),i=b.setupHeaders(j,a,g.data,g.params),h={id:++Ext.data.Connection.requestId,xhr:j,headers:i,options:a,async:f,timeout:setTimeout(function(){h.timedout=!0,b.abort(h)},a.timeout||b.timeout)},b.requests[h.id]=h,b.latestId=h.id,f&&(j.onreadystatechange=Ext.Function.bind(b.onStateChange,b,[h])),j.send(g.data),f?h:b.onComplete(h))):(Ext.callback(a.callback,a.scope,[a,undefined,undefined]),null)},upload:function(a,b,c,d){a=Ext.getDom(a),d=d||{};var e=Ext.id(),f=document.createElement("iframe"),g=[],h="multipart/form-data",i={target:a.target,method:a.method,encoding:a.encoding,enctype:a.enctype,action:a.action},j=function(b,c){k=document.createElement("input"),Ext.fly(k).set({type:"hidden",value:c,name:b}),a.appendChild(k),g.push(k)},k,l,m,n,o,p,q,r;Ext.fly(f).set({id:e,name:e,cls:Ext.baseCSSPrefix+"hide-display",src:Ext.SSL_SECURE_URL}),document.body.appendChild(f),document.frames&&(document.frames[e].name=e),Ext.fly(a).set({target:e,method:"POST",enctype:h,encoding:h,action:b||i.action});if(c){l=Ext.Object.fromQueryString(c)||{};for(n in l)if(l.hasOwnProperty(n)){m=l[n];if(Ext.isArray(m)){o=m.length;for(p=0;p<o;p++)j(n,m[p])}else j(n,m)}}Ext.fly(f).on("load",Ext.Function.bind(this.onUploadComplete,this,[f,d]),null,{single:!0}),a.submit(),Ext.fly(a).set(i),q=g.length;for(r=0;r<q;r++)Ext.removeNode(g[r])},onUploadComplete:function(a,b){var c=this,d={responseText:"",responseXML:null},e,f;try{e=a.contentWindow.document||a.contentDocument||window.frames[a.id].document,e&&(e.body&&(/textarea/i.test((f=e.body.firstChild||{}).tagName)?d.responseText=f.value:d.responseText=e.body.innerHTML),d.responseXML=e.XMLDocument||e)}catch(g){}c.fireEvent("requestcomplete",c,d,b),Ext.callback(b.success,b.scope,[d,b]),Ext.callback(b.callback,b.scope,[b,!0,d]),setTimeout(function(){Ext.removeNode(a)},100)},isFormUpload:function(a){var b=this.getForm(a);return b?a.isUpload||/multipart\/form-data/i.test(b.getAttribute("enctype")):!1},getForm:function(a){return Ext.getDom(a.form)||null},setOptions:function(a,b){var c=this,d=a.params||{},e=c.extraParams,f=a.urlParams,g=a.url||c.url,h=a.jsonData,i,j,k;return Ext.isFunction(d)&&(d=d.call(b,a)),Ext.isFunction(g)&&(g=g.call(b,a)),g=this.setupUrl(a,g),k=a.rawData||a.xmlData||h||null,h&&!Ext.isPrimitive(h)&&(k=Ext.encode(k)),Ext.isObject(d)&&(d=Ext.Object.toQueryString(d)),Ext.isObject(e)&&(e=Ext.Object.toQueryString(e)),d+=e?(d?"&":"")+e:"",f=Ext.isObject(f)?Ext.Object.toQueryString(f):f,d=this.setupParams(a,d),i=(a.method||c.method||(d||k?"POST":"GET")).toUpperCase(),this.setupMethod(a,i),j=a.disableCaching!==!1?a.disableCaching||c.disableCaching:!1,i==="GET"&&j&&(g=Ext.urlAppend(g,(a.disableCachingParam||c.disableCachingParam)+"="+(new Date).getTime())),(i=="GET"||k)&&d&&(g=Ext.urlAppend(g,d),d=null),f&&(g=Ext.urlAppend(g,f)),{url:g,method:i,data:k||d||null}},setupUrl:function(a,b){var c=this.getForm(a);return c&&(b=b||c.action),b},setupParams:function(a,b){var c=this.getForm(a),d;return c&&!this.isFormUpload(a)&&(d=Ext.Element.serializeForm(c),b=b?b+"&"+d:d),b},setupMethod:function(a,b){return this.isFormUpload(a)?"POST":b},setupHeaders:function(a,b,c,d){var e=this,f=Ext.apply({},b.headers||{},e.defaultHeaders||{}),g=e.defaultPostHeader,h=b.jsonData,i=b.xmlData,j,k;!f["Content-Type"]&&(c||d)&&(c&&(b.rawData?g="text/plain":i&&Ext.isDefined(i)?g="text/xml":h&&Ext.isDefined(h)&&(g="application/json")),f["Content-Type"]=g),e.useDefaultXhrHeader&&!f["X-Requested-With"]&&(f["X-Requested-With"]=e.defaultXhrHeader);try{for(j in f)f.hasOwnProperty(j)&&(k=f[j],a.setRequestHeader(j,k))}catch(l){e.fireEvent("exception",j,k)}return f},newRequest:function(a){var b;return(a.cors||this.cors)&&Ext.isIE&&Ext.ieVersion>=8?b=new XDomainRequest:b=this.getXhrInstance(),b},openRequest:function(a,b,c,d,e){var f=this.newRequest(a);d?f.open(b.method,b.url,c,d,e):f.open(b.method,b.url,c);if(a.withCredentials||this.withCredentials)f.withCredentials=!0;return f},getXhrInstance:function(){var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("MSXML2.XMLHTTP.3.0")},function(){return new ActiveXObject("MSXML2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=0,c=a.length,d;for(;b<c;++b)try{d=a[b],d();break}catch(e){}return d}(),isLoading:function(a){a||(a=this.getLatest());if(!a||!a.xhr)return!1;var b=a.xhr.readyState;return b!==0&&b!=4},abort:function(a){var b=this,c;a||(a=b.getLatest());if(a&&b.isLoading(a)){c=a.xhr;try{c.onreadystatechange=null}catch(d){c=Ext.emptyFn}c.abort(),b.clearTimeout(a),a.timedout||(a.aborted=!0),b.onComplete(a),b.cleanup(a)}},abortAll:function(){var a=this.requests,b;for(b in a)a.hasOwnProperty(b)&&this.abort(a[b])},getLatest:function(){var a=this.latestId,b;return a&&(b=this.requests[a]),b||null},onStateChange:function(a){a.xhr.readyState==4&&(this.clearTimeout(a),this.onComplete(a),this.cleanup(a))},clearTimeout:function(a){clearTimeout(a.timeout),delete a.timeout},cleanup:function(a){a.xhr=null,delete a.xhr},onComplete:function(a){var b=this,c=a.options,d,e,f;try{d=b.parseStatus(a.xhr.status)}catch(g){d={success:!1,isException:!1}}return e=d.success,e?(f=b.createResponse(a),b.fireEvent("requestcomplete",b,f,c),Ext.callback(c.success,c.scope,[f,c])):(d.isException||a.aborted||a.timedout?f=b.createException(a):f=b.createResponse(a),b.fireEvent("requestexception",b,f,c),Ext.callback(c.failure,c.scope,[f,c])),Ext.callback(c.callback,c.scope,[c,e,f]),delete b.requests[a.id],f},parseStatus:function(a){a=a==1223?204:a;var b=a>=200&&a<300||a==304,c=!1;if(!b)switch(a){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:c=!0}return{success:b,isException:c}},createResponse:function(a){var b=a.xhr,c={},d=b.getAllResponseHeaders().replace(/\r\n/g,"\n").split("\n"),e=d.length,f,g,h,i,j;while(e--)f=d[e],g=f.indexOf(":"),g>=0&&(h=f.substr(0,g).toLowerCase(),f.charAt(g+1)==" "&&++g,c[h]=f.substr(g+1));return a.xhr=null,delete a.xhr,j={request:a,requestId:a.id,status:b.status,statusText:b.statusText,getResponseHeader:function(a){return c[a.toLowerCase()]},getAllResponseHeaders:function(){return c},responseText:b.responseText,responseXML:b.responseXML},b=null,j},createException:function(a){return{request:a,requestId:a.id,status:a.aborted?-1:0,statusText:a.aborted?"transaction aborted":"communication failure",aborted:a.aborted,timedout:a.timedout}}}),Ext.define("Ext.Ajax",{extend:"Ext.data.Connection",singleton:!0,autoAbort:!1}),Ext.define("Ext.data.Field",{requires:["Ext.data.Types","Ext.data.SortTypes"],alias:"data.field",constructor:function(a){Ext.isString(a)&&(a={name:a}),Ext.apply(this,a);var b=Ext.data.Types,c=this.sortType;this.type?Ext.isString(this.type)&&(this.type=b[this.type.toUpperCase()]||b.AUTO):this.type=b.AUTO,Ext.isString(c)?this.sortType=Ext.data.SortTypes[c]:Ext.isEmpty(c)&&(this.sortType=this.type.sortType),a.hasOwnProperty("convert")?!this.convert&&!a.hasOwnProperty("defaultValue")&&(this.defaultValue=this.type.convert(this.defaultValue)):this.convert=this.type.convert},dateFormat:null,useNull:!1,defaultValue:"",mapping:null,sortType:null,sortDir:"ASC",allowBlank:!0,persist:!0}),Ext.define("Ext.data.NodeInterface",{requires:["Ext.data.Field"],statics:{decorate:function(a){var b,c;typeof a=="string"?a=Ext.ModelManager.getModel(a):a.isModel&&(a=Ext.ModelManager.getModel(a.modelName));if(a.prototype.isNode)return;b=a.prototype.idProperty,c=a.prototype.fields.get(b).type.type,a.override(this.getPrototypeBody()),this.applyFields(a,[{name:"parentId",type:c,defaultValue:null},{name:"index",type:"int",defaultValue:null,persist:!1},{name:"depth",type:"int",defaultValue:0,persist:!1},{name:"expanded",type:"bool",defaultValue:!1,persist:!1},{name:"expandable",type:"bool",defaultValue:!0,persist:!1},{name:"checked",type:"auto",defaultValue:null,persist:!1},{name:"leaf",type:"bool",defaultValue:!1},{name:"cls",type:"string",defaultValue:null,persist:!1},{name:"iconCls",type:"string",defaultValue:null,persist:!1},{name:"icon",type:"string",defaultValue:null,persist:!1},{name:"root",type:"boolean",defaultValue:!1,persist:!1},{name:"isLast",type:"boolean",defaultValue:!1,persist:!1},{name:"isFirst",type:"boolean",defaultValue:!1,persist:!1},{name:"allowDrop",type:"boolean",defaultValue:!0,persist:!1},{name:"allowDrag",type:"boolean",defaultValue:!0,persist:!1},{name:"loaded",type:"boolean",defaultValue:!1,persist:!1},{name:"loading",type:"boolean",defaultValue:!1,persist:!1},{name:"href",type:"string",defaultValue:null,persist:!1},{name:"hrefTarget",type:"string",defaultValue:null,persist:!1},{name:"qtip",type:"string",defaultValue:null,persist:!1},{name:"qtitle",type:"string",defaultValue:null,persist:!1},{name:"children",type:"auto",defaultValue:null,persist:!1}])},applyFields:function(a,b){var c=a.prototype,d=c.fields,e=d.keys,f=b.length,g,h;for(h=0;h<f;h++)g=b[h],Ext.Array.contains(e,g.name)||d.add(new Ext.data.Field(g))},getPrototypeBody:function(){return{isNode:!0,constructor:function(){var a=this;return this.callParent(arguments),Ext.applyIf(a,{firstChild:null,lastChild:null,parentNode:null,previousSibling:null,nextSibling:null,childNodes:[]}),a.enableBubble(["append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert","expand","collapse","beforeexpand","beforecollapse","sort"]),a},createNode:function(a){return Ext.isObject(a)&&!a.isModel&&(a=Ext.ModelManager.create(a,this.modelName)),a},isLeaf:function(){return this.get("leaf")===!0},setFirstChild:function(a){this.firstChild=a},setLastChild:function(a){this.lastChild=a},updateInfo:function(a){var b=this,c=b.isRoot(),d=b.parentNode,e=!d||c?!0:d.firstChild===b,f=!d||c?!0:d.lastChild===b,g=0,h=b,i=b.childNodes,j=i.length,k=0,l=b.phantom;while(h.parentNode)++g,h=h.parentNode;b.beginEdit(),b.set({isFirst:e,isLast:f,depth:g,index:d?d.indexOf(b):0,parentId:d?d.getId():null}),b.endEdit(!0),a&&(b.commit(),b.phantom=l);for(k=0;k<j;k++)i[k].updateInfo(a)},isLast:function(){return this.get("isLast")},isFirst:function(){return this.get("isFirst")},hasChildNodes:function(){return!this.isLeaf()&&this.childNodes.length>0},isExpandable:function(){var a=this;return a.get("expandable")?!(a.isLeaf()||a.isLoaded()&&!a.hasChildNodes()):!1},appendChild:function(a,b,c){var d=this,e,f,g,h,i;if(!Ext.isArray(a)){a=d.createNode(a);if(b===!0||!!d.hasListeners.beforeappend&&d.fireEvent("beforeappend",d,a)!==!1){g=d.childNodes.length,h=a.parentNode;if(h){if(b!==!0&&(!d.hasListeners.beforeremove||a.fireEvent("beforemove",a,h,d,g)===!1))return!1;h.removeChild(a,!1,!1,!0)}return g=d.childNodes.length,g===0&&d.setFirstChild(a),d.childNodes.push(a),a.parentNode=d,a.nextSibling=null,d.setLastChild(a),i=d.childNodes[g-1],i?(a.previousSibling=i,i.nextSibling=a,i.updateInfo(c)):a.previousSibling=null,a.updateInfo(c),d.isLoaded()?d.childNodes.length===1&&d.afterEdit([]):d.set("loaded",!0),!a.isLeaf()&&a.phantom&&a.set("loaded",!0),b!==!0&&(d.fireEvent("append",d,a,g),h&&a.fireEvent("move",a,h,d,g)),a}return!1}d.callStore("suspendAutoSync");for(e=0,f=a.length-1;e<f;e++)d.appendChild(a[e]);d.callStore("resumeAutoSync"),d.appendChild(a[f])},getBubbleTarget:function(){return this.parentNode},removeChild:function(a,b,c,d){var e=this,f=e.indexOf(a),g,h;if(f==-1||c!==!0&&(!e.hasListeners.beforeremove||e.fireEvent("beforeremove",e,a,!!d)===!1))return!1;Ext.Array.erase(e.childNodes,f,1),e.firstChild==a&&e.setFirstChild(a.nextSibling),e.lastChild==a&&e.setLastChild(a.previousSibling),a.previousSibling&&(a.previousSibling.nextSibling=a.nextSibling),a.nextSibling&&(a.nextSibling.previousSibling=a.previousSibling);for(g=f>0?f-1:0,h=e.childNodes.length;g<h;g++)e.childNodes[g].updateInfo();return e.childNodes.length||e.set("loaded",e.isLoaded()),c!==!0&&e.hasListeners.remove&&e.fireEvent("remove",e,a,!!d),b?a.destroy(!0):a.clear(),a},copy:function(a,b){var c=this,d=c.callOverridden(arguments),e=c.childNodes?c.childNodes.length:0,f;if(b)for(f=0;f<e;f++)d.appendChild(c.childNodes[f].copy(!0));return d},clear:function(a){var b=this;b.parentNode=b.previousSibling=b.nextSibling=null,a&&(b.firstChild=b.lastChild=null)},destroy:function(a){var b=this,c=b.destroyOptions,d=b.childNodes,e=d.length,f;if(a===!0){b.clear(!0);for(f=0;f<e;f++)d[f].destroy(!0);b.childNodes=null,delete b.destroyOptions,b.callOverridden([c])}else b.destroyOptions=a,b.remove(!0)},insertBefore:function(a,b,c){var d=this,e=d.indexOf(b),f=a.parentNode,g=e,h,i,j;if(!b)return d.appendChild(a);if(a==b)return!1;a=d.createNode(a);if(c===!0||!!d.hasListeners.beforeinsert&&d.fireEvent("beforeinsert",d,a,b)!==!1){f==d&&d.indexOf(a)<e&&g--;if(f){if(c!==!0&&(!d.hasListeners.beforeremove||a.fireEvent("beforemove",a,f,d,e,b)===!1))return!1;f.removeChild(a,!1,!1,!0)}g===0&&d.setFirstChild(a),Ext.Array.splice(d.childNodes,g,0,a),a.parentNode=d,a.nextSibling=b,b.previousSibling=a,i=d.childNodes[g-1],i?(a.previousSibling=i,i.nextSibling=a):a.previousSibling=null;for(j=g>0?g-1:0,h=d.childNodes.length;j<h;j++)d.childNodes[j].updateInfo();return d.isLoaded()?d.childNodes.length===1&&d.set("loaded",d.isLoaded()):d.set("loaded",!0),!a.isLeaf()&&a.phantom&&a.set("loaded",!0),c!==!0&&(d.hasListeners.insert&&d.fireEvent("insert",d,a,b),f&&d.hasListeners.move&&a.fireEvent("move",a,f,d,g,b)),a}return!1},insertChild:function(a,b){var c=this.childNodes[a];return c?this.insertBefore(b,c):this.appendChild(b)},remove:function(a,b){var c=this.parentNode;return c&&c.removeChild(this,a,b),this},removeAll:function(a,b){var c=this.childNodes,d;while(d=c[0])this.removeChild(d,a,b);return this},getChildAt:function(a){return this.childNodes[a]},replaceChild:function(a,b,c){var d=b?b.nextSibling:null;return this.removeChild(b,!1,c),this.insertBefore(a,d,c),b},indexOf:function(a){return Ext.Array.indexOf(this.childNodes,a)},indexOfId:function(a){var b=this.childNodes,c=b.length,d=0;for(;d<c;++d)if(b[d].getId()===a)return d;return-1},getPath:function(a,b){a=a||this.idProperty,b=b||"/";var c=[this.get(a)],d=this.parentNode;while(d)c.unshift(d.get(a)),d=d.parentNode;return b+c.join(b)},getDepth:function(){return this.get("depth")},bubble:function(a,b,c){var d=this;while(d){if(a.apply(b||d,c||[d])===!1)break;d=d.parentNode}},cascade:function(){return Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.data.Node: cascade has been deprecated. Please use cascadeBy instead."),this.cascadeBy.apply(this,arguments)},cascadeBy:function(a,b,c){if(a.apply(b||this,c||[this])!==!1){var d=this.childNodes,e=d.length,f;for(f=0;f<e;f++)d[f].cascadeBy(a,b,c)}},eachChild:function(a,b,c){var d=this.childNodes,e=d.length,f;for(f=0;f<e;f++)if(a.apply(b||this,c||[d[f]])===!1)break},findChild:function(a,b,c){return this.findChildBy(function(){return this.get(a)==b},null,c)},findChildBy:function(a,b,c){var d=this.childNodes,e=d.length,f=0,g,h;for(;f<e;f++){g=d[f];if(a.call(b||g,g)===!0)return g;if(c){h=g.findChildBy(a,b,c);if(h!==null)return h}}return null},contains:function(a){return a.isAncestor(this)},isAncestor:function(a){var b=this.parentNode;while(b){if(b==a)return!0;b=b.parentNode}return!1},sort:function(a,b,c){var d=this.childNodes,e=d.length,f,g;if(e>0){Ext.Array.sort(d,a);for(f=0;f<e;f++)g=d[f],g.previousSibling=d[f-1],g.nextSibling=d[f+1],f===0&&this.setFirstChild(g),f==e-1&&this.setLastChild(g),g.updateInfo(),b&&!g.isLeaf()&&g.sort(a,!0,!0);c!==!0&&this.fireEvent("sort",this,d)}},isExpanded:function(){return this.get("expanded")},isLoaded:function(){return this.get("loaded")},isLoading:function(){return this.get("loading")},isRoot:function(){return!this.parentNode},isVisible:function(){var a=this.parentNode;while(a){if(!a.isExpanded())return!1;a=a.parentNode}return!0},expand:function(a,b,c){var d=this;d.isLeaf()?Ext.callback(b,c||d):d.isLoading()?d.on("expand",function(){d.expand(a,b,c)},d,{single:!0}):d.isExpanded()?a?d.expandChildren(!0,b,c):Ext.callback(b,c||d,[d.childNodes]):d.fireEvent("beforeexpand",d,function(){d.set("expanded",!0),d.hasListeners.expand&&d.fireEvent("expand",d,d.childNodes,!1),a?d.expandChildren(!0,b,c):Ext.callback(b,c||d,[d.childNodes])},d)},expandChildren:function(a,b,c){var d=this,e=0,f=d.childNodes,g=f.length,h,i=0;for(;e<g;++e)h=f[e],!h.isLeaf()&&!h.isExpanded()&&(i++,f[e].expand(a,function(){i--,b&&!i&&Ext.callback(b,c||d,[d.childNodes])}));!i&&b&&Ext.callback(b,c||d,[d.childNodes])},collapse:function(a,b,c){var d=this;d.isLeaf()?Ext.callback(b,c||d,[d.childNodes]):!d.collapsing&&d.isExpanded()?d.fireEvent("beforecollapse",d,function(){d.set("expanded",!1),d.hasListeners.collapse&&d.fireEvent("collapse",d,d.childNodes,!1),a?d.collapseChildren(!0,b,c):Ext.callback(b,c||d,[d.childNodes])},d):a&&d.collapseChildren(!0,b,c)},collapseChildren:function(a,b,c){var d=this,e=0,f=d.childNodes,g=f.length,h,i=0;for(;e<g;++e)h=f[e],!h.isLeaf()&&h.isExpanded()&&(i++,f[e].collapse(a,function(){i--,b&&!i&&Ext.callback(b,c||d,[d.childNodes])}));!i&&b&&Ext.callback(b,c||d,[d.childNodes])}}}}}),Ext.define("Ext.data.Tree",{alias:"data.tree",mixins:{observable:"Ext.util.Observable"},root:null,constructor:function(a){var b=this;b.mixins.observable.constructor.call(b),a&&b.setRootNode(a)},getRootNode:function(){return this.root},setRootNode:function(a){var b=this;return b.root=a,b.fireEvent("beforeappend",null,a)!==!1&&(a.set("root",!0),a.updateInfo(),a.commit(),a.on({scope:b,insert:b.onNodeInsert,append:b.onNodeAppend,remove:b.onNodeRemove}),b.relayEvents(a,["append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert","expand","collapse","beforeexpand","beforecollapse","sort","rootchange"]),b.nodeHash={},b.registerNode(a),b.fireEvent("append",null,a),b.fireEvent("rootchange",a)),a},flatten:function(){var a=[],b=this.nodeHash,c;for(c in b)b.hasOwnProperty(c)&&a.push(b[c]);return a},onNodeInsert:function(a,b){this.registerNode(b,!0)},onNodeAppend:function(a,b){this.registerNode(b,!0)},onNodeRemove:function(a,b){this.unregisterNode(b,!0)},onNodeIdChanged:function(a,b,c){var d=this.nodeHash;d[c]=a,delete d[b||a.internalId]},getNodeById:function(a){return this.nodeHash[a]},registerNode:function(a,b){var c=this;c.nodeHash[a.getId()||a.internalId]=a,a.on("idchanged",c.onNodeIdChanged,c),b===!0&&a.eachChild(function(a){c.registerNode(a,!0)})},unregisterNode:function(a,b){delete this.nodeHash[a.getId()||a.internalId],b===!0&&a.eachChild(function(a){this.unregisterNode(a,!0)},this)},sort:function(a,b){this.getRootNode().sort(a,b)},filter:function(a,b){this.getRootNode().filter(a,b)}}),Ext.define("Ext.data.association.HasMany",{extend:"Ext.data.association.Association",alternateClassName:"Ext.data.HasManyAssociation",requires:["Ext.util.Inflector"],alias:"association.hasmany",constructor:function(a){var b=this,c,d;b.callParent(arguments),b.name=b.name||Ext.util.Inflector.pluralize(b.associatedName.toLowerCase()),c=b.ownerModel.prototype,d=b.name,Ext.applyIf(b,{storeName:d+"Store",foreignKey:b.ownerName.toLowerCase()+"_id"}),c[d]=b.createStore()},createStore:function(){var a=this,b=a.associatedModel,c=a.storeName,d=a.foreignKey,e=a.primaryKey,f=a.filterProperty,g=a.autoLoad,h=a.storeConfig||{};return function(){var a=this,j,k,l={};return a[c]===undefined&&(f?k={property:f,value:a.get(f),exactMatch:!0}:k={property:d,value:a.get(e),exactMatch:!0},l[d]=a.get(e),j=Ext.apply({},h,{model:b,filters:[k],remoteFilter:!1,modelDefaults:l}),a[c]=new Ext.data.Store(j),g&&a[c].load()),a[c]}},read:function(a,b,c){var d=a[this.name](),e,f,g,h;d.add(b.read(c).records),e=this.associatedModel.prototype.associations.findBy(function(b){return b.type==="belongsTo"&&b.associatedName===a.$className});if(e){f=d.data.items,g=f.length;for(h=0;h<g;h++)f[h][e.instanceName]=a}}}),Ext.define("Ext.data.proxy.Proxy",{alias:"proxy.proxy",alternateClassName:["Ext.data.DataProxy","Ext.data.Proxy"],uses:["Ext.data.Batch","Ext.data.Operation","Ext.data.Model"],mixins:{observable:"Ext.util.Observable"},batchOrder:"create,update,destroy",batchActions:!0,defaultReaderType:"json",defaultWriterType:"json",isProxy:!0,constructor:function(a){a=a||{},a.model===undefined&&delete a.model,Ext.apply(this,a),this.mixins.observable.constructor.call(this),this.model!==undefined&&!(this.model instanceof Ext.data.Model)&&this.setModel(this.model)},setModel:function(a,b){this.model=Ext.ModelManager.getModel(a);var c=this.reader,d=this.writer;this.setReader(c),this.setWriter(d),b&&this.store&&this.store.setModel(this.model)},getModel:function(){return this.model},setReader:function(a){var b=this;if(a===undefined||typeof a=="string")a={type:a};return a.isReader?a.setModel(b.model):(Ext.applyIf(a,{proxy:b,model:b.model,type:b.defaultReaderType}),a=Ext.createByAlias("reader."+a.type,a)),a.onMetaChange&&(a.onMetaChange=Ext.Function.createSequence(a.onMetaChange,this.onMetaChange,this)),b.reader=a,b.reader},getReader:function(){return this.reader},onMetaChange:function(a){this.fireEvent("metachange",this,a)},setWriter:function(a){if(a===undefined||typeof a=="string")a={type:a};return a.isWriter||(Ext.applyIf(a,{model:this.model,type:this.defaultWriterType}),a=Ext.createByAlias("writer."+a.type,a)),this.writer=a,this.writer},getWriter:function(){return this.writer},create:Ext.emptyFn,read:Ext.emptyFn,update:Ext.emptyFn,destroy:Ext.emptyFn,batch:function(a,b){var c=this,d=c.batchActions,e,f,g,h,i,j,k,l,m;a.operations===undefined&&(a={operations:a,listeners:b}),a.batch?Ext.isDefined(a.batch.runOperation)&&(e=Ext.applyIf(a.batch,{proxy:c,listeners:{}})):a.batch={proxy:c,listeners:a.listeners||{}},e||(e=new Ext.data.Batch(a.batch)),e.on("complete",Ext.bind(c.onBatchComplete,c,[a],0)),g=c.batchOrder.split(","),h=g.length;for(j=0;j<h;j++){i=g[j],f=a.operations[i];if(f)if(d)e.add(new Ext.data.Operation({action:i,records:f}));else{l=f.length;for(k=0;k<l;k++)m=f[k],e.add(new Ext.data.Operation({action:i,records:[m]}))}}return e.start(),e},onBatchComplete:function(a,b){var c=a.scope||this;b.hasException?Ext.isFunction(a.failure)&&Ext.callback(a.failure,c,[b,a]):Ext.isFunction(a.success)&&Ext.callback(a.success,c,[b,a]),Ext.isFunction(a.callback)&&Ext.callback(a.callback,c,[b,a])}},function(){Ext.data.DataProxy=this}),Ext.define("Ext.data.proxy.Client",{extend:"Ext.data.proxy.Proxy",alternateClassName:"Ext.data.ClientProxy",clear:function(){}}),Ext.define("Ext.data.proxy.Memory",{extend:"Ext.data.proxy.Client",alias:"proxy.memory",alternateClassName:"Ext.data.MemoryProxy",constructor:function(a){this.callParent([a]),this.setReader(this.reader)},updateOperation:function(a,b,c){var d=0,e=a.getRecords(),f=e.length;for(d;d<f;d++)e[d].commit();a.setCompleted(),a.setSuccessful(),Ext.callback(b,c||this,[a])},create:function(){this.updateOperation.apply(this,arguments)},update:function(){this.updateOperation.apply(this,arguments)},destroy:function(){this.updateOperation.apply(this,arguments)},read:function(a,b,c){var d=this,e=d.getReader(),f=e.read(d.data);Ext.apply(a,{resultSet:f}),a.setCompleted(),a.setSuccessful(),Ext.callback(b,c||d,[a])},clear:Ext.emptyFn}),Ext.define("Ext.data.proxy.Server",{extend:"Ext.data.proxy.Proxy",alias:"proxy.server",alternateClassName:"Ext.data.ServerProxy",uses:["Ext.data.Request"],pageParam:"page",startParam:"start",limitParam:"limit",groupParam:"group",sortParam:"sort",filterParam:"filter",directionParam:"dir",simpleSortMode:!1,noCache:!0,cacheString:"_dc",timeout:3e4,constructor:function(a){var b=this;a=a||{},b.callParent([a]),b.extraParams=a.extraParams||{},b.api=Ext.apply({},a.api||b.api),b.nocache=b.noCache},create:function(){return this.doRequest.apply(this,arguments)},read:function(){return this.doRequest.apply(this,arguments)},update:function(){return this.doRequest.apply(this,arguments)},destroy:function(){return this.doRequest.apply(this,arguments)},setExtraParam:function(a,b){this.extraParams[a]=b},buildRequest:function(a){var b=this,c=Ext.applyIf(a.params||{},b.extraParams||{}),d;return c=Ext.applyIf(c,b.getParams(a)),a.id&&!c.id&&(c.id=a.id),d=new Ext.data.Request({params:c,action:a.action,records:a.records,operation:a,url:a.url,proxy:b}),d.url=b.buildUrl(d),a.request=d,d},processResponse:function(a,b,c,d,e,f){var g=this,h,i;a===!0?(h=g.getReader(),h.applyDefaults=b.action==="read",i=h.read(g.extractResponseData(d)),i.success!==!1?(Ext.apply(b,{response:d,resultSet:i}),b.commitRecords(i.records),b.setCompleted(),b.setSuccessful()):(b.setException(i.message),g.fireEvent("exception",this,d,b))):(g.setException(b,d),g.fireEvent("exception",this,d,b)),typeof e=="function"&&e.call(f||g,b),g.afterRequest(c,a)},setException:function(a,b){a.setException({status:b.status,statusText:b.statusText})},extractResponseData:function(a){return a},applyEncoding:function(a){return Ext.encode(a)},encodeSorters:function(a){var b=[],c=a.length,d=0;for(;d<c;d++)b[d]={property:a[d].property,direction:a[d].direction};return this.applyEncoding(b)},encodeFilters:function(a){var b=[],c=a.length,d=0;for(;d<c;d++)b[d]={property:a[d].property,value:a[d].value};return this.applyEncoding(b)},getParams:function(a){var b=this,c={},d=Ext.isDefined,e=a.groupers,f=a.sorters,g=a.filters,h=a.page,i=a.start,j=a.limit,k=b.simpleSortMode,l=b.pageParam,m=b.startParam,n=b.limitParam,o=b.groupParam,p=b.sortParam,q=b.filterParam,r=b.directionParam;return l&&d(h)&&(c[l]=h),m&&d(i)&&(c[m]=i),n&&d(j)&&(c[n]=j),o&&e&&e.length>0&&(c[o]=b.encodeSorters(e)),p&&f&&f.length>0&&(k?(c[p]=f[0].property,c[r]=f[0].direction):c[p]=b.encodeSorters(f)),q&&g&&g.length>0&&(c[q]=b.encodeFilters(g)),c},buildUrl:function(a){var b=this,c=b.getUrl(a);return b.noCache&&(c=Ext.urlAppend(c,Ext.String.format("{0}={1}",b.cacheString,Ext.Date.now()))),c},getUrl:function(a){return a.url||this.api[a.action]||this.url},doRequest:function(a,b,c){},afterRequest:Ext.emptyFn,onDestroy:function(){Ext.destroy(this.reader,this.writer)}}),Ext.define("Ext.data.proxy.JsonP",{extend:"Ext.data.proxy.Server",alternateClassName:"Ext.data.ScriptTagProxy",alias:["proxy.jsonp","proxy.scripttag"],requires:["Ext.data.JsonP"],defaultWriterType:"base",callbackKey:"callback",recordParam:"records",autoAppendParams:!0,constructor:function(){this.addEvents("exception"),this.callParent(arguments)},doRequest:function(a,b,c){var d=this,e=d.getWriter(),f=d.buildRequest(a),g=f.params;return a.allowWrite()&&(f=e.write(f)),Ext.apply(f,{callbackKey:d.callbackKey,timeout:d.timeout,scope:d,disableCaching:!1,callback:d.createRequestCallback(f,a,b,c)}),d.autoAppendParams&&(f.params={}),f.jsonp=Ext.data.JsonP.request(f),f.params=g,a.setStarted(),d.lastRequest=f,f},createRequestCallback:function(a,b,c,d){var e=this;return function(f,g,h){delete e.lastRequest,e.processResponse(f,b,a,g,c,d)}},setException:function(a,b){a.setException(a.request.jsonp.errorType)},buildUrl:function(a){var b=this,c=b.callParent(arguments),d=Ext.apply({},a.params),e=d.filters,f,g,h;delete d.filters,b.autoAppendParams&&(c=Ext.urlAppend(c,Ext.Object.toQueryString(d)));if(e&&e.length)for(h=0;h<e.length;h++)g=e[h],g.value&&(c=Ext.urlAppend(c,g.property+"="+g.value));return f=a.records,Ext.isArray(f)&&f.length>0&&(c=Ext.urlAppend(c,Ext.String.format("{0}={1}",b.recordParam,b.encodeRecords(f)))),c},destroy:function(){this.abort(),this.callParent(arguments)},abort:function(){var a=this.lastRequest;a&&Ext.data.JsonP.abort(a.jsonp)},encodeRecords:function(a){var b="",c=0,d=a.length;for(;c<d;c++)b+=Ext.Object.toQueryString(a[c].getData());return b}}),Ext.define("Ext.data.proxy.WebStorage",{extend:"Ext.data.proxy.Client",alternateClassName:"Ext.data.WebStorageProxy",requires:["Ext.data.SequentialIdGenerator"],id:undefined,constructor:function(a){this.callParent(arguments),this.cache={},this.id=this.id||(this.store?this.store.storeId:undefined),this.initialize()},create:function(a,b,c){var d=this,e=a.records,f=e.length,g=d.getIds(),h,i,j;a.setStarted(),d.isHierarchical===undefined&&(d.isHierarchical=!!e[0].isNode,d.isHierarchical&&d.getStorageObject().setItem(d.getTreeKey(),!0));for(j=0;j<f;j++)i=e[j],i.phantom?(i.phantom=!1,h=d.getNextId()):h=i.getId(),d.setRecord(i,h),i.commit(),g.push(h);d.setIds(g),a.setCompleted(),a.setSuccessful(),typeof b=="function"&&b.call(c||d,a)},read:function(a,b,c){var d=this,e=[],f=0,g=!0,h=d.model,i,j,k,l,m;a.setStarted();if(d.isHierarchical)e=d.getTreeData();else{i=d.getIds(),j=i.length,m=a.id;if(m)l=d.getRecord(m),k=new h(l,m,l),k?e.push(k):g=!1;else for(;f<j;f++)m=i[f],l=d.getRecord(m),e.push(new h(l,m,l))}g&&a.setSuccessful(),a.setCompleted(),a.resultSet=Ext.create("Ext.data.ResultSet",{records:e,total:e.length,loaded:!0}),typeof b=="function"&&b.call(c||d,a)},update:function(a,b,c){var d=a.records,e=d.length,f=this.getIds(),g,h,i;a.setStarted();for(i=0;i<e;i++)g=d[i],this.setRecord(g),g.commit(),h=g.getId(),h!==undefined&&Ext.Array.indexOf(f,h)==-1&&f.push(h);this.setIds(f),a.setCompleted(),a.setSuccessful(),typeof b=="function"&&b.call(c||this,a)},destroy:function(a,b,c){var d=this,e=a.records,f=d.getIds(),g=f.length,h=[],i={},j=e.length,k;a.setStarted();for(;j--;)Ext.apply(i,d.removeRecord(e[j]));for(j=0;j<g;j++)k=f[j],i[k]||h.push(k);d.setIds(h),a.setCompleted(),a.setSuccessful(),typeof b=="function"&&b.call(c||d,a)},getRecord:function(a){var b=this,c=b.cache,d=c[a]?c[a]:Ext.decode(b.getStorageObject().getItem(b.getRecordKey(a)));return d?(c[a]=d,d[b.model.prototype.idProperty]=a,d):null},setRecord:function(a,b){b?a.setId(b):b=a.getId();var c=this,d=a.data,e={},f=c.model,g=f.prototype.fields.items,h=g.length,i=0,j,k,l,m;for(;i<h;i++)j=g[i],k=j.name,j.persist&&(e[k]=d[k]);delete e[c.model.prototype.idProperty],a.isNode&&a.get("depth")===1&&delete e.parentId,l=c.getStorageObject(),m=c.getRecordKey(b),c.cache[b]=e,l.removeItem(m),l.setItem(m,Ext.encode(e))},removeRecord:function(a){var b=this,c=a.getId(),d={},e,f;d[c]=a,b.getStorageObject().removeItem(b.getRecordKey(c)),delete b.cache[c];if(a.childNodes){f=a.childNodes;for(e=f.length;e--;)Ext.apply(d,b.removeRecord(f[e]))}return d},getRecordKey:function(a){return a.isModel&&(a=a.getId()),Ext.String.format("{0}-{1}",this.id,a)},getRecordCounterKey:function(){return Ext.String.format("{0}-counter",this.id)},getTreeKey:function(){return Ext.String.format("{0}-tree",this.id)},getIds:function(){var a=this,b=(a.getStorageObject().getItem(a.id)||"").split(","),c=a.model,d=b.length,e=c.prototype.fields.get(c.prototype.idProperty).type.type==="string",f;if(d==1&&b[0]==="")b=[];else for(f=0;f<d;f++)b[f]=e?b[f]:+b[f];return b},setIds:function(a){var b=this.getStorageObject(),c=a.join(",");b.removeItem(this.id),Ext.isEmpty(c)||b.setItem(this.id,c)},getNextId:function(){var a=this,b=a.getStorageObject(),c=a.getRecordCounterKey(),d=a.model,e=d.prototype.fields.get(d.prototype.idProperty).type.type==="string",f;return f=a.idGenerator.generate(),b.setItem(c,f),e||(f=+f),f},getTreeData:function(){var a=this,b=a.getIds(),c=b.length,d=[],e={},f=[],g=0,h=a.model,i=h.prototype.idProperty,j,k,l,m,n,o;for(;g<c;g++)o=b[g],k=a.getRecord(o),d.push(k),e[o]=k,k.parentId||f.push(k);j=f.length,Ext.Array.sort(d,a.sortByParentId);for(g=j;g<c;g++){k=d[g],m=k.parentId;if(!l||l[i]!==m)l=e[m],l.children=n=[];n.push(k)}for(g=c;g--;)k=d[g],!k.children&&!k.leaf&&(k.loaded=!0);for(g=j;g--;)k=f[g],f[g]=new h(k,k[i],k);return f},sortByParentId:function(a,b){return(a.parentId||0)-(b.parentId||0)},initialize:function(){var a=this,b=a.getStorageObject(),c=+b.getItem(a.getRecordCounterKey());b.setItem(a.id,b.getItem(a.id)||""),b.getItem(a.getTreeKey())&&(a.isHierarchical=!0),a.idGenerator=new Ext.data.SequentialIdGenerator({seed:c?c+1:1})},clear:function(){var a=this,b=a.getStorageObject(),c=a.getIds(),d=c.length,e;for(e=0;e<d;e++)b.removeItem(a.getRecordKey(c[e]));b.removeItem(a.getRecordCounterKey()),b.removeItem(a.getTreeKey()),b.removeItem(a.id),a.cache={}},getStorageObject:function(){}}),Ext.define("Ext.data.proxy.LocalStorage",{extend:"Ext.data.proxy.WebStorage",alias:"proxy.localstorage",alternateClassName:"Ext.data.LocalStorageProxy",getStorageObject:function(){return window.localStorage}}),Ext.define("Ext.data.proxy.SessionStorage",{extend:"Ext.data.proxy.WebStorage",alias:"proxy.sessionstorage",alternateClassName:"Ext.data.SessionStorageProxy",getStorageObject:function(){return window.sessionStorage}}),Ext.define("Ext.data.reader.Reader",{requires:["Ext.data.ResultSet"],alternateClassName:["Ext.data.Reader","Ext.data.DataReader"],mixins:{observable:"Ext.util.Observable"},totalProperty:"total",successProperty:"success",root:"",implicitIncludes:!0,readRecordsOnFailure:!0,isReader:!0,applyDefaults:!0,constructor:function(a){var b=this;b.mixins.observable.constructor.call(b,a),b.fieldCount=0,b.model=Ext.ModelManager.getModel(b.model),b.model&&b.model.prototype.fields&&b.buildExtractors(),this.addEvents("exception")},setModel:function(a,b){var c=this;c.model=Ext.ModelManager.getModel(a),c.buildExtractors(!0),b&&c.proxy&&c.proxy.setModel(c.model,!0)},read:function(a){var b;return a&&(b=a.responseText?this.getResponseData(a):this.readRecords(a)),b||this.nullResultSet},readRecords:function(a){var b=this,c,d,e,f,g,h,i;b.fieldCount!==b.getFields().length&&b.buildExtractors(!0),b.rawData=a,a=b.getData(a),c=!0,d=0,e=[];if(b.successProperty){h=b.getSuccess(a);if(h===!1||h==="false")c=!1}b.messageProperty&&(i=b.getMessage(a));if(b.readRecordsOnFailure||c)f=Ext.isArray(a)?a:b.getRoot(a),f&&(g=f.length),b.totalProperty&&(h=parseInt(b.getTotal(a),10),isNaN(h)||(g=h)),f&&(e=b.extractData(f),d=e.length);return new Ext.data.ResultSet({total:g||d,count:d,records:e,success:c,message:i})},extractData:function(a){var b=this,c=[],d=b.model,e=a.length,f,g,h,i;!a.length&&Ext.isObject(a)&&(a=[a],e=1);for(i=0;i<e;i++)g=a[i],h=new d(undefined,b.getId(g),g,f={}),h.phantom=!1,b.convertRecordData(f,g,h),c.push(h),b.implicitIncludes&&b.readAssociated(h,g);return c},readAssociated:function(a,b){var c=a.associations.items,d=0,e=c.length,f,g,h,i;for(;d<e;d++)f=c[d],g=this.getAssociatedDataRoot(b,f.associationKey||f.name),g&&(i=f.getReader(),i||(h=f.associatedModel.proxy,h?i=h.getReader():i=new this.constructor({model:f.associatedName})),f.read(a,i,g))},getAssociatedDataRoot:function(a,b){return a[b]},getFields:function(){return this.model.prototype.fields.items},getData:function(a){return a},getRoot:function(a){return a},getResponseData:function(a){},onMetaChange:function(a){var b=this,c=a.fields||b.getFields(),d,e;b.metaData=a,b.root=a.root||b.root,b.idProperty=a.idProperty||b.idProperty,b.totalProperty=a.totalProperty||b.totalProperty,b.successProperty=a.successProperty||b.successProperty,b.messageProperty=a.messageProperty||b.messageProperty,e=a.clientIdProperty,b.model?(b.model.setFields(c,b.idProperty,e),b.setModel(b.model,!0)):(d=Ext.define("Ext.data.reader.Json-Model"+Ext.id(),{extend:"Ext.data.Model",fields:c,clientIdProperty:e}),b.idProperty&&(d.idProperty=b.idProperty),b.setModel(d,!0))},getIdProperty:function(){return this.idProperty||this.model.prototype.idProperty},buildExtractors:function(a){var b=this,c=b.getIdProperty(),d=b.totalProperty,e=b.successProperty,f=b.messageProperty,g,h,i;a===!0&&delete b.convertRecordData;if(b.convertRecordData)return;d&&(b.getTotal=b.createAccessor(d)),e&&(b.getSuccess=b.createAccessor(e)),f&&(b.getMessage=b.createAccessor(f)),c?(h=b.model.prototype.fields.get(c),h&&(i=h.mapping,c=i!==undefined&&i!==null?i:c),g=b.createAccessor(c),b.getId=function(a){var c=g.call(b,a);return c===undefined||c===""?null:c}):b.getId=function(){return null},b.convertRecordData=b.buildRecordDataExtractor()},buildRecordDataExtractor:function(){var a=this,b=a.model.prototype,c=b.clientIdProperty,d=b.fields.items,e=d.length,f=[],g,h=0,i,j=["var me = this,\n","    fields = me.model.prototype.fields,\n","    value,\n","    internalId"];for(h=0;h<e;h++)i=d[h],f[h]="__field"+h,j.push(",\n    ",f[h],' = fields.get("',i.name,'")');j.push(";\n\n    return function(dest, source, record) {\n");for(h=0;h<e;h++)i=d[h],g=f[h],j.push("        value = ",a.createFieldAccessExpression(i,g,"source"),";\n"),i.defaultValue!==undefined?(j.push("        if (value === undefined) {\n"),j.push("            if (me.applyDefaults) {\n"),j.push('                dest["'+i.name+'"] = ',i.convert?f[h]+".convert("+f[h]+".defaultValue, record)":f[h]+".defaultValue",";\n"),j.push("            }\n"),j.push("        } else {\n"),j.push('            dest["'+i.name+'"] = ',i.convert?f[h]+".convert(value, record)":"value",";\n"),j.push("        }\n")):(j.push("        if (value !== undefined) {\n"),j.push('            dest["'+i.name+'"] = ',i.convert?f[h]+".convert(value, record)":"value",";\n"),j.push("        }\n"));return c&&(j.push("        if (record && (internalId = "+a.createFieldAccessExpression({mapping:c},null,"source")+")) {\n"),j.push("            record.internalId = internalId;\n        }\n")),j.push("    };"),Ext.functionFactory(j.join("")).call(a)},destroyReader:function(){var a=this;delete a.proxy,delete a.model,delete a.convertRecordData,delete a.getId,delete a.getTotal,delete a.getSuccess,delete a.getMessage}},function(){Ext.apply(this.prototype,{nullResultSet:new Ext.data.ResultSet({total:0,count:0,records:[],success:!0})})}),Ext.define("Ext.data.reader.Json",{extend:"Ext.data.reader.Reader",alternateClassName:"Ext.data.JsonReader",alias:"reader.json",root:"",useSimpleAccessors:!1,readRecords:function(a){return a.metaData&&this.onMetaChange(a.metaData),this.jsonData=a,this.callParent([a])},getResponseData:function(a){var b,c;try{return b=Ext.decode(a.responseText),this.readRecords(b)}catch(d){return c=new Ext.data.ResultSet({total:0,count:0,records:[],success:!1,message:d.message}),this.fireEvent("exception",this,a,c),Ext.Logger.warn("Unable to parse the JSON returned by the server"),c}},buildExtractors:function(){var a=this;a.callParent(arguments),a.root?a.getRoot=a.createAccessor(a.root):a.getRoot=function(a){return a}},extractData:function(a){var b=this.record,c=[],d,e;if(b){d=a.length,!d&&Ext.isObject(a)&&(d=1,a=[a]);for(e=0;e<d;e++)c[e]=a[e][b]}else c=a;return this.callParent([c])},createAccessor:function(){var a=/[\[\.]/;return function(b){if(Ext.isEmpty(b))return Ext.emptyFn;if(Ext.isFunction(b))return b;if(this.useSimpleAccessors!==!0){var c=String(b).search(a);if(c>=0)return Ext.functionFactory("obj","return obj"+(c>0?".":"")+b)}return function(a){return a[b]}}}(),createFieldAccessExpression:function(){var a=/[\[\.]/;return function(b,c,d){var e=this,f=b.mapping!==null,g=f?b.mapping:b.name,h,i;if(typeof g=="function")h=c+".mapping("+d+", this)";else if(this.useSimpleAccessors===!0||(i=String(g).search(a))<0){if(!f||isNaN(g))g='"'+g+'"';h=d+"["+g+"]"}else h=d+(i>0?".":"")+g;return h}}()}),Ext.define("Ext.data.reader.Array",{extend:"Ext.data.reader.Json",alternateClassName:"Ext.data.ArrayReader",alias:"reader.array",totalProperty:undefined,successProperty:undefined,createFieldAccessExpression:function(a,b,c){var d=a.mapping==null?a.originalIndex:a.mapping,e;return typeof d=="function"?e=b+".mapping("+c+", this)":(isNaN(d)&&(d='"'+d+'"'),e=c+"["+d+"]"),e}}),Ext.define("Ext.data.reader.Xml",{extend:"Ext.data.reader.Reader",alternateClassName:"Ext.data.XmlReader",alias:"reader.xml",createAccessor:function(a){var b=this;return Ext.isEmpty(a)?Ext.emptyFn:Ext.isFunction(a)?a:function(c){return b.getNodeValue(Ext.DomQuery.selectNode(a,c))}},getNodeValue:function(a){return a&&a.firstChild?a.firstChild.nodeValue:undefined},getResponseData:function(a){var b=a.responseXML,c,d;return b?this.readRecords(b):(d="XML data not found in the response",c=new Ext.data.ResultSet({total:0,count:0,records:[],success:!1,message:d}),this.fireEvent("exception",this,a,c),Ext.Logger.warn(d),c)},getData:function(a){return a.documentElement||a},getRoot:function(a){var b=a.nodeName,c=this.root;if(!c||b&&b==c)return a;if(Ext.DomQuery.isXml(a))return Ext.DomQuery.selectNode(c,a)},extractData:function(a){var b=this.record;return b!=a.nodeName?a=Ext.DomQuery.select(b,a):a=[a],this.callParent([a])},getAssociatedDataRoot:function(a,b){return Ext.DomQuery.select(b,a)[0]},readRecords:function(a){return Ext.isArray(a)&&(a=a[0]),this.xmlData=a,this.callParent([a])},createFieldAccessExpression:function(a,b,c){var d=a.mapping||a.name,e;return typeof d=="function"?e=b+".mapping("+c+", this)":e='me.getNodeValue(Ext.DomQuery.selectNode("'+d+'", '+c+"))",e}}),Ext.define("Ext.data.writer.Json",{extend:"Ext.data.writer.Writer",alternateClassName:"Ext.data.JsonWriter",alias:"writer.json",root:undefined,encode:!1,allowSingle:!0,writeRecords:function(a,b){var c=this.root;return this.allowSingle&&b.length==1&&(b=b[0]),this.encode?c&&(a.params[c]=Ext.encode(b)):(a.jsonData=a.jsonData||{},c?a.jsonData[c]=b:a.jsonData=b),a}}),Ext.define("Ext.direct.Provider",{alias:"direct.provider",mixins:{observable:"Ext.util.Observable"},constructor:function(a){var b=this;Ext.apply(b,a),b.addEvents("connect","disconnect","data","exception"),b.mixins.observable.constructor.call(b,a)},isConnected:function(){return!1},connect:Ext.emptyFn,disconnect:Ext.emptyFn}),Ext.define("Ext.direct.JsonProvider",{extend:"Ext.direct.Provider",alias:"direct.jsonprovider",uses:["Ext.direct.ExceptionEvent"],parseResponse:function(a){return Ext.isEmpty(a.responseText)?null:Ext.isObject(a.responseText)?a.responseText:Ext.decode(a.responseText)},createEvents:function(a){var b=null,c=[],d,e=0,f;try{b=this.parseResponse(a)}catch(g){return d=new Ext.direct.ExceptionEvent({data:g,xhr:a,code:Ext.direct.Manager.self.exceptions.PARSE,message:"Error parsing json response: \n\n "+b}),[d]}if(Ext.isArray(b))for(f=b.length;e<f;++e)c.push(this.createEvent(b[e]));else c.push(this.createEvent(b));return c},createEvent:function(a){return Ext.create("direct."+a.type,a)}}),Ext.define("Ext.direct.PollingProvider",{extend:"Ext.direct.JsonProvider",alias:"direct.pollingprovider",uses:["Ext.direct.ExceptionEvent"],requires:["Ext.Ajax","Ext.util.DelayedTask"],interval:3e3,constructor:function(a){this.callParent(arguments),this.addEvents("beforepoll","poll")},isConnected:function(){return!!this.pollTask},connect:function(){var a=this,b=a.url;b&&!a.pollTask?(a.pollTask=Ext.TaskManager.start({run:function(){a.fireEvent("beforepoll",a)!==!1&&(Ext.isFunction(b)?b(a.baseParams):Ext.Ajax.request({url:b,callback:a.onData,scope:a,params:a.baseParams}))},interval:a.interval,scope:a}),a.fireEvent("connect",a)):!!b},disconnect:function(){var a=this;a.pollTask&&(Ext.TaskManager.stop(a.pollTask),delete a.pollTask,a.fireEvent("disconnect",a))},onData:function(a,b,c){var d=this,e=0,f,g;if(b){g=d.createEvents(c);for(f=g.length;e<f;++e)d.fireEvent("data",d,g[e])}else d.fireEvent("data",d,new Ext.direct.ExceptionEvent({data:null,code:Ext.direct.Manager.self.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:c}))}}),Ext.ns("Ext.fx"),Ext.require("Ext.fx.CubicBezier",function(){var a=Math,b=a.PI,c=a.pow,d=a.sin,e=a.sqrt,f=a.abs,g=1.70158;Ext.fx.Easing={},Ext.apply(Ext.fx.Easing,{linear:function(a){return a},ease:function(a){var b=.07813-a/2,d=-0.25,g=e(.0066+b*b),h=g-b,i=c(f(h),1/3)*(h<0?-1:1),j=-g-b,k=c(f(j),1/3)*(j<0?-1:1),l=i+k+.25;return c(1-l,2)*3*l*.1+(1-l)*3*l*l+l*l*l},easeIn:function(a){return c(a,1.7)},easeOut:function(a){return c(a,.48)},easeInOut:function(a){var b=.48-a/1.04,d=e(.1734+b*b),g=d-b,h=c(f(g),1/3)*(g<0?-1:1),i=-d-b,j=c(f(i),1/3)*(i<0?-1:1),k=h+j+.5;return(1-k)*3*k*k+k*k*k},backIn:function(a){return a*a*((g+1)*a-g)},backOut:function(a){return a-=1,a*a*((g+1)*a+g)+1},elasticIn:function(a){if(a===0||a===1)return a;var e=.3,f=e/4;return c(2,-10*a)*d((a-f)*2*b/e)+1},elasticOut:function(a){return 1-Ext.fx.Easing.elasticIn(1-a)},bounceIn:function(a){return 1-Ext.fx.Easing.bounceOut(1-a)},bounceOut:function(a){var b=7.5625,c=2.75,d;return a<1/c?d=b*a*a:a<2/c?(a-=1.5/c,d=b*a*a+.75):a<2.5/c?(a-=2.25/c,d=b*a*a+.9375):(a-=2.625/c,d=b*a*a+.984375),d}}),Ext.apply(Ext.fx.Easing,{"back-in":Ext.fx.Easing.backIn,"back-out":Ext.fx.Easing.backOut,"ease-in":Ext.fx.Easing.easeIn,"ease-out":Ext.fx.Easing.easeOut,"elastic-in":Ext.fx.Easing.elasticIn,"elastic-out":Ext.fx.Easing.elasticIn,"bounce-in":Ext.fx.Easing.bounceIn,"bounce-out":Ext.fx.Easing.bounceOut,"ease-in-out":Ext.fx.Easing.easeInOut})}),Ext.define("Ext.fx.target.Component",{extend:"Ext.fx.target.Target",type:"component",getPropMethod:{top:function(){return this.getPosition(!0)[1]},left:function(){return this.getPosition(!0)[0]},x:function(){return this.getPosition()[0]},y:function(){return this.getPosition()[1]},height:function(){return this.getHeight()},width:function(){return this.getWidth()},opacity:function(){return this.el.getStyle("opacity")}},compMethod:{top:"setPosition",left:"setPosition",x:"setPagePosition",y:"setPagePosition",height:"setSize",width:"setSize",opacity:"setOpacity"},getAttr:function(a,b){return[[this.target,b!==undefined?b:this.getPropMethod[a].call(this.target)]]},setAttr:function(a,b,c){var d=this,e=d.target,f=a.length,g,h,i,j,k,l,m,n,o,p,q;for(j=0;j<f;j++){g=a[j].attrs;for(h in g){m=g[h].length,l={setPosition:{},setPagePosition:{},setSize:{},setOpacity:{}};for(k=0;k<m;k++)i=g[h][k],l[d.compMethod[h]].target=i[0],l[d.compMethod[h]][h]=i[1];l.setPosition.target&&(i=l.setPosition,n=i.left===undefined?undefined:parseFloat(i.left),o=i.top===undefined?undefined:parseFloat(i.top),i.target.setPosition(n,o)),l.setPagePosition.target&&(i=l.setPagePosition,i.target.setPagePosition(i.x,i.y)),l.setSize.target&&(i=l.setSize,p=i.width===undefined?i.target.getWidth():parseFloat(i.width),q=i.height===undefined?i.target.getHeight():parseFloat(i.height),c||d.dynamic?i.target.setSize(p,q):i.target.el.setSize(p,q)),l.setOpacity.target&&(i=l.setOpacity,i.target.el.setStyle("opacity",i.opacity))}}}}),Ext.define("Ext.fx.target.Element",{extend:"Ext.fx.target.Target",type:"element",getElVal:function(a,b,c){return c==undefined&&(b==="x"?c=a.getX():b==="y"?c=a.getY():b==="scrollTop"?c=a.getScroll().top:b==="scrollLeft"?c=a.getScroll().left:b==="height"?c=a.getHeight():b==="width"?c=a.getWidth():c=a.getStyle(b)),c},getAttr:function(a,b){var c=this.target;return[[c,this.getElVal(c,a,b)]]},setAttr:function(a){var b=this.target,c=a.length,d,e,f,g,h,i,j,k;for(g=0;g<c;g++){d=a[g].attrs;for(e in d)if(d.hasOwnProperty(e)){i=d[e].length;for(h=0;h<i;h++)f=d[e][h],j=f[0],k=f[1],e==="x"?j.setX(k):e==="y"?j.setY(k):e==="scrollTop"?j.scrollTo("top",k):e==="scrollLeft"?j.scrollTo("left",k):e==="width"?j.setWidth(k):e==="height"?j.setHeight(k):j.setStyle(e,k)}}}}),Ext.define("Ext.fx.target.CompositeElement",{extend:"Ext.fx.target.Element",isComposite:!0,constructor:function(a){a.id=a.id||Ext.id(null,"ext-composite-"),this.callParent([a])},getAttr:function(a,b){var c=[],d=this.target.elements,e=d.length,f,g;for(f=0;f<e;f++)g=d[f],g&&(g=this.target.getElement(g),c.push([g,this.getElVal(g,a,b)]));return c}}),Ext.define("Ext.fx.target.ElementCSS",{extend:"Ext.fx.target.Element",setAttr:function(a,b){var c={attrs:[],duration:[],easing:[]},d=a.length,e,f,g,h,i,j,k,l,m;for(k=0;k<d;k++){f=a[k],i=f.duration,h=f.easing,f=f.attrs;for(g in f)Ext.Array.indexOf(c.attrs,g)==-1&&(c.attrs.push(g.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})),c.duration.push(i+"ms"),c.easing.push(h))}e=c.attrs.join(","),i=c.duration.join(","),h=c.easing.join(", ");for(k=0;k<d;k++){f=a[k].attrs;for(g in f){m=f[g].length;for(l=0;l<m;l++)j=f[g][l],j[0].setStyle(Ext.supports.CSS3Prefix+"TransitionProperty",b?"":e),j[0].setStyle(Ext.supports.CSS3Prefix+"TransitionDuration",b?"":i),j[0].setStyle(Ext.supports.CSS3Prefix+"TransitionTimingFunction",b?"":h),j[0].setStyle(g,j[1]),b?j=j[0].dom.offsetWidth:j[0].on(Ext.supports.CSS3TransitionEnd,function(){this.setStyle(Ext.supports.CSS3Prefix+"TransitionProperty",null),this.setStyle(Ext.supports.CSS3Prefix+"TransitionDuration",null),this.setStyle(Ext.supports.CSS3Prefix+"TransitionTimingFunction",null)},j[0],{single:!0})}}}}),Ext.define("Ext.fx.target.CompositeElementCSS",{extend:"Ext.fx.target.CompositeElement",requires:["Ext.fx.target.ElementCSS"],setAttr:function(){return Ext.fx.target.ElementCSS.prototype.setAttr.apply(this,arguments)}}),Ext.define("Ext.fx.target.Sprite",{extend:"Ext.fx.target.Target",type:"draw",getFromPrim:function(a,b){var c;switch(b){case"rotate":case"rotation":return c=a.attr.rotation,{x:c.x||0,y:c.y||0,degrees:c.degrees||0};case"scale":case"scaling":return c=a.attr.scaling,{x:c.x||1,y:c.y||1,cx:c.cx||0,cy:c.cy||0};case"translate":case"translation":return c=a.attr.translation,{x:c.x||0,y:c.y||0};default:return a.attr[b]}},getAttr:function(a,b){return[[this.target,b!=undefined?b:this.getFromPrim(this.target,a)]]},setAttr:function(a){var b=a.length,c=[],d,e,f,g,h,i,j,k,l,m,n,o;for(k=0;k<b;k++){d=a[k].attrs;for(e in d){f=d[e],o=f.length;for(l=0;l<o;l++)h=f[l][0],g=f[l][1],e==="translate"||e==="translation"?j={x:g.x,y:g.y}:e==="rotate"||e==="rotation"?(m=g.x,isNaN(m)&&(m=null),n=g.y,isNaN(n)&&(n=null),j={degrees:g.degrees,x:m,y:n}):e==="scale"||e==="scaling"?(m=g.x,isNaN(m)&&(m=null),n=g.y,isNaN(n)&&(n=null),j={x:m,y:n,cx:g.cx,cy:g.cy}):e==="width"||e==="height"||e==="x"||e==="y"?j=parseFloat(g):j=g,i=Ext.Array.indexOf(c,h),i==-1&&(c.push([h,{}]),i=c.length-1),c[i][1][e]=j}}b=c.length;for(k=0;k<b;k++)c[k][0].setAttributes(c[k][1]);this.target.redraw()}}),Ext.define("Ext.fx.target.CompositeSprite",{extend:"Ext.fx.target.Sprite",getAttr:function(a,b){var c=[],d=[].concat(this.target.items),e=d.length,f,g;for(f=0;f<e;f++)g=d[f],c.push([g,b!=undefined?b:this.getFromPrim(g,a)]);return c}}),Ext.define("Ext.layout.Layout",{requires:["Ext.XTemplate"],uses:["Ext.layout.Context"],isLayout:!0,initialized:!1,running:!1,autoSizePolicy:{setsWidth:0,setsHeight:0},statics:{layoutsByType:{},create:function(a,b){var c=Ext.ClassManager,d=this.layoutsByType,e,f,g,h,i,j;if(!a||typeof a=="string")i=a||b,g={};else{if(a.isLayout)return a;g=a,i=a.type||b}if(!(h=d[i])){e="layout."+i,f=c.getNameByAlias(e),f||(j=!0),h=c.get(f);if(j||!h)return c.instantiateByAlias(e,g||{});d[i]=h}return new h(g)}},constructor:function(a){var b=this;b.id=Ext.id(null,b.type+"-"),Ext.apply(b,a),b.layoutCount=0},beginLayout:Ext.emptyFn,beginLayoutCycle:function(a){var b=this,c=b.context,d;b.lastWidthModel!=a.widthModel&&(b.lastWidthModel&&(d=!0),b.lastWidthModel=a.widthModel),b.lastHeightModel!=a.heightModel&&(b.lastWidthModel&&(d=!0),b.lastHeightModel=a.heightModel),d&&((c=a.context).clearTriggers(b,!1),c.clearTriggers(b,!0),b.triggerCount=0)},finishedLayout:function(){this.ownerContext=null},redoLayout:Ext.emptyFn,undoLayout:Ext.emptyFn,getAnimatePolicy:function(){return this.animatePolicy},getItemSizePolicy:function(a){return this.autoSizePolicy},isItemBoxParent:function(a){return!1},isItemLayoutRoot:function(a){var b=a.getSizeModel(),c=b.width,d=b.height;return!a.componentLayout.lastComponentSize&&(c.calculated||d.calculated)?!1:!c.shrinkWrap&&!d.shrinkWrap},isItemShrinkWrap:function(a){return a.shrinkWrap},isRunning:function(){return!!this.ownerContext},getItemsRenderTree:function(a,b){var c=a.length,d,e,f,g;if(c){g=[];for(d=0;d<c;++d)e=a[d],e.rendered||(b&&b[e.id]!==undefined?f=b[e.id]:(this.configureItem(e),f=e.getRenderTree(),b&&(b[e.id]=f)),f&&g.push(f))}return g},finishRender:Ext.emptyFn,finishRenderItems:function(a,b){var c=b.length,d,e;for(d=0;d<c;d++)e=b[d],e.rendering&&(e.finishRender(d),this.afterRenderItem(e))},renderChildren:function(){var a=this,b=a.getLayoutItems(),c=a.getRenderTarget();a.renderItems(b,c)},renderItems:function(a,b){var c=this,d=a.length,e=0,f;if(d){Ext.suspendLayouts();for(;e<d;e++)f=a[e],f&&!f.rendered?c.renderItem(f,b,e):c.isValidParent(f,b,e)?c.configureItem(f):c.moveItem(f,b,e);Ext.resumeLayouts(!0)}},isValidParent:function(a,b,c){var d=a.el?a.el.dom:Ext.getDom(a),e=b&&b.dom||b;return d.parentNode&&d.parentNode.className.indexOf(Ext.baseCSSPrefix+"resizable-wrap")!==-1&&(d=d.parentNode),d&&e?typeof c=="number"?d===e.childNodes[c]:d.parentNode===e:!1},configureItem:function(a){a.ownerLayout=this},renderItem:function(a,b,c){a.rendered||(this.configureItem(a),a.render(b,c),this.afterRenderItem(a))},moveItem:function(a,b,c){b=b.dom||b,typeof c=="number"&&(c=b.childNodes[c]),b.insertBefore(a.el.dom,c||null),a.container=Ext.get(b),this.configureItem(a)},onContentChange:function(){return this.owner.updateLayout(),!0},initLayout:function(){this.initialized=!0},setOwner:function(a){this.owner=a},getLayoutItems:function(){return[]},afterRenderItem:Ext.emptyFn,onAdd:Ext.emptyFn,onRemove:Ext.emptyFn,onDestroy:Ext.emptyFn,afterRemove:function(a){var b=this,c=a.el,d=b.owner,e;a.rendered&&(e=[].concat(b.itemCls||[]),d.itemCls&&(e=Ext.Array.push(e,d.itemCls)),e.length&&c.removeCls(e)),delete a.ownerLayout},destroy:function(){var a=this,b;a.targetCls&&(b=a.getTarget(),b&&b.removeCls(a.targetCls)),a.onDestroy()},sortWeightedItems:function(a,b){for(var c=0,d=a.length;c<d;++c)a[c].$i=c;Ext.Array.sort(a,function(a,c){var d=c.weight-a.weight;return d||(d=a.$i-c.$i,a[b]&&(d=-d)),d});for(c=0;c<d;++c)delete a[c].$i}},function(){var a=this,b={};a.prototype.sizeModels=a.sizeModels=b;var c=function(a){var e=this,f=a.name;Ext.apply(Ext.apply(e,d),a),e[f]=!0,c[f]=b[f]=e,e.fixed=!(e.auto=e.natural||e.shrinkWrap)};Ext.layout.SizeModel=c;var d={calculated:!1,configured:!1,constrainedMax:!1,constrainedMin:!1,natural:!1,shrinkWrap:!1,calculatedFromConfigured:!1,calculatedFromNatural:!1,calculatedFromShrinkWrap:!1,names:null};new c({name:"calculated"}),new c({name:"configured",names:{width:"width",height:"height"}}),new c({name:"natural"}),new c({name:"shrinkWrap"}),new c({name:"calculatedFromConfigured",configured:!0,names:{width:"width",height:"height"}}),new c({name:"calculatedFromNatural",natural:!0}),new c({name:"calculatedFromShrinkWrap",shrinkWrap:!0}),new c({name:"constrainedMax",configured:!0,constrained:!0,names:{width:"maxWidth",height:"maxHeight"}}),new c({name:"constrainedMin",configured:!0,constrained:!0,names:{width:"minWidth",height:"minHeight"}})}),Ext.define("Ext.layout.component.Component",{extend:"Ext.layout.Layout",type:"component",isComponentLayout:!0,nullBox:{},usesContentHeight:!0,usesContentWidth:!0,usesHeight:!0,usesWidth:!0,beginLayoutCycle:function(a,b){var c=this,d=c.owner,e=a.ownerCtContext,f=a.heightModel,g=a.widthModel,h=d.el.dom===document.body,i=d.lastBox||c.nullBox,j=d.el.lastBox||c.nullBox,k=!h,l,m,n,o;c.callParent(arguments),b&&(c.usesContentWidth&&++a.consumersContentWidth,c.usesContentHeight&&++a.consumersContentHeight,c.usesWidth&&++a.consumersWidth,c.usesHeight&&++a.consumersHeight,e&&!e.hasRawContent&&(l=d.ownerLayout,l.usesWidth&&++a.consumersWidth,l.usesHeight&&++a.consumersHeight)),g.configured?(n=g.names.width,h||(k=b?d[n]!==j.width:g.constrained),a.setWidth(d[n],k)):a.isTopLevel&&(g.calculated&&(m=i.width,a.setWidth(m,m!=j.width)),m=i.x,a.setProp("x",m,m!=j.x)),f.configured?(o=f.names.height,h||(k=b?d[o]!==j.height:f.constrained),a.setHeight(d[o],k)):a.isTopLevel&&(f.calculated&&(m=i.height,a.setHeight(m,m!=j.height)),m=i.y,a.setProp("y",m,m!=j.y))},finishedLayout:function(a){var b=this,c=a.children,d=b.owner,e,f,g,h,i,j;if(c){e=c.length;for(f=0;f<e;f++)g=c[f],g.el.lastBox=g.props}a.previousSize=b.lastComponentSize,b.lastComponentSize=d.el.lastBox=i=a.props,d.lastBox=h={},j=i.x,j!==undefined&&(h.x=j),j=i.y,j!==undefined&&(h.y=j),j=i.width,j!==undefined&&(h.width=j),j=i.height,j!==undefined&&(h.height=j),b.callParent(arguments)},notifyOwner:function(a){var b=this,c=b.lastComponentSize,d=a.previousSize,e=[c.width,c.height];d&&e.push(d.width,d.height),b.owner.afterComponentLayout.apply(b.owner,e)},getTarget:function(){return this.owner.el},getRenderTarget:function(){return this.owner.el},cacheTargetInfo:function(a){var b=this,c=b.targetInfo,d;return c||(d=a.getEl("getTarget",b),b.targetInfo=c={padding:d.getPaddingInfo(),border:d.getBorderInfo()}),c},measureAutoDimensions:function(a,b){var c=this,d=c.owner,e=a.heightModel,f=a.widthModel,g=a.boxParent,h=a.isBoxParent,i=a.props,j,k={gotWidth:!1,gotHeight:!1,isContainer:j=!a.hasRawContent},l=b||3,m,n,o=0,p=0,q,r;return f.shrinkWrap&&a.consumersContentWidth?(++o,m=!(l&1),j?m?(k.contentWidth=0,k.gotWidth=!0,++p):(k.contentWidth=a.getProp("contentWidth"))!==undefined&&(k.gotWidth=!0,++p):(r=i.contentWidth,typeof r=="number"?(k.contentWidth=r,k.gotWidth=!0,++p):(m?q=!0:a.hasDomProp("containerChildrenDone")?h||!g||g.widthModel.shrinkWrap?q=!0:q=g.hasDomProp("width"):q=!1,q&&(isNaN(k.contentWidth=m?0:c.measureContentWidth(a))||(a.setContentWidth(k.contentWidth,!0),k.gotWidth=!0,++p))))):f.natural&&a.consumersWidth&&(++o,r=i.width,typeof r=="number"?(k.width=r,k.gotWidth=!0,++p):(h||!g?q=!0:q=g.hasDomProp("width"),q&&(isNaN(k.width=c.measureOwnerWidth(a))||(a.setWidth(k.width,!1),k.gotWidth=!0,++p)))),e.shrinkWrap&&a.consumersContentHeight?(++o,n=!(l&2),j?n?(k.contentHeight=0,k.gotHeight=!0,++p):(k.contentHeight=a.getProp("contentHeight"))!==undefined&&(k.gotHeight=!0,++p):(r=i.contentHeight,typeof r=="number"?(k.contentHeight=r,k.gotHeight=!0,++p):(n?q=!0:a.hasDomProp("containerChildrenDone")?d.noWrap?q=!0:f.shrinkWrap?h||!g||g.widthModel.shrinkWrap?q=!0:q=g.hasDomProp("width"):q=(a.bodyContext||a).hasDomProp("width"):q=!1,q&&(isNaN(k.contentHeight=n?0:c.measureContentHeight(a))||(a.setContentHeight(k.contentHeight,!0),k.gotHeight=!0,++p))))):e.natural&&a.consumersHeight&&(++o,r=i.height,typeof r=="number"?(k.height=r,k.gotHeight=!0,++p):(h||!g?q=!0:q=g.hasDomProp("width"),q&&(isNaN(k.height=c.measureOwnerHeight(a))||(a.setHeight(k.height,!1),k.gotHeight=!0,++p)))),g&&a.onBoxMeasured(),k.gotAll=p==o,k},measureContentWidth:function(a){return a.el.getWidth()-a.getFrameInfo().width},measureContentHeight:function(a){return a.el.getHeight()-a.getFrameInfo().height},measureOwnerHeight:function(a){return a.el.getHeight()},measureOwnerWidth:function(a){return a.el.getWidth()}}),Ext.define("Ext.layout.component.Auto",{alias:"layout.autocomponent",extend:"Ext.layout.component.Component",type:"autocomponent",setHeightInDom:!1,setWidthInDom:!1,waitForOuterHeightInDom:!1,waitForOuterWidthInDom:!1,beginLayoutCycle:function(a,b){var c=this,d=c.lastWidthModel,e=c.lastHeightModel,f=c.owner;c.callParent(arguments),d&&d.fixed&&a.widthModel.shrinkWrap&&f.el.setWidth(null),e&&e.fixed&&a.heightModel.shrinkWrap&&f.el.setHeight(null)},calculate:function(a){var b=this,c=b.measureAutoDimensions(a),d=a.heightModel,e=a.widthModel,f,g;c.gotWidth?e.shrinkWrap?b.publishOwnerWidth(a,c.contentWidth):b.publishInnerWidth&&b.publishInnerWidth(a,c.width):!e.auto&&b.publishInnerWidth&&(f=b.waitForOuterWidthInDom?a.getDomProp("width"):a.getProp("width"),f===undefined?b.done=!1:b.publishInnerWidth(a,f)),c.gotHeight?d.shrinkWrap?b.publishOwnerHeight(a,c.contentHeight):b.publishInnerHeight&&b.publishInnerHeight(a,c.height):!d.auto&&b.publishInnerHeight&&(g=b.waitForOuterHeightInDom?a.getDomProp("height"):a.getProp("height"),g===undefined?b.done=!1:b.publishInnerHeight(a,g)),c.gotAll||(b.done=!1)},calculateOwnerHeightFromContentHeight:function(a,b){return b+a.getFrameInfo().height},calculateOwnerWidthFromContentWidth:function(a,b){return b+a.getFrameInfo().width},onConstrainSize:function(a,b){var c=b.heightModel,d=b.widthModel;c&&(a.heightModel=c),d&&(a.widthModel=d)},publishOwnerHeight:function(a,b){var c=this,d=c.owner,e=c.calculateOwnerHeightFromContentHeight(a,b),f,g,h;isNaN(e)?c.done=!1:(g=Ext.Number.constrain(e,d.minHeight,d.maxHeight),g==e?h=c.setHeightInDom:(f=c.sizeModels[g<e?"constrainedMax":"constrainedMin"],e=g,a.heightModel.calculatedFromShrinkWrap?a.heightModel=f:a.invalidate({before:c.onConstrainSize,heightModel:f})),a.setHeight(e,h))},publishOwnerWidth:function(a,b){var c=this,d=c.owner,e=c.calculateOwnerWidthFromContentWidth(a,b),f,g,h;isNaN(e)?c.done=!1:(g=Ext.Number.constrain(e,d.minWidth,d.maxWidth),g==e?h=c.setWidthInDom:(f=c.sizeModels[g<e?"constrainedMax":"constrainedMin"],e=g,a.widthModel.calculatedFromShrinkWrap?a.widthModel=f:a.invalidate({before:c.onConstrainSize,widthModel:f})),a.setWidth(e,h))}}),Ext.define("Ext.layout.component.Draw",{alias:"layout.draw",extend:"Ext.layout.component.Auto",type:"draw",measureContentWidth:function(a){var b=a.target,c=b.surface,d=a.getPaddingInfo(),e=a.surfaceBBox||(a.surfaceBBox=c.items.getBBox());return b.viewBox?a.heightModel.shrinkWrap?d.width:e.width/e.height*(a.getProp("contentHeight")-d.height)+d.width:b.autoSize?e.width+d.width:e.x+e.width+d.width},measureContentHeight:function(a){var b=a.target,c=b.surface,d=a.getPaddingInfo(),e=a.surfaceBBox||(a.surfaceBBox=c.items.getBBox());return a.target.viewBox?a.widthModel.shrinkWrap?d.height:e.height/e.width*(a.getProp("contentWidth")-d.width)+d.height:b.autoSize?e.height+d.height:e.y+e.height+d.height},publishInnerWidth:function(a,b){a.setContentWidth(b-a.getFrameInfo().width,!0)},publishInnerHeight:function(a,b){a.setContentHeight(b-a.getFrameInfo().height,!0)},finishedLayout:function(a){var b=a.props,c=a.getPaddingInfo();this.owner.setSurfaceSize(b.contentWidth-c.width,b.contentHeight-c.height),this.callParent(arguments)}}),Ext.define("Ext.state.Provider",{mixins:{observable:"Ext.util.Observable"},prefix:"ext-",constructor:function(a){a=a||{};var b=this;Ext.apply(b,a),b.addEvents("statechange"),b.state={},b.mixins.observable.constructor.call(b)},get:function(a,b){return typeof this.state[a]=="undefined"?b:this.state[a]},clear:function(a){var b=this;delete b.state[a],b.fireEvent("statechange",b,a,null)},set:function(a,b){var c=this;c.state[a]=b,c.fireEvent("statechange",c,a,b)},decodeValue:function(a){var b=this,c=/^(a|n|d|b|s|o|e)\:(.*)$/,d=c.exec(unescape(a)),e,f,g,h,i,j;if(!d||!d[1])return;f=d[1],a=d[2];switch(f){case"e":return null;case"n":return parseFloat(a);case"d":return new Date(Date.parse(a));case"b":return a=="1";case"a":e=[];if(a!=""){h=a.split("^"),i=h.length;for(j=0;j<i;j++)a=h[j],e.push(b.decodeValue(a))}return e;case"o":e={};if(a!=""){h=a.split("^"),i=h.length;for(j=0;j<i;j++)a=h[j],g=a.split("="),e[g[0]]=b.decodeValue(g[1])}return e;default:return a}},encodeValue:function(a){var b="",c=0,d,e,f;if(a==null)return"e:1";if(typeof a=="number")d="n:"+a;else if(typeof a=="boolean")d="b:"+(a?"1":"0");else if(Ext.isDate(a))d="d:"+a.toGMTString();else if(Ext.isArray(a)){for(e=a.length;c<e;c++)b+=this.encodeValue(a[c]),c!=e-1&&(b+="^");d="a:"+b}else if(typeof a=="object"){for(f in a)typeof a[f]!="function"&&a[f]!==undefined&&(b+=f+"="+this.encodeValue(a[f])+"^");d="o:"+b.substring(0,b.length-1)}else d="s:"+a;return escape(d)}}),Ext.define("Ext.state.CookieProvider",{extend:"Ext.state.Provider",constructor:function(a){var b=this;b.path="/",b.expires=new Date((new Date).getTime()+6048e5),b.domain=null,b.secure=!1,b.callParent(arguments),b.state=b.readCookies()},set:function(a,b){var c=this;if(typeof b=="undefined"||b===null){c.clear(a);return}c.setCookie(a,b),c.callParent(arguments)},clear:function(a){this.clearCookie(a),this.callParent(arguments)},readCookies:function(){var a={},b=document.cookie+";",c=/\s?(.*?)=(.*?);/g,d=this.prefix,e=d.length,f,g,h;while((f=c.exec(b))!=null)g=f[1],h=f[2],g&&g.substring(0,e)==d&&(a[g.substr(e)]=this.decodeValue(h));return a},setCookie:function(a,b){var c=this;document.cookie=c.prefix+a+"="+c.encodeValue(b)+(c.expires==null?"":"; expires="+c.expires.toGMTString())+(c.path==null?"":"; path="+c.path)+(c.domain==null?"":"; domain="+c.domain)+(c.secure==1?"; secure":"")},clearCookie:function(a){var b=this;document.cookie=b.prefix+a+"=null; expires=Thu, 01-Jan-70 00:00:01 GMT"+(b.path==null?"":"; path="+b.path)+(b.domain==null?"":"; domain="+b.domain)+(b.secure==1?"; secure":"")}}),Ext.define("Ext.state.LocalStorageProvider",{extend:"Ext.state.Provider",alias:"state.localstorage",constructor:function(){var a=this;a.callParent(arguments),a.store=a.getStorageObject(),a.state=a.readLocalStorage()},readLocalStorage:function(){var a=this.store,b=0,c=a.length,d=this.prefix,e=d.length,f={},g;for(;b<c;++b)g=a.key(b),g.substring(0,e)==d&&(f[g.substr(e)]=this.decodeValue(a.getItem(g)));return f},set:function(a,b){var c=this;c.clear(a);if(typeof b=="undefined"||b===null)return;c.store.setItem(c.prefix+a,c.encodeValue(b)),c.callParent(arguments)},clear:function(a){this.store.removeItem(this.prefix+a),this.callParent(arguments)},getStorageObject:function(){try{var a="localStorage"in window&&window.localStorage!==null;if(a)return window.localStorage}catch(b){return!1}}}),Ext.define("Ext.state.Manager",{singleton:!0,requires:["Ext.state.Provider"],constructor:function(){this.provider=new Ext.state.Provider},setProvider:function(a){this.provider=a},get:function(a,b){return this.provider.get(a,b)},set:function(a,b){this.provider.set(a,b)},clear:function(a){this.provider.clear(a)},getProvider:function(){return this.provider}}),Ext.define("Ext.state.Stateful",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.state.Manager"],stateful:!1,saveDelay:100,constructor:function(a){var b=this;a=a||{},a.stateful!==undefined&&(b.stateful=a.stateful),a.saveDelay!==undefined&&(b.saveDelay=a.saveDelay),b.stateId=b.stateId||a.stateId,b.stateEvents||(b.stateEvents=[]),a.stateEvents&&b.stateEvents.concat(a.stateEvents),this.addEvents("beforestaterestore","staterestore","beforestatesave","statesave"),b.mixins.observable.constructor.call(b),b.stateful!==!1&&(b.addStateEvents(b.stateEvents),b.initState())},addStateEvents:function(a){var b=this,c,d,e;if(b.stateful&&b.getStateId()){typeof a=="string"&&(a=Array.prototype.slice.call(arguments,0)),e=b.stateEventsByName||(b.stateEventsByName={});for(c=a.length;c--;)d=a[c],e[d]||(e[d]=1,b.on(d,b.onStateChange,b))}},onStateChange:function(){var a=this,b=a.saveDelay,c,d;if(!a.stateful)return;b?(a.stateTask||(c=Ext.state.Stateful,d=c.runner||(c.runner=new Ext.util.TaskRunner),a.stateTask=d.newTask({run:a.saveState,scope:a,interval:b,repeat:1})),a.stateTask.start()):a.saveState()},saveState:function(){var a=this,b=a.stateful&&a.getStateId(),c=a.hasListeners,d;if(b){d=a.getState()||{};if(!c.beforestatesave||a.fireEvent("beforestatesave",a,d)!==!1)Ext.state.Manager.set(b,d),c.statesave&&a.fireEvent("statesave",a,d)}},getState:function(){return null},applyState:function(a){a&&Ext.apply(this,a)},getStateId:function(){var a=this;return a.stateId||(a.autoGenId?null:a.id)},initState:function(){var a=this,b=a.stateful&&a.getStateId(),c=a.hasListeners,d;if(b){d=Ext.state.Manager.get(b);if(d){d=Ext.apply({},d);if(!c.beforestaterestore||a.fireEvent("beforestaterestore",a,d)!==!1)a.applyState(d),c.staterestore&&a.fireEvent("staterestore",a,d)}}},savePropToState:function(a,b,c){var d=this,e=d[a],f=d.initialConfig;if(d.hasOwnProperty(a))if(!f||f[a]!==e)return b&&(b[c||a]=e),!0;return!1},savePropsToState:function(a,b){var c=this,d,e;if(typeof a=="string")c.savePropToState(a,b);else for(d=0,e=a.length;d<e;++d)c.savePropToState(a[d],b);return b},destroy:function(){var a=this,b=a.stateTask;b&&(b.destroy(),a.stateTask=null),a.clearListeners()}}),Ext.define("Ext.util.AbstractMixedCollection",{requires:["Ext.util.Filter"],mixins:{observable:"Ext.util.Observable"},isMixedCollection:!0,generation:0,constructor:function(a,b){var c=this;c.items=[],c.map={},c.keys=[],c.length=0,c.allowFunctions=a===!0,b&&(c.getKey=b),c.mixins.observable.constructor.call(c)},allowFunctions:!1,add:function(a,b){var c=this,d=b,e=a,f;arguments.length==1&&(d=e,e=c.getKey(d));if(typeof e!="undefined"&&e!==null){f=c.map[e];if(typeof f!="undefined")return c.replace(e,d);c.map[e]=d}return c.generation++,c.length++,c.items.push(d),c.keys.push(e),c.hasListeners.add&&c.fireEvent("add",c.length-1,d,e),d},getKey:function(a){return a.id},replace:function(a,b){var c=this,d,e;return arguments.length==1&&(b=arguments[0],a=c.getKey(b)),d=c.map[a],typeof a=="undefined"||a===null||typeof d=="undefined"?c.add(a,b):(c.generation++,e=c.indexOfKey(a),c.items[e]=b,c.map[a]=b,c.hasListeners.replace&&c.fireEvent("replace",a,d,b),b)},addAll:function(a){var b=this,c=0,d,e,f;if(arguments.length>1||Ext.isArray(a)){d=arguments.length>1?arguments:a;for(e=d.length;c<e;c++)b.add(d[c])}else for(f in a)a.hasOwnProperty(f)&&(b.allowFunctions||typeof a[f]!="function")&&b.add(f,a[f])},each:function(a,b){var c=[].concat(this.items),d=0,e=c.length,f;for(;d<e;d++){f=c[d];if(a.call(b||f,f,d,e)===!1)break}},eachKey:function(a,b){var c=this.keys,d=this.items,e=0,f=c.length;for(;e<f;e++)a.call(b||window,c[e],d[e],e,f)},findBy:function(a,b){var c=this.keys,d=this.items,e=0,f=d.length;for(;e<f;e++)if(a.call(b||window,d[e],c[e]))return d[e];return null},find:function(){return Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.util.MixedCollection: find has been deprecated. Use findBy instead."),this.findBy.apply(this,arguments)},insert:function(a,b,c){var d=this,e=b,f=c;return arguments.length==2&&(f=e,e=d.getKey(f)),d.containsKey(e)&&(d.suspendEvents(),d.removeAtKey(e),d.resumeEvents()),a>=d.length?d.add(e,f):(d.generation++,d.length++,Ext.Array.splice(d.items,a,0,f),typeof e!="undefined"&&e!==null&&(d.map[e]=f),Ext.Array.splice(d.keys,a,0,e),d.hasListeners.add&&d.fireEvent("add",a,f,e),f)},remove:function(a){return this.generation++,this.removeAt(this.indexOf(a))},removeAll:function(a){a=[].concat(a);var b,c=a.length;for(b=0;b<c;b++)this.remove(a[b]);return this},removeAt:function(a){var b=this,c,d;return a<b.length&&a>=0?(b.length--,c=b.items[a],Ext.Array.erase(b.items,a,1),d=b.keys[a],typeof d!="undefined"&&delete b.map[d],Ext.Array.erase(b.keys,a,1),b.hasListeners.remove&&b.fireEvent("remove",c,d),b.generation++,c):!1},removeAtKey:function(a){return this.removeAt(this.indexOfKey(a))},getCount:function(){return this.length},indexOf:function(a){return Ext.Array.indexOf(this.items,a)},indexOfKey:function(a){return Ext.Array.indexOf(this.keys,a)},get:function(a){var b=this,c=b.map[a],d=c!==undefined?c:typeof a=="number"?b.items[a]:undefined;return typeof d!="function"||b.allowFunctions?d:null},getAt:function(a){return this.items[a]},getByKey:function(a){return this.map[a]},contains:function(a){return typeof this.map[this.getKey(a)]!="undefined"},containsKey:function(a){return typeof this.map[a]!="undefined"},clear:function(){var a=this;a.length=0,a.items=[],a.keys=[],a.map={},a.generation++,a.hasListeners.clear&&a.fireEvent("clear")},first:function(){return this.items[0]},last:function(){return this.items[this.length-1]},sum:function(a,b,c,d){var e=this.extractValues(a,b),f=e.length,g=0,h;c=c||0,d=d||d===0?d:f-1;for(h=c;h<=d;h++)g+=e[h];return g},collect:function(a,b,c){var d=this.extractValues(a,b),e=d.length,f={},g=[],h,i,j;for(j=0;j<e;j++)h=d[j],i=String(h),(c||!Ext.isEmpty(h))&&!f[i]&&(f[i]=!0,g.push(h));return g},extractValues:function(a,b){var c=this.items;return b&&(c=Ext.Array.pluck(c,b)),Ext.Array.pluck(c,a)},getRange:function(a,b){var c=this,d=c.items,e=[],f;if(d.length<1)return e;a=a||0,b=Math.min(typeof b=="undefined"?c.length-1:b,c.length-1);if(a<=b)for(f=a;f<=b;f++)e[e.length]=d[f];else for(f=a;f>=b;f--)e[e.length]=d[f];return e},filter:function(a,b,c,d){var e=[],f;if(Ext.isString(a))e.push(new Ext.util.Filter({property:a,value:b,anyMatch:c,caseSensitive:d}));else if(Ext.isArray(a)||a instanceof Ext.util.Filter)e=e.concat(a);return f=function(a){var b=!0,c=e.length,d,f,g,h;for(d=0;d<c;d++)f=e[d],g=f.filterFn,h=f.scope,b=b&&g.call(h,a);return b},this.filterBy(f)},filterBy:function(a,b){var c=this,d=new this.self,e=c.keys,f=c.items,g=f.length,h;d.getKey=c.getKey;for(h=0;h<g;h++)a.call(b||c,f[h],e[h])&&d.add(e[h],f[h]);return d},findIndex:function(a,b,c,d,e){return Ext.isEmpty(b,!1)?-1:(b=this.createValueMatcher(b,d,e),this.findIndexBy(function(c){return c&&b.test(c[a])},null,c))},findIndexBy:function(a,b,c){var d=this,e=d.keys,f=d.items,g=c||0,h=f.length;for(;g<h;g++)if(a.call(b||d,f[g],e[g]))return g;return-1},createValueMatcher:function(a,b,c,d){if(!a.exec){var e=Ext.String.escapeRegex;a=String(a),b===!0?a=e(a):(a="^"+e(a),d===!0&&(a+="$")),a=new RegExp(a,c?"":"i")}return a},clone:function(){var a=this,b=new this.self,c=a.keys,d=a.items,e=0,f=d.length;for(;e<f;e++)b.add(c[e],d[e]);return b.getKey=a.getKey,b}}),Ext.define("Ext.util.Grouper",{extend:"Ext.util.Sorter",getGroupString:function(a){return a.get(this.property)}}),Ext.define("Ext.util.HashMap",{mixins:{observable:"Ext.util.Observable"},constructor:function(a){a=a||{};var b=this,c=a.keyFn;b.addEvents("add","clear","remove","replace"),b.mixins.observable.constructor.call(b,a),b.clear(!0),c&&(b.getKey=c)},getCount:function(){return this.length},getData:function(a,b){return b===undefined&&(b=a,a=this.getKey(b)),[a,b]},getKey:function(a){return a.id},add:function(a,b){var c=this;return b===undefined&&(b=a,a=c.getKey(b)),c.containsKey(a)?c.replace(a,b):(c.map[a]=b,++c.length,c.hasListeners.add&&c.fireEvent("add",c,a,b),b)},replace:function(a,b){var c=this,d=c.map,e;return b===undefined&&(b=a,a=c.getKey(b)),c.containsKey(a)||c.add(a,b),e=d[a],d[a]=b,c.hasListeners.replace&&c.fireEvent("replace",c,a,b,e),b},remove:function(a){var b=this.findKey(a);return b!==undefined?this.removeAtKey(b):!1},removeAtKey:function(a){var b=this,c;return b.containsKey(a)?(c=b.map[a],delete b.map[a],--b.length,b.hasListeners.remove&&b.fireEvent("remove",b,a,c),!0):!1},get:function(a){return this.map[a]},clear:function(a){var b=this;return b.map={},b.length=0,a!==!0&&b.hasListeners.clear&&b.fireEvent("clear",b),b},containsKey:function(a){return this.map[a]!==undefined},contains:function(a){return this.containsKey(this.findKey(a))},getKeys:function(){return this.getArray(!0)},getValues:function(){return this.getArray(!1)},getArray:function(a){var b=[],c,d=this.map;for(c in d)d.hasOwnProperty(c)&&b.push(a?c:d[c]);return b},each:function(a,b){var c=Ext.apply({},this.map),d,e=this.length;b=b||this;for(d in c)if(c.hasOwnProperty(d)&&a.call(b,d,c[d],e)===!1)break;return this},clone:function(){var a=new this.self,b=this.map,c;a.suspendEvents();for(c in b)b.hasOwnProperty(c)&&a.add(c,b[c]);return a.resumeEvents(),a},findKey:function(a){var b,c=this.map;for(b in c)if(c.hasOwnProperty(b)&&c[b]===a)return b;return undefined}}),Ext.define("Ext.AbstractManager",{requires:["Ext.util.HashMap"],typeName:"type",constructor:function(a){Ext.apply(this,a||{}),this.all=new Ext.util.HashMap,this.types={}},get:function(a){return this.all.get(a)},register:function(a){this.all.add(a)},unregister:function(a){this.all.remove(a)},registerType:function(a,b){this.types[a]=b,b[this.typeName]=a},isRegistered:function(a){return this.types[a]!==undefined},create:function(a,b){var c=a[this.typeName]||a.type||b,d=this.types[c];return new d(a)},onAvailable:function(a,b,c){var d=this.all,e;d.containsKey(a)?(e=d.get(a),b.call(c||e,e)):d.on("add",function(e,f,g){f==a&&(b.call(c||g,g),d.un("add",b,c))})},each:function(a,b){this.all.each(a,b||this)},getCount:function(){return this.all.getCount()}}),Ext.define("Ext.ComponentManager",{extend:"Ext.AbstractManager",alternateClassName:"Ext.ComponentMgr",singleton:!0,typeName:"xtype",create:function(a,b){return typeof a=="string"?Ext.widget(a):a.isComponent?a:Ext.widget(a.xtype||b,a)},registerType:function(a,b){this.types[a]=b,b[this.typeName]=a,b.prototype[this.typeName]=a}}),Ext.define("Ext.AbstractComponent",{requires:["Ext.ComponentQuery","Ext.ComponentManager","Ext.util.ProtoElement"],mixins:{observable:"Ext.util.Observable",animate:"Ext.util.Animate",elementCt:"Ext.util.ElementContainer",renderable:"Ext.util.Renderable",state:"Ext.state.Stateful"},uses:["Ext.PluginManager","Ext.Element","Ext.DomHelper","Ext.XTemplate","Ext.ComponentQuery","Ext.ComponentLoader","Ext.EventManager","Ext.layout.Context","Ext.layout.Layout","Ext.layout.component.Auto","Ext.LoadMask","Ext.ZIndexManager"],statics:{AUTO_ID:1e3,pendingLayouts:null,layoutSuspendCount:0,cancelLayout:function(a){var b=this.runningLayoutContext||this.pendingLayouts;b&&b.cancelComponent(a)},flushLayouts:function(){var a=this,b=a.pendingLayouts;b&&b.invalidQueue.length&&(a.pendingLayouts=null,a.runningLayoutContext=b,Ext.override(b,{runComplete:function(){return a.runningLayoutContext=null,this.callParent()}}),b.run())},resumeLayouts:function(a){this.layoutSuspendCount&&!--this.layoutSuspendCount&&a&&this.flushLayouts()},suspendLayouts:function(){++this.layoutSuspendCount},updateLayout:function(a,b){var c=this,d=c.runningLayoutContext,e;d?d.queueInvalidate(a):(e=c.pendingLayouts||(c.pendingLayouts=new Ext.layout.Context),e.queueInvalidate(a),!b&&!c.layoutSuspendCount&&!a.isLayoutSuspended()&&c.flushLayouts())}},isComponent:!0,getAutoId:function(){return this.autoGenId=!0,++Ext.AbstractComponent.AUTO_ID},deferLayouts:!1,autoGenId:!1,renderTpl:"{%this.renderContent(out,values)%}",frameSize:{left:0,top:0,right:0,bottom:0,width:0,height:0},tplWriteMode:"overwrite",baseCls:Ext.baseCSSPrefix+"component",disabledCls:Ext.baseCSSPrefix+"item-disabled",ui:"default",uiCls:[],hidden:!1,disabled:!1,draggable:!1,floating:!1,hideMode:"display",styleHtmlContent:!1,styleHtmlCls:Ext.baseCSSPrefix+"html",autoShow:!1,autoRender:!1,allowDomMove:!0,rendered:!1,componentLayoutCounter:0,shrinkWrap:2,weight:0,maskOnDisable:!0,_isLayoutRoot:!1,constructor:function(a){var b=this,c,d,e;a?(Ext.apply(b,a),e=b.xhooks,e&&(delete b.xhooks,Ext.override(b,e))):a={},b.initialConfig=a,b.mixins.elementCt.constructor.call(b),b.addEvents("beforeactivate","activate","beforedeactivate","deactivate","added","disable","enable","beforeshow","show","beforehide","hide","removed","beforerender","render","afterrender","boxready","beforedestroy","destroy","resize","move","focus","blur"),b.getId(),b.setupProtoEl(),b.cls&&(b.initialCls=b.cls,b.protoEl.addCls(b.cls)),b.style&&(b.initialStyle=b.style,b.protoEl.setStyle(b.style)),b.mons=[],b.renderData=b.renderData||{},b.renderSelectors=b.renderSelectors||{},b.plugins&&(b.plugins=[].concat(b.plugins),b.constructPlugins()),b.hasListeners||(b.hasListeners=new b.HasListeners),b.initComponent(),Ext.ComponentManager.register(b),b.mixins.observable.constructor.call(b),b.mixins.state.constructor.call(b,a),this.addStateEvents("resize");if(b.plugins){b.plugins=[].concat(b.plugins);for(c=0,d=b.plugins.length;c<d;c++)b.plugins[c]=b.initPlugin(b.plugins[c])}b.loader=b.getLoader(),b.renderTo&&b.render(b.renderTo),b.autoShow&&b.show()},initComponent:function(){this.constructPlugins(),this.setSize(this.width,this.height)},getState:function(){var a=this,b=null,c=a.getSizeModel();return c.width.configured&&(b=a.addPropertyToState(b,"width")),c.height.configured&&(b=a.addPropertyToState(b,"height")),b},addPropertyToState:function(a,b,c){var d=this,e=arguments.length;if(e==3||d.hasOwnProperty(b))e<3&&(c=d[b]),c!==d.initialConfig[b]&&((a||(a={}))[b]=c);return a},show:Ext.emptyFn,animate:function(a){var b=this,c,d,e,f,g,h,i,j,k,l,m,n;return a=a||{},g=a.to||{},Ext.fx.Manager.hasFxBlock(b.id)?b:(c=Ext.isDefined(g.width),c&&(f=Ext.Number.constrain(g.width,b.minWidth,b.maxWidth)),d=Ext.isDefined(g.height),d&&(e=Ext.Number.constrain(g.height,b.minHeight,b.maxHeight)),!a.dynamic&&(c||d)&&(j=(a.from?a.from.width:undefined)||b.getWidth(),k=j,l=(a.from?a.from.height:undefined)||b.getHeight(),m=l,n=!1,d&&e>l&&(m=e,n=!0),c&&f>j&&(k=f,n=!0),n&&(h=!Ext.isNumber(b.width),i=!Ext.isNumber(b.height),b.setSize(k,m),b.el.setSize(j,l),h&&delete b.width,i&&delete b.height),c&&(g.width=f),d&&(g.height=e)),b.mixins.animate.animate.apply(b,arguments))},onHide:function(){this.updateLayout({isRoot:!1})},onShow:function(){this.updateLayout({isRoot:!1})},constructPlugin:function(a){return a.ptype&&typeof a.init!="function"?(a.cmp=this,a=Ext.PluginManager.create(a)):typeof a=="string"&&(a=Ext.PluginManager.create({ptype:a,cmp:this})),a},constructPlugins:function(){var a=this,b=a.plugins,c,d;if(b)for(c=0,d=b.length;c<d;c++)b[c]=a.constructPlugin(b[c])},initPlugin:function(a){return a.init(this),a},updateAria:Ext.emptyFn,registerFloatingItem:function(a){var b=this;b.floatingItems||(b.floatingItems=new Ext.ZIndexManager(b)),b.floatingItems.register(a)},unregisterFloatingItem:function(a){var b=this;b.floatingItems&&b.floatingItems.unregister(a)},layoutSuspendCount:0,suspendLayouts:function(){var a=this;if(!a.rendered)return;++a.layoutSuspendCount==1&&(a.suspendLayout=!0)},resumeLayouts:function(a){var b=this;if(!b.rendered)return;--b.layoutSuspendCount||(b.suspendLayout=!1,a&&!b.isLayoutSuspended()&&b.updateLayout(a))},setupProtoEl:function(){var a=this,b=[a.baseCls,a.getComponentLayout().targetCls];Ext.isDefined(a.cmpCls)&&(Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.Component: cmpCls has been deprecated. Please use componentCls."),a.componentCls=a.cmpCls,delete a.cmpCls),a.componentCls?b.push(a.componentCls):a.componentCls=a.baseCls,a.protoEl=new Ext.util.ProtoElement({cls:b.join(" ")})},setUI:function(a){var b=this,c=Ext.Array.clone(b.uiCls),d=[],e=[],f,g;for(g=0;g<c.length;g++)f=c[g],e=e.concat(b.removeClsWithUI(f,!0)),d.push(f);e.length&&b.removeCls(e),b.removeUIFromElement(),b.ui=a,b.addUIToElement(),e=[];for(g=0;g<d.length;g++)f=d[g],e=e.concat(b.addClsWithUI(f,!0));e.length&&b.addCls(e),b.rendered&&b.updateLayout()},addClsWithUI:function(a,b){var c=this,d=[],e,f=0,g;typeof a=="string"&&(a=a.indexOf(" ")<0?[a]:Ext.String.splitWords(a)),e=a.length,c.uiCls=Ext.Array.clone(c.uiCls);for(;f<e;f++)g=a[f],g&&!c.hasUICls(g)&&(c.uiCls.push(g),d=d.concat(c.addUIClsToElement(g)));return b!==!0&&c.addCls(d),d},removeClsWithUI:function(a,b){var c=this,d=[],e=0,f,g;typeof a=="string"&&(a=a.indexOf(" ")<0?[a]:Ext.String.splitWords(a)),f=a.length;for(e=0;e<f;e++)g=a[e],g&&c.hasUICls(g)&&(c.uiCls=Ext.Array.remove(c.uiCls,g),d=d.concat(c.removeUIClsFromElement(g)));return b!==!0&&c.removeCls(d),d},hasUICls:function(a){var b=this,c=b.uiCls||[];return Ext.Array.contains(c,a)},frameElementsArray:["tl","tc","tr","ml","mc","mr","bl","bc","br"],addUIClsToElement:function(a){var b=this,c=b.baseCls+"-"+b.ui+"-"+a,d=[Ext.baseCSSPrefix+a,b.baseCls+"-"+a,c],e=b.frameElementCls,f,g,h,i,j,k;if(b.frame&&!Ext.supports.CSS3BorderRadius){f=b.frameElementsArray,g=f.length,h=0;for(;h<g;h++)j=f[h],i=b["frame"+j.toUpperCase()],k=c+"-"+j,i&&i.dom?i.addCls(k):Ext.Array.indexOf(e[j],k)==-1&&e[j].push(k)}return b.frameElementCls=e,d},removeUIClsFromElement:function(a){var b=this,c=b.baseCls+"-"+b.ui+"-"+a,d=[Ext.baseCSSPrefix+a,b.baseCls+"-"+a,c],e=b.frameElementCls,f,g,h,i,j,k;if(b.frame&&!Ext.supports.CSS3BorderRadius){f=b.frameElementsArray,g=f.length,h=0;for(;h<g;h++)j=f[h],i=b["frame"+j.toUpperCase()],k=c+"-"+j,i&&i.dom?i.addCls(k):Ext.Array.remove(e[j],k)}return b.frameElementCls=e,d},addUIToElement:function(){var a=this,b=a.baseCls+"-"+a.ui,c=a.frameElementCls,d,e,f,g,h,i;a.addCls(b);if(a.frame&&!Ext.supports.CSS3BorderRadius){d=a.frameElementsArray,e=d.length,f=0;for(;f<e;f++)h=d[f],g=a["frame"+h.toUpperCase()],i=b+"-"+h,g?g.addCls(i):Ext.Array.contains(c[h],i)||c[h].push(i)}},removeUIFromElement:function(){var a=this,b=a.baseCls+"-"+a.ui,c=a.frameElementCls,d,e,f,g,h,i;a.removeCls(b);if(a.frame&&!Ext.supports.CSS3BorderRadius){d=a.frameElementsArray,e=d.length,f=0;for(;f<e;f++)h=d[f],g=a["frame"+h.toUpperCase()],i=b+"-"+h,g?g.removeCls(i):Ext.Array.remove(c[h],i)}},getTpl:function(a){return Ext.XTemplate.getTpl(this,a)},initStyles:function(a){var b=this,c=Ext.Element,d=b.padding,e=b.margin,f=b.x,g=b.y,h,i;d!==undefined&&a.setStyle("padding",c.unitizeBox(d===!0?5:d)),e!==undefined&&a.setStyle("margin",c.unitizeBox(e===!0?5:e)),b.border!==undefined&&b.setBorder(b.border,a),b.cls&&b.cls!=b.initialCls&&(a.addCls(b.cls),delete b.cls,delete b.initialCls),b.style&&b.style!=b.initialStyle&&(a.setStyle(b.style),delete b.style,delete b.initialStyle),f!==undefined&&a.setStyle("left",f+"px"),g!==undefined&&a.setStyle("top",g+"px"),!b.getFrameInfo()&&Ext.isBorderBox&&(h=b.width,i=b.height,h!==undefined&&a.setStyle("width",typeof h=="number"?h+"px":h),i!==undefined&&a.setStyle("height",typeof i=="number"?i+"px":i))},initEvents:function(){var a=this,b=a.afterRenderEvents,c,d,e=function(b){a.mon(c,b)};if(b)for(d in b)b.hasOwnProperty(d)&&(c=a[d],c&&c.on&&Ext.each(b[d],e));a.addFocusListener()},addFocusListener:function(){var a=this,b=a.getFocusEl(),c;if(b){if(b.isComponent)return b.addFocusListener();c=b.needsTabIndex(),!a.focusListenerAdded&&(!c||Ext.FocusManager.enabled)&&(c&&(b.dom.tabIndex=-1),b.on({focus:a.onFocus,blur:a.onBlur,scope:a}),a.focusListenerAdded=!0)}},getFocusEl:Ext.emptyFn,isFocusable:function(a){var b=this,c;if(b.focusable!==!1&&(c=b.getFocusEl())&&b.rendered&&!b.destroying&&!b.isDestroyed&&!b.disabled&&b.isVisible(!0))return c.isComponent?c.isFocusable():c&&c.dom&&c.isVisible()},preFocus:Ext.emptyFn,onFocus:function(a){var b=this,c=b.focusCls,d=b.getFocusEl();b.disabled||(b.preFocus(a),c&&d&&d.addCls(b.addClsWithUI(c,!0)),b.hasFocus||(b.hasFocus=!0,b.fireEvent("focus",b,a)))},beforeBlur:Ext.emptyFn,onBlur:function(a){var b=this,c=b.focusCls,d=b.getFocusEl();if(b.destroying)return;b.beforeBlur(a),c&&d&&d.removeCls(b.removeClsWithUI(c,!0)),b.validateOnBlur&&b.validate(),b.hasFocus=!1,b.fireEvent("blur",b,a),b.postBlur(a)},postBlur:Ext.emptyFn,is:function(a){return Ext.ComponentQuery.is(this,a)},up:function(a){var b=this.getBubbleTarget();if(a)for(;b;b=b.getBubbleTarget())if(Ext.ComponentQuery.is(b,a))return b;return b},nextSibling:function(a){var b=this.ownerCt,c,d,e,f;if(b){c=b.items,e=c.indexOf(this)+1;if(e)if(a){for(d=c.getCount();e<d;e++)if((f=c.getAt(e)).is(a))return f}else if(e<c.getCount())return c.getAt(e)}return null},previousSibling:function(a){var b=this.ownerCt,c,d,e;if(b){c=b.items,d=c.indexOf(this);if(d!=-1)if(a){for(--d;d>=0;d--)if((e=c.getAt(d)).is(a))return e}else if(d)return c.getAt(--d)}return null},previousNode:function(a,b){var c=this,d,e,f,g;if(b&&c.is(a))return c;if(c.ownerCt){for(e=c.ownerCt.items.items,f=Ext.Array.indexOf(e,c)-1;f>-1;f--){g=e[f];if(g.query){d=g.query(a),d=d[d.length-1];if(d)return d;if(g.is(a))return g}}return c.ownerCt.previousNode(a,!0)}},nextNode:function(a,b){var c=this,d,e,f,g,h;if(b&&c.is(a))return c;if(c.ownerCt){for(e=c.ownerCt.items,g=e.indexOf(c)+1,e=e.items,f=e.length;g<f;g++){h=e[g];if(h.is(a))return h;if(h.down){d=h.down(a);if(d)return d}}return c.ownerCt.nextNode(a)}},getId:function(){return this.id||(this.id="ext-comp-"+this.getAutoId())},getItemId:function(){return this.itemId||this.id},getEl:function(){return this.el},getTargetEl:function(){return this.frameBody||this.el},getOverflowStyle:function(){var a=this,b=null;if(typeof a.autoScroll=="boolean")b={overflow:a.autoScroll?"auto":""};else if(a.overflowX!==undefined||a.overflowY!==undefined)b={"overflow-x":a.overflowX||"","overflow-y":a.overflowY||""};return b&&(Ext.isIE6||Ext.isIE7)&&(b.position="relative"),b},isXType:function(a,b){return b?this.xtype===a:this.xtypesMap[a]},getXTypes:function(){var a=this.self,b,c,d;if(!a.xtypes){b=[],c=this;while(c)d=c.xtypes,d!==undefined&&b.unshift.apply(b,d),c=c.superclass;a.xtypeChain=b,a.xtypes=b.join("/")}return a.xtypes},update:function(a,b,c){var d=this;d.tpl&&!Ext.isString(a)?(d.data=a,d.rendered&&d.tpl[d.tplWriteMode](d.getTargetEl(),a||{})):(d.html=Ext.isObject(a)?Ext.DomHelper.markup(a):a,d.rendered&&d.getTargetEl().update(d.html,b,c)),d.rendered&&d.updateLayout()},setVisible:function(a){return this[a?"show":"hide"]()},isVisible:function(a){var b=this,c=b,d=b.rendered&&!b.hidden,e=b.ownerCt;b.hiddenAncestor=!1;if(b.destroyed)return!1;if(a&&d&&e)while(e){if(e.hidden||e.collapsed&&(!e.getDockedItems||!Ext.Array.contains(e.getDockedItems(),c))){b.hiddenAncestor=e,d=!1;break}c=e,e=e.ownerCt}return d},onBoxReady:function(){var a=this;a.disableOnBoxReady?a.onDisable():a.enableOnBoxReady&&a.onEnable(),a.resizable&&a.initResizable(a.resizable),a.draggable&&a.initDraggable()},enable:function(a){var b=this;return delete b.disableOnBoxReady,b.removeCls(b.disabledCls),b.rendered?b.onEnable():b.enableOnBoxReady=!0,b.disabled=!1,delete b.resetDisable,a!==!0&&b.fireEvent("enable",b),b},disable:function(a){var b=this;return delete b.enableOnBoxReady,b.addCls(b.disabledCls),b.rendered?b.onDisable():b.disableOnBoxReady=!0,b.disabled=!0,a!==!0&&(delete b.resetDisable,b.fireEvent("disable",b)),b},onEnable:function(){this.maskOnDisable&&(this.el.dom.disabled=!1,this.unmask())},onDisable:function(){this.maskOnDisable&&(this.el.dom.disabled=!0,this.mask())},mask:function(){var a=this.lastBox,b=this.getMaskTarget(),c=[];a&&(c[2]=a.height),b.mask.apply(b,c)},unmask:function(){this.getMaskTarget().unmask()},getMaskTarget:function(){return this.el},isDisabled:function(){return this.disabled},setDisabled:function(a){return this[a?"disable":"enable"]()},isHidden:function(){return this.hidden},addCls:function(a){var b=this,c=b.rendered?b.el:b.protoEl;return c.addCls.apply(c,arguments),b},addClass:function(){return this.addCls.apply(this,arguments)},hasCls:function(a){var b=this,c=b.rendered?b.el:b.protoEl;return c.hasCls.apply(c,arguments)},removeCls:function(a){var b=this,c=b.rendered?b.el:b.protoEl;return c.removeCls.apply(c,arguments),b},addOverCls:function(){var a=this;a.disabled||a.el.addCls(a.overCls)},removeOverCls:function(){this.el.removeCls(this.overCls)},addListener:function(a,b,c,d){var e=this,f,g;if(Ext.isString(a)&&(Ext.isObject(b)||d&&d.element)){if(d.element){f=b,b={},b[a]=f,a=d.element,c&&(b.scope=c);for(g in d)d.hasOwnProperty(g)&&e.eventOptionsRe.test(g)&&(b[g]=d[g])}e[a]&&e[a].on?e.mon(e[a],b):(e.afterRenderEvents=e.afterRenderEvents||{},e.afterRenderEvents[a]||(e.afterRenderEvents[a]=[]),e.afterRenderEvents[a].push(b))}return e.mixins.observable.addListener.apply(e,arguments)},removeManagedListenerItem:function(a,b,c,d,e,f){var g=this,h=b.options?b.options.element:null;if(!h)return g.mixins.observable.removeManagedListenerItem.apply(g,arguments);h=g[h],h&&h.un&&(a||b.item===c&&b.ename===d&&(!e||b.fn===e)&&(!f||b.scope===f))&&(h.un(b.ename,b.fn,b.scope),a||Ext.Array.remove(g.managedListeners,b))},getBubbleTarget:function(){return this.ownerCt},isFloating:function(){return this.floating},isDraggable:function(){return!!this.draggable},isDroppable:function(){return!!this.droppable},onAdded:function(a,b){var c=this;c.ownerCt=a,c.hasListeners.added&&c.fireEvent("added",c,a,b)},onRemoved:function(a){var b=this;b.hasListeners.removed&&b.fireEvent("removed",b,b.ownerCt),delete b.ownerCt,delete b.ownerLayout},beforeDestroy:Ext.emptyFn,onResize:Ext.emptyFn,setSize:function(a,b){var c=this;return a&&typeof a=="object"&&(b=a.height,a=a.width),typeof a=="number"?c.width=Ext.Number.constrain(a,c.minWidth,c.maxWidth):a===null&&delete c.width,typeof b=="number"?c.height=Ext.Number.constrain(b,c.minHeight,c.maxHeight):b===null&&delete c.height,c.rendered&&c.isVisible()&&c.updateLayout({isRoot:!1}),c},isLayoutRoot:function(){var a=this,b=a.ownerLayout;return!b||a._isLayoutRoot||a.floating?!0:b.isItemLayoutRoot(a)},isLayoutSuspended:function(){var a=this,b;while(a){if(a.layoutSuspendCount||a.suspendLayout)return!0;b=a.ownerLayout;if(!b)break;a=b.owner}return!1},updateLayout:function(a){var b=this,c,d=a&&a.isRoot;if(!b.rendered||b.layoutSuspendCount||b.suspendLayout)return;b.hidden?Ext.AbstractComponent.cancelLayout(b):typeof d!="boolean"&&(d=b.isLayoutRoot());if(d||!b.ownerLayout||!b.ownerLayout.onContentChange(b))b.isLayoutSuspended()||(c=a&&a.hasOwnProperty("defer")?a.defer:b.deferLayouts,Ext.AbstractComponent.updateLayout(b,c))},getSizeModel:function(a){var b=this,c=Ext.layout.SizeModel,d=b.componentLayout.ownerContext,e,f,g,h,i,j,k;d&&(k=d.widthModel,g=d.heightModel);if(!k||!g)e=typeof b.width=="number",f=typeof b.height=="number",b.floating||!(h=b.ownerLayout)?(e&&(k=c.configured),f&&(g=c.configured),i=Ext.layout.Layout.prototype.autoSizePolicy,j=b.floating?3:b.shrinkWrap):(i=h.getItemSizePolicy(b,a),j=h.isItemShrinkWrap(b)),j=j===!0?3:j||0,j!==3&&(a||(a=b.ownerCt&&b.ownerCt.getSizeModel()),a&&(j|=(a.width.shrinkWrap?1:0)|(a.height.shrinkWrap?2:0))),k||(i.setsWidth?i.readsWidth?e?k=c.calculatedFromConfigured:k=j&1?c.calculatedFromShrinkWrap:c.calculatedFromNatural:k=c.calculated:e?k=c.configured:k=j&1?c.shrinkWrap:c.natural),g||(i.setsHeight?i.readsHeight?f?g=c.calculatedFromConfigured:g=j&2?c.calculatedFromShrinkWrap:c.calculatedFromNatural:g=c.calculated:f?g=c.configured:g=j&2?c.shrinkWrap:c.natural);return{width:k,height:g}},isDescendant:function(a){if(a.isContainer)for(var b=this.ownerCt;b;b=b.ownerCt)if(b===a)return!0;return!1},doComponentLayout:function(){return this.updateLayout(),this},forceComponentLayout:function(){this.updateLayout()},setComponentLayout:function(a){var b=this.componentLayout;b&&b.isLayout&&b!=a&&b.setOwner(null),this.componentLayout=a,a.setOwner(this)},getComponentLayout:function(){var a=this;return(!a.componentLayout||!a.componentLayout.isLayout)&&a.setComponentLayout(Ext.layout.Layout.create(a.componentLayout,"autocomponent")),a.componentLayout},afterComponentLayout:function(a,b,c,d){var e=this;++e.componentLayoutCounter===1&&e.afterFirstLayout(a,b),e.hasListeners.resize&&(a!==c||b!==d)&&e.fireEvent("resize",e,a,b,c,d)},beforeComponentLayout:function(a,b){return!0},setPosition:function(a,b,c){var d=this,e=d.beforeSetPosition.apply(d,arguments);return e&&d.rendered&&(e=d.convertPosition(e),c?(d.stopAnimation(),d.animate(Ext.apply({duration:1e3,listeners:{afteranimate:Ext.Function.bind(d.afterSetPosition,d,[e.left,e.top])},to:e},c))):(e.left!==undefined&&e.top!==undefined?d.el.setLeftTop(e.left,e.top):e.left!==undefined?d.el.setLeft(e.left):e.top!==undefined&&d.el.setTop(e.top),d.afterSetPosition(e.left,e.top))),d},beforeSetPosition:function(a,b,c){var d,e;return!a||Ext.isNumber(a)?d={x:a,y:b,anim:c}:Ext.isNumber(e=a[0])?d={x:e,y:a[1],anim:b}:d={x:a.x,y:a.y,anim:b},d.hasX=Ext.isNumber(d.x),d.hasY=Ext.isNumber(d.y),this.x=d.x,this.y=d.y,d.hasX||d.hasY?d:null},afterSetPosition:function(a,b){var c=this;c.onPosition(a,b),c.hasListeners.move&&c.fireEvent("move",c,a,b)},convertPosition:function(a,b){var c={},d=Ext.Element;return a.hasX&&(c.left=b?d.addUnits(a.x):a.x),a.hasY&&(c.top=b?d.addUnits(a.y):a.y),c},onPosition:Ext.emptyFn,setWidth:function(a){return this.setSize(a)},setHeight:function(a){return this.setSize(undefined,a)},getSize:function(){return this.el.getSize()},getWidth:function(){return this.el.getWidth()},getHeight:function(){return this.el.getHeight()},getLoader:function(){var a=this,b=a.autoLoad?Ext.isObject(a.autoLoad)?a.autoLoad:{url:a.autoLoad}:null,c=a.loader||b;return c?(c.isLoader?c.setTarget(a):a.loader=new Ext.ComponentLoader(Ext.apply({target:a,autoLoad:b},c)),a.loader):null},setDocked:function(a,b){var c=this;return c.dock=a,b&&c.ownerCt&&c.rendered&&c.ownerCt.updateLayout(),c},setBorder:function(a,b){var c=this,d=!!b;if(c.rendered||d)d||(b=c.el),a?a=Ext.Element.unitizeBox(a===!0?1:a):a=0,b.setStyle("border-width",a),d||c.updateLayout();c.border=a},onDestroy:function(){var a=this;a.monitorResize&&Ext.EventManager.resizeEvent&&Ext.EventManager.resizeEvent.removeListener(a.setSize,a),Ext.destroy(a.componentLayout,a.loadMask,a.floatingItems)},destroy:function(){var a=this,b=a.renderSelectors,c,d;if(!a.isDestroyed)if(!a.hasListeners.beforedestroy||a.fireEvent("beforedestroy",a)!==!1){a.destroying=!0,a.beforeDestroy(),a.floating?(delete a.floatParent,a.zIndexManager&&a.zIndexManager.unregister(a)):a.ownerCt&&a.ownerCt.remove&&a.ownerCt.remove(a,!1),a.onDestroy(),Ext.destroy(a.plugins),a.hasListeners.destroy&&a.fireEvent("destroy",a),Ext.ComponentManager.unregister(a),a.mixins.state.destroy.call(a),a.clearListeners();if(a.rendered){Ext.AbstractComponent.cancelLayout(a),a.preserveElOnDestroy||a.el.remove(),a.mixins.elementCt.destroy.call(a);if(b)for(c in b)b.hasOwnProperty(c)&&(d=a[c],d&&(delete a[c],d.remove()));delete a.el,delete a.frameBody,delete a.rendered}a.destroying=!1,a.isDestroyed=!0}},getPlugin:function(a){var b=0,c=this.plugins,d=c.length;for(;b<d;b++)if(c[b].pluginId===a)return c[b]},isDescendantOf:function(a){return!!this.findParentBy(function(b){return b===a})}},function(){var a=this;a.createAlias({on:"addListener",prev:"previousSibling",next:"nextSibling"}),Ext.resumeLayouts=function(b){a.resumeLayouts(b)},Ext.suspendLayouts=function(){a.suspendLayouts()},Ext.batchLayouts=function(b,c){a.suspendLayouts(),b.call(c),a.resumeLayouts(!0)}}),Ext.define("Ext.ModelManager",{extend:"Ext.AbstractManager",alternateClassName:"Ext.ModelMgr",requires:["Ext.data.association.Association"],singleton:!0,typeName:"mtype",associationStack:[],registerType:function(a,b){var c=b.prototype,d;return c&&c.isModel?d=b:(b.extend||(b.extend="Ext.data.Model"),d=Ext.define(a,b)),this.types[a]=d,d},onModelDefined:function(a){var b=this.associationStack,c=b.length,d=[],e,f,g;for(f=0;f<c;f++)e=b[f],e.associatedModel==a.modelName&&d.push(e);for(f=0,c=d.length;f<c;f++)g=d[f],this.types[g.ownerModel].prototype.associations.add(Ext.data.association.Association.create(g)),Ext.Array.remove(b,g)},registerDeferredAssociation:function(a){this.associationStack.push(a)},getModel:function(a){var b=a;return typeof b=="string"&&(b=this.types[b]),b},create:function(a,b,c){var d=typeof b=="function"?b:this.types[b||a.name];return new d(a,c)}},function(){Ext.regModel=function(){return this.ModelManager.registerType.apply(this.ModelManager,arguments)}}),Ext.define("Ext.PluginManager",{extend:"Ext.AbstractManager",alternateClassName:"Ext.PluginMgr",singleton:!0,typeName:"ptype",create:function(a,b){return a.init?a:Ext.createByAlias("plugin."+(a.ptype||b),a)},findByType:function(a,b){var c=[],d=this.types,e,f;for(e in d){if(!d.hasOwnProperty(e))continue;f=d[e],f.type==a&&(!b||b===!0&&f.isDefault)&&c.push(f)}return c}},function(){Ext.preg=function(){return Ext.PluginManager.registerType.apply(Ext.PluginManager,arguments)}}),Ext.define("Ext.fx.Queue",{requires:["Ext.util.HashMap"],constructor:function(){this.targets=new Ext.util.HashMap,this.fxQueue={}},getFxDefaults:function(a){var b=this.targets.get(a);return b?b.fxDefaults:{}},setFxDefaults:function(a,b){var c=this.targets.get(a);c&&(c.fxDefaults=Ext.apply(c.fxDefaults||{},b))},stopAnimation:function(a){var b=this,c=b.getFxQueue(a),d=c.length;while(d)c[d-1].end(),d--},getActiveAnimation:function(a){var b=this.getFxQueue(a);return b&&!!b.length?b[0]:!1},hasFxBlock:function(a){var b=this.getFxQueue(a);return b&&b[0]&&b[0].block},getFxQueue:function(a){if(!a)return!1;var b=this,c=b.fxQueue[a],d=b.targets.get(a);return d?(c||(b.fxQueue[a]=[],d.type!="element"&&d.target.on("destroy",function(){b.fxQueue[a]=[]})),b.fxQueue[a]):!1},queueFx:function(a){var b=this,c=a.target,d,e;if(!c)return;d=b.getFxQueue(c.getId()),e=d.length,e?a.concurrent?a.paused=!1:d[e-1].on("afteranimate",function(){a.paused=!1}):a.paused=!1,a.on("afteranimate",function(){Ext.Array.remove(d,a);if(a.remove&&c.type=="element"){var b=Ext.get(c.id);b&&b.remove()}},this),d.push(a)}}),Ext.define("Ext.util.LruCache",{extend:"Ext.util.HashMap",constructor:function(a){Ext.apply(this,a),this.callParent([a])},add:function(a,b){var c=this,d=c.findKey(b),e;return d?(c.unlinkEntry(e=c.map[d]),e.prev=c.last,e.next=null):e={prev:c.last,next:null,key:a,value:b},c.last?c.last.next=e:c.first=e,c.last=e,c.callParent([a,e]),c.prune(),b},insertBefore:function(a,b,c){var d=this,e,f;return(c=this.map[this.findKey(c)])?(e=d.findKey(b),e?d.unlinkEntry(f=d.map[e]):f={prev:c.prev,next:c,key:a,value:b},c.prev?f.prev.next=f:d.first=f,f.next=c,c.prev=f,d.prune(),b):d.add(a,b)},get:function(a){var b=this.map[a];if(b)return b.next&&this.moveToEnd(b),b.value},removeAtKey:function(a){return this.unlinkEntry(this.map[a]),this.callParent(arguments)},clear:function(a){return this.first=this.last=null,this.callParent(arguments)},unlinkEntry:function(a){a&&(a.next?a.next.prev=a.prev:this.last=a.prev,a.prev?a.prev.next=a.next:this.first=a.next,a.prev=a.next=null)},moveToEnd:function(a){this.unlinkEntry(a),(a.prev=this.last)?this.last.next=a:this.first=a,this.last=a},getArray:function(a){var b=[],c=this.first;while(c)b.push(a?c.key:c.value),c=c.next;return b},each:function(a,b,c){var d=this,e=c?d.last:d.first,f=d.length;b=b||d;while(e){if(a.call(b,e.key,e.value,f)===!1)break;e=c?e.prev:e.next}return d},findKey:function(a){var b,c=this.map;for(b in c)if(c.hasOwnProperty(b)&&c[b].value===a)return b;return undefined},prune:function(){var a=this,b=a.maxSize?a.length-a.maxSize:0;if(b>0)for(;a.first&&b;b--)a.removeAtKey(a.first.key)}}),Ext.define("Ext.util.Point",{extend:"Ext.util.Region",statics:{fromEvent:function(a){return a=a.changedTouches&&a.changedTouches.length>0?a.changedTouches[0]:a,new this(a.pageX,a.pageY)}},constructor:function(a,b){this.callParent([b,a,b,a])},toString:function(){return"Point["+this.x+","+this.y+"]"},equals:function(a){return this.x==a.x&&this.y==a.y},isWithin:function(a,b){return Ext.isObject(b)||(b={x:b,y:b}),this.x<=a.x+b.x&&this.x>=a.x-b.x&&this.y<=a.y+b.y&&this.y>=a.y-b.y},roundedEquals:function(a){return Math.round(this.x)==Math.round(a.x)&&Math.round(this.y)==Math.round(a.y)}},function(){this.prototype.translate=Ext.util.Region.prototype.translateBy}),Ext.define("Ext.util.Sortable",{isSortable:!0,defaultSortDirection:"ASC",requires:["Ext.util.Sorter"],initSortable:function(){var a=this,b=a.sorters;a.sorters=new Ext.util.AbstractMixedCollection(!1,function(a){return a.id||a.property}),b&&a.sorters.addAll(a.decodeSorters(b))},sort:function(a,b,c,d){var e=this,f,g,h;return Ext.isArray(a)?(d=c,c=b,h=a):Ext.isObject(a)?(d=c,c=b,h=[a]):Ext.isString(a)&&(f=e.sorters.get(a),f?b===undefined?f.toggle():f.setDirection(b):(f={property:a,direction:b},h=[f])),h&&h.length&&(h=e.decodeSorters(h),Ext.isString(c)?c==="prepend"?(a=e.sorters.clone().items,e.sorters.clear(),e.sorters.addAll(h),e.sorters.addAll(a)):e.sorters.addAll(h):(e.sorters.clear(),e.sorters.addAll(h))),d!==!1&&(e.onBeforeSort(h),a=e.sorters.items,a.length&&e.doSort(e.generateComparator())),a},generateComparator:function(){var a=this.sorters.getRange();return a.length?this.createComparator(a):this.emptyComparator},createComparator:function(a){return function(b,c){var d=a[0].sort(b,c),e=a.length,f=1;for(;f<e;f++)d=d||a[f].sort.call(this,b,c);return d}},emptyComparator:function(){return 0},onBeforeSort:Ext.emptyFn,decodeSorters:function(a){Ext.isArray(a)||(a===undefined?a=[]:a=[a]);var b=a.length,c=Ext.util.Sorter,d=this.model?this.model.prototype.fields:null,e,f,g;for(g=0;g<b;g++)f=a[g],f instanceof c||(Ext.isString(f)&&(f={property:f}),Ext.applyIf(f,{root:this.sortRoot,direction:"ASC"}),f.fn&&(f.sorterFn=f.fn),typeof f=="function"&&(f={sorterFn:f}),d&&!f.transform&&(e=d.get(f.property),f.transform=e?e.sortType:undefined),a[g]=new Ext.util.Sorter(f));return a},getSorters:function(){return this.sorters.items}}),Ext.define("Ext.util.MixedCollection",{extend:"Ext.util.AbstractMixedCollection",mixins:{sortable:"Ext.util.Sortable"},constructor:function(){var a=this;a.callParent(arguments),a.addEvents("sort"),a.mixins.sortable.initSortable.call(a)},doSort:function(a){this.sortBy(a)},_sort:function(a,b,c){var d=this,e,f,g=String(b).toUpperCase()=="DESC"?-1:1,h=[],i=d.keys,j=d.items;c=c||function(a,b){return a-b};for(e=0,f=j.length;e<f;e++)h[h.length]={key:i[e],value:j[e],index:e};Ext.Array.sort(h,function(b,d){var e=c(b[a],d[a])*g;return e===0&&(e=b.index<d.index?-1:1),e});for(e=0,f=h.length;e<f;e++)j[e]=h[e].value,i[e]=h[e].key;d.fireEvent("sort",d)},sortBy:function(a){var b=this,c=b.items,d=b.keys,e=c.length,f=[],g;for(g=0;g<e;g++)f[g]={key:d[g],value:c[g],index:g};Ext.Array.sort(f,function(b,c){var d=a(b.value,c.value);return d===0&&(d=b.index<c.index?-1:1),d});for(g=0;g<e;g++)c[g]=f[g].value,d[g]=f[g].key;b.fireEvent("sort",b,c,d)},findInsertionIndex:function(a,b){var c=this,d=c.items,e=0,f=d.length-1,g,h;b||(b=c.generateComparator());while(e<=f)g=e+f>>1,h=b(a,d[g]),h>=0?e=g+1:h<0&&(f=g-1);return e},reorder:function(a){var b=this,c=b.items,d=0,e=c.length,f=[],g=[],h;b.suspendEvents();for(h in a)f[a[h]]=c[h];for(d=0;d<e;d++)a[d]==undefined&&g.push(c[d]);for(d=0;d<e;d++)f[d]==undefined&&(f[d]=g.shift());b.clear(),b.addAll(f),b.resumeEvents(),b.fireEvent("sort",b)},sortByKey:function(a,b){this._sort("key",a,b||function(a,b){var c=String(a).toUpperCase(),d=String(b).toUpperCase();return c>d?1:c<d?-1:0})}}),Ext.define("Ext.container.DockingContainer",{requires:["Ext.util.MixedCollection","Ext.Element"],isDockingContainer:!0,defaultDockWeights:{top:{render:1,visual:1},left:{render:3,visual:5},right:{render:5,visual:7},bottom:{render:7,visual:3}},dockOrder:{top:-1,left:-1,right:1,bottom:1},addDocked:function(a,b){var c=this,d=0,e,f;a=c.prepareItems(a),f=a.length;for(;d<f;d++)e=a[d],e.dock=e.dock||"top",b!==undefined?c.dockedItems.insert(b+d,e):c.dockedItems.add(e),e.onAdded!==Ext.emptyFn&&e.onAdded(c,d),c.onDockedAdd!==Ext.emptyFn&&c.onDockedAdd(e);return c.rendered&&!c.suspendLayout&&c.updateLayout(),a},destroyDockedItems:function(){var a=this.dockedItems,b;if(a)while(b=a.first())this.removeDocked(b,!0)},doRenderDockedItems:function(a,b,c){var d=b.$comp,e=d.componentLayout,f,g;e.getDockedItems&&!b.$skipDockedItems&&(f=e.getDockedItems("render",!c),g=f&&e.getItemsRenderTree(f),g&&Ext.DomHelper.generateMarkup(g,a))},getDockedComponent:function(a){return Ext.isObject(a)&&(a=a.getItemId()),this.dockedItems.get(a)},getDockedItems:function(a,b){var c=this.getComponentLayout().getDockedItems("render",b);return a&&c.length&&(c=Ext.ComponentQuery.query(a,c)),c},getDockingRefItems:function(a,b){var c=a&&"*,* *",d=this.getDockedItems(c,!0),e;return d.push.apply(d,b),e=this.getDockedItems(c,!1),d.push.apply(d,e),d},initDockingItems:function(){var a=this,b=a.dockedItems;a.dockedItems=new Ext.util.AbstractMixedCollection(!1,a.getComponentId),b&&a.addDocked(b)},insertDocked:function(a,b){this.addDocked(b,a)},onDockedAdd:Ext.emptyFn,onDockedRemove:Ext.emptyFn,removeDocked:function(a,b){var c=this,d,e;return c.dockedItems.contains(a)?(d=c.componentLayout,e=d&&c.rendered,e&&d.onRemove(a),c.dockedItems.remove(a),a.onRemoved(),c.onDockedRemove(a),b===!0||b!==!1&&c.autoDestroy?a.destroy():e&&d.afterRemove(a),!c.destroying&&!c.suspendLayout&&c.updateLayout(),a):a},setupDockingRenderTpl:function(a){a.renderDockedItems=this.doRenderDockedItems}}),Ext.define("Ext.data.AbstractStore",{requires:["Ext.util.MixedCollection","Ext.data.proxy.Proxy","Ext.data.Operation","Ext.util.Filter"],mixins:{observable:"Ext.util.Observable",sortable:"Ext.util.Sortable"},statics:{create:function(a){return a.isStore||(a.type||(a.type="store"),a=Ext.createByAlias("store."+a.type,a)),a}},remoteSort:!1,remoteFilter:!1,autoLoad:undefined,autoSync:!1,batchUpdateMode:"operation",filterOnLoad:!0,sortOnLoad:!0,implicitModel:!1,defaultProxyType:"memory",isDestroyed:!1,isStore:!0,sortRoot:"data",constructor:function(a){var b=this,c;Ext.apply(b,a),b.removed=[],b.mixins.observable.constructor.apply(b,arguments),b.model=Ext.ModelManager.getModel(b.model),Ext.applyIf(b,{modelDefaults:{}}),!b.model&&b.fields&&(b.model=Ext.define("Ext.data.Store.ImplicitModel-"+(b.storeId||Ext.id()),{extend:"Ext.data.Model",fields:b.fields,proxy:b.proxy||b.defaultProxyType}),delete b.fields,b.implicitModel=!0),b.setProxy(b.proxy||b.model.getProxy()),b.proxy.on("metachange",b.onMetaChange,b),b.id&&!b.storeId&&(b.storeId=b.id,delete b.id),b.storeId&&Ext.data.StoreManager.register(b),b.mixins.sortable.initSortable.call(b),c=b.decodeFilters(b.filters),b.filters=new Ext.util.MixedCollection,b.filters.addAll(c)},setProxy:function(a){var b=this;return a instanceof Ext.data.proxy.Proxy?a.setModel(b.model):(Ext.isString(a)&&(a={type:a}),Ext.applyIf(a,{model:b.model}),a=Ext.createByAlias("proxy."+a.type,a)),b.proxy=a,b.proxy},getProxy:function(){return this.proxy},onMetaChange:function(a,b){this.fireEvent("metachange",this,b)},create:function(a,b){var c=this,d=Ext.ModelManager.create(Ext.applyIf(a,c.modelDefaults),c.model.modelName),e;return b=b||{},Ext.applyIf(b,{action:"create",records:[d]}),e=new Ext.data.Operation(b),c.proxy.create(e,c.onProxyWrite,c),d},read:function(){return this.load.apply(this,arguments)},update:function(a){var b=this,c;return a=a||{},Ext.applyIf(a,{action:"update",records:b.getUpdatedRecords()}),c=new Ext.data.Operation(a),b.proxy.update(c,b.onProxyWrite,b)},onProxyWrite:function(a){var b=this,c=a.wasSuccessful(),d=a.getRecords();switch(a.action){case"create":b.onCreateRecords(d,a,c);break;case"update":b.onUpdateRecords(d,a,c);break;case"destroy":b.onDestroyRecords(d,a,c)}c&&(b.fireEvent("write",b,a),b.fireEvent("datachanged",b),b.fireEvent("refresh",b)),Ext.callback(a.callback,a.scope||b,[d,a,c])},onCreateRecords:Ext.emptyFn,onUpdateRecords:Ext.emptyFn,onDestroyRecords:function(a,b,c){c&&(this.removed=[])},destroy:function(a){var b=this,c;return a=a||{},Ext.applyIf(a,{action:"destroy",records:b.getRemovedRecords()}),c=new Ext.data.Operation(a),b.proxy.destroy(c,b.onProxyWrite,b)},onBatchOperationComplete:function(a,b){return this.onProxyWrite(b)},onBatchComplete:function(a,b){var c=this,d=a.operations,e=d.length,f;c.suspendEvents();for(f=0;f<e;f++)c.onProxyWrite(d[f]);c.resumeEvents(),c.fireEvent("datachanged",c),c.fireEvent("refresh",c)},onBatchException:function(a,b){},filterNew:function(a){return a.phantom===!0&&a.isValid()},getNewRecords:function(){return[]},getUpdatedRecords:function(){return[]},getModifiedRecords:function(){return[].concat(this.getNewRecords(),this.getUpdatedRecords())},filterUpdated:function(a){return a.dirty===!0&&a.phantom!==!0&&a.isValid()},getRemovedRecords:function(){return this.removed},filter:function(a,b){},decodeFilters:function(a){Ext.isArray(a)||(a===undefined?a=[]:a=[a]);var b=a.length,c=Ext.util.Filter,d,e;for(e=0;e<b;e++)d=a[e],d instanceof c||(Ext.apply(d,{root:"data"}),d.fn&&(d.filterFn=d.fn),typeof d=="function"&&(d={filterFn:d}),a[e]=new c(d));return a},clearFilter:function(a){},isFiltered:function(){},filterBy:function(a,b){},sync:function(a){var b=this,c={},d=b.getNewRecords(),e=b.getUpdatedRecords(),f=b.getRemovedRecords(),g=!1;return d.length>0&&(c.create=d,g=!0),e.length>0&&(c.update=e,g=!0),f.length>0&&(c.destroy=f,g=!0),g&&b.fireEvent("beforesync",c)!==!1&&(a=a||{},b.proxy.batch(Ext.apply(a,{operations:c,listeners:b.getBatchListeners()}))),b},getBatchListeners:function(){var a=this,b={scope:a,exception:a.onBatchException};return a.batchUpdateMode=="operation"?b.operationcomplete=a.onBatchOperationComplete:b.complete=a.onBatchComplete,b},save:function(){return this.sync.apply(this,arguments)},load:function(a){var b=this,c;return a=a||{},a.action=a.action||"read",a.filters=a.filters||b.filters.items,a.sorters=a.sorters||b.getSorters(),c=new Ext.data.Operation(a),b.fireEvent("beforeload",b,c)!==!1&&(b.loading=!0,b.proxy.read(c,b.onProxyLoad,b)),b},afterEdit:function(a,b){var c=this,d,e;if(c.autoSync&&!c.autoSyncSuspended){for(d=b.length;d--;)if(a.fields.get(b[d]).persist){e=!0;break}e&&c.sync()}c.fireEvent("update",c,a,Ext.data.Model.EDIT,b)},afterReject:function(a){this.fireEvent("update",this,a,Ext.data.Model.REJECT,null)},afterCommit:function(a){this.fireEvent("update",this,a,Ext.data.Model.COMMIT,null)},destroyStore:function(){var a=this;a.isDestroyed||(a.storeId&&Ext.data.StoreManager.unregister(a),a.clearData(),a.data=a.tree=a.sorters=a.filters=a.groupers=null,a.reader&&a.reader.destroyReader(),a.proxy=a.reader=a.writer=null,a.clearListeners(),a.isDestroyed=!0,a.implicitModel?Ext.destroy(a.model):a.model=null)},doSort:function(a){var b=this;b.remoteSort?b.load():(b.data.sortBy(a),b.fireEvent("datachanged",b),b.fireEvent("refresh",b))},clearData:Ext.emptyFn,getCount:Ext.emptyFn,getById:Ext.emptyFn,removeAll:Ext.emptyFn,isLoading:function(){return!!this.loading},suspendAutoSync:function(){this.autoSyncSuspended=!0},resumeAutoSync:function(){this.autoSyncSuspended=!1}}),Ext.define("Ext.data.Errors",{extend:"Ext.util.MixedCollection",isValid:function(){return this.length===0},getByField:function(a){var b=[],c,d,e;for(e=0;e<this.length;e++)c=this.items[e],c.field==a&&b.push(c);return b}}),Ext.define("Ext.data.Model",{alternateClassName:"Ext.data.Record",mixins:{observable:"Ext.util.Observable"},requires:["Ext.ModelManager","Ext.data.IdGenerator","Ext.data.Field","Ext.data.Errors","Ext.data.Operation","Ext.data.validations","Ext.util.MixedCollection"],compareConvertFields:function(a,b){var c=a.convert&&a.type&&a.convert!==a.type.convert,d=b.convert&&b.type&&b.convert!==b.type.convert;return c&&!d?1:!c&&d?-1:0},itemNameFn:function(a){return a.name},onClassExtended:function(a,b,c){var d=c.onBeforeCreated;c.onBeforeCreated=function(a,b){var e=this,f=Ext.getClassName(a),g=a.prototype,h=a.prototype.superclass,i=b.validations||[],j=b.fields||[],k=b.associations||[],l=function(a,b){var c=0,d,e;if(a){a=Ext.Array.from(a);for(d=a.length;c<d;++c)e=a[c],Ext.isObject(e)||(e={model:e}),e.type=b,k.push(e)}},m=b.idgen,n=new Ext.util.MixedCollection(!1,g.itemNameFn),o=new Ext.util.MixedCollection(!1,g.itemNameFn),p=h.validations,q=h.fields,r=h.associations,s,t,u,v=[],w=b.idProperty||a.prototype.idProperty,x=function(a,b,c){var d,e;n.events.add.firing?(e=a,d=b):(d=c,e=b.originalIndex),d.originalIndex=e;if(d.mapping===w||d.mapping==null&&d.name===w)d.defaultValue=undefined},y=b.proxy||a.prototype.proxy||a.prototype.defaultProxyType,z=function(){n.sortBy(g.compareConvertFields)};a.modelName=f,g.modelName=f,p&&(i=p.concat(i)),b.validations=i,q&&(j=q.items.concat(j)),n.on({add:x,replace:x});for(t=0,u=j.length;t<u;++t)n.add(new Ext.data.Field(j[t]));n.get(w)||n.add(new Ext.data.Field(w)),z(),n.on({add:z,replace:z}),b.fields=n,m&&(b.idgen=Ext.data.IdGenerator.get(m)),l(b.belongsTo,"belongsTo"),delete b.belongsTo,l(b.hasMany,"hasMany"),delete b.hasMany,l(b.hasOne,"hasOne"),delete b.hasOne,r&&(k=r.items.concat(k));for(t=0,u=k.length;t<u;++t)v.push("association."+k[t].type.toLowerCase());y&&!y.isProxy&&v.push("proxy."+(typeof y=="string"?y:y.type)),Ext.require(v,function(){Ext.ModelManager.registerType(f,a);for(t=0,u=k.length;t<u;++t)s=k[t],Ext.apply(s,{ownerModel:f,associatedModel:s.model}),Ext.ModelManager.getModel(s.model)===undefined?Ext.ModelManager.registerDeferredAssociation(s):o.add(Ext.data.association.Association.create(s));b.associations=o,d.call(e,a,b,c),a.setProxy(y),Ext.ModelManager.onModelDefined(a)})}},inheritableStatics:{setProxy:function(a){return a.isProxy||(typeof a=="string"&&(a={type:a}),a=Ext.createByAlias("proxy."+a.type,a)),a.setModel(this),this.proxy=this.prototype.proxy=a,a},getProxy:function(){return this.proxy},setFields:function(a,b,c){var d=this,e=d.prototype,f=e.fields,g=a?a.length:0,h=0;b&&(e.idProperty=b),c&&(e.clientIdProperty=c),f?f.clear():f=d.prototype.fields=new Ext.util.MixedCollection(!1,function(a){return a.name});for(;h<g;h++)f.add(new Ext.data.Field(a[h]));return f.get(e.idProperty)||f.add(new Ext.data.Field(e.idProperty)),d.fields=f,f},getFields:function(){return this.prototype.fields.items},load:function(a,b){b=Ext.apply({},b),b=Ext.applyIf(b,{action:"read",id:a});var c=new Ext.data.Operation(b),d=b.scope||this,e=null,f;f=function(a){a.wasSuccessful()?(e=a.getRecords()[0],Ext.callback(b.success,d,[e,a])):Ext.callback(b.failure,d,[e,a]),Ext.callback(b.callback,d,[e,a])},this.proxy.read(c,f,this)}},statics:{PREFIX:"ext-record",AUTO_ID:1,EDIT:"edit",REJECT:"reject",COMMIT:"commit",id:function(a){var b=[this.PREFIX,"-",this.AUTO_ID++].join("");return a.phantom=!0,a.internalId=b,b}},idgen:{isGenerator:!0,type:"default",generate:function(){return null},getRecId:function(a){return a.modelName+"-"+a.internalId}},editing:!1,dirty:!1,persistenceProperty:"data",evented:!1,isModel:!0,phantom:!1,idProperty:"id",clientIdProperty:null,defaultProxyType:"ajax",constructor:function(a,b,c,d){a=a||{};var e=this,f,g,h,i,j,k,l,m;e.internalId=b||b===0?b:Ext.data.Model.id(e),e.raw=c,e.data||(e.data={}),e.modified={},e.persistanceProperty&&(e.persistenceProperty=e.persistanceProperty),e[e.persistenceProperty]=d||{},e.mixins.observable.constructor.call(e);if(!d){f=e.fields.items,g=f.length,m=0,l=e[e.persistenceProperty];if(Ext.isArray(a))for(;m<g;m++)h=f[m],i=h.name,j=a[m],j===undefined&&(j=h.defaultValue),h.convert&&(j=h.convert(j,e)),j!==undefined&&(l[i]=j);else for(;m<g;m++)h=f[m],i=h.name,j=a[i],j===undefined&&(j=h.defaultValue),h.convert&&(j=h.convert(j,e)),j!==undefined&&(l[i]=j)}e.stores=[],e.getId()?e.phantom=!1:e.phantom&&(k=e.idgen.generate(),k!==null&&e.setId(k)),e.dirty=!1,e.modified={},typeof e.init=="function"&&e.init(),e.id=e.idgen.getRecId(e)},get:function(a){return this[this.persistenceProperty][a]},_singleProp:{},set:function(a,b){var c=this,d=c[c.persistenceProperty],e=c.fields,f=c.modified,g=typeof a=="string",h,i,j,k,l,m,n,o,p,q;g?(q=c._singleProp,q[a]=b):q=a;for(m in q)if(q.hasOwnProperty(m)){p=q[m],e&&(i=e.get(m))&&i.convert&&(p=i.convert(p,c)),h=d[m];if(c.isEqual(h,p))continue;d[m]=p,(l||(l=[])).push(m);if(i&&i.persist)if(f.hasOwnProperty(m)){if(c.isEqual(f[m],p)){delete f[m],c.dirty=!1;for(k in f)if(f.hasOwnProperty(k)){c.dirty=!0;break}}}else c.dirty=!0,f[m]=h;m==c.idProperty&&(j=!0,n=h,o=p)}return g&&delete q[a],j&&c.fireEvent("idchanged",c,n,o),!c.editing&&l&&c.afterEdit(l),l||null},copyFrom:function(a){if(a){var b=this,c=b.fields.items,d=c.length,e,f=0,g=b[b.persistenceProperty],h=a[a.persistenceProperty],i;for(;f<d;f++)e=c[f],i=h[e.name],i!==undefined&&(g[e.name]=i);b.phantom&&!a.phantom&&b.setId(a.getId())}},isEqual:function(a,b){return Ext.isDate(a)&&Ext.isDate(b)?Ext.Date.isEqual(a,b):a===b},beginEdit:function(){var a=this;a.editing||(a.editing=!0,a.dirtySave=a.dirty,a.dataSave=Ext.apply({},a[a.persistenceProperty]),a.modifiedSave=Ext.apply({},a.modified))},cancelEdit:function(){var a=this;a.editing&&(a.editing=!1,a.modified=a.modifiedSave,a[a.persistenceProperty]=a.dataSave,a.dirty=a.dirtySave,delete a.modifiedSave,delete a.dataSave,delete a.dirtySave)},endEdit:function(a,b){var c=this,d;c.editing&&(c.editing=!1,b||(b=c.getModifiedFieldNames()),d=c.dirty||b.length>0,delete c.modifiedSave,delete c.dataSave,delete c.dirtySave,d&&a!==!0&&c.afterEdit(b))},getModifiedFieldNames:function(){var a=this,b=a.dataSave,c=a[a.persistenceProperty],d=[],e;for(e in c)c.hasOwnProperty(e)&&(a.isEqual(c[e],b[e])||d.push(e));return d},getChanges:function(){var a=this.modified,b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=this.get(c));return b},isModified:function(a){return this.modified.hasOwnProperty(a)},setDirty:function(){var a=this,b=a.fields.items,c=b.length,d,e,f;a.dirty=!0;for(f=0;f<c;f++)d=b[f],d.persist&&(e=d.name,a.modified[e]=a.get(e))},reject:function(a){var b=this,c=b.modified,d;for(d in c)c.hasOwnProperty(d)&&typeof c[d]!="function"&&(b[b.persistenceProperty][d]=c[d]);b.dirty=!1,b.editing=!1,b.modified={},a!==!0&&b.afterReject()},commit:function(a){var b=this;b.phantom=b.dirty=b.editing=!1,b.modified={},a!==!0&&b.afterCommit()},copy:function(a){var b=this;return new b.self(Ext.apply({},b[b.persistenceProperty]),a)},setProxy:function(a){return a.isProxy||(typeof a=="string"&&(a={type:a}),a=Ext.createByAlias("proxy."+a.type,a)),a.setModel(this.self),this.proxy=a,a},getProxy:function(){return this.proxy},validate:function(){var a=new Ext.data.Errors,b=this.validations,c=Ext.data.validations,d,e,f,g,h,i;if(b){d=b.length;for(i=0;i<d;i++)e=b[i],f=e.field||e.name,h=e.type,g=c[h](e,this.get(f)),g||a.add({field:f,message:e.message||c[h+"Message"]})}return a},isValid:function(){return this.validate().isValid()},save:function(a){a=Ext.apply({},a);var b=this,c=b.phantom?"create":"update",d=a.scope||b,e=b.stores,f=0,g,h,i,j,k;return Ext.apply(a,{records:[b],action:c}),j=new Ext.data.Operation(a),k=function(c){i=[b,c];if(c.wasSuccessful()){for(g=e.length;f<g;f++)h=e[f],h.fireEvent("write",h,c),h.fireEvent("datachanged",h);Ext.callback(a.success,d,i)}else Ext.callback(a.failure,d,i);Ext.callback(a.callback,d,i)},b.getProxy()[c](j,k,b),b},destroy:function(a){a=Ext.apply({},a);var b=this,c=a.scope||b,d=b.stores,e=0,f,g,h,i,j;return Ext.apply(a,{records:[b],action:"destroy"}),i=new Ext.data.Operation(a),j=function(i){h=[b,i];if(i.wasSuccessful()){for(f=d.length;e<f;e++)g=d[e],g.fireEvent("write",g,i),g.fireEvent("datachanged",g);b.clearListeners(),Ext.callback(a.success,c,h)}else Ext.callback(a.failure,c,h);Ext.callback(a.callback,c,h)},b.getProxy().destroy(i,j,b),b},getId:function(){return this.get(this.idProperty)},getObservableId:function(){return this.id},setId:function(a){this.set(this.idProperty,a),this.phantom=!a&&a!==0},join:function(a){Ext.Array.include(this.stores,a),this.store=this.stores[0]},unjoin:function(a){Ext.Array.remove(this.stores,a),this.store=this.stores[0]||null},afterEdit:function(a){this.callStore("afterEdit",a)},afterReject:function(){this.callStore("afterReject")},afterCommit:function(){this.callStore("afterCommit")},callStore:function(a){var b=Ext.Array.clone(arguments),c=this.stores,d=0,e=c.length,f,g;b[0]=this;for(;d<e;++d)f=c[d],f&&typeof f[a]=="function"&&f[a].apply(f,b),g=f.treeStore,g&&typeof g[a]=="function"&&g[a].apply(g,b)},getData:function(a){var b=this,c=b.fields.items,d=c.length,e={},f,g;for(g=0;g<d;g++)f=c[g].name,e[f]=b.get(f);return a===!0&&Ext.apply(e,b.getAssociatedData()),e},getAssociatedData:function(){return this.prepareAssociatedData({},1)},prepareAssociatedData:function(a,b){var c=this,d=c.associations.items,e=d.length,f={},g=[],h=[],i=[],j,k,l,m,n,o,p,q,r,s,t,u,v,w;for(t=0;t<e;t++){s=d[t],q=s.associationId,p=a[q];if(p&&p!==b)continue;a[q]=b,v=s.type,w=s.name;if(v=="hasMany"){j=c[s.storeName],f[w]=[];if(j&&j.getCount()>0){k=j.data.items,r=k.length;for(u=0;u<r;u++)l=k[u],f[w][u]=l.getData(),g.push(l),h.push(w),i.push(u)}}else if(v=="belongsTo"||v=="hasOne")l=c[s.instanceName],l!==undefined&&(f[w]=l.getData(),g.push(l),h.push(w),i.push(-1))}for(t=0,r=g.length;t<r;++t)l=g[t],m=f[h[t]],n=i[t],o=l.prepareAssociatedData(a,b+1),n===-1?Ext.apply(m,o):Ext.apply(m[n],o);return f}}),Ext.define("Ext.data.StoreManager",{extend:"Ext.util.MixedCollection",alternateClassName:["Ext.StoreMgr","Ext.data.StoreMgr","Ext.StoreManager"],singleton:!0,uses:["Ext.data.ArrayStore"],register:function(){for(var a=0,b;b=arguments[a];a++)this.add(b)},unregister:function(){for(var a=0,b;b=arguments[a];a++)this.remove(this.lookup(b))},lookup:function(a){if(Ext.isArray(a)){var b=["field1"],c=!Ext.isArray(a[0]),d=a,e,f;if(c){d=[];for(e=0,f=a.length;e<f;++e)d.push([a[e]])}else for(e=2,f=a[0].length;e<=f;++e)b.push("field"+e);return new Ext.data.ArrayStore({data:d,fields:b,autoDestroy:!0,autoCreated:!0,expanded:c})}return Ext.isString(a)?this.get(a):Ext.data.AbstractStore.create(a)},getKey:function(a){return a.storeId}},function(){Ext.regStore=function(a,b){var c;return Ext.isObject(a)?b=a:b.storeId=a,b instanceof Ext.data.Store?c=b:c=new Ext.data.Store(b),Ext.data.StoreManager.register(c)},Ext.getStore=function(a){return Ext.data.StoreManager.lookup(a)}}),Ext.define("Ext.data.TreeStore",{extend:"Ext.data.AbstractStore",alias:"store.tree",requires:["Ext.util.Sorter","Ext.data.Tree","Ext.data.NodeInterface"],clearOnLoad:!0,clearRemovedOnLoad:!0,nodeParam:"node",defaultRootId:"root",defaultRootProperty:"children",folderSort:!1,constructor:function(a){var b=this,c,d;a=Ext.apply({},a),d=a.fields||b.fields,d||(a.fields=[{name:"text",type:"string"}]),b.callParent([a]),b.tree=new Ext.data.Tree,b.relayEvents(b.tree,["append","remove","move","insert","beforeappend","beforeremove","beforemove","beforeinsert","expand","collapse","beforeexpand","beforecollapse","sort","rootchange"]),b.tree.on({scope:b,remove:b.onNodeRemove,beforeexpand:b.onBeforeNodeExpand,beforecollapse:b.onBeforeNodeCollapse,append:b.onNodeAdded,insert:b.onNodeAdded,sort:b.onNodeSort}),b.onBeforeSort(),c=b.root,c&&(delete b.root,b.setRootNode(c)),Ext.isDefined(b.nodeParameter)&&(Ext.isDefined(Ext.global.console)&&Ext.global.console.warn("Ext.data.TreeStore: nodeParameter has been deprecated. Please use nodeParam instead."),b.nodeParam=b.nodeParameter,delete b.nodeParameter)},setProxy:function(a){var b,c;a instanceof Ext.data.proxy.Proxy?c=Ext.isEmpty(a.getReader().root):Ext.isString(a)?c=!0:(b=a.reader,c=!b||!!Ext.isEmpty(b.root)),a=this.callParent(arguments),c&&(b=a.getReader(),b.root=this.defaultRootProperty,b.buildExtractors(!0))},onBeforeSort:function(){this.folderSort&&this.sort({property:"leaf",direction:"ASC"},"prepend",!1)},onBeforeNodeExpand:function(a,b,c){a.isLoaded()?Ext.callback(b,c||a,[a.childNodes]):a.isLoading()?this.on("load",function(){Ext.callback(b,c||a,[a.childNodes])},this,{single:!0}):this.read({node:a,callback:function(){Ext.callback(b,c||a,[a.childNodes])}})},getNewRecords:function(){return Ext.Array.filter(this.tree.flatten(),this.filterNew)},getUpdatedRecords:function(){return Ext.Array.filter(this.tree.flatten(),this.filterUpdated)},onBeforeNodeCollapse:function(a,b,c){b.call(c||a,a.childNodes)},onNodeRemove:function(a,b,c){var d=this,e=d.removed;!b.isReplace&&Ext.Array.indexOf(e,b)==-1&&e.push(b),d.autoSync&&!d.autoSyncSuspended&&!c&&d.sync()},onNodeAdded:function(a,b){var c=this,d=c.getProxy(),e=d.getReader(),f=b.raw||b[b.persistenceProperty],g;Ext.Array.remove(c.removed,b),b.isLeaf()||(g=e.getRoot(f),g&&(c.fillNode(b,e.extractData(g)),delete f[e.root])),c.autoSync&&!c.autoSyncSuspended&&(b.phantom||b.dirty)&&c.sync()},onNodeSort:function(){this.autoSync&&!this.autoSyncSuspended&&this.sync()},setRootNode:function(a,b){var c=this;return a=a||{},a.isModel?a.isModel&&!a.isNode&&Ext.data.NodeInterface.decorate(c.model):(Ext.applyIf(a,{id:c.defaultRootId,text:"Root",allowDrag:!1}),Ext.data.NodeInterface.decorate(c.model),a=Ext.ModelManager.create(a,c.model)),c.getProxy().getReader().buildExtractors(!0),c.tree.setRootNode(a),b!==!0&&!a.isLoaded()&&(c.autoLoad===!0||a.isExpanded())&&c.load({node:a}),a},getRootNode:function(){return this.tree.getRootNode()},getNodeById:function(a){return this.tree.getNodeById(a)},load:function(a){a=a||{},a.params=a.params||{};var b=this,c=a.node||b.tree.getRootNode(),d;return c||(c=b.setRootNode({expanded:!0},!0)),b.clearOnLoad&&(b.clearRemovedOnLoad&&b.clearRemoved(c),b.tree.un("remove",b.onNodeRemove,b),c.removeAll(!1),b.tree.on("remove",b.onNodeRemove,b)),Ext.applyIf(a,{node:c}),a.params[b.nodeParam]=c?c.getId():"root",c&&c.set("loading",!0),b.callParent([a])},clearRemoved:function(a){var b=this,c=b.removed,d=a.getId(),e=c.length,f=e,g={},h=[],i={},j,k,l;if(a===b.getRootNode()){b.removed=[];return}for(;f--;)j=c[f],i[j.getId()]=j;for(f=e;f--;){j=c[f],k=j;while(k&&k.getId()!==d)l=k.get("parentId"),k=k.parentNode||b.getNodeById(l)||i[l];k&&(g[j.getId()]=j)}for(f=0;f<e;f++)j=c[f],g[j.getId()]||h.push(j);b.removed=h},fillNode:function(a,b){var c=this,d=b?b.length:0,e=c.sorters,f,g,h=!1,i=d&&c.sortOnLoad&&!c.remoteSort&&e&&e.items&&e.items.length,j,k;for(f=1;f<d;f++){j=b[f],k=b[f-1],h=j[j.persistenceProperty].index!=k[k.persistenceProperty].index;if(h)break}i?(h&&c.sorters.insert(0,c.indexSorter),g=new Ext.util.MixedCollection,g.addAll(b),g.sort(c.sorters.items),b=g.items,c.sorters.remove(c.indexSorter)):h&&Ext.Array.sort(b,c.sortByIndex),a.set("loaded",!0);for(f=0;f<d;f++)a.appendChild(b[f],undefined,!0);return b},sortByIndex:function(a,b){return a[a.persistenceProperty].index-b[b.persistenceProperty].index},onProxyLoad:function(a){var b=this,c=a.wasSuccessful(),d=a.getRecords(),e=a.node,f,g,h,i;b.loading=!1,e.set("loading",!1),c&&(b.clearOnLoad||(d=b.cleanRecords(e,d)),d=b.fillNode(e,d)),b.fireEvent("read",b,a.node,d,c),b.fireEvent("load",b,a.node,d,c),Ext.callback(a.callback,a.scope||b,[d,a,c])},cleanRecords:function(a,b){var c={},d=a.childNodes,e=0,f=d.length,g=[],h;for(;e<f;++e)c[d[e].getId()]=!0;for(e=0,f=b.length;e<f;++e)h=b[e],c[h.getId()]||g.push(h);return g},removeAll:function(){var a=this.getRootNode();a&&a.destroy(!0),this.fireEvent("clear",this)},doSort:function(a){var b=this;b.remoteSort?b.load():(b.tree.sort(a,!0),b.fireEvent("datachanged",b),b.fireEvent("refresh",b)),b.fireEvent("sort",b)}},function(){var a=this.prototype;a.indexSorter=new Ext.util.Sorter({sorterFn:a.sortByIndex})}),Ext.define("Ext.data.proxy.Ajax",{requires:["Ext.util.MixedCollection","Ext.Ajax"],extend:"Ext.data.proxy.Server",alias:"proxy.ajax",alternateClassName:["Ext.data.HttpProxy","Ext.data.AjaxProxy"],actionMethods:{create:"POST",read:"GET",update:"POST",destroy:"POST"},doRequest:function(a,b,c){var d=this.getWriter(),e=this.buildRequest(a,b,c);return a.allowWrite()&&(e=d.write(e)),Ext.apply(e,{headers:this.headers,timeout:this.timeout,scope:this,callback:this.createRequestCallback(e,a,b,c),method:this.getMethod(e),disableCaching:!1}),Ext.Ajax.request(e),e},getMethod:function(a){return this.actionMethods[a.action]},createRequestCallback:function(a,b,c,d){var e=this;return function(f,g,h){e.processResponse(g,b,a,h,c,d)}}},function(){Ext.data.HttpProxy=this}),Ext.define("Ext.data.Store",{extend:"Ext.data.AbstractStore",alias:"store.store",requires:["Ext.data.StoreManager","Ext.data.Model","Ext.data.proxy.Ajax","Ext.data.proxy.Memory","Ext.data.reader.Json","Ext.data.writer.Json","Ext.util.LruCache"],uses:["Ext.ModelManager","Ext.util.Grouper"],remoteSort:!1,remoteFilter:!1,remoteGroup:!1,groupField:undefined,groupDir:"ASC",trailingBufferZone:25,leadingBufferZone:200,pageSize:undefined,currentPage:1,clearOnPageLoad:!0,loading:!1,sortOnFilter:!0,buffered:!1,purgePageCount:5,clearRemovedOnLoad:!0,defaultPageSize:25,statics:{recordIdFn:function(a){return a.internalId},recordIndexFn:function(a){return a.index}},onClassExtended:function(a,b,c){var d=b.model,e;typeof d=="string"&&(e=c.onBeforeCreated,c.onBeforeCreated=function(){var a=this,b=arguments;Ext.require(d,function(){e.apply(a,b)})})},constructor:function(a){a=Ext.Object.merge({},a);var b=this,c=a.groupers||b.groupers,d=a.groupField||b.groupField,e,f;f=a.data||b.data,b.data=new Ext.util.MixedCollection(!1,Ext.data.Store.recordIdFn),f&&(b.inlineData=f,delete a.data),!c&&d&&(c=[{property:d,direction:a.groupDir||b.groupDir}]),delete a.groupers,b.groupers=new Ext.util.MixedCollection,b.groupers.addAll(b.decodeGroupers(c)),this.callParent([a]),b.buffered&&(b.pageMap=new b.PageMap({pageSize:b.pageSize,maxSize:b.purgePageCount,listeners:{clear:b.cancelAllPrefetches,scope:b}}),b.pageRequests={},b.sortOnLoad=!1,b.filterOnLoad=!1),b.groupers.items.length&&b.sort(b.groupers.items,"prepend",!1),e=b.proxy,f=b.inlineData,!b.buffered&&!b.pageSize&&(b.pageSize=b.defaultPageSize),f?(e instanceof Ext.data.proxy.Memory?(e.data=f,b.read()):b.add.apply(b,[f]),b.sort(),delete b.inlineData):b.autoLoad&&Ext.defer(b.load,10,b,[typeof b.autoLoad=="object"?b.autoLoad:undefined])},destroy:function(){this.pageMap&&this.pageMap.clear(),this.callParent(arguments)},onBeforeSort:function(){var a=this.groupers;a.getCount()>0&&this.sort(a.items,"prepend",!1)},decodeGroupers:function(a){Ext.isArray(a)||(a===undefined?a=[]:a=[a]);var b=a.length,c=Ext.util.Grouper,d,e,f=[];for(e=0;e<b;e++)d=a[e],d instanceof c?f.push(d):(Ext.isString(d)&&(d={property:d}),d=Ext.apply({root:"data",direction:"ASC"},d),d.fn&&(d.sorterFn=d.fn),typeof d=="function"&&(d={sorterFn:d}),f.push(new c(d)));return f},group:function(a,b){var c=this,d=!1,e,f;Ext.isArray(a)?f=a:Ext.isObject(a)?f=[a]:Ext.isString(a)&&(e=c.groupers.get(a),e?b===undefined?e.toggle():e.setDirection(b):(e={property:a,direction:b},f=[e])),f&&f.length&&(d=!0,f=c.decodeGroupers(f),c.groupers.clear(),c.groupers.addAll(f)),c.remoteGroup?c.load({scope:c,callback:c.fireGroupChange}):(c.sort(null,null,null,d),c.fireGroupChange())},clearGrouping:function(){var a=this,b=a.groupers.items,c=b.length,d,e;for(e=0;e<c;e++)d=b[e],a.sorters.remove(d);a.groupers.clear(),a.remoteGroup?a.load({scope:a,callback:a.fireGroupChange}):(a.sort(),a.fireEvent("groupchange",a,a.groupers))},isGrouped:function(){return this.groupers.getCount()>0},fireGroupChange:function(){this.fireEvent("groupchange",this,this.groupers)},getGroups:function(a){var b=this.data.items,c=b.length,d=[],e={},f,g,h,i;for(i=0;i<c;i++)f=b[i],g=this.getGroupString(f),h=e[g],h===undefined&&(h={name:g,children:[]},d.push(h),e[g]=h),h.children.push(f);return a?e[a]:d},getGroupsForGrouper:function(a,b){var c=a.length,d=[],e,f,g,h,i;for(i=0;i<c;i++)g=a[i],f=b.getGroupString(g),f!==e&&(h={name:f,grouper:b,records:[]},d.push(h)),h.records.push(g),e=f;return d},getGroupsForGrouperIndex:function(a,b){var c=this,d=c.groupers,e=d.getAt(b),f=c.getGroupsForGrouper(a,e),g=f.length,h;if(b+1<d.length)for(h=0;h<g;h++)f[h].children=c.getGroupsForGrouperIndex(f[h].records,b+1);for(h=0;h<g;h++)f[h].depth=b;return f},getGroupData:function(a){var b=this;return a!==!1&&b.sort(),b.getGroupsForGrouperIndex(b.data.items,0)},getGroupString:function(a){var b=this.groupers.first();return b?a.get(b.property):""},insert:function(a,b){var c=this,d=!1,e,f,g;b=[].concat(b);for(e=0,g=b.length;e<g;e++)f=c.createModel(b[e]),f.set(c.modelDefaults),b[e]=f,c.data.insert(a+e,f),f.join(c),d=d||f.phantom===!0;c.snapshot&&c.snapshot.addAll(b),c.requireSort&&(c.suspendEvents(),c.sort(),c.resumeEvents()),c.fireEvent("add",c,b,a),c.fireEvent("datachanged",c),c.autoSync&&d&&!c.autoSyncSuspended&&c.sync()},add:function(a){Ext.isArray(a)?a=a.slice(0):a=Array.prototype.slice.apply(arguments);var b=this,c=0,d=a.length,e,f=b.sorters&&b.sorters.items.length;if(f&&d===1)return[b.addSorted(b.createModel(a[0]))];for(;c<d;c++)e=b.createModel(a[c]),a[c]=e;return f&&(b.requireSort=!0),b.insert(b.data.length,a),delete b.requireSort,a},addSorted:function(a){var b=this,c=b.data.findInsertionIndex(a,b.generateComparator());return b.insert(c,a),a},createModel:function(a){return a.isModel||(a=Ext.ModelManager.create(a,this.model)),a},each:function(a,b){var c=this.data.items,d=c.length,e,f;for(f=0;f<d;f++){e=c[f];if(a.call(b||e,e,f,d)===!1)break}},remove:function(a,b){Ext.isArray(a)||(a=[a]),b=b===!0;var c=this,d=!1,e=0,f=a.length,g,h,i;for(;e<f;e++)i=a[e],h=c.data.indexOf(i),c.snapshot&&c.snapshot.remove(i),h>-1&&(g=i.phantom===!0,!b&&!g&&c.removed.push(i),i.unjoin(c),c.data.remove(i),d=d||!g,c.fireEvent("remove",c,i,h));c.fireEvent("datachanged",c),!b&&c.autoSync&&d&&!c.autoSyncSuspended&&c.sync()},removeAt:function(a){var b=this.getAt(a);b&&this.remove(b)},load:function(a){var b=this;return a=a||{},typeof a=="function"&&(a={callback:a}),a.groupers=a.groupers||b.groupers.items,a.page=a.page||b.currentPage,a.start=a.start!==undefined?a.start:(b.currentPage-1)*b.pageSize,a.limit=a.limit||b.pageSize,a.addRecords=a.addRecords||!1,b.buffered?b.loadToPrefetch(a):b.callParent([a])},onProxyLoad:function(a){var b=this,c=a.getResultSet(),d=a.getRecords(),e=a.wasSuccessful();c&&(b.totalCount=c.total),e&&b.loadRecords(d,a),b.loading=!1,b.fireEvent("load",b,d,e),b.fireEvent("read",b,d,a.wasSuccessful()),Ext.callback(a.callback,a.scope||b,[d,a,e])},getNewRecords:function(){return this.data.filterBy(this.filterNew).items},getUpdatedRecords:function(){return this.data.filterBy(this.filterUpdated).items},filter:function(a,b){Ext.isString(a)&&(a={property:a,value:b});var c=this,d=c.decodeFilters(a),e=0,f=c.sorters.length&&c.sortOnFilter&&!c.remoteSort,g=d.length;for(;e<g;e++)c.filters.replace(d[e]);c.remoteFilter?c.buffered?(c.pageMap.clear(),c.loadPage(1)):(c.currentPage=1,c.load()):c.filters.getCount()&&(c.snapshot=c.snapshot||c.data.clone(),c.data=c.data.filter(c.filters.items),f?c.sort():(c.fireEvent("datachanged",c),c.fireEvent("refresh",c)))},clearFilter:function(a){var b=this;b.filters.clear();if(b.remoteFilter){if(a)return;b.buffered?(b.pageMap.clear(),b.loadPage(1)):(b.currentPage=1,b.load())}else b.isFiltered()&&(b.data=b.snapshot.clone(),delete b.snapshot,a!==!0&&(b.fireEvent("datachanged",b),b.fireEvent("refresh",b)))},isFiltered:function(){var a=this.snapshot;return!!a&&a!==this.data},filterBy:function(a,b){var c=this;c.snapshot=c.snapshot||c.data.clone(),c.data=c.queryBy(a,b||c),c.fireEvent("datachanged",c),c.fireEvent("refresh",c)},queryBy:function(a,b){var c=this,d=c.snapshot||c.data;return d.filterBy(a,b||c)},loadData:function(a,b){var c=this.model,d=a.length,e=[],f,g;for(f=0;f<d;f++)g=a[f],g instanceof Ext.data.Model||(g=Ext.ModelManager.create(g,c)),e.push(g);this.loadRecords(e,{addRecords:b})},loadRawData:function(a,b){var c=this,d=c.proxy.reader.read(a),e=d.records;d.success&&(c.totalCount=d.total,c.loadRecords(e,{addRecords:b}),c.fireEvent("load",c,e,!0))},loadRecords:function(a,b){var c=this,d=0,e=a.length,f=(b=b||{}).start,g=c.snapshot;b.addRecords?g&&g.addAll(a):(delete c.snapshot,c.clearData(!0)),c.data.addAll(a);if(typeof f!="undefined")for(;d<e;d++)a[d].index=f+d,a[d].join(c);else for(;d<e;d++)a[d].join(c);c.suspendEvents(),c.filterOnLoad&&!c.remoteFilter&&c.filter(),c.sortOnLoad&&!c.remoteSort&&c.sort(),c.resumeEvents(),c.fireEvent("datachanged",c),c.fireEvent("refresh",c)},loadPage:function(a,b){var c=this;c.currentPage=a,b=Ext.apply({page:a,start:(a-1)*c.pageSize,limit:c.pageSize,addRecords:!c.clearOnPageLoad},b);if(c.buffered)return c.loadToPrefetch(b);c.read(b)},nextPage:function(a){this.loadPage(this.currentPage+1,a)},previousPage:function(a){this.loadPage(this.currentPage-1,a)},clearData:function(a){var b=this,c=b.data.items,d=c.length;while(d--)c[d].unjoin(b);b.data.clear();if(a!==!0||b.clearRemovedOnLoad)b.removed=[]},loadToPrefetch:function(a){var b=this,c=function(){b.rangeCached(a.start,a.limit-1)&&(b.pageMap.un("pageAdded",c),b.guaranteeRange(a.start,(b.viewSize||b.pageSize)-1))};return b.pageMap.on("pageAdded",c),b.prefetch(a||{})},prefetch:function(a){var b=this,c=b.pageSize,d;return c?(b.lastPageSize&&c!=b.lastPageSize&&Ext.error.raise("pageSize cannot be dynamically altered"),b.pageMap.pageSize||(b.pageMap.pageSize=c)):b.pageSize=b.pageMap.pageSize=c=a.limit,b.lastPageSize=c,a.page||(a.page=b.getPageFromRecordIndex(a.start),a.start=(a.page-1)*c,a.limit=Math.ceil(a.limit/c)*c),b.pageRequests[a.page]||(a=Ext.apply({action:"read",filters:b.filters.items,sorters:b.sorters.items,generation:b.pageMap.generation},a),d=new Ext.data.Operation(a),b.fireEvent("beforeprefetch",b,d)!==!1&&(b.loading=!0,b.pageRequests[a.page]=b.proxy.read(d,b.onProxyPrefetch,b))),b},cancelAllPrefetches:function(){var a=this,b=a.pageRequests,c,d;a.pageMap.events.pageadded&&a.pageMap.events.pageadded.clearListeners();for(d in b)b.hasOwnProperty(d)&&(c=b[d],delete b[d],delete c.callback)},prefetchPage:function(a,b){var c=this,d=c.pageSize||c.defaultPageSize,e=(a-1)*c.pageSize,f=c.totalCount;if(f!==undefined&&c.getCount()===f)return;c.prefetch(Ext.apply({page:a,start:e,limit:d},b))},onProxyPrefetch:function(a){var b=this,c=a.getResultSet(),d=a.getRecords(),e=a.wasSuccessful(),f=a.page;a.generation===b.pageMap.generation&&(c&&(b.totalCount=c.total,b.fireEvent("totalcountchange",b.totalCount)),f!==undefined&&delete b.pageRequests[f],e&&b.cachePage(d,a.page),b.loading=!1,b.fireEvent("prefetch",b,d,e,a),Ext.callback(a.callback,a.scope||b,[d,a,e]))},cachePage:function(a,b){var c=this;Ext.isDefined(c.totalCount)||(c.totalCount=a.length,c.fireEvent("totalcountchange",c.totalCount)),c.pageMap.addPage(b,a)},rangeCached:function(a,b){return this.pageMap&&this.pageMap.hasRange(a,b)},pageCached:function(a){return this.pageMap&&this.pageMap.hasPage(a)},rangeSatisfied:function(a,b){return this.rangeCached(a,b)},getPageFromRecordIndex:function(a){return Math.floor(a/this.pageSize)+1},onGuaranteedRange:function(a){var b=this,c=b.getTotalCount(),d=a.prefetchStart,e=c-1<a.prefetchEnd?c-1:a.prefetchEnd,f;e=Math.max(0,e),f=b.pageMap.getRange(d,e),b.fireEvent("guaranteedrange",f,d,e),a.cb&&a.cb.call(a.scope||b,f,d,e)},prefetchRange:function(a,b){var c=this,d,e,f;if(!c.rangeCached(a,b)){d=c.getPageFromRecordIndex(a),e=c.getPageFromRecordIndex(b),c.pageMap.maxSize=c.purgePageCount?e-d+1+c.purgePageCount:0;for(f=d;f<=e;f++)c.pageCached(f)||c.prefetchPage(f)}},guaranteeRange:function(a,b,c,d){b=b>this.totalCount?this.totalCount-1:b;var e=this,f=e.lastRequestStart,g={prefetchStart:a,prefetchEnd:b,cb:c,scope:d},h;e.lastRequestStart=a,e.rangeCached(a,b)?(a<f?(a=Math.max(a-e.leadingBufferZone,0),b=Math.min(b+e.trailingBufferZone,e.totalCount-1)):(a=Math.max(Math.min(a-e.trailingBufferZone,e.totalCount-e.pageSize),0),b=Math.min(b+e.leadingBufferZone,e.totalCount-1)),e.rangeCached(a,b)||e.prefetchRange(a,b),e.onGuaranteedRange(g)):(e.fireEvent("cachemiss",e,a,b),a=Math.min(Math.max(Math.floor(a-(e.leadingBufferZone+e.trailingBufferZone)/2),0),e.totalCount-e.pageSize),b=Math.min(Math.max(Math.ceil(b+(e.leadingBufferZone+e.trailingBufferZone)/2),0),e.totalCount-1),h=function(c,d){e.rangeCached(g.prefetchStart,g.prefetchEnd)&&(e.fireEvent("cachefilled",e,a,b),e.pageMap.un("pageAdded",h),e.onGuaranteedRange(g))},e.pageMap.on("pageAdded",h),e.prefetchRange(g.prefetchStart,g.prefetchEnd),e.prefetchRange(a,b))},sort:function(){var a=this,b=a.pageMap;a.buffered?a.remoteSort?(b.clear(),a.callParent(arguments)):a.callParent(arguments):a.callParent(arguments)},doSort:function(a){var b=this,c,d,e;if(b.remoteSort)b.buffered?(b.pageMap.clear(),b.loadPage(1)):b.load();else{b.data.sortBy(a);if(!b.buffered){c=b.getRange(),d=c.length,e=0;for(;e<d;e++)c[e].index=e}b.fireEvent("datachanged",b),b.fireEvent("refresh",b)}},find:function(a,b,c,d,e,f){var g=this.createFilterFn(a,b,d,e,f);return g?this.data.findIndexBy(g,null,c):-1},findRecord:function(){var a=this,b=a.find.apply(a,arguments);return b!==-1?a.getAt(b):null},createFilterFn:function(a,b,c,d,e){return Ext.isEmpty(b)?!1:(b=this.data.createValueMatcher(b,c,d,e),function(c){return b.test(c.data[a])})},findExact:function(a,b,c){return this.data.findIndexBy(function(c){return c.isEqual(c.get(a),b)},this,c)},findBy:function(a,b,c){return this.data.findIndexBy(a,b,c)},collect:function(a,b,c){var d=this,e=c===!0&&d.snapshot?d.snapshot:d.data;return e.collect(a,"data",b)},getCount:function(){return this.data.length||0},getTotalCount:function(){return this.totalCount||0},getAt:function(a){return this.data.getAt(a)},getRange:function(a,b){return this.data.getRange(a,b)},getById:function(a){return(this.snapshot||this.data).findBy(function(b){return b.getId()===a})},indexOf:function(a){return this.data.indexOf(a)},indexOfTotal:function(a){var b=a.index;return b||b===0?b:this.indexOf(a)},indexOfId:function(a){return this.indexOf(this.getById(a))},removeAll:function(a){var b=this;b.clearData(),b.snapshot&&b.snapshot.clear(),b.pageMap&&b.pageMap.clear(),a!==!0&&b.fireEvent("clear",b)},first:function(a){var b=this;return a&&b.isGrouped()?b.aggregate(function(a){return a.length?a[0]:undefined},b,!0):b.data.first()},last:function(a){var b=this;return a&&b.isGrouped()?b.aggregate(function(a){var b=a.length;return b?a[b-1]:undefined},b,!0):b.data.last()},sum:function(a,b){var c=this;return b&&c.isGrouped()?c.aggregate(c.getSum,c,!0,[a]):c.getSum(c.data.items,a)},getSum:function(a,b){var c=0,d=0,e=a.length;for(;d<e;++d)c+=a[d].get(b);return c},count:function(a){var b=this;return a&&b.isGrouped()?b.aggregate(function(a){return a.length},b,!0):b.getCount()},min:function(a,b){var c=this;return b&&c.isGrouped()?c.aggregate(c.getMin,c,!0,[a]):c.getMin(c.data.items,a)},getMin:function(a,b){var c=1,d=a.length,e,f;d>0&&(f=a[0].get(b));for(;c<d;++c)e=a[c].get(b),e<f&&(f=e);return f},max:function(a,b){var c=this;return b&&c.isGrouped()?c.aggregate(c.getMax,c,!0,[a]):c.getMax(c.data.items,a)},getMax:function(a,b){var c=1,d=a.length,e,f;d>0&&(f=a[0].get(b));for(;c<d;++c)e=a[c].get(b),e>f&&(f=e);return f},average:function(a,b){var c=this;return b&&c.isGrouped()?c.aggregate(c.getAverage,c,!0,[a]):c.getAverage(c.data.items,a)},getAverage:function(a,b){var c=0,d=a.length,e=0;if(a.length>0){for(;c<d;++c)e+=a[c].get(b);return e/d}return 0},aggregate:function(a,b,c,d){d=d||[];if(c&&this.isGrouped()){var e=this.getGroups(),f=0,g=e.length,h={},i;for(;f<g;++f)i=e[f],h[i.name]=a.apply(b||this,[i.children].concat(d));return h}return a.apply(b||this,[this.data.items].concat(d))},commitChanges:function(){var a=this,b=a.getModifiedRecords(),c=b.length,d=0;for(;d<c;d++)b[d].commit();a.removed.length=0},filterNewOnly:function(a){return a.phantom===!0},getRejectRecords:function(){var a=this.data.filterBy(this.filterNewOnly).items;return a.concat(this.getUpdatedRecords())},rejectChanges:function(){var a=this,b=a.getRejectRecords(),c=b.length,d=0,e;for(;d<c;d++)e=b[d],e.reject(),e.phantom&&a.remove(e);b=a.removed,c=b.length;for(d=0;d<c;d++)e=b[d],a.insert(e.index||0,e),e.reject();a.removed.length=0}},function(){Ext.regStore("ext-empty-store",{fields:[],proxy:"memory"}),this.prototype.PageMap=new Ext.Class({extend:"Ext.util.LruCache",clear:function(a){this.generation=(this.generation||0)+1,this.callParent(arguments)},getPageFromRecordIndex:this.prototype.getPageFromRecordIndex,addPage:function(a,b){this.add(a,b),this.fireEvent("pageAdded",a,b)},getPage:function(a){return this.get(a)},hasRange:function(a,b){var c=this.getPageFromRecordIndex(a),d=this.getPageFromRecordIndex(b);for(;c<=d;c++)if(!this.hasPage(c))return!1;return!0},hasPage:function(a){return!!this.map[a]},getRange:function(a,b){this.hasRange(a,b)||Ext.Error.raise("PageMap asked for range which it does not have");var c=this,d=c.getPageFromRecordIndex(a),e=c.getPageFromRecordIndex(b),f=(d-1)*c.pageSize,g=e*c.pageSize-1,h=d,i=[],j,k,l,m=0,n;for(;h<=e;h++)h==d?(j=a-f,l=!0):(j=0,l=!1),h==e&&(k=c.pageSize-(g-b),l=!0),l?Ext.Array.push(i,Ext.Array.slice(c.getPage(h),j,k)):Ext.Array.push(i,c.getPage(h));for(n=i.length;m<n;m++)i[m].index=a++;return i}})}),Ext.define("Ext.data.ArrayStore",{extend:"Ext.data.Store",alias:"store.array",requires:["Ext.data.proxy.Memory","Ext.data.reader.Array"],constructor:function(a){a=Ext.apply({proxy:{type:"memory",reader:"array"}},a),this.callParent([a])},loadData:function(a,b){if(this.expandData===!0){var c=[],d=0,e=a.length;for(;d<e;d++)c[c.length]=[a[d]];a=c}this.callParent([a,b])}},function(){Ext.data.SimpleStore=Ext.data.ArrayStore}),Ext.define("Ext.data.BufferStore",{extend:"Ext.data.Store",alias:"store.buffer",sortOnLoad:!1,filterOnLoad:!1,constructor:function(){Ext.Error.raise("The BufferStore class has been deprecated. Instead, specify the buffered config option on Ext.data.Store")}}),Ext.define("Ext.data.JsonPStore",{extend:"Ext.data.Store",alias:"store.jsonp",requires:["Ext.data.proxy.JsonP","Ext.data.reader.Json"],constructor:function(a){a=Ext.apply({proxy:{type:"jsonp",reader:"json"}},a),this.callParent([a])}}),Ext.define("Ext.data.JsonStore",{extend:"Ext.data.Store",alias:"store.json",requires:["Ext.data.proxy.Ajax","Ext.data.reader.Json","Ext.data.writer.Json"],constructor:function(a){a=Ext.apply({proxy:{type:"ajax",reader:"json",writer:"json"}},a),this.callParent([a])}}),Ext.define("Ext.data.NodeStore",{extend:"Ext.data.Store",alias:"store.node",requires:["Ext.data.NodeInterface"],node:null,recursive:!1,rootVisible:!1,constructor:function(a){var b=this,c;a=a||{},Ext.apply(b,a),a.proxy={type:"proxy"},b.callParent([a]),c=b.node,c&&(b.node=null,b.setNode(c))},setNode:function(a){var b=this;b.node&&b.node!=a&&(b.mun(b.node,{expand:b.onNodeExpand,collapse:b.onNodeCollapse,append:b.onNodeAppend,insert:b.onNodeInsert,remove:b.onNodeRemove,sort:b.onNodeSort,scope:b}),b.node=null),a&&(Ext.data.NodeInterface.decorate(a.self),b.removeAll(),b.rootVisible?b.add(a):!a.isExpanded()&&b.treeStore.autoLoad!==!1&&a.expand(),b.mon(a,{expand:b.onNodeExpand,collapse:b.onNodeCollapse,append:b.onNodeAppend,insert:b.onNodeInsert,remove:b.onNodeRemove,sort:b.onNodeSort,scope:b}),b.node=a,a.isExpanded()&&a.isLoaded()&&b.onNodeExpand(a,a.childNodes,!0))},onNodeSort:function(a,b){var c=this;if(c.indexOf(a)!==-1||a===c.node&&!c.rootVisible&&a.isExpanded())c.onNodeCollapse(a,b,!0),c.onNodeExpand(a,b,!0)},onNodeExpand:function(a,b,c){var d=this,e=d.indexOf(a)+1,f=b?b.length:0,g,h;if(!d.recursive&&a!==d.node)return;if(a!==this.node&&!d.isVisible(a))return;if(!c&&d.fireEvent("beforeexpand",a,b,e)===!1)return;if(f){d.insert(e,b);for(g=0;g<f;g++)h=b[g],h.isExpanded()&&(h.isLoaded()?d.onNodeExpand(h,h.childNodes,!0):(h.set("expanded",!1),h.expand()))}c||d.fireEvent("expand",a,b)},onNodeCollapse:function(a,b,c){var d=this,e=b.length,f=d.indexOf(a)+1,g,h;if(!d.recursive&&a!==d.node)return;if(!c&&d.fireEvent("beforecollapse",a,b,f)===!1)return;for(g=0;g<e;g++)h=b[g],d.remove(h),h.isExpanded()&&d.onNodeCollapse(h,h.childNodes,!0);c||d.fireEvent("collapse",a,b,f)},onNodeAppend:function(a,b,c){var d=this,e,f;if(d.isVisible(b)){if(c===0)e=a;else{f=b.previousSibling;while(f.isExpanded()&&f.lastChild)f=f.lastChild;e=f}d.insert(d.indexOf(e)+1,b),!b.isLeaf()&&b.isExpanded()&&(b.isLoaded()?d.onNodeExpand(b,b.childNodes,!0):(b.set("expanded",!1),b.expand()))}},onNodeInsert:function(a,b,c){var d=this,e=this.indexOf(c);e!=-1&&d.isVisible(b)&&(d.insert(e,b),!b.isLeaf()&&b.isExpanded()&&(b.isLoaded()?d.onNodeExpand(b,b.childNodes,!0):(b.set("expanded",!1),b.expand())))},onNodeRemove:function(a,b,c){var d=this;d.indexOf(b)!=-1&&(!b.isLeaf()&&b.isExpanded()&&d.onNodeCollapse(b,b.childNodes,!0),d.remove(b))},isVisible:function(a){var b=a.parentNode;while(b){if(b===this.node&&!this.rootVisible&&b.isExpanded())return!0;if(this.indexOf(b)===-1||!b.isExpanded())return!1;b=b.parentNode}return!0}}),Ext.define("Ext.data.XmlStore",{extend:"Ext.data.Store",alias:"store.xml",requires:["Ext.data.proxy.Ajax","Ext.data.reader.Xml","Ext.data.writer.Xml"],constructor:function(a){a=Ext.apply({proxy:{type:"ajax",reader:"xml",writer:"xml"}},a),this.callParent([a])}}),Ext.define("Ext.data.proxy.Rest",{extend:"Ext.data.proxy.Ajax",alternateClassName:"Ext.data.RestProxy",alias:"proxy.rest",appendId:!0,batchActions:!1,buildUrl:function(a){var b=this,c=a.operation,d=c.records||[],e=d[0],f=b.format,g=b.getUrl(a),h=e?e.getId():c.id;return b.appendId&&h&&(g.match(/\/$/)||(g+="/"),g+=h),f&&(g.match(/\.$/)||(g+="."),g+=f),a.url=g,b.callParent(arguments)}},function(){Ext.apply(this.prototype,{actionMethods:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"}})}),Ext.define("Ext.direct.Manager",{singleton:!0,mixins:{observable:"Ext.util.Observable"},requires:["Ext.util.MixedCollection"],statics:{exceptions:{TRANSPORT:"xhr",PARSE:"parse",LOGIN:"login",SERVER:"exception"}},constructor:function(){var a=this;a.addEvents("event","exception"),a.transactions=new Ext.util.MixedCollection,a.providers=new Ext.util.MixedCollection,a.mixins.observable.constructor.call(a)},addProvider:function(a){var b=this,c=arguments,d=0,e;if(c.length>1){for(e=c.length;d<e;++d)b.addProvider(c[d]);return}return a.isProvider||(a=Ext.create("direct."+a.type+"provider",a)),b.providers.add(a),a.on("data",b.onProviderData,b),a.isConnected()||a.connect(),a},getProvider:function(a){return a.isProvider?a:this.providers.get(a)},removeProvider:function(a){var b=this,c=b.providers;return a=a.isProvider?a:c.get(a),a?(a.un("data",b.onProviderData,b),c.remove(a),a):null},addTransaction:function(a){return this.transactions.add(a),a},removeTransaction:function(a){return a=this.getTransaction(a),this.transactions.remove(a),a},getTransaction:function(a){return Ext.isObject(a)?a:this.transactions.get(a)},onProviderData:function(a,b){var c=this,d=0,e;if(Ext.isArray(b)){for(e=b.length;d<e;++d)c.onProviderData(a,b[d]);return}b.name&&b.name!="event"&&b.name!="exception"?c.fireEvent(b.name,b):b.status===!1&&c.fireEvent("exception",b),c.fireEvent("event",b,a)},parseMethod:function(a){if(Ext.isString(a)){var b=a.split("."),c=0,d=b.length,e=window;while(e&&c<d)e=e[b[c]],++c;a=Ext.isFunction(e)?e:null}return a||null}},function(){Ext.Direct=Ext.direct.Manager}),Ext.define("Ext.data.proxy.Direct",{extend:"Ext.data.proxy.Server",alternateClassName:"Ext.data.DirectProxy",alias:"proxy.direct",requires:["Ext.direct.Manager"],paramOrder:undefined,paramsAsHash:!0,directFn:undefined,paramOrderRe:/[\s,|]/,constructor:function(a){var b=this,c,d,e;b.callParent(arguments),c=b.paramOrder,Ext.isString(c)&&(b.paramOrder=c.split(b.paramOrderRe)),d=b.directFn,d&&(b.directFn=Ext.direct.Manager.parseMethod(d)),e=b.api;for(d in e)e.hasOwnProperty(d)&&(e[d]=Ext.direct.Manager.parseMethod(e[d]))},doRequest:function(a,b,c){var d=this,e=d.getWriter(),f=d.buildRequest(a,b,c),g=d.api[f.action]||d.directFn,h=f.params,i=[],j;a.allowWrite()&&(f=e.write(f)),a.action=="read"?(j=g.directCfg.method,i=j.getArgs(h,d.paramOrder,d.paramsAsHash)):i.push(f.jsonData),Ext.apply(f,{args:i,directFn:g}),i.push(d.createRequestCallback(f,a,b,c),d),g.apply(window,i)},applyEncoding:function(a){return a},createRequestCallback:function(a,b,c,d){var e=this;return function(f,g){e.processResponse(g.status,b,a,g,c,d)}},extractResponseData:function(a){return Ext.isDefined(a.result)?a.result:a.data},setException:function(a,b){a.setException(b.message)},buildUrl:function(){return""}}),Ext.define("Ext.data.DirectStore",{extend:"Ext.data.Store",alias:"store.direct",requires:["Ext.data.proxy.Direct"],constructor:function(a){a=Ext.apply({},a);if(!a.proxy){var b={type:"direct",reader:{type:"json"}};Ext.copyTo(b,a,"paramOrder,paramsAsHash,directFn,api,simpleSortMode"),Ext.copyTo(b.reader,a,"totalProperty,root,idProperty"),a.proxy=b}this.callParent([a])}}),Ext.define("Ext.direct.Event",{alias:"direct.event",requires:["Ext.direct.Manager"],status:!0,constructor:function(a){Ext.apply(this,a)},getData:function(){return this.data}}),Ext.define("Ext.direct.RemotingEvent",{extend:"Ext.direct.Event",alias:"direct.rpc",getTransaction:function(){return this.transaction||Ext.direct.Manager.getTransaction(this.tid)}}),Ext.define("Ext.direct.ExceptionEvent",{extend:"Ext.direct.RemotingEvent",alias:"direct.exception",status:!1}),Ext.define("Ext.direct.RemotingProvider",{alias:"direct.remotingprovider",extend:"Ext.direct.JsonProvider",requires:["Ext.util.MixedCollection","Ext.util.DelayedTask","Ext.direct.Transaction","Ext.direct.RemotingMethod"],enableBuffer:10,maxRetries:1,timeout:undefined,constructor:function(a){var b=this;b.callParent(arguments),b.addEvents("beforecall","call"),b.namespace=Ext.isString(b.namespace)?Ext.ns(b.namespace):b.namespace||window,b.transactions=new Ext.util.MixedCollection,b.callBuffer=[]},initAPI:function(){var a=this.actions,b=this.namespace,c,d,e,f,g,h;for(c in a)if(a.hasOwnProperty(c)){d=b[c],d||(d=b[c]={}),e=a[c];for(f=0,g=e.length;f<g;++f)h=new Ext.direct.RemotingMethod(e[f]),d[h.name]=this.createHandler(c,h)}},createHandler:function(a,b){var c=this,d;return b.formHandler?d=function(d,e,f){c.configureFormRequest(a,b,d,e,f)}:d=function(){c.configureRequest(a,b,Array.prototype.slice.call(arguments,0))},d.directCfg={action:a,method:b},d},isConnected:function(){return!!this.connected},connect:function(){var a=this;a.url?(a.initAPI(),a.connected=!0,a.fireEvent("connect",a)):!!a.url},disconnect:function(){var a=this;a.connected&&(a.connected=!1,a.fireEvent("disconnect",a))},runCallback:function(a,b){var c=!!b.status,d=c?"success":"failure",e,f;a&&a.callback&&(e=a.callback,f=Ext.isDefined(b.result)?b.result:b.data,Ext.isFunction(e)?e(f,b,c):(Ext.callback(e[d],e.scope,[f,b,c]),Ext.callback(e.callback,e.scope,[f,b,c])))},onData:function(a,b,c){var d=this,e=0,f,g,h,i,j;if(b){g=d.createEvents(c);for(f=g.length;e<f;++e)h=g[e],i=d.getTransaction(h),d.fireEvent("data",d,h),i&&(d.runCallback(i,h,!0),Ext.direct.Manager.removeTransaction(i))}else{j=[].concat(a.transaction);for(f=j.length;e<f;++e)i=d.getTransaction(j[e]),i&&i.retryCount<d.maxRetries?i.retry():(h=new Ext.direct.ExceptionEvent({data:null,transaction:i,code:Ext.direct.Manager.self.exceptions.TRANSPORT,message:"Unable to connect to the server.",xhr:c}),d.fireEvent("data",d,h),i&&(d.runCallback(i,h,!1),Ext.direct.Manager.removeTransaction(i)))}},getTransaction:function(a){return a&&a.tid?Ext.direct.Manager.getTransaction(a.tid):null},configureRequest:function(a,b,c){var d=this,e=b.getCallData(c),f=e.data,g=e.callback,h=e.scope,i;i=new Ext.direct.Transaction({provider:d,args:c,action:a,method:b.name,data:f,callback:h&&Ext.isFunction(g)?Ext.Function.bind(g,h):g}),d.fireEvent("beforecall",d,i,b)!==!1&&(Ext.direct.Manager.addTransaction(i),d.queueTransaction(i),d.fireEvent("call",d,i,b))},getCallData:function(a){return{action:a.action,method:a.method,data:a.data,type:"rpc",tid:a.id}},sendRequest:function(a){var b=this,c={url:b.url,callback:b.onData,scope:b,transaction:a,timeout:b.timeout},d,e=b.enableUrlEncode,f=0,g,h;if(Ext.isArray(a)){d=[];for(g=a.length;f<g;++f)d.push(b.getCallData(a[f]))}else d=b.getCallData(a);e?(h={},h[Ext.isString(e)?e:"data"]=Ext.encode(d),c.params=h):c.jsonData=d,Ext.Ajax.request(c)},queueTransaction:function(a){var b=this,c=b.enableBuffer;if(a.form){b.sendFormRequest(a);return}b.callBuffer.push(a),c?(b.callTask||(b.callTask=new Ext.util.DelayedTask(b.combineAndSend,b)),b.callTask.delay(Ext.isNumber(c)?c:10)):b.combineAndSend()},combineAndSend:function(){var a=this.callBuffer,b=a.length;b>0&&(this.sendRequest(b==1?a[0]:a),this.callBuffer=[])},configureFormRequest:function(a,b,c,d,e){var f=this,g=new Ext.direct.Transaction({provider:f,action:a,method:b.name,args:[c,d,e],callback:e&&Ext.isFunction(d)?Ext.Function.bind(d,e):d,isForm:!0}),h,i;f.fireEvent("beforecall",f,g,b)!==!1&&(Ext.direct.Manager.addTransaction(g),h=String(c.getAttribute("enctype")).toLowerCase()=="multipart/form-data",i={extTID:g.id,extAction:a,extMethod:b.name,extType:"rpc",extUpload:String(h)},Ext.apply(g,{form:Ext.getDom(c),isUpload:h,params:d&&Ext.isObject(d.params)?Ext.apply(i,d.params):i}),f.fireEvent("call",f,g,b),f.sendFormRequest(g))},sendFormRequest:function(a){Ext.Ajax.request({url:this.url,params:a.params,callback:this.onData,scope:this,form:a.form,isUpload:a.isUpload,transaction:a})}}),Ext.define("Ext.draw.CompositeSprite",{extend:"Ext.util.MixedCollection",mixins:{animate:"Ext.util.Animate"},autoDestroy:!1,isCompositeSprite:!0,constructor:function(a){var b=this;a=a||{},Ext.apply(b,a),b.addEvents("mousedown","mouseup","mouseover","mouseout","click"),b.id=Ext.id(null,"ext-sprite-group-"),b.callParent()},onClick:function(a){this.fireEvent("click",a)},onMouseUp:function(a){this.fireEvent("mouseup",a)},onMouseDown:function(a){this.fireEvent("mousedown",a)},onMouseOver:function(a){this.fireEvent("mouseover",a)},onMouseOut:function(a){this.fireEvent("mouseout",a)},attachEvents:function(a){var b=this;a.on({scope:b,mousedown:b.onMouseDown,mouseup:b.onMouseUp,mouseover:b.onMouseOver,mouseout:b.onMouseOut,click:b.onClick})},add:function(a,b){var c=this.callParent(arguments);return this.attachEvents(c),c},insert:function(a,b,c){return this.callParent(arguments)},remove:function(a){var b=this;return a.un({scope:b,mousedown:b.onMouseDown,mouseup:b.onMouseUp,mouseover:b.onMouseOver,mouseout:b.onMouseOut,click:b.onClick}),b.callParent(arguments)},getBBox:function(){var a=0,b,c,d=this.items,e=this.length,f=Infinity,g=f,h=-f,i=f,j=-f,k,l;for(;a<e;a++)b=d[a],b.el&&!b.bboxExcluded&&(c=b.getBBox(),g=Math.min(g,c.x),i=Math.min(i,c.y),h=Math.max(h,c.height+c.y),j=Math.max(j,c.width+c.x));return{x:g,y:i,height:h-i,width:j-g}},setAttributes:function(a,b){var c=0,d=this.items,e=this.length;for(;c<e;c++)d[c].setAttributes(a,b);return this},hide:function(a){var b=0,c=this.items,d=this.length;for(;b<d;b++)c[b].hide(a);return this},show:function(a){var b=0,c=this.items,d=this.length;for(;b<d;b++)c[b].show(a);return this},redraw:function(){var a=this,b=0,c=a.items,d=a.getSurface(),e=a.length;if(d)for(;b<e;b++)d.renderItem(c[b]);return a},setStyle:function(a){var b=0,c=this.items,d=this.length,e,f;for(;b<d;b++)e=c[b],f=e.el,f&&f.setStyle(a)},addCls:function(a){var b=0,c=this.items,d=this.getSurface(),e=this.length;if(d)for(;b<e;b++)d.addCls(c[b],a)},removeCls:function(a){var b=0,c=this.items,d=this.getSurface(),e=this.length;if(d)for(;b<e;b++)d.removeCls(c[b],a)},getSurface:function(){var a=this.first();return a?a.surface:null},destroy:function(){var a=this,b=a.getSurface(),c=a.autoDestroy,d;if(b)while(a.getCount()>0)d=a.first(),a.remove(d),b.remove(d,c);a.clearListeners()}}),Ext.define("Ext.chart.LegendItem",{extend:"Ext.draw.CompositeSprite",requires:["Ext.chart.Shape"],x:0,y:0,zIndex:500,boldRe:/bold\s\d{1,}.*/i,constructor:function(a){this.callParent(arguments),this.createLegend(a)},createLegend:function(a){function s(a){var b=d[a];return Ext.isArray(b)?b[f]:b}var b=this,c=a.yFieldIndex,d=b.series,e=d.type,f=b.yFieldIndex,g=b.legend,h=b.surface,i=g.x+b.x,j=g.y+b.y,k,l=b.zIndex,m,n,o,p,q=!1,r=Ext.apply(d.seriesStyle,d.style);n=b.add("label",h.add({type:"text",x:20,y:0,zIndex:(l||0)+2,fill:g.labelColor,font:g.labelFont,text:s("title")||s("yField"),style:{cursor:"pointer"}}));if(e==="line"||e==="scatter"){e==="line"&&b.add("line",h.add({type:"path",path:"M0.5,0.5L16.5,0.5",zIndex:(l||0)+2,"stroke-width":d.lineWidth,"stroke-linejoin":"round","stroke-dasharray":d.dash,stroke:r.stroke||d.getLegendColor(c)||"#000",style:{cursor:"pointer"}}));if(d.showMarkers||e==="scatter")m=Ext.apply(d.markerStyle,d.markerConfig||{},{fill:d.getLegendColor(c)}),b.add("marker",Ext.chart.Shape[m.type](h,{fill:m.fill,x:8.5,y:.5,zIndex:(l||0)+2,radius:m.radius||m.size,style:{cursor:"pointer"}}))}else b.add("box",h.add({type:"rect",zIndex:(l||0)+2,x:0,y:0,width:12,height:12,fill:d.getLegendColor(c),style:{cursor:"pointer"}}));b.setAttributes({hidden:!1},!0),k=b.getBBox(),o=b.add("mask",h.add({type:"rect",x:k.x,y:k.y,width:k.width||20,height:k.height||20,zIndex:(l||0)+1,fill:b.legend.boxFill,style:{cursor:"pointer"}})),b.on("mouseover",function(){n.setStyle({"font-weight":"bold"}),o.setStyle({cursor:"pointer"}),d._index=c,d.highlightItem()},b),b.on("mouseout",function(){n.setStyle({"font-weight":g.labelFont&&b.boldRe.test(g.labelFont)?"bold":"normal"}),d._index=c,d.unHighlightItem()},b),d.visibleInLegend(c)||(q=!0,n.setAttributes({opacity:.5},!0)),b.on("mousedown",function(){q?(d.showAll(c),n.setAttributes({opacity:1},!0)):(d.hideAll(c),n.setAttributes({opacity:.5},!0)),q=!q},b),b.updatePosition({x:0,y:0})},updatePosition:function(a){var b=this,c=b.items,d=c.length,e=0,f;a||(a=b.legend);for(;e<d;e++){f=c[e];switch(f.type){case"text":f.setAttributes({x:20+a.x+b.x,y:a.y+b.y},!0);break;case"rect":f.setAttributes({translate:{x:a.x+b.x,y:a.y+b.y-6}},!0);break;default:f.setAttributes({translate:{x:a.x+b.x,y:a.y+b.y}},!0)}}}}),Ext.define("Ext.chart.Legend",{requires:["Ext.chart.LegendItem"],visible:!0,update:!0,position:"bottom",x:0,y:0,labelColor:"#000",labelFont:"12px Helvetica, sans-serif",boxStroke:"#000",boxStrokeWidth:1,boxFill:"#FFF",itemSpacing:10,padding:5,width:0,height:0,boxZIndex:100,constructor:function(a){var b=this;a&&Ext.apply(b,a),b.items=[],b.isVertical="left|right|float".indexOf(b.position)!==-1,b.origX=b.x,b.origY=b.y},create:function(){var a=this,b=a.chart.series.items,c,d,e;a.createBox(),a.rebuild!==!1&&a.createItems();if(!a.created&&a.isDisplayed()){a.created=!0;for(c=0,d=b.length;c<d;c++)e=b[c],e.on("titlechange",function(){a.create(),a.updatePosition()})}},isDisplayed:function(){return this.visible&&this.chart.series.findIndex("showInLegend",!0)!==-1},createItems:function(){var a=this,b=a.chart,c=b.series.items,d,e,f=b.surface,g=a.items,h=a.padding,i=a.itemSpacing,j=2,k=0,l=0,m=0,n=0,o=a.isVertical,p=Math,q=p.floor,r=p.max,s=0,t=0,u=g?g.length:0,v,w,x,y,z,A,B,C,D,E,F;if(u)for(;t<u;t++)g[t].destroy();g.length=[];for(t=0,d=c.length;t<d;t++){e=c[t];if(e.showInLegend){C=[].concat(e.yField);for(F=0,E=C.length;F<E;F++)D=C[F],y=new Ext.chart.LegendItem({legend:this,series:e,surface:b.surface,yFieldIndex:F}),z=y.getBBox(),B=z.width,A=z.height,t+F===0?x=o?h+A/2:h:x=i/(o?2:1),y.x=q(o?h:m+x),y.y=q(o?n+x:h+A/2),m+=B+x,n+=A+x,k=r(k,B),l=r(l,A),g.push(y)}}a.width=q((o?k:m)+h*2),o&&g.length===1&&(j=1),a.height=q((o?n-j*x:l)+h*2),a.itemHeight=l},getBBox:function(){var a=this;return{x:Math.round(a.x)-a.boxStrokeWidth/2,y:Math.round(a.y)-a.boxStrokeWidth/2,width:a.width,height:a.height}},createBox:function(){var a=this,b,c;a.boxSprite&&a.boxSprite.destroy(),c=a.getBBox();if(isNaN(c.width)||isNaN(c.height)){a.boxSprite=!1;return}b=a.boxSprite=a.chart.surface.add(Ext.apply({type:"rect",stroke:a.boxStroke,"stroke-width":a.boxStrokeWidth,fill:a.boxFill,zIndex:a.boxZIndex},c)),b.redraw()},updatePosition:function(){var a=this,b=a.items,c,d,e,f,g=a.width||0,h=a.height||0,i=a.padding,j=a.chart,k=j.chartBBox,l=j.insetPadding,m=k.width-l*2,n=k.height-l*2,o=k.x+l,p=k.y+l,q=j.surface,r=Math.floor,s;if(a.isDisplayed()){switch(a.position){case"left":e=l,f=r(p+n/2-h/2);break;case"right":e=r(q.width-g)-l,f=r(p+n/2-h/2);break;case"top":e=r(o+m/2-g/2),f=l;break;case"bottom":e=r(o+m/2-g/2),f=r(q.height-h)-l;break;default:e=r(a.origX)+l,f=r(a.origY)+l}a.x=e,a.y=f;for(c=0,d=b.length;c<d;c++)b[c].updatePosition();s=a.getBBox(),isNaN(s.width)||isNaN(s.height)?a.boxSprite&&a.boxSprite.hide(!0):(a.boxSprite||a.createBox(),a.boxSprite.setAttributes(s,!0),a.boxSprite.show(!0))}},toggle:function(a){var b=this,c=0,d=b.items,e=d.length;b.boxSprite&&(a?b.boxSprite.show(!0):b.boxSprite.hide(!0));for(;c<e;++c)a?d[c].show(!0):d[c].hide(!0);b.visible=a}}),Ext.define("Ext.draw.Surface",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.draw.CompositeSprite"],uses:["Ext.draw.engine.Svg","Ext.draw.engine.Vml","Ext.draw.engine.SvgExporter","Ext.draw.engine.ImageExporter"],separatorRe:/[, ]+/,statics:{create:function(a,b){b=b||["Svg","Vml"];var c=0,d=b.length,e;for(;c<d;c++)if(Ext.supports[b[c]]!==!1)return Ext.create("Ext.draw.engine."+b[c],a);return!1},save:function(a,b){var c={"image/png":"Image","image/jpeg":"Image","image/svg+xml":"Svg"},d=c[a.type]||"Svg";return Ext.draw.engine[d+"Exporter"].self.generate(a,b)}},availableAttrs:{blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,"dominant-baseline":"auto",fill:"none","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:"",height:0,hidden:!1,href:"http://sencha.com/",opacity:1,path:"M0,0",radius:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"none","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank",text:"","text-anchor":"middle",title:"Ext Draw",width:0,x:0,y:0,zIndex:0},container:undefined,height:352,width:512,x:0,y:0,orderSpritesByZIndex:!0,constructor:function(a){var b=this;a=a||{},Ext.apply(b,a),b.domRef=Ext.getDoc().dom,b.customAttributes={},b.addEvents("mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","click","dblclick"),b.mixins.observable.constructor.call(b),b.getId(),b.initGradients(),b.initItems(),b.renderTo&&(b.render(b.renderTo),delete b.renderTo),b.initBackground(a.background)},initSurface:Ext.emptyFn,renderItem:Ext.emptyFn,renderItems:Ext.emptyFn,setViewBox:function(a,b,c,d){isFinite(a)&&isFinite(b)&&isFinite(c)&&isFinite(d)&&(this.viewBox={x:a,y:b,width:c,height:d},this.applyViewBox())},addCls:Ext.emptyFn,removeCls:Ext.emptyFn,setStyle:Ext.emptyFn,initGradients:function(){if(this.hasOwnProperty("gradients")){var a=this.gradients,b=a.length,c=this.addGradient,d;if(a)for(d=0;d<b;d++)if(c.call(this,a[d],d,b)===!1)break}},initItems:function(){var a=this.items;this.items=new Ext.draw.CompositeSprite,this.items.autoDestroy=!0,this.groups=new Ext.draw.CompositeSprite,a&&this.add(a)},initBackground:function(a){var b=this,c=b.width,d=b.height,e,f,g;Ext.isString(a)&&(a={fill:a}),a&&(a.gradient?(f=a.gradient,e=f.id,b.addGradient(f),b.background=b.add({type:"rect",x:0,y:0,width:c,height:d,fill:"url(#"+e+")",zIndex:-1})):a.fill?b.background=b.add({type:"rect",x:0,y:0,width:c,height:d,fill:a.fill,zIndex:-1}):a.image&&(b.background=b.add({type:"image",x:0,y:0,width:c,height:d,src:a.image,zIndex:-1})),b.background.bboxExcluded=!0)},setSize:function(a,b){this.applyViewBox()},scrubAttrs:function(a){var b,c={},d={},e=a.attr;for(b in e)this.translateAttrs.hasOwnProperty(b)?(c[this.translateAttrs[b]]=e[b],d[this.translateAttrs[b]]=!0):this.availableAttrs.hasOwnProperty(b)&&!d[b]&&(c[b]=e[b]);return c},onClick:function(a){this.processEvent("click",a)},onDblClick:function(a){this.processEvent("dblclick",a)},onMouseUp:function(a){this.processEvent("mouseup",a)},onMouseDown:function(a){this.processEvent("mousedown",a)},onMouseOver:function(a){this.processEvent("mouseover",a)},onMouseOut:function(a){this.processEvent("mouseout",a)},onMouseMove:function(a){this.fireEvent("mousemove",a)},onMouseEnter:Ext.emptyFn,onMouseLeave:Ext.emptyFn,addGradient:Ext.emptyFn,add:function(){var a=Array.prototype.slice.call(arguments),b,c,d=a.length>1,e,f,g,h,i;if(d||Ext.isArray(a[0])){e=d?a:a[0],f=[];for(g=0,h=e.length;g<h;g++)i=e[g],i=this.add(i),f.push(i);return f}return b=this.prepareItems(a[0],!0)[0],this.insertByZIndex(b),this.onAdd(b),b},insertByZIndex:function(a){var b=this,c=b.items.items,d=c.length,e=Math.ceil,f=a.attr.zIndex,g=d,h=g-1,i=0,j;if(b.orderSpritesByZIndex&&d&&f<c[h].attr.zIndex){while(i<=h){g=e((i+h)/2),j=c[g].attr.zIndex;if(j>f)h=g-1;else{if(!(j<f))break;i=g+1}}while(g<d&&c[g].attr.zIndex<=f)g++}return b.items.insert(g,a),g},onAdd:function(a){var b=a.group,c=a.draggable,d,e,f;if(b){d=[].concat(b),e=d.length;for(f=0;f<e;f++)b=d[f],this.getGroup(b).add(a);delete a.group}c&&a.initDraggable()},remove:function(a,b){if(a){this.items.remove(a);var c=[].concat(this.groups.items),d=c.length,e;for(e=0;e<d;e++)c[e].remove(a);a.onRemove(),b===!0&&a.destroy()}},removeAll:function(a){var b=this.items.items,c=b.length,d;for(d=c-1;d>-1;d--)this.remove(b[d],a)},onRemove:Ext.emptyFn,onDestroy:Ext.emptyFn,applyViewBox:function(){var a=this,b=a.viewBox,c=a.width||1,d=a.height||1,e,f,g,h,i,j,k;b&&(c||d)?(e=b.x,f=b.y,g=b.width,h=b.height,i=d/h,j=c/g,k=Math.min(j,i),g*k<c&&(e-=(c-g*k)/2/k),h*k<d&&(f-=(d-h*k)/2/k),a.viewBoxShift={dx:-e,dy:-f,scale:k},a.background&&a.background.setAttributes(Ext.apply({},{x:e,y:f,width:c/k,height:d/k},{hidden:!1}),!0)):a.background&&c&&d&&a.background.setAttributes(Ext.apply({x:0,y:0,width:c,height:d},{hidden:!1}),!0)},getBBox:function(a,b){var c=this["getPath"+a.type](a);return b?(a.bbox.plain=a.bbox.plain||Ext.draw.Draw.pathDimensions(c),a.bbox.plain):(a.dirtyTransform&&this.applyTransformations(a,!0),a.bbox.transform=a.bbox.transform||Ext.draw.Draw.pathDimensions(Ext.draw.Draw.mapPath(c,a.matrix)),a.bbox.transform)},transformToViewBox:function(a,b){if(this.viewBoxShift){var c=this,d=c.viewBoxShift;return[a/d.scale-d.dx,b/d.scale-d.dy]}return[a,b]},applyTransformations:function(a,b){a.type=="text"&&(a.bbox.transform=0,this.transform(a,!1)),a.dirtyTransform=!1;var c=this,d=a.attr;(d.translation.x!=null||d.translation.y!=null)&&c.translate(a),(d.scaling.x!=null||d.scaling.y!=null)&&c.scale(a),d.rotation.degrees!=null&&c.rotate(a),a.bbox.transform=0,this.transform(a,b),a.transformations=[]},rotate:function(a){var b,c=a.attr.rotation.degrees,d=a.attr.rotation.x,e=a.attr.rotation.y;if(!Ext.isNumber(d)||!Ext.isNumber(e))b=this.getBBox(a,!0),d=Ext.isNumber(d)?d:b.x+b.width/2,e=Ext.isNumber(e)?e:b.y+b.height/2;a.transformations.push({type:"rotate",degrees:c,x:d,y:e})},translate:function(a){var b=a.attr.translation.x||0,c=a.attr.translation.y||0;a.transformations.push({type:"translate",x:b,y:c})},scale:function(a){var b,c=a.attr.scaling.x||1,d=a.attr.scaling.y||1,e=a.attr.scaling.centerX,f=a.attr.scaling.centerY;if(!Ext.isNumber(e)||!Ext.isNumber(f))b=this.getBBox(a,!0),e=Ext.isNumber(e)?e:b.x+b.width/2,f=Ext.isNumber(f)?f:b.y+b.height/2;a.transformations.push({type:"scale",x:c,y:d,centerX:e,centerY:f})},rectPath:function(a,b,c,d,e){return e?[["M",a+e,b],["l",c-e*2,0],["a",e,e,0,0,1,e,e],["l",0,d-e*2],["a",e,e,0,0,1,-e,e],["l",e*2-c,0],["a",e,e,0,0,1,-e,-e],["l",0,e*2-d],["a",e,e,0,0,1,e,-e],["z"]]:[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]]},ellipsePath:function(a,b,c,d){return d==null&&(d=c),[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]]},getPathpath:function(a){return a.attr.path},getPathcircle:function(a){var b=a.attr;return this.ellipsePath(b.x,b.y,b.radius,b.radius)},getPathellipse:function(a){var b=a.attr;return this.ellipsePath(b.x,b.y,b.radiusX||b.width/2||0,b.radiusY||b.height/2||0)},getPathrect:function(a){var b=a.attr;return this.rectPath(b.x||0,b.y||0,b.width||0,b.height||0,b.r||0)},getPathimage:function(a){var b=a.attr;return this.rectPath(b.x||0,b.y||0,b.width,b.height)},getPathtext:function(a){var b=this.getBBoxText(a);return this.rectPath(b.x,b.y,b.width,b.height)},createGroup:function(a){var b=this.groups.get(a);return b||(b=new Ext.draw.CompositeSprite({surface:this}),b.id=a||Ext.id(null,"ext-surface-group-"),this.groups.add(b)),b},getGroup:function(a){var b;return typeof a=="string"?(b=this.groups.get(a),b||(b=this.createGroup(a))):b=a,b},prepareItems:function(a,b){a=[].concat(a);var c,d,e;for(d=0,e=a.length;d<e;d++)c=a[d],c instanceof Ext.draw.Sprite?c.surface=this:(c.surface=this,a[d]=this.createItem(c));return a},setText:Ext.emptyFn,createItem:Ext.emptyFn,getId:function(){return this.id||(this.id=Ext.id(null,"ext-surface-"))},destroy:function(){var a=this;delete a.domRef,a.background&&a.background.destroy(),a.removeAll(!0),Ext.destroy(a.groups.items)}}),Ext.define("Ext.fx.Manager",{singleton:!0,requires:["Ext.util.MixedCollection","Ext.fx.target.Element","Ext.fx.target.ElementCSS","Ext.fx.target.CompositeElement","Ext.fx.target.CompositeElementCSS","Ext.fx.target.Sprite","Ext.fx.target.CompositeSprite","Ext.fx.target.Component"],mixins:{queue:"Ext.fx.Queue"},constructor:function(){this.items=new Ext.util.MixedCollection,this.mixins.queue.constructor.call(this)},interval:16,forceJS:!0,createTarget:function(a){var b=this,c=!b.forceJS&&Ext.supports.Transitions,d;b.useCSS3=c;if(a){if(a.tagName||Ext.isString(a)||a.isFly)a=Ext.get(a),d=new Ext.fx.target["Element"+(c?"CSS":"")](a);else if(a.dom)d=new Ext.fx.target["Element"+(c?"CSS":"")](a);else if(a.isComposite)d=new Ext.fx.target["CompositeElement"+(c?"CSS":"")](a);else if(a.isSprite)d=new Ext.fx.target.Sprite(a);else if(a.isCompositeSprite)d=new Ext.fx.target.CompositeSprite(a);else{if(!a.isComponent)return a.isAnimTarget?a:null;d=new Ext.fx.target.Component(a)}return b.targets.add(d),d}return null},addAnim:function(a){var b=this.items,c=this.task;b.add(a.id,a),!c&&b.length&&(c=this.task={run:this.runner,interval:this.interval,scope:this},Ext.TaskManager.start(c))},removeAnim:function(a){var b=this,c=b.items,d=b.task;c.removeAtKey(a.id),d&&!c.length&&(Ext.TaskManager.stop(d),delete b.task)},runner:function(){var a=this,b=a.items.getRange(),c=0,d=b.length,e;a.targetArr={},a.timestamp=new Date;for(;c<d;c++)e=b[c],e.isReady()&&a.startAnim(e);for(c=0;c<d;c++)e=b[c],e.isRunning()&&a.runAnim(e);a.applyPendingAttrs()},startAnim:function(a){a.start(this.timestamp)},runAnim:function(a){if(!a)return;var b=this,c=a.target.getId(),d=b.useCSS3&&a.target.type=="element",e=b.timestamp-a.startTime,f=e>=a.duration,g,h;g=this.collectTargetData(a,e,d,f),d&&(a.target.setAttr(g.anims[a.id].attributes,!0),b.collectTargetData(a,a.duration,d,f),a.paused=!0,g=a.target.target,a.target.isComposite&&(g=a.target.target.last()),h={},h[Ext.supports.CSS3TransitionEnd]=a.lastFrame,h.scope=a,h.single=!0,g.on(h))},collectTargetData:function(a,b,c,d){var e=a.target.getId(),f=this.targetArr[e];return f||(f=this.targetArr[e]={id:e,el:a.target,anims:{}}),f.anims[a.id]={id:a.id,anim:a,elapsed:b,isLastFrame:d,attributes:[{duration:a.duration,easing:c&&a.reverse?a.easingFn.reverse().toCSS3():a.easing,attrs:a.runAnim(b)}]},f},applyPendingAttrs:function(){var a=this.targetArr,b,c,d,e,f;for(c in a)if(a.hasOwnProperty(c)){b=a[c];for(f in b.anims)b.anims.hasOwnProperty(f)&&(d=b.anims[f],e=d.anim,d.attributes&&e.isRunning()&&(b.el.setAttr(d.attributes,!1,d.isLastFrame),d.isLastFrame&&e.lastFrame()))}}}),Ext.define("Ext.fx.Animator",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.fx.Manager"],isAnimator:!0,duration:250,delay:0,delayStart:0,dynamic:!1,easing:"ease",running:!1,paused:!1,damper:1,iterations:1,currentIteration:0,keyframeStep:0,animKeyFramesRE:/^(from|to|\d+%?)$/,constructor:function(a){var b=this;a=Ext.apply(b,a||{}),b.config=a,b.id=Ext.id(null,"ext-animator-"),b.addEvents("beforeanimate","keyframe","afteranimate"),b.mixins.observable.constructor.call(b,a),b.timeline=[],b.createTimeline(b.keyframes),b.target&&(b.applyAnimator(b.target),Ext.fx.Manager.addAnim(b))},sorter:function(a,b){return a.pct-b.pct},createTimeline:function(a){var b=this,c=[],d=b.to||{},e=b.duration,f,g,h,i,j,k,l,m;for(j in a)a.hasOwnProperty(j)&&b.animKeyFramesRE.test(j)&&(m={attrs:Ext.apply(a[j],d)},j=="from"?j=0:j=="to"&&(j=100),m.pct=parseInt(j,10),c.push(m));Ext.Array.sort(c,b.sorter),i=c.length;for(h=0;h<i;h++)f=c[h-1]?e*(c[h-1].pct/100):0,g=e*(c[h].pct/100),b.timeline.push({duration:g-f,attrs:c[h].attrs})},applyAnimator:function(a){var b=this,c=[],d=b.timeline,e=b.reverse,f=d.length,g,h,i,j,k,l,m;if(b.fireEvent("beforeanimate",b)!==!1){for(m=0;m<f;m++)g=d[m],k=g.attrs,h=k.easing||b.easing,i=k.damper||b.damper,delete k.easing,delete k.damper,g=new Ext.fx.Anim({target:a,easing:h,damper:i,duration:g.duration,paused:!0,to:k}),c.push(g);b.animations=c,b.target=g.target;for(m=0;m<f-1;m++)g=c[m],g.nextAnim=c[m+1],g.on("afteranimate",function(){this.nextAnim.paused=!1}),g.on("afteranimate",function(){this.fireEvent("keyframe",this,++this.keyframeStep)},b);c[f-1].on("afteranimate",function(){this.lastFrame()},b)}},start:function(a){var b=this,c=b.delay,d=b.delayStart,e;if(c){if(!d){b.delayStart=a;return}e=a-d;if(e<c)return;a=new Date(d.getTime()+c)}b.fireEvent("beforeanimate",b)!==!1&&(b.startTime=a,b.running=!0,b.animations[b.keyframeStep].paused=!1)},lastFrame:function(){var a=this,b=a.iterations,c=a.currentIteration;c++,c<b?(a.startTime=new Date,a.currentIteration=c,a.keyframeStep=0,a.applyAnimator(a.target),a.animations[a.keyframeStep].paused=!1):(a.currentIteration=0,a.end())},end:function(){var a=this;a.fireEvent("afteranimate",a,a.startTime,new Date-a.startTime)},isReady:function(){return this.paused===!1&&this.running===!1&&this.iterations>0},isRunning:function(){return!1}}),Ext.define("Ext.fx.Anim",{mixins:{observable:"Ext.util.Observable"},requires:["Ext.fx.Manager","Ext.fx.Animator","Ext.fx.Easing","Ext.fx.CubicBezier","Ext.fx.PropertyHandler"],isAnimation:!0,duration:250,delay:0,delayStart:0,dynamic:!1,easing:"ease",damper:1,bezierRE:/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,reverse:!1,running:!1,paused:!1,iterations:1,alternate:!1,currentIteration:0,startTime:0,frameCount:0,constructor:function(a){var b=this,c;a=a||{};if(a.keyframes)return new Ext.fx.Animator(a);Ext.apply(b,a),b.from===undefined&&(b.from={}),b.propHandlers={},b.config=a,b.target=Ext.fx.Manager.createTarget(b.target),b.easingFn=Ext.fx.Easing[b.easing],b.target.dynamic=b.dynamic,b.easingFn||(b.easingFn=String(b.easing).match(b.bezierRE),b.easingFn&&b.easingFn.length==5&&(c=b.easingFn,b.easingFn=Ext.fx.CubicBezier.cubicBezier(+c[1],+c[2],+c[3],+c[4]))),b.id=Ext.id(null,"ext-anim-"),b.addEvents("beforeanimate","afteranimate","lastframe"),b.mixins.observable.constructor.call(b),Ext.fx.Manager.addAnim(b)},setAttr:function(a,b){return Ext.fx.Manager.items.get(this.id).setAttr(this.target,a,b)},initAttrs:function(){var a=this,b=a.from,c=a.to,d=a.initialFrom||{},e={},f,g,h,i;for(i in c)c.hasOwnProperty(i)&&(f=a.target.getAttr(i,b[i]),g=c[i],Ext.fx.PropertyHandler[i]?h=a.propHandlers[i]=Ext.fx.PropertyHandler[i]:Ext.isObject(g)?h=a.propHandlers[i]=Ext.fx.PropertyHandler.object:h=a.propHandlers[i]=Ext.fx.PropertyHandler.defaultHandler,e[i]=h.get(f,g,a.damper,d[i],i));a.currentAttrs=e},start:function(a){var b=this,c=b.delay,d=b.delayStart,e;if(c){if(!d){b.delayStart=a;return}e=a-d;if(e<c)return;a=new Date(d.getTime()+c)}b.fireEvent("beforeanimate",b)!==!1&&(b.startTime=a,!b.paused&&!b.currentAttrs&&b.initAttrs(),b.running=!0,b.frameCount=0)},runAnim:function(a){var b=this,c=b.currentAttrs,d=b.duration,e=b.easingFn,f=b.propHandlers,g={},h,i,j,k;a>=d&&(a=d,k=!0),b.reverse&&(a=d-a);for(j in c)c.hasOwnProperty(j)&&(i=c[j],h=k?1:e(a/d),g[j]=f[j].set(i,h));return b.frameCount++,g},lastFrame:function(){var a=this,b=a.iterations,c=a.currentIteration;c++,c<b?(a.alternate&&(a.reverse=!a.reverse),a.startTime=new Date,a.currentIteration=c,a.paused=!1):(a.currentIteration=0,a.end(),a.fireEvent("lastframe",a,a.startTime))},endWasCalled:0,end:function(){if(this.endWasCalled++)return;var a=this;a.startTime=0,a.paused=!1,a.running=!1,Ext.fx.Manager.removeAnim(a),a.fireEvent("afteranimate",a,a.startTime),Ext.callback(a.callback,a.scope,[a,a.startTime])},isReady:function(){return this.paused===!1&&this.running===!1&&this.iterations>0},isRunning:function(){return this.paused===!1&&this.running===!0&&this.isAnimator!==!0}}),Ext.enableFx=!0,Ext.define("Ext.chart.Highlight",{requires:["Ext.fx.Anim"],highlight:!1,highlightCfg:{fill:"#fdd","stroke-width":5,stroke:"#f55"},constructor:function(a){a.highlight&&a.highlight!==!0&&(this.highlightCfg=Ext.merge(this.highlightCfg,a.highlight))},highlightItem:function(a){if(!a)return;var b=this,c=a.sprite,d=Ext.merge({},b.highlightCfg,b.highlight),e=b.chart.surface,f=b.chart.animate,g,h,i,j;if(!b.highlight||!c||c._highlighted)return;c._anim&&(c._anim.paused=!0),c._highlighted=!0;if(!c._defaults){c._defaults=Ext.apply({},c.attr),h={},i={};for(g in d){g in c._defaults||(c._defaults[g]=e.availableAttrs[g]),h[g]=c._defaults[g],i[g]=d[g];if(Ext.isObject(d[g])){h[g]={},i[g]={},Ext.apply(c._defaults[g],c.attr[g]),Ext.apply(h[g],c._defaults[g]);for(j in c._defaults[g])j in d[g]?i[g][j]=d[g][j]:i[g][j]=h[g][j];for(j in d[g])j in i[g]||(i[g][j]=d[g][j])}}c._from=h,c._to=i,c._endStyle=i}f?c._anim=new Ext.fx.Anim({target:c,from:c._from,to:c._to,duration:150}):c.setAttributes(c._to,!0)},unHighlightItem:function(){if(!this.highlight||!this.items)return;var a=this,b=a.items,c=b.length,d=Ext.merge({},a.highlightCfg,a.highlight),e=a.chart.animate,f=0,g,h,i;for(;f<c;f++){if(!b[f])continue;i=b[f].sprite;if(i&&i._highlighted){i._anim&&(i._anim.paused=!0),g={};for(h in d)Ext.isObject(i._defaults[h])?(g[h]={},Ext.apply(g[h],i._defaults[h])):g[h]=i._defaults[h];e?(i._endStyle=g,i._anim=new Ext.fx.Anim({target:i,to:g,duration:150})):i.setAttributes(g,!0),delete i._highlighted}}},cleanHighlights:function(){if(!this.highlight)return;var a=this.group,b=this.markerGroup,c=0,d;for(d=a.getCount();c<d;c++)delete a.getAt(c)._defaults;if(b)for(d=b.getCount();c<d;c++)delete b.getAt(c)._defaults}}),Ext.define("Ext.layout.Context",{requires:["Ext.util.Queue","Ext.layout.ContextItem","Ext.layout.Layout","Ext.fx.Anim","Ext.fx.Manager"],currentOwnerCtContext:null,remainingLayouts:0,state:0,constructor:function(a){var b=this;Ext.apply(b,a),b.items={},b.layouts={},b.blockCount=0,b.cycleCount=0,b.flushCount=0,b.calcCount=0,b.animateQueue=b.newQueue(),b.completionQueue=b.newQueue(),b.finalizeQueue=b.newQueue(),b.finishQueue=b.newQueue(),b.flushQueue=b.newQueue(),b.invalidateData={},b.layoutQueue=b.newQueue(),b.invalidQueue=[],b.triggers={data:{},dom:{}}},callLayout:function(a,b){this.currentLayout=a;var c=this.getCmp(a.owner);a[b](c)},cancelComponent:function(a,b){var c=this,d=a,e=!a.isComponent,f=e?d.length:1,g,h,i,j,k,l,m,n,o;for(g=0;g<f;++g){e&&(a=d[g]);if(!b){m=c.invalidQueue,i=m.length;if(i){c.invalidQueue=l=[];for(h=0;h<i;++h)n=m[h],o=n.item.target,o!=a&&!o.isDescendant(a)&&l.push(n)}}k=a.componentLayout,c.cancelLayout(k),k.getLayoutItems&&(j=k.getLayoutItems(),j.length&&c.cancelComponent(j,!0)),a.isContainer&&!a.collapsed&&(k=a.layout,c.cancelLayout(k),j=k.getVisibleItems(),j.length&&c.cancelComponent(j,!0))}},cancelLayout:function(a){var b=this;b.completionQueue.remove(a),b.finalizeQueue.remove(a),b.finishQueue.remove(a),b.layoutQueue.remove(a),a.running&&b.layoutDone(a),a.ownerContext=null},clearTriggers:function(a,b){var c=a.id,d=this.triggers[b?"dom":"data"][c],e=d&&d.length||0,f,g,h,i;for(g=0;g<e;++g)i=d[g],h=i.item,f=b?h.domTriggers:h.triggers,delete f[i.prop][c]},finishInvalidate:function(a,b,c){if(a[c]){var d=this,e=d.currentLayout;d.currentLayout=a.layout||null,a[c](b,a),d.currentLayout=e}},flush:function(){var a=this,b=a.flushQueue.clear(),c=b.length,d;if(c){++a.flushCount;for(d=0;d<c;++d)b[d].flush()}},flushAnimations:function(){var a=this,b=a.animateQueue.clear(),c=b.length,d;if(c){for(d=0;d<c;d++)b[d].target.animate!==!1&&b[d].flushAnimations();Ext.fx.Manager.runner()}},flushInvalidates:function(){var a=this,b=a.invalidQueue,c=b&&b.length,d,e,f,g;a.invalidQueue=[];if(c){e=[];for(g=0;g<c;++g)d=(f=b[g]).item.target,d.container.isDetachedBody||(e.push(d),f.options&&(a.invalidateData[d.id]=f.options));a.invalidate(e,null)}},flushLayouts:function(a,b,c){var d=this,e=c?d[a].items:d[a].clear(),f=e.length,g,h;if(f){for(g=0;g<f;++g)h=e[g],h.running||d.callLayout(h,b);d.currentLayout=null}},getCmp:function(a){return this.getItem(a,a.el)},getEl:function(a,b){var c=this.getItem(b,b);return c.parent||(c.parent=a,a.children.length?a.children.push(c):a.children=[c]),c},getItem:function(a,b){var c=b.id,d=this.items,e=d[c]||(d[c]=new Ext.layout.ContextItem({context:this,target:a,el:b,ownerCtContext:this.currentOwnerCtContext}));return e},handleFailure:function(){var a=this.layouts,b,c;Ext.failedLayouts=(Ext.failedLayouts||0)+1;for(c in a)b=a[c],a.hasOwnProperty(c)&&(b.running=!1,b.ownerContext=null)},invalidate:function(a,b,c){var d=this,e=!a.isComponent,f=d.items,g=d.state>0,h=d.currentOwnerCtContext,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;d.currentOwnerCtContext=b;for(n=0,s=e?a.length:1;n<s;++n){p=e?a[n]:a;if(p.rendered&&!p.hidden){m=!p.componentLayout.ownerContext,q=d.getCmp(p),m&&(p.beforeLayout&&p.beforeLayout(),g&&!b&&(l=p.ownerCt)&&(b=f[l.el.id]),q.init(b)),i=j=k=!0,t=p.componentLayout,t.ownerContext=q,t.getLayoutItems&&(t.renderChildren(),r=t.getLayoutItems(),r.length&&(d.invalidate(r,q,!0),i=!1)),p.isContainer&&!p.collapsed?(u=p.layout,u.ownerContext=q,u.renderChildren(),k=!1,r=u.getVisibleItems(),r.length&&(d.invalidate(r,q,!0),j=!1)):u=null;if(m)q.hasRawContent=!0,q.target.isContainer&&(q.target.items.items.length||!q.target.getTargetEl().dom.firstChild)&&(q.hasRawContent=!1);else{q.doInvalidate(c),r=q.children;for(o=r.length;o--;)r[o].doInvalidate(!0)}v=q.props,i&&(v.componentChildrenDone=!0,j&&(v.childrenDone=!0)),j&&(v.containerChildrenDone=!0),k&&(v.containerLayoutDone=!0),w=d.invalidateData[q.id],w&&(delete d.invalidateData[q.id],w.state&&Ext.apply(q.state,w.state),d.finishInvalidate(w,q,"before")),d.resetLayout(t,q,m),u&&d.resetLayout(u,q,m),w&&d.finishInvalidate(w,q,"after"),q.boxChildren&&q.widthModel.shrinkWrap&&(q.el.setWidth(1e4),q.state.blocks=(q.state.blocks||0)+1),m&&q.initAnimatePolicy()}}d.currentOwnerCtContext=h},layoutDone:function(a){var b=a.ownerContext,c;a.running=!1,a.isComponentLayout?(b.measuresBox&&b.onBoxMeasured(),b.setProp("done",!0),c=b.ownerCtContext,c&&(b.target.ownerLayout.isComponentLayout?--c.remainingComponentChildLayouts||c.setProp("componentChildrenDone",!0):--c.remainingContainerChildLayouts||c.setProp("containerChildrenDone",!0),--c.remainingChildLayouts||c.setProp("childrenDone",!0))):b.setProp("containerLayoutDone",!0),--this.remainingLayouts,++this.progressCount},newQueue:function(){return new Ext.util.Queue},queueAnimation:function(a){this.animateQueue.add(a)},queueCompletion:function(a){this.completionQueue.add(a)},queueFinalize:function(a){this.finalizeQueue.add(a)},queueFlush:function(a){this.flushQueue.add(a)},chainFns:function(a,b,c){var d=a[c],e=b[c];return function(c){d&&d.call(a.scope||a,c,a),e.call(b.scope||b,c,b)}},queueInvalidate:function(a,b){var c=this,d=[],e=c.invalidQueue,f=e.length,g,h,i,j,k;a.isComponent?a=c.getCmp(g=a):g=a.target;while(f--){h=e[f],i=h.item.target;if(g.isDescendant(i))return;if(i==g){(j=h.options)?b&&((k=j.state)?b.state&&Ext.apply(k,b.state):j.state=b.state,b.before&&(j.before=c.chainFns(j,b,"before")),b.after&&(j.after=c.chainFns(j,b,"after"))):h.options=b;return}i.isDescendant(g)||d.push(h)}d.push({item:a,options:b}),c.invalidQueue=d},queueItemLayouts:function(a){var b=a.isComponent?a:a.target,c=b.componentLayout;!c.pending&&!c.invalid&&!c.done&&this.queueLayout(c),c=b.layout,c&&!c.pending&&!c.invalid&&!c.done&&this.queueLayout(c)},queueLayout:function(a){this.layoutQueue.add(a),a.pending=!0},resetLayout:function(a,b,c){var d=this,e;d.currentLayout=a,a.done=!1,a.pending=!0,a.firedTriggers=0,d.layoutQueue.add(a),c?(d.layouts[a.id]=a,a.running=!0,a.finishedLayout&&d.finishQueue.add(a),++d.remainingLayouts,++a.layoutCount,a.beginCount=0,a.blockCount=0,a.calcCount=0,a.triggerCount=0,a.isComponentLayout&&(e=b.ownerCtContext)&&(b.target.ownerLayout.isComponentLayout?++e.remainingComponentChildLayouts:++e.remainingContainerChildLayouts,++e.remainingChildLayouts),a.initialized||a.initLayout(),a.beginLayout(b)):(++a.beginCount,a.running||(++d.remainingLayouts,a.running=!0,a.isComponentLayout&&(b.unsetProp("done"),e=b.ownerCtContext,e&&(b.target.ownerLayout.isComponentLayout?++e.remainingComponentChildLayouts==1&&e.unsetProp("componentChildrenDone"):++e.remainingContainerChildLayouts==1&&e.unsetProp("containerChildrenDone"),++e.remainingChildLayouts==1&&e.unsetProp("childrenDone"))),d.completionQueue.remove(a),d.finalizeQueue.remove(a))),a.beginLayoutCycle(b,c)},run:function(){var a=this,b=!1,c=100;a.flushInvalidates(),a.state=1,a.totalCount=a.layoutQueue.getCount(),a.flush();while((a.remainingLayouts||a.invalidQueue.length)&&c--){a.invalidQueue.length&&a.flushInvalidates();if(a.runCycle())b=!1;else{if(!!b){a.state=2;break}a.flush(),b=!0,a.flushLayouts("completionQueue","completeLayout")}!a.remainingLayouts&&!a.invalidQueue.length&&(a.flush(),a.flushLayouts("completionQueue","completeLayout"),a.flushLayouts("finalizeQueue","finalizeLayout"))}return a.runComplete()},runComplete:function(){var a=this;return a.state=2,a.remainingLayouts?(a.handleFailure(),!1):(a.flush(),a.flushLayouts("finishQueue","finishedLayout",!0),a.flushLayouts("finishQueue","notifyOwner"),a.flush(),a.flushAnimations(),!0)},runCycle:function(){var a=this,b=a.layoutQueue.clear(),c=b.length,d;++a.cycleCount,a.progressCount=0;for(d=0;d<c;++d)a.runLayout(a.currentLayout=b[d]);return a.currentLayout=null,a.progressCount>0},runLayout:function(a){var b=this,c=b.getCmp(a.owner);a.pending=!1;if(c.state.blocks)return;a.done=!0,++a.calcCount,++b.calcCount,a.calculate(c),a.done?(b.layoutDone(a),a.completeLayout&&b.queueCompletion(a),a.finalizeLayout&&b.queueFinalize(a)):!a.pending&&!a.invalid&&!(a.blockCount+a.triggerCount-a.firedTriggers)&&b.queueLayout(a)},setItemSize:function(a,b,c){var d=a,e=1,f,g;a.isComposite?(d=a.elements,e=d.length,a=d[0]):!a.dom&&!a.el&&(e=d.length,a=d[0]);for(g=0;g<e;)f=this.get(a),f.setSize(b,c),a=d[++g]}}),Ext.define("Ext.selection.Model",{extend:"Ext.util.Observable",alternateClassName:"Ext.AbstractSelectionModel",requires:["Ext.data.StoreManager"],mixins:{bindable:"Ext.util.Bindable"},allowDeselect:!1,selected:null,pruneRemoved:!0,constructor:function(a){var b=this;a=a||{},Ext.apply(b,a),b.addEvents("selectionchange","focuschange"),b.modes={SINGLE:!0,SIMPLE:!0,MULTI:!0},b.setSelectionMode(a.mode||b.mode),b.selected=new Ext.util.MixedCollection,b.callParent(arguments)},bindStore:function(a,b){var c=this;c.mixins.bindable.bindStore.apply(c,arguments),c.store&&!b&&c.refresh()},getStoreListeners:function(){var a=this;return{add:a.onStoreAdd,clear:a.onStoreClear,remove:a.onStoreRemove,update:a.onStoreUpdate}},selectAll:function(a){var b=this,c=b.store.getRange(),d=0,e=c.length,f=b.getSelection().length;b.bulkChange=!0;for(;d<e;d++)b.doSelect(c[d],!0,a);delete b.bulkChange,b.maybeFireSelectionChange(b.getSelection().length!==f)},deselectAll:function(a){var b=this,c=b.getSelection(),d=0,e=c.length,f=b.getSelection().length;b.bulkChange=!0;for(;d<e;d++)b.doDeselect(c[d],a);delete b.bulkChange,b.maybeFireSelectionChange(b.getSelection().length!==f)},selectWithEvent:function(a,b,c){var d=this;switch(d.selectionMode){case"MULTI":b.ctrlKey&&d.isSelected(a)?d.doDeselect(a,!1):b.shiftKey&&d.lastFocused?d.selectRange(d.lastFocused,a,b.ctrlKey):b.ctrlKey?d.doSelect(a,!0,!1):d.isSelected(a)&&!b.shiftKey&&!b.ctrlKey&&d.selected.getCount()>1?d.doSelect(a,c,!1):d.doSelect(a,!1);break;case"SIMPLE":d.isSelected(a)?d.doDeselect(a):d.doSelect(a,!0);break;case"SINGLE":d.allowDeselect&&d.isSelected(a)?d.doDeselect(a):d.doSelect(a,!1)}},selectRange:function(a,b,c,d){var e=this,f=e.store,g=0,h,i,j,k=[];if(e.isLocked())return;c||e.deselectAll(!0),Ext.isNumber(a)||(a=f.indexOf(a)),Ext.isNumber(b)||(b=f.indexOf(b)),a>b&&(i=b,b=a,a=i);for(h=a;h<=b;h++)e.isSelected(f.getAt(h))&&g++;d?j=d=="up"?a:b:j=-1;for(h=a;h<=b;h++)g==b-a+1?h!=j&&e.doDeselect(h,!0):k.push(f.getAt(h));e.doMultiSelect(k,!0)},select:function(a,b,c){Ext.isDefined(a)&&this.doSelect(a,b,c)},deselect:function(a,b){this.doDeselect(a,b)},doSelect:function(a,b,c){var d=this,e;if(d.locked||!d.store)return;typeof a=="number"&&(a=[d.store.getAt(a)]),d.selectionMode=="SINGLE"&&a?(e=a.length?a[0]:a,d.doSingleSelect(e,c)):d.doMultiSelect(a,b,c)},doMultiSelect:function(a,b,c){function j(){e.add(i),f=!0}var d=this,e=d.selected,f=!1,g=0,h,i;if(d.locked)return;a=Ext.isArray(a)?a:[a],h=a.length;if(!b&&e.getCount()>0&&d.doDeselect(d.getSelection(),c)===!1)return;for(;g<h;g++){i=a[g];if(b&&d.isSelected(i))continue;d.lastSelected=i,d.onSelectChange(i,!0,c,j)}d.preventFocus||d.setLastFocused(i,c),d.maybeFireSelectionChange(f&&!c)},doDeselect:function(a,b){function j(){++i,d.remove(g)}var c=this,d=c.selected,e=0,f,g,h=0,i=0;if(c.locked||!c.store)return!1;typeof a=="number"?a=[c.store.getAt(a)]:Ext.isArray(a)||(a=[a]),f=a.length;for(;e<f;e++)g=a[e],c.isSelected(g)&&(c.lastSelected==g&&(c.lastSelected=d.last()),++h,c.onSelectChange(g,!1,b,j));return c.maybeFireSelectionChange(i>0&&!b),i===h},doSingleSelect:function(a,b){function f(){c.bulkChange=!0;if(e.getCount()>0&&c.doDeselect(c.lastSelected,b)===!1)return delete c.bulkChange,!1;delete c.bulkChange,e.add(a),c.lastSelected=a,d=!0}var c=this,d=!1,e=c.selected;if(c.locked)return;if(c.isSelected(a))return;c.onSelectChange(a,!0,b,f),d&&(b||c.setLastFocused(a),c.maybeFireSelectionChange(!b))},setLastFocused:function(a,b){var c=this,d=c.lastFocused;c.lastFocused=a,a!==d&&c.onLastFocusChanged(d,a,b)},isFocused:function(a){return a===this.getLastFocused()},maybeFireSelectionChange:function(a){var b=this;a&&!b.bulkChange&&b.fireEvent("selectionchange",b,b.getSelection())},getLastSelected:function(){return this.lastSelected},getLastFocused:function(){return this.lastFocused},getSelection:function(){return this.selected.getRange()},getSelectionMode:function(){return this.selectionMode},setSelectionMode:function(a){a=a?a.toUpperCase():"SINGLE",this.selectionMode=this.modes[a]?a:"SINGLE"},isLocked:function(){return this.locked},setLocked:function(a){this.locked=!!a},isSelected:function(a){return a=Ext.isNumber(a)?this.store.getAt(a):a,this.selected.indexOf(a)!==-1},hasSelection:function(){return this.selected.getCount()>0},refresh:function(){var a=this,b=[],c=a.getSelection(),d=c.length,e,f,g=0,h=this.getLastFocused();for(;g<d;g++)e=c[g],(!this.pruneRemoved||a.store.indexOf(e)!==-1)&&b.push(e);a.selected.getCount()!=b.length&&(f=!0),a.clearSelections(),a.store.indexOf(h)!==-1&&this.setLastFocused(h,!0),b.length&&a.doSelect(b,!1,!0),a.maybeFireSelectionChange(f)},clearSelections:function(){this.selected.clear(),this.lastSelected=null,this.setLastFocused(null)},onStoreAdd:function(){},onStoreClear:function(){this.selected.getCount>0&&(this.clearSelections(),this.maybeFireSelectionChange(!0))},onStoreRemove:function(a,b,c){var d=this,e=d.selected;if(d.locked||!d.pruneRemoved)return;e.remove(b)&&(d.lastSelected==b&&(d.lastSelected=null),d.getLastFocused()==b&&d.setLastFocused(null),d.maybeFireSelectionChange(!0))},getCount:function(){return this.selected.getCount()},destroy:function(){},onStoreUpdate:function(){},onSelectChange:function(a,b,c){},onLastFocusChanged:function(a,b){this.fireEvent("focuschange",this,a,b)},onEditorKey:function(a,b){},bindComponent:function(a){}}),Ext.define("Ext.selection.DataViewModel",{extend:"Ext.selection.Model",requires:["Ext.util.KeyNav"],deselectOnContainerClick:!0,enableKeyNav:!0,constructor:function(a){this.addEvents("beforedeselect","beforeselect","deselect","select"),this.callParent(arguments)},bindComponent:function(a){var b=this,c={refresh:b.refresh,scope:b};b.view=a,b.bindStore(a.getStore()),c[a.triggerEvent]=b.onItemClick,c[a.triggerCtEvent]=b.onContainerClick,a.on(c),b.enableKeyNav&&b.initKeyNav(a)},onItemClick:function(a,b,c,d,e){this.selectWithEvent(b,e)},onContainerClick:function(){this.deselectOnContainerClick&&this.deselectAll()},initKeyNav:function(a){var b=this;if(!a.rendered){a.on({render:Ext.Function.bind(b.initKeyNav,b,[a]),single:!0});return}a.el.set({tabIndex:-1}),b.keyNav=new Ext.util.KeyNav(a.el,{down:Ext.pass(b.onNavKey,[1],b),right:Ext.pass(b.onNavKey,[1],b),left:Ext.pass(b.onNavKey,[-1],b),up:Ext.pass(b.onNavKey,[-1],b),scope:b})},onNavKey:function(a){a=a||1;var b=this,c=b.view,d=b.getSelection()[0],e=b.view.store.getCount(),f;d?f=c.indexOf(c.getNode(d))+a:f=0,f<0?f=e-1:f>=e&&(f=0),b.select(f)},onSelectChange:function(a,b,c,d){var e=this,f=e.view,g=b?"select":"deselect";(c||e.fireEvent("before"+g,e,a))!==!1&&d()!==!1&&(f&&(b?f.onItemSelect(a):f.onItemDeselect(a)),c||e.fireEvent(g,e,a))},destroy:function(){Ext.destroy(this.keyNav),this.callParent()}}),Ext.define("Ext.Component",{alias:["widget.component","widget.box"],extend:"Ext.AbstractComponent",requires:["Ext.util.DelayedTask"],uses:["Ext.Layer","Ext.resizer.Resizer","Ext.util.ComponentDragger"],mixins:{floating:"Ext.util.Floating"},statics:{DIRECTION_TOP:"top",DIRECTION_RIGHT:"right",DIRECTION_BOTTOM:"bottom",DIRECTION_LEFT:"left",VERTICAL_DIRECTION_Re:/^(?:top|bottom)$/,INVALID_ID_CHARS_Re:/[\.,\s]/g},resizeHandles:"all",floating:!1,toFrontOnShow:!0,hideMode:"display",hideParent:!1,bubbleEvents:[],actionMode:"el",monPropRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,constructor:function(a){var b=this;a=a||{};if(a.initialConfig)a.isAction&&(b.baseAction=a),a=a.initialConfig;else if(a.tagName||a.dom||Ext.isString(a))a={applyTo:a,id:a.id||a};b.callParent([a]),b.baseAction&&b.baseAction.addComponent(b)},initComponent:function(){var a=this;a.callParent(),a.listeners&&(a.on(a.listeners),a.listeners=null),a.enableBubble(a.bubbleEvents),a.mons=[]},afterRender:function(){var a=this;a.callParent(),(!a.x||!a.y)&&(a.pageX||a.pageY)&&a.setPagePosition(a.pageX,a.pageY)},setAutoScroll:function(a){var b=this;return b.autoScroll=!!a,b.rendered&&b.getTargetEl().setStyle(b.getOverflowStyle()),b.updateLayout(),b},setOverflowXY:function(a,b){var c=this,d=arguments.length;return d&&(c.overflowX=a||"",d>1&&(c.overflowY=b||"")),c.rendered&&c.getTargetEl().setStyle(c.getOverflowStyle()),c.updateLayout(),c},beforeRender:function(){var a=this,b=a.floating,c;return b&&(a.addCls(Ext.baseCSSPrefix+"layer"),c=b.cls,c&&a.addCls(c)),a.callParent()},afterComponentLayout:function(){this.callParent(arguments),this.floating&&this.onAfterFloatLayout()},makeFloating:function(a){this.mixins.floating.constructor.call(this,a)},wrapPrimaryEl:function(a){this.floating?this.makeFloating(a):this.callParent(arguments)},initResizable:function(a){var b=this;a=Ext.apply({target:b,dynamic:!1,constrainTo:b.constrainTo||(b.floatParent?b.floatParent.getTargetEl():null),handles:b.resizeHandles},a),a.target=b,b.resizer=new Ext.resizer.Resizer(a)},getDragEl:function(){return this.el},initDraggable:function(){var a=this,b=a.resizer&&a.resizer.el!==a.el?a.resizerComponent=new Ext.Component({el:a.resizer.el,rendered:!0,container:a.container}):a,c=Ext.applyIf({el:b.getDragEl(),constrainTo:a.constrain?a.constrainTo||(a.floatParent?a.floatParent.getTargetEl():a.el.getScopeParent()):undefined},a.draggable);if(a.constrain||a.constrainDelegate)c.constrain=a.constrain,c.constrainDelegate=a.constrainDelegate;a.dd=new Ext.util.ComponentDragger(b,c)},scrollBy:function(a,b,c){var d;(d=this.getTargetEl())&&d.dom&&d.scrollBy.apply(d,arguments)},setLoading:function(a,b){var c=this,d;return c.rendered&&(Ext.destroy(c.loadMask),c.loadMask=null,a!==!1&&!c.collapsed&&(Ext.isObject(a)?d=Ext.apply({},a):Ext.isString(a)?d={msg:a}:d={},b&&Ext.applyIf(d,{useTargetEl:!0}),c.loadMask=new Ext.LoadMask(c,d),c.loadMask.show())),c.loadMask},beforeSetPosition:function(){var a=this,b=a.callParent(arguments),c;return b&&(c=a.adjustPosition(b.x,b.y),b.x=c.x,b.y=c.y),b||null},afterSetPosition:function(a,b){this.onPosition(a,b),this.fireEvent("move",this,a,b)},showAt:function(a,b,c){var d=this;!d.rendered&&(d.autoRender||d.floating)&&d.doAutoRender(),d.floating?d.setPosition(a,b,c):d.setPagePosition(a,b,c),d.show()},setPagePosition:function(a,b,c){var d=this,e,f;return Ext.isArray(a)&&(b=a[1],a=a[0]),d.pageX=a,d.pageY=b,d.floating?(d.isContainedFloater()?(f=d.floatParent.getTargetEl().getViewRegion(),Ext.isNumber(a)&&Ext.isNumber(f.left)&&(a-=f.left),Ext.isNumber(b)&&Ext.isNumber(f.top)&&(b-=f.top)):(e=d.el.translatePoints(a,b),a=e.left,b=e.top),d.setPosition(a,b,c)):(e=d.el.translatePoints(a,b),d.setPosition(e.left,e.top,c)),d},isContainedFloater:function(){return this.floating&&this.floatParent},getBox:function(a){var b=a?this.getPosition(a):this.el.getXY(),c=this.getSize();return c.x=b[0],c.y=b[1],c},updateBox:function(a){return this.setSize(a.width,a.height),this.setPagePosition(a.x,a.y),this},getOuterSize:function(){var a=this.el;return{width:a.getWidth()+a.getMargin("lr"),height:a.getHeight()+a.getMargin("tb")}},adjustPosition:function(a,b){var c=this,d;return c.isContainedFloater()&&(d=c.floatParent.getTargetEl().getViewRegion(),a+=d.left,b+=d.top),{x:a,y:b}},getPosition:function(a){var b=this,c=b.el,d,e=b.isContainedFloater(),f;return a===!0||!e?[c.getLeft(!0),c.getTop(!0)]:(b.x!==undefined&&b.y!==undefined?d=[b.x,b.y]:(d=b.el.getXY(),e&&(f=b.floatParent.getTargetEl().getViewRegion(),d[0]-=f.left,d[1]-=f.top)),d)},getId:function(){var a=this,b;return a.id||(b=a.getXType(),b?b=b.replace(Ext.Component.INVALID_ID_CHARS_Re,"-"):b=Ext.name.toLowerCase()+"-comp",a.id=b+"-"+a.getAutoId()),a.id},show:function(a,b,c){var d=this,e=d.rendered;return e&&d.isVisible()?d.toFrontOnShow&&d.floating&&d.toFront():d.fireEvent("beforeshow",d)!==!1&&(d.hidden=!1,!e&&(d.autoRender||d.floating)&&(d.doAutoRender(),e=d.rendered),e&&(d.beforeShow(),d.onShow.apply(d,arguments),d.afterShow.apply(d,arguments))),d},beforeShow:Ext.emptyFn,onShow:function(){var a=this;a.el.show(),a.callParent(arguments),a.floating&&a.constrain&&a.doConstrain()},afterShow:function(a,b,c){var d=this,e,f,g;a=a||d.animateTarget,d.ghost||(a=null),a?(a=a.el?a.el:Ext.get(a),f=d.el.getBox(),e=a.getBox(),d.el.addCls(Ext.baseCSSPrefix+"hide-offsets"),g=d.ghost(),g.el.stopAnimation(),g.el.setX(-1e4),g.el.animate({from:e,to:f,listeners:{afteranimate:function(){delete g.componentLayout.lastComponentSize,d.unghost(),d.el.removeCls(Ext.baseCSSPrefix+"hide-offsets"),d.onShowComplete(b,c)}}})):d.onShowComplete(b,c)},onShowComplete:function(a,b){var c=this;c.floating&&(c.toFront(),c.onFloatShow()),Ext.callback(a,b||c),c.fireEvent("show",c),delete c.hiddenByLayout},hide:function(){var a=this;return a.showOnParentShow=!1,(!a.rendered||!!a.isVisible())&&a.fireEvent("beforehide",a)!==!1&&(a.hidden=!0,a.rendered&&a.onHide.apply(a,arguments)),a},onHide:function(a,b,c){var d=this,e,f;a=a||d.animateTarget,d.ghost||(a=null),a&&(a=a.el?a.el:Ext.get(a),e=d.ghost(),e.el.stopAnimation(),f=a.getBox(),f.width+="px",f.height+="px",e.el.animate({to:f,listeners:{afteranimate:function(){delete e.componentLayout.lastComponentSize,e.el.hide(),d.afterHide(b,c)}}})),d.el.hide(),a||d.afterHide(b,c)},afterHide:function(a,b){var c=this;delete c.hiddenByLayout,Ext.AbstractComponent.prototype.onHide.call(this),Ext.callback(a,b||c),c.fireEvent("hide",c)},onDestroy:function(){var a=this;a.rendered&&(Ext.destroy(a.proxy,a.proxyWrap,a.resizer,a.resizerComponent),(a.actionMode=="container"||a.removeMode=="container")&&a.container.remove()),delete a.focusTask,a.callParent()},deleteMembers:function(){var a=arguments,b=a.length,c=0;for(;c<b;++c)delete this[a[c]]},focus:function(a,b){var c=this,d,e;if(c.rendered&&!c.isDestroyed&&c.isVisible(!0)&&(d=c.getFocusEl())){if(d.isComponent)return d.focus(a,b);if(b)return c.focusTask||(c.focusTask=new Ext.util.DelayedTask(c.focus)),c.focusTask.delay(Ext.isNumber(b)?b:10,null,c,[a,!1]),c;if(e=d.dom)d.needsTabIndex()&&(e.tabIndex=-1),d.focus(),a===!0&&e.select();c.floating&&c.toFront(!0)}return c},cancelFocus:function(){var a=this.focusTask;a&&a.cancel()},blur:function(){var a;return this.rendered&&(a=this.getFocusEl())&&a.blur(),this},getEl:function(){return this.el},getResizeEl:function(){return this.el},getPositionEl:function(){return this.el},getActionEl:function(){return this.el},getVisibilityEl:function(){return this.el},onResize:Ext.emptyFn,getBubbleTarget:function(){return this.ownerCt||this.floatParent},getContentTarget:function(){return this.el},cloneConfig:function(a){a=a||{};var b=a.id||Ext.id(),c=Ext.applyIf(a,this.initialConfig),d;return c.id=b,d=Ext.getClass(this),new d(c)},getXType:function(){return this.self.xtype},findParentBy:function(a){var b;for(b=this.getBubbleTarget();b&&!a(b,this);b=b.getBubbleTarget());return b||null},findParentByType:function(a){return Ext.isFunction(a)?this.findParentBy(function(b){return b.constructor===a}):this.up(a)},bubble:function(a,b,c){var d=this;while(d){if(a.apply(b||d,c||[d])===!1)break;d=d.getBubbleTarget()}return this},getProxy:function(){var a=this,b;return a.proxy||(b=Ext.getBody(),Ext.scopeResetCSS&&(a.proxyWrap=b=Ext.getBody().createChild({cls:Ext.resetCls})),a.proxy=a.el.createProxy(Ext.baseCSSPrefix+"proxy-el",b,!0)),a.proxy}}),Ext.define("Ext.app.EventBus",{requires:["Ext.util.Event","Ext.Component"],mixins:{observable:"Ext.util.Observable"},constructor:function(){this.mixins.observable.constructor.call(this),this.bus={};var a=this;Ext.override(Ext.Component,{fireEvent:function(b){return Ext.util.Observable.prototype.fireEvent.apply(this,arguments)!==!1?a.dispatch.call(a,b,this,arguments):!1}})},dispatch:function(a,b,c){var d=this.bus,e=d[a],f,g,h,i,j,k,l;if(e)for(f in e)if(e.hasOwnProperty(f)&&b.is(f)){g=e[f];for(h in g)if(g.hasOwnProperty(h)){i=g[h];for(k=0,l=i.length;k<l;k++){j=i[k];if(j.fire.apply(j,Array.prototype.slice.call(c,1))===!1)return!1}}}return!0},control:function(a,b,c){var d=this.bus,e,f,g,h,i,j,k,l,m,n;if(Ext.isString(a)){h=a,a={},a[h]=b,this.control(a,null,c);return}e=Ext.util.Observable.HasListeners.prototype;for(h in a)if(a.hasOwnProperty(h)){m=a[h]||{};for(n in m)m.hasOwnProperty(n)&&(i={},j=m[n],k=c,l=new Ext.util.Event(c,n),Ext.isObject(j)&&(i=j,j=i.fn,k=i.scope||c,delete i.fn,delete i.scope),l.addListener(j,k,i),e[n]=1,f=d[n]||(d[n]={}),f=f[h]||(f[h]={}),g=f[c.id]||(f[c.id]=[]),g.push(l))}}}),Ext.define("Ext.chart.MaskLayer",{extend:"Ext.Component",constructor:function(a){a=Ext.apply(a||{},{style:"position:absolute;background-color:#888;cursor:move;opacity:0.6;border:1px solid #222;"}),this.callParent([a])},initComponent:function(){var a=this;a.callParent(arguments),a.addEvents("mousedown","mouseup","mousemove","mouseenter","mouseleave")},initDraggable:function(){this.callParent(arguments),this.dd.onStart=function(a){var b=this,c=b.comp;this.startPosition=c.getPosition(!0),c.ghost&&!c.liveDrag&&(b.proxy=c.ghost(),b.dragTarget=b.proxy.header.el);if(b.constrain||b.constrainDelegate)b.constrainTo=b.calculateConstrainRegion()}}}),Ext.define("Ext.chart.Mask",{requires:["Ext.chart.MaskLayer"],constructor:function(a){var b=this,c;b.addEvents("select"),a&&Ext.apply(b,a),b.enableMask&&b.on("afterrender",function(){var a=new Ext.chart.MaskLayer({renderTo:b.el,hidden:!0});a.el.on({mousemove:function(a){b.onMouseMove(a)},mouseup:function(a){b.resized(a)}}),c=new Ext.resizer.Resizer({el:a.el,handles:"all",pinned:!0}),c.on({resize:function(a){b.resized(a)}}),a.initDraggable(),b.maskType=b.mask,b.mask=a,b.maskSprite=b.surface.add({type:"path",path:["M",0,0],zIndex:1001,opacity:.7,hidden:!0,stroke:"#444"})},b,{single:!0})},resized:function(a){var b=this,c=b.bbox||b.chartBBox,d=c.x,e=c.y,f=c.width,g=c.height,h=b.mask.getBox(!0),i=Math.max,j=Math.min,k=h.x-d,l=h.y-e;k=i(k,d),l=i(l,e),k=j(k,f),l=j(l,g),h.x=k,h.y=l,b.fireEvent("select",b,h)},onMouseUp:function(a){var b=this,c=b.bbox||b.chartBBox,d=b.maskSelection;b.maskMouseDown=!1,b.mouseDown=!1,b.mouseMoved&&(b.onMouseMove(a),b.mouseMoved=!1,b.fireEvent("select",b,{x:d.x-c.x,y:d.y-c.y,width:d.width,height:d.height}))},onMouseDown:function(a){var b=this;b.mouseDown=!0,b.mouseMoved=!1,b.maskMouseDown={x:a.getPageX()-b.el.getX(),y:a.getPageY()-b.el.getY()}},onMouseMove:function(a){var b=this,c=b.maskType,d=b.bbox||b.chartBBox,e=d.x,f=d.y,g=Math,h=g.floor,i=g.abs,j=g.min,k=g.max,l=h(f+d.height),m=h(e+d.width),n=a.getPageX(),o=a.getPageY(),p=n-b.el.getX(),q=o-b.el.getY(),r=b.maskMouseDown,s;b.mouseMoved=b.mouseDown,p=k(p,e),q=k(q,f),p=j(p,m),q=j(q,l),r&&b.mouseDown?(c=="horizontal"?(q=f,r.y=l,o=b.el.getY()+d.height+b.insetPadding):c=="vertical"&&(p=e,r.x=m),m=r.x-p,l=r.y-q,s=["M",p,q,"l",m,0,0,l,-m,0,"z"],b.maskSelection={x:m>0?p:p+m,y:l>0?q:q+l,width:i(m),height:i(l)},b.mask.updateBox(b.maskSelection),b.mask.show(),b.maskSprite.setAttributes({hidden:!0},!0)):(c=="horizontal"?s=["M",p,f,"L",p,l]:c=="vertical"?s=["M",e,q,"L",m,q]:s=["M",p,f,"L",p,l,"M",e,q,"L",m,q],b.maskSprite.setAttributes({path:s,fill:b.maskMouseDown?b.maskSprite.stroke:!1,"stroke-width":c===!0?1:3,hidden:!1},!0))},onMouseLeave:function(a){var b=this;b.mouseMoved=!1,b.mouseDown=!1,b.maskMouseDown=!1,b.mask.hide(),b.maskSprite.hide(!0)}}),Ext.define("Ext.draw.Component",{alias:"widget.draw",extend:"Ext.Component",requires:["Ext.draw.Surface","Ext.layout.component.Draw"],enginePriority:["Svg","Vml"],baseCls:Ext.baseCSSPrefix+"surface",componentLayout:"draw",viewBox:!0,shrinkWrap:3,autoSize:!1,initComponent:function(){this.callParent(arguments),this.addEvents("mousedown","mouseup","mousemove","mouseenter","mouseleave","click","dblclick")},onRender:function(){var a=this,b=a.viewBox,c=a.autoSize,d,e,f,g,h,i;a.callParent(arguments);if(a.createSurface()!==!1){e=a.surface.items;if(b||c)d=e.getBBox(),f=d.width,g=d.height,h=d.x,i=d.y,a.viewBox?a.surface.setViewBox(h,i,f,g):a.autoSizeSurface()}},autoSizeSurface:function(){var a=this.surface.items.getBBox();this.setSurfaceSize(a.width,a.height)},setSurfaceSize:function(a,b){this.surface.setSize(a,b);if(this.autoSize){var c=this.surface.items.getBBox();this.surface.setViewBox(c.x,c.y- +Ext.isOpera,a,b)}},createSurface:function(){function d(b){return function(c){a.fireEvent(b,c)}}var a=this,b=Ext.applyIf({renderTo:a.el,height:a.height,width:a.width,items:a.items},a.initialConfig),c;delete b.listeners,c=Ext.draw.Surface.create(b);if(!c)return!1;a.surface=c,c.on({scope:a,mouseup:d("mouseup"),mousedown:d("mousedown"),mousemove:d("mousemove"),mouseenter:d("mouseenter"),mouseleave:d("mouseleave"),click:d("click"),dblclick:d("dblclick")})},onDestroy:function(){Ext.destroy(this.surface),this.callParent(arguments)}}),Ext.define("Ext.chart.Chart",{alias:"widget.chart",extend:"Ext.draw.Component",mixins:{themeManager:"Ext.chart.theme.Theme",mask:"Ext.chart.Mask",navigation:"Ext.chart.Navigation",bindable:"Ext.util.Bindable"},uses:["Ext.chart.series.Series"],requires:["Ext.util.MixedCollection","Ext.data.StoreManager","Ext.chart.Legend","Ext.chart.theme.Base","Ext.chart.theme.Theme","Ext.util.DelayedTask"],viewBox:!1,animate:!1,legend:!1,insetPadding:10,enginePriority:["Svg","Vml"],background:!1,constructor:function(a){var b=this,c;a=Ext.apply({},a),b.initTheme(a.theme||b.theme),b.gradients&&Ext.apply(a,{gradients:b.gradients}),b.background&&Ext.apply(a,{background:b.background}),a.animate&&(c={easing:"ease",duration:500},Ext.isObject(a.animate)?a.animate=Ext.applyIf(a.animate,c):a.animate=c),a.enableMask&&b.mixins.mask.constructor.call(b,a),b.mixins.navigation.constructor.call(b,a),b.callParent([a])},getChartStore:function(){return this.substore||this.store},initComponent:function(){var a=this,b,c;a.callParent(),a.addEvents("itemmousedown","itemmouseup","itemmouseover","itemmouseout","itemclick","itemdblclick","itemdragstart","itemdrag","itemdragend","beforerefresh","refresh"),Ext.applyIf(a,{zoom:{width:1,height:1,x:0,y:0}}),a.maxGutter=[0,0],a.store=Ext.data.StoreManager.lookup(a.store),b=a.axes,a.axes=new Ext.util.MixedCollection(!1,function(a){return a.position}),b&&a.axes.addAll(b),c=a.series,a.series=new Ext.util.MixedCollection(!1,function(a){return a.seriesId||(a.seriesId=Ext.id(null,"ext-chart-series-"))}),c&&a.series.addAll(c),a.legend!==!1&&(a.legend=new Ext.chart.Legend(Ext.applyIf({chart:a},a.legend))),a.on({mousemove:a.onMouseMove,mouseleave:a.onMouseLeave,mousedown:a.onMouseDown,mouseup:a.onMouseUp,click:a.onClick,dblclick:a.onDblClick,scope:a})},afterComponentLayout:function(a,b){var c=this;Ext.isNumber(a)&&Ext.isNumber(b)&&(c.curWidth=a,c.curHeight=b,c.redraw(!0)),this.callParent(arguments)},redraw:function(a){var b=this,c=b.series.items,d=c.length,e=b.axes.items,f=e.length,g,h=b.chartBBox={x:0,y:0,height:b.curHeight,width:b.curWidth},i=b.legend;b.surface.setSize(h.width,h.height);for(g=0;g<d;g++)b.initializeSeries(c[g],g);for(g=0;g<f;g++)b.initializeAxis(e[g]);for(g=0;g<f;g++)e[g].processView();for(g=0;g<f;g++)e[g].drawAxis(!0);i!==!1&&i.visible&&(i.update||!i.created)&&i.create(),b.alignAxes(),i!==!1&&i.visible&&i.updatePosition(),b.getMaxGutter(),b.resizing=!!a;for(g=0;g<f;g++)e[g].drawAxis();for(g=0;g<d;g++)b.drawCharts(c[g]);b.resizing=!1},afterRender:function(){var a,b=this;this.callParent(),b.categoryNames&&b.setCategoryNames(b.categoryNames),b.tipRenderer&&(a=b.getFunctionRef(b.tipRenderer),b.setTipRenderer(a.fn,a.scope)),b.bindStore(b.store,!0),b.refresh()},getEventXY:function(a){var b=this,c=this.surface.getRegion(),d=a.getXY(),e=d[0]-c.left,f=d[1]-c.top;return[e,f]},onClick:function(a){this.handleClick("itemclick",a)},onDblClick:function(a){this.handleClick("itemdblclick",a)},handleClick:function(a,b){var c=this,d=c.getEventXY(b),e=c.series.items,f,g,h,i;for(f=0,g=e.length;f<g;f++)h=e[f],Ext.draw.Draw.withinBox(d[0],d[1],h.bbox)&&h.getItemForPoint&&(i=h.getItemForPoint(d[0],d[1]),i&&h.fireEvent(a,i))},onMouseDown:function(a){var b=this,c=b.getEventXY(a),d=b.series.items,e,f,g,h;b.enableMask&&b.mixins.mask.onMouseDown.call(b,a);for(e=0,f=d.length;e<f;e++)g=d[e],Ext.draw.Draw.withinBox(c[0],c[1],g.bbox)&&g.getItemForPoint&&(h=g.getItemForPoint(c[0],c[1]),h&&g.fireEvent("itemmousedown",h))},onMouseUp:function(a){var b=this,c=b.getEventXY(a),d=b.series.items,e,f,g,h;b.enableMask&&b.mixins.mask.onMouseUp.call(b,a);for(e=0,f=d.length;e<f;e++)g=d[e],Ext.draw.Draw.withinBox(c[0],c[1],g.bbox)&&g.getItemForPoint&&(h=g.getItemForPoint(c[0],c[1]),h&&g.fireEvent("itemmouseup",h))},onMouseMove:function(a){var b=this,c=b.getEventXY(a),d=b.series.items,e,f,g,h,i,j,k;b.enableMask&&b.mixins.mask.onMouseMove.call(b,a);for(e=0,f=d.length;e<f;e++){g=d[e];if(Ext.draw.Draw.withinBox(c[0],c[1],g.bbox)){if(g.getItemForPoint){h=g.getItemForPoint(c[0],c[1]),i=g._lastItemForPoint,j=g._lastStoreItem,k=g._lastStoreField;if(h!==i||h&&(h.storeItem!=j||h.storeField!=k))i&&(g.fireEvent("itemmouseout",i),delete g._lastItemForPoint,delete g._lastStoreField,delete g._lastStoreItem),h&&(g.fireEvent("itemmouseover",h),g._lastItemForPoint=h,g._lastStoreItem=h.storeItem,g._lastStoreField=h.storeField)}}else i=g._lastItemForPoint,i&&(g.fireEvent("itemmouseout",i),delete g._lastItemForPoint,delete g._lastStoreField,delete g._lastStoreItem)}},onMouseLeave:function(a){var b=this,c=b.series.items,d,e,f;b.enableMask&&b.mixins.mask.onMouseLeave.call(b,a);for(d=0,e=c.length;d<e;d++)f=c[d],delete f._lastItemForPoint},delayRefresh:function(){var a=this;a.refreshTask||(a.refreshTask=new Ext.util.DelayedTask(a.refresh,a)),a.refreshTask.delay(a.refreshBuffer)},refresh:function(){var a=this;a.rendered&&a.curWidth!==undefined&&a.curHeight!==undefined&&a.fireEvent("beforerefresh",a)!==!1&&(a.redraw(),a.fireEvent("refresh",a))},bindStore:function(a,b){var c=this;c.mixins.bindable.bindStore.apply(c,arguments),c.store&&!b&&c.refresh()},getStoreListeners:function(){var a=this.refresh,b=this.delayRefresh;return{refresh:a,add:b,remove:b,update:b,clear:a}},initializeAxis:function(a){var b=this,c=b.chartBBox,d=c.width,e=c.height,f=c.x,g=c.y,h=b.themeAttrs,i={chart:b};h&&(i.axisStyle=Ext.apply({},h.axis),i.axisLabelLeftStyle=Ext.apply({},h.axisLabelLeft),i.axisLabelRightStyle=Ext.apply({},h.axisLabelRight),i.axisLabelTopStyle=Ext.apply({},h.axisLabelTop),i.axisLabelBottomStyle=Ext.apply({},h.axisLabelBottom),i.axisTitleLeftStyle=Ext.apply({},h.axisTitleLeft),i.axisTitleRightStyle=Ext.apply({},h.axisTitleRight),i.axisTitleTopStyle=Ext.apply({},h.axisTitleTop),i.axisTitleBottomStyle=Ext.apply({},h.axisTitleBottom));switch(a.position){case"top":Ext.apply(i,{length:d,width:e,x:f,y:g});break;case"bottom":Ext.apply(i,{length:d,width:e,x:f,y:e});break;case"left":Ext.apply(i,{length:e,width:d,x:f,y:e});break;case"right":Ext.apply(i,{length:e,width:d,x:d,y:e})}a.chart?Ext.apply(a,i):(Ext.apply(i,a),a=b.axes.replace(Ext.createByAlias("axis."+a.type.toLowerCase(),i)))},alignAxes:function(){function p(a){var c=b.findIndex("position",a);return c<0?null:b.getAt(c)}var a=this,b=a.axes,c=b.items,d,e=a.legend,f=["top","right","bottom","left"],g,h,i,j,k=a.insetPadding,l={top:k,right:k,bottom:k,left:k},m,n,o;for(h=0,i=f.length;h<i;h++)g=f[h],m=g==="left"||g==="right",d=p(g),e!==!1&&e.position===g&&(n=e.getBBox(),l[g]+=(m?n.width:n.height)+l[g]),d&&d.bbox&&(n=d.bbox,l[g]+=m?n.width:n.height);j={x:l.left,y:l.top,width:a.curWidth-l.left-l.right,height:a.curHeight-l.top-l.bottom},a.chartBBox=j;for(h=0,i=c.length;h<i;h++)d=c[h],o=d.position,m=o==="left"||o==="right",d.x=o==="right"?j.x+j.width:j.x,d.y=o==="top"?j.y:j.y+j.height,d.width=m?j.width:j.height,d.length=m?j.height:j.width},initializeSeries:function(a,b){var c=this,d=c.themeAttrs,e,f,g,h,i,j=[],k=0,l,m={chart:c,seriesId:a.seriesId};if(d){g=d.seriesThemes,i=d.markerThemes,e=Ext.apply({},d.series),f=Ext.apply({},d.marker),m.seriesStyle=Ext.apply(e,g[b%g.length]),m.seriesLabelStyle=Ext.apply({},d.seriesLabel),m.markerStyle=Ext.apply(f,i[b%i.length]);if(d.colors)m.colorArrayStyle=d.colors;else{j=[];for(l=g.length;k<l;k++)h=g[k],(h.fill||h.stroke)&&j.push(h.fill||h.stroke);j.length&&(m.colorArrayStyle=j)}m.seriesIdx=b}a instanceof Ext.chart.series.Series?Ext.apply(a,m):(Ext.applyIf(m,a),a=c.series.replace(Ext.createByAlias("series."+a.type.toLowerCase(),m))),a.initialize&&a.initialize()},getMaxGutter:function(){var a=this,b=a.series.items,c,d,e,f=[0,0],g;for(c=0,d=b.length;c<d;c++)e=b[c],g=e.getGutters&&e.getGutters()||[0,0],f[0]=Math.max(f[0],g[0]),f[1]=Math.max(f[1],g[1]);a.maxGutter=f},drawAxis:function(a){a.drawAxis()},drawCharts:function(a){a.triggerafterrender=!1,a.drawSeries(),this.animate||a.fireEvent("afterrender")},save:function(a){return Ext.draw.Surface.save(a,this.surface)},destroy:function(){Ext.destroy(this.surface),this.bindStore(null),this.callParent(arguments)}}),Ext.define("Ext.chart.TipSurface",{extend:"Ext.draw.Component",spriteArray:!1,renderFirst:!0,constructor:function(a){this.callParent([a]),a.sprites&&(this.spriteArray=[].concat(a.sprites),delete a.sprites)},onRender:function(){var a=this,b=0,c=0,d,e;this.callParent(arguments),e=a.spriteArray;if(a.renderFirst&&e){a.renderFirst=!1;for(c=e.length;b<c;b++)d=a.surface.add(e[b]),d.setAttributes({hidden:!1},!0)}}}),Ext.define("Ext.chart.axis.Abstract",{requires:["Ext.chart.Chart"],constructor:function(a){a=a||{};var b=this,c=a.position||"left";c=c.charAt(0).toUpperCase()+c.substring(1),a.label=Ext.apply(a["axisLabel"+c+"Style"]||{},a.label||{}),a.axisTitleStyle=Ext.apply(a["axisTitle"+c+"Style"]||{},a.labelTitle||{}),Ext.apply(b,a),b.fields=Ext.Array.from(b.fields),this.callParent(),b.labels=[],b.getId(),b.labelGroup=b.chart.surface.getGroup(b.axisId+"-labels")},alignment:null,grid:!1,steps:10,x:0,y:0,minValue:0,maxValue:0,getId:function(){return this.axisId||(this.axisId=Ext.id(null,"ext-axis-"))},processView:Ext.emptyFn,drawAxis:Ext.emptyFn,addDisplayAndLabels:Ext.emptyFn}),Ext.define("Ext.chart.axis.Axis",{extend:"Ext.chart.axis.Abstract",alternateClassName:"Ext.chart.Axis",requires:["Ext.draw.Draw"],forceMinMax:!1,dashSize:3,position:"bottom",skipFirst:!1,length:0,width:0,adjustEnd:!0,majorTickSteps:!1,applyData:Ext.emptyFn,getRange:function(){var a=this,b=a.chart,c=b.getChartStore(),d=c.data.items,e=b.series.items,f=a.position,g,h=Ext.chart.series,i=[],j=Infinity,k=-Infinity,l=a.position==="left"||a.position==="right",m,n,o,p,q,r=d.length,s,t={},u={},v=!0,w,x,y,z,A;w=a.fields;for(p=0,n=w.length;p<n;p++)u[w[p]]=!0;for(m=0,n=e.length;m<n;m++){if(e[m].seriesIsHidden)continue;if(!e[m].getAxesForXAndYFields)continue;g=e[m].getAxesForXAndYFields();if(g.xAxis&&g.xAxis!==f&&g.yAxis&&g.yAxis!==f)continue;h.Bar&&e[m]instanceof h.Bar&&!e[m].column?w=l?Ext.Array.from(e[m].xField):Ext.Array.from(e[m].yField):w=l?Ext.Array.from(e[m].yField):Ext.Array.from(e[m].xField);if(a.fields.length){for(p=0,o=w.length;p<o;p++)if(u[w[p]])break;if(p==o)continue}if(s=e[m].stacked)h.Bar&&e[m]instanceof h.Bar?e[m].column!=l&&(s=!1,v=!1):l||(s=!1,v=!1);if(s){x={};for(p=0;p<w.length;p++){if(v&&e[m].__excludes&&e[m].__excludes[p])continue;u[w[p]]||Ext.Logger.warn("Field `"+w[p]+"` is not included in the "+f+" axis config."),u[w[p]]=x[w[p]]=!0}i.push({fields:x,value:0})}else{if(!w||w.length==0)w=a.fields;for(p=0;p<w.length;p++){if(v&&e[m].__excludes&&e[m].__excludes[p])continue;u[w[p]]=t[w[p]]=!0}}}for(m=0;m<r;m++){y=d[m];for(q=0;q<i.length;q++)i[q].value=0;for(z in u){A=y.get(z);if(isNaN(A))continue;A===undefined&&(A=0),t[z]&&(j>A&&(j=A),k<A&&(k=A));for(q=0;q<i.length;q++)i[q].fields[z]&&(i[q].value+=A,j>0&&(j=0),k<i[q].value&&(k=i[q].value))}}return isFinite(k)||(k=a.prevMax||0),isFinite(j)||(j=a.prevMin||0),j!=k&&k!=Math.floor(k)&&(k=Math.floor(k)+1),isNaN(a.minimum)||(j=a.minimum),isNaN(a.maximum)||(k=a.maximum),{min:j,max:k}},calcEnds:function(){var a=this,b=a.fields,c=a.getRange(),d=c.min,e=c.max,f,g,h;return h=Ext.draw.Draw.snapEnds(d,e,a.majorTickSteps!==!1?a.majorTickSteps+1:a.steps,a.majorTickSteps===!1),f=h.from,g=h.to,a.forceMinMax&&(isNaN(e)||(h.to=e),isNaN(d)||(h.from=d)),isNaN(a.maximum)||(h.to=a.maximum),isNaN(a.minimum)||(h.from=a.minimum),h.step=(h.to-h.from)/(g-f)*h.step,a.adjustMaximumByMajorUnit&&(h.to=Math.ceil(h.to/h.step)*h.step,h.steps=(h.to-h.from)/h.step),a.adjustMinimumByMajorUnit&&(h.from=Math.floor(h.from/h.step)*h.step,h.steps=(h.to-h.from)/h.step),a.prevMin=d==e?0:d,a.prevMax=e,h},drawAxis:function(a){var b=this,c,d,e=b.x,f=b.y,g=b.chart.maxGutter[0],h=b.chart.maxGutter[1],i=b.dashSize,j=b.minorTickSteps||0,k=b.minorTickSteps||0,l=b.length,m=b.position,n=[],o=!1,p=b.applyData(),q=p.step,r=p.steps,s=p.from,t=p.to,u,v,w,x,y,z,A,B;if(b.hidden||isNaN(q)||s>t)return;b.from=p.from,b.to=p.to,m=="left"||m=="right"?(v=Math.floor(e)+.5,x=["M",v,f,"l",0,-l],u=l-h*2):(w=Math.floor(f)+.5,x=["M",e,w,"l",l,0],u=l-g*2),B=r&&u/r,z=Math.max(j+1,0),A=Math.max(k+1,0);if(b.type=="Numeric"||b.type=="Time")o=!0,b.labels=[p.from];if(m=="right"||m=="left"){w=f-h,v=e-(m=="left")*i*2;while(w>=f-h-u){x.push("M",v,Math.floor(w)+.5,"l",i*2+1,0);if(w!=f-h)for(c=1;c<A;c++)x.push("M",v+i,Math.floor(w+B*c/A)+.5,"l",i+1,0);n.push([Math.floor(e),Math.floor(w)]),w-=B,o&&b.labels.push(b.labels[b.labels.length-1]+q);if(B===0)break}if(Math.round(w+B-(f-h-u))){x.push("M",v,Math.floor(f-l+h)+.5,"l",i*2+1,0);for(c=1;c<A;c++)x.push("M",v+i,Math.floor(f-l+h+B*c/A)+.5,"l",i+1,0);n.push([Math.floor(e),Math.floor(w)]),o&&b.labels.push(b.labels[b.labels.length-1]+q)}}else{v=e+g,w=f-(m=="top")*i*2;while(v<=e+g+u){x.push("M",Math.floor(v)+.5,w,"l",0,i*2+1);if(v!=e+g)for(c=1;c<z;c++)x.push("M",Math.floor(v-B*c/z)+.5,w,"l",0,i+1);n.push([Math.floor(v),Math.floor(f)]),v+=B,o&&b.labels.push(b.labels[b.labels.length-1]+q);if(B===0)break}if(Math.round(v-B-(e+g+u))){x.push("M",Math.floor(e+l-g)+.5,w,"l",0,i*2+1);for(c=1;c<z;c++)x.push("M",Math.floor(e+l-g-B*c/z)+.5,w,"l",0,i+1);n.push([Math.floor(v),Math.floor(f)]),o&&b.labels.push(b.labels[b.labels.length-1]+q)}}o&&(b.labels[n.length-1]=+b.labels[n.length-1].toFixed(10)),b.axis||(b.axis=b.chart.surface.add(Ext.apply({type:"path",path:x},b.axisStyle))),b.axis.setAttributes({path:x},!0),b.inflections=n,!a&&b.grid&&b.drawGrid(),b.axisBBox=b.axis.getBBox(),b.drawLabel()},drawGrid:function(){var a=this,b=a.chart.surface,c=a.grid,d=c.odd,e=c.even,f=a.inflections,g=f.length-(d||e?0:1),h=a.position,i=a.chart.maxGutter,j=a.width-2,k=!1,l,m,n=1,o=[],p,q,r,s=[],t=[];if(i[1]!==0&&(h=="left"||h=="right")||i[0]!==0&&(h=="top"||h=="bottom"))n=0,g++;for(;n<g;n++)l=f[n],m=f[n-1],d||e?(o=n%2?s:t,p=(n%2?d:e)||{},q=(p.lineWidth||p["stroke-width"]||0)/2,r=2*q,h=="left"?o.push("M",m[0]+1+q,m[1]+.5-q,"L",m[0]+1+j-q,m[1]+.5-q,"L",l[0]+1+j-q,l[1]+.5+q,"L",l[0]+1+q,l[1]+.5+q,"Z"):h=="right"?o.push("M",m[0]-q,m[1]+.5-q,"L",m[0]-j+q,m[1]+.5-q,"L",l[0]-j+q,l[1]+.5+q,"L",l[0]-q,l[1]+.5+q,"Z"):h=="top"?o.push("M",m[0]+.5+q,m[1]+1+q,"L",m[0]+.5+q,m[1]+1+j-q,"L",l[0]+.5-q,l[1]+1+j-q,"L",l[0]+.5-q,l[1]+1+q,"Z"):o.push("M",m[0]+.5+q,m[1]-q,"L",m[0]+.5+q,m[1]-j+q,"L",l[0]+.5-q,l[1]-j+q,"L",l[0]+.5-q,l[1]-q,"Z")):h=="left"?o=o.concat(["M",l[0]+.5,l[1]+.5,"l",j,0]):h=="right"?o=o.concat(["M",l[0]-.5,l[1]+.5,"l",-j,0]):h=="top"?o=o.concat(["M",l[0]+.5,l[1]+.5,"l",0,j]):o=o.concat(["M",l[0]+.5,l[1]-.5,"l",0,-j]);d||e?(s.length&&(!a.gridOdd&&s.length&&(a.gridOdd=b.add({type:"path",path:s})),a.gridOdd.setAttributes(Ext.apply({path:s,hidden:!1},d||{}),!0)),t.length&&(a.gridEven||(a.gridEven=b.add({type:"path",path:t})),a.gridEven.setAttributes(Ext.apply({path:t,hidden:!1},e||{}),!0))):o.length?(a.gridLines||(a.gridLines=a.chart.surface.add({type:"path",path:o,"stroke-width":a.lineWidth||1,stroke:a.gridColor||"#ccc"})),a.gridLines.setAttributes({hidden:!1,path:o},!0)):a.gridLines&&a.gridLines.hide(!0)},getOrCreateLabel:function(a,b){var c=this,d=c.labelGroup,e=d.getAt(a),f=c.chart.surface;return e?b!=e.attr.text&&(e.setAttributes(Ext.apply({text:b},c.label),!0),e._bbox=e.getBBox()):(e=f.add(Ext.apply({group:d,type:"text",x:0,y:0,text:b},c.label)),f.renderItem(e),e._bbox=e.getBBox()),c.label.rotation?(e.setAttributes({rotation:{degrees:0}},!0),e._ubbox=e.getBBox(),e.setAttributes(c.label,!0)):e._ubbox=e._bbox,e},rect2pointArray:function(a){var b=this.chart.surface,c=b.getBBox(a,!0),d=[c.x,c.y],e=d.slice(),f=[c.x+c.width,c.y],g=f.slice(),h=[c.x+c.width,c.y+c.height],i=h.slice(),j=[c.x,c.y+c.height],k=j.slice(),l=a.matrix;return d[0]=l.x.apply(l,e),d[1]=l.y.apply(l,e),f[0]=l.x.apply(l,g),f[1]=l.y.apply(l,g),h[0]=l.x.apply(l,i),h[1]=l.y.apply(l,i),j[0]=l.x.apply(l,k),j[1]=l.y.apply(l,k),[d,f,h,j]},intersect:function(a,b){var c=this.rect2pointArray(a),d=this.rect2pointArray(b);return!!Ext.draw.Draw.intersect(c,d).length},drawHorizontalLabels:function(){var a=this,b=a.label,c=Math.floor,d=Math.max,e=a.chart.axes,f=a.chart.insetPadding,g=a.position,h=a.inflections,i=h.length,j=a.labels,k=a.labelGroup,l=0,m,n=a.chart.maxGutter[1],o,p,q,r,s,t,u=0,v=a.adjustEnd,w=e.findIndex("position","left")!=-1,x=e.findIndex("position","right")!=-1,y,z,A,B,C,D,E,F,G,H;D=i-1,q=h[0],H=a.getOrCreateLabel(0,a.label.renderer(j[0])),m=Math.floor(Math.abs(Math.sin(b.rotate&&b.rotate.degrees*Math.PI/180||0)));for(G=0;G<i;G++){q=h[G],B=a.label.renderer(j[G]),y=a.getOrCreateLabel(G,B),p=y._bbox,l=d(l,p.height+a.dashSize+a.label.padding),E=c(q[0]-(m?p.height:p.width)/2),v&&a.chart.maxGutter[0]==0&&(G==0&&!w?E=q[0]:G==D&&!x&&(E=Math.min(E,q[0]-p.width+f))),g=="top"?F=q[1]-a.dashSize*2-a.label.padding-p.height/2:F=q[1]+a.dashSize*2+a.label.padding+p.height/2,y.setAttributes({hidden:!1,x:E,y:F},!0);if(G!=0&&(a.intersect(y,s)||a.intersect(y,H))){if(G!==D||t===0){y.hide(!0);continue}s.hide(!0)}s=y,t=G}return l},drawVerticalLabels:function(){var a=this,b=a.inflections,c=a.position,d=b.length,e=a.chart,f=e.insetPadding,g=a.labels,h=0,i=Math.max,j=Math.floor,k=Math.ceil,l=a.chart.axes,m=a.chart.maxGutter[1],n,o,p,q,r,s=0,t=l.findIndex("position","top")!=-1,u=l.findIndex("position","bottom")!=-1,v=a.adjustEnd,w,x,y,z,A,B,C,D,E;B=d;for(E=0;E<B;E++){p=b[E],z=a.label.renderer(g[E]),w=a.getOrCreateLabel(E,z),o=w._bbox,h=i(h,o.width+a.dashSize+a.label.padding),D=p[1],v&&m<o.height/2&&(E==B-1&&!t?D=Math.max(D,a.y-a.length+k(o.height/2)-f):E==0&&!u&&(D=a.y+m-j(o.height/2))),c=="left"?C=p[0]-o.width-a.dashSize-a.label.padding-2:C=p[0]+a.dashSize+a.label.padding+2,w.setAttributes(Ext.apply({hidden:!1,x:C,y:D},a.label),!0);if(E!=0&&a.intersect(w,q)){if(E!==B-1||r===0){w.hide(!0);continue}q.hide(!0)}q=w,r=E}return h},drawLabel:function(){var a=this,b=a.position,c=a.labelGroup,d=a.inflections,e=0,f=0,g,h;b=="left"||b=="right"?e=a.drawVerticalLabels():f=a.drawHorizontalLabels(),g=c.getCount(),h=d.length;for(;h<g;h++)c.getAt(h).hide(!0);a.bbox={},Ext.apply(a.bbox,a.axisBBox),a.bbox.height=f,a.bbox.width=e,Ext.isString(a.title)&&a.drawTitle(e,f)},elipsis:function(a,b,c,d,e){var f,g;if(c<d)return a.hide(!0),!1;while(b.length>4){b=b.substr(0,b.length-4)+"...",a.setAttributes({text:b},!0),f=a.getBBox();if(f.width<c){typeof e=="number"&&a.setAttributes({x:Math.floor(e-f.width/2)},!0);break}}return!0},setTitle:function(a){this.title=a,this.drawLabel()},drawTitle:function(a,b){var c=this,d=c.position,e=c.chart.surface,f=c.displaySprite,g=c.title,h=d=="left"||d=="right",i=c.x,j=c.y,k,l,m;f?f.setAttributes({text:g},!0):(k={type:"text",x:0,y:0,text:g},f=c.displaySprite=e.add(Ext.apply(k,c.axisTitleStyle,c.labelTitle)),e.renderItem(f)),l=f.getBBox(),m=c.dashSize+c.label.padding,h?(j-=c.length/2-l.height/2,d=="left"?i-=a+m+l.width/2:i+=a+m+l.width-l.width/2,c.bbox.width+=l.width+10):(i+=c.length/2-l.width*.5,d=="top"?j-=b+m+l.height*.3:j+=b+m+l.height*.8,c.bbox.height+=l.height+10),f.setAttributes({translate:{x:i,y:j}},!0)}}),Ext.define("Ext.chart.axis.Category",{extend:"Ext.chart.axis.Axis",alternateClassName:"Ext.chart.CategoryAxis",alias:"axis.category",categoryNames:null,calculateCategoryCount:!1,setLabels:function(){var a=this.chart.getChartStore(),b=a.data.items,c,d,e,f=this.fields,g=f.length,h;this.labels=[];for(c=0,d=b.length;c<d;c++){e=b[c];for(h=0;h<g;h++)this.labels.push(e.get(f[h]))}},applyData:function(){this.callParent(),this.setLabels();var a=this.chart.getChartStore().getCount();return{from:0,to:a-1,power:1,step:1,steps:a-1}}}),Ext.define("Ext.chart.axis.Gauge",{extend:"Ext.chart.axis.Abstract",position:"gauge",alias:"axis.gauge",drawAxis:function(a){var b=this.chart,c=b.surface,d=b.chartBBox,e=d.x+d.width/2,f=d.y+d.height,g=this.margin||10,h=Math.min(d.width,2*d.height)/2+g,i=[],j,k=this.steps,l,m=Math.PI,n=Math.cos,o=Math.sin;if(this.sprites&&!b.resizing){this.drawLabel();return}if(this.margin>=0)if(!this.sprites)for(l=0;l<=k;l++)j=c.add({type:"path",path:["M",e+(h-g)*n(l/k*m-m),f+(h-g)*o(l/k*m-m),"L",e+h*n(l/k*m-m),f+h*o(l/k*m-m),"Z"],stroke:"#ccc"}),j.setAttributes({hidden:!1},!0),i.push(j);else{i=this.sprites;for(l=0;l<=k;l++)i[l].setAttributes({path:["M",e+(h-g)*n(l/k*m-m),f+(h-g)*o(l/k*m-m),"L",e+h*n(l/k*m-m),f+h*o(l/k*m-m),"Z"],stroke:"#ccc"},!0)}this.sprites=i,this.drawLabel(),this.title&&this.drawTitle()},drawTitle:function(){var a=this,b=a.chart,c=b.surface,d=b.chartBBox,e=a.titleSprite,f;e||(a.titleSprite=e=c.add({type:"text",zIndex:2})),e.setAttributes(Ext.apply({text:a.title},a.label||{}),!0),f=e.getBBox(),e.setAttributes({x:d.x+d.width/2-f.width/2,y:d.y+d.height-f.height/2-4},!0)},setTitle:function(a){this.title=a,this.drawTitle()},drawLabel:function(){var a=this.chart,b=a.surface,c=a.chartBBox,d=c.x+c.width/2,e=c.y+c.height,f=this.margin||10,g=Math.min(c.width,2*c.height)/2+2*f,h=Math.round,i=[],j,k=this.maximum||0,l=this.minimum||0,m=this.steps,n=0,o,p=Math.PI,q=Math.cos,r=Math.sin,s=this.label,t=s.renderer||function(a){return a};if(!this.labelArray)for(n=0;n<=m;n++)o=n===0||n===m?7:0,j=b.add({type:"text",text:t(h(l+n/m*(k-l))),x:d+g*q(n/m*p-p),y:e+g*r(n/m*p-p)-o,"text-anchor":"middle","stroke-width":.2,zIndex:10,stroke:"#333"}),j.setAttributes({hidden:!1},!0),i.push(j);else{i=this.labelArray;for(n=0;n<=m;n++)o=n===0||n===m?7:0,i[n].setAttributes({text:t(h(l+n/m*(k-l))),x:d+g*q(n/m*p-p),y:e+g*r(n/m*p-p)-o},!0)}this.labelArray=i}}),Ext.define("Ext.chart.axis.Numeric",{extend:"Ext.chart.axis.Axis",alternateClassName:"Ext.chart.NumericAxis",type:"numeric",alias:"axis.numeric",uses:["Ext.data.Store"],constructor:function(a){var b=this,c=!!a.label&&!!a.label.renderer,d;b.callParent([a]),d=b.label,a.constrain==null&&(b.constrain=a.minimum!=null&&a.maximum!=null),c||(d.renderer=function(a){return b.roundToDecimal(a,b.decimals)})},roundToDecimal:function(a,b){var c=Math.pow(10,b||0);return Math.floor(a*c)/c},minimum:NaN,maximum:NaN,constrain:!0,decimals:2,scale:"linear",doConstrain:function(){var a=this,b=a.chart.store,c=b.data.items,d,e,f,g=a.chart.series.items,h=a.fields,i=h.length,j=a.getRange(),k=j.min,l=j.max,m,n,o=[],p=!1,q,r=[],s;for(m=0,n=g.length;m<n;m++)o[m]=g[m].__excludes,p=p||g[m].stacked;for(d=0,e=c.length;d<e;d++){s=!0,f=c[d];for(m=0;m<i;m++){s=!0;if(o[m])continue;q=f.get(h[m]);if(!p&&+q<+k){s=!1;break}if(!p&&+q>+l){s=!1;break}}s&&r.push(f)}a.chart.substore=Ext.create("Ext.data.Store",{model:b.model,data:r})},position:"left",adjustMaximumByMajorUnit:!1,adjustMinimumByMajorUnit:!1,processView:function(){var a=this,b=a.constrain;b&&a.doConstrain()},applyData:function(){return this.callParent(),this.calcEnds()}}),Ext.define("Ext.chart.axis.Radial",{extend:"Ext.chart.axis.Abstract",position:"radial",alias:"axis.radial",drawAxis:function(a){var b=this.chart,c=b.surface,d=b.chartBBox,e=b.store,f=e.getCount(),g=d.x+d.width/2,h=d.y+d.height/2,i=Math.min(d.width,d.height)/2,j=[],k,l=this.steps,m,n,o=Math.PI*2,p=Math.cos,q=Math.sin;if(this.sprites&&!b.resizing){this.drawLabel();return}if(!this.sprites){for(m=1;m<=l;m++)k=c.add({type:"circle",x:g,y:h,radius:Math.max(i*m/l,0),stroke:"#ccc"}),k.setAttributes({hidden:!1},!0),j.push(k);for(m=0;m<f;m++)k=c.add({type:"path",path:["M",g,h,"L",g+i*p(m/f*o),h+i*q(m/f*o),"Z"],stroke:"#ccc"}),k.setAttributes({hidden:!1},!0),j.push(k)}else{j=this.sprites;for(m=0;m<l;m++)j[m].setAttributes({x:g,y:h,radius:Math.max(i*(m+1)/l,0),stroke:"#ccc"},!0);for(n=0;n<f;n++)j[m+n].setAttributes({path:["M",g,h,"L",g+i*p(n/f*o),h+i*q(n/f*o),"Z"],stroke:"#ccc"},!0)}this.sprites=j,this.drawLabel()},drawLabel:function(){var a=this.chart,b=a.series.items,c,d=a.surface,e=a.chartBBox,f=a.store,g=f.data.items,h,i,j=e.x+e.width/2,k=e.y+e.height/2,l=Math.min(e.width,e.height)/2,m=Math.max,n=Math.round,o=[],p,q=[],r,s=[],t,u=!this.maximum,v=this.maximum||0,w=this.steps,x=0,y,z,A,B=Math.PI*2,C=Math.cos,D=Math.sin,E=this.label.display,F=E!=="none",G=10;if(!F)return;for(x=0,h=b.length;x<h;x++)c=b[x],q.push(c.yField),t=c.xField;for(y=0,h=g.length;y<h;y++){i=g[y];if(u)for(x=0,r=q.length;x<r;x++)v=m(+i.get(q[x]),v);s.push(i.get(t))}if(!this.labelArray){if(E!="categories")for(x=1;x<=w;x++)p=d.add({type:"text",text:n(x/w*v),x:j,y:k-l*x/w,"text-anchor":"middle","stroke-width":.1,stroke:"#333"}),p.setAttributes({hidden:!1},!0),o.push(p);if(E!="scale")for(y=0,w=s.length;y<w;y++)z=C(y/w*B)*(l+G),A=D(y/w*B)*(l+G),p=d.add({type:"text",text:s[y],x:j+z,y:k+A,"text-anchor":z*z<=.001?"middle":z<0?"end":"start"}),p.setAttributes({hidden:!1},!0),o.push(p)}else{o=this.labelArray;if(E!="categories")for(x=0;x<w;x++)o[x].setAttributes({text:n((x+1)/w*v),x:j,y:k-l*(x+1)/w,"text-anchor":"middle","stroke-width":.1,stroke:"#333"},!0);if(E!="scale")for(y=0,w=s.length;y<w;y++)z=C(y/w*B)*(l+G),A=D(y/w*B)*(l+G),o[x+y]&&o[x+y].setAttributes({type:"text",text:s[y],x:j+z,y:k+A,"text-anchor":z*z<=.001?"middle":z<0?"end":"start"},!0)}this.labelArray=o}}),Ext.define("Ext.chart.axis.Time",{extend:"Ext.chart.axis.Numeric",alternateClassName:"Ext.chart.TimeAxis",alias:"axis.time",uses:["Ext.data.Store"],dateFormat:!1,fromDate:!1,toDate:!1,step:[Ext.Date.DAY,1],constrain:!1,constructor:function(a){var b=this,c,d,e;b.callParent([a]),c=b.label||{},e=this.dateFormat,e&&(c.renderer?(d=c.renderer,c.renderer=function(a){return a=d(a),Ext.Date.format(new Date(d(a)),e)}):c.renderer=function(a){return Ext.Date.format(new Date(a>>0),e)})},processView:function(){var a=this;a.fromDate&&(a.minimum=+a.fromDate),a.toDate&&(a.maximum=+a.toDate),a.constrain&&a.doConstrain()},calcEnds:function(){var a=this,b,c=a.step;return c?(b=a.getRange(),b=Ext.draw.Draw.snapEndsByDateAndStep(new Date(b.min),new Date(b.max),Ext.isNumber(c)?[Date.MILLI,c]:c),a.minimum&&(b.from=a.minimum),a.maximum&&(b.to=a.maximum),b.step=(b.to-b.from)/b.steps,b):a.callParent(arguments)}}),Ext.define("Ext.draw.Text",{extend:"Ext.draw.Component",uses:["Ext.util.CSS"],alias:"widget.text",text:"",focusable:!1,viewBox:!1,autoSize:!0,baseCls:Ext.baseCSSPrefix+"surface "+Ext.baseCSSPrefix+"draw-text",initComponent:function(){var a=this;a.textConfig=Ext.apply({type:"text",text:a.text,rotate:{degrees:a.degrees||0}},a.textStyle),Ext.apply(a.textConfig,a.getStyles(a.styleSelectors||a.styleSelector)),a.initialConfig.items=[a.textConfig],a.callParent(arguments)},getStyles:function(a){a=Ext.Array.from(a);var b=0,c=a.length,d,e,f,g={};for(;b<c;b++)d=Ext.util.CSS.getRule(a[b]),d&&(e=d.style,e&&Ext.apply(g,{"font-family":e.fontFamily,"font-weight":e.fontWeight,"line-height":e.lineHeight,"font-size":e.fontSize,fill:e.color}));return g},setAngle:function(a){var b=this,c,d;b.rendered?(c=b.surface,d=c.items.items[0],b.degrees=a,d.setAttributes({rotate:{degrees:a}},!0),(b.autoSize||b.viewBox)&&b.updateLayout()):b.degrees=a},setText:function(a){var b=this,c,d;b.rendered?(c=b.surface,d=c.items.items[0],b.text=a||"",c.remove(d),b.textConfig.type="text",b.textConfig.text=b.text,d=c.add(b.textConfig),d.setAttributes({rotate:{degrees:b.degrees}},!0),(b.autoSize||b.viewBox)&&b.updateLayout()):b.on({render:function(){b.setText(a)},single:!0})}}),Ext.define("Ext.FocusManager",{singleton:!0,alternateClassName:["Ext.FocusMgr"],mixins:{observable:"Ext.util.Observable"},requires:["Ext.AbstractComponent","Ext.Component","Ext.ComponentManager","Ext.ComponentQuery","Ext.util.HashMap","Ext.util.KeyNav"],enabled:!1,focusElementCls:Ext.baseCSSPrefix+"focus-element",focusFrameCls:Ext.baseCSSPrefix+"focus-frame",whitelist:["textfield"],constructor:function(a){var b=this,c=Ext.ComponentQuery;b.mixins.observable.constructor.call(b,a),b.addEvents("beforecomponentfocus","componentfocus","disable","enable"),b.focusTask=new Ext.util.DelayedTask(b.handleComponentFocus,b),Ext.override(Ext.AbstractComponent,{onFocus:function(){this.callParent(arguments),b.enabled&&this.hasFocus&&(Array.prototype.unshift.call(arguments,this),b.onComponentFocus.apply(b,arguments))},onBlur:function(){this.callParent(arguments),b.enabled&&!this.hasFocus&&(Array.prototype.unshift.call(arguments,this),b.onComponentBlur.apply(b,arguments))},onDestroy:function(){this.callParent(arguments),b.enabled&&(Array.prototype.unshift.call(arguments,this),b.onComponentDestroy.apply(b,arguments))}}),Ext.override(Ext.Component,{afterHide:function(){this.callParent(arguments),b.enabled&&(Array.prototype.unshift.call(arguments,this),b.onComponentHide.apply(b,arguments))}}),b.keyNav=new Ext.util.KeyNav(Ext.getDoc(),{disabled:!0,scope:b,backspace:b.focusLast,enter:b.navigateIn,esc:b.navigateOut,tab:b.navigateSiblings,space:b.navigateIn,del:b.focusLast,left:b.navigateSiblings,right:b.navigateSiblings,down:b.navigateSiblings,up:b.navigateSiblings}),b.focusData={},b.subscribers=new Ext.util.HashMap,b.focusChain={},Ext.apply(c.pseudos,{focusable:function(a){var b=a.length,c=[],d=0,e;for(;d<b;d++)e=a[d],e.isFocusable()&&c.push(e);return c},nextFocus:function(a,b,c){c=c||1,b=parseInt(b,10);var d=a.length,e=b,f;for(;;){(e+=c)>=d?e=0:e<0&&(e=d-1);if(e===b)return[];if((f=a[e]).isFocusable())return[f]}return[]},prevFocus:function(a,b){return this.nextFocus(a,b,-1)},root:function(a){var b=a.length,c=[],d=0,e;for(;d<b;d++)e=a[d],e.ownerCt||c.push(e);return c}})},addXTypeToWhitelist:function(a){var b=this;if(Ext.isArray(a)){Ext.Array.forEach(a,b.addXTypeToWhitelist,b);return}Ext.Array.contains(b.whitelist,a)||b.whitelist.push(a)},clearComponent:function(a){clearTimeout(this.cmpFocusDelay),a.isDestroyed||a.blur()},disable:function(){var a=this;if(!a.enabled)return;delete a.options,a.enabled=!1,a.removeDOM(),a.keyNav.disable(),a.fireEvent("disable",a)},enable:function(a){var b=this;a===!0&&(a={focusFrame:!0}),b.options=a=a||{};if(b.enabled)return;b.enabled=!0,b.initDOM(a),b.keyNav.enable(),b.focusEl.focus(),delete b.focusedCmp,b.fireEvent("enable",b)},focusLast:function(a){var b=this;if(b.isWhitelisted(b.focusedCmp))return!0;b.previousFocusedCmp&&b.previousFocusedCmp.focus()},getRootComponents:function(){var a=this,b=Ext.ComponentQuery,c=b.query(":focusable:root:not([floating])"),d=b.query(":focusable:root[floating]");return d.sort(function(a,b){return a.el.getZIndex()>b.el.getZIndex()}),d.concat(c)},initDOM:function(a){var b=this,c=b.focusFrameCls,d=Ext.ComponentQuery.query("{getFocusEl()}:not([focusListenerAdded])"),e=0,f=d.length;if(!Ext.isReady)return Ext.onReady(b.initDOM,b);for(;e<f;e++)d[e].addFocusListener();b.focusEl||(b.focusEl=Ext.getBody(),b.focusEl.dom.tabIndex=-1),!b.focusFrame&&a.focusFrame&&(b.focusFrame=Ext.getBody().createChild({cls:c,children:[{cls:c+"-top"},{cls:c+"-bottom"},{cls:c+"-left"},{cls:c+"-right"}],style:"top: -100px; left: -100px;"}),b.focusFrame.setVisibilityMode(Ext.Element.DISPLAY),b.focusFrame.hide().setLeftTop(0,0))},isWhitelisted:function(a){return a&&Ext.Array.some(this.whitelist,function(b){return a.isXType(b)})},navigateIn:function(a){var b=this,c=b.focusedCmp,d,e;if(b.isWhitelisted(c))return!0;c?(e=c.hasFocus?Ext.ComponentQuery.query(">:focusable",c)[0]:c,e?e.focus():Ext.isFunction(c.onClick)&&(a.button=0,c.onClick(a),c.isVisible(!0)?c.focus():b.navigateOut())):(d=b.getRootComponents()[0],d&&(d.getFocusEl()===b.focusEl&&b.focusEl.blur(),d.focus()))},navigateOut:function(a){var b=this,c;return!b.focusedCmp||!(c=b.focusedCmp.up(":focusable"))?b.focusEl.focus():c.focus(),!0},navigateSiblings:function(a,b,c){var d=this,e=b||d,f=a.getKey(),g=Ext.EventObject,h=a.shiftKey||f==g.LEFT||f==g.UP,i=f==g.LEFT||f==g.RIGHT||f==g.UP||f==g.DOWN,j=h?"prev":"next",k,l,m,n;m=e.focusedCmp&&e.focusedCmp.comp||e.focusedCmp;if(!m&&!c)return!0;if(i&&d.isWhitelisted(m))return!0;!m||m.is(":root")?n=d.getRootComponents():(c=c||m.up(),c&&(n=c.getRefItems()));if(n){k=m?Ext.Array.indexOf(n,m):-1,l=Ext.ComponentQuery.query(":"+j+"Focus("+k+")",n)[0];if(l&&m!==l)return l.focus(),l}},onComponentBlur:function(a,b){var c=this;c.focusedCmp===a&&(c.previousFocusedCmp=a,delete c.focusedCmp),c.focusFrame&&c.focusFrame.hide()},onComponentFocus:function(a,b){var c=this,d=c.focusChain,e;if(!a.isFocusable()){c.clearComponent(a);if(d[a.id])return;e=a.up(),e&&(d[a.id]=!0,e.focus());return}c.focusChain={},c.focusTask.delay(10,null,null,[a,a.getFocusEl()])},handleComponentFocus:function(a,b){var c=this,d,e,f,g,h,i,j,k,l,m,n,o;if(c.fireEvent("beforecomponentfocus",c,a,c.previousFocusedCmp)===!1){c.clearComponent(a);return}c.focusedCmp=a,c.shouldShowFocusFrame(a)&&(d="."+c.focusFrameCls+"-",e=c.focusFrame,g=b.getPageBox(),h=g.top,i=g.left,j=g.width,k=g.height,l=e.child(d+"top"),m=e.child(d+"bottom"),n=e.child(d+"left"),o=e.child(d+"right"),l.setWidth(j).setLeftTop(i,h),m.setWidth(j).setLeftTop(i,h+k-2),n.setHeight(k-2).setLeftTop(i,h+2),o.setHeight(k-2).setLeftTop(i+j-2,h+2),e.show()),c.fireEvent("componentfocus",c,a,c.previousFocusedCmp)},onComponentHide:function(a){var b=this,c=!1,d=b.focusedCmp,e;d&&(c=a.hasFocus||a.isContainer&&a.isAncestor(b.focusedCmp)),b.clearComponent(a),c&&(e=a.up(":focusable"))?e.focus():b.focusEl.focus()},onComponentDestroy:function(){},removeDOM:function(){var a=this;if(a.enabled||a.subscribers.length)return;Ext.destroy(a.focusFrame),delete a.focusEl,delete a.focusFrame},removeXTypeFromWhitelist:function(a){var b=this;if(Ext.isArray(a)){Ext.Array.forEach(a,b.removeXTypeFromWhitelist,b);return}Ext.Array.remove(b.whitelist,a)},setupSubscriberKeys:function(a,b){var c=this,d=a.getFocusEl(),e=b.scope,f={backspace:c.focusLast,enter:c.navigateIn,esc:c.navigateOut,scope:c},g=function(b){return c.focusedCmp===a?c.navigateSiblings(b,c,a):c.navigateSiblings(b)};return Ext.iterate(b,function(b,c){f[b]=function(b){var d=g(b);return Ext.isFunction(c)&&c.call(e||a,b,d)===!0?!0:d}},c),new Ext.util.KeyNav(d,f)},shouldShowFocusFrame:function(a){var b=this,c=b.options||{},d=a.getFocusEl(),e=Ext.getDom(d).tagName;return!b.focusFrame||!a?!1:c.focusFrame?!0:b.focusData[a.id].focusFrame?!0:!1}}),Ext.define("Ext.Img",{extend:"Ext.Component",alias:["widget.image","widget.imagecomponent"],autoEl:"img",src:"",alt:"",imgCls:"",getElConfig:function(){var a=this,b=a.callParent(),c;return a.autoEl=="img"?c=b:b.cn=[c={tag:"img",id:a.id+"-img"}],a.imgCls&&(c.cls=(c.cls?c.cls+" ":"")+a.imgCls),c.src=a.src||Ext.BLANK_IMAGE_URL,a.alt&&(c.alt=a.alt),b},onRender:function(){var a=this,b;a.callParent(arguments),b=a.el,a.imgEl=a.autoEl=="img"?b:b.getById(a.id+"-img")},onDestroy:function(){Ext.destroy(this.imgEl),this.imgEl=null,this.callParent()},setSrc:function(a){var b=this,c=b.imgEl;b.src=a,c&&(c.dom.src=a||Ext.BLANK_IMAGE_URL)}}),Ext.define("Ext.LoadMask",{extend:"Ext.Component",alias:"widget.loadmask",mixins:{floating:"Ext.util.Floating",bindable:"Ext.util.Bindable"},uses:["Ext.data.StoreManager"],msg:"Loading...",msgCls:Ext.baseCSSPrefix+"mask-loading",maskCls:Ext.baseCSSPrefix+"mask",useMsg:!0,useTargetEl:!1,baseCls:Ext.baseCSSPrefix+"mask-msg",childEls:["msgEl"],renderTpl:'<div id="{id}-msgEl" style="position:relative" class="{[values.$comp.msgCls]}"></div>',floating:{shadow:"frame"},focusOnToFront:!1,bringParentToFront:!1,constructor:function(a,b){var c=this;a.isComponent||(a=Ext.get(a),this.isElement=!0),c.ownerCt=a,this.isElement||c.bindComponent(a),c.callParent([b]),c.store&&c.bindStore(c.store,!0)},bindComponent:function(a){var b=this,c={scope:this,resize:b.sizeMask,added:b.onComponentAdded,removed:b.onComponentRemoved},d=Ext.container.Container.hierarchyEventSource;a.floating?(c.move=b.sizeMask,a.zIndexManager.front!==a&&(b.restack=!0,b.activeOwner=a)):a.ownerCt?b.onComponentAdded(a.ownerCt):b.preventBringToFront=!0,b.mon(a,c),b.mon(d,{show:b.onContainerShow,hide:b.onContainerHide,expand:b.onContainerExpand,collapse:b.onContainerCollapse,scope:b})},onComponentAdded:function(a){var b=this;delete b.activeOwner,b.floatParent=a,a.floating||(a=a.up("[floating]")),a&&(b.activeOwner=a,b.mon(a,"move",b.sizeMask,b)),a=b.floatParent.ownerCt,b.rendered&&b.isVisible()&&a&&(b.floatOwner=a,b.mon(a,"afterlayout",b.sizeMask,b,{single:!0}))},onComponentRemoved:function(a){var b=this,c=b.activeOwner,d=b.floatOwner;c&&b.mun(c,"move",b.sizeMask,b),d&&b.mun(d,"afterlayout",b.sizeMask,b),delete b.activeOwner,delete b.floatOwner},afterRender:function(){this.callParent(arguments),this.container=this.floatParent.getContentTarget()},onContainerShow:function(a){this.isActiveContainer(a)&&this.onComponentShow()},onContainerHide:function(a){this.isActiveContainer(a)&&this.onComponentHide()},onContainerExpand:function(a){this.isActiveContainer(a)&&this.onComponentShow()},onContainerCollapse:function(a){this.isActiveContainer(a)&&this.onComponentHide()},isActiveContainer:function(a){return this.isDescendantOf(a)},onComponentHide:function(){var a=this;a.rendered&&a.isVisible()&&(a.hide(),a.showNext=!0)},onComponentShow:function(){this.showNext&&this.show(),delete this.showNext},sizeMask:function(){var a=this,b;a.rendered&&a.isVisible()&&(a.center(),b=a.getMaskTarget(),a.getMaskEl().show().setSize(b.getSize()).alignTo(b,"tl-tl"))},bindStore:function(a,b){var c=this;c.mixins.bindable.bindStore.apply(c,arguments),a=c.store,a&&a.isLoading()&&c.onBeforeLoad()},getStoreListeners:function(){return{beforeload:this.onBeforeLoad,load:this.onLoad,exception:this.onLoad,cachemiss:this.onBeforeLoad,cachefilled:this.onLoad}},onDisable:function(){this.callParent(arguments),this.loading&&this.onLoad()},getOwner:function(){return this.ownerCt||this.floatParent},getMaskTarget:function(){var a=this.getOwner();return this.useTargetEl?a.getTargetEl():a.getEl()},onBeforeLoad:function(){var a=this,b=a.getOwner(),c;a.disabled||(a.loading=!0,b.componentLayoutCounter?a.maybeShow():(c=b.afterComponentLayout,b.afterComponentLayout=function(){b.afterComponentLayout=c,c.apply(b,arguments),a.maybeShow()}))},maybeShow:function(){var a=this,b=a.getOwner();b.isVisible(!0)?a.loading&&b.rendered&&a.show():a.showNext=!0},getMaskEl:function(){var a=this;return a.maskEl||(a.maskEl=a.el.insertSibling({cls:a.maskCls,style:{zIndex:a.el.getStyle("zIndex")-2}},"before"))},onShow:function(){var a=this,b=a.msgEl;a.callParent(arguments),a.loading=!0,a.useMsg?b.show().update(a.msg):b.parent().hide()},hide:function(){if(this.isElement){this.ownerCt.unmask(),this.fireEvent("hide",this);return}return delete this.showNext,this.callParent(arguments)},onHide:function(){this.callParent(),this.getMaskEl().hide()},show:function(){if(this.isElement){this.ownerCt.mask(this.useMsg?this.msg:"",this.msgCls),this.fireEvent("show",this);return}return this.callParent(arguments)},afterShow:function(){this.callParent(arguments),this.sizeMask()},setZIndex:function(a){var b=this;return b.restack&&(a=parseInt(b.activeOwner.el.getStyle("zIndex"),10)+1),b.getMaskEl().setStyle("zIndex",a-1),b.mixins.floating.setZIndex.apply(b,arguments)},onLoad:function(){this.loading=!1,this.hide()},onDestroy:function(){var a=this;a.isElement&&a.ownerCt.unmask(),Ext.destroy(a.maskEl),a.callParent()}}),Ext.define("Ext.view.AbstractView",{extend:"Ext.Component",requires:["Ext.LoadMask","Ext.data.StoreManager","Ext.CompositeElementLite","Ext.DomQuery","Ext.selection.DataViewModel"],mixins:{bindable:"Ext.util.Bindable"},inheritableStatics:{getRecord:function(a){return this.getBoundView(a).getRecord(a)},getBoundView:function(a){return Ext.getCmp(a.boundView)}},deferInitialRefresh:!0,itemCls:Ext.baseCSSPrefix+"dataview-item",loadingText:"Loading...",loadMask:!0,loadingUseMsg:!0,selectedItemCls:Ext.baseCSSPrefix+"item-selected",emptyText:"",deferEmptyText:!0,trackOver:!1,blockRefresh:!1,preserveScrollOnRefresh:!1,last:!1,triggerEvent:"itemclick",triggerCtEvent:"containerclick",addCmpEvents:function(){},initComponent:function(){var a=this,b=Ext.isDefined,c=a.itemTpl,d={};c&&(Ext.isArray(c)?c=c.join(""):Ext.isObject(c)&&(d=Ext.apply(d,c.initialConfig),c=c.html),a.itemSelector||(a.itemSelector="."+a.itemCls),c=Ext.String.format('<tpl for="."><div class="{0}">{1}</div></tpl>',a.itemCls,c),a.tpl=new Ext.XTemplate(c,d)),a.callParent();if(Ext.isString(a.tpl)||Ext.isArray(a.tpl))a.tpl=new Ext.XTemplate(a.tpl);a.addEvents("beforerefresh","refresh","viewready","itemupdate","itemadd","itemremove"),a.addCmpEvents(),a.store=Ext.data.StoreManager.lookup(a.store||"ext-empty-store"),a.bindStore(a.store,!0),a.all=new Ext.CompositeElementLite,a.scrollState={top:0,left:0},a.on({scroll:a.onViewScroll,element:"el",scope:a})},onRender:function(){var a=this,b=a.loadMask,c={msg:a.loadingText,msgCls:a.loadingCls,useMsg:a.loadingUseMsg};a.callParent(arguments),b&&(Ext.isObject(b)&&(c=Ext.apply(c,b)),a.loadMask=new Ext.LoadMask(a,c),a.loadMask.on({scope:a,beforeshow:a.onMaskBeforeShow,hide:a.onMaskHide}))},onBoxReady:function(){var a=this,b=a.store;a.callParent(arguments),a.doFirstRefresh(a.store)},onMaskBeforeShow:function(){var a=this,b=a.loadingHeight;a.getSelectionModel().deselectAll(),a.all.clear(),b&&b>a.getHeight()&&(a.hasLoadingHeight=!0,a.oldMinHeight=a.minHeight,a.minHeight=b,a.updateLayout())},onMaskHide:function(){var a=this;!a.destroying&&a.hasLoadingHeight&&(a.minHeight=a.oldMinHeight,a.updateLayout(),delete a.hasLoadingHeight)},afterRender:function(){this.callParent(arguments),this.getSelectionModel().bindComponent(this)},getSelectionModel:function(){var a=this,b="SINGLE";return a.selModel||(a.selModel={}),a.simpleSelect?b="SIMPLE":a.multiSelect&&(b="MULTI"),Ext.applyIf(a.selModel,{allowDeselect:a.allowDeselect,mode:b}),a.selModel.events||(a.selModel=new Ext.selection.DataViewModel(a.selModel)),a.selModel.hasRelaySetup||(a.relayEvents(a.selModel,["selectionchange","beforeselect","beforedeselect","select","deselect","focuschange"]),a.selModel.hasRelaySetup=!0),a.disableSelection&&(a.selModel.locked=!0),a.selModel},refresh:function(){var a=this,b,c,d,e,f,g;if(!a.rendered||a.isDestroyed)return;if(!a.hasListeners.beforerefresh||a.fireEvent("beforerefresh",a)!==!1)b=a.getTargetEl(),g=a.store.getRange(),f=b.dom,a.preserveScrollOnRefresh||(c=f.parentNode,d=f.style.display,f.style.display="none",e=f.nextSibling,c.removeChild(f)),a.refreshCounter?a.clearViewEl():(a.fixedNodes=b.dom.childNodes.length,a.refreshCounter=1),a.tpl.append(b,a.collectData(g,0)),g.length<1?((!a.deferEmptyText||a.hasSkippedEmptyText)&&Ext.core.DomHelper.insertHtml("beforeEnd",b.dom,a.emptyText),a.all.clear()):(a.all.fill(Ext.query(a.getItemSelector(),b.dom)),a.updateIndexes(0)),a.selModel.refresh(),a.hasSkippedEmptyText=!0,a.preserveScrollOnRefresh||(c.insertBefore(f,e),f.style.display=d),this.refreshSize(),a.fireEvent("refresh",a),a.viewReady||(a.viewReady=!0,a.fireEvent("viewready",a))},refreshSize:function(){var a=this.getSizeModel();(a.height.shrinkWrap||a.width.shrinkWrap)&&this.updateLayout()},clearViewEl:function(){var a=this,b=a.getTargetEl();if(a.fixedNodes)while(b.dom.childNodes[a.fixedNodes])b.dom.removeChild(b.dom.childNodes[a.fixedNodes]);else b.update("");a.refreshCounter++},onViewScroll:Ext.emptyFn,saveScrollState:function(){if(this.rendered){var a=this.el.dom,b=this.scrollState;b.left=a.scrollLeft,b.top=a.scrollTop}},restoreScrollState:function(){if(this.rendered){var a=this.el.dom,b=this.scrollState;a.scrollLeft=b.left,a.scrollTop=b.top}},prepareData:function(a,b,c){var d,e;if(c){d=c.getAssociatedData();for(e in d)d.hasOwnProperty(e)&&(a[e]=d[e])}return a},collectData:function(a,b){var c=[],d=0,e=a.length,f;for(;d<e;d++)f=a[d],c[d]=this.prepareData(f.data,b+d,f);return c},bufferRender:function(a,b){var c=this,d=c.renderBuffer||(c.renderBuffer=document.createElement("div"));return c.tpl.overwrite(d,c.collectData(a,b)),Ext.query(c.getItemSelector(),d)},onUpdate:function(a,b){var c=this,d,e;if(c.rendered){d=c.store.indexOf(b);if(d>-1){e=c.bufferRender([b],d)[0];if(c.getNode(b))return c.all.replaceElement(d,e,!0),c.updateIndexes(d,d),c.selModel.refresh(),c.hasListeners.itemupdate&&c.fireEvent("itemupdate",b,d,e),e}}},onAdd:function(a,b,c){var d=this,e;if(d.rendered){if(d.all.getCount()===0){d.refresh();return}e=d.bufferRender(b,c),d.doAdd(e,b,c),d.selModel.refresh(),d.updateIndexes(c),this.refreshSize(),d.hasListeners.itemadd&&d.fireEvent("itemadd",b,c,e)}},doAdd:function(a,b,c){var d=this.all,e=d.getCount();e===0?(this.clearViewEl(),this.getTargetEl().appendChild(a)):c<e?c===0?d.item(c).insertSibling(a,"before",!0):d.item(c-1).insertSibling(a,"after",!0):d.last().insertSibling(a,"after",!0),Ext.Array.insert(d.elements,c,a)},onRemove:function(a,b,c){var d=this;d.rendered&&(d.store.getCount()===0?d.refresh():(d.doRemove(b,c),d.updateIndexes(c)),this.refreshSize(),d.hasListeners.itemremove&&d.fireEvent("itemremove",b,c))},doRemove:function(a,b){this.all.removeElement(b,!0)},refreshNode:function(a){this.onUpdate(this.store,this.store.getAt(a))},updateIndexes:function(a,b){var c=this.all.elements,d=this.store.getRange(),e;a=a||0,b=b||(b===0?0:c.length-1);for(e=a;e<=b;e++)c[e].viewIndex=e,c[e].viewRecordId=d[e].internalId,c[e].boundView||(c[e].boundView=this.id)},getStore:function(){return this.store},bindStore:function(a,b){var c=this;c.mixins.bindable.bindStore.apply(c,arguments),c.getSelectionModel().bindStore(c.store),c.componentLayoutCounter&&c.doFirstRefresh(a)},doFirstRefresh:function(a){var b=this;a&&!a.loading&&(b.deferInitialRefresh?Ext.Function.defer(function(){b.isDestroyed||b.refresh()},1):b.refresh())},onUnbindStore:function(a){this.setMaskBind(null)},onBindStore:function(a){this.setMaskBind(a)},setMaskBind:function(a){var b=this.loadMask;b&&b.bindStore&&b.bindStore(a)},getStoreListeners:function(){var a=this;return{refresh:a.onDataRefresh,add:a.onAdd,remove:a.onRemove,update:a.onUpdate,clear:a.refresh}},onDataRefresh:function(){this.blockRefresh!==!0&&this.refresh.apply(this,arguments)},findItemByChild:function(a){return Ext.fly(a).findParent(this.getItemSelector(),this.getTargetEl())},findTargetByEvent:function(a){return a.getTarget(this.getItemSelector(),this.getTargetEl())},getSelectedNodes:function(){var a=[],b=this.selModel.getSelection(),c=b.length,d=0;for(;d<c;d++)a.push(this.getNode(b[d]));return a},getRecords:function(a){var b=[],c=0,d=a.length,e=this.store.data;for(;c<d;c++)b[b.length]=e.getByKey(a[c].viewRecordId);return b},getRecord:function(a){return this.store.data.getByKey(Ext.getDom(a).viewRecordId)},isSelected:function(a){var b=this.getRecord(a);return this.selModel.isSelected(b)},select:function(a,b,c){this.selModel.select(a,b,c)},deselect:function(a,b){this.selModel.deselect(a,b)},getNode:function(a){return!a&&a!==0||!this.rendered?null:Ext.isString(a)?document.getElementById(a):Ext.isNumber(a)?this.all.elements[a]:a.isModel?this.getNodeByRecord(a):a},getNodeByRecord:function(a){var b=this.all.elements,c=b.length,d=0;for(;d<c;d++)if(b[d].viewRecordId===a.internalId)return b[d];return null},getNodes:function(a,b){var c=this.all.elements,d=[],e;a=a||0,b=Ext.isDefined(b)?b:Math.max(c.length-1,0);if(a<=b)for(e=a;e<=b&&c[e];e++)d.push(c[e]);else for(e=a;e>=b&&c[e];e--)d.push(c[e]);return d},indexOf:function(a){return a=this.getNode(a),Ext.isNumber(a.viewIndex)?a.viewIndex:this.all.indexOf(a)},onDestroy:function(){var a=this;a.all.clear(),a.callParent(),a.bindStore(null),a.selModel.destroy()},onItemSelect:function(a){var b=this.getNode(a);b&&Ext.fly(b).addCls(this.selectedItemCls)},onItemDeselect:function(a){var b=this.getNode(a);b&&Ext.fly(b).removeCls(this.selectedItemCls)},getItemSelector:function(){return this.itemSelector}},function(){Ext.deprecate("extjs","4.0",function(){Ext.view.AbstractView.override({getSelectionCount:function(){return Ext.global.console&&Ext.global.console.warn("DataView: getSelectionCount will be removed, please interact with the Ext.selection.DataViewModel"),this.selModel.getSelection().length},getSelectedRecords:function(){return Ext.global.console&&Ext.global.console.warn("DataView: getSelectedRecords will be removed, please interact with the Ext.selection.DataViewModel"),this.selModel.getSelection()},select:function(a,b,c){Ext.global.console&&Ext.global.console.warn("DataView: select will be removed, please access select through a DataView's SelectionModel, ie: view.getSelectionModel().select()");var d=this.getSelectionModel();return d.select.apply(d,arguments)},clearSelections:function(){Ext.global.console&&Ext.global.console.warn("DataView: clearSelections will be removed, please access deselectAll through DataView's SelectionModel, ie: view.getSelectionModel().deselectAll()");var a=this.getSelectionModel();return a.deselectAll()}})})}),Ext.define("Ext.Shadow",{requires:["Ext.ShadowPool"],constructor:function(a){var b=this,c,d,e;Ext.apply(b,a),Ext.isString(b.mode)||(b.mode=b.defaultMode),d=b.offset,e=Math.floor(d/2),b.opacity=50;switch(b.mode.toLowerCase()){case"drop":Ext.supports.CSS3BoxShadow?c={t:d,l:d,h:-d,w:-d}:c={t:-e,l:-e,h:-e,w:-e};break;case"sides":Ext.supports.CSS3BoxShadow?c={t:d,l:0,h:-d,w:0}:c={t:-(1+e),l:1+e-2*d,h:-1,w:e-1};break;case"frame":Ext.supports.CSS3BoxShadow?c={t:0,l:0,h:0,w:0}:c={t:1+e-2*d,l:1+e-2*d,h:d-e-1,w:d-e-1}}b.adjusts=c},offset:4,defaultMode:"drop",boxShadowProperty:function(){var a="boxShadow",b=document.documentElement.style;return"boxShadow"in b||("WebkitBoxShadow"in b?a="WebkitBoxShadow":"MozBoxShadow"in b&&(a="MozBoxShadow")),a}(),show:function(a){var b=this,c;a=Ext.get(a),b.el||(b.el=Ext.ShadowPool.pull(),b.el.dom.nextSibling!=a.dom&&b.el.insertBefore(a)),c=parseInt(a.getStyle("z-index"),10)-1||0,b.el.setStyle("z-index",b.zIndex||c),Ext.isIE&&!Ext.supports.CSS3BoxShadow&&(b.el.dom.style.filter="progid:DXImageTransform.Microsoft.alpha(opacity="+b.opacity+") progid:DXImageTransform.Microsoft.Blur(pixelradius="+b.offset+")"),b.realign(a.getLeft(!0),a.getTop(!0),a.dom.offsetWidth,a.dom.offsetHeight),b.el.dom.style.display="block"},isVisible:function(){return this.el?!0:!1},realign:function(a,b,c,d){if(!this.el)return;var e=this.adjusts,f=this.el.dom,g=f.style,h,i,j,k;g.left=a+e.l+"px",g.top=b+e.t+"px",h=Math.max(c+e.w,0),i=Math.max(d+e.h,0),j=h+"px",k=i+"px";if(g.width!=j||g.height!=k)g.width=j,g.height=k,Ext.supports.CSS3BoxShadow&&(g[this.boxShadowProperty]="0 0 "+this.offset+"px #888")},hide:function(){var a=this;a.el&&(a.el.dom.style.display="none",Ext.ShadowPool.push(a.el),delete a.el)},setZIndex:function(a){this.zIndex=a,this.el&&this.el.setStyle("z-index",a)},setOpacity:function(a){this.el&&(Ext.isIE&&!Ext.supports.CSS3BoxShadow&&(a=Math.floor(a*100/2)/100),this.opacity=a,this.el.setOpacity(a))}}),Ext.define("Ext.dd.DragDrop",{requires:["Ext.dd.DragDropManager"],constructor:function(a,b,c){a&&this.init(a,b,c)},id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:!1,lock:function(){this.locked=!0},moveOnly:!1,unlock:function(){this.locked=!1},isTarget:!0,padding:null,_domRef:null,__ygDragDrop:!0,constrainX:!1,constrainY:!1,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:!1,xTicks:null,yTicks:null,primaryButtonOnly:!0,available:!1,hasOuterHandles:!1,b4StartDrag:function(a,b){},startDrag:function(a,b){},b4Drag:function(a){},onDrag:function(a){},onDragEnter:function(a,b){},b4DragOver:function(a){},onDragOver:function(a,b){},b4DragOut:function(a){},onDragOut:function(a,b){},b4DragDrop:function(a){},onDragDrop:function(a,b){},onInvalidDrop:function(a){},b4EndDrag:function(a){},endDrag:function(a){},b4MouseDown:function(a){},onMouseDown:function(a){},onMouseUp:function(a){},onAvailable:function(){},defaultPadding:{left:0,right:0,top:0,bottom:0},constrainTo:function(a,b,c){Ext.isNumber(b)&&(b={left:b,right:b,top:b,bottom:b}),b=b||this.defaultPadding;var d=Ext.get(this.getEl()).getBox(),e=Ext.get(a),f=e.getScroll(),g,h=e.dom,i,j,k;h==document.body?g={x:f.left,y:f.top,width:Ext.Element.getViewWidth(),height:Ext.Element.getViewHeight()}:(i=e.getXY(),g={x:i[0],y:i[1],width:h.clientWidth,height:h.clientHeight}),j=d.y-g.y,k=d.x-g.x,this.resetConstraints(),this.setXConstraint(k-(b.left||0),g.width-k-d.width-(b.right||0),this.xTickSize),this.setYConstraint(j-(b.top||0),g.height-j-d.height-(b.bottom||0),this.yTickSize)},getEl:function(){return this._domRef||(this._domRef=Ext.getDom(this.id)),this._domRef},getDragEl:function(){return Ext.getDom(this.dragElId)},init:function(a,b,c){this.initTarget(a,b,c),Ext.EventManager.on(this.id,"mousedown",this.handleMouseDown,this)},initTarget:function(a,b,c){this.config=c||{},this.DDMInstance=Ext.dd.DragDropManager,this.groups={},typeof a!="string"&&(a=Ext.id(a)),this.id=a,this.addToGroup(b?b:"default"),this.handleElId=a,this.setDragElId(a),this.invalidHandleTypes={A:"A"},this.invalidHandleIds={},this.invalidHandleClasses=[],this.applyConfig(),this.handleOnAvailable()},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0],this.isTarget=this.config.isTarget!==!1,this.maintainOffset=this.config.maintainOffset,this.primaryButtonOnly=this.config.primaryButtonOnly!==!1},handleOnAvailable:function(){this.available=!0,this.resetConstraints(),this.onAvailable()},setPadding:function(a,b,c,d){!b&&0!==b?this.padding=[a,a,a,a]:!c&&0!==c?this.padding=[a,b,a,b]:this.padding=[a,b,c,d]},setInitPosition:function(a,b){var c=this.getEl(),d,e,f;if(!this.DDMInstance.verifyEl(c))return;d=a||0,e=b||0,f=Ext.Element.getXY(c),this.initPageX=f[0]-d,this.initPageY=f[1]-e,this.lastPageX=f[0],this.lastPageY=f[1],this.setStartPosition(f)},setStartPosition:function(a){var b=a||Ext.Element.getXY(this.getEl());this.deltaSetXY=null,this.startPageX=b[0],this.startPageY=b[1]},addToGroup:function(a){this.groups[a]=!0,this.DDMInstance.regDragDrop(this,a)},removeFromGroup:function(a){this.groups[a]&&delete this.groups[a],this.DDMInstance.removeDDFromGroup(this,a)},setDragElId:function(a){this.dragElId=a},setHandleElId:function(a){typeof a!="string"&&(a=Ext.id(a)),this.handleElId=a,this.DDMInstance.regHandle(this.id,a)},setOuterHandleElId:function(a){typeof a!="string"&&(a=Ext.id(a)),Ext.EventManager.on(a,"mousedown",this.handleMouseDown,this),this.setHandleElId(a),this.hasOuterHandles=!0},unreg:function(){Ext.EventManager.un(this.id,"mousedown",this.handleMouseDown,this),this._domRef=null,this.DDMInstance._remove(this)},destroy:function(){this.unreg()},isLocked:function(){return this.DDMInstance.isLocked()||this.locked},handleMouseDown:function(a,b){if(this.primaryButtonOnly&&a.button!=0)return;if(this.isLocked())return;this.DDMInstance.refreshCache(this.groups),(this.hasOuterHandles||this.DDMInstance.isOverTarget(a.getPoint(),this))&&this.clickValidator(a)&&(this.setStartPosition(),this.b4MouseDown(a),this.onMouseDown(a),this.DDMInstance.handleMouseDown(a,this),this.DDMInstance.stopEvent(a))},clickValidator:function(a){var b=a.getTarget();return this.isValidHandleChild(b)&&(this.id==this.handleElId||this.DDMInstance.handleWasClicked(b,this.id))},addInvalidHandleType:function(a){var b=a.toUpperCase();this.invalidHandleTypes[b]=b},addInvalidHandleId:function(a){typeof a!="string"&&(a=Ext.id(a)),this.invalidHandleIds[a]=a},addInvalidHandleClass:function(a){this.invalidHandleClasses.push(a)},removeInvalidHandleType:function(a){var b=a.toUpperCase();delete this.invalidHandleTypes[b]},removeInvalidHandleId:function(a){typeof a!="string"&&(a=Ext.id(a)),delete this.invalidHandleIds[a]},removeInvalidHandleClass:function(a){for(var b=0,c=this.invalidHandleClasses.length;b<c;++b)this.invalidHandleClasses[b]==a&&delete this.invalidHandleClasses[b]},isValidHandleChild:function(a){var b=!0,c,d,e;try{c=a.nodeName.toUpperCase()}catch(f){c=a.nodeName}b=b&&!this.invalidHandleTypes[c],b=b&&!this.invalidHandleIds[a.id];for(d=0,e=this.invalidHandleClasses.length;b&&d<e;++d)b=!Ext.fly(a).hasCls(this.invalidHandleClasses[d]);return b},setXTicks:function(a,b){this.xTicks=[],this.xTickSize=b;var c={},d;for(d=this.initPageX;d>=this.minX;d-=b)c[d]||(this.xTicks[this.xTicks.length]=d,c[d]=!0);for(d=this.initPageX;d<=this.maxX;d+=b)c[d]||(this.xTicks[this.xTicks.length]=d,c[d]=!0);Ext.Array.sort(this.xTicks,this.DDMInstance.numericSort)},setYTicks:function(a,b){this.yTicks=[],this.yTickSize=b;var c={},d;for(d=this.initPageY;d>=this.minY;d-=b)c[d]||(this.yTicks[this.yTicks.length]=d,c[d]=!0);for(d=this.initPageY;d<=this.maxY;d+=b)c[d]||(this.yTicks[this.yTicks.length]=d,c[d]=!0);Ext.Array.sort(this.yTicks,this.DDMInstance.numericSort)},setXConstraint:function(a,b,c){this.leftConstraint=a,this.rightConstraint=b,this.minX=this.initPageX-a,this.maxX=this.initPageX+b,c&&this.setXTicks(this.initPageX,c),this.constrainX=!0},clearConstraints:function(){this.constrainX=!1,this.constrainY=!1,this.clearTicks()},clearTicks:function(){this.xTicks=null,this.yTicks=null,this.xTickSize=0,this.yTickSize=0},setYConstraint:function(a,b,c){this.topConstraint=a,this.bottomConstraint=b,this.minY=this.initPageY-a,this.maxY=this.initPageY+b,c&&this.setYTicks(this.initPageY,c),this.constrainY=!0},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var a=this.maintainOffset?this.lastPageX-this.initPageX:0,b=this.maintainOffset?this.lastPageY-this.initPageY:0;this.setInitPosition(a,b)}else this.setInitPosition();this.constrainX&&this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize),this.constrainY&&this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize)},getTick:function(a,b){if(!b)return a;if(b[0]>=a)return b[0];var c,d,e,f,g;for(c=0,d=b.length;c<d;++c){e=c+1;if(b[e]&&b[e]>=a)return f=a-b[c],g=b[e]-a,g>f?b[c]:b[e]}return b[b.length-1]},toString:function(){return"DragDrop "+this.id}}),Ext.define("Ext.dd.DD",{extend:"Ext.dd.DragDrop",requires:["Ext.dd.DragDropManager"],constructor:function(a,b,c){a&&this.init(a,b,c)},scroll:!0,autoOffset:function(a,b){var c=a-this.startPageX,d=b-this.startPageY;this.setDelta(c,d)},setDelta:function(a,b){this.deltaX=a,this.deltaY=b},setDragElPos:function(a,b){var c=this.getDragEl();this.alignElWithMouse(c,a,b)},alignElWithMouse:function(a,b,c){var d=this.getTargetCoord(b,c),e=a.dom?a:Ext.fly(a,"_dd"),f=e.getSize(),g=Ext.Element,h,i,j,k;return this.deltaSetXY?(h=this.cachedViewportSize,e.setLeftTop(Math.max(0,Math.min(d.x+this.deltaSetXY[0],h.width-f.width)),Math.max(0,Math.min(d.y+this.deltaSetXY[1],h.height-f.height)))):(h=this.cachedViewportSize={width:g.getDocumentWidth(),height:g.getDocumentHeight()},i=[Math.max(0,Math.min(d.x,h.width-f.width)),Math.max(0,Math.min(d.y,h.height-f.height))],e.setXY(i),j=e.getLeft(!0),k=e.getTop(!0),this.deltaSetXY=[j-d.x,k-d.y]),this.cachePosition(d.x,d.y),this.autoScroll(d.x,d.y,a.offsetHeight,a.offsetWidth),d},cachePosition:function(a,b){if(a)this.lastPageX=a,this.lastPageY=b;else{var c=Ext.Element.getXY(this.getEl());this.lastPageX=c[0],this.lastPageY=c[1]}},autoScroll:function(a,b,c,d){if(this.scroll){var e=Ext.Element.getViewHeight(),f=Ext.Element.getViewWidth(),g=this.DDMInstance.getScrollTop(),h=this.DDMInstance.getScrollLeft(),i=c+b,j=d+a,k=e+g-b-this.deltaY,l=f+h-a-this.deltaX,m=40,n=document.all?80:30;i>e&&k<m&&window.scrollTo(h,g+n),b<g&&g>0&&b-g<m&&window.scrollTo(h,g-n),j>f&&l<m&&window.scrollTo(h+n,g),a<h&&h>0&&a-h<m&&window.scrollTo(h-n,g)}},getTargetCoord:function(a,b){var c=a-this.deltaX,d=b-this.deltaY;return this.constrainX&&(c<this.minX&&(c=this.minX),c>this.maxX&&(c=this.maxX)),this.constrainY&&(d<this.minY&&(d=this.minY),d>this.maxY&&(d=this.maxY)),c=this.getTick(c,this.xTicks),d=this.getTick(d,this.yTicks),{x:c,y:d}},applyConfig:function(){this.callParent(),this.scroll=this.config.scroll!==!1},b4MouseDown:function(a){this.autoOffset(a.getPageX(),a.getPageY())},b4Drag:function(a){this.setDragElPos(a.getPageX(),a.getPageY())},toString:function(){return"DD "+this.id}}),Ext.define("Ext.dd.DDProxy",{extend:"Ext.dd.DD",statics:{dragElId:"ygddfdiv"},constructor:function(a,b,c){a&&(this.init(a,b,c),this.initFrame())},resizeFrame:!0,centerFrame:!1,createFrame:function(){var a=this,b=document.body,c,d;if(!b||!b.firstChild){setTimeout(function(){a.createFrame()},50);return}c=this.getDragEl(),c||(c=document.createElement("div"),c.id=this.dragElId,d=c.style,d.position="absolute",d.visibility="hidden",d.cursor="move",d.border="2px solid #aaa",d.zIndex=999,b.insertBefore(c,b.firstChild))},initFrame:function(){this.createFrame()},applyConfig:function(){this.callParent(),this.resizeFrame=this.config.resizeFrame!==!1,this.centerFrame=this.config.centerFrame,this.setDragElId(this.config.dragElId||Ext.dd.DDProxy.dragElId)},showFrame:function(a,b){var c=this.getEl(),d=this.getDragEl(),e=d.style;this._resizeProxy(),this.centerFrame&&this.setDelta(Math.round(parseInt(e.width,10)/2),Math.round(parseInt(e.height,10)/2)),this.setDragElPos(a,b),Ext.fly(d).show()},_resizeProxy:function(){if(this.resizeFrame){var a=this.getEl();Ext.fly(this.getDragEl()).setSize(a.offsetWidth,a.offsetHeight)}},b4MouseDown:function(a){var b=a.getPageX(),c=a.getPageY();this.autoOffset(b,c),this.setDragElPos(b,c)},b4StartDrag:function(a,b){this.showFrame(a,b)},b4EndDrag:function(a){Ext.fly(this.getDragEl()).hide()},endDrag:function(a){var b=this.getEl(),c=this.getDragEl();c.style.visibility="",this.beforeMove(),b.style.visibility="hidden",Ext.dd.DDM.moveToEl(b,c),c.style.visibility="hidden",b.style.visibility="",this.afterDrag()},beforeMove:function(){},afterDrag:function(){},toString:function(){return"DDProxy "+this.id}}),Ext.define("Ext.dd.DDTarget",{extend:"Ext.dd.DragDrop",constructor:function(a,b,c){a&&this.initTarget(a,b,c)},getDragEl:Ext.emptyFn,isValidHandleChild:Ext.emptyFn,startDrag:Ext.emptyFn,endDrag:Ext.emptyFn,onDrag:Ext.emptyFn,onDragDrop:Ext.emptyFn,onDragEnter:Ext.emptyFn,onDragOut:Ext.emptyFn,onDragOver:Ext.emptyFn,onInvalidDrop:Ext.emptyFn,onMouseDown:Ext.emptyFn,onMouseUp:Ext.emptyFn,setXConstraint:Ext.emptyFn,setYConstraint:Ext.emptyFn,resetConstraints:Ext.emptyFn,clearConstraints:Ext.emptyFn,clearTicks:Ext.emptyFn,setInitPosition:Ext.emptyFn,setDragElId:Ext.emptyFn,setHandleElId:Ext.emptyFn,setOuterHandleElId:Ext.emptyFn,addInvalidHandleClass:Ext.emptyFn,addInvalidHandleId:Ext.emptyFn,addInvalidHandleType:Ext.emptyFn,removeInvalidHandleClass:Ext.emptyFn,removeInvalidHandleId:Ext.emptyFn,removeInvalidHandleType:Ext.emptyFn,toString:function(){return"DDTarget "+this.id}}),Ext.define("Ext.dd.DropTarget",{extend:"Ext.dd.DDTarget",requires:["Ext.dd.ScrollManager"],constructor:function(a,b){this.el=Ext.get(a),Ext.apply(this,b),this.containerScroll&&Ext.dd.ScrollManager.register(this.el),this.callParent([this.el.dom,this.ddGroup||this.group,{isTarget:!0}])},dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",isTarget:!0,isNotifyTarget:!0,notifyEnter:function(a,b,c){return this.overClass&&this.el.addCls(this.overClass),this.dropAllowed},notifyOver:function(a,b,c){return this.dropAllowed},notifyOut:function(a,b,c){this.overClass&&this.el.removeCls(this.overClass)},notifyDrop:function(a,b,c){return!1},destroy:function(){this.callParent(),this.containerScroll&&Ext.dd.ScrollManager.unregister(this.el)}}),Ext.define("Ext.dd.DropZone",{extend:"Ext.dd.DropTarget",requires:["Ext.dd.Registry"],getTargetFromEvent:function(a){return Ext.dd.Registry.getTargetFromEvent(a)},onNodeEnter:function(a,b,c,d){},onNodeOver:function(a,b,c,d){return this.dropAllowed},onNodeOut:function(a,b,c,d){},onNodeDrop:function(a,b,c,d){return!1},onContainerOver:function(a,b,c){return this.dropNotAllowed},onContainerDrop:function(a,b,c){return!1},notifyEnter:function(a,b,c){return this.dropNotAllowed},notifyOver:function(a,b,c){var d=this.getTargetFromEvent(b);return d?(this.lastOverNode!=d&&(this.lastOverNode&&this.onNodeOut(this.lastOverNode,a,b,c),this.onNodeEnter(d,a,b,c),this.lastOverNode=d),this.onNodeOver(d,a,b,c)):(this.lastOverNode&&(this.onNodeOut(this.lastOverNode,a,b,c),this.lastOverNode=null),this.onContainerOver(a,b,c))},notifyOut:function(a,b,c){this.lastOverNode&&(this.onNodeOut(this.lastOverNode,a,b,c),this.lastOverNode=null)},notifyDrop:function(a,b,c){this.lastOverNode&&(this.onNodeOut(this.lastOverNode,a,b,c),this.lastOverNode=null);var d=this.getTargetFromEvent(b);return d?this.onNodeDrop(d,a,b,c):this.onContainerDrop(a,b,c)},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)}}),Ext.define("Ext.dd.StatusProxy",{extend:"Ext.Component",animRepair:!1,childEls:["ghost"],renderTpl:['<div class="'+Ext.baseCSSPrefix+'dd-drop-icon"></div><div id="{id}-ghost" class="'+Ext.baseCSSPrefix+'dd-drag-ghost"></div>'],constructor:function(a){var b=this;a=a||{},Ext.apply(b,{hideMode:"visibility",hidden:!0,floating:!0,id:b.id||Ext.id(),cls:Ext.baseCSSPrefix+"dd-drag-proxy "+this.dropNotAllowed,shadow:a.shadow||!1,renderTo:Ext.getDetachedBody()}),b.callParent(arguments),this.dropStatus=this.dropNotAllowed},dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",setStatus:function(a){a=a||this.dropNotAllowed,this.dropStatus!=a&&(this.el.replaceCls(this.dropStatus,a),this.dropStatus=a)},reset:function(a){var b=this,c=Ext.baseCSSPrefix+"dd-drag-proxy ";b.el.replaceCls(c+b.dropAllowed,c+b.dropNotAllowed),b.dropStatus=b.dropNotAllowed,a&&b.ghost.update("")},update:function(a){typeof a=="string"?this.ghost.update(a):(this.ghost.update(""),a.style.margin="0",this.ghost.dom.appendChild(a));var b=this.ghost.dom.firstChild;b&&Ext.fly(b).setStyle("float","none")},getGhost:function(){return this.ghost},hide:function(a){this.callParent(),a&&this.reset(!0)},stop:function(){this.anim&&this.anim.isAnimated&&this.anim.isAnimated()&&this.anim.stop()},sync:function(){this.el.sync()},repair:function(a,b,c){var d=this;d.callback=b,d.scope=c,a&&d.animRepair!==!1?(d.el.addCls(Ext.baseCSSPrefix+"dd-drag-repair"),d.el.hideUnders(!0),d.anim=d.el.animate({duration:d.repairDuration||500,easing:"ease-out",to:{x:a[0],y:a[1]},stopAnimation:!0,callback:d.afterRepair,scope:d})):d.afterRepair()},afterRepair:function(){var a=this;a.hide(!0),a.el.removeCls(Ext.baseCSSPrefix+"dd-drag-repair"),typeof a.callback=="function"&&a.callback.call(a.scope||a),delete a.callback,delete a.scope}}),Ext.define("Ext.dd.DragSource",{extend:"Ext.dd.DDProxy",requires:["Ext.dd.StatusProxy","Ext.dd.DragDropManager"],dropAllowed:Ext.baseCSSPrefix+"dd-drop-ok",dropNotAllowed:Ext.baseCSSPrefix+"dd-drop-nodrop",animRepair:!0,repairHighlightColor:"c3daf9",constructor:function(a,b){this.el=Ext.get(a),this.dragData||(this.dragData={}),Ext.apply(this,b),this.proxy||(this.proxy=new Ext.dd.StatusProxy({id:this.el.id+"-drag-status-proxy",animRepair:this.animRepair})),this.callParent([this.el.dom,this.ddGroup||this.group,{dragElId:this.proxy.id,resizeFrame:!1,isTarget:!1,scroll:this.scroll===!0}]),this.dragging=!1},getDragData:function(a){return this.dragData},onDragEnter:function(a,b){var c=Ext.dd.DragDropManager.getDDById(b),d;this.cachedTarget=c,this.beforeDragEnter(c,a,b)!==!1&&(c.isNotifyTarget?(d=c.notifyEnter(this,a,this.dragData),this.proxy.setStatus(d)):this.proxy.setStatus(this.dropAllowed),this.afterDragEnter&&this.afterDragEnter(c,a,b))},beforeDragEnter:function(a,b,c){return!0},onDragOver:function(a,b){var c=this.cachedTarget||Ext.dd.DragDropManager.getDDById(b),d;this.beforeDragOver(c,a,b)!==!1&&(c.isNotifyTarget&&(d=c.notifyOver(this,a,this.dragData),this.proxy.setStatus(d)),this.afterDragOver&&this.afterDragOver(c,a,b))},beforeDragOver:function(a,b,c){return!0},onDragOut:function(a,b){var c=this.cachedTarget||Ext.dd.DragDropManager.getDDById(b);this.beforeDragOut(c,a,b)!==!1&&(c.isNotifyTarget&&c.notifyOut(this,a,this.dragData),this.proxy.reset(),this.afterDragOut&&this.afterDragOut(c,a,b)),this.cachedTarget=null},beforeDragOut:function(a,b,c){return!0},onDragDrop:function(a,b){var c=this.cachedTarget||Ext.dd.DragDropManager.getDDById(b);this.beforeDragDrop(c,a,b)!==!1&&(c.isNotifyTarget?c.notifyDrop(this,a,this.dragData)!==!1?this.onValidDrop(c,a,b):this.onInvalidDrop(c,a,b):this.onValidDrop(c,a,b),this.afterDragDrop&&this.afterDragDrop(c,a,b)),delete this.cachedTarget},beforeDragDrop:function(a,b,c){return!0},onValidDrop:function(a,b,c){this.hideProxy(),this.afterValidDrop&&this.afterValidDrop(a,b,c)},getRepairXY:function(a,b){return this.el.getXY()},onInvalidDrop:function(a,b,c){this.beforeInvalidDrop(a,b,c),this.cachedTarget&&(this.cachedTarget.isNotifyTarget&&this.cachedTarget.notifyOut(this,b,this.dragData),this.cacheTarget=null),this.proxy.repair(this.getRepairXY(b,this.dragData),this.afterRepair,this),this.afterInvalidDrop&&this.afterInvalidDrop(b,c)},afterRepair:function(){var a=this;Ext.enableFx&&a.el.highlight(a.repairHighlightColor),a.dragging=!1},beforeInvalidDrop:function(a,b,c){return!0},handleMouseDown:function(a){if(this.dragging)return;var b=this.getDragData(a);b&&this.onBeforeDrag(b,a)!==!1&&(this.dragData=b,this.proxy.stop(),this.callParent(arguments))},onBeforeDrag:function(a,b){return!0},onStartDrag:Ext.emptyFn,alignElWithMouse:function(){return this.proxy.ensureAttachedToBody(!0),this.callParent(arguments)},startDrag:function(a,b){this.proxy.reset(),this.proxy.hidden=!1,this.dragging=!0,this.proxy.update(""),this.onInitDrag(a,b),this.proxy.show()},onInitDrag:function(a,b){var c=this.el.dom.cloneNode(!0);return c.id=Ext.id(),this.proxy.update(c),this.onStartDrag(a,b),!0},getProxy:function(){return this.proxy},hideProxy:function(){this.proxy.hide(),this.proxy.reset(!0),this.dragging=!1},triggerCacheRefresh:function(){Ext.dd.DDM.refreshCache(this.groups)},b4EndDrag:function(a){},endDrag:function(a){this.onEndDrag(this.dragData,a)},onEndDrag:function(a,b){},autoOffset:function(a,b){this.setDelta(-12,-20)},destroy:function(){this.callParent(),Ext.destroy(this.proxy)}}),Ext.define("Ext.draw.SpriteDD",{extend:"Ext.dd.DragSource",constructor:function(a,b){var c=this,d=a.el;c.sprite=a,c.el=d,c.dragData={el:d,sprite:a},c.callParent([d,b]),c.sprite.setStyle("cursor","move")},showFrame:Ext.emptyFn,createFrame:Ext.emptyFn,getDragEl:function(a){return this.el},getRegion:function(){var a=this,b=a.el,c,d,e,f,g,h,i,j,k,l,m;m=a.sprite,l=m.getBBox();try{c=Ext.Element.getXY(b)}catch(n){}return c?(d=c[0],e=d+l.width,f=c[1],g=f+l.height,new Ext.util.Region(f,e,g,d)):null},startDrag:function(a,b){var c=this,d=c.sprite.attr;c.prev=c.sprite.surface.transformToViewBox(a,b)},onDrag:function(a){var b=a.getXY(),c=this,d=c.sprite,e=d.attr,f,g;b=c.sprite.surface.transformToViewBox(b[0],b[1]),f=b[0]-c.prev[0],g=b[1]-c.prev[1],d.setAttributes({translate:{x:e.translation.x+f,y:e.translation.y+g}},!0),c.prev=b},setDragElPos:function(){return!1}}),Ext.define("Ext.draw.Sprite",{mixins:{observable:"Ext.util.Observable",animate:"Ext.util.Animate"},requires:["Ext.draw.SpriteDD"],dirty:!1,dirtyHidden:!1,dirtyTransform:!1,dirtyPath:!0,dirtyFont:!0,zIndexDirty:!0,isSprite:!0,zIndex:0,fontProperties:["font","font-size","font-weight","font-style","font-family","text-anchor","text"],pathProperties:["x","y","d","path","height","width","radius","r","rx","ry","cx","cy"],constructor:function(a){var b=this;a=Ext.merge({},a||{}),b.id=Ext.id(null,"ext-sprite-"),b.transformations=[],Ext.copyTo(this,a,"surface,group,type,draggable"),b.bbox={},b.attr={zIndex:0,translation:{x:null,y:null},rotation:{degrees:null,x:null,y:null},scaling:{x:null,y:null,cx:null,cy:null}},delete a.surface,delete a.group,delete a.type,delete a.draggable,b.setAttributes(a),b.addEvents("beforedestroy","destroy","render","mousedown","mouseup","mouseover","mouseout","mousemove","click"),b.mixins.observable.constructor.apply(this,arguments)},initDraggable:function(){var a=this;a.draggable=!0,a.el||a.surface.createSpriteElement(a),a.dd=new Ext.draw.SpriteDD(a,Ext.isBoolean(a.draggable)?null:a.draggable),a.on("beforedestroy",a.dd.destroy,a.dd)},setAttributes:function(a,b){var c=this,d=c.fontProperties,e=d.length,f=c.pathProperties,g=f.length,h=!!c.surface,i=h&&c.surface.customAttributes||{},j=c.attr,k=!1,l,m,n,o,p,q,r,s;a=Ext.apply({},a);for(l in i)a.hasOwnProperty(l)&&typeof i[l]=="function"&&Ext.apply(a,i[l].apply(c,[].concat(a[l])));!!a.hidden!=!!j.hidden&&(c.dirtyHidden=!0);for(m=0;m<g;m++){l=f[m];if(l in a&&a[l]!==j[l]){c.dirtyPath=!0,k=!0;break}}"zIndex"in a&&(c.zIndexDirty=!0),"text"in a&&(c.dirtyFont=!0,k=!0);for(m=0;m<e;m++){l=d[m];if(l in a&&a[l]!==j[l]){c.dirtyFont=!0,k=!0;break}}return n=a.translation||a.translate,delete a.translate,delete a.translation,o=j.translation,n&&("x"in n&&n.x!==o.x||"y"in n&&n.y!==o.y)&&(c.dirtyTransform=!0,o.x=n.x,o.y=n.y),p=a.rotation||a.rotate,q=j.rotation,delete a.rotate,delete a.rotation,p&&("x"in p&&p.x!==q.x||"y"in p&&p.y!==q.y||"degrees"in p&&p.degrees!==q.degrees)&&(c.dirtyTransform=!0,q.x=p.x,q.y=p.y,q.degrees=p.degrees),r=a.scaling||a.scale,s=j.scaling,delete a.scale,delete a.scaling,r&&("x"in r&&r.x!==s.x||"y"in r&&r.y!==s.y||"cx"in r&&r.cx!==s.cx||"cy"in r&&r.cy!==s.cy)&&(c.dirtyTransform=!0,s.x=r.x,s.y=r.y,s.cx=r.cx,s.cy=r.cy),!c.dirtyTransform&&k&&(j.scaling.x===null||j.scaling.y===null||j.rotation.y===null||j.rotation.y===null)&&(c.dirtyTransform=!0),Ext.apply(j,a),c.dirty=!0,b===!0&&h&&c.redraw(),this},getBBox:function(){return this.surface.getBBox(this)},setText:function(a){return this.surface.setText(this,a)},hide:function(a){return this.setAttributes({hidden:!0},a),this},show:function(a){return this.setAttributes({hidden:!1},a),this},remove:function(){return this.surface?(this.surface.remove(this),!0):!1},onRemove:function(){this.surface.onRemove(this)},destroy:function(){var a=this;a.fireEvent("beforedestroy",a)!==!1&&(a.remove(),a.surface.onDestroy(a),a.clearListeners(),a.fireEvent("destroy"))},redraw:function(){return this.surface.renderItem(this),this},setStyle:function(){return this.el.setStyle.apply(this.el,arguments),this},addCls:function(a){return this.surface.addCls(this,a),this},removeCls:function(a){return this.surface.removeCls(this,a),this}}),Ext.define("Ext.draw.engine.Svg",{extend:"Ext.draw.Surface",requires:["Ext.draw.Draw","Ext.draw.Sprite","Ext.draw.Matrix","Ext.Element"],engine:"Svg",trimRe:/^\s+|\s+$/g,spacesRe:/\s+/,xlink:"http://www.w3.org/1999/xlink",translateAttrs:{radius:"r",radiusX:"rx",radiusY:"ry",path:"d",lineWidth:"stroke-width",fillOpacity:"fill-opacity",strokeOpacity:"stroke-opacity",strokeLinejoin:"stroke-linejoin"},parsers:{},minDefaults:{circle:{cx:0,cy:0,r:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},ellipse:{cx:0,cy:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},rect:{x:0,y:0,width:0,height:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},text:{x:0,y:0,"text-anchor":"start","font-family":null,"font-size":null,"font-weight":null,"font-style":null,fill:"#000",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},path:{d:"M0,0",fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},image:{x:0,y:0,width:0,height:0,preserveAspectRatio:"none",opacity:null}},createSvgElement:function(a,b){var c=this.domRef.createElementNS("http://www.w3.org/2000/svg",a),d;if(b)for(d in b)c.setAttribute(d,String(b[d]));return c},createSpriteElement:function(a){var b=this.createSvgElement(a.type);return b.id=a.id,b.style&&(b.style.webkitTapHighlightColor="rgba(0,0,0,0)"),a.el=Ext.get(b),this.applyZIndex(a),a.matrix=new Ext.draw.Matrix,a.bbox={plain:0,transform:0},this.applyAttrs(a),this.applyTransformations(a),a.fireEvent("render",a),b},getBBoxText:function(a){var b={},c,d,e,f,g,h;if(a&&a.el){h=a.el.dom;try{return b=h.getBBox(),b}catch(i){}b={x:b.x,y:Infinity,width:0,height:0},g=h.getNumberOfChars();for(f=0;f<g;f++)c=h.getExtentOfChar(f),b.y=Math.min(c.y,b.y),d=c.y+c.height-b.y,b.height=Math.max(b.height,d),e=c.x+c.width-b.x,b.width=Math.max(b.width,e);return b}},hide:function(){Ext.get(this.el).hide()},show:function(){Ext.get(this.el).show()},hidePrim:function(a){this.addCls(a,Ext.baseCSSPrefix+"hide-visibility")},showPrim:function(a){this.removeCls(a,Ext.baseCSSPrefix+"hide-visibility")},getDefs:function(){return this._defs||(this._defs=this.createSvgElement("defs"))},transform:function(a,b){var c=this,d=new Ext.draw.Matrix,e=a.transformations,f=e.length,g=0,h,i;for(;g<f;g++)h=e[g],i=h.type,i=="translate"?d.translate(h.x,h.y):i=="rotate"?d.rotate(h.degrees,h.x,h.y):i=="scale"&&d.scale(h.x,h.y,h.centerX,h.centerY);a.matrix=d,b||a.el.set({transform:d.toSvg()})},setSize:function(a,b){var c=this,d=c.el;a=+a||c.width,b=+b||c.height,c.width=a,c.height=b,d.setSize(a,b),d.set({width:a,height:b}),c.callParent([a,b])},getRegion:function(){var a=this.el.getXY(),b=this.bgRect.getXY(),c=Math.max,d=c(a[0],b[0]),e=c(a[1],b[1]);return{left:d,top:e,right:d+this.width,bottom:e+this.height}},onRemove:function(a){a.el&&(a.el.destroy(),delete a.el),this.callParent(arguments)},setViewBox:function(a,b,c,d){isFinite(a)&&isFinite(b)&&isFinite(c)&&isFinite(d)&&(this.callParent(arguments),this.el.dom.setAttribute("viewBox",[a,b,c,d].join(" ")))},render:function(a){var b=this,c,d,e,f,g,h;b.el||(c=b.width||0,d=b.height||0,e=b.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:c,height:d}),f=b.getDefs(),g=b.createSvgElement("rect",{width:"100%",height:"100%",fill:"#000",stroke:"none",opacity:0}),Ext.isSafari3&&(h=b.createSvgElement("rect",{x:-10,y:-10,width:"110%",height:"110%",fill:"none",stroke:"#000"})),e.appendChild(f),Ext.isSafari3&&e.appendChild(h),e.appendChild(g),a.appendChild(e),b.el=Ext.get(e),b.bgRect=Ext.get(g),Ext.isSafari3&&(b.webkitRect=Ext.get(h),b.webkitRect.hide()),b.el.on({scope:b,mouseup:b.onMouseUp,mousedown:b.onMouseDown,mouseover:b.onMouseOver,mouseout:b.onMouseOut,mousemove:b.onMouseMove,mouseenter:b.onMouseEnter,mouseleave:b.onMouseLeave,click:b.onClick,dblclick:b.onDblClick})),b.renderAll()},onMouseEnter:function(a){this.el.parent().getRegion().contains(a.getPoint())&&this.fireEvent("mouseenter",a)},onMouseLeave:function(a){this.el.parent().getRegion().contains(a.getPoint())||this.fireEvent("mouseleave",a)},processEvent:function(a,b){var c=b.getTarget(),d=this.surface,e;this.fireEvent(a,b),c.nodeName=="tspan"&&c.parentNode&&(c=c.parentNode),e=this.items.get(c.id),e&&e.fireEvent(a,e,b)},tuneText:function(a,b){var c=a.el.dom,d=[],e,f,g,h,i,j,k,l;b.hasOwnProperty("text")&&(g=a.tspans&&Ext.Array.map(a.tspans,function(a){return a.textContent}).join(""),!a.tspans||b.text!=g?(d=this.setText(a,b.text),a.tspans=d):d=a.tspans||[]);if(d.length){e=this.getBBoxText(a).height,l=a.el.dom.getAttribute("x");for(h=0,i=d.length;h<i;h++)k=Ext.isFF3_0||Ext.isFF3_5?2:4,d[h].setAttribute("x",l),d[h].setAttribute("dy",h?e*1.2:e/k);a.dirty=!0}},setText:function(a,b){var c=this,d=a.el.dom,e=[],f,g,h,i,j,k;while(d.firstChild)d.removeChild(d.firstChild);k=String(b).split("\n");for(i=0,j=k.length;i<j;i++)h=k[i],h&&(g=c.createSvgElement("tspan"),g.appendChild(document.createTextNode(Ext.htmlDecode(h))),d.appendChild(g),e[i]=g);return e},renderAll:function(){this.items.each(this.renderItem,this)},renderItem:function(a){if(!this.el)return;a.el||this.createSpriteElement(a),a.zIndexDirty&&this.applyZIndex(a),a.dirty&&(this.applyAttrs(a),a.dirtyTransform&&this.applyTransformations(a))},redraw:function(a){a.dirty=a.zIndexDirty=!0,this.renderItem(a)},applyAttrs:function(a){var b=this,c=a.el,d=a.group,e=a.attr,f=b.parsers,g=b.gradientsMap||{},h=Ext.isSafari&&!Ext.isStrict,i,j,k,l,m,n,o,p,q;if(d){i=[].concat(d),k=i.length;for(j=0;j<k;j++)d=i[j],b.getGroup(d).add(a);delete a.group}l=b.scrubAttrs(a)||{},a.bbox.plain=0,a.bbox.transform=0,a.type=="circle"||a.type=="ellipse"?(l.cx=l.cx||l.x,l.cy=l.cy||l.y):a.type=="rect"?l.rx=l.ry=l.r:a.type=="path"&&l.d&&(l.d=Ext.draw.Draw.pathToString(Ext.draw.Draw.pathToAbsolute(l.d))),a.dirtyPath=!1,l["clip-rect"]&&(b.setClip(a,l),delete l["clip-rect"]),a.type=="text"&&l.font&&a.dirtyFont&&c.set({style:"font: "+l.font}),a.type=="image"&&c.dom.setAttributeNS(b.xlink,"href",l.src),Ext.applyIf(l,b.minDefaults[a.type]),a.dirtyHidden&&(e.hidden?b.hidePrim(a):b.showPrim(a),a.dirtyHidden=!1);for(n in l)if(l.hasOwnProperty(n)&&l[n]!=null){h&&"color|stroke|fill".indexOf(n)>-1&&l[n]in g&&(l[n]=g[l[n]]);if(n=="hidden"&&a.type=="text")continue;n in f?c.dom.setAttribute(n,f[n](l[n],a,b)):c.dom.setAttribute(n,l[n])}a.type=="text"&&b.tuneText(a,l),a.dirtyFont=!1,o=e.style,o&&c.setStyle(o),a.dirty=!1,Ext.isSafari3&&(b.webkitRect.show(),setTimeout(function(){b.webkitRect.hide()}))},setClip:function(a,b){var c=this,d=b["clip-rect"],e,f;d&&(a.clip&&a.clip.parentNode.parentNode.removeChild(a.clip.parentNode),e=c.createSvgElement("clipPath"),f=c.createSvgElement("rect"),e.id=Ext.id(null,"ext-clip-"),f.setAttribute("x",d.x),f.setAttribute("y",d.y),f.setAttribute("width",d.width),f.setAttribute("height",d.height),e.appendChild(f),c.getDefs().appendChild(e),a.el.dom.setAttribute("clip-path","url(#"+e.id+")"),a.clip=f)},applyZIndex:function(a){var b=this,c=b.items,d=c.indexOf(a),e=a.el,f;if(b.el.dom.childNodes[d+2]!==e.dom){if(d>0)do f=c.getAt(--d).el;while(!f&&d>0);e.insertAfter(f||b.bgRect)}a.zIndexDirty=!1},createItem:function(a){var b=new Ext.draw.Sprite(a);return b.surface=this,b},addGradient:function(a){a=Ext.draw.Draw.parseGradient(a);var b=this,c=a.stops.length,d=a.vector,e=Ext.isSafari&&!Ext.isStrict,f,g,h,i,j;j=b.gradientsMap||{};if(!e){a.type=="linear"?(f=b.createSvgElement("linearGradient"),f.setAttribute("x1",d[0]),f.setAttribute("y1",d[1]),f.setAttribute("x2",d[2]),f.setAttribute("y2",d[3])):(f=b.createSvgElement("radialGradient"),f.setAttribute("cx",a.centerX),f.setAttribute("cy",a.centerY),f.setAttribute("r",a.radius),Ext.isNumber(a.focalX)&&Ext.isNumber(a.focalY)&&(f.setAttribute("fx",a.focalX),f.setAttribute("fy",a.focalY))),f.id=a.id,b.getDefs().appendChild(f);for(i=0;i<c;i++)g=a.stops[i],h=b.createSvgElement("stop"),h.setAttribute("offset",g.offset+"%"),h.setAttribute("stop-color",g.color),h.setAttribute("stop-opacity",g.opacity),f.appendChild(h)}else j["url(#"+a.id+")"]=a.stops[0].color;b.gradientsMap=j},hasCls:function(a,b){return b&&(" "+(a.el.dom.getAttribute("class")||"")+" ").indexOf(" "+b+" ")!=-1},addCls:function(a,b){var c=a.el,d,e,f,g=[],h=c.getAttribute("class")||"";if(!Ext.isArray(b))typeof b=="string"&&!this.hasCls(a,b)&&c.set({"class":h+" "+b});else{for(d=0,e=b.length;d<e;d++)f=b[d],typeof f=="string"&&(" "+h+" ").indexOf(" "+f+" ")==-1&&g.push(f);g.length&&c.set({"class":" "+g.join(" ")})}},removeCls:function(a,b){var c=this,d=a.el,e=d.getAttribute("class")||"",f,g,h,i,j;Ext.isArray(b)||(b=[b]);if(e){j=e.replace(c.trimRe," ").split(c.spacesRe);for(f=0,h=b.length;f<h;f++)i=b[f],typeof i=="string"&&(i=i.replace(c.trimRe,""),g=Ext.Array.indexOf(j,i),g!=-1&&Ext.Array.erase(j,g,1));d.set({"class":j.join(" ")})}},destroy:function(){var a=this;a.callParent(),a.el&&a.el.remove(),a._defs&&Ext.get(a._defs).destroy(),a.bgRect&&Ext.get(a.bgRect).destroy(),a.webkitRect&&Ext.get(a.webkitRect).destroy(),delete a.el}}),Ext.define("Ext.draw.engine.Vml",{extend:"Ext.draw.Surface",requires:["Ext.draw.Draw","Ext.draw.Color","Ext.draw.Sprite","Ext.draw.Matrix","Ext.Element"],engine:"Vml",map:{M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},bitesRe:/([clmz]),?([^clmz]*)/gi,valRe:/-?[^,\s\-]+/g,fillUrlRe:/^url\(\s*['"]?([^\)]+?)['"]?\s*\)$/i,pathlike:/^(path|rect)$/,NonVmlPathRe:/[ahqstv]/ig,partialPathRe:/[clmz]/g,fontFamilyRe:/^['"]+|['"]+$/g,baseVmlCls:Ext.baseCSSPrefix+"vml-base",vmlGroupCls:Ext.baseCSSPrefix+"vml-group",spriteCls:Ext.baseCSSPrefix+"vml-sprite",measureSpanCls:Ext.baseCSSPrefix+"vml-measure-span",zoom:21600,coordsize:1e3,coordorigin:"0 0",zIndexShift:0,orderSpritesByZIndex:!1,path2vml:function(a){var b=this,c=b.NonVmlPathRe,d=b.map,e=b.valRe,f=b.zoom,g=b.bitesRe,h=Ext.Function.bind(Ext.draw.Draw.pathToAbsolute,Ext.draw.Draw),i,j,k,l,m,n,o,p;if(String(a).match(c))h=Ext.Function.bind(Ext.draw.Draw.path2curve,Ext.draw.Draw);else if(!String(a).match(b.partialPathRe))return i=String(a).replace(g,function(a,b,c){var g=[],h=b.toLowerCase()=="m",i=d[b];return c.replace(e,function(a){h&&g.length===2&&(i+=g+d[b=="m"?"l":"L"],g=[]),g.push(Math.round(a*f))}),i+g}),i;j=h(a),i=[];for(m=0,n=j.length;m<n;m++){k=j[m],l=j[m][0].toLowerCase(),l=="z"&&(l="x");for(o=1,p=k.length;o<p;o++)l+=Math.round(k[o]*b.zoom)+(o!=p-1?",":"");i.push(l)}return i.join(" ")},translateAttrs:{radius:"r",radiusX:"rx",radiusY:"ry",lineWidth:"stroke-width",fillOpacity:"fill-opacity",strokeOpacity:"stroke-opacity",strokeLinejoin:"stroke-linejoin"},minDefaults:{circle:{fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},ellipse:{cx:0,cy:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},rect:{x:0,y:0,width:0,height:0,rx:0,ry:0,fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},text:{x:0,y:0,"text-anchor":"start",font:'10px "Arial"',fill:"#000",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},path:{d:"M0,0",fill:"none",stroke:null,"stroke-width":null,opacity:null,"fill-opacity":null,"stroke-opacity":null},image:{x:0,y:0,width:0,height:0,preserveAspectRatio:"none",opacity:null}},onMouseEnter:function(a){this.fireEvent("mouseenter",a)},onMouseLeave:function(a){this.fireEvent("mouseleave",a)},processEvent:function(a,b){var c=b.getTarget(),d=this.surface,e;this.fireEvent(a,b),e=this.items.get(c.id),e&&e.fireEvent(a,e,b)},createSpriteElement:function(a){var b=this,c=a.attr,d=a.type,e=b.zoom,f=a.vml||(a.vml={}),g=Math.round,h=d==="image"?b.createNode("image"):b.createNode("shape"),i,j,k;return h.coordsize=e+" "+e,h.coordorigin=c.coordorigin||"0 0",Ext.get(h).addCls(b.spriteCls),d=="text"&&(f.path=i=b.createNode("path"),i.textpathok=!0,f.textpath=k=b.createNode("textpath"),k.on=!0,h.appendChild(k),h.appendChild(i)),h.id=a.id,a.el=Ext.get(h),a.el.setStyle("zIndex",-b.zIndexShift),b.el.appendChild(h),d!=="image"&&(j=b.createNode("skew"),j.on=!0,h.appendChild(j),a.skew=j),a.matrix=new Ext.draw.Matrix,a.bbox={plain:null,transform:null},this.applyAttrs(a),this.applyTransformations(a),a.fireEvent("render",a),a.el},getBBoxText:function(a){var b=a.vml;return{x:b.X+(b.bbx||0)-b.W/2,y:b.Y-b.H/2,width:b.W,height:b.H}},applyAttrs:function(a){var b=this,c=a.vml,d=a.group,e=a.attr,f=a.el,g=f.dom,h,i,j,k,l,m,n,o,p,q,r,s;if(d){j=[].concat(d),l=j.length;for(k=0;k<l;k++)d=j[k],b.getGroup(d).add(a);delete a.group}m=b.scrubAttrs(a)||{},a.zIndexDirty&&b.setZIndex(a),Ext.applyIf(m,b.minDefaults[a.type]),a.type=="image"&&(Ext.apply(a.attr,{x:m.x,y:m.y,width:m.width,height:m.height}),f.setStyle({width:m.width+"px",height:m.height+"px"}),g.src=m.src),g.href&&(g.href=m.href),g.title&&(g.title=m.title),g.target&&(g.target=m.target),g.cursor&&(g.cursor=m.cursor),a.dirtyHidden&&(m.hidden?b.hidePrim(a):b.showPrim(a),a.dirtyHidden=!1),a.dirtyPath&&(a.type=="circle"||a.type=="ellipse"?(p=m.x,q=m.y,r=m.rx||m.r||0,s=m.ry||m.r||0,g.path=Ext.String.format("ar{0},{1},{2},{3},{4},{1},{4},{1}",Math.round((p-r)*b.zoom),Math.round((q-s)*b.zoom),Math.round((p+r)*b.zoom),Math.round((q+s)*b.zoom),Math.round(p*b.zoom)),a.dirtyPath=!1):a.type!=="text"&&a.type!=="image"&&(a.attr.path=m.path=b.setPaths(a,m)||m.path,g.path=b.path2vml(m.path),a.dirtyPath=!1)),"clip-rect"in m&&b.setClip(a,m),a.type=="text"&&b.setTextAttributes(a,m),(m.opacity||m["stroke-opacity"]||m.fill)&&b.setFill(a,m),(m.stroke||m["stroke-opacity"]||m.fill)&&b.setStroke(a,m),h=e.style,h&&f.setStyle(h),a.dirty=!1},setZIndex:function(a){var b=this,c=a.attr.zIndex,d=b.zIndexShift,e,f,g,h;if(c<d){e=b.items.items,f=e.length;for(h=0;h<f;h++)(c=e[h].attr.zIndex)&&c<d&&(d=c);b.zIndexShift=d;for(h=0;h<f;h++)g=e[h],g.el&&g.el.setStyle("zIndex",g.attr.zIndex-d),g.zIndexDirty=!1}else a.el&&(a.el.setStyle("zIndex",c-d),a.zIndexDirty=!1)},setPaths:function(a,b){var c=a.attr,d=a.attr["stroke-width"]||1;return a.bbox.plain=null,a.bbox.transform=null,a.type=="circle"?(c.rx=c.ry=b.r,Ext.draw.Draw.ellipsePath(a)):a.type=="ellipse"?(c.rx=b.rx,c.ry=b.ry,Ext.draw.Draw.ellipsePath(a)):a.type=="rect"?(c.rx=c.ry=b.r,Ext.draw.Draw.rectPath(a)):a.type=="path"&&c.path?Ext.draw.Draw.pathToAbsolute(c.path):!1},setFill:function(a,b){var c=this,d=a.el.dom,e=d.fill,f=!1,g,h,i,j,k;e||(e=d.fill=c.createNode("fill"),f=!0),Ext.isArray(b.fill)&&(b.fill=b.fill[0]),b.fill=="none"?e.on=!1:(typeof b.opacity=="number"&&(e.opacity=b.opacity),typeof b["fill-opacity"]=="number"&&(e.opacity=b["fill-opacity"]),e.on=!0,typeof b.fill=="string"&&(i=b.fill.match(c.fillUrlRe),i?(i=i[1],i.charAt(0)=="#"&&(h=c.gradientsColl.getByKey(i.substring(1))),h?(j=b.rotation,k=-(h.angle+270+(j?j.degrees:0))%360,k===0&&(k=180),e.angle=k,e.type="gradient",e.method="sigma",e.colors?e.colors.value=h.colors:e.colors=h.colors):(e.src=i,e.type="tile")):(e.color=Ext.draw.Color.toHex(b.fill),e.src="",e.type="solid"))),f&&d.appendChild(e)},setStroke:function(a,b){var c=this,d=a.el.dom,e=a.strokeEl,f=!1,g,h;e||(e=a.strokeEl=c.createNode("stroke"),f=!0),Ext.isArray(b.stroke)&&(b.stroke=b.stroke[0]),!b.stroke||b.stroke=="none"||b.stroke==0||b["stroke-width"]==0?e.on=!1:(e.on=!0,b.stroke&&!b.stroke.match(c.fillUrlRe)&&(e.color=Ext.draw.Color.toHex(b.stroke)),e.dashstyle=b["stroke-dasharray"]?"dash":"solid",e.joinstyle=b["stroke-linejoin"],e.endcap=b["stroke-linecap"]||"round",e.miterlimit=b["stroke-miterlimit"]||8,g=parseFloat(b["stroke-width"]||1)*.75,h=b["stroke-opacity"]||1,Ext.isNumber(g)&&g<1?(e.weight=1,e.opacity=h*g):(e.weight=g,e.opacity=h)),f&&d.appendChild(e)},setClip:function(a,b){var c=this,d=a.el,e=a.clipEl,f=String(b["clip-rect"]).split(c.separatorRe);e||(e=a.clipEl=c.el.insertFirst(Ext.getDoc().dom.createElement("div")),e.addCls(Ext.baseCSSPrefix+"vml-sprite")),f.length==4?(f[2]=+f[2]+ +f[0],f[3]=+f[3]+ +f[1],e.setStyle("clip",Ext.String.format("rect({1}px {2}px {3}px {0}px)",f[0],f[1],f[2],f[3])),e.setSize(c.el.width,c.el.height)):e.setStyle("clip","")},setTextAttributes:function(a,b){var c=this,d=a.vml,e=d.textpath.style,f=c.span.style,g=c.zoom,h=Math.round,i={fontSize:"font-size",fontWeight:"font-weight",fontStyle:"font-style"},j,k;if(a.dirtyFont){b.font&&(e.font=f.font=b.font),b["font-family"]&&(e.fontFamily='"'+b["font-family"].split(",")[0].replace(c.fontFamilyRe,"")+'"',f.fontFamily=b["font-family"]);for(j in i)k=b[i[j]],k&&(e[j]=f[j]=k);c.setText(a,b.text),d.textpath.string&&(c.span.innerHTML=String(d.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br/>")),d.W=c.span.offsetWidth,d.H=c.span.offsetHeight+2,b["text-anchor"]=="middle"?e["v-text-align"]="center":b["text-anchor"]=="end"?(e["v-text-align"]="right",d.bbx=-Math.round(d.W/2)):(e["v-text-align"]="left",d.bbx=Math.round(d.W/2))}d.X=b.x,d.Y=b.y,d.path.v=Ext.String.format("m{0},{1}l{2},{1}",Math.round(d.X*g),Math.round(d.Y*g),Math.round(d.X*g)+1),a.bbox.plain=null,a.bbox.transform=null,a.dirtyFont=!1},setText:function(a,b){a.vml.textpath.string=Ext.htmlDecode(b)},hide:function(){this.el.hide()},show:function(){this.el.show()},hidePrim:function(a){a.el.addCls(Ext.baseCSSPrefix+"hide-visibility")},showPrim:function(a){a.el.removeCls(Ext.baseCSSPrefix+"hide-visibility")},setSize:function(a,b){var c=this;a=a||c.width,b=b||c.height,c.width=a,c.height=b,c.el&&(a!=undefined&&c.el.setWidth(a),b!=undefined&&c.el.setHeight(b)),c.callParent(arguments)},applyViewBox:function(){var a=this,b=a.viewBox,c=a.width,d=a.height,e,f,g;a.callParent();if(b&&(c||d)){e=a.items.items,f=e.length;for(g=0;g<f;g++)a.applyTransformations(e[g])}},onAdd:function(a){this.callParent(arguments),this.el&&this.renderItem(a)},onRemove:function(a){a.el&&(a.el.remove(),delete a.el),this.callParent(arguments)},render:function(a){var b=this,c=Ext.getDoc().dom,d;if(!b.createNode)try{c.namespaces.rvml||c.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),b.createNode=function(a){return c.createElement("<rvml:"+a+' class="rvml">')}}catch(e){b.createNode=function(a){return c.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}b.el||(d=c.createElement("div"),b.el=Ext.get(d),b.el.addCls(b.baseVmlCls),b.span=c.createElement("span"),Ext.get(b.span).addCls(b.measureSpanCls),d.appendChild(b.span),b.el.setSize(b.width||0,b.height||0),a.appendChild(d),b.el.on({scope:b,mouseup:b.onMouseUp,mousedown:b.onMouseDown,mouseover:b.onMouseOver,mouseout:b.onMouseOut,mousemove:b.onMouseMove,mouseenter:b.onMouseEnter,mouseleave:b.onMouseLeave,click:b.onClick,dblclick:b.onDblClick})),b.renderAll()},renderAll:function(){this.items.each(this.renderItem,this)},redraw:function(a){a.dirty=!0,this.renderItem(a)},renderItem:function(a){if(!this.el)return;a.el||this.createSpriteElement(a),a.dirty&&(this.applyAttrs(a),a.dirtyTransform&&this.applyTransformations(a))},rotationCompensation:function(a,b,c){var d=new Ext.draw.Matrix;return d.rotate(-a,.5,.5),{x:d.x(b,c),y:d.y(b,c)}},transform:function(a,b){var c=this,d=c.getBBox(a,!0),e=d.x+d.width*.5,f=d.y+d.height*.5,g=new Ext.draw.Matrix,h=a.transformations,i=h.length,j=0,k=0,l=1,m=1,n="",o=a.el,p=o.dom,q=p.style,r=c.zoom,s=a.skew,t=c.viewBoxShift,u,v,w,x,y,z,A,B,C,D,E,F;for(;j<i;j++)w=h[j],x=w.type,x=="translate"?g.translate(w.x,w.y):x=="rotate"?(g.rotate(w.degrees,w.x,w.y),k+=w.degrees):x=="scale"&&(g.scale(w.x,w.y,w.centerX,w.centerY),l*=w.x,m*=w.y);a.matrix=g.clone();if(b)return;t&&g.prepend(t.scale,0,0,t.scale,t.dx*t.scale,t.dy*t.scale),a.type!="image"&&s?(s.origin="0,0",s.matrix=g.toString(),F=g.offset(),F[0]>32767?F[0]=32767:F[0]<-32768&&(F[0]=-32768),F[1]>32767?F[1]=32767:F[1]<-32768&&(F[1]=-32768),s.offset=F):(q.filter=g.toFilter(),q.left=Math.min(g.x(d.x,d.y),g.x(d.x+d.width,d.y),g.x(d.x,d.y+d.height),g.x(d.x+d.width,d.y+d.height))+"px",q.top=Math.min(g.y(d.x,d.y),g.y(d.x+d.width,d.y),g.y(d.x,d.y+d.height),g.y(d.x+d.width,d.y+d.height))+"px")},createItem:function(a){return Ext.create("Ext.draw.Sprite",a)},getRegion:function(){return this.el.getRegion()},addCls:function(a,b){a&&a.el&&a.el.addCls(b)},removeCls:function(a,b){a&&a.el&&a.el.removeCls(b)},addGradient:function(a){var b=this.gradientsColl||(this.gradientsColl=Ext.create("Ext.util.MixedCollection")),c=[],d=Ext.create("Ext.util.MixedCollection"),e,f,g,h,i,j;d.addAll(a.stops),d.sortByKey("ASC",function(a,b){return a=parseInt(a,10),b=parseInt(b,10),a>b?1:a<b?-1:0}),e=d.keys,f=d.items,g=e.length;for(j=0;j<g;j++)h=e[j],i=f[j],c.push(h+"% "+i.color);b.add(a.id,{colors:c.join(","),angle:a.angle})},destroy:function(){var a=this;a.callParent(arguments),a.el&&a.el.remove(),delete a.el}}),Ext.define("Ext.dd.DragZone",{extend:"Ext.dd.DragSource",constructor:function(a,b){this.callParent([a,b]),this.containerScroll&&Ext.dd.ScrollManager.register(this.el)},getDragData:function(a){return Ext.dd.Registry.getHandleFromEvent(a)},onInitDrag:function(a,b){return this.proxy.update(this.dragData.ddel.cloneNode(!0)),this.onStartDrag(a,b),!0},afterRepair:function(){var a=this;Ext.enableFx&&Ext.fly(a.dragData.ddel).highlight(a.repairHighlightColor),a.dragging=!1},getRepairXY:function(a){return Ext.fly(this.dragData.ddel).getXY()},destroy:function(){this.callParent(),this.containerScroll&&Ext.dd.ScrollManager.unregister(this.el)}}),Ext.define("Ext.flash.Component",{extend:"Ext.Component",alternateClassName:"Ext.FlashComponent",alias:"widget.flash",flashVersion:"9.0.115",backgroundColor:"#ffffff",wmode:"opaque",swfWidth:"100%",swfHeight:"100%",expressInstall:!1,renderTpl:['<div id="{swfId}"></div>'],initComponent:function(){this.callParent(),this.addEvents("success","failure")},beforeRender:function(){this.callParent(),Ext.applyIf(this.renderData,{swfId:this.getSwfId()})},afterRender:function(){var a=this,b=Ext.apply({},a.flashParams),c=Ext.apply({},a.flashVars);a.callParent(),Ext.apply({allowScriptAccess:"always",bgcolor:a.backgroundColor,wmode:a.wmode},b),Ext.apply({allowedDomain:document.location.hostname},c),new swfobject.embedSWF(a.url,a.getSwfId(),a.swfWidth,a.swfHeight,a.flashVersion,a.expressInstall?a.statics.EXPRESS_INSTALL_URL:undefined,c,b,a.flashAttributes,Ext.bind(a.swfCallback,a))},swfCallback:function(a){var b=this;a.success?(b.swf=Ext.get(a.ref),b.onSuccess(),b.fireEvent("success",b)):(b.onFailure(),b.fireEvent("failure",b))},getSwfId:function(){return this.swfId||(this.swfId="extswf"+this.getAutoId())},onSuccess:function(){this.swf.setStyle("visibility","inherit")},onFailure:Ext.emptyFn,beforeDestroy:function(){var a=this,b=a.swf;b&&(swfobject.removeSWF(a.getSwfId()),Ext.destroy(b),delete a.swf),a.callParent()},statics:{EXPRESS_INSTALL_URL:"http://swfobject.googlecode.com/svn/trunk/swfobject/expressInstall.swf"}}),Ext.define("Ext.form.CheckboxManager",{extend:"Ext.util.MixedCollection",singleton:!0,getByName:function(a){return this.filterBy(function(b){return b.name==a})},getWithValue:function(a,b){return this.filterBy(function(c){return c.name==a&&c.inputValue==b})},getChecked:function(a){return this.filterBy(function(b){return b.name==a&&b.checked})}}),Ext.define("Ext.form.Label",{extend:"Ext.Component",alias:"widget.label",requires:["Ext.util.Format"],autoEl:"label",maskOnDisable:!1,getElConfig:function(){var a=this;return a.html=a.text?Ext.util.Format.htmlEncode(a.text):a.html||"",Ext.apply(a.callParent(),{htmlFor:a.forId||""})},setText:function(a,b){var c=this;return b=b!==!1,b?(c.text=a,delete c.html):(c.html=a,delete c.text),c.rendered&&(c.el.dom.innerHTML=b!==!1?Ext.util.Format.htmlEncode(a):a),this}}),Ext.define("Ext.form.Labelable",{requires:["Ext.XTemplate"],autoEl:{tag:"table",cellpadding:0},childEls:["labelCell","labelEl","bodyEl","errorEl","inputRow"],labelableRenderTpl:["<tpl if=\"labelAlign=='top'\">","<tr>",'<td id="{id}-labelCell" colspan="3" style="{labelCellStyle}" {labelCellAttrs}>',"{beforeLabelTpl}",'<label id="{id}-labelEl" {labelAttrTpl}<tpl if="inputId"> for="{inputId}"</tpl> class="{labelCls}"','<tpl if="labelStyle"> style="{labelStyle}"</tpl>>',"{beforeLabelTextTpl}",'<tpl if="fieldLabel">{fieldLabel}{labelSeparator}</tpl>',"{afterLabelTextTpl}","</label>","{afterLabelTpl}","</td>","</tr>","</tpl>",'<tr id="{id}-inputRow" <tpl if="inFormLayout">id="{id}"</tpl>>','<tpl if="labelOnLeft">','<td id="{id}-labelCell" style="{labelCellStyle}" {labelCellAttrs}>',"{beforeLabelTpl}",'<label id="{id}-labelEl" {labelAttrTpl}<tpl if="inputId"> for="{inputId}"</tpl> class="{labelCls}"','<tpl if="labelStyle"> style="{labelStyle}"</tpl>>',"{beforeLabelTextTpl}",'<tpl if="fieldLabel">{fieldLabel}{labelSeparator}</tpl>',"{afterLabelTextTpl}","</label>","{afterLabelTpl}","</td>","</tpl>",'<td class="{baseBodyCls} {fieldBodyCls}" id="{id}-bodyEl" role="presentation" colspan="{bodyColspan}">',"{beforeSubTpl}","{[values.$comp.getSubTplMarkup()]}","{afterSubTpl}","</td>","<tpl if=\"msgTarget=='side'\">",'<td id="{id}-errorEl" class="{errorMsgCls}" style="display:none" width="{errorIconWidth}"></td>',"</tpl>","</tr>","<tpl if=\"msgTarget=='under'\">","<tr>",'<tpl if="labelOnLeft">',"<td></td>","</tpl>",'<td id="{id}-errorEl" class="{errorMsgClass}" colspan="{[values.labelOnLeft ? 2 : 3]}" style="display:none"></td>',"</tr>","</tpl>",{disableFormats:!0}],activeErrorsTpl:['<tpl if="errors && errors.length">','<ul><tpl for="errors"><li>{.}</li></tpl></ul>',"</tpl>"],isFieldLabelable:!0,formItemCls:Ext.baseCSSPrefix+"form-item",labelCls:Ext.baseCSSPrefix+"form-item-label",errorMsgCls:Ext.baseCSSPrefix+"form-error-msg",baseBodyCls:Ext.baseCSSPrefix+"form-item-body",fieldBodyCls:"",clearCls:Ext.baseCSSPrefix+"clear",invalidCls:Ext.baseCSSPrefix+"form-invalid",fieldLabel:undefined,labelAlign:"left",labelWidth:100,labelPad:5,labelSeparator:":",hideLabel:!1,hideEmptyLabel:!0,preventMark:!1,autoFitErrors:!0,msgTarget:"qtip",noWrap:!0,labelableInsertions:["beforeLabelTpl","afterLabelTpl","beforeSubTpl","afterSubTpl","beforeLabelTextTpl","afterLabelTextTpl","labelAttrTpl"],labelableRenderProps:"allowBlank,labelAlign,fieldBodyCls,baseBodyCls,clearCls,labelSeparator,msgTarget",initLabelable:function(){var a=this,b=a.padding;b&&(a.padding=undefined,a.extraMargins=Ext.Element.parseBox(b)),a.addCls(a.formItemCls),a.lastActiveError="",a.addEvents("errorchange")},getFieldLabel:function(){return this.fieldLabel||""},setFieldLabel:function(a){a=a||"";var b=this,c=b.labelSeparator,d=b.labelEl,e;b.fieldLabel=a,b.rendered&&(Ext.isEmpty(a)&&b.hideEmptyLabel?d.parent().setDisplayed("none"):(c&&(e=a.substr(a.length-1),e!=c&&(a+=c)),d.update(a),d.parent().setDisplayed("")),b.updateLayout())},getInsertionRenderData:function(a,b){var c=b.length,d,e;while(c--)d=b[c],e=this[d],e&&typeof e!="string"&&(e.isTemplate||(e=Ext.XTemplate.getTpl(this,d)),e=e.apply(a)),a[d]=e||"";return a},getLabelableRenderData:function(){var a=this,b,c;return Ext.form.Labelable.errorIconWidth||(Ext.form.Labelable.errorIconWidth=(c=Ext.getBody().createChild({style:"position:absolute",cls:Ext.baseCSSPrefix+"form-invalid-icon"})).getWidth(),c.remove()),b=Ext.copyTo({inFormLayout:a.ownerLayout&&a.ownerLayout.type==="form",inputId:a.getInputId(),labelOnLeft:a.labelAlign!="top",fieldLabel:a.getFieldLabel(),labelCellStyle:a.getLabelCellStyle(),labelCellAttrs:a.getLabelCellAttrs(),labelCls:a.getLabelCls(),labelStyle:a.getLabelStyle(),bodyColspan:a.getBodyColspan(),errorMsgCls:a.errorMsgCls+(a.autoFitErrors?"":" "+Ext.baseCSSPrefix+"external-error-icon"),errorIconWidth:Ext.form.Labelable.errorIconWidth},a,a.labelableRenderProps,!0),a.getInsertionRenderData(b,a.labelableInsertions),b},beforeLabelableRender:function(){var a=this;a.ownerLayout&&a.addCls(Ext.baseCSSPrefix+a.ownerLayout.type+"-form-item")},onLabelableRender:function(){var a=this,b,c,d={};if(a.extraMargins){b=a.el.getMargin();for(c in b)b.hasOwnProperty(c)&&(d["margin-"+c]=b[c]+a.extraMargins[c]+"px");a.el.setStyle(d)}},hasVisibleLabel:function(){return this.hideLabel?!1:!this.hideEmptyLabel||!!this.getFieldLabel()},getBodyColspan:function(){var a=this,b=!a.hasVisibleLabel(),c;return c=b||a.labelAlign==="top"?3:2,a.hasActiveError()&&c--,c},getLabelCls:function(){var a=this.labelCls,b=this.labelClsExtra;return b?a+" "+b:a},getLabelCellStyle:function(){var a=this,b=a.hideLabel||!a.fieldLabel&&a.hideEmptyLabel;return b?"display:none;":""},getLabelCellAttrs:function(){var a=this,b=a.labelAlign,c="";return b!=="top"&&(c='valign="top" halign="'+b+'" width="'+(a.labelWidth+a.labelPad)+'"'),c+' class="'+Ext.baseCSSPrefix+'field-label-cell"'},getLabelStyle:function(){var a=this,b=a.labelPad,c="";return a.labelAlign==="top"?c="margin-bottom:"+b+"px;":(a.labelWidth&&(c="width:"+a.labelWidth+"px;"),c+="margin-right:"+b+"px;"),c+(a.labelStyle||"")},getSubTplMarkup:function(){return""},getInputId:function(){return""},getActiveError:function(){return this.activeError||""},hasActiveError:function(){return!!this.getActiveError()},setActiveError:function(a){this.setActiveErrors(a)},getActiveErrors:function(){return this.activeErrors||[]},setActiveErrors:function(a){a=Ext.Array.from(a),this.activeError=a[0],this.activeErrors=a,this.activeError=this.getTpl("activeErrorsTpl").apply({errors:a}),this.renderActiveError()},unsetActiveError:function(){delete this.activeError,delete this.activeErrors,this.renderActiveError()},renderActiveError:function(){var a=this,b=a.getActiveError(),c=!!b;b!==a.lastActiveError&&(a.fireEvent("errorchange",a,b),a.lastActiveError=b),a.rendered&&!a.isDestroyed&&!a.preventMark&&(a.el[c?"addCls":"removeCls"](a.invalidCls),a.getActionEl().dom.setAttribute("aria-invalid",c),a.errorEl&&(a.errorEl.dom.innerHTML=b))},setFieldDefaults:function(a){var b=this,c,d;for(d in a)a.hasOwnProperty(d)&&(c=a[d],b.hasOwnProperty(d)||(b[d]=c))}}),Ext.define("Ext.form.RadioManager",{extend:"Ext.util.MixedCollection",singleton:!0,getByName:function(a,b){return this.filterBy(function(c){return c.name==a&&c.getFormId()==b})},getWithValue:function(a,b,c){return this.filterBy(function(d){return d.name==a&&d.inputValue==b&&d.getFormId()==c})},getChecked:function(a,b){return this.findBy(function(c){return c.name==a&&c.checked&&c.getFormId()==b})}}),Ext.define("Ext.form.action.DirectSubmit",{extend:"Ext.form.action.Submit",requires:["Ext.direct.Manager"],alternateClassName:"Ext.form.Action.DirectSubmit",alias:"formaction.directsubmit",type:"directsubmit",doSubmit:function(){var a=this,b=Ext.Function.bind(a.onComplete,a),c=a.buildForm();a.form.api.submit(c,b,a),Ext.removeNode(c)},processResponse:function(a){return this.result=a},onComplete:function(a,b){a?this.onSuccess(a):this.onFailure(null)}}),Ext.define("Ext.form.action.Load",{extend:"Ext.form.action.Action",requires:["Ext.data.Connection"],alternateClassName:"Ext.form.Action.Load",alias:"formaction.load",type:"load",run:function(){Ext.Ajax.request(Ext.apply(this.createCallback(),{method:this.getMethod(),url:this.getUrl(),headers:this.headers,params:this.getParams()}))},onSuccess:function(a){var b=this.processResponse(a),c=this.form;if(b===!0||!b.success||!b.data){this.failureType=Ext.form.action.Action.LOAD_FAILURE,c.afterAction(this,!1);return}c.clearInvalid(),c.setValues(b.data),c.afterAction(this,!0)},handleResponse:function(a){var b=this.form.reader,c,d;return b?(c=b.read(a),d=c.records&&c.records[0]?c.records[0].data:null,{success:c.success,data:d}):Ext.decode(a.responseText)}}),Ext.define("Ext.form.action.DirectLoad",{extend:"Ext.form.action.Load",requires:["Ext.direct.Manager"],alternateClassName:"Ext.form.Action.DirectLoad",alias:"formaction.directload",type:"directload",run:function(){var a=this,b=a.form,c=b.api.load,d=c.directCfg.method,e=d.getArgs(a.getParams(),b.paramOrder,b.paramsAsHash);e.push(a.onComplete,a),c.apply(window,e)},processResponse:function(a){return this.result=a},onComplete:function(a,b){a?this.onSuccess(a):this.onFailure(null)}}),Ext.define("Ext.form.action.StandardSubmit",{extend:"Ext.form.action.Submit",alias:"formaction.standardsubmit",doSubmit:function(){var a=this.buildForm();a.submit(),Ext.removeNode(a)}}),Ext.define("Ext.grid.ColumnComponentLayout",{extend:"Ext.layout.component.Auto",alias:"layout.columncomponent",type:"columncomponent",setWidthInDom:!0,getContentHeight:function(a){return this.owner.isGroupHeader?a.getProp("contentHeight"):this.callParent(arguments)},calculateOwnerHeightFromContentHeight:function(a,b){var c=this.callParent(arguments);return this.owner.isGroupHeader&&(c+=this.owner.titleEl.dom.offsetHeight),c},getContentWidth:function(a){return this.owner.isGroupHeader?a.getProp("contentWidth"):this.callParent(arguments)},calculateOwnerWidthFromContentWidth:function(a,b){return b+a.getPaddingInfo().width}}),Ext.define("Ext.grid.feature.AbstractSummary",{extend:"Ext.grid.feature.Feature",alias:"feature.abstractsummary",showSummaryRow:!0,nestedIdRe:/\{\{id\}([\w\-]*)\}/g,init:function(){var a=this;a.grid.optimizedColumnMove=!1,a.view.mon(a.view.store,{update:a.onStoreUpdate,scope:a})},onStoreUpdate:function(){var a=this.view;this.showSummaryRow&&(a.saveScrollState(),a.refresh(),a.restoreScrollState())},toggleSummaryRow:function(a){this.showSummaryRow=!!a},getSummaryFragments:function(){var a={};return this.showSummaryRow&&Ext.apply(a,{printSummaryRow:Ext.bind(this.printSummaryRow,this)}),a},printSummaryRow:function(a){var b=this.view.getTableChunker().metaRowTpl.join(""),c=Ext.baseCSSPrefix;return b=b.replace(c+"grid-row",c+"grid-row-summary"),b=b.replace("{{id}}","{gridSummaryValue}"),b=b.replace(this.nestedIdRe,"{id$1}"),b=b.replace("{[this.embedRowCls()]}","{rowCls}"),b=b.replace("{[this.embedRowAttr()]}","{rowAttr}"),b=new Ext.XTemplate(b,{firstOrLastCls:Ext.view.TableChunker.firstOrLastCls}),b.applyTemplate({columns:this.getPrintData(a)})},getColumnValue:function(a,b){var c=Ext.getCmp(a.id),d=b[a.id],e=c.summaryRenderer;return!d&&d!==0&&(d=" "),e&&(d=e.call(c.scope||this,d,b,a.dataIndex)),d},getSummary:function(a,b,c,d){if(b){if(Ext.isFunction(b))return a.aggregate(b,null,d);switch(b){case"count":return a.count(d);case"min":return a.min(c,d);case"max":return a.max(c,d);case"sum":return a.sum(c,d);case"average":return a.average(c,d);default:return d?{}:""}}}}),Ext.define("Ext.grid.feature.Chunking",{extend:"Ext.grid.feature.Feature",alias:"feature.chunking",chunkSize:20,rowHeight:Ext.isIE?27:26,visibleChunk:0,hasFeatureEvent:!1,attachEvents:function(){this.view.el.on("scroll",this.onBodyScroll,this,{buffer:300})},onBodyScroll:function(a,b){var c=this.view,d=b.scrollTop,e=Math.floor(d/this.rowHeight/this.chunkSize);e!==this.visibleChunk&&(this.visibleChunk=e,c.refresh(),c.el.dom.scrollTop=d,c.el.dom.scrollTop=d)},collectData:function(a,b,c,d,e){var f={fullWidth:e.fullWidth,chunks:[]},g=e.rows.length,h=0,i=0,j=this.visibleChunk,k,l,m;for(;h<g;h+=this.chunkSize,i++)h+this.chunkSize>g?m=g-h:m=this.chunkSize,i>=j-1&&i<=j+1?l=e.rows.slice(h,h+this.chunkSize):l=[],f.chunks.push({rows:l,fullWidth:d,chunkHeight:m*this.rowHeight});return f},getTableFragments:function(){return{openTableWrap:function(){return'<tpl for="chunks"><div class="'+Ext.baseCSSPrefix+'grid-chunk" style="height: {chunkHeight}px;">'},closeTableWrap:function(){return"</div></tpl>"}}}}),Ext.define("Ext.grid.feature.GroupingSummary",{extend:"Ext.grid.feature.Grouping",alias:"feature.groupingsummary",mixins:{summary:"Ext.grid.feature.AbstractSummary"},init:function(){this.mixins.summary.init.call(this)},getFeatureTpl:function(){var a=this.callParent(arguments);return this.showSummaryRow&&(a=a.replace("</tpl>",""),a+="{[this.printSummaryRow(xindex)]}</tpl>"),a},getFragmentTpl:function(){var a=this,b=a.callParent();return Ext.apply(b,a.getSummaryFragments()),a.showSummaryRow&&(a.summaryGroups=a.view.store.getGroups(),a.summaryData=a.generateSummaryData()),b},getPrintData:function(a){var b=this,c=b.view.headerCt.getColumnsForTpl(),d=0,e=c.length,f=[],g=b.summaryGroups[a-1].name,h=b.summaryData[g],i;for(;d<e;++d)i=c[d],i.gridSummaryValue=this.getColumnValue(i,h),f.push(i);return f},generateSummaryData:function(){var a=this,b={},c={},d=a.view.store,e=this.getGroupField(),f=d.proxy.reader,g=a.summaryGroups,h=a.view.headerCt.getColumnsForTpl(),i,j,k,l,m,n,o,p,q,r,s;for(j=0,k=g.length;j<k;++j)b[g[j].name]={};if(a.remoteRoot&&f.rawData){m=f.root,f.root=a.remoteRoot,f.buildExtractors(!0),p=f.getRoot(f.rawData),r=p.length,f.convertRecordData||f.buildExtractors();for(q=0;q<r;q++)s={},f.convertRecordData(s,p[q]),c[s[e]]=s;f.root=m,f.buildExtractors(!0)}for(j=0,k=h.length;j<k;++j){o=Ext.getCmp(h[j].id),l=a.getSummary(d,o.summaryType,o.dataIndex,!0);for(n in l)l.hasOwnProperty(n)&&(b[n][o.id]=l[n]);for(n in c)c.hasOwnProperty(n)&&(i=c[n][o.dataIndex],i!==undefined&&b[n]!==undefined&&(b[n][o.id]=i))}return b}}),Ext.define("Ext.grid.feature.Summary",{extend:"Ext.grid.feature.AbstractSummary",alias:"feature.summary",getFragmentTpl:function(){return this.summaryData=this.generateSummaryData(),this.getSummaryFragments()},getTableFragments:function(){if(this.showSummaryRow)return{closeRows:this.closeRows}},closeRows:function(){return"</tpl>{[this.printSummaryRow()]}"},getPrintData:function(a){var b=this,c=b.view.headerCt.getColumnsForTpl(),d=0,e=c.length,f=[],g=b.summaryData,h;for(;d<e;++d)h=c[d],h.gridSummaryValue=this.getColumnValue(h,g),f.push(h);return f},generateSummaryData:function(){var a=this,b={},c=a.view.store,d=a.view.headerCt.getColumnsForTpl(),e=0,f=d.length,g,h,i;for(e=0,f=d.length;e<f;++e)i=Ext.getCmp(d[e].id),b[i.id]=a.getSummary(c,i.summaryType,i.dataIndex,!1);return b}}),Ext.define("Ext.grid.header.DragZone",{extend:"Ext.dd.DragZone",colHeaderCls:Ext.baseCSSPrefix+"column-header",maxProxyWidth:120,constructor:function(a){this.headerCt=a,this.ddGroup=this.getDDGroup(),this.callParent([a.el]),this.proxy.el.addCls(Ext.baseCSSPrefix+"grid-col-dd")},getDDGroup:function(){return"header-dd-zone-"+this.headerCt.up("[scrollerOwner]").id},getDragData:function(a){var b=a.getTarget("."+this.colHeaderCls),c,d;if(b){c=Ext.getCmp(b.id);if(!this.headerCt.dragging&&c.draggable&&!c.isOnLeftEdge(a)&&!c.isOnRightEdge(a))return d=document.createElement("div"),d.innerHTML=Ext.getCmp(b.id).text,{ddel:d,header:c}}return!1},onBeforeDrag:function(){return!this.headerCt.dragging&&!this.disabled},onInitDrag:function(){this.headerCt.dragging=!0,this.callParent(arguments)},onDragDrop:function(){this.headerCt.dragging=!1,this.callParent(arguments)},afterRepair:function(){this.callParent(),this.headerCt.dragging=!1},getRepairXY:function(){return this.dragData.header.el.getXY()},disable:function(){this.disabled=!0},enable:function(){this.disabled=!1}}),Ext.define("Ext.grid.header.DropZone",{extend:"Ext.dd.DropZone",colHeaderCls:Ext.baseCSSPrefix+"column-header",proxyOffsets:[-4,-9],constructor:function(a){this.headerCt=a,this.ddGroup=this.getDDGroup(),this.callParent([a.el])},getDDGroup:function(){return"header-dd-zone-"+this.headerCt.up("[scrollerOwner]").id},getTargetFromEvent:function(a){return a.getTarget("."+this.colHeaderCls)},getTopIndicator:function(){return this.topIndicator||(this.topIndicator=Ext.DomHelper.append(Ext.getBody(),{cls:"col-move-top",html:"&#160;"},!0)),this.topIndicator},getBottomIndicator:function(){return this.bottomIndicator||(this.bottomIndicator=Ext.DomHelper.append(Ext.getBody(),{cls:"col-move-bottom",html:"&#160;"},!0)),this.bottomIndicator},getLocation:function(a,b){var c=a.getXY()[0],d=Ext.fly(b).getRegion(),e,f;return d.right-c<=(d.right-d.left)/2?e="after":e="before",{pos:e,header:Ext.getCmp(b.id),node:b}},positionIndicator:function(a,b,c){var d=this.getLocation(c,b),e=d.header,f=d.pos,g=a.nextSibling("gridcolumn:not([hidden])"),h=a.previousSibling("gridcolumn:not([hidden])"),i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(!e.draggable&&e.getIndex()===0)return!1;this.lastLocation=d;if(a!==e&&(f==="before"&&g!==e||f==="after"&&h!==e)&&!e.isDescendantOf(a)){s=Ext.dd.DragDropManager.getRelated(this),t=s.length,u=0;for(;u<t;u++)v=s[u],v!==this&&v.invalidateDrop&&v.invalidateDrop();this.valid=!0,j=this.getTopIndicator(),k=this.getBottomIndicator(),f==="before"?(l="tl",m="bl"):(l="tr",m="br"),n=e.el.getAnchorXY(l),o=e.el.getAnchorXY(m),p=this.headerCt.el,q=p.getLeft(),r=p.getRight(),n[0]=Ext.Number.constrain(n[0],q,r),o[0]=Ext.Number.constrain(o[0],q,r),n[0]-=4,n[1]-=9,o[0]-=4,j.setXY(n),k.setXY(o),j.show(),k.show()}else this.invalidateDrop()},invalidateDrop:function(){this.valid=!1,this.hideIndicators()},onNodeOver:function(a,b,c,d){var e=this,f=e.headerCt,g=!0,h=d.header,i;return d.header.el.dom===a?g=!1:(i=e.getLocation(c,a).header,g=h.ownerCt===i.ownerCt||!h.ownerCt.sealed&&!i.ownerCt.sealed),g?e.positionIndicator(d.header,a,c):e.valid=!1,e.valid?e.dropAllowed:e.dropNotAllowed},hideIndicators:function(){this.getTopIndicator().hide(),this.getBottomIndicator().hide()},onNodeOut:function(){this.hideIndicators()},onNodeDrop:function(a,b,c,d){if(this.valid){this.invalidateDrop();var e=d.header,f=this.lastLocation,g=f.header,h=e.ownerCt,i=h.items.indexOf(e),j=g.ownerCt,k=j.items.indexOf(g),l=this.headerCt,m=l.getHeaderIndex(e),n=e.isGroupHeader?e.query(":not([isGroupHeader])").length:1,o=l.getHeaderIndex(g),p,q;f.pos==="after"&&(k++,o+=g.isGroupHeader?g.query(":not([isGroupHeader])").length:1),h!==j&&h.lockableInjected&&j.lockableInjected&&j.lockedCt?(q=h.up("[scrollerOwner]"),q.lock(e,k)):h!==j&&h.lockableInjected&&j.lockableInjected&&h.lockedCt?(q=h.up("[scrollerOwner]"),q.unlock(e,k)):(h===j&&k>i&&(k-=1),Ext.suspendLayouts(),h!==j&&(h.remove(e,!1),h.isGroupHeader&&(h.items.getCount()||(p=h.ownerCt,p.remove(h,!1),h.el.dom.parentNode.removeChild(h.el.dom)))),h===j?j.move(i,k):j.insert(k,e),j.isGroupHeader?j!==h&&(e.savedFlex=e.flex,delete e.flex,e.width=e.getWidth()):e.savedFlex&&(e.flex=e.savedFlex,delete e.width),l.purgeCache(),Ext.resumeLayouts(!0),l.onHeaderMoved(e,n,m,o),h.items.getCount()||h.destroy())}}}),Ext.define("Ext.grid.plugin.HeaderReorderer",{extend:"Ext.util.Observable",requires:["Ext.grid.header.DragZone","Ext.grid.header.DropZone"],alias:"plugin.gridheaderreorderer",init:function(a){this.headerCt=a,a.on({render:this.onHeaderCtRender,single:!0,scope:this})},destroy:function(){Ext.destroy(this.dragZone,this.dropZone)},onHeaderCtRender:function(){var a=this;a.dragZone=new Ext.grid.header.DragZone(a.headerCt),a.dropZone=new Ext.grid.header.DropZone(a.headerCt),a.disabled&&a.dragZone.disable()},enable:function(){this.disabled=!1,this.dragZone&&this.dragZone.enable()},disable:function(){this.disabled=!0,this.dragZone&&this.dragZone.disable()}}),Ext.define("Ext.grid.property.Property",{extend:"Ext.data.Model",alternateClassName:"Ext.PropGridProperty",fields:[{name:"name",type:"string"},{name:"value"}],idProperty:"name"}),Ext.define("Ext.grid.property.Store",{extend:"Ext.data.Store",alternateClassName:"Ext.grid.PropertyStore",sortOnLoad:!1,uses:["Ext.data.reader.Reader","Ext.data.proxy.Proxy","Ext.data.ResultSet","Ext.grid.property.Property"],constructor:function(a,b){var c=this;c.grid=a,c.source=b,c.callParent([{data:b,model:Ext.grid.property.Property,proxy:c.getProxy()}])},getProxy:function(){return this.proxy||(Ext.grid.property.Store.prototype.proxy=new Ext.data.proxy.Memory({model:Ext.grid.property.Property,reader:this.getReader()})),this.proxy},getReader:function(){return this.reader||(Ext.grid.property.Store.prototype.reader=new Ext.data.reader.Reader({model:Ext.grid.property.Property,buildExtractors:Ext.emptyFn,read:function(a){return this.readRecords(a)},readRecords:function(a){var b,c,d={records:[],success:!0};for(c in a)a.hasOwnProperty(c)&&(b=a[c],this.isEditableValue(b)&&d.records.push(new Ext.grid.property.Property({name:c,value:b},c)));return d.total=d.count=d.records.length,new Ext.data.ResultSet(d)},isEditableValue:function(a){return Ext.isPrimitive(a)||Ext.isDate(a)}})),this.reader},setSource:function(a){var b=this;b.source=a,b.suspendEvents(),b.removeAll(),b.proxy.data=a,b.load(),b.resumeEvents(),b.fireEvent("datachanged",b),b.fireEvent("refresh",b)},getProperty:function(a){return Ext.isNumber(a)?this.getAt(a):this.getById(a)},setValue:function(a,b,c){var d=this,e=d.getRec(a);e?(e.set("value",b),d.source[a]=b):c&&(d.source[a]=b,e=new Ext.grid.property.Property({name:a,value:b},a),d.add(e))},remove:function(a){var b=this.getRec(a);b&&(this.callParent([b]),delete this.source[a])},getRec:function(a){return this.getById(a)},getSource:function(){return this.source}}),Ext.define("Ext.layout.component.Body",{alias:["layout.body"],extend:"Ext.layout.component.Auto",type:"body",beginLayout:function(a){this.callParent(arguments),a.bodyContext=a.getEl("body")},calculateOwnerHeightFromContentHeight:function(a,b){var c=this.callParent(arguments);return a.targetContext!=a&&(c+=a.getPaddingInfo().height),c},calculateOwnerWidthFromContentWidth:function(a,b){var c=this.callParent(arguments);return a.targetContext!=a&&(c+=a.getPaddingInfo().width),c},measureContentWidth:function(a){return a.bodyContext.setWidth(a.bodyContext.el.dom.offsetWidth,!1)},measureContentHeight:function(a){return a.bodyContext.setHeight(a.bodyContext.el.dom.offsetHeight,!1)},publishInnerHeight:function(a,b){var c=b-a.getFrameInfo().height,d=a.targetContext;d!=a&&(c-=a.getPaddingInfo().height),a.bodyContext.setHeight(c,!a.heightModel.natural)},publishInnerWidth:function(a,b){var c=b-a.getFrameInfo().width,d=a.targetContext;d!=a&&(c-=a.getPaddingInfo().width),a.bodyContext.setWidth(c,!a.widthModel.natural)}}),Ext.define("Ext.layout.component.BoundList",{extend:"Ext.layout.component.Auto",alias:"layout.boundlist",type:"component",beginLayout:function(a){var b=this,c=b.owner,d=c.pagingToolbar;b.callParent(arguments),c.floating&&(a.savedXY=c.el.getXY(),c.el.setXY([-9999,-9999])),d&&(a.toolbarContext=a.context.getCmp(d)),a.listContext=a.getEl("listEl")},beginLayoutCycle:function(a){var b=this.owner;this.callParent(arguments),a.heightModel.auto&&(b.el.setHeight("auto"),b.listEl.setHeight("auto"))},getLayoutItems:function(){var a=this.owner.pagingToolbar;return a?[a]:[]},isValidParent:function(){return!0},finishedLayout:function(a){var b=a.savedXY;this.callParent(arguments),b&&this.owner.el.setXY(b)},measureContentWidth:function(a){return this.owner.listEl.getWidth()},measureContentHeight:function(a){return this.owner.listEl.getHeight()},publishInnerHeight:function(a,b){var c=a.toolbarContext,d=0;c&&(d=c.getProp("height")),d===undefined?this.done=!1:a.listContext.setHeight(b-a.getFrameInfo().height-d)},calculateOwnerHeightFromContentHeight:function(a){var b=this.callParent(arguments),c=a.toolbarContext;return c&&(b+=c.getProp("height")),b}}),Ext.define("Ext.layout.component.Button",{alias:["layout.button"],extend:"Ext.layout.component.Auto",type:"button",cellClsRE:/-btn-(tl|br)\b/,htmlRE:/<.*>/,constructor:function(){this.callParent(arguments),this.hackWidth=Ext.isIE&&(!Ext.isStrict||Ext.isIE6||Ext.isIE7),this.heightIncludesPadding=Ext.isIE6&&Ext.isStrict},beginLayout:function(a){this.callParent(arguments),this.cacheTargetInfo(a)},beginLayoutCycle:function(a){var b=this,c="",d=b.owner,e=d.btnEl,f=d.btnInnerEl,g=d.text,h;b.callParent(arguments),f.setStyle("overflow",c),a.widthModel.natural||d.el.setStyle("width",c),h=a.heightModel.shrinkWrap&&g&&b.htmlRE.test(g),e.setStyle("width",c),e.setStyle("height",h?"auto":c),f.setStyle("width",c),f.setStyle("height",h?"auto":c),f.setStyle("line-height",h?"normal":c),f.setStyle("padding-top",c),d.btnIconEl.setStyle("width",c)},calculateOwnerHeightFromContentHeight:function(a,b){return b},calculateOwnerWidthFromContentWidth:function(a,b){return b},measureContentWidth:function(a){var b=this,c=b.owner,d=c.btnEl,e=c.btnInnerEl,f=c.text,g,h,i,j,k,l;return c.text&&b.hackWidth&&d?(g=b.btnFrameWidth,f.indexOf(">")===-1&&(f=f.replace(/</g,"&lt;")),h=Ext.util.TextMetrics.measure(e,f),j=h.width+g+b.adjWidth,k=a.getEl("btnEl"),l=a.getEl("btnInnerEl"),i=(c.icon||c.iconCls)&&(c.iconAlign=="top"||c.iconAlign=="bottom"),a.setWidth(j),k.setWidth(h.width+g),l.setWidth(h.width+g),i&&c.btnIconEl.setWidth(h.width+g)):j=a.el.getWidth(),j},measureContentHeight:function(a){var b=this,c=b.owner,d=c.btnInnerEl,e=a.getEl("btnEl"),f=a.getEl("btnInnerEl"),g=b.minTextHeight,h=b.adjHeight,i=c.getText(),j,k,l;return c.vertical?(j=Ext.util.TextMetrics.measure(d,c.text).width,j+=b.btnFrameHeight+h,a.setHeight(j,!0,!0)):i&&b.htmlRE.test(i)?(k=d.getHeight(),k<g&&(l=Math.floor((g-k)/2),f.setHeight(g-(b.heightIncludesPadding?l:0)),f.setProp("padding-top",l),k=g),j=k+h):j=a.el.getHeight(),e.setHeight(j-h),j},publishInnerHeight:function(a,b){var c=this,d=c.owner,e=Ext.isNumber,f=a.getEl("btnEl"),g=d.btnInnerEl,h=a.getEl("btnInnerEl"),i=e(b)?b-c.adjHeight:b,j=c.btnFrameHeight,k=d.getText(),l,m;f.setHeight(i),h.setHeight(i),!d.vertical&&i>=0&&h.setProp("line-height",i-j+"px"),k&&c.htmlRE.test(k)&&(h.setProp("line-height","normal"),g.setStyle("line-height","normal"),l=Ext.util.TextMetrics.measure(g,k).height,m=Math.floor(Math.max(i-j-l,0)/2),h.setProp("padding-top",c.btnFrameTop+m),h.setHeight(i-(c.heightIncludesPadding?m:0)))},publishInnerWidth:function(a,b){var c=this,d=Ext.isNumber,e=a.getEl("btnEl"),f=a.getEl("btnInnerEl"),g=d(b)?b-c.adjWidth:b;e.setWidth(g),f.setWidth(g)},clearTargetCache:function(){delete this.adjWidth},cacheTargetInfo:function(a){var b=this,c=b.owner,d=c.scale,e,f,g,h,i;if(!("adjWidth"in b)||b.lastScale!==d)b.lastScale&&c.btnInnerEl.setStyle("line-height",""),b.lastScale=d,e=a.getPaddingInfo(),f=a.getFrameInfo(),g=a.getEl("btnWrap").getPaddingInfo(),h=a.getEl("btnInnerEl"),i=h.getPaddingInfo(),Ext.apply(b,{adjWidth:g.width+f.width+e.width,adjHeight:g.height+f.height+e.height,btnFrameWidth:i.width,btnFrameHeight:i.height,btnFrameTop:i.top,minTextHeight:parseInt(h.getStyle("line-height"),10)});b.callParent(arguments)}}),Ext.define("Ext.layout.component.Dock",{extend:"Ext.layout.component.Component",alias:"layout.dock",alternateClassName:"Ext.layout.component.AbstractDock",type:"dock",initializedBorders:-1,horizontalCollapsePolicy:{width:!0,x:!0},verticalCollapsePolicy:{height:!0,y:!0},finishRender:function(){var a=this,b,c;a.callParent(),b=a.getRenderTarget(),c=a.getDockedItems(),a.finishRenderItems(b,c)},isItemBoxParent:function(a){return!0},isItemShrinkWrap:function(a){return!0},dockOpposites:{top:"bottom",right:"left",bottom:"top",left:"right"},handleItemBorders:function(){var a=this,b=a.owner,c,d,e=a.borders,f=a.dockOpposites,g=b.dockedItems.generation,h,i,j,k,l,m=a.collapsed;if(a.initializedBorders==g||b.border&&!b.manageBodyBorders)return;a.initializedBorders=g,a.collapsed=!1,d=a.getLayoutItems(),a.collapsed=m,c={top:[],right:[],bottom:[],left:[]};for(h=0,i=d.length;h<i;h++){j=d[h],k=j.dock;if(j.ignoreBorderManagement)continue;c[k].satisfied||(c[k].push(j),c[k].satisfied=!0),!c.top.satisfied&&f[k]!=="top"&&c.top.push(j),!c.right.satisfied&&f[k]!=="right"&&c.right.push(j),!c.bottom.satisfied&&f[k]!=="bottom"&&c.bottom.push(j),!c.left.satisfied&&f[k]!=="left"&&c.left.push(j)}if(e)for(l in e)if(e.hasOwnProperty(l)){i=e[l].length;if(!b.manageBodyBorders){for(h=0;h<i;h++)e[l][h].removeCls(Ext.baseCSSPrefix+"docked-noborder-"+l);!e[l].satisfied&&!b.bodyBorder&&b.removeBodyCls(Ext.baseCSSPrefix+"docked-noborder-"+l)}else e[l].satisfied&&b.setBodyStyle("border-"+l+"-width","")}for(l in c)if(c.hasOwnProperty(l)){i=c[l].length;if(!b.manageBodyBorders){for(h=0;h<i;h++)c[l][h].addCls(Ext.baseCSSPrefix+"docked-noborder-"+l);(!c[l].satisfied&&!b.bodyBorder||b.bodyBorder===!1)&&b.addBodyCls(Ext.baseCSSPrefix+"docked-noborder-"+l)}else c[l].satisfied&&b.setBodyStyle("border-"+l+"-width","1px")}a.borders=c},beginLayout:function(a){var b=this,c=b.owner,d=b.getLayoutItems(),e=a.context,f=d.length,g=!1,h=!1,i,j,k,l,m,n;b.callParent(arguments),b.handleItemBorders(),n=c.getCollapsed(),Ext.isDefined(b.lastCollapsedState)&&n!==b.lastCollapsedState&&(b.owner.collapsed?(a.isCollapsingOrExpanding=1,c.addClsWithUI(c.collapsedCls)):(a.isCollapsingOrExpanding=2,c.removeClsWithUI(c.collapsedCls),a.lastCollapsedState=b.lastCollapsedState)),b.lastCollapsedState=n,a.dockedItems=i=[];for(j=0;j<f;j++)k=d[j],l=e.getCmp(k),l.dockedAt={x:0,y:0},l.offsets=m=Ext.Element.parseBox(k.offsets||{}),m.width=m.left+m.right,m.height=m.top+m.bottom,i.push(l);c.collapsed&&(c.collapsedVertical()?(g=!0,a.measureDimensions=1):(h=!0,a.measureDimensions=2)),a.collapsedVert=g,a.collapsedHorz=h,a.bodyContext=a.getEl("body")},beginLayoutCycle:function(a){var b=this,c=a.dockedItems,d=c.length,e=b.owner,f=e.frameBody,g=b.lastHeightModel,h,i,j;b.callParent(arguments),a.collapsedVert?a.heightModel=b.sizeModels.shrinkWrap:a.collapsedHorz&&(a.widthModel=b.sizeModels.shrinkWrap),g&&g.shrinkWrap&&!a.heightModel.shrinkWrap&&!b.owner.manageHeight&&(e.body.dom.style.marginBottom=""),a.widthModel.auto&&(a.widthModel.shrinkWrap&&e.el.setWidth(null),e.body.setWidth(null),f&&f.setWidth(null)),a.heightModel.auto&&(e.body.setHeight(null),f&&f.setHeight(null)),a.collapsedVert?a.setContentHeight(0):a.collapsedHorz&&a.setContentWidth(0);for(h=0;h<d;h++){i=c[h].target,j=i.dock;if(j=="right")i.el.setLeft(0);else if(j!="left")continue}},calculate:function(a){var b=this,c=b.measureAutoDimensions(a,a.measureDimensions),d=a.state,e=d.horzDone,f=d.vertDone,g=a.bodyContext,h,i,j,k;a.borderInfo||a.getBorderInfo(),a.paddingInfo||a.getPaddingInfo(),a.framingInfo||a.getFraming(),g.borderInfo||g.getBorderInfo(),g.paddingInfo||g.getPaddingInfo(),h=!e&&b.createAxis(a,c.contentWidth,a.widthModel,"left","right","x","width","Width",a.collapsedHorz),i=!f&&b.createAxis(a,c.contentHeight,a.heightModel,"top","bottom","y","height","Height",a.collapsedVert);for(j=0,k=a.dockedItems.length;k--;++j)h&&b.dockChild(a,h,k,j),i&&b.dockChild(a,i,k,j);h&&b.finishAxis(a,h)&&(d.horzDone=e=h),i&&b.finishAxis(a,i)&&(d.vertDone=f=i),e&&f&&b.finishConstraints(a,e,f)?b.finishPositions(a,e,f):b.done=!1},createAxis:function(a,b,c,d,e,f,g,h,i){var j=0,k=this.owner,l=k["max"+h],m=k["min"+h]||0,n=l!=null,o=a.state["constrained"+h],p=o!=null,q="set"+h,r,s,t,u,v;return c.shrinkWrap&&!p?i?v=0:(s=a.bodyContext,v=b+s.borderInfo[g]):(r=a.borderInfo,t=a.framingInfo,u=a.paddingInfo,p?(v=o,c=this.sizeModels.calculated,a[q](o)):v=a.getProp(g),v-=r[e]+u[e]+t[e],j=r[d]+u[d]+t[d]),{shrinkWrap:c.shrinkWrap,sizeModel:c,begin:j,end:v,collapsed:i,horizontal:f=="x",ignoreFrameBegin:!1,ignoreFrameEnd:!1,initialSize:v-j,hasMinMaxConstraints:(m||n)&&c.shrinkWrap,isConstrainedSize:p,minSize:m,maxSize:n?l:1e9,bodyPosProp:this.owner.manageHeight?f:"margin-"+d,dockBegin:d,dockEnd:e,posProp:f,sizeProp:g,sizePropCap:h,setSize:q,dockedPixelsEnd:0}},dockChild:function(a,b,c,d){var e=this,f=a.dockedItems[b.shrinkWrap?c:d],g=f.target,h=g.dock,i;g.ignoreParentFrame&&a.isCollapsingOrExpanding&&f.clearMarginCache(),h==b.dockBegin?b.shrinkWrap?i=e.dockOutwardBegin(a,f,g,b):i=e.dockInwardBegin(a,f,g,b):h==b.dockEnd?b.shrinkWrap?i=e.dockOutwardEnd(a,f,g,b):i=e.dockInwardEnd(a,f,g,b):i=e.dockStretch(a,f,g,b),f.dockedAt[b.posProp]=i},dockInwardBegin:function(a,b,c,d){var e=d.begin,f=d.sizeProp,g,h;return c.ignoreParentFrame&&(h=c.dock,e-=a.borderInfo[h]+a.paddingInfo[h]+a.framingInfo[h]),c.overlay||(g=b.getProp(f)+b.getMarginInfo()[f],d.begin+=g),e},dockInwardEnd:function(a,b,c,d){var e=d.sizeProp,f=b.getProp(e)+b.getMarginInfo()[e],g=d.end-f;return c.overlay||(d.end=g),c.ignoreParentFrame&&(g+=a.borderInfo[c.dock]+a.paddingInfo[c.dock]+a.framingInfo[c.dock]),g},dockOutwardBegin:function(a,b,c,d){var e=d.begin,f=d.sizeProp,g,h;return d.collapsed?d.ignoreFrameBegin=d.ignoreFrameEnd=!0:c.ignoreParentFrame&&(g=c.dock,e-=a.borderInfo[g]+a.paddingInfo[g]+a.framingInfo[g],d.ignoreFrameBegin=!0),c.overlay||(h=b.getProp(f)+b.getMarginInfo()[f],e-=h,d.begin=e),e},dockOutwardEnd:function(a,b,c,d){var e=d.end,f=d.sizeProp,g,h;return h=b.getProp(f)+b.getMarginInfo()[f],d.collapsed?d.ignoreFrameBegin=d.ignoreFrameEnd=!0:c.ignoreParentFrame&&(g=c.dock,e+=a.borderInfo[g]+a.paddingInfo[g]+a.framingInfo[g],d.ignoreFrameEnd=!0),c.overlay||(d.end=e+h,d.dockedPixelsEnd+=h),e},dockStretch:function(a,b,c,d){var e=c.dock,f=d.sizeProp,g=e=="top"||e=="bottom",h=b.offsets,i=a.borderInfo,j=a.paddingInfo,k=g?"right":"bottom",l=g?"left":"top",m=d.begin+h[l],n,o,p;return c.stretch!==!1&&(o=d.end-m-h[k],c.ignoreParentFrame&&(p=a.framingInfo,m-=i[l]+j[l]+p[l],o+=i[f]+j[f]+p[f]),n=b.getMarginInfo(),o-=n[f],b[d.setSize](o)),m},finishAxis:function(a,b){var c=b.end-b.begin,d=b.setSize,e=b.dockBegin,f=b.dockEnd,g=a.borderInfo,h=a.paddingInfo,i=a.framingInfo,j=h[e]+g[e]+i[e],k=a.bodyContext,l,m,n;return b.shrinkWrap?(b.delta=-b.begin,m=b.initialSize,b.ignoreFrameBegin?(b.delta-=g[e],l=-b.begin-j):(c+=j,b.delta+=h[e]+i[e],l=-b.begin),b.ignoreFrameEnd||(c+=h[f]+g[f]+i[f]),b.size=c,!b.horizontal&&!this.owner.manageHeight&&(n=!1)):(b.delta=-g[b.dockBegin],m=c,l=b.begin-j),k[d](m,n),k.setProp(b.bodyPosProp,l),!isNaN(c)},finishConstraints:function(a,b,c){var d=b.size<b.minSize,e=b.size>b.maxSize,f=c.size<c.minSize,g=c.size>c.maxSize,h=a.state,i=!0,j=this.sizeModels.configured,k;return b.shrinkWrap&&e&&c.shrinkWrap&&f?(h.constrainedWidth=b.maxSize,a.widthModel=j,i=!1):(b.shrinkWrap&&(e?(h.constrainedWidth=b.maxSize,a.widthModel=j,i=!1):d&&(h.constrainedWidth=b.minSize,a.widthModel=j,i=!1)),c.shrinkWrap&&(g?(h.constrainedHeight=c.maxSize,a.heightModel=j,i=!1):f&&(h.constrainedHeight=c.minSize,a.heightModel=j,i=!1))),i?(b.shrinkWrap&&a.setWidth(b.size),c.shrinkWrap&&(!a.collapsedVert&&!this.owner.manageHeight&&(k=!1,a.bodyContext.setProp("margin-bottom",c.dockedPixelsEnd)),a.setHeight(c.size,k))):a.invalidate({state:{constrainedWidth:h.constrainedWidth,constrainedHeight:h.constrainedHeight}}),i},finishPositions:function(a,b,c){var d=a.dockedItems,e=d.length,f=b.delta,g=c.delta,h,i;for(h=0;h<e;++h)i=d[h],i.setProp("x",f+i.dockedAt.x),i.setProp("y",g+i.dockedAt.y)},finishedLayout:function(a){var b=this,c=a.target;b.callParent(arguments),a.animatePolicy||(a.isCollapsingOrExpanding===1?c.afterCollapse(!1):a.isCollapsingOrExpanding===2&&c.afterExpand(!1))},getAnimatePolicy:function(a){var b=this,c,d;a.isCollapsingOrExpanding==1?c=b.lastCollapsedState:a.isCollapsingOrExpanding==2&&(c=a.lastCollapsedState);if(c=="left"||c=="right")d=b.horizontalCollapsePolicy;else if(c=="top"||c=="bottom")d=b.verticalCollapsePolicy;return d},getDockedItems:function(a,b){var c=this,d=c.owner.dockedItems.items,e=d&&d.length&&a!==!1,f,g,h,i,j,k;if(b==null)h=e?d.slice():d;else{h=[];for(i=0,k=d.length;i<k;++i)g=d[i].dock,j=g=="top"||g=="left",(b?j:!j)&&h.push(d[i]);e=e&&h.length}return e&&(f=(a=a||"render")=="render",Ext.Array.sort(h,function(b,d){var e,g;return f&&(e=c.owner.dockOrder[b.dock])!==(g=c.owner.dockOrder[d.dock])&&!(e+g)?e-g:(e=c.getItemWeight(b,a),g=c.getItemWeight(d,a),e!==undefined&&g!==undefined?e-g:0)})),h||[]},getItemWeight:function(a,b){var c=a.weight||this.owner.defaultDockWeights[a.dock];return c[b]||c},getLayoutItems:function(){var a=this,b,c,d,e,f;if(a.owner.collapsed)f=a.owner.getCollapsedDockedItems();else{b=a.getDockedItems("visual"),c=b.length,f=[];for(e=0;e<c;e++)d=b[e],d.hidden||f.push(d)}return f},measureContentWidth:function(a){var b=a.bodyContext;return b.el.getWidth()-b.getBorderInfo().width},measureContentHeight:function(a){var b=a.bodyContext;return b.el.getHeight()-b.getBorderInfo().height},redoLayout:function(a){var b=this,c=b.owner;a.isCollapsingOrExpanding==1?(c.reExpander&&c.reExpander.el.show(),c.addClsWithUI(c.collapsedCls),a.redo(!0)):a.isCollapsingOrExpanding==2&&(c.removeClsWithUI(c.collapsedCls),a.bodyContext.redo())},renderChildren:function(){var a=this,b=a.getDockedItems(),c=a.getRenderTarget();a.renderItems(b,c)},renderItems:function(a,b){var c=this,d=a.length,e=0,f=0,g,h=0,i=c.getRenderTarget().dom.childNodes,j=i.length,k,l,m,g;for(k=0,l=0;k<j;k++){m=i[k];if(Ext.fly(m).hasCls("x-resizable-handle"))break;for(l=0;l<d;l++){g=a[l];if(g.rendered&&g.el.dom===m)break}l===d&&h++}for(;e<d;e++,f++)g=a[e],e===f&&(g.dock==="right"||g.dock==="bottom")&&(f+=h),g&&!g.rendered?c.renderItem(g,b,f):c.isValidParent(g,b,f)||c.moveItem(g,b,f)},undoLayout:function(a){var b=this,c=b.owner;a.isCollapsingOrExpanding==1?(c.reExpander&&c.reExpander.el.hide(),c.removeClsWithUI(c.collapsedCls),a.undo(!0)):a.isCollapsingOrExpanding==2&&(c.addClsWithUI(c.collapsedCls),a.bodyContext.undo())},sizePolicy:{nostretch:{setsWidth:0,setsHeight:0},stretchH:{setsWidth:1,setsHeight:0},stretchV:{setsWidth:0,setsHeight:1},autoStretchH:{readsWidth:1,setsWidth:1,setsHeight:0},autoStretchV:{readsHeight:1,setsWidth:0,setsHeight:1}},getItemSizePolicy:function(a){var b=this.sizePolicy,c,d;return a.stretch===!1?b.nostretch:(c=a.dock,d=c=="left"||c=="right",d?b.stretchV:b.stretchH)},configureItem:function(a,b){this.callParent(arguments),a.addCls(Ext.baseCSSPrefix+"docked"),a.addClsWithUI("docked-"+a.dock)},afterRemove:function(a){this.callParent(arguments),this.itemCls&&a.el.removeCls(this.itemCls+"-"+a.dock);var b=a.el.dom;!a.destroying&&b&&b.parentNode.removeChild(b),this.childrenChanged=!0}}),Ext.define("Ext.layout.component.FieldSet",{extend:"Ext.layout.component.Body",alias:["layout.fieldset"],type:"fieldset",beginLayoutCycle:function(a){var b=a.target,c;this.callParent(arguments),b.collapsed&&(a.heightModel=this.sizeModels.shrinkWrap,a.setContentHeight(0),a.widthModel.shrinkWrap&&(c=b.lastComponentSize,a.setContentWidth(c&&c.contentWidth||100)))},calculateOwnerHeightFromContentHeight:function(a,b){return a.getProp("contentHeight")+a.getPaddingInfo().height+(a.target.legend?a.target.legend.getHeight():a.getBorderInfo().top)+a.getBorderInfo().bottom},publishInnerHeight:function(a,b){this.callParent(arguments),a.target.legend&&a.bodyContext.setHeight(a.bodyContext.getProp("height")-a.target.legend.getHeight(),!a.heightModel.natural)},getLayoutItems:function(){var a=this.owner.legend;return a?[a]:[]}}),Ext.define("Ext.layout.component.ProgressBar",{alias:["layout.progressbar"],extend:"Ext.layout.component.Auto",type:"progressbar",beginLayout:function(a){var b=this,c,d;b.callParent(arguments);if(!a.textEls){d=b.owner.textEl;if(d.isComposite){a.textEls=[],d=d.elements;for(c=d.length;c--;)a.textEls[c]=a.getEl(Ext.get(d[c]))}else a.textEls=[a.getEl("textEl")]}},calculate:function(a){var b=this,c,d,e;b.callParent(arguments);if(Ext.isNumber(e=a.getProp("width"))){e-=a.getBorderInfo().width,d=a.textEls;for(c=d.length;c--;)d[c].setWidth(e)}else b.done=!1}}),Ext.define("Ext.ProgressBar",{extend:"Ext.Component",alias:"widget.progressbar",requires:["Ext.Template","Ext.CompositeElement","Ext.TaskManager","Ext.layout.component.ProgressBar"],uses:["Ext.fx.Anim"],baseCls:Ext.baseCSSPrefix+"progress",animate:!1,text:"",waitTimer:null,childEls:["bar"],renderTpl:['<tpl if="internalText">','<div class="{baseCls}-text {baseCls}-text-back">{text}</div>',"</tpl>",'<div id="{id}-bar" class="{baseCls}-bar" style="width:{percentage}%">','<tpl if="internalText">','<div class="{baseCls}-text">',"<div>{text}</div>","</div>","</tpl>","</div>"],componentLayout:"progressbar",initComponent:function(){this.callParent(),this.addEvents("update")},initRenderData:function(){var a=this;return Ext.apply(a.callParent(),{internalText:!a.hasOwnProperty("textEl"),text:a.text||"&#160;",percentage:a.value?a.value*100:0})},onRender:function(){var a=this;a.callParent(arguments),a.textEl?(a.textEl=Ext.get(a.textEl),a.updateText(a.text)):a.textEl=a.el.select("."+a.baseCls+"-text")},updateProgress:function(a,b,c){var d=this,e=d.value;return d.value=a||0,b&&d.updateText(b),d.rendered&&!d.isDestroyed&&(c===!0||c!==!1&&d.animate?(d.bar.stopAnimation(),d.bar.animate(Ext.apply({from:{width:e*100+"%"},to:{width:d.value*100+"%"}},d.animate))):d.bar.setStyle("width",d.value*100+"%")),d.fireEvent("update",d,d.value,b),d},updateText:function(a){var b=this;return b.text=a,b.rendered&&b.textEl.update(b.text),b},applyText:function(a){this.updateText(a)},getText:function(){return this.text},wait:function(a){var b=this,c;return b.waitTimer||(c=b,a=a||{},b.updateText(a.text),b.waitTimer=Ext.TaskManager.start({run:function(c){var d=a.increment||10;c-=1,b.updateProgress(((c+d)%d+1)*(100/d)*.01,null,a.animate)},interval:a.interval||1e3,duration:a.duration,onStop:function(){a.fn&&a.fn.apply(a.scope||b),b.reset()},scope:c})),b},isWaiting:function(){return this.waitTimer!==null},reset:function(a){var b=this;return b.updateProgress(0),b.clearTimer(),a===!0&&b.hide(),b},clearTimer:function(){var a=this;a.waitTimer&&(a.waitTimer.onStop=null,Ext.TaskManager.stop(a.waitTimer),a.waitTimer=null)},onDestroy:function(){var a=this;a.clearTimer(),a.rendered&&(a.textEl.isComposite&&a.textEl.clear(),Ext.destroyMembers(a,"textEl","progressBar")),a.callParent()}}),Ext.define("Ext.layout.component.Tab",{extend:"Ext.layout.component.Button",alias:"layout.tab",beginLayout:function(a){var b=this,c=b.owner.closable;b.lastClosable!==c&&(b.lastClosable=c,b.clearTargetCache()),b.callParent(arguments)}}),Ext.define("Ext.layout.component.field.Field",{extend:"Ext.layout.component.Auto",alias:"layout.field",uses:["Ext.tip.QuickTip","Ext.util.TextMetrics","Ext.util.CSS"],type:"field",beginLayout:function(a){var b=this,c=b.owner,d=a.widthModel,e;b.callParent(arguments),a.labelStrategy=b.getLabelStrategy(),a.errorStrategy=b.getErrorStrategy(),a.labelContext=a.getEl("labelEl"),a.bodyCellContext=a.getEl("bodyEl"),a.inputContext=a.getEl("inputEl"),a.errorContext=a.getEl("errorEl"),a.inputRow=a.getEl("inputRow"),(Ext.isIE6||Ext.isIE7)&&Ext.isStrict&&a.inputContext&&(b.ieInputWidthAdjustment=a.inputContext.getPaddingInfo().width+a.inputContext.getBorderInfo().width),a.labelStrategy.prepare(a,c),a.errorStrategy.prepare(a,c),d.shrinkWrap?b.beginLayoutShrinkWrap(a):d.natural?(typeof c.size=="number"?b.beginLayoutFixed(a,e=c.size*6.5+20,"px"):b.beginLayoutShrinkWrap(a),a.setWidth(e,!1)):b.beginLayoutFixed(a,"100","%")},beginLayoutFixed:function(a,b,c){var d=a.target;d.el.setStyle("table-layout","fixed"),d.bodyEl.setStyle("width",b+c)},beginLayoutShrinkWrap:function(a){var b=a.target;b.inputEl&&b.inputEl.dom&&b.inputEl.dom.removeAttribute("size"),b.el.setStyle("table-layout","auto"),b.bodyEl.setStyle("width","")},finishedLayout:function(a){var b=this.owner;this.callParent(arguments),a.labelStrategy.finishedLayout(a,b),a.errorStrategy.finishedLayout(a,b)},calculateOwnerHeightFromContentHeight:function(a,b){return b},measureContentHeight:function(a){return a.el.getHeight()},measureContentWidth:function(a){return a.el.getWidth()},measureLabelErrorHeight:function(a){return a.labelStrategy.getHeight(a)+a.errorStrategy.getHeight(a)},onFocus:function(){this.getErrorStrategy().onFocus(this.owner)},getLabelStrategy:function(){var a=this,b=a.labelStrategies,c=a.owner.labelAlign;return b[c]||b.base},getErrorStrategy:function(){var a=this,b=a.owner,c=a.errorStrategies,d=b.msgTarget;return!b.preventMark&&Ext.isString(d)?c[d]||c.elementId:c.none},labelStrategies:function(){var a={prepare:function(a,b){var c=b.labelCls+"-"+b.labelAlign,d=b.labelEl;d&&d.addCls(c)},getHeight:function(){return 0},finishedLayout:Ext.emptyFn};return{base:a,top:Ext.applyIf({prepare:function(b,c){a.prepare(b,c);var d=c.labelEl;b.hasHiddenLabel=d&&!c.hideEmptyLabel&&!c.getFieldLabel(),b.hasHiddenLabel&&(d.dom.innerHTML="&#160;")},getHeight:function(a){var b=a.labelContext,c=b.getProp("height"),d=a.hasHiddenLabel;if(c===undefined||d)c=b.el.getHeight()+b.getMarginInfo().height,d&&b.setHeight(c);return c},finishedLayout:function(a,b){a.hasHiddenLabel&&(b.labelEl.dom.innerHTML="")}},a),left:a,right:a}}(),errorStrategies:function(){function a(a){var b=Ext.layout.component.field.Field.tip,c;b&&b.isVisible()&&(c=b.activeTarget,c&&c.el===a.getActionEl().dom&&b.toFront(!0))}var b=Ext.applyIf,c=Ext.emptyFn,d=Ext.baseCSSPrefix+"form-invalid-icon",e,f={prepare:function(a,b){var c=b.errorEl;c&&c.setDisplayed(!1)},getHeight:function(){return 0},onFocus:c,finishedLayout:c};return{none:f,side:b({prepare:function(a,b){var c=b.errorEl,f;e||(e=(f=Ext.getBody().createChild({style:"position:absolute",cls:d})).getWidth(),f.remove()),c.addCls(d),c.set({"data-errorqtip":b.getActiveError()||""}),c.setDisplayed(b.hasActiveError()),b.bodyEl.dom.colSpan=b.getBodyColspan(),Ext.layout.component.field.Field.initTip()},onFocus:a},f),under:b({prepare:function(a,b){var c=b.errorEl,d=Ext.baseCSSPrefix+"form-invalid-under";c.addCls(d),c.setDisplayed(b.hasActiveError()),b.labelAlign=="left"&&c.prev().setDisplayed(b.hasVisibleLabel()?"block":"none")},getHeight:function(a){var b=0,c,d;return a.target.hasActiveError()&&(c=a.errorContext,d=c.props,b=d.height,b===undefined&&(d.height=b=c.el.getHeight())),b}},f),qtip:b({prepare:function(a,b){Ext.layout.component.field.Field.initTip(),b.getActionEl().set({"data-errorqtip":b.getActiveError()||""})},onFocus:a},f),title:b({prepare:function(a,b){b.el.set({title:b.getActiveError()||""})}},f),elementId:b({prepare:function(a,b){var c=Ext.fly(b.msgTarget);c&&(c.dom.innerHTML=b.getActiveError()||"",c.setDisplayed(b.hasActiveError()))}},f)}}(),statics:{initTip:function(){var a=this.tip;a||(a=this.tip=Ext.create("Ext.tip.QuickTip",{baseCls:Ext.baseCSSPrefix+"form-invalid-tip"}),a.tagConfig=Ext.apply({},{attribute:"errorqtip"},a.tagConfig))},destroyTip:function(){var a=this.tip;a&&(a.destroy(),delete this.tip)}}}),Ext.define("Ext.form.field.Base",{extend:"Ext.Component",mixins:{labelable:"Ext.form.Labelable",field:"Ext.form.field.Field"},alias:"widget.field",alternateClassName:["Ext.form.Field","Ext.form.BaseField"],requires:["Ext.util.DelayedTask","Ext.XTemplate","Ext.layout.component.field.Field"],fieldSubTpl:['<input id="{id}" type="{type}" {inputAttrTpl}',' size="1"','<tpl if="name"> name="{name}"</tpl>','<tpl if="value"> value="{[Ext.util.Format.htmlEncode(values.value)]}"</tpl>','<tpl if="placeholder"> placeholder="{placeholder}"</tpl>','<tpl if="maxLength !== undefined"> maxlength="{maxLength}"</tpl>','<tpl if="readOnly"> readonly="readonly"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' class="{fieldCls} {typeCls} {editableCls}" autocomplete="off"/>',{disableFormats:!0}],subTplInsertions:["inputAttrTpl"],inputType:"text",invalidText:"The value in this field is invalid",fieldCls:Ext.baseCSSPrefix+"form-field",focusCls:"form-focus",dirtyCls:Ext.baseCSSPrefix+"form-dirty",checkChangeEvents:Ext.isIE&&(!document.documentMode||document.documentMode<9)?["change","propertychange"]:["change","input","textInput","keyup","dragdrop"],checkChangeBuffer:50,componentLayout:"field",readOnly:!1,readOnlyCls:Ext.baseCSSPrefix+"form-readonly",validateOnBlur:!0,hasFocus:!1,baseCls:Ext.baseCSSPrefix+"field",maskOnDisable:!1,initComponent:function(){var a=this;a.callParent(),a.subTplData=a.subTplData||{},a.addEvents("specialkey","writeablechange"),a.initLabelable(),a.initField(),a.name||(a.name=a.getInputId())},beforeRender:function(){var a=this;a.callParent(arguments),a.beforeLabelableRender(arguments),a.readOnly&&a.addCls(a.readOnlyCls)},getInputId:function(){return this.inputId||(this.inputId=this.id+"-inputEl")},getSubTplData:function(){var a=this,b=a.inputType,c=a.getInputId(),d;return d=Ext.apply({id:c,cmpId:a.id,name:a.name||c,disabled:a.disabled,readOnly:a.readOnly,value:a.getRawValue(),type:b,fieldCls:a.fieldCls,fieldStyle:a.getFieldStyle(),tabIdx:a.tabIndex,typeCls:Ext.baseCSSPrefix+"form-"+(b==="password"?"text":b)},a.subTplData),a.getInsertionRenderData(d,a.subTplInsertions),d},afterFirstLayout:function(){this.callParent();var a=this.inputEl;a&&a.selectable()},applyRenderSelectors:function(){var a=this;a.callParent(),a.inputEl=a.el.getById(a.getInputId())},getSubTplMarkup:function(){return this.getTpl("fieldSubTpl").apply(this.getSubTplData())},initRenderTpl:function(){var a=this;return a.hasOwnProperty("renderTpl")||(a.renderTpl=a.getTpl("labelableRenderTpl")),a.callParent()},initRenderData:function(){return Ext.applyIf(this.callParent(),this.getLabelableRenderData())},setFieldStyle:function(a){var b=this,c=b.inputEl;c&&c.applyStyles(a),b.fieldStyle=a},getFieldStyle:function(){return"width:100%;"+(Ext.isObject(this.fieldStyle)?Ext.DomHelper.generateStyles(this.fieldStyle):this.fieldStyle||"")},onRender:function(){var a=this;a.callParent(arguments),a.onLabelableRender(),a.renderActiveError()},getFocusEl:function(){return this.inputEl},isFileUpload:function(){return this.inputType==="file"},extractFileInput:function(){var a=this,b=a.isFileUpload()?a.inputEl.dom:null,c;return b&&(c=b.cloneNode(!0),b.parentNode.replaceChild(c,b),a.inputEl=Ext.get(c)),b},getSubmitData:function(){var a=this,b=null,c;return!a.disabled&&a.submitValue&&!a.isFileUpload()&&(c=a.getSubmitValue(),c!==null&&(b={},b[a.getName()]=c)),b},getSubmitValue:function(){return this.processRawValue(this.getRawValue())},getRawValue:function(){var a=this,b=a.inputEl?a.inputEl.getValue():Ext.value(a.rawValue,"");return a.rawValue=b,b},setRawValue:function(a){var b=this;return a=Ext.value(a,""),b.rawValue=a,b.inputEl&&(b.inputEl.dom.value=a),a},valueToRaw:function(a){return""+Ext.value(a,"")},rawToValue:function(a){return a},processRawValue:function(a){return a},getValue:function(){var a=this,b=a.rawToValue(a.processRawValue(a.getRawValue()));return a.value=b,b},setValue:function(a){var b=this;return b.setRawValue(b.valueToRaw(a)),b.mixins.field.setValue.call(b,a)},onBoxReady:function(){var a=this;a.callParent(),a.setReadOnlyOnBoxReady&&a.setReadOnly(a.readOnly)},onDisable:function(){var a=this,b=a.inputEl;a.callParent(),b&&(b.dom.disabled=!0,a.hasActiveError()&&(a.clearInvalid(),a.needsValidateOnEnable=!0))},onEnable:function(){var a=this,b=a.inputEl;a.callParent(),b&&(b.dom.disabled=!1,a.needsValidateOnEnable&&(delete a.needsValidateOnEnable,a.forceValidation=!0,a.isValid(),delete a.forceValidation))},setReadOnly:function(a){var b=this,c=b.inputEl;a=!!a,b[a?"addCls":"removeCls"](b.readOnlyCls),b.readOnly=a,c?c.dom.readOnly=a:b.rendering&&(b.setReadOnlyOnBoxReady=!0),b.fireEvent("writeablechange",b,a)},fireKey:function(a){a.isSpecialKey()&&this.fireEvent("specialkey",this,new Ext.EventObjectImpl(a))},initEvents:function(){var a=this,b=a.inputEl,c,d,e=a.checkChangeEvents,f,g=e.length,h;a.inEditor&&(a.onBlur=Ext.Function.createBuffered(a.onBlur,10));if(b){a.mon(b,Ext.EventManager.getKeyEvent(),a.fireKey,a),c=new Ext.util.DelayedTask(a.checkChange,a),a.onChangeEvent=d=function(){c.delay(a.checkChangeBuffer)};for(f=0;f<g;f++)h=e[f],h==="propertychange"&&(a.usesPropertychange=!0),a.mon(b,h,d)}a.callParent()},doComponentLayout:function(){var a=this,b=a.inputEl,c=a.usesPropertychange,d="propertychange",e=a.onChangeEvent;c&&a.mun(b,d,e),a.callParent(arguments),c&&a.mon(b,d,e)},onDirtyChange:function(a){this[a?"addCls":"removeCls"](this.dirtyCls)},isValid:function(){var a=this,b=a.disabled,c=a.forceValidation||!b;return c?a.validateValue(a.processRawValue(a.getRawValue())):b},validateValue:function(a){var b=this,c=b.getErrors(a),d=Ext.isEmpty(c);return b.preventMark||(d?b.clearInvalid():b.markInvalid(c)),d},markInvalid:function(a){var b=this,c=b.getActiveError();b.setActiveErrors(Ext.Array.from(a)),c!==b.getActiveError()&&b.updateLayout()},clearInvalid:function(){var a=this,b=a.hasActiveError();a.unsetActiveError(),b&&a.updateLayout()},renderActiveError:function(){var a=this,b=a.hasActiveError();a.inputEl&&a.inputEl[b?"addCls":"removeCls"](a.invalidCls+"-field"),a.mixins.labelable.renderActiveError.call(a)},getActionEl:function(){return this.inputEl||this.el}}),Ext.define("Ext.form.field.Checkbox",{extend:"Ext.form.field.Base",alias:["widget.checkboxfield","widget.checkbox"],alternateClassName:"Ext.form.Checkbox",requires:["Ext.XTemplate","Ext.form.CheckboxManager"],componentLayout:"field",childEls:["boxLabelEl"],fieldSubTpl:["<tpl if=\"boxLabel && boxLabelAlign == 'before'\">","{beforeBoxLabelTpl}",'<label id="{cmpId}-boxLabelEl" {boxLabelAttrTpl} class="{boxLabelCls} {boxLabelCls}-{boxLabelAlign}" for="{id}">',"{beforeBoxLabelTextTpl}","{boxLabel}","{afterBoxLabelTextTpl}","</label>","{afterBoxLabelTpl}","</tpl>",'<input type="button" id="{id}" {inputAttrTpl}','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' class="{fieldCls} {typeCls}" autocomplete="off" hidefocus="true" />',"<tpl if=\"boxLabel && boxLabelAlign == 'after'\">","{beforeBoxLabelTpl}",'<label id="{cmpId}-boxLabelEl" {boxLabelAttrTpl} class="{boxLabelCls} {boxLabelCls}-{boxLabelAlign}" for="{id}">',"{beforeBoxLabelTextTpl}","{boxLabel}","{afterBoxLabelTextTpl}","</label>","{afterBoxLabelTpl}","</tpl>",{disableFormats:!0,compiled:!0}],subTplInsertions:["beforeBoxLabelTpl","afterBoxLabelTpl","beforeBoxLabelTextTpl","afterBoxLabelTextTpl","boxLabelAttrTpl","inputAttrTpl"],isCheckbox:!0,focusCls:"form-cb-focus",fieldBodyCls:Ext.baseCSSPrefix+"form-cb-wrap",checked:!1,checkedCls:Ext.baseCSSPrefix+"form-cb-checked",boxLabelCls:Ext.baseCSSPrefix+"form-cb-label",boxLabelAlign:"after",inputValue:"on",checkChangeEvents:[],inputType:"checkbox",onRe:/^on$/i,initComponent:function(){this.callParent(arguments),this.getManager().add(this)},initValue:function(){var a=this,b=!!a.checked;a.originalValue=a.lastValue=b,a.setValue(b)},getElConfig:function(){var a=this;return a.isChecked(a.rawValue,a.inputValue)&&a.addCls(a.checkedCls),a.callParent()},getFieldStyle:function(){return Ext.isObject(this.fieldStyle)?Ext.DomHelper.generateStyles(this.fieldStyle):this.fieldStyle||""},getSubTplData:function(){var a=this;return Ext.apply(a.callParent(),{disabled:a.readOnly||a.disabled,boxLabel:a.boxLabel,boxLabelCls:a.boxLabelCls,boxLabelAlign:a.boxLabelAlign})},initEvents:function(){var a=this;a.callParent(),a.mon(a.inputEl,"click",a.onBoxClick,a)},onBoxClick:function(a){var b=this;!b.disabled&&!b.readOnly&&this.setValue(!this.checked)},getRawValue:function(){return this.checked},getValue:function(){return this.checked},getSubmitValue:function(){var a=this.uncheckedValue,b=Ext.isDefined(a)?a:null;return this.checked?this.inputValue:b},isChecked:function(a,b){return a===!0||a==="true"||a==="1"||a===1||((Ext.isString(a)||Ext.isNumber(a))&&b?a==b:this.onRe.test(a))},setRawValue:function(a){var b=this,c=b.inputEl,d=b.isChecked(a,b.inputValue);return c&&b[d?"addCls":"removeCls"](b.checkedCls),b.checked=b.rawValue=d,d},setValue:function(a){var b=this,c,d,e,f;if(Ext.isArray(a)){c=b.getManager().getByName(b.name,b.getFormId()).items,e=c.length;for(d=0;d<e;++d)f=c[d],f.setValue(Ext.Array.contains(a,f.inputValue))}else b.callParent(arguments);return b},valueToRaw:function(a){return a},onChange:function(a,b){var c=this,d=c.handler;d&&d.call(c.scope||c,c,a),c.callParent(arguments)},resetOriginalValue:function(a){var b=this,c,d,e,f;if(!a){c=b.getManager().getByName(b.name,b.getFormId()).items,e=c.length;for(f=0;f<e;++f)d=c[f],d!==b&&c[f].resetOriginalValue(!0)}b.callParent()},beforeDestroy:function(){this.callParent(),this.getManager().removeAtKey(this.id)},getManager:function(){return Ext.form.CheckboxManager},onEnable:function(){var a=this,b=a.inputEl;a.callParent(),b&&(b.dom.disabled=a.readOnly)},setReadOnly:function(a){var b=this,c=b.inputEl;c&&(c.dom.disabled=!!a||b.disabled),b.callParent(arguments)},getFormId:function(){var a=this,b;return a.formId||(b=a.up("form"),b&&(a.formId=b.id)),a.formId}}),Ext.define("Ext.form.field.Display",{extend:"Ext.form.field.Base",alias:"widget.displayfield",requires:["Ext.util.Format","Ext.XTemplate"],alternateClassName:["Ext.form.DisplayField","Ext.form.Display"],fieldSubTpl:['<div id="{id}"','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' class="{fieldCls}">{value}</div>',{compiled:!0,disableFormats:!0}],fieldCls:Ext.baseCSSPrefix+"form-display-field",htmlEncode:!1,validateOnChange:!1,initEvents:Ext.emptyFn,submitValue:!1,isDirty:function(){return!1},isValid:function(){return!0},validate:function(){return!0},getRawValue:function(){return this.rawValue},setRawValue:function(a){var b=this,c;return a=Ext.value(a,""),b.rawValue=a,b.rendered&&(b.inputEl.dom.innerHTML=b.getDisplayValue()),a},getDisplayValue:function(){var a=this,b=this.getRawValue(),c;return a.renderer?c=a.renderer.call(a.scope||a,b,a):c=a.htmlEncode?Ext.util.Format.htmlEncode(b):b,c},getSubTplData:function(){var a=this.callParent(arguments);return a.value=this.getDisplayValue(),a}}),Ext.define("Ext.form.field.Hidden",{extend:"Ext.form.field.Base",alias:["widget.hiddenfield","widget.hidden"],alternateClassName:"Ext.form.Hidden",inputType:"hidden",hideLabel:!0,initComponent:function(){this.formItemCls+="-hidden",this.callParent()},isEqual:function(a,b){return this.isEqualAsString(a,b)},initEvents:Ext.emptyFn,setSize:Ext.emptyFn,setWidth:Ext.emptyFn,setHeight:Ext.emptyFn,setPosition:Ext.emptyFn,setPagePosition:Ext.emptyFn,markInvalid:Ext.emptyFn,clearInvalid:Ext.emptyFn}),Ext.define("Ext.form.field.Radio",{extend:"Ext.form.field.Checkbox",alias:["widget.radiofield","widget.radio"],alternateClassName:"Ext.form.Radio",requires:["Ext.form.RadioManager"],isRadio:!0,inputType:"radio",ariaRole:"radio",formId:null,getGroupValue:function(){var a=this.getManager().getChecked(this.name,this.getFormId());return a?a.inputValue:null},onBoxClick:function(a){var b=this;!b.disabled&&!b.readOnly&&this.setValue(!0)},onRemoved:function(){this.callParent(arguments),this.formId=null},setValue:function(a){var b=this,c;return Ext.isBoolean(a)?b.callParent(arguments):(c=b.getManager().getWithValue(b.name,a,b.getFormId()).getAt(0),c&&c.setValue(!0)),b},getSubmitValue:function(){return this.checked?this.inputValue:null},getModelData:function(){return this.getSubmitData()},onChange:function(a,b){var c=this,d,e,f,g;c.callParent(arguments);if(a){g=c.getManager().getByName(c.name,c.getFormId()).items,e=g.length;for(d=0;d<e;d++)f=g[d],f!==c&&f.setValue(!1)}},getManager:function(){return Ext.form.RadioManager}}),Ext.define("Ext.layout.component.field.FieldContainer",{extend:"Ext.layout.component.field.Field",alias:"layout.fieldcontainer",type:"fieldcontainer",waitForOuterHeightInDom:!0,waitForOuterWidthInDom:!0,beginLayout:function(a){this.callParent(arguments),a.hasRawContent=!0,a.target.bodyEl.setStyle("height","")},measureContentHeight:function(a){return a.hasDomProp("containerLayoutDone")?this.callParent(arguments):NaN},measureContentWidth:function(a){return a.hasDomProp("containerLayoutDone")?this.callParent(arguments):NaN},publishInnerWidth:function(a,b){var c=a.bodyCellContext;c.setWidth(c.el.getWidth(),!1)},publishInnerHeight:function(a,b){var c=a.bodyCellContext;c.setHeight(b-this.measureLabelErrorHeight(a))}}),Ext.define("Ext.layout.component.field.HtmlEditor",{extend:"Ext.layout.component.field.Field",alias:["layout.htmleditor"],type:"htmleditor",toolbarSizePolicy:{setsWidth:0,setsHeight:0},beginLayout:function(a){this.callParent(arguments),a.textAreaContext=a.getEl("textareaEl"),a.iframeContext=a.getEl("iframeEl"),a.toolbarContext=a.context.getCmp(this.owner.getToolbar())},getItemSizePolicy:function(a){return this.toolbarSizePolicy},getLayoutItems:function(){var a=this.owner.getToolbar();return a?[a]:[]},getRenderTarget:function(){return this.owner.bodyEl},publishInnerHeight:function(a,b){var c=this,d=b-c.measureLabelErrorHeight(a)-a.toolbarContext.getProp("height")-a.bodyCellContext.getPaddingInfo().height;Ext.isNumber(d)?(a.textAreaContext.setHeight(d),a.iframeContext.setHeight(d)):c.done=!1}}),Ext.define("Ext.layout.component.field.Slider",{alias:["layout.sliderfield"],extend:"Ext.layout.component.field.Field",type:"sliderfield",beginLayout:function(a){this.callParent(arguments),a.endElContext=a.getEl("endEl"),a.innerElContext=a.getEl("innerEl"),a.bodyElContext=a.getEl("bodyEl")},publishInnerHeight:function(a,b){var c=b-this.measureLabelErrorHeight(a),d,e;this.owner.vertical?(d=a.endElContext.getPaddingInfo(),e=a.inputContext.getPaddingInfo(),a.innerElContext.setHeight(c-e.height-d.height)):a.bodyElContext.setHeight(c)},publishInnerWidth:function(a,b){if(!this.owner.vertical){var c=a.endElContext.getPaddingInfo(),d=a.inputContext.getPaddingInfo();a.innerElContext.setWidth(b-d.left-c.right-a.labelContext.getProp("width"))}},beginLayoutFixed:function(a,b,c){var d=this,e=d.ieInputWidthAdjustment;e&&d.owner.bodyEl.setStyle("padding-right",e+"px"),d.callParent(arguments)}}),Ext.define("Ext.layout.component.field.Text",{extend:"Ext.layout.component.field.Field",alias:"layout.textfield",requires:["Ext.util.TextMetrics"],type:"textfield",canGrowWidth:!0,beginLayoutCycle:function(a){var b=this;b.callParent(arguments),a.shrinkWrap&&a.inputContext.el.setStyle("height","")},measureContentWidth:function(a){var b=this,c=b.owner,d=b.callParent(arguments),e=a.inputContext,f,g,h,i,j;return c.grow&&b.canGrowWidth&&!a.state.growHandled&&(f=c.inputEl,g=Ext.util.Format.htmlEncode(f.dom.value||(c.hasFocus?"":c.emptyText)||""),g+=c.growAppend,h=f.getTextWidth(g)+e.getFrameInfo().width,i=c.growMax,j=Math.min(i,d),i=Math.max(c.growMin,i,j),h=Ext.Number.constrain(h,c.growMin,i),e.setWidth(h),a.state.growHandled=!0,e.domBlock(b,"width"),d=NaN),d},publishInnerHeight:function(a,b){a.inputContext.setHeight(b-this.measureLabelErrorHeight(a))},beginLayoutFixed:function(a,b,c){var d=this,e=d.ieInputWidthAdjustment;e&&(d.owner.bodyEl.setStyle("padding-right",e+"px"),c==="px"&&(b-=e)),d.callParent(arguments)}}),Ext.define("Ext.form.field.Text",{extend:"Ext.form.field.Base",alias:"widget.textfield",requires:["Ext.form.field.VTypes","Ext.layout.component.field.Text"],alternateClassName:["Ext.form.TextField","Ext.form.Text"],size:20,growMin:30,growMax:800,growAppend:"W",allowBlank:!0,minLength:0,maxLength:Number.MAX_VALUE,minLengthText:"The minimum length for this field is {0}",maxLengthText:"The maximum length for this field is {0}",blankText:"This field is required",regexText:"",emptyCls:Ext.baseCSSPrefix+"form-empty-field",componentLayout:"textfield",initComponent:function(){var a=this;a.callParent(),a.addEvents("autosize","keydown","keyup","keypress"),a.addStateEvents("change"),a.setGrowSizePolicy()},setGrowSizePolicy:function(){this.grow&&(this.shrinkWrap|=1)},initEvents:function(){var a=this,b=a.inputEl;a.callParent(),(a.selectOnFocus||a.emptyText)&&a.mon(b,"mousedown",a.onMouseDown,a),(a.maskRe||a.vtype&&a.disableKeyFilter!==!0&&(a.maskRe=Ext.form.field.VTypes[a.vtype+"Mask"]))&&a.mon(b,"keypress",a.filterKeys,a),a.enableKeyEvents&&a.mon(b,{scope:a,keyup:a.onKeyUp,keydown:a.onKeyDown,keypress:a.onKeyPress})},isEqual:function(a,b){return this.isEqualAsString(a,b)},onChange:function(){this.callParent(),this.autoSize()},getSubTplData:function(){var a=this,b=a.getRawValue(),c=a.emptyText&&b.length<1,d;return c&&(Ext.supports.Placeholder?d=a.emptyText:b=a.emptyText),Ext.apply(a.callParent(),{maxLength:a.enforceMaxLength?a.maxLength:undefined,readOnly:a.readOnly,placeholder:d,value:b,fieldCls:a.fieldCls+(c&&(d||b)?" "+a.emptyCls:"")})},afterRender:function(){this.autoSize(),this.callParent()},onMouseDown:function(a){var b=this;b.hasFocus||b.mon(b.inputEl,"mouseup",Ext.emptyFn,b,{single:!0,preventDefault:!0})},processRawValue:function(a){var b=this,c=b.stripCharsRe,d;return c&&(d=a.replace(c,""),d!==a&&(b.setRawValue(d),a=d)),a},onDisable:function(){this.callParent(),Ext.isIE&&(this.inputEl.dom.unselectable="on")},onEnable:function(){this.callParent(),Ext.isIE&&(this.inputEl.dom.unselectable="")},onKeyDown:function(a){this.fireEvent("keydown",this,a)},onKeyUp:function(a){this.fireEvent("keyup",this,a)},onKeyPress:function(a){this.fireEvent("keypress",this,a)},reset:function(){this.callParent(),this.applyEmptyText()},applyEmptyText:function(){var a=this,b=a.emptyText,c;a.rendered&&b&&(c=a.getRawValue().length<1&&!a.hasFocus,Ext.supports.Placeholder?a.inputEl.dom.placeholder=b:c&&a.setRawValue(b),c&&a.inputEl.addCls(a.emptyCls),a.autoSize())},afterFirstLayout:function(){this.callParent();if(Ext.isIE&&this.disabled){var a=this.inputEl;a&&(a.dom.unselectable="on")}},preFocus:function(){var a=this,b=a.inputEl,c=a.emptyText,d;a.callParent(arguments),c&&!Ext.supports.Placeholder&&b.dom.value===c?(a.setRawValue(""),d=!0,b.removeCls(a.emptyCls)):Ext.supports.Placeholder&&a.inputEl.removeCls(a.emptyCls),(a.selectOnFocus||d)&&b.dom.select()},onFocus:function(){var a=this;a.callParent(arguments),a.emptyText&&a.autoSize()},postBlur:function(){this.callParent(arguments),this.applyEmptyText()},filterKeys:function(a){if(a.ctrlKey&&!a.altKey)return;var b=a.getKey(),c=String.fromCharCode(a.getCharCode());if(Ext.isGecko&&(a.isNavKeyPress()||b===a.BACKSPACE||b===a.DELETE&&a.button===-1))return;if(!Ext.isGecko&&a.isSpecialKey()&&!c)return;this.maskRe.test(c)||a.stopEvent()},getState:function(){return this.addPropertyToState(this.callParent(),"value")},applyState:function(a){this.callParent(arguments),a.hasOwnProperty("value")&&this.setValue(a.value)},getRawValue:function(){var a=this,b=a.callParent();return b===a.emptyText&&(b=""),b},setValue:function(a){var b=this,c=b.inputEl;return c&&b.emptyText&&!Ext.isEmpty(a)&&c.removeCls(b.emptyCls),b.callParent(arguments),b.applyEmptyText(),b},getErrors:function(a){var b=this,c=b.callParent(arguments),d=b.validator,e=b.emptyText,f=b.allowBlank,g=b.vtype,h=Ext.form.field.VTypes,i=b.regex,j=Ext.String.format,k;return a=a||b.processRawValue(b.getRawValue()),Ext.isFunction(d)&&(k=d.call(b,a),k!==!0&&c.push(k)),a.length<1||a===e?(f||c.push(b.blankText),c):(a.length<b.minLength&&c.push(j(b.minLengthText,b.minLength)),a.length>b.maxLength&&c.push(j(b.maxLengthText,b.maxLength)),g&&(h[g](a,b)||c.push(b.vtypeText||h[g+"Text"])),i&&!i.test(a)&&c.push(b.regexText||b.invalidText),c)},selectText:function(a,b){var c=this,d=c.getRawValue(),e=!0,f=c.inputEl.dom,g,h;d.length>0&&(a=a===g?0:a,b=b===g?d.length:b,f.setSelectionRange?f.setSelectionRange(a,b):f.createTextRange&&(h=f.createTextRange(),h.moveStart("character",a),h.moveEnd("character",b-d.length),h.select()),e=Ext.isGecko||Ext.isOpera),e&&c.focus()},autoSize:function(){var a=this;a.grow&&a.rendered&&(a.autoSizing=!0,a.updateLayout())},afterComponentLayout:function(){var a=this,b;a.callParent(arguments),a.autoSizing&&(b=a.inputEl.getWidth(),b!==a.lastInputWidth&&(a.fireEvent("autosize",a,b),a.lastInputWidth=b,delete a.autoSizing))}}),Ext.define("Ext.layout.component.field.TextArea",{extend:"Ext.layout.component.field.Text",alias:"layout.textareafield",type:"textareafield",canGrowWidth:!1,beginLayout:function(a){this.callParent(arguments),a.target.inputEl.setStyle("height","")},measureContentHeight:function(a){var b=this,c=b.owner,d=b.callParent(arguments),e,f,g,h,i,j;return c.grow&&!a.state.growHandled&&(e=a.inputContext,f=c.inputEl,i=f.getWidth(!0),g=Ext.util.Format.htmlEncode(f.dom.value)||"&#160;",g+=c.growAppend,g=g.replace(/\n/g,"<br/>"),j=Ext.util.TextMetrics.measure(f,g,i).height+e.getBorderInfo().height+e.getPaddingInfo().height,j=Ext.Number.constrain(j,c.growMin,c.growMax),e.setHeight(j),a.state.growHandled=!0,e.domBlock(b,"height"),d=NaN),d}}),Ext.define("Ext.form.field.TextArea",{extend:"Ext.form.field.Text",alias:["widget.textareafield","widget.textarea"],alternateClassName:"Ext.form.TextArea",requires:["Ext.XTemplate","Ext.layout.component.field.TextArea","Ext.util.DelayedTask"],fieldSubTpl:['<textarea id="{id}" {inputAttrTpl}','<tpl if="name"> name="{name}"</tpl>','<tpl if="rows"> rows="{rows}" </tpl>','<tpl if="cols"> cols="{cols}" </tpl>','<tpl if="placeholder"> placeholder="{placeholder}"</tpl>','<tpl if="size"> size="{size}"</tpl>','<tpl if="maxLength !== undefined"> maxlength="{maxLength}"</tpl>','<tpl if="readOnly"> readonly="readonly"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>',' class="{fieldCls} {typeCls}" ','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',' autocomplete="off">\n','<tpl if="value">{[Ext.util.Format.htmlEncode(values.value)]}</tpl>',"</textarea>",{disableFormats:!0}],growMin:60,growMax:1e3,growAppend:"\n-",cols:20,rows:4,enterIsSpecial:!1,preventScrollbars:!1,componentLayout:"textareafield",setGrowSizePolicy:Ext.emptyFn,getSubTplData:function(){var a=this,b=a.getFieldStyle(),c=a.callParent();return a.grow&&a.preventScrollbars&&(c.fieldStyle=(b||"")+";overflow:hidden;height:"+a.growMin+"px"),Ext.applyIf(c,{cols:a.cols,rows:a.rows}),c},afterRender:function(){var a=this;a.callParent(arguments),a.needsMaxCheck=a.enforceMaxLength&&!Ext.supports.TextAreaMaxLength,a.needsMaxCheck&&a.inputEl.on("paste",a.onPaste,a)},onPaste:function(a){var b=this;b.pasteTask||(b.pasteTask=new Ext.util.DelayedTask(b.pasteCheck,b)),b.pasteTask.delay(1)},pasteCheck:function(){var a=this,b=a.getValue(),c=a.maxLength;b.length>c&&(b=b.substr(0,c),a.setValue(b))},fireKey:function(a){var b=this,c;a.isSpecialKey()&&(b.enterIsSpecial||a.getKey()!==a.ENTER||a.hasModifier())&&b.fireEvent("specialkey",b,a),b.needsMaxCheck&&a.getKey()!==a.BACKSPACE&&!a.isNavKeyPress()&&(c=b.getValue(),c.length>=b.maxLength&&a.stopEvent())},autoSize:function(){var a=this,b;a.grow&&a.rendered&&(a.updateLayout(),b=a.inputEl.getHeight(),b!==a.lastInputHeight&&(a.fireEvent("autosize",a,b),a.lastInputHeight=b))},initAria:function(){this.callParent(arguments),this.getActionEl().dom.setAttribute("aria-multiline",!0)},beforeDestroy:function(){var a=this.pasteTask;a&&a.delay(),this.callParent()}}),Ext.define("Ext.layout.component.field.Trigger",{alias:"layout.triggerfield",extend:"Ext.layout.component.field.Field",type:"triggerfield",beginLayout:function(a){var b=this,c=b.owner,d;a.triggerWrap=a.getEl("triggerWrap"),b.callParent(arguments),d=c.getTriggerStateFlags(),d!=c.lastTriggerStateFlags&&(c.lastTriggerStateFlags=d,b.updateEditState())},beginLayoutFixed:function(a,b,c){var d=this,e=a.target,f=d.ieInputWidthAdjustment,g="100%";d.callParent(arguments),e.inputCell.setStyle("width","100%"),f&&(e.inputCell.setStyle("padding-right",f+"px"),c==="px"&&(g=b-f-e.getTriggerWidth())),e.inputEl.setStyle("width",g),e.triggerWrap.setStyle("width",b+c),e.triggerWrap.setStyle("table-layout","fixed")},beginLayoutShrinkWrap:function(a){var b=a.target,c="";this.callParent(arguments),b.triggerWrap.setStyle("width",c),b.inputCell.setStyle("width",c),b.inputEl.setStyle("width",c),b.triggerWrap.setStyle("table-layout","auto")},getTextWidth:function(){var a=this,b=a.owner,c=b.inputEl,d;return d=(c.dom.value||(b.hasFocus?"":b.emptyText)||"")+b.growAppend,c.getTextWidth(d)},measureContentWidth:function(a){var b=this,c=b.owner,d=b.callParent(arguments),e=a.inputContext,f,g,h;return c.grow&&!a.state.growHandled&&(f=b.getTextWidth()+a.inputContext.getFrameInfo().width,g=c.growMax,h=Math.min(g,d),g=Math.max(c.growMin,g,h),f=Ext.Number.constrain(f,c.growMin,g),e.setWidth(f),a.state.growHandled=!0,e.domBlock(b,"width"),d=NaN),d},updateEditState:function(){var a=this,b=a.owner,c=b.inputEl,d=Ext.baseCSSPrefix+"trigger-noedit",e,f;a.owner.readOnly?(c.addCls(d),f=!0,e=!1):(a.owner.editable?(c.removeCls(d),f=!1):(c.addCls(d),f=!0),e=!a.owner.hideTrigger),b.triggerCell.setDisplayed(e),c.dom.readOnly=f}}),Ext.define("Ext.form.field.Trigger",{extend:"Ext.form.field.Text",alias:["widget.triggerfield","widget.trigger"],requires:["Ext.DomHelper","Ext.util.ClickRepeater","Ext.layout.component.field.Trigger"],alternateClassName:["Ext.form.TriggerField","Ext.form.TwinTriggerField","Ext.form.Trigger"],childEls:[{name:"triggerCell",select:"."+Ext.baseCSSPrefix+"trigger-cell"},{name:"triggerEl",select:"."+Ext.baseCSSPrefix+"form-trigger"},"triggerWrap","inputCell"],triggerBaseCls:Ext.baseCSSPrefix+"form-trigger",triggerWrapCls:Ext.baseCSSPrefix+"form-trigger-wrap",hideTrigger:!1,editable:!0,readOnly:!1,repeatTriggerClick:!1,autoSize:Ext.emptyFn,monitorTab:!0,mimicing:!1,triggerIndexRe:/trigger-index-(\d+)/,componentLayout:"triggerfield",initComponent:function(){this.wrapFocusCls=this.triggerWrapCls+"-focus",this.callParent(arguments)},getSubTplMarkup:function(){var a=this,b=a.callParent(arguments);return'<table id="'+a.id+'-triggerWrap" class="'+Ext.baseCSSPrefix+'form-trigger-wrap" cellpadding="0" cellspacing="0"><tbody><tr><td id="'+a.id+'-inputCell" class="'+Ext.baseCSSPrefix+'form-trigger-input-cell">'+b+"</td>"+a.getTriggerMarkup()+"</tr></tbody></table>"},getSubTplData:function(){var a=this,b=a.callParent(),c=a.readOnly===!0,d=a.editable!==!1;return Ext.apply(b,{editableCls:c||!d?" "+Ext.baseCSSPrefix+"trigger-noedit":"",readOnly:!d||c})},getLabelableRenderData:function(){var a=this,b=a.triggerWrapCls,c=a.callParent(arguments);return Ext.applyIf(c,{triggerWrapCls:b,triggerMarkup:a.getTriggerMarkup()})},getTriggerMarkup:function(){var a=this,b=0,c=a.readOnly||a.hideTrigger,d,e=a.triggerBaseCls,f=[];a.trigger1Cls||(a.trigger1Cls=a.triggerCls);for(b=0;(d=a["trigger"+(b+1)+"Cls"])||b<1;b++)f.push({tag:"td",valign:"top",cls:Ext.baseCSSPrefix+"trigger-cell",style:"width:"+a.triggerWidth+(c?"px;display:none":"px"),cn:{cls:[Ext.baseCSSPrefix+"trigger-index-"+b,e,d].join(" "),role:"button"}});return f[b-1].cn.cls+=" "+e+"-last",Ext.DomHelper.markup(f)},disableCheck:function(){return!this.disabled},beforeRender:function(){var a=this,b=a.triggerBaseCls,c;a.triggerWidth||(c=Ext.getBody().createChild({style:"position: absolute;",cls:Ext.baseCSSPrefix+"form-trigger"}),Ext.form.field.Trigger.prototype.triggerWidth=c.getWidth(),c.remove()),a.callParent(),b!=Ext.baseCSSPrefix+"form-trigger"&&a.addChildEls({name:"triggerEl",select:"."+b}),a.lastTriggerStateFlags=a.getTriggerStateFlags()},onRender:function(){var a=this;a.callParent(arguments),a.doc=Ext.getDoc(),a.initTrigger(),a.triggerEl.unselectable()},getTriggerWidth:function(){var a=this,b=0;return a.triggerWrap&&!a.hideTrigger&&!a.readOnly&&(b=a.triggerEl.getCount()*a.triggerWidth),b},setHideTrigger:function(a){a!=this.hideTrigger&&(this.hideTrigger=a,this.updateLayout())},setEditable:function(a){a!=this.editable&&(this.editable=a,this.updateLayout())},setReadOnly:function(a){a!=this.readOnly&&(this.readOnly=a,this.updateLayout())},initTrigger:function(){var a=this,b=a.triggerWrap,c=a.triggerEl,d=a.disableCheck,e,f,g,h,i;a.repeatTriggerClick?a.triggerRepeater=new Ext.util.ClickRepeater(b,{preventDefault:!0,handler:a.onTriggerWrapClick,listeners:{mouseup:a.onTriggerWrapMousup,scope:a},scope:a}):a.mon(b,{click:a.onTriggerWrapClick,mouseup:a.onTriggerWrapMousup,scope:a}),c.setVisibilityMode(Ext.Element.DISPLAY),c.addClsOnOver(a.triggerBaseCls+"-over",d,a),e=c.elements,f=e.length;for(h=0;h<f;h++)g=e[h],i=h+1,g.addClsOnOver(a["trigger"+i+"Cls"]+"-over",d,a),g.addClsOnClick(a["trigger"+i+"Cls"]+"-click",d,a);c.addClsOnClick(a.triggerBaseCls+"-click",d,a)},onDestroy:function(){var a=this;Ext.destroyMembers(a,"triggerRepeater","triggerWrap","triggerEl"),delete a.doc,a.callParent()},onFocus:function(){var a=this;a.callParent(arguments),a.mimicing||(a.bodyEl.addCls(a.wrapFocusCls),a.mimicing=!0,a.mon(a.doc,"mousedown",a.mimicBlur,a,{delay:10}),a.monitorTab&&a.on("specialkey",a.checkTab,a))},checkTab:function(a,b){!this.ignoreMonitorTab&&b.getKey()==b.TAB&&this.triggerBlur()},getTriggerStateFlags:function(){var a=this,b=0;return a.readOnly&&(b+=1),a.editable&&(b+=2),a.hideTrigger&&(b+=4),b},onBlur:Ext.emptyFn,mimicBlur:function(a){!this.isDestroyed&&!this.bodyEl.contains(a.target)&&this.validateBlur(a)&&this.triggerBlur(a)},triggerBlur:function(a){var b=this;b.mimicing=!1,b.mun(b.doc,"mousedown",b.mimicBlur,b),b.monitorTab&&b.inputEl&&b.un("specialkey",b.checkTab,b),Ext.form.field.Trigger.superclass.onBlur.call(b,a),b.bodyEl&&b.bodyEl.removeCls(b.wrapFocusCls)},validateBlur:function(a){return!0},onTriggerWrapClick:function(){var a=this,b,c,d,e;e=arguments[a.triggerRepeater?1:0],e&&!a.readOnly&&!a.disabled&&(b=e.getTarget("."+a.triggerBaseCls,null),c=b&&b.className.match(a.triggerIndexRe),c&&(d=a["onTrigger"+(parseInt(c[1],10)+1)+"Click"]||a.onTriggerClick,d&&d.call(a,e)))},onTriggerWrapMousup:Ext.emptyFn,onTriggerClick:Ext.emptyFn}),Ext.define("Ext.form.field.File",{extend:"Ext.form.field.Trigger",alias:["widget.filefield","widget.fileuploadfield"],alternateClassName:["Ext.form.FileUploadField","Ext.ux.form.FileUploadField","Ext.form.File"],uses:["Ext.button.Button","Ext.layout.component.field.Field"],buttonText:"Browse...",buttonOnly:!1,buttonMargin:3,fieldBodyCls:Ext.baseCSSPrefix+"form-file-wrap",readOnly:!0,componentLayout:"triggerfield",childEls:["fileInputEl","buttonEl","buttonEl-btnEl","browseButtonWrap"],onRender:function(){var a=this,b;a.callParent(arguments),b=a.inputEl,b.dom.name="",a.fileInputEl.dom.name=a.getName(),a.fileInputEl.on({scope:a,change:a.onFileChange}),a.buttonOnly&&a.inputCell.setDisplayed(!1),a.browseButtonWrap.dom.style.width=a.browseButtonWrap.dom.lastChild.offsetWidth+a.buttonEl.getMargin("lr")+"px",Ext.isIE&&a.buttonEl.repaint()},getTriggerMarkup:function(){var a=this,b,c=Ext.widget("button",Ext.apply({id:a.id+"-buttonEl",ui:a.ui,disabled:a.disabled,text:a.buttonText,cls:Ext.baseCSSPrefix+"form-file-btn",preventDefault:!1,style:a.buttonOnly?"":"margin-left:"+a.buttonMargin+"px"},a.buttonConfig)),d=c.getRenderTree(),e={id:a.id+"-fileInputEl",cls:Ext.baseCSSPrefix+"form-file-input",tag:"input",type:"file",size:1};return a.disabled&&(e.disabled=!0),d.cn=e,b='<td id="'+a.id+'-browseButtonWrap">'+Ext.DomHelper.markup(d)+"</td>",c.destroy(),b},createFileInput:function(){var a=this;a.fileInputEl=a.buttonEl.createChild({name:a.getName(),id:a.id+"-fileInputEl",cls:Ext.baseCSSPrefix+"form-file-input",tag:"input",type:"file",size:1}),a.fileInputEl.on({scope:a,change:a.onFileChange})},onFileChange:function(){this.lastValue=null,Ext.form.field.File.superclass.setValue.call(this,this.fileInputEl.dom.value)},setValue:Ext.emptyFn,reset:function(){var a=this;a.rendered&&(a.fileInputEl.remove(),a.createFileInput(),a.inputEl.dom.value=""),a.callParent()},onDisable:function(){this.callParent(),this.disableItems()},disableItems:function(){var a=this.fileInputEl;a&&(a.dom.disabled=!0),this["buttonEl-btnEl"].dom.disabled=!0},onEnable:function(){var a=this;a.callParent(),a.fileInputEl.dom.disabled=!1,this["buttonEl-btnEl"].dom.disabled=!0},isFileUpload:function(){return!0},extractFileInput:function(){var a=this.fileInputEl.dom;return this.reset(),a},onDestroy:function(){Ext.destroyMembers(this,"fileInputEl","buttonEl"),this.callParent()}}),Ext.define("Ext.form.field.Picker",{extend:"Ext.form.field.Trigger",alias:"widget.pickerfield",alternateClassName:"Ext.form.Picker",requires:["Ext.util.KeyNav"],matchFieldWidth:!0,pickerAlign:"tl-bl?",openCls:Ext.baseCSSPrefix+"pickerfield-open",editable:!0,initComponent:function(){this.callParent(),this.addEvents("expand","collapse","select")},initEvents:function(){var a=this;a.callParent(),a.keyNav=new Ext.util.KeyNav(a.inputEl,{down:a.onDownArrow,esc:{handler:a.onEsc,scope:a,defaultEventAction:!1},scope:a,forceKeyDown:!0}),a.editable||a.mon(a.inputEl,"click",a.onTriggerClick,a),Ext.isGecko&&a.inputEl.dom.setAttribute("autocomplete","off")},onEsc:function(a){var b=this;b.isExpanded?(b.collapse(),a.stopEvent()):b.up("window")?b.blur():(!Ext.FocusManager||!Ext.FocusManager.enabled)&&a.stopEvent()},onDownArrow:function(a){this.isExpanded||this.onTriggerClick()},expand:function(){var a=this,b,c,d;a.rendered&&!a.isExpanded&&!a.isDestroyed&&(b=a.bodyEl,c=a.getPicker(),d=a.collapseIf,c.show(),a.isExpanded=!0,a.alignPicker(),b.addCls(a.openCls),a.mon(Ext.getDoc(),{mousewheel:d,mousedown:d,scope:a}),Ext.EventManager.onWindowResize(a.alignPicker,a),a.fireEvent("expand",a),a.onExpand())},onExpand:Ext.emptyFn,alignPicker:function(){var a=this,b=a.getPicker();a.isExpanded&&(a.matchFieldWidth&&b.setWidth(a.bodyEl.getWidth()),b.isFloating()&&a.doAlign())},doAlign:function(){var a=this,b=a.picker,c="-above",d;a.picker.alignTo(a.inputEl,a.pickerAlign,a.pickerOffset),d=b.el.getY()<a.inputEl.getY(),a.bodyEl[d?"addCls":"removeCls"](a.openCls+c),b[d?"addCls":"removeCls"](b.baseCls+c)},collapse:function(){if(this.isExpanded&&!this.isDestroyed){var a=this,b=a.openCls,c=a.picker,d=Ext.getDoc(),e=a.collapseIf,f="-above";c.hide(),a.isExpanded=!1,a.bodyEl.removeCls([b,b+f]),c.el.removeCls(c.baseCls+f),d.un("mousewheel",e,a),d.un("mousedown",e,a),Ext.EventManager.removeResizeListener(a.alignPicker,a),a.fireEvent("collapse",a),a.onCollapse()}},onCollapse:Ext.emptyFn,collapseIf:function(a){var b=this;!b.isDestroyed&&!a.within(b.bodyEl,!1,!0)&&!a.within(b.picker.el,!1,!0)&&!b.isEventWithinPickerLoadMask(a)&&b.collapse()},getPicker:function(){var a=this;return a.picker||(a.picker=a.createPicker())},createPicker:Ext.emptyFn,onTriggerClick:function(){var a=this;!a.readOnly&&!a.disabled&&(a.isExpanded?a.collapse():a.expand(),a.inputEl.focus())},mimicBlur:function(a){var b=this,c=b.picker;(!c||!a.within(c.el,!1,!0)&&!b.isEventWithinPickerLoadMask(a))&&b.callParent(arguments)},onDestroy:function(){var a=this,b=a.picker;Ext.EventManager.removeResizeListener(a.alignPicker,a),Ext.destroy(a.keyNav),b&&(delete b.pickerField,b.destroy()),a.callParent()},isEventWithinPickerLoadMask:function(a){var b=this.picker.loadMask;return b?a.within(b.maskEl,!1,!0)||a.within(b.el,!1,!0):!1}}),Ext.define("Ext.form.field.Spinner",{extend:"Ext.form.field.Trigger",alias:"widget.spinnerfield",alternateClassName:"Ext.form.Spinner",requires:["Ext.util.KeyNav"],trigger1Cls:Ext.baseCSSPrefix+"form-spinner-up",trigger2Cls:Ext.baseCSSPrefix+"form-spinner-down",spinUpEnabled:!0,spinDownEnabled:!0,keyNavEnabled:!0,mouseWheelEnabled:!0,repeatTriggerClick:!0,onSpinUp:Ext.emptyFn,onSpinDown:Ext.emptyFn,triggerTpl:'<td style="{triggerStyle}"><div class="'+Ext.baseCSSPrefix+"trigger-index-0 "+Ext.baseCSSPrefix+"form-trigger "+Ext.baseCSSPrefix+'form-spinner-up" role="button"></div><div class="'+Ext.baseCSSPrefix+"trigger-index-1 "+Ext.baseCSSPrefix+"form-trigger "+Ext.baseCSSPrefix+'form-spinner-down" role="button"></div></td></tr>',initComponent:function(){this.callParent(),this.addEvents("spin","spinup","spindown")},onRender:function(){var a=this,b;a.callParent(arguments),b=a.triggerEl,a.spinUpEl=b.item(0),a.spinDownEl=b.item(1),a.setSpinUpEnabled(a.spinUpEnabled),a.setSpinDownEnabled(a.spinDownEnabled),a.keyNavEnabled&&(a.spinnerKeyNav=new Ext.util.KeyNav(a.inputEl,{scope:a,up:a.spinUp,down:a.spinDown})),a.mouseWheelEnabled&&a.mon(a.bodyEl,"mousewheel",a.onMouseWheel,a)},getSubTplMarkup:function(){var a=this,b=Ext.form.field.Base.prototype.getSubTplMarkup.apply(a,arguments);return'<table id="'+a.id+'-triggerWrap" class="'+Ext.baseCSSPrefix+'form-trigger-wrap" cellpadding="0" cellspacing="0"><tbody><tr><td id="'+a.id+'-inputCell" class="'+Ext.baseCSSPrefix+'form-trigger-input-cell">'+b+"</td>"+a.getTriggerMarkup()+"</tbody></table>"},getTriggerMarkup:function(){var a=this,b=a.readOnly||a.hideTrigger;return a.getTpl("triggerTpl").apply({triggerStyle:"width:"+a.triggerWidth+(b?"px;display:none":"px")})},getTriggerWidth:function(){var a=this,b=0;return a.triggerWrap&&!a.hideTrigger&&!a.readOnly&&(b=a.triggerWidth),b},onTrigger1Click:function(){this.spinUp()},onTrigger2Click:function(){this.spinDown()},onTriggerWrapMousup:function(){this.inputEl.focus()},spinUp:function(){var a=this;a.spinUpEnabled&&!a.disabled&&(a.fireEvent("spin",a,"up"),a.fireEvent("spinup",a),a.onSpinUp())},spinDown:function(){var a=this;a.spinDownEnabled&&!a.disabled&&(a.fireEvent("spin",a,"down"),a.fireEvent("spindown",a),a.onSpinDown())},setSpinUpEnabled:function(a){var b=this,c=b.spinUpEnabled;b.spinUpEnabled=a,c!==a&&b.rendered&&b.spinUpEl[a?"removeCls":"addCls"](b.trigger1Cls+"-disabled")},setSpinDownEnabled:function(a){var b=this,c=b.spinDownEnabled;b.spinDownEnabled=a,c!==a&&b.rendered&&b.spinDownEl[a?"removeCls":"addCls"](b.trigger2Cls+"-disabled")},onMouseWheel:function(a){var b=this,c;b.hasFocus&&(c=a.getWheelDelta(),c>0?b.spinUp():c<0&&b.spinDown(),a.stopEvent())},onDestroy:function(){Ext.destroyMembers(this,"spinnerKeyNav","spinUpEl","spinDownEl"),this.callParent()}}),Ext.define("Ext.form.field.Number",{extend:"Ext.form.field.Spinner",alias:"widget.numberfield",alternateClassName:["Ext.form.NumberField","Ext.form.Number"],allowDecimals:!0,decimalSeparator:".",submitLocaleSeparator:!0,decimalPrecision:2,minValue:Number.NEGATIVE_INFINITY,maxValue:Number.MAX_VALUE,step:1,minText:"The minimum value for this field is {0}",maxText:"The maximum value for this field is {0}",nanText:"{0} is not a valid number",negativeText:"The value cannot be negative",baseChars:"0123456789",autoStripChars:!1,initComponent:function(){var a=this,b;a.callParent(),a.setMinValue(a.minValue),a.setMaxValue(a.maxValue),a.disableKeyFilter!==!0&&(b=a.baseChars+"",a.allowDecimals&&(b+=a.decimalSeparator),a.minValue<0&&(b+="-"),b=Ext.String.escapeRegex(b),a.maskRe=new RegExp("["+b+"]"),a.autoStripChars&&(a.stripCharsRe=new RegExp("[^"+b+"]","gi")))},getErrors:function(a){var b=this,c=b.callParent(arguments),d=Ext.String.format,e;return a=Ext.isDefined(a)?a:this.processRawValue(this.getRawValue()),a.length<1?c:(a=String(a).replace(b.decimalSeparator,"."),isNaN(a)&&c.push(d(b.nanText,a)),e=b.parseValue(a),b.minValue===0&&e<0?c.push(this.negativeText):e<b.minValue&&c.push(d(b.minText,b.minValue)),e>b.maxValue&&c.push(d(b.maxText,b.maxValue)),c)},rawToValue:function(a){var b=this.fixPrecision(this.parseValue(a));return b===null&&(b=a||null),b},valueToRaw:function(a){var b=this,c=b.decimalSeparator;return a=b.parseValue(a),a=b.fixPrecision(a),a=Ext.isNumber(a)?a:parseFloat(String(a).replace(c,".")),a=isNaN(a)?"":String(a).replace(".",c),a},getSubmitValue:function(){var a=this,b=a.callParent();return a.submitLocaleSeparator||(b=b.replace(a.decimalSeparator,".")),b},onChange:function(){this.toggleSpinners(),this.callParent(arguments)},toggleSpinners:function(){var a=this,b=a.getValue(),c=b===null;a.setSpinUpEnabled(c||b<a.maxValue),a.setSpinDownEnabled(c||b>a.minValue)},setMinValue:function(a){this.minValue=Ext.Number.from(a,Number.NEGATIVE_INFINITY),this.toggleSpinners()},setMaxValue:function(a){this.maxValue=Ext.Number.from(a,Number.MAX_VALUE),this.toggleSpinners()},parseValue:function(a){return a=parseFloat(String(a).replace(this.decimalSeparator,".")),isNaN(a)?null:a},fixPrecision:function(a){var b=this,c=isNaN(a),d=b.decimalPrecision;if(c||!a)return c?"":a;if(!b.allowDecimals||d<=0)d=0;return parseFloat(Ext.Number.toFixed(parseFloat(a),d))},beforeBlur:function(){var a=this,b=a.parseValue(a.getRawValue());Ext.isEmpty(b)||a.setValue(b)},onSpinUp:function(){var a=this;a.readOnly||a.setValue(Ext.Number.constrain(a.getValue()+a.step,a.minValue,a.maxValue))},onSpinDown:function(){var a=this;a.readOnly||a.setValue(Ext.Number.constrain(a.getValue()-a.step,a.minValue,a.maxValue))}}),Ext.define("Ext.layout.component.field.ComboBox",{extend:"Ext.layout.component.field.Trigger",alias:"layout.combobox",requires:["Ext.util.TextMetrics"],type:"combobox",startingWidth:null,getTextWidth:function(){var a=this,b=a.owner,c=b.store,d=b.displayField,e=c.data.length,f="",g=0,h=0,i,j,k;for(;g<e;g++)j=c.getAt(g).data[d],i=j.length,i>h&&(h=i,f=j);k=Math.max(a.callParent(arguments),b.inputEl.getTextWidth(f+b.growAppend));if(!a.startingWidth||b.removingRecords)a.startingWidth=k,k<b.growMin&&(b.defaultListConfig.minWidth=b.growMin),b.removingRecords=!1;return k<a.startingWidth?a.startingWidth:k}}),Ext.define("Ext.layout.container.Container",{extend:"Ext.layout.Layout",alternateClassName:"Ext.layout.ContainerLayout",mixins:{elementCt:"Ext.util.ElementContainer"},requires:["Ext.XTemplate"],type:"container",manageOverflow:0,beginCollapse:Ext.emptyFn,beginExpand:Ext.emptyFn,animatePolicy:null,childEls:["overflowPadderEl"],renderTpl:["{%this.renderBody(out,values)%}"],usesContainerHeight:!0,usesContainerWidth:!0,usesHeight:!0,usesWidth:!0,reserveScrollbar:!1,lastOverflowAdjust:{width:0,height:0},constructor:function(){this.callParent(arguments),this.mixins.elementCt.constructor.call(this)},destroy:function(){this.callParent(),this.mixins.elementCt.destroy.call(this)},initLayout:function(){var a=this,b=Ext.getScrollbarSize().width;a.callParent(),b&&a.manageOverflow&&!a.hasOwnProperty("lastOverflowAdjust")&&(a.owner.autoScroll||a.reserveScrollbar)&&(a.lastOverflowAdjust={width:b,height:0})},beginLayout:function(a){this.callParent(arguments),a.targetContext=a.getEl("getTarget",this),this.cacheChildItems(a)},beginLayoutCycle:function(a,b){var c=this,d=c.overflowPadderEl;c.callParent(arguments),a.state.overflowAdjust||(a.state.overflowAdjust=c.lastOverflowAdjust),b&&(c.usesContainerHeight&&++a.consumersContainerHeight,c.usesContainerWidth&&++a.consumersContainerWidth),d&&d.setStyle("display","none")},completeLayout:function(a){this.lastOverflowAdjust=a.state.overflowAdjust},cacheChildItems:function(a){var b=a.context,c=[],d=this.getVisibleItems(),e=d.length,f;a.childItems=c,a.visibleItems=d;for(f=0;f<e;++f)c.push(b.getCmp(d[f]))},cacheElements:function(){var a=this.owner;this.applyChildEls(a.el,a.id)},calculateContentSize:function(a,b){var c=this,d=(b||0)|c.manageOverflow|((a.widthModel.shrinkWrap?1:0)|(a.heightModel.shrinkWrap?2:0)),e=d&1||undefined,f=d&2||undefined,g=a.childItems,h=g.length,i=0,j=0,k=0,l=a.props,m,n,o,p,q,r,s,t,u,v,w,x,y,z;e&&(isNaN(l.contentWidth)?++k:e=undefined),f&&(isNaN(l.contentHeight)?++k:f=undefined);if(k){for(w=0;w<h;++w){s=g[w],r=s.target,v=f&&s.getProp("height"),y=e&&s.getProp("width"),x=s.getMarginInfo(),e&&isNaN(r.x)||f&&isNaN(r.y)?(z=r.el.getXY(),m||(m=a.targetContext.el.getXY(),q=a.targetContext.getBorderInfo(),n=m[0]+q.left,o=m[1]+q.top),t=z[0]-n,u=z[1]-o):(t=r.x,u=r.y),v+=x.bottom,y+=x.right,i=Math.max(i,u+v),j=Math.max(j,t+y);if(isNaN(i)&&isNaN(j)){c.done=!1;return}}if(e||f)p=a.targetContext.getPaddingInfo();e&&!a.setContentWidth(j+p.right)&&(c.done=!1),f&&!a.setContentHeight(i+p.bottom)&&(c.done=!1)}},calculateOverflow:function(a,b,c){var d=this,e=d.owner,f=d.manageOverflow,g=a.state,h=g.overflowAdjust,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(f&&!g.secondPass&&!d.reserveScrollbar){e.autoScroll?u=v=!0:(e.overflowX?u=e.overflowX=="auto":(n=a.targetContext.getStyle("overflow-x"),u=n&&n!="hidden"&&n!="scroll"),e.overflowY?v=e.overflowY=="auto":(n=a.targetContext.getStyle("overflow-y"),v=n&&n!="hidden"&&n!="scroll")),b.gotWidth||(u=!1),b.gotHeight||(v=!1);if(u||v){o=Ext.getScrollbarSize(),p=a.peek("contentWidth"),q=a.peek("contentHeight"),r=b.width,s=b.height,t=d.getScrollbarsNeeded(r,s,p,q),g.overflowState=t,typeof c=="number"&&(t&=~c),h={width:u&&t&2?o.width:0,height:v&&t&1?o.height:0};if(h.width!==d.lastOverflowAdjust.width||h.height!==d.lastOverflowAdjust.height)d.done=!1,a.invalidate({state:{overflowAdjust:h,overflowState:g.overflowState,secondPass:!0}})}}if(!d.done)return;k=a.padElContext||(a.padElContext=a.getEl("overflowPadderEl",d)),k&&(t=g.overflowState,i=b.width,j=0,t?(l=a.targetContext.getPaddingInfo(),m=d.scrollRangeFlags,t&2&&m&1&&(j+=l.bottom),t&1&&m&4&&(i+=l.right),k.setProp("display",""),k.setSize(i,j)):k.setProp("display","none"))},configureItem:function(a){var b=this,c=b.owner.itemCls,d=[].concat(b.itemCls||[]);b.callParent(arguments),c&&(d=Ext.Array.push(d,c)),a.addCls(d)},doRenderBody:function(a,b){this.renderItems(a,b),this.renderContent(a,b)},doRenderContainer:function(a,b){var c=b.$comp.layout,d=c.getRenderTpl(),e=c.getRenderData();d.applyOut(e,a)},doRenderItems:function(a,b){var c=b.$layout,d=c.getRenderTree();d&&Ext.DomHelper.generateMarkup(d,a)},doRenderPadder:function(a,b){var c=b.$layout,d=c.owner,e=c.getScrollRangeFlags();c.manageOverflow==2&&e&5&&(a.push('<div id="',d.id,'-overflowPadderEl" ','style="font-size: 1px; width:1px; height: 1px;'),a.push('"></div>'),c.scrollRangeFlags=e)},finishRender:function(){var a=this,b,c;a.callParent(),a.cacheElements(),b=a.getRenderTarget(),c=a.getLayoutItems(),a.targetCls&&a.getTarget().addCls(a.targetCls),a.finishRenderItems(b,c)},notifyOwner:function(){this.owner.afterLayout(this)},getContainerSize:function(a,b){var c=a.targetContext,d=c.getFrameInfo(),e=c.getPaddingInfo(),f=0,g=0,h=a.state.overflowAdjust,i,j,k,l;return a.widthModel.shrinkWrap||(++g,k=b?c.getDomProp("width"):c.getProp("width"),i=typeof k=="number",i&&(++f,k-=d.width+e.width,h&&(k-=h.width))),a.heightModel.shrinkWrap||(++g,l=b?c.getDomProp("height"):c.getProp("height"),j=typeof l=="number",j&&(++f,l-=d.height+e.height,h&&(l-=h.height))),{width:k,height:l,needed:g,got:f,gotAll:f==g,gotWidth:i,gotHeight:j}},getLayoutItems:function(){var a=this.owner,b=a&&a.items;return b&&b.items||[]},getRenderData:function(){var a=this.owner;return{$comp:a,$layout:this,ownerId:a.id}},getRenderedItems:function(){var a=this,b=a.getRenderTarget(),c=a.getLayoutItems(),d=c.length,e=[],f,g;for(f=0;f<d;f++)g=c[f],g.rendered&&a.isValidParent(g,b,f)&&e.push(g);return e},getRenderTarget:function(){return this.owner.getTargetEl()},getElementTarget:function(){return this.getRenderTarget()},getRenderTpl:function(){var a=this,b=Ext.XTemplate.getTpl(this,"renderTpl");return b.renderContent||a.owner.setupRenderTpl(b),b},getRenderTree:function(){var a,b=this.owner.items,c,d={};do c=b.generation,a=this.getItemsRenderTree(this.getLayoutItems(),d);while(b.generation!==c);return a},getScrollbarsNeeded:function(a,b,c,d){var e=Ext.getScrollbarSize(),f=typeof a=="number",g=typeof b=="number",h=0,i=0;return e.width?(g&&b<d&&(i=2,a-=e.width),f&&a<c&&(h=1,!i&&g&&(b-=e.height,b<d&&(i=2))),i+h):0},getScrollRangeFlags:function(){var a=-1;return function(){if(a<0){var b=Ext.getBody().createChild({cls:Ext.baseCSSPrefix+"border-box",style:{width:"100px",height:"100px",padding:"10px",overflow:"auto"},children:[{style:{border:"1px solid red",width:"150px",height:"150px",margin:"0 5px 5px 0"}}]}),c=b.dom.scrollHeight,d=b.dom.scrollWidth,e={175:0,165:1,170:2,160:3},f={175:0,165:4,170:8,160:12};a=(e[c]||0)|(f[d]||0),b.remove()}return a}}(),getTarget:function(){return this.owner.getTargetEl()},getVisibleItems:function(){var a=this.getRenderTarget(),b=this.getLayoutItems(),c=b.length,d=[],e,f;for(e=0;e<c;e++)f=b[e],f.rendered&&this.isValidParent(f,a,e)&&f.hidden!==!0&&d.push(f);return d},setupRenderTpl:function(a){var b=this;a.renderBody=b.doRenderBody,a.renderContainer=b.doRenderContainer,a.renderItems=b.doRenderItems,a.renderPadder=b.doRenderPadder}}),Ext.define("Ext.layout.container.Auto",{alias:["layout.auto","layout.autocontainer"],extend:"Ext.layout.container.Container",type:"autocontainer",childEls:["clearEl"],renderTpl:["{%this.renderBody(out,values)%}",'<div id="{ownerId}-clearEl" class="',Ext.baseCSSPrefix,'clear" role="presentation"></div>'],calculate:function(a){var b=this,c;a.hasDomProp("containerChildrenDone")?(c=b.getContainerSize(a),c.gotAll||(b.done=!1),b.calculateContentSize(a)):b.done=!1}}),Ext.define("Ext.container.AbstractContainer",{extend:"Ext.Component",requires:["Ext.util.MixedCollection","Ext.layout.container.Auto","Ext.ZIndexManager"],renderTpl:"{%this.renderContainer(out,values)%}",suspendLayout:!1,autoDestroy:!0,defaultType:"panel",detachOnRemove:!0,isContainer:!0,layoutCounter:0,baseCls:Ext.baseCSSPrefix+"container",bubbleEvents:["add","remove"],initComponent:function(){var a=this;a.addEvents("afterlayout","beforeadd","beforeremove","add","remove"),a.callParent(),a.getLayout(),a.initItems()},initItems:function(){var a=this,b=a.items;a.items=new Ext.util.AbstractMixedCollection(!1,a.getComponentId),b&&(Ext.isArray(b)||(b=[b]),a.add(b))},getFocusEl:function(){return this.getTargetEl()},finishRenderChildren:function(){this.callParent();var a=this.getLayout();a&&a.finishRender()},beforeRender:function(){var a=this,b=a.getLayout();a.callParent(),b.initialized||b.initLayout()},setupRenderTpl:function(a){var b=this.getLayout();this.callParent(arguments),b.setupRenderTpl(a)},setLayout:function(a){var b=this.layout;b&&b.isLayout&&b!=a&&b.setOwner(null),this.layout=a,a.setOwner(this)},getLayout:function(){var a=this;return(!a.layout||!a.layout.isLayout)&&a.setLayout(Ext.layout.Layout.create(a.layout,a.self.prototype.layout||"autocontainer")),a.layout},doLayout:function(){return this.updateLayout(),this},afterLayout:function(a){var b=this;++b.layoutCounter,b.hasListeners.afterlayout&&b.fireEvent("afterlayout",b,a)},prepareItems:function(a,b){Ext.isArray(a)?a=a.slice():a=[a];var c=0,d=a.length,e;for(;c<d;c++)e=a[c],e==null?(Ext.Array.erase(a,c,1),--c,--d):(b&&(e=this.applyDefaults(e)),a[c]=this.lookupComponent(e));return a},applyDefaults:function(a){var b=this.defaults;return b&&(Ext.isFunction(b)&&(b=b.call(this,a)),Ext.isString(a)&&(a=Ext.ComponentManager.get(a)),Ext.applyIf(a,b)),a},lookupComponent:function(a){return typeof a=="string"?Ext.ComponentManager.get(a):Ext.ComponentManager.create(a,this.defaultType)},getComponentId:function(a){return a.getItemId()},add:function(){var a=this,b=Ext.Array.slice(arguments),c=typeof b[0]=="number"?b.shift():-1,d=a.getLayout(),e,f,g,h,i,j,k;b.length==1&&Ext.isArray(b[0])?(f=b[0],e=!0):f=b,k=f=a.prepareItems(f,!0),h=f.length,a.rendered&&Ext.suspendLayouts(),!e&&h==1&&(k=f[0]);for(g=0;g<h;g++)i=f[g],j=c<0?a.items.length:c+g,i.floating?i.onAdded(a,j):(!a.hasListeners.beforeadd||a.fireEvent("beforeadd",a,i,j)!==!1)&&a.onBeforeAdd(i)!==!1&&(a.items.insert(j,i),i.onAdded(a,j),a.onAdd(i,j),d.onAdd(i,j),a.hasListeners.add&&a.fireEvent("add",a,i,j));return a.updateLayout(),a.rendered&&Ext.resumeLayouts(!0),k},onAdd:Ext.emptyFn,onRemove:Ext.emptyFn,insert:function(a,b){return this.add(a,b)},move:function(a,b){var c=this.items,d;return d=c.removeAt(a),d===!1?!1:(c.insert(b,d),this.doLayout(),d)},onBeforeAdd:function(a){var b=this,c=a.border;a.ownerCt&&a.ownerCt.remove(a,!1);if(b.border===!1||b.border===0)a.border=Ext.isDefined(c)&&c!==!1&&c!==0},remove:function(a,b){var c=this,d=c.getComponent(a);return d&&(!c.hasListeners.beforeremove||c.fireEvent("beforeremove",c,d)!==!1)&&(c.doRemove(d,b),c.hasListeners.remove&&c.fireEvent("remove",c,d),c.destroying||c.doLayout()),d},doRemove:function(a,b){var c=this,d=c.layout,e=d&&c.rendered,f=b===!0||b!==!1&&c.autoDestroy;b=b===!0||b!==!1&&c.autoDestroy,c.items.remove(a),a.onRemoved(f),e&&d.onRemove(a),c.onRemove(a,f),f?a.destroy():(e&&d.afterRemove(a),c.detachOnRemove&&a.rendered&&Ext.getDetachedBody().appendChild(a.getEl()))},removeAll:function(a){var b=this,c=b.items.items.slice(),d=[],e=0,f=c.length,g;b.suspendLayouts();for(;e<f;e++)g=c[e],b.remove(g,a),g.ownerCt!==b&&d.push(g);return b.resumeLayouts(!!f),d},getRefItems:function(a){var b=this,c=b.items.items,d=c.length,e=0,f,g=[];for(;e<d;e++)f=c[e],g.push(f),a&&f.getRefItems&&g.push.apply(g,f.getRefItems(!0));return b.floatingItems&&b.floatingItems.accessList&&g.push.apply(g,b.floatingItems.accessList),g},cascade:function(a,b,c){var d=this,e=d.items?d.items.items:[],f=e.length,g=0,h,i=c?c.concat(d):[d],j=i.length-1;if(a.apply(b||d,i)!==!1)for(;g<f;g++)h=e[g],h.cascade?h.cascade(a,b,c):(i[j]=h,a.apply(b||e,i));return this},isAncestor:function(a){while(a){if(a.ownerCt===this)return!0;a=a.ownerCt}},getComponent:function(a){return Ext.isObject(a)&&(a=a.getItemId()),this.items.get(a)},query:function(a){return a=a||"*",Ext.ComponentQuery.query(a,this)},queryBy:function(a,b){var c=[],d=this.getRefItems(!0),e=0,f=d.length,g;for(;e<f;++e)g=d[e],a.call(b||g,g)!==!1&&c.push(g);return c},queryById:function(a){return this.down("#"+a)},child:function(a){return a=a||"",this.query("> "+a)[0]||null},nextChild:function(a,b){var c=this,d,e=c.items.indexOf(a);return e!==-1&&(d=b?Ext.ComponentQuery(b,c.items.items.slice(e+1)):c.items.getAt(e+1),!d&&c.ownerCt&&(d=c.ownerCt.nextChild(c,b))),d},prevChild:function(a,b){var c=this,d,e=c.items.indexOf(a);return e!==-1&&(d=b?Ext.ComponentQuery(b,c.items.items.slice(e+1)):c.items.getAt(e+1),!d&&c.ownerCt&&(d=c.ownerCt.nextChild(c,b))),d},down:function(a){return this.query(a)[0]||null},enable:function(){this.callParent(arguments);var a=this.getChildItemsToDisable(),b=a.length,c,d;for(d=0;d<b;d++)c=a[d],c.resetDisable&&c.enable()},disable:function(){this.callParent(arguments);var a=this.getChildItemsToDisable(),b=a.length,c,d;for(d=0;d<b;d++)c=a[d],c.resetDisable!==!1&&!c.disabled&&(c.disable(),c.resetDisable=!0)},getChildItemsToDisable:function(){return this.query("[isFormField],button")},beforeLayout:function(){return!0},beforeDestroy:function(){var a=this,b=a.items,c;if(b)while(c=b.first())a.doRemove(c,!0);Ext.destroy(a.layout),a.callParent()}}),Ext.define("Ext.container.Container",{extend:"Ext.container.AbstractContainer",alias:"widget.container",alternateClassName:"Ext.Container",fireHierarchyEvent:function(a){this.hierarchyEventSource.fireEvent(a,this)},afterHide:function(){this.callParent(arguments),this.fireHierarchyEvent("hide")},afterShow:function(){this.callParent(arguments),this.fireHierarchyEvent("show")},getChildByElement:function(a,b){var c,d,e=0,f=this.getRefItems(),g=f.length;a=Ext.getDom(a);for(;e<g;e++){c=f[e],d=c.getEl();if(d&&(d.dom===a||d.contains(a)))return b&&c.getChildByElement?c.getChildByElement(a,b):c}return null}},function(){this.hierarchyEventSource=this.prototype.hierarchyEventSource=new Ext.util.Observable({events:{hide:!0,show:!0,collapse:!0,expand:!0}})}),Ext.define("Ext.container.Viewport",{extend:"Ext.container.Container",alias:"widget.viewport",requires:["Ext.EventManager"],alternateClassName:"Ext.Viewport",isViewport:!0,ariaRole:"application",preserveElOnDestroy:!0,initComponent:function(){var a=this,b=document.body.parentNode,c;Ext.getScrollbarSize(),a.width=a.height=undefined,a.callParent(arguments),Ext.fly(b).addCls(Ext.baseCSSPrefix+"viewport"),a.autoScroll&&(delete a.autoScroll,Ext.fly(b).setStyle("overflow","auto")),a.el=c=Ext.getBody(),c.setHeight=Ext.emptyFn,c.setWidth=Ext.emptyFn,c.setSize=Ext.emptyFn,c.dom.scroll="no",a.allowDomMove=!1,a.renderTo=a.el},onRender:function(){var a=this;a.callParent(arguments),a.width=Ext.Element.getViewportWidth(),a.height=Ext.Element.getViewportHeight()},afterFirstLayout:function(){var a=this;a.callParent(arguments),setTimeout(function(){Ext.EventManager.onWindowResize(a.fireResize,a)},1)},fireResize:function(a,b){(a!=this.width||b!=this.height)&&this.setSize(a,b)}}),Ext.define("Ext.form.FieldContainer",{extend:"Ext.container.Container",mixins:{labelable:"Ext.form.Labelable",fieldAncestor:"Ext.form.FieldAncestor"},requires:"Ext.layout.component.field.FieldContainer",alias:"widget.fieldcontainer",componentLayout:"fieldcontainer",combineLabels:!1,labelConnector:", ",combineErrors:!1,maskOnDisable:!1,fieldSubTpl:"{%this.renderContainer(out,values)%}",initComponent:function(){var a=this;a.initLabelable(),a.initFieldAncestor(),a.callParent()},beforeRender:function(){this.callParent(arguments),this.beforeLabelableRender(arguments)},onLabelableAdded:function(a){var b=this;b.mixins.fieldAncestor.onLabelableAdded.call(this,a),b.updateLabel()},onLabelableRemoved:function(a){var b=this;b.mixins.fieldAncestor.onLabelableRemoved.call(this,a),b.updateLabel()},initRenderTpl:function(){var a=this;return a.hasOwnProperty("renderTpl")||(a.renderTpl=a.getTpl("labelableRenderTpl")),a.callParent()},initRenderData:function(){return Ext.applyIf(this.callParent(),this.getLabelableRenderData())},getFieldLabel:function(){var a=this.fieldLabel||"";return!a&&this.combineLabels&&(a=Ext.Array.map(this.query("[isFieldLabelable]"),function(a){return a.getFieldLabel()}).join(this.labelConnector)),a},getSubTplData:function(){var a=this.initRenderData();return Ext.apply(a,this.subTplData),a},getSubTplMarkup:function(){var a=this,b=a.getTpl("fieldSubTpl"),c;return b.renderContent||a.setupRenderTpl(b),c=b.apply(a.getSubTplData()),c},updateLabel:function(){var a=this,b=a.labelEl;b&&b.update(a.getFieldLabel())},onFieldErrorChange:function(a,b){if(this.combineErrors){var c=this,d=c.getActiveError(),e=Ext.Array.filter(c.query("[isFormField]"),function(a){return a.hasActiveError()}),f=c.getCombinedErrors(e);f?c.setActiveErrors(f):c.unsetActiveError(),d!==c.getActiveError()&&c.doComponentLayout()}},getCombinedErrors:function(a){var b=[],c,d=a.length,e,f,g,h,i,j;for(c=0;c<d;c++){e=a[c],f=e.getActiveErrors(),h=f.length;for(g=0;g<h;g++)i=f[g],j=e.getFieldLabel(),b.push((j?j+": ":"")+i)}return b},getTargetEl:function(){return this.bodyEl||this.callParent()}}),Ext.define("Ext.form.FieldSet",{extend:"Ext.container.Container",alias:"widget.fieldset",uses:["Ext.form.field.Checkbox","Ext.panel.Tool","Ext.layout.container.Anchor","Ext.layout.component.FieldSet"],collapsed:!1,toggleOnTitleClick:!0,baseCls:Ext.baseCSSPrefix+"fieldset",layout:"anchor",border:1,componentLayout:"fieldset",autoEl:"fieldset",childEls:["body"],renderTpl:["{%this.renderLegend(out,values);%}",'<div id="{id}-body" class="{baseCls}-body">',"{%this.renderContainer(out,values);%}","</div>"],stateEvents:["collapse","expand"],maskOnDisable:!1,beforeDestroy:function(){var a=this,b=a.legend;b&&(delete b.ownerCt,b.destroy(),a.legend=null),a.callParent()},initComponent:function(){var a=this,b=a.baseCls;a.callParent(),a.addEvents("beforeexpand","beforecollapse","expand","collapse"),a.collapsed&&(a.addCls(b+"-collapsed"),a.collapse()),a.title&&a.addCls(b+"-with-title"),(a.title||a.checkboxToggle||a.collapsible)&&a.addCls(b+"-with-legend")},initRenderData:function(){var a=this.callParent();return a.baseCls=this.baseCls,a},getState:function(){var a=this.callParent();return a=this.addPropertyToState(a,"collapsed"),a},afterCollapse:Ext.emptyFn,afterExpand:Ext.emptyFn,collapsedHorizontal:function(){return!0},collapsedVertical:function(){return!0},createLegendCt:function(){var a=this,b=[],c={xtype:"container",baseCls:this.baseCls+"-header",id:a.id+"-legend",autoEl:"legend",items:b,ownerCt:a,ownerLayout:a.componentLayout};return a.checkboxToggle?b.push(a.createCheckboxCmp()):a.collapsible&&b.push(a.createToggleCmp()),b.push(a.createTitleCmp()),c},createTitleCmp:function(){var a=this,b={xtype:"component",html:a.title,cls:a.baseCls+"-header-text",id:a.id+"-legendTitle"};return a.collapsible&&a.toggleOnTitleClick&&(b.listeners={el:{scope:a,click:a.toggle}},b.cls+=" "+a.baseCls+"-header-text-collapsible"),a.titleCmp=Ext.widget(b)},createCheckboxCmp:function(){var a=this,b="-checkbox";return a.checkboxCmp=Ext.widget({xtype:"checkbox",hideEmptyLabel:!0,name:a.checkboxName||a.id+b,cls:a.baseCls+"-header"+b,id:a.id+"-legendChk",checked:!a.collapsed,listeners:{change:a.onCheckChange,scope:a}}),a.checkboxCmp},createToggleCmp:function(){var a=this;return a.toggleCmp=Ext.widget({xtype:"tool",type:"toggle",handler:a.toggle,id:a.id+"-legendToggle",scope:a}),a.toggleCmp},doRenderLegend:function(a,b){var c=b.$comp,d,e;if(c.title||c.checkboxToggle||c.collapsible)c.legend=d=Ext.widget(c.createLegendCt()),d.ownerLayout.configureItem(d),e=c.legend.getRenderTree(),Ext.DomHelper.generateMarkup(e,a)},finishRender:function(){var a=this.legend;this.callParent(),a&&a.finishRender()},getCollapsed:function(){return this.collapsed?"top":!1},getCollapsedDockedItems:function(){var a=this.legend;return a?[a]:[]},setTitle:function(a){var b=this,c=b.legend;return b.title=a,b.rendered&&(b.legend||(b.legend=c=Ext.widget(b.createLegendCt()),c.ownerLayout.configureItem(c),c.render(b.el,0)),b.titleCmp.update(a)),b},getTargetEl:function(){return this.body||this.frameBody||this.el},getContentTarget:function(){return this.body},expand:function(){return this.setExpanded(!0)},collapse:function(){return this.setExpanded(!1)},setExpanded:function(a){var b=this,c=b.checkboxCmp,d=a?"expand":"collapse";if(!b.rendered||b.fireEvent("before"+d,b)!==!1)a=!!a,c&&c.setValue(a),a?b.removeCls(b.baseCls+"-collapsed"):b.addCls(b.baseCls+"-collapsed"),b.collapsed=!a,b.rendered&&(b.updateLayout(),b.fireEvent(d,b));return b},getRefItems:function(a){var b=this.callParent(arguments),c=this.legend;return c&&(b.unshift(c),a&&b.unshift.apply(b,c.getRefItems(!0))),b},toggle:function(){this.setExpanded(!!this.collapsed)},onCheckChange:function(a,b){this.setExpanded(b)},setupRenderTpl:function(a){this.callParent(arguments),a.renderLegend=this.doRenderLegend}}),Ext.define("Ext.layout.container.Anchor",{alias:"layout.anchor",extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.AnchorLayout",type:"anchor",manageOverflow:2,renderTpl:["{%this.renderBody(out,values);this.renderPadder(out,values)%}"],defaultAnchor:"100%",parseAnchorRE:/^(r|right|b|bottom)$/i,beginLayout:function(a){var b=this,c=0,d,e,f,g,h,i;b.callParent(arguments),f=a.childItems,h=f.length;for(g=0;g<h;++g){e=f[g],d=e.target.anchorSpec;if(d){e.widthModel.calculated&&d.right&&(c|=1),e.heightModel.calculated&&d.bottom&&(c|=2);if(c==3)break}}a.anchorDimensions=c,!Ext.supports.RightMargin&&!b.rightMarginCleanerFn&&(i=a.targetContext.el,b.rightMarginCleanerFn=Ext.Element.getRightMarginFixCleaner(i),i.addCls(Ext.baseCSSPrefix+"inline-children"))},calculate:function(a){var b=this,c=b.getContainerSize(a);a.anchorDimensions!==a.state.calculatedAnchors&&b.calculateAnchors(a,c);if(a.hasDomProp("containerChildrenDone")){c.gotAll||(b.done=!1),b.calculateContentSize(a,a.anchorDimensions);if(b.done){b.calculateOverflow(a,c,a.anchorDimensions);return}}b.done=!1},calculateAnchors:function(a,b){var c=this,d=a.childItems,e=d.length,f=b.gotHeight,g=b.gotWidth,h=b.height,i=b.width,j=a.state,k=(g?1:0)|(f?2:0),l,m,n,o,p,q;j.calculatedAnchors=(j.calculatedAnchors||0)|k;for(p=0;p<e;p++)m=d[p],n=m.getMarginInfo(),l=m.target.anchorSpec,g&&m.widthModel.calculated&&(q=l.right(i)-n.width,q=c.adjustWidthAnchor(q,m),m.setWidth(q)),f&&m.heightModel.calculated&&(o=l.bottom(h)-n.height,o=c.adjustHeightAnchor(o,m),m.setHeight(o))},finishedLayout:function(a){var b=this.rightMarginCleanerFn;b&&(delete this.rightMarginCleanerFn,a.targetContext.el.removeCls(Ext.baseCSSPrefix+"inline-children"),b())},anchorFactory:{offset:function(a){return function(b){return b+a}},ratio:function(a){return function(b){return Math.floor(b*a)}},standard:function(a){return function(b){return b-a}}},parseAnchor:function(a,b,c){if(a&&a!="none"){var d=this.anchorFactory,e;if(this.parseAnchorRE.test(a))return d.standard(c-b);if(a.indexOf("%")!=-1)return d.ratio(parseFloat(a.replace("%",""))*.01);e=parseInt(a,10);if(!isNaN(e))return d.offset(e)}return null},adjustWidthAnchor:function(a,b){return a},adjustHeightAnchor:function(a,b){return a},configureItem:function(a){var b=this,c=b.owner,d=a.anchor,e,f,g;b.callParent(arguments),!a.anchor&&a.items&&!Ext.isNumber(a.width)&&(!Ext.isIE6||!Ext.isStrict)&&(a.anchor=d=b.defaultAnchor),c.anchorSize?typeof c.anchorSize=="number"?f=c.anchorSize:(f=c.anchorSize.width,g=c.anchorSize.height):(f=c.initialConfig.width,g=c.initialConfig.height),d&&(e=d.split(" "),a.anchorSpec={right:b.parseAnchor(e[0],a.initialConfig.width,f),bottom:b.parseAnchor(e[1],a.initialConfig.height,g)})},sizePolicy:{"":{setsWidth:0,setsHeight:0},b:{setsWidth:0,setsHeight:1},r:{"":{setsWidth:1,setsHeight:0},b:{setsWidth:1,setsHeight:1}}},getItemSizePolicy:function(a){var b=a.anchorSpec,c="",d=this.sizePolicy,e;return b&&(e=this.owner.getSizeModel(),b.right&&!e.width.shrinkWrap&&(d=d.r),b.bottom&&!e.height.shrinkWrap&&(c="b")),d[c]}}),Ext.define("Ext.layout.container.Absolute",{alias:"layout.absolute",extend:"Ext.layout.container.Anchor",alternateClassName:"Ext.layout.AbsoluteLayout",targetCls:Ext.baseCSSPrefix+"abs-layout-ct",itemCls:Ext.baseCSSPrefix+"abs-layout-item",ignoreOnContentChange:!0,type:"absolute",adjustWidthAnchor:function(a,b){var c=this.targetPadding,d=b.getStyle("left");return a-d+c.left},adjustHeightAnchor:function(a,b){var c=this.targetPadding,d=b.getStyle("top");return a-d+c.top},isItemLayoutRoot:function(a){return this.ignoreOnContentChange||this.callParent(arguments)},isItemShrinkWrap:function(a){return!0},beginLayout:function(a){var b=this,c=b.getTarget();b.callParent(arguments),c.dom!==document.body&&c.position(),b.targetPadding=a.targetContext.getPaddingInfo()},isItemBoxParent:function(a){return!0},onContentChange:function(){return this.ignoreOnContentChange?!1:this.callParent(arguments)}}),Ext.define("Ext.layout.container.CheckboxGroup",{extend:"Ext.layout.container.Container",alias:["layout.checkboxgroup"],autoFlex:!0,type:"checkboxgroup",childEls:["innerCt"],renderTpl:['<table id="{ownerId}-innerCt" role="presentation" style="{tableStyle}"><tbody><tr>','<tpl for="columns">','<td class="{parent.colCls}" valign="top" style="{style}">',"{% this.renderColumn(out,parent,xindex-1) %}","</td>","</tpl>","</tr></tbody></table>"],beginLayout:function(a){var b=this,c,d,e,f,g,h,i,j=0,k=0,l=b.autoFlex,m=b.owner.items.generation,n=b.innerCt.dom.style;b.callParent(arguments),f=a.childItems,b.lastChildGeneration!=m&&(b.lastChildGeneration=m,b.fixColumns()),c=b.columnEls,a.innerCtContext=a.getEl("innerCt",b);if(!a.widthModel.shrinkWrap){d=c.length;if(b.columnsArray){for(g=0;g<d;g++)h=b.owner.columns[g],h<1&&(j+=h,k++);for(g=0;g<d;g++)h=b.owner.columns[g],h<1?i=h/j*100+"%":i=h+"px",c[g].style.width=i}else for(g=0;g<d;g++)i=l?1/d*100+"%":"",c[g].style.width=i,k++;k?k<d?(n.tableLayout="fixed",n.width="100%"):(n.tableLayout="auto",l?n.width="100%":n.width=""):(n.tableLayout="fixed",n.width="")}else n.tableLayout="auto",n.width=""},cacheElements:function(){var a=this;a.callParent(),a.columnEls=a.innerCt.query("td."+a.owner.groupCls),a.lastChildGeneration=a.owner.items.generation},calculate:function(a){var b=this,c,d,e,f,g,h;a.getDomProp("containerChildrenDone")?(c=a.innerCtContext,d=a.widthModel.shrinkWrap,e=a.heightModel.shrinkWrap,f=e||d,g=c.el.dom,h=f&&c.getPaddingInfo(),d&&a.setContentWidth(g.offsetWidth+h.width,!0),e&&a.setContentHeight(g.offsetHeight+h.height,!0)):b.done=!1},doRenderColumn:function(a,b,c){var d=b.$layout,e=d.owner,f=b.columnCount,g=e.items.items,h=g.length,i,j,k,l,m;e.vertical?(k=Math.ceil(h/f),j=c*k,h=Math.min(h,j+k),l=1):(j=c,l=f);for(;j<h;j+=l)i=g[j],d.configureItem(i),m=i.getRenderTree(),Ext.DomHelper.generateMarkup(m,a)},fixColumns:function(){var a=this,b=a.owner,c=b.columns,d=a.columnEls,e=b.items.items,f=d.length,g=e.length,h,i,j,k,l,m;if((!c||c=="auto")&&g>f){m=g-f;for(i=0;i<m;i++)k=a.innerCt.down("tr"),k.createChild({cls:b.groupCls,tag:"td",vAlign:"top"});a.cacheElements(),d=a.columnEls,f=d.length}if(b.vertical){h=-1,j=Math.ceil(g/f);for(i=0;i<g;++i)i%j===0&&++h,d[h].appendChild(e[i].el.dom)}else for(i=0;i<g;++i)h=i%f,d[h].appendChild(e[i].el.dom)},getColumnCount:function(){var a=this,b=a.owner,c=b.columns;return a.columnsArray?c.length:Ext.isNumber(c)?c:b.items.length},getItemSizePolicy:function(a){return this.autoSizePolicy},getRenderData:function(){var a=this,b=a.callParent(),c=a.owner,d,e=a.getColumnCount(),f,g,h,i=a.autoFlex,j=0,k=0;if(a.columnsArray)for(d=0;d<e;d++)f=a.owner.columns[d],f<1&&(j+=f,k++);b.colCls=c.groupCls,b.columnCount=e,b.columns=[];for(d=0;d<e;d++)g=b.columns[d]={},a.columnsArray?(f=a.owner.columns[d],f<1?h=f/j*100+"%":h=f+"px",g.style="width:"+h):(g.style="width:"+1/e*100+"%",k++);return b.tableStyle=k?k<e?"table-layout:fixed;width:100%":i?"table-layout:auto;width:100%":"table-layout:auto;":"table-layout:fixed;",b},getRenderTarget:function(){return this.innerCt},initLayout:function(){var a=this,b=a.owner;a.columnsArray=Ext.isArray(b.columns),a.evenColumns=Ext.isNumber(b.columns),a.callParent()},isValidParent:function(){return!0},setupRenderTpl:function(a){this.callParent(arguments),a.renderColumn=this.doRenderColumn}}),Ext.define("Ext.form.CheckboxGroup",{extend:"Ext.form.FieldContainer",mixins:{field:"Ext.form.field.Field"},alias:"widget.checkboxgroup",requires:["Ext.layout.container.CheckboxGroup","Ext.form.field.Base"],columns:"auto",vertical:!1,allowBlank:!0,blankText:"You must select at least one item in this group",defaultType:"checkboxfield",groupCls:Ext.baseCSSPrefix+"form-check-group",fieldBodyCls:Ext.baseCSSPrefix+"form-checkboxgroup-body",layout:"checkboxgroup",initComponent:function(){var a=this;a.callParent(),a.initField()},initValue:function(){var a=this,b=a.value;a.originalValue=a.lastValue=b||a.getValue(),b&&a.setValue(b)},onFieldAdded:function(a){var b=this;a.isCheckbox&&b.mon(a,"change",b.checkChange,b),b.callParent(arguments)},onFieldRemoved:function(a){var b=this;a.isCheckbox&&b.mun(a,"change",b.checkChange,b),b.callParent(arguments)},isEqual:function(a,b){var c=Ext.Object.toQueryString;return c(a)===c(b)},getErrors:function(){var a=[];return!this.allowBlank&&Ext.isEmpty(this.getChecked())&&a.push(this.blankText),a},getBoxes:function(a){return this.query("[isCheckbox]"+(a||""))},eachBox:function(a,b){Ext.Array.forEach(this.getBoxes(),a,b||this)},getChecked:function(){return this.getBoxes("[checked]")},isDirty:function(){var a=this.getBoxes(),b,c=a.length;for(b=0;b<c;b++)if(a[b].isDirty())return!0},setReadOnly:function(a){var b=this.getBoxes(),c,d=b.length;for(c=0;c<d;c++)b[c].setReadOnly(a);this.readOnly=a},reset:function(){var a=this,b=a.hasActiveError(),c=a.preventMark;a.preventMark=!0,a.batchChanges(function(){var b=a.getBoxes(),c,d=b.length;for(c=0;c<d;c++)b[c].reset()}),a.preventMark=c,a.unsetActiveError(),b&&a.updateLayout()},resetOriginalValue:function(){var a=this,b=a.getBoxes(),c,d=b.length;for(c=0;c<d;c++)b[c].resetOriginalValue();a.originalValue=a.getValue(),a.checkDirty()},setValue:function(a){var b=this,c=b.getBoxes(),d,e=c.length,f,g,h;return b.batchChanges(function(){for(d=0;d<e;d++)f=c[d],g=f.getName(),h=!1,a&&a.hasOwnProperty(g)&&(Ext.isArray(a[g])?h=Ext.Array.contains(a[g],f.inputValue):h=a[g]),f.setValue(h)}),b},getValue:function(){var a={},b=this.getBoxes(),c,d=b.length,e,f,g,h;for(c=0;c<d;c++)e=b[c],f=e.getName(),g=e.inputValue,e.getValue()&&(a.hasOwnProperty(f)?(h=a[f],Ext.isArray(h)||(h=a[f]=[h]),h.push(g)):a[f]=g);return a},getSubmitData:function(){return null},getModelData:function(){return null},validate:function(){var a=this,b,c,d;return a.disabled?c=!0:(b=a.getErrors(),c=Ext.isEmpty(b),d=!a.hasActiveError(),c?a.unsetActiveError():a.setActiveError(b)),c!==d&&(a.fireEvent("validitychange",a,c),a.updateLayout()),c}},function(){this.borrow(Ext.form.field.Base,["markInvalid","clearInvalid"])}),Ext.define("Ext.form.RadioGroup",{extend:"Ext.form.CheckboxGroup",alias:"widget.radiogroup",allowBlank:!0,blankText:"You must select one item in this group",defaultType:"radiofield",groupCls:Ext.baseCSSPrefix+"form-radio-group",getBoxes:function(a){return this.query("[isRadio]"+(a||""))},checkChange:function(){var a=this.getValue(),b=Ext.Object.getKeys(a)[0];if(Ext.isArray(a[b]))return;this.callParent(arguments)},setValue:function(a){var b,c,d,e,f,g,h;if(Ext.isObject(a))for(h in a)if(a.hasOwnProperty(h)){b=a[h],c=this.items.first(),d=c?c.getFormId():null,e=Ext.form.RadioManager.getWithValue(h,b,d).items,g=e.length;for(f=0;f<g;++f)e[f].setValue(!0)}return this}}),Ext.define("Ext.layout.container.Column",{extend:"Ext.layout.container.Container",alias:["layout.column"],alternateClassName:"Ext.layout.ColumnLayout",type:"column",itemCls:Ext.baseCSSPrefix+"column",targetCls:Ext.baseCSSPrefix+"column-layout-ct",columnWidthSizePolicy:{setsWidth:1,setsHeight:0},childEls:["innerCt"],manageOverflow:2,renderTpl:['<div id="{ownerId}-innerCt" class="',Ext.baseCSSPrefix,'column-inner">',"{%this.renderBody(out,values)%}",'<div class="',Ext.baseCSSPrefix,'clear"></div>',"</div>","{%this.renderPadder(out,values)%}"],getItemSizePolicy:function(a){return a.columnWidth?this.columnWidthSizePolicy:this.autoSizePolicy},beginLayout:function(){this.callParent(arguments),this.innerCt.dom.style.width=""},calculate:function(a){var b=this,c=b.getContainerSize(a),d=a.state;if(d.calculatedColumns||(d.calculatedColumns=b.calculateColumns(a)))if(b.calculateHeights(a)){b.calculateOverflow(a,c);return}b.done=!1},calculateColumns:function(a){var b=this,c=b.getContainerSize(a),d=a.getEl("innerCt",b),e=a.childItems,f=e.length,g=0,h,i,j,k,l,m;if(!a.heightModel.shrinkWrap&&!a.targetContext.hasProp("height"))return!1;c.gotWidth?(i=c.width,d.setWidth(i)):(a.targetContext.block(b,"width"),h=!0);for(j=0;j<f;++j)k=e[j],l=k.getMarginInfo().width,k.widthModel.calculated||(m=k.getProp("width"),typeof m!="number"&&(k.block(b,"width"),h=!0),g+=m+l);if(!h){i=i<g?0:i-g;for(j=0;j<f;++j)k=e[j],k.widthModel.calculated&&(l=k.marginInfo.width,m=k.target.columnWidth,m=Math.floor(m*i)-l,m=k.setWidth(m),g+=m+l);a.setContentWidth(g)}return!h},calculateHeights:function(a){var b=this,c=a.childItems,d=c.length,e,f,g;e=!1;for(f=0;f<d;++f)g=c[f],g.hasDomProp("height")||(g.domBlock(b,"height"),e=!0);return e||a.setContentHeight(b.innerCt.getHeight()+a.targetContext.getPaddingInfo().height),!e},finishedLayout:function(a){var b=a.bodyContext;b&&(Ext.isIE6||Ext.isIE7||Ext.isIEQuirks)&&b.el.repaint(),this.callParent(arguments)},getRenderTarget:function(){return this.innerCt}}),Ext.define("Ext.layout.container.Editor",{alias:"layout.editor",extend:"Ext.layout.container.Container",autoSizeDefault:{width:"field",height:"field"},getItemSizePolicy:function(a){var b=this,c=b.owner.autoSize;return b.sizePolicy||(b.sizePolicy={setsWidth:c&&c.width==="boundEl"?1:0,setsHeight:c&&c.height==="boundEl"?1:0})},calculate:function(a){var b=this,c=b.owner,d=c.autoSize,e,f;d===!0&&(d=b.autoSizeDefault),d&&(e=b.getDimension(c,d.width,"getWidth",c.width),f=b.getDimension(c,d.height,"getHeight",c.height)),a.childItems[0].setSize(e,f),a.setWidth(e),a.setHeight(f),a.setContentSize(e||c.field.getWidth(),f||c.field.getHeight())},getDimension:function(a,b,c,d){switch(b){case"boundEl":return a.boundEl[c]();case"field":return undefined;default:return d}}}),Ext.define("Ext.Editor",{extend:"Ext.container.Container",alias:"widget.editor",requires:["Ext.layout.container.Editor"],layout:"editor",allowBlur:!0,revertInvalid:!0,value:"",alignment:"c-c?",offsets:[0,0],shadow:"frame",constrain:!1,swallowKeys:!0,completeOnEnter:!0,cancelOnEsc:!0,updateEl:!1,hidden:!0,baseCls:Ext.baseCSSPrefix+"editor",initComponent:function(){var a=this,b=a.field=Ext.ComponentManager.create(a.field,"textfield");Ext.apply(b,{inEditor:!0,msgTarget:b.msgTarget=="title"?"title":"qtip"}),a.mon(b,{scope:a,blur:{fn:a.onFieldBlur,delay:1},specialkey:a.onSpecialKey}),b.grow&&a.mon(b,"autosize",a.onFieldAutosize,a,{delay:1}),a.floating={constrain:a.constrain},a.items=b,a.callParent(arguments),a.addEvents("beforestartedit","startedit","beforecomplete","complete","canceledit","specialkey")},onFieldAutosize:function(){this.updateLayout()},afterRender:function(a,b){var c=this,d=c.field,e=d.inputEl;c.callParent(arguments),e&&(e.dom.name="",c.swallowKeys&&e.swallowEvent(["keypress","keydown"]))},onSpecialKey:function(a,b){var c=this,d=b.getKey(),e=c.completeOnEnter&&d==b.ENTER,f=c.cancelOnEsc&&d==b.ESC;if(e||f)b.stopEvent(),Ext.defer(function(){e?c.completeEdit():c.cancelEdit(),a.triggerBlur&&a.triggerBlur(b)},10);c.fireEvent("specialkey",c,a,b)},startEdit:function(a,b){var c=this,d=c.field;c.completeEdit(),c.boundEl=Ext.get(a),b=Ext.isDefined(b)?b:Ext.String.trim(c.boundEl.dom.innerText||c.boundEl.dom.innerHTML),c.rendered||c.render(c.parentEl||document.body),c.fireEvent("beforestartedit",c,c.boundEl,b)!==!1&&(c.startValue=b,c.show(),d.suspendEvents(),d.reset(),d.setValue(b),d.resumeEvents(),c.realign(!0),d.focus(!1,10),d.autoSize&&d.autoSize(),c.editing=!0)},realign:function(a){var b=this;a===!0&&b.updateLayout(),b.alignTo(b.boundEl,b.alignment,b.offsets)},completeEdit:function(a){var b=this,c=b.field,d;if(!b.editing)return;c.assertValue&&c.assertValue(),d=b.getValue();if(!c.isValid()){b.revertInvalid!==!1&&b.cancelEdit(a);return}if(String(d)===String(b.startValue)&&b.ignoreNoChange){b.hideEdit(a);return}b.fireEvent("beforecomplete",b,d,b.startValue)!==!1&&(d=b.getValue(),b.updateEl&&b.boundEl&&b.boundEl.update(d),b.hideEdit(a),b.fireEvent("complete",b,d,b.startValue))},onShow:function(){var a=this;a.callParent(arguments),a.hideEl!==!1&&a.boundEl.hide(),a.fireEvent("startedit",a,a.boundEl,a.startValue)},cancelEdit:function(a){var b=this,c=b.startValue,d=b.field,e;b.editing&&(e=b.getValue(),d.suspendEvents(),b.setValue(c),d.resumeEvents(),b.hideEdit(a),b.fireEvent("canceledit",b,e,c))},hideEdit:function(a){a!==!0&&(this.editing=!1,this.hide())},onFieldBlur:function(a,b){var c=this,d;c.allowBlur===!0&&c.editing&&c.selectSameEditor!==!0&&c.completeEdit(),b&&Ext.fly(d=b.getTarget()).focusable()&&d.focus()},onHide:function(){var a=this,b=a.field;if(a.editing){a.completeEdit();return}b.hasFocus&&b.blur(),b.collapse&&b.collapse(),a.hideEl!==!1&&a.boundEl.show(),a.callParent(arguments)},setValue:function(a){this.field.setValue(a)},getValue:function(){return this.field.getValue()},beforeDestroy:function(){var a=this;Ext.destroy(a.field),delete a.field,delete a.parentEl,delete a.boundEl,a.callParent(arguments)}}),Ext.define("Ext.grid.CellEditor",{extend:"Ext.Editor",constructor:function(a){a=Ext.apply({},a),a.field&&(a.field.monitorTab=!1),this.callParent([a])},onShow:function(){var a=this,b=a.boundEl.first(),c,d;b&&(c=b.dom.lastChild,c&&c.nodeType===3&&(d=a.cellTextNode=b.dom.lastChild,a.cellTextValue=d.nodeValue,d.nodeValue=" ")),a.callParent(arguments)},onHide:function(){var a=this,b=a.boundEl.first();b&&a.cellTextNode&&(a.cellTextNode.nodeValue=a.cellTextValue,delete a.cellTextNode,delete a.cellTextValue),a.callParent(arguments)},afterRender:function(){var a=this,b=a.field;a.callParent(arguments),b.isXType("checkboxfield")&&b.mon(b.inputEl,{mousedown:a.onCheckBoxMouseDown,click:a.onCheckBoxClick,scope:a})},onCheckBoxMouseDown:function(){this.completeEdit=Ext.emptyFn},onCheckBoxClick:function(){delete this.completeEdit,this.field.focus(!1,10)},realign:function(a){var b=this,c=b.boundEl,d=c.first(),e=d.dom.childNodes,f=e.length,g=Ext.Array.clone(b.offsets),h=b.field.inputEl,i,j,k,l;b.isForTree&&(f>1||f===1&&e[0].nodeType!==3)?(i=d.last(),j=i.getOffsetsTo(d)[0]+i.getWidth(),k=d.getWidth(),l=k-j,b.editingPlugin.grid.columnLines||l--,g[0]+=j,b.addCls(Ext.baseCSSPrefix+"grid-editor-on-text-node")):l=c.getWidth()-1,a===!0&&b.field.setWidth(l),b.alignTo(c,b.alignment,g)},onEditorTab:function(a){var b=this.field;b.onEditorTab&&b.onEditorTab(a)},alignment:"tl-tl",hideEl:!1,cls:Ext.baseCSSPrefix+"small-editor "+Ext.baseCSSPrefix+"grid-editor",shim:!1,shadow:!1}),Ext.define("Ext.layout.container.Fit",{extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.FitLayout",alias:"layout.fit",itemCls:Ext.baseCSSPrefix+"fit-item",targetCls:Ext.baseCSSPrefix+"layout-fit",type:"fit",defaultMargins:{top:0,right:0,bottom:0,left:0},manageMargins:!0,sizePolicies:{0:{setsWidth:0,setsHeight:0},1:{setsWidth:1,setsHeight:0},2:{setsWidth:0,setsHeight:1},3:{setsWidth:1,setsHeight:1}},getItemSizePolicy:function(a){var b=this.owner.getSizeModel(),c=(b.width.shrinkWrap?0:1)|(b.height.shrinkWrap?0:2);return this.sizePolicies[c]},beginLayoutCycle:function(a,b){var c=this,d=a.widthModel,e=a.heightModel,f=a.childItems,g=!d.shrinkWrap,h=!e.shrinkWrap,i=f.length,j=a.targetContext.el.dom.tagName.toUpperCase()==="TD",k,l,m,n;c.callParent(arguments);for(k=0;k<i;++k)m=f[k],b||(m.widthModel.calculated==g?l=null:l={widthModel:g?c.sizeModels.calculated:m.sizeModel.width},m.heightModel.calculated!=h&&((l||(l={})).heightModel=h?c.sizeModels.calculated:m.sizeModel.height),l&&(l.before=c.onBeforeInvalidateChild,m.invalidate(l))),j&&(n=m.target.el.dom,m.heightModel.calculated&&(n.style.height=""),m.widthModel.calculated&&(n.style.width=""))},calculate:function(a){var b=this,c=a.childItems,d=c.length,e={contentWidth:0,contentHeight:0,length:d,ownerContext:a,targetSize:b.getContainerSize(a)},f=a.widthModel.shrinkWrap,g=a.heightModel.shrinkWrap,h=0,i=0,j,k;for(k=0;k<d;++k)e.index=k,b.fitItem(c[k],e);if(g||f)j=a.targetContext.getPaddingInfo(),f&&(h=j.width),g&&(i=j.height);a.setContentSize(e.contentWidth+h,e.contentHeight+i)||(b.done=!1)},fitItem:function(a,b){var c=this;if(a.invalid){c.done=!1;return}b.margins=a.getMarginInfo(),b.needed=b.got=0,c.fitItemWidth(a,b),c.fitItemHeight(a,b),b.got!=b.needed&&(c.done=!1)},fitItemWidth:function(a,b){b.ownerContext.widthModel.shrinkWrap?b.contentWidth=Math.max(b.contentWidth,a.getProp("width")+b.margins.width):a.widthModel.calculated&&(++b.needed,b.targetSize.gotWidth&&(++b.got,this.setItemWidth(a,b))),this.positionItemX(a,b)},fitItemHeight:function(a,b){b.ownerContext.heightModel.shrinkWrap?b.contentHeight=Math.max(b.contentHeight,a.getProp("height")+b.margins.height):a.heightModel.calculated&&(++b.needed,b.targetSize.gotHeight&&(++b.got,this.setItemHeight(a,b))),this.positionItemY(a,b)},onBeforeInvalidateChild:function(a,b){++a.context.progressCount,b.widthModel&&(a.widthModel=b.widthModel),b.heightModel&&(a.heightModel=b.heightModel)},positionItemX:function(a,b){var c=b.margins;(b.index||c.left)&&a.setProp("x",c.left),c.width&&a.setProp("margin-right",c.width)},positionItemY:function(a,b){var c=b.margins;(b.index||c.top)&&a.setProp("y",c.top),c.height&&a.setProp("margin-bottom",c.height)},setItemHeight:function(a,b){a.setHeight(b.targetSize.height-b.margins.height)},setItemWidth:function(a,b){a.setWidth(b.targetSize.width-b.margins.width)}}),Ext.define("Ext.layout.container.Card",{extend:"Ext.layout.container.Fit",alternateClassName:"Ext.layout.CardLayout",alias:"layout.card",type:"card",hideInactive:!0,deferredRender:!1,getRenderTree:function(){var a=this,b=a.getActiveItem();if(b){b.hasListeners.beforeactivate&&b.fireEvent("beforeactivate",b)===!1?b=a.activeItem=a.owner.activeItem=null:b.hasListeners.activate&&b.on({boxready:function(){b.fireEvent("activate",b)},single:!0});if(!a.deferredRender)return a.callParent(arguments);if(b)return a.getItemsRenderTree([b])}},renderChildren:function(){var a=this,b=a.getActiveItem();a.deferredRender?b&&a.renderItems([b],a.getRenderTarget()):a.callParent()},isValidParent:function(a,b,c){var d=a.el?a.el.dom:Ext.getDom(a);return d&&d.parentNode===(b.dom||b)||!1},getActiveItem:function(){var a=this,b=a.parseActiveItem(a.activeItem||a.owner&&a.owner.activeItem);return b&&a.owner.items.indexOf(b)!=-1?a.activeItem=b:a.activeItem=null,a.activeItem},parseActiveItem:function(a){return a&&a.isComponent?a:typeof a=="number"||a===undefined?this.getLayoutItems()[a||0]:this.owner.getComponent(a)},configureItem:function(a){a===this.getActiveItem()?a.hidden=!1:a.hidden=!0,this.callParent(arguments)},onRemove:function(a){var b=this;a===b.activeItem&&(b.activeItem=null)},getAnimation:function(a,b){var c=(a||{}).cardSwitchAnimation;return c===!1?!1:c||b.cardSwitchAnimation},getNext:function(){var a=arguments[0],b=this.getLayoutItems(),c=Ext.Array.indexOf(b,this.activeItem);return b[c+1]||(a?b[0]:!1)},next:function(){var a=arguments[0],b=arguments[1];return this.setActiveItem(this.getNext(b),a)},getPrev:function(){var a=arguments[0],b=this.getLayoutItems(),c=Ext.Array.indexOf(b,this.activeItem);return b[c-1]||(a?b[b.length-1]:!1)},prev:function(){var a=arguments[0],b=arguments[1];return this.setActiveItem(this.getPrev(b),a)},setActiveItem:function(a){var b=this,c=b.owner,d=b.activeItem,e=c.rendered,f;return a=b.parseActiveItem(a),f=c.items.indexOf(a),f==-1&&(f=c.items.items.length,Ext.suspendLayouts(),a=c.add(a),Ext.resumeLayouts()),a&&d!=a?a.fireEvent("beforeactivate",a,d)===!1?!1:d&&d.fireEvent("beforedeactivate",d,a)===!1?!1:(e?(Ext.suspendLayouts(),a.rendered||b.renderItem(a,b.getRenderTarget(),c.items.length),d&&(b.hideInactive&&(d.hide(),d.hiddenByLayout=!0),d.fireEvent("deactivate",d,a)),a.hidden&&a.show(),a.hidden||(b.activeItem=a),Ext.resumeLayouts(!0)):b.activeItem=a,a.fireEvent("activate",a,d),b.activeItem):!1}}),Ext.define("Ext.layout.container.Form",{alias:"layout.form",extend:"Ext.layout.container.Auto",alternateClassName:"Ext.layout.FormLayout",tableCls:Ext.baseCSSPrefix+"form-layout-table",type:"form",manageOverflow:2,childEls:["formTable"],padRow:'<tr><td class="'+Ext.baseCSSPrefix+'form-item-pad" colspan="3"></td></tr>',renderTpl:['<table id="{ownerId}-formTable" class="{tableCls}" style="width:100%" cellpadding="0">',"{%this.renderBody(out,values)%}","</table>","{%this.renderPadder(out,values)%}"],getRenderData:function(){var a=this.callParent();return a.tableCls=this.tableCls,a},calculate:function(a){var b=this,c=b.getContainerSize(a,!0),d,e,f=0,g;if(c.gotWidth){this.callParent(arguments),d=b.formTable.dom.offsetWidth,e=a.childItems;for(g=e.length;f<g;++f)e[f].setWidth(d,!1)}else b.done=!1},getRenderTarget:function(){return this.formTable},getRenderTree:function(){var a=this.callParent(arguments),b=0,c=a.length,d;for(;b<c;b++)d=a[b],d.tag&&d.tag=="table"?(d.tag="tbody",delete d.cellspacing,delete d.cellpadding,Ext.isIE6&&(d.cn=this.padRow)):a[b]={tag:"tbody",cn:{tag:"tr",cn:{tag:"td",colspan:3,style:"width:100%",cn:d}}};return a},isValidParent:function(a,b,c){return!0},isItemShrinkWrap:function(a){return(a.shrinkWrap===!0?3:a.shrinkWrap||0)&2},getItemSizePolicy:function(a){return{setsWidth:1,setsHeight:0}}}),Ext.define("Ext.layout.container.Table",{alias:["layout.table"],extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.TableLayout",monitorResize:!1,type:"table",clearEl:!0,targetCls:Ext.baseCSSPrefix+"table-layout-ct",tableCls:Ext.baseCSSPrefix+"table-layout",cellCls:Ext.baseCSSPrefix+"table-layout-cell",tableAttrs:null,itemSizePolicy:{setsWidth:0,setsHeight:0},getItemSizePolicy:function(a){return this.itemSizePolicy},getLayoutItems:function(){var a=this,b=[],c=a.callParent(),d,e=c.length,f;for(f=0;f<e;f++)d=c[f],d.hidden||b.push(d);return b},renderChildren:function(){var a=this,b=a.getLayoutItems(),c=a.owner.getTargetEl().child("table",!0).tBodies[0],d=c.rows,e=0,f=b.length,g,h,i,j,k,l,m,n;g=a.calculateCells(b);for(;e<f;e++){h=g[e],i=h.rowIdx,j=h.cellIdx,k=b[e],l=d[i],l||(l=c.insertRow(i),a.trAttrs&&l.set(a.trAttrs)),n=m=Ext.get(l.cells[j]||l.insertCell(j)),a.needsDivWrap()&&(n=m.first()||m.createChild({tag:"div"}),n.setWidth(null)),k.rendered?a.isValidParent(k,n,i,j,c)||a.moveItem(k,n,0):a.renderItem(k,n,0),a.tdAttrs&&m.set(a.tdAttrs),k.tdAttrs&&m.set(k.tdAttrs),m.set({colSpan:k.colspan||1,rowSpan:k.rowspan||1,id:k.cellId||"",cls:a.cellCls+" "+(k.cellCls||"")});if(!g[e+1]||g[e+1].rowIdx!==i){j++;while(l.cells[j])l.deleteCell(j)}}i++;while(c.rows[i])c.deleteRow(i)},calculate:function(a){if(!a.hasDomProp("containerChildrenDone"))this.done=!1;else{var b=a.targetContext,c=a.widthModel.shrinkWrap,d=a.heightModel.shrinkWrap,e=d||c,f=e&&b.el.child("table",!0),g=e&&b.getPaddingInfo();c&&a.setContentWidth(f.offsetWidth+g.width,!0),d&&a.setContentHeight(f.offsetHeight+g.height,!0)}},finalizeLayout:function(){if(this.needsDivWrap()){var a=this.getLayoutItems(),b,c=a.length,d;for(b=0;b<c;b++)d=a[b],Ext.fly(d.el.dom.parentNode).setWidth(d.getWidth())}(Ext.isIE6||Ext.isIEQuirks)&&this.owner.getTargetEl().child("table").repaint()},calculateCells:function(a){var b=[],c=0,d=0,e=0,f=this.columns||Infinity,g=[],h=0,i,j=a.length,k;for(;h<j;h++){k=a[h];while(d>=f||g[d]>0)if(d>=f){d=0,e=0,c++;for(i=0;i<f;i++)g[i]>0&&g[i]--}else d++;b.push({rowIdx:c,cellIdx:e});for(i=k.colspan||1;i;--i)g[d]=k.rowspan||1,++d;++e}return b},getRenderTree:function(){var a=this,b=a.getLayoutItems(),c,d=[],e=Ext.apply({tag:"table",role:"presentation",cls:a.tableCls,cellspacing:0,cn:{tag:"tbody",cn:d}},a.tableAttrs),f=a.tdAttrs,g=a.needsDivWrap(),h,i=b.length,j,k,l,m,n,o;c=a.calculateCells(b);for(h=0;h<i;h++)j=b[h],k=c[h],m=k.rowIdx,n=k.cellIdx,l=d[m],l||(l=d[m]={tag:"tr",cn:[]},a.trAttrs&&Ext.apply(l,a.trAttrs)),o=l.cn[n]={tag:"td"},f&&Ext.apply(o,f),Ext.apply(o,{colSpan:j.colspan||1,rowSpan:j.rowspan||1,id:j.cellId||"",cls:a.cellCls+" "+(j.cellCls||"")}),g&&(o=o.cn={tag:"div"}),a.configureItem(j),o.cn=j.getRenderTree();return e},isValidParent:function(a,b,c,d){var e,f,g;return arguments.length===3?(g=a.el.up("table"),g&&g.dom.parentNode===b.dom):(e=this.owner.getTargetEl().child("table",!0).tBodies[0],f=e.rows[c].cells[d],a.el.dom.parentNode===f)},needsDivWrap:function(){return Ext.isOpera10_5}}),Ext.define("Ext.layout.container.boxOverflow.Scroller",{extend:"Ext.layout.container.boxOverflow.None",requires:["Ext.util.ClickRepeater","Ext.Element"],alternateClassName:"Ext.layout.boxOverflow.Scroller",mixins:{observable:"Ext.util.Observable"},animateScroll:!1,scrollIncrement:20,wheelIncrement:10,scrollRepeatInterval:60,scrollDuration:400,scrollerCls:Ext.baseCSSPrefix+"box-scroller",constructor:function(a,b){var c=this;c.layout=a,Ext.apply(c,b||{}),c.mixins.observable.constructor.call(c),c.addEvents("scroll"),c.scrollPosition=0,c.scrollSize=0},getPrefixConfig:function(){var a=this;return a.initCSSClasses(),{cls:Ext.layout.container.Box.prototype.innerCls+" "+a.beforeCtCls,cn:{id:a.layout.owner.id+"-before-scroller",cls:a.scrollerCls+" "+a.beforeScrollerCls,style:"display:none"}}},getSuffixConfig:function(){var a=this;return{cls:Ext.layout.container.Box.prototype.innerCls+" "+a.afterCtCls,cn:{id:a.layout.owner.id+"-after-scroller",cls:a.scrollerCls+" "+a.afterScrollerCls,style:"display:none"}}},getOverflowCls:function(){return Ext.baseCSSPrefix+this.layout.direction+"-box-overflow-body"},initCSSClasses:function(){var a=this,b=Ext.baseCSSPrefix,c=a.layout,d=c.getNames(),e=d.left,f=d.right,g=a.getOwnerType(c.owner);a.beforeCtCls=a.beforeCtCls||b+"box-scroller-"+e,a.afterCtCls=a.afterCtCls||b+"box-scroller-"+f,a.beforeScrollerCls=a.beforeScrollerCls||b+g+"-scroll-"+e,a.afterScrollerCls=a.afterScrollerCls||b+g+"-scroll-"+f},beginLayout:function(a){var b=this.layout,c=b.getNames();a.innerCtScrollPos=b.innerCt.dom["scroll"+c.leftCap],this.callParent(arguments)},completeLayout:function(a){this.scrollSize=a.props["content"+this.layout.getNames().widthCap],this.callParent(arguments)},finishedLayout:function(a){var b=this,c=b.layout,d=c.getNames(),e=Math.min(b.getMaxScrollPosition(),a.innerCtScrollPos);c.innerCt.dom["scroll"+d.leftCap]=e},handleOverflow:function(a){var b=this,c=b.layout,d=c.getNames(),e="get"+d.widthCap;return b.captureChildElements(),b.showScrollers(),{reservedSpace:b.beforeCt[e]()+b.afterCt[e]()}},captureChildElements:function(){var a=this,b=a.layout.owner.el,c,d;a.beforeCt||(c=a.beforeScroller=b.getById(a.layout.owner.id+"-before-scroller"),d=a.afterScroller=b.getById(a.layout.owner.id+"-after-scroller"),a.beforeCt=c.up(""),a.afterCt=d.up(""),a.createWheelListener(),c.addClsOnOver(a.beforeScrollerCls+"-hover"),d.addClsOnOver(a.afterScrollerCls+"-hover"),c.setVisibilityMode(Ext.Element.DISPLAY),d.setVisibilityMode(Ext.Element.DISPLAY),a.beforeRepeater=new Ext.util.ClickRepeater(c,{interval:a.scrollRepeatInterval,handler:a.scrollLeft,scope:a}),a.afterRepeater=new Ext.util.ClickRepeater(d,{interval:a.scrollRepeatInterval,handler:a.scrollRight,scope:a}))},createWheelListener:function(){this.layout.innerCt.on({mousewheel:function(a){this.scrollBy(a.getWheelDelta()*this.wheelIncrement*-1,!1)},stopEvent:!0,scope:this})},clearOverflow:function(){var a=this.layout;this.hideScrollers()},showScrollers:function(){var a=this;a.captureChildElements(),a.beforeScroller.show(),a.afterScroller.show(),a.updateScrollButtons(),a.layout.owner.addClsWithUI("scroller")},hideScrollers:function(){var a=this;a.beforeScroller!==undefined&&(a.beforeScroller.hide(),a.afterScroller.hide(),a.layout.owner.removeClsWithUI("scroller"))},destroy:function(){var a=this;Ext.destroy(a.beforeRepeater,a.afterRepeater,a.beforeScroller,a.afterScroller,a.beforeCt,a.afterCt)},scrollBy:function(a,b){this.scrollTo(this.getScrollPosition()+a,b)},getScrollAnim:function(){return{duration:this.scrollDuration,callback:this.updateScrollButtons,scope:this}},updateScrollButtons:function(){var a=this,b,c,d,e;if(a.beforeScroller===undefined||a.afterScroller===undefined)return;b=a.atExtremeBefore()?"addCls":"removeCls",c=a.atExtremeAfter()?"addCls":"removeCls",d=a.beforeScrollerCls+"-disabled",e=a.afterScrollerCls+"-disabled",a.beforeScroller[b](d),a.afterScroller[c](e),a.scrolling=!1},atExtremeBefore:function(){return!this.getScrollPosition()},scrollLeft:function(){this.scrollBy(-this.scrollIncrement,!1)},scrollRight:function(){this.scrollBy(this.scrollIncrement,!1)},getScrollPosition:function(){var a=this,b=a.layout,c;return a.hasOwnProperty("scrollPosition")?c=a.scrollPosition:c=parseInt(b.innerCt.dom["scroll"+b.getNames().leftCap],10)||0,c},getMaxScrollPosition:function(){var a=this,b=a.layout,c=b.getNames(),d=a.scrollSize-b.innerCt["get"+c.widthCap]();return d<0?0:d},atExtremeAfter:function(){return this.getScrollPosition()>=this.getMaxScrollPosition()},scrollTo:function(a,b){var c=this,d=c.layout,e=d.getNames(),f=c.getScrollPosition(),g=Ext.Number.constrain(a,0,c.getMaxScrollPosition());g!=f&&!c.scrolling&&(delete c.scrollPosition,b===undefined&&(b=c.animateScroll),d.innerCt.scrollTo(e.left,g,b?c.getScrollAnim():!1),b?c.scrolling=!0:c.updateScrollButtons(),c.fireEvent("scroll",c,g,b?c.getScrollAnim():!1))},scrollToItem:function(a,b){var c=this,d=c.layout,e=d.getNames(),f,g,h;a=c.getItem(a),a!==undefined&&(f=c.getItemVisibility(a),f.fullyVisible||(g=a.getBox(!0,!0),h=g[e.x],f.hiddenEnd&&(h-=c.layout.innerCt["get"+e.widthCap]()-g[e.width]),c.scrollTo(h,b)))},getItemVisibility:function(a){var b=this,c=b.getItem(a).getBox(!0,!0),d=b.layout,e=d.getNames(),f=c[e.x],g=f+c[e.width],h=b.getScrollPosition(),i=h+d.innerCt["get"+e.widthCap]();return{hiddenStart:f<h,hiddenEnd:g>i,fullyVisible:f>h&&g<i}}}),Ext.define("Ext.menu.Item",{extend:"Ext.Component",alias:"widget.menuitem",alternateClassName:"Ext.menu.TextItem",activeCls:Ext.baseCSSPrefix+"menu-item-active",ariaRole:"menuitem",canActivate:!0,clickHideDelay:1,destroyMenu:!0,disabledCls:Ext.baseCSSPrefix+"menu-item-disabled",hideOnClick:!0,isMenuItem:!0,menuAlign:"tl-tr?",menuExpandDelay:200,menuHideDelay:200,tooltipType:"qtip",arrowCls:Ext.baseCSSPrefix+"menu-item-arrow",childEls:["itemEl","iconEl","textEl","arrowEl"],renderTpl:['<tpl if="plain">',"{text}","<tpl else>",'<a id="{id}-itemEl" class="'+Ext.baseCSSPrefix+'menu-item-link" href="{href}" <tpl if="hrefTarget">target="{hrefTarget}"</tpl> hidefocus="true" unselectable="on">','<img id="{id}-iconEl" src="{icon}" class="'+Ext.baseCSSPrefix+'menu-item-icon {iconCls}" />','<span id="{id}-textEl" class="'+Ext.baseCSSPrefix+'menu-item-text" <tpl if="arrowCls">style="margin-right: 17px;"</tpl> >{text}</span>','<img id="{id}-arrowEl" src="{blank}" class="{arrowCls}" />',"</a>","</tpl>"],maskOnDisable:!1,activate:function(){var a=this;!a.activated&&a.canActivate&&a.rendered&&!a.isDisabled()&&a.isVisible()&&(a.el.addCls(a.activeCls),a.focus(),a.activated=!0,a.fireEvent("activate",a))},getFocusEl:function(){return this.itemEl},deactivate:function(){var a=this;a.activated&&(a.el.removeCls(a.activeCls),a.blur(),a.hideMenu(),a.activated=!1,a.fireEvent("deactivate",a))},deferExpandMenu:function(){var a=this;a.activated&&(!a.menu.rendered||!a.menu.isVisible())&&(a.parentMenu.activeChild=a.menu,a.menu.parentItem=a,a.menu.parentMenu=a.menu.ownerCt=a.parentMenu,a.menu.showBy(a,a.menuAlign))},deferHideMenu:function(){this.menu.isVisible()&&this.menu.hide()},cancelDeferHide:function(){clearTimeout(this.hideMenuTimer)},deferHideParentMenus:function(){var a;Ext.menu.Manager.hideAll(),Ext.Element.getActiveElement()||(a=this.up(":not([hidden])"),a&&a.focus())},expandMenu:function(a){var b=this;b.menu&&(b.cancelDeferHide(),a===0?b.deferExpandMenu():b.expandMenuTimer=Ext.defer(b.deferExpandMenu,Ext.isNumber(a)?a:b.menuExpandDelay,b))},getRefItems:function(a){var b=this.menu,c;return b&&(c=b.getRefItems(a),c.unshift(b)),c||[]},hideMenu:function(a){var b=this;b.menu&&(clearTimeout(b.expandMenuTimer),b.hideMenuTimer=Ext.defer(b.deferHideMenu,Ext.isNumber(a)?a:b.menuHideDelay,b))},initComponent:function(){var a=this,b=Ext.baseCSSPrefix,c=[b+"menu-item"],d;a.addEvents("activate","click","deactivate"),a.plain&&c.push(b+"menu-item-plain"),a.cls&&c.push(a.cls),a.cls=c.join(" "),a.menu&&(d=a.menu,delete a.menu,a.setMenu(d)),a.callParent(arguments)},onClick:function(a){var b=this;b.href||a.stopEvent();if(b.disabled)return;b.hideOnClick&&(b.deferHideParentMenusTimer=Ext.defer(b.deferHideParentMenus,b.clickHideDelay,b)),Ext.callback(b.handler,b.scope||b,[b,a]),b.fireEvent("click",b,a),b.hideOnClick||b.focus()},onRemoved:function(){var a=this;a.activated&&a.parentMenu.activeItem===a&&a.parentMenu.deactivateActiveItem(),a.callParent(arguments),delete a.parentMenu,delete a.ownerButton},beforeDestroy:function(){var a=this;a.rendered&&a.clearTip(),a.callParent()},onDestroy:function(){var a=this;clearTimeout(a.expandMenuTimer),a.cancelDeferHide(),clearTimeout(a.deferHideParentMenusTimer),a.setMenu(null),a.callParent(arguments)},beforeRender:function(){var a=this,b=Ext.BLANK_IMAGE_URL;a.callParent(),Ext.applyIf(a.renderData,{href:a.href||"#",hrefTarget:a.hrefTarget,icon:a.icon||b,iconCls:a.iconCls+(a.checkChangeDisabled?" "+a.disabledCls:""),plain:a.plain,text:a.text,arrowCls:a.menu?a.arrowCls:"",blank:b})},onRender:function(){var a=this;a.callParent(arguments),a.tooltip&&a.setTooltip(a.tooltip,!0)},setMenu:function(a,b){var c=this,d=c.menu;d&&(delete d.parentItem,delete d.parentMenu,delete d.ownerCt,delete d.ownerItem,(b===!0||b!==!1&&c.destroyMenu)&&Ext.destroy(d)),a?(c.menu=Ext.menu.Manager.get(a),c.menu.ownerItem=c):c.menu=null,c.rendered&&!c.destroying&&c.arrowEl[c.menu?"addCls":"removeCls"](c.arrowCls)},setHandler:function(a,b){this.handler=a||null,this.scope=b},setIcon:function(a){var b=this.iconEl;b&&(b.src=a||Ext.BLANK_IMAGE_URL),this.icon=a},setIconCls:function(a){var b=this,c=b.iconEl;c&&(b.iconCls&&c.removeCls(b.iconCls),a&&c.addCls(a)),b.iconCls=a},setText:function(a){var b=this,c=b.textEl||b.el;b.text=a,b.rendered&&(c.update(a||""),b.ownerCt.updateLayout())},getTipAttr:function(){return this.tooltipType=="qtip"?"data-qtip":"title"},clearTip:function(){Ext.isObject(this.tooltip)&&Ext.tip.QuickTipManager.unregister(this.itemEl)},setTooltip:function(a,b){var c=this;return c.rendered?(b||c.clearTip(),Ext.isObject(a)?(Ext.tip.QuickTipManager.register(Ext.apply({target:c.itemEl.id},a)),c.tooltip=a):c.itemEl.dom.setAttribute(c.getTipAttr(),a)):c.tooltip=a,c}}),Ext.define("Ext.menu.CheckItem",{extend:"Ext.menu.Item",alias:"widget.menucheckitem",checkedCls:Ext.baseCSSPrefix+"menu-item-checked",uncheckedCls:Ext.baseCSSPrefix+"menu-item-unchecked",groupCls:Ext.baseCSSPrefix+"menu-group-icon",hideOnClick:!1,checkChangeDisabled:!1,afterRender:function(){var a=this;a.callParent(),a.checked=!a.checked,a.setChecked(!a.checked,!0),a.checkChangeDisabled&&a.disableCheckChange()},initComponent:function(){var a=this;a.addEvents("beforecheckchange","checkchange"),a.callParent(arguments),Ext.menu.Manager.registerCheckable(a),a.group&&(a.iconCls||(a.iconCls=a.groupCls),a.initialConfig.hideOnClick!==!1&&(a.hideOnClick=!0))},disableCheckChange:function(){var a=this,b=a.iconEl;b&&b.addCls(a.disabledCls),a.checkChangeDisabled=!0},enableCheckChange:function(){var a=this,b=a.iconEl;b&&b.removeCls(a.disabledCls),a.checkChangeDisabled=!1},onClick:function(a){var b=this;!b.disabled&&!b.checkChangeDisabled&&(!b.checked||!b.group)&&b.setChecked(!b.checked),this.callParent([a])},onDestroy:function(){Ext.menu.Manager.unregisterCheckable(this),this.callParent(arguments)},setChecked:function(a,b){var c=this;c.checked!==a&&(b||c.fireEvent("beforecheckchange",c,a)!==!1)&&(c.el&&c.el[a?"addCls":"removeCls"](c.checkedCls)[a?"removeCls":"addCls"](c.uncheckedCls),c.checked=a,Ext.menu.Manager.onCheckChange(c,a),b||(Ext.callback(c.checkHandler,c.scope,[c,a]),c.fireEvent("checkchange",c,a)))}}),Ext.define("Ext.menu.KeyNav",{extend:"Ext.util.KeyNav",requires:["Ext.FocusManager"],constructor:function(a){var b=this;b.menu=a,b.callParent([a.el,{down:b.down,enter:b.enter,esc:b.escape,left:b.left,right:b.right,space:b.enter,tab:b.tab,up:b.up}])},down:function(a){var b=this,c=b.menu.focusedItem;if(c&&a.getKey()==Ext.EventObject.DOWN&&b.isWhitelisted(c))return!0;b.focusNextItem(1)},enter:function(a){var b=this.menu,c=b.focusedItem;if(b.activeItem)b.onClick(a);else if(c&&c.isFormField)return!0},escape:function(a){Ext.menu.Manager.hideAll()},focusNextItem:function(a){var b=this.menu,c=b.items,d=b.focusedItem,e=d?c.indexOf(d):-1,f=e+a,g;while(f!=e){f<0?f=c.length-1:f>=c.length&&(f=0),g=c.getAt(f);if(b.canActivateItem(g)){b.setActiveItem(g);break}f+=a}},isWhitelisted:function(a){return Ext.FocusManager.isWhitelisted(a)},left:function(a){var b=this.menu,c=b.focusedItem,d=b.activeItem;if(c&&this.isWhitelisted(c))return!0;b.hide(),b.parentMenu&&b.parentMenu.focus()},right:function(a){var b=this.menu,c=b.focusedItem,d=b.activeItem,e;if(c&&this.isWhitelisted(c))return!0;d&&(e=b.activeItem.menu,e&&(d.expandMenu(0),Ext.defer(function(){e.setActiveItem(e.items.getAt(0))},25)))},tab:function(a){var b=this;a.shiftKey?b.up(a):b.down(a)},up:function(a){var b=this,c=b.menu.focusedItem;if(c&&a.getKey()==Ext.EventObject.UP&&b.isWhitelisted(c))return!0;b.focusNextItem(-1)}}),Ext.define("Ext.menu.Manager",{singleton:!0,requires:["Ext.util.MixedCollection","Ext.util.KeyMap"],alternateClassName:"Ext.menu.MenuMgr",uses:["Ext.menu.Menu"],menus:{},groups:{},attached:!1,lastShow:new Date,init:function(){var a=this;a.active=new Ext.util.MixedCollection,Ext.getDoc().addKeyListener(27,function(){a.active.length>0&&a.hideAll()},a)},hideAll:function(){var a=this.active,b,c,d,e;if(a&&a.length>0){b=a.clone(),c=b.items,e=c.length;for(d=0;d<e;d++)c[d].hide();return!0}return!1},onHide:function(a){var b=this,c=b.active;c.remove(a),c.length<1&&(Ext.getDoc().un("mousedown",b.onMouseDown,b),b.attached=!1)},onShow:function(a){var b=this,c=b.active,d=c.last(),e=b.attached,f=a.getEl(),g;b.lastShow=new Date,c.add(a),e||(Ext.getDoc().on("mousedown",b.onMouseDown,b,{buffer:Ext.isIE?10:undefined}),b.attached=!0),a.toFront()},onBeforeHide:function(a){a.activeChild&&a.activeChild.hide(),a.autoHideTimer&&(clearTimeout(a.autoHideTimer),delete a.autoHideTimer)},onBeforeShow:function(a){var b=this.active,c=a.parentMenu;b.remove(a),!c&&!a.allowOtherMenus?this.hideAll():c&&c.activeChild&&a!=c.activeChild&&c.activeChild.hide()},onMouseDown:function(a){var b=this,c=b.active,d=b.lastShow;Ext.Date.getElapsed(d)>50&&c.length>0&&!a.getTarget("."+Ext.baseCSSPrefix+"menu")&&b.hideAll()},register:function(a){var b=this;b.active||b.init(),a.floating&&(b.menus[a.id]=a,a.on({beforehide:b.onBeforeHide,hide:b.onHide,beforeshow:b.onBeforeShow,show:b.onShow,scope:b}))},get:function(a){var b=this.menus;return typeof a=="string"?b?b[a]:null:a.isMenu?a:Ext.isArray(a)?new Ext.menu.Menu({items:a}):Ext.ComponentManager.create(a,"menu")},unregister:function(a){var b=this,c=b.menus,d=b.active;delete c[a.id],d.remove(a),a.un({beforehide:b.onBeforeHide,hide:b.onHide,beforeshow:b.onBeforeShow,show:b.onShow,scope:b})},registerCheckable:function(a){var b=this.groups,c=a.group;c&&(b[c]||(b[c]=[]),b[c].push(a))},unregisterCheckable:function(a){var b=this.groups,c=a.group;c&&Ext.Array.remove(b[c],a)},onCheckChange:function(a,b){var c=this.groups,d=a.group,e=0,f,g,h;if(d&&b){f=c[d],g=f.length;for(;e<g;e++)h=f[e],h!=a&&h.setChecked(!1)}}}),Ext.define("Ext.button.Button",{alias:"widget.button",extend:"Ext.Component",requires:["Ext.menu.Manager","Ext.util.ClickRepeater","Ext.layout.component.Button","Ext.util.TextMetrics","Ext.util.KeyMap"],alternateClassName:"Ext.Button",isButton:!0,componentLayout:"button",hidden:!1,disabled:!1,pressed:!1,enableToggle:!1,menuAlign:"tl-bl?",textAlign:"center",type:"button",clickEvent:"click",preventDefault:!0,handleMouseEvents:!0,tooltipType:"qtip",baseCls:Ext.baseCSSPrefix+"btn",pressedCls:"pressed",overCls:"over",focusCls:"focus",menuActiveCls:"menu-active",hrefTarget:"_blank",border:!0,childEls:["btnEl","btnWrap","btnInnerEl","btnIconEl"],renderTpl:['<em id="{id}-btnWrap"<tpl if="splitCls"> class="{splitCls}"</tpl>>','<tpl if="href">','<a id="{id}-btnEl" href="{href}" class="{btnCls}" target="{hrefTarget}"','<tpl if="tabIndex"> tabIndex="{tabIndex}"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>',' role="link">','<span id="{id}-btnInnerEl" class="{baseCls}-inner">',"{text}","</span>",'<span id="{id}-btnIconEl" class="{baseCls}-icon {iconCls}"<tpl if="iconUrl"> style="background-image:url({iconUrl})"</tpl>></span>',"</a>","<tpl else>",'<button id="{id}-btnEl" type="{type}" class="{btnCls}" hidefocus="true"','<tpl if="tabIndex"> tabIndex="{tabIndex}"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>',' role="button" autocomplete="off">','<span id="{id}-btnInnerEl" class="{baseCls}-inner" style="{innerSpanStyle}">',"{text}","</span>",'<span id="{id}-btnIconEl" class="{baseCls}-icon {iconCls}"<tpl if="iconUrl"> style="background-image:url({iconUrl})"</tpl>></span>',"</button>","</tpl>","</em>",'<tpl if="closable">','<a id="{id}-closeEl" href="#" class="{baseCls}-close-btn" title="{closeText}"></a>',"</tpl>"],scale:"small",allowedScales:["small","medium","large"],iconAlign:"left",arrowAlign:"right",arrowCls:"arrow",maskOnDisable:!1,persistentPadding:undefined,shrinkWrap:3,frame:!0,initComponent:function(){var a=this;a.callParent(arguments),a.addEvents("click","toggle","mouseover","mouseout","menushow","menuhide","menutriggerover","menutriggerout"),a.menu&&(a.split=!0,a.menu=Ext.menu.Manager.get(a.menu),a.menu.ownerButton=a),a.url&&(a.href=a.url),a.href&&!a.hasOwnProperty("preventDefault")&&(a.preventDefault=!1),Ext.isString(a.toggleGroup)&&(a.enableToggle=!0)},getActionEl:function(){return this.btnEl},getFocusEl:function(){return this.inOnFocus?this.el:this.btnEl},onFocus:function(a){var b=this;b.inOnFocus=!0,b.callParent(arguments),b.inOnFocus=!1},onBlur:function(a){var b=this,c=b.focusCls,d=b.getEl();if(b.destroying)return;b.beforeBlur(a),c&&d&&d.removeCls(b.removeClsWithUI(c,!0)),b.validateOnBlur&&b.validate(),b.hasFocus=!1,b.fireEvent("blur",b,a),b.postBlur(a)},setComponentCls:function(){var a=this,b=a.getComponentCls();Ext.isEmpty(a.oldCls)||(a.removeClsWithUI(a.oldCls),a.removeClsWithUI(a.pressedCls)),a.oldCls=b,a.addClsWithUI(b)},getComponentCls:function(){var a=this,b=[];return a.iconCls||a.icon?a.text?b.push("icon-text-"+a.iconAlign):b.push("icon"):a.text&&b.push("noicon"),a.pressed&&b.push(a.pressedCls),b},beforeRender:function(){var a=this;a.callParent(),a.oldCls=a.getComponentCls(),a.addClsWithUI(a.oldCls),Ext.applyIf(a.renderData,a.getTemplateArgs()),a.scale&&a.setScale(a.scale)},onRender:function(){var a=this,b,c;a.doc=Ext.getDoc(),a.callParent(arguments),a.split&&a.arrowTooltip&&a.arrowEl.dom.setAttribute(a.getTipAttr(),a.arrowTooltip),b=a.el,a.tooltip&&a.setTooltip(a.tooltip,!0),a.handleMouseEvents?(c={scope:a,mouseover:a.onMouseOver,mouseout:a.onMouseOut,mousedown:a.onMouseDown},a.split&&(c.mousemove=a.onMouseMove)):c={scope:a},a.menu&&(a.mon(a.menu,{scope:a,show:a.onMenuShow,hide:a.onMenuHide}),a.keyMap=new Ext.util.KeyMap({target:a.el,key:Ext.EventObject.DOWN,handler:a.onDownKey,scope:a})),a.repeat?a.mon(new Ext.util.ClickRepeater(b,Ext.isObject(a.repeat)?a.repeat:{}),"click",a.onRepeatClick,a):c[a.clickEvent]=a.onClick,a.mon(b,c),Ext.ButtonToggleManager.register(a)},getTemplateArgs:function(){var a=this,b=a.getPersistentPadding(),c="";return Math.max.apply(Math,b)>0&&(c="margin:"+Ext.Array.map(b,function(a){return-a+"px"}).join(" ")),{href:a.getHref(),disabled:a.disabled,hrefTarget:a.hrefTarget,type:a.type,btnCls:a.getBtnCls(),splitCls:a.getSplitCls(),iconUrl:a.icon,iconCls:a.iconCls,text:a.text||"&#160;",tabIndex:a.tabIndex,innerSpanStyle:c}},getHref:function(){var a=this,b=Ext.apply({},a.baseParams);return b=Ext.apply(b,a.params),a.href?Ext.urlAppend(a.href,Ext.Object.toQueryString(b)):!1},setParams:function(a){this.params=a,this.btnEl.dom.href=this.getHref()},getSplitCls:function(){var a=this;return a.split?a.baseCls+"-"+a.arrowCls+" "+(a.baseCls+"-"+a.arrowCls+"-"+a.arrowAlign):""},getBtnCls:function(){return this.textAlign?this.baseCls+"-"+this.textAlign:""},setIconCls:function(a){var b=this,c=b.btnIconEl,d=b.iconCls;return b.iconCls=a,c&&(c.removeCls(d),c.addCls(a||""),b.setComponentCls(),b.didIconStateChange(d,a)&&b.updateLayout()),b},setTooltip:function(a,b){var c=this;return c.rendered?(b||c.clearTip(),Ext.isObject(a)?(Ext.tip.QuickTipManager.register(Ext.apply({target:c.btnEl.id},a)),c.tooltip=a):c.btnEl.dom.setAttribute(c.getTipAttr(),a)):c.tooltip=a,c},setTextAlign:function(a){var b=this,c=b.btnEl;return c&&(c.removeCls(b.baseCls+"-"+b.textAlign),c.addCls(b.baseCls+"-"+a)),b.textAlign=a,b},getTipAttr:function(){return this.tooltipType=="qtip"?"data-qtip":"title"},getRefItems:function(a){var b=this.menu,c;return b&&(c=b.getRefItems(a),c.unshift(b)),c||[]},clearTip:function(){Ext.isObject(this.tooltip)&&Ext.tip.QuickTipManager.unregister(this.btnEl)},beforeDestroy:function(){var a=this;a.rendered&&a.clearTip(),a.menu&&a.destroyMenu!==!1&&Ext.destroy(a.menu),Ext.destroy(a.btnInnerEl,a.repeater),a.callParent()},onDestroy:function(){var a=this;a.rendered&&(a.doc.un("mouseover",a.monitorMouseOver,a),a.doc.un("mouseup",a.onMouseUp,a),delete a.doc,Ext.ButtonToggleManager.unregister(a),Ext.destroy(a.keyMap),delete a.keyMap),a.callParent()},setHandler:function(a,b){return this.handler=a,this.scope=b,this},setText:function(a){var b=this;return b.text=a,b.rendered&&(b.btnInnerEl.update(a||"&#160;"),b.setComponentCls(),Ext.isStrict&&Ext.isIE8&&b.el.repaint(),b.updateLayout()),b},setIcon:function(a){var b=this,c=b.btnIconEl,d=b.icon;return b.icon=a,c&&(c.setStyle("background-image",a?"url("+a+")":""),b.setComponentCls(),b.didIconStateChange(d,a)&&b.updateLayout()),b},didIconStateChange:function(a,b){var c=Ext.isEmpty(b);return Ext.isEmpty(a)?!c:c},getText:function(){return this.text},toggle:function(a,b){var c=this;return a=a===undefined?!c.pressed:!!a,a!==c.pressed&&(c.rendered&&c[a?"addClsWithUI":"removeClsWithUI"](c.pressedCls),c.pressed=a,b||(c.fireEvent("toggle",c,a),Ext.callback(c.toggleHandler,c.scope||c,[c,a]))),c},maybeShowMenu:function(){var a=this;a.menu&&!a.hasVisibleMenu()&&!a.ignoreNextClick&&a.showMenu()},showMenu:function(){var a=this;return a.rendered&&a.menu&&(a.tooltip&&a.getTipAttr()!="title"&&Ext.tip.QuickTipManager.getQuickTip().cancelShow(a.btnEl),a.menu.isVisible()&&a.menu.hide(),a.menu.showBy(a.el,a.menuAlign,!Ext.isStrict&&Ext.isIE||Ext.isIE6?[-2,-2]:undefined)),a},hideMenu:function(){return this.hasVisibleMenu()&&this.menu.hide(),this},hasVisibleMenu:function(){var a=this.menu;return a&&a.rendered&&a.isVisible()},onRepeatClick:function(a,b){this.onClick(b)},onClick:function(a){var b=this;(b.preventDefault||b.disabled&&b.getHref()&&a)&&a.preventDefault();if(a.button!==0)return;b.disabled||(b.doToggle(),b.maybeShowMenu(),b.fireHandler(a))},fireHandler:function(a){var b=this,c=b.handler;b.fireEvent("click",b,a)!==!1&&(c&&c.call(b.scope||b,b,a),b.blur())},doToggle:function(){var a=this;a.enableToggle&&(a.allowDepress!==!1||!a.pressed)&&a.toggle()},onMouseOver:function(a){var b=this;!b.disabled&&!a.within(b.el,!0,!0)&&b.onMouseEnter(a)},onMouseOut:function(a){var b=this;a.within(b.el,!0,!0)||(b.overMenuTrigger&&b.onMenuTriggerOut(a),b.onMouseLeave(a))},onMouseMove:function(a){var b=this,c=b.el,d=b.overMenuTrigger,e,f;b.split&&(b.arrowAlign==="right"?(e=a.getX()-c.getX(),f=c.getWidth()):(e=a.getY()-c.getY(),f=c.getHeight()),e>f-b.getTriggerSize()?d||b.onMenuTriggerOver(a):d&&b.onMenuTriggerOut(a))},getTriggerSize:function(){var a=this,b=a.triggerSize,c,d,e;return b===e&&(c=a.arrowAlign,d=c.charAt(0),b=a.triggerSize=a.el.getFrameWidth(d)+a.btnWrap.getFrameWidth(d)+a.frameSize[c]),b},onMouseEnter:function(a){var b=this;b.addClsWithUI(b.overCls),b.fireEvent("mouseover",b,a)},onMouseLeave:function(a){var b=this;b.removeClsWithUI(b.overCls),b.fireEvent("mouseout",b,a)},onMenuTriggerOver:function(a){var b=this;b.overMenuTrigger=!0,b.fireEvent("menutriggerover",b,b.menu,a)},onMenuTriggerOut:function(a){var b=this;delete b.overMenuTrigger,b.fireEvent("menutriggerout",b,b.menu,a)},enable:function(a){var b=this;return b.callParent(arguments),b.btnEl&&(b.btnEl.dom.disabled=!1),b.removeClsWithUI("disabled"),b},disable:function(a){var b=this;return b.callParent(arguments),b.btnEl&&(b.btnEl.dom.disabled=!0),b.addClsWithUI("disabled"),b.removeClsWithUI(b.overCls),b.btnInnerEl&&(Ext.isIE6||Ext.isIE7)&&b.btnInnerEl.repaint(),b},setScale:function(a){var b=this,c=b.ui.replace("-"+b.scale,"");if(!Ext.Array.contains(b.allowedScales,a))throw"#setScale: scale must be an allowed scale ("+b.allowedScales.join(", ")+")";b.scale=a,b.setUI(c)},setUI:function(a){var b=this;b.scale&&!a.match(b.scale)&&(a=a+"-"+b.scale),b.callParent([a])},onMouseDown:function(a){var b=this;!b.disabled&&a.button===0&&(b.addClsWithUI(b.pressedCls),b.doc.on("mouseup",b.onMouseUp,b))},onMouseUp:function(a){var b=this;a.button===0&&(b.pressed||b.removeClsWithUI(b.pressedCls),b.doc.un("mouseup",b.onMouseUp,b))},onMenuShow:function(a){var b=this;b.ignoreNextClick=0,b.addClsWithUI(b.menuActiveCls),b.fireEvent("menushow",b,b.menu)},onMenuHide:function(a){var b=this;b.removeClsWithUI(b.menuActiveCls),b.ignoreNextClick=Ext.defer(b.restoreClick,250,b),b.fireEvent("menuhide",b,b.menu)},restoreClick:function(){this.ignoreNextClick=0},onDownKey:function(){var a=this;a.disabled||a.menu&&a.showMenu()},getPersistentPadding:function(){var a=this,b=a.persistentPadding,c,d,e,f;return b||(b=a.self.prototype.persistentPadding=[0,0,0,0],Ext.isIE||(c=new Ext.button.Button({text:"test",style:"position:absolute;top:-999px;"}),c.el=Ext.DomHelper.append(Ext.getBody(),c.getRenderTree(),!0),c.applyChildEls(c.el),e=c.btnEl,f=c.btnInnerEl,e.setSize(null,null),d=f.getOffsetsTo(e),b[0]=d[1],b[1]=e.getWidth()-f.getWidth()-d[0],b[2]=e.getHeight()-f.getHeight()-d[1],b[3]=d[0],c.destroy(),c.el.remove())),b}},function(){var a={},b=function(b,c){if(c){var d=a[b.toggleGroup],e=d.length,f;for(f=0;f<e;f++)d[f]!==b&&d[f].toggle(!1)}};Ext.ButtonToggleManager={register:function(c){if(!c.toggleGroup)return;var d=a[c.toggleGroup];d||(d=a[c.toggleGroup]=[]),d.push(c),c.on("toggle",b)},unregister:function(c){if(!c.toggleGroup)return;var d=a[c.toggleGroup];d&&(Ext.Array.remove(d,c),c.un("toggle",b))},getPressed:function(b){var c=a[b],d=0,e;if(c)for(e=c.length;d<e;d++)if(c[d].pressed===!0)return c[d];return null}}}),Ext.define("Ext.button.Split",{alias:"widget.splitbutton",extend:"Ext.button.Button",alternateClassName:"Ext.SplitButton",arrowCls:"split",split:!0,initComponent:function(){this.callParent(),this.addEvents("arrowclick")},setArrowHandler:function(a,b){this.arrowHandler=a,this.scope=b},onClick:function(a,b){var c=this;a.preventDefault(),c.disabled||(c.overMenuTrigger?(c.maybeShowMenu(),c.fireEvent("arrowclick",c,a),c.arrowHandler&&c.arrowHandler.call(c.scope||c,c,a)):(c.doToggle(),c.fireHandler(a)))}}),Ext.define("Ext.button.Cycle",{alias:"widget.cycle",extend:"Ext.button.Split",alternateClassName:"Ext.CycleButton",getButtonText:function(a){var b=this,c="";return a&&b.showText===!0?(b.prependText&&(c+=b.prependText),c+=a.text,c):b.text},setActiveItem:function(a,b){var c=this;Ext.isObject(a)||(a=c.menu.getComponent(a)),a&&(c.rendered?(c.setText(c.getButtonText(a)),c.setIconCls(a.iconCls)):(c.text=c.getButtonText(a),c.iconCls=a.iconCls),c.activeItem=a,a.checked||a.setChecked(!0,!1),c.forceIcon&&c.setIconCls(c.forceIcon),b||c.fireEvent("change",c,a))},getActiveItem:function(){return this.activeItem},initComponent:function(){var a=this,b=0,c,d,e,f;a.addEvents("change"),a.changeHandler&&(a.on("change",a.changeHandler,a.scope||a),delete a.changeHandler),c=(a.menu.items||[]).concat(a.items||[]),a.menu=Ext.applyIf({cls:Ext.baseCSSPrefix+"cycle-menu",items:[]},a.menu),e=c.length;for(d=0;d<e;d++)f=c[d],f=Ext.applyIf({group:a.id,itemIndex:d,checkHandler:a.checkHandler,scope:a,checked:f.checked||!1},f),a.menu.items.push(f),f.checked&&(b=d);a.itemCount=a.menu.items.length,a.callParent(arguments),a.on("click",a.toggleSelected,a),a.setActiveItem(b,a),a.width&&a.showText&&a.addCls(Ext.baseCSSPrefix+"cycle-fixed-width")},checkHandler:function(a,b){b&&this.setActiveItem(a)},toggleSelected:function(){var a=this,b=a.menu,c;c=a.activeItem.next(":not([disabled])")||b.items.getAt(0),c.setChecked(!0)}}),Ext.define("Ext.menu.Separator",{extend:"Ext.menu.Item",alias:"widget.menuseparator",canActivate:!1,focusable:!1,hideOnClick:!1,plain:!0,separatorCls:Ext.baseCSSPrefix+"menu-item-separator",text:"&#160;",beforeRender:function(a,b){var c=this;c.callParent(),c.addCls(c.separatorCls)}}),Ext.define("Ext.panel.DD",{extend:"Ext.dd.DragSource",requires:["Ext.panel.Proxy"],constructor:function(a,b){var c=this;c.panel=a,c.dragData={panel:a},c.panelProxy=new Ext.panel.Proxy(a,b),c.proxy=c.panelProxy.proxy,c.callParent([a.el,b]),c.setupEl(a)},setupEl:function(a){var b=this,c=a.header,d=a.body;c&&(b.setHandleElId(c.id),d=c.el),d?(d.setStyle("cursor","move"),b.scroll=!1):a.on("boxready",b.setupEl,b,{single:!0})},showFrame:Ext.emptyFn,startDrag:Ext.emptyFn,b4StartDrag:function(a,b){this.panelProxy.show()},b4MouseDown:function(a){var b=a.getPageX(),c=a.getPageY();this.autoOffset(b,c)},onInitDrag:function(a,b){return this.onStartDrag(a,b),!0},createFrame:Ext.emptyFn,getDragEl:function(a){return this.panelProxy.ghost.el.dom},endDrag:function(a){this.panelProxy.hide(),this.panel.saveState()},autoOffset:function(a,b){a-=this.startPageX,b-=this.startPageY,this.setDelta(a,b)},onInvalidDrop:function(a,b,c){var d=this;d.beforeInvalidDrop(a,b,c),d.cachedTarget&&(d.cachedTarget.isNotifyTarget&&d.cachedTarget.notifyOut(d,b,d.dragData),d.cacheTarget=null),d.afterInvalidDrop&&d.afterInvalidDrop(b,c)}}),Ext.define("Ext.panel.Header",{extend:"Ext.container.Container",uses:["Ext.panel.Tool","Ext.draw.Component","Ext.util.CSS","Ext.layout.component.Body","Ext.Img"],alias:"widget.header",isHeader:!0,defaultType:"tool",indicateDrag:!1,weight:-1,componentLayout:"body",titleAlign:"left",childEls:["body"],renderTpl:['<div id="{id}-body" class="{baseCls}-body {bodyCls}','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>"','<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values)%}","</div>"],headingTpl:'<span id="{id}-textEl" class="{cls}-text {cls}-text-{ui}">{title}</span>',shrinkWrap:3,initComponent:function(){var a=this,b,c,d,e,f;a.addEvents("click","dblclick"),a.indicateDragCls=a.baseCls+"-draggable",a.title=a.title||"&#160;",a.tools=a.tools||[],a.items=a.items||[],a.orientation=a.orientation||"horizontal",a.dock=a.dock?a.dock:a.orientation=="horizontal"?"top":"left",a.addClsWithUI([a.orientation,a.dock]),a.indicateDrag&&a.addCls(a.indicateDragCls);if(!Ext.isEmpty(a.iconCls)||!Ext.isEmpty(a.icon))a.initIconCmp(),a.items.push(a.iconCmp);a.orientation=="vertical"?(a.layout={type:"vbox",align:"center"},a.textConfig={width:16,cls:a.baseCls+"-text",type:"text",text:a.title,rotate:{degrees:90}},e=a.ui,Ext.isArray(e)&&(e=e[0]),b="."+a.baseCls+"-text-"+e,Ext.scopeResetCSS&&(b="."+Ext.baseCSSPrefix+"reset "+b),c=Ext.util.CSS.getRule(b),c?d=c.style:(d=(f=Ext.getBody().createChild({style:"position:absolute",cls:a.baseCls+"-text-"+e})).getStyles("fontFamily","fontWeight","fontSize","color"),f.remove()),d&&Ext.apply(a.textConfig,{"font-family":d.fontFamily,"font-weight":d.fontWeight,"font-size":d.fontSize,fill:d.color}),a.titleCmp=new Ext.draw.Component({width:16,ariaRole:"heading",focusable:!1,viewBox:!1,flex:1,id:a.id+"_hd",autoSize:!0,items:a.textConfig,xhooks:{setSize:function(a){this.callParent([a])}},childEls:[{name:"textEl",select:"."+a.baseCls+"-text"}]})):(a.layout={type:"hbox",align:"middle"},a.titleCmp=new Ext.Component({ariaRole:"heading",focusable:!1,noWrap:!0,flex:1,id:a.id+"_hd",style:"text-align:"+a.titleAlign,cls:a.baseCls+"-text-container",renderTpl:a.getTpl("headingTpl"),renderData:{title:a.title,cls:a.baseCls,ui:a.ui},childEls:["textEl"]})),a.items.push(a.titleCmp),a.items=a.items.concat(a.tools),a.callParent(),a.on({dblclick:a.onDblClick,click:a.onClick,element:"el",scope:a})},initIconCmp:function(){var a=this,b={focusable:!1,src:Ext.BLANK_IMAGE_URL,cls:[a.baseCls+"-icon",a.iconCls],id:a.id+"-iconEl",iconCls:a.iconCls};Ext.isEmpty(a.icon)||(delete b.iconCls,b.src=a.icon),a.iconCmp=new Ext.Img(b)},afterRender:function(){this.el.unselectable(),this.callParent()},addUIClsToElement:function(a){var b=this,c=b.callParent(arguments),d=[b.baseCls+"-body-"+a,b.baseCls+"-body-"+b.ui+"-"+a],e,f;if(b.bodyCls){e=b.bodyCls.split(" ");for(f=0;f<d.length;f++)Ext.Array.contains(e,d[f])||e.push(d[f]);b.bodyCls=e.join(" ")}else b.bodyCls=d.join(" ");return c},removeUIClsFromElement:function(a){var b=this,c=b.callParent(arguments),d=[b.baseCls+"-body-"+a,b.baseCls+"-body-"+b.ui+"-"+a],e,f;if(b.bodyCls){e=b.bodyCls.split(" ");for(f=0;f<d.length;f++)Ext.Array.remove(e,d[f]);b.bodyCls=e.join(" ")}return c},addUIToElement:function(){var a=this,b,c;a.callParent(arguments),c=a.baseCls+"-body-"+a.ui,a.rendered?a.bodyCls?a.body.addCls(a.bodyCls):a.body.addCls(c):a.bodyCls?(b=a.bodyCls.split(" "),Ext.Array.contains(b,c)||b.push(c),a.bodyCls=b.join(" ")):a.bodyCls=c,a.titleCmp&&a.titleCmp.rendered&&a.titleCmp.textEl&&a.titleCmp.textEl.addCls(a.baseCls+"-text-"+a.ui)},removeUIFromElement:function(){var a=this,b,c;a.callParent(arguments),c=a.baseCls+"-body-"+a.ui,a.rendered?a.bodyCls?a.body.removeCls(a.bodyCls):a.body.removeCls(c):a.bodyCls?(b=a.bodyCls.split(" "),Ext.Array.remove(b,c),a.bodyCls=b.join(" ")):a.bodyCls=c,a.titleCmp&&a.titleCmp.rendered&&a.titleCmp.textEl&&a.titleCmp.textEl.removeCls(a.baseCls+"-text-"+a.ui)},onClick:function(a){this.fireClickEvent("click",a)},onDblClick:function(a){this.fireClickEvent("dblclick",a)},fireClickEvent:function(a,b){var c="."+Ext.panel.Tool.prototype.baseCls;b.getTarget(c)||this.fireEvent(a,this,b)},getFocusEl:function(){return this.el},getTargetEl:function(){return this.body||this.frameBody||this.el},setTitle:function(a){var b=this,c,d;b.rendered?b.titleCmp.rendered?(b.titleCmp.surface?(b.title=a||"",c=b.titleCmp.surface.items.items[0],d=b.titleCmp.surface,d.remove(c),b.textConfig.type="text",b.textConfig.text=a,c=d.add(b.textConfig),c.setAttributes({rotate:{degrees:90}},!0),b.titleCmp.autoSizeSurface()):(b.title=a,b.titleCmp.textEl.update(b.title||"&#160;")),b.titleCmp.updateLayout()):b.titleCmp.on({render:function(){b.setTitle(a)},single:!0}):b.title=a},getMinWidth:function(){var a=this,b=a.titleCmp.textEl.dom,c,d=a.tools,e,f;b.style.display="inline",c=b.offsetWidth,b.style.display="";if(d&&(e=d.length))for(f=0;f<e;f++)d[f].el&&(c+=d[f].el.dom.offsetWidth);return a.iconCmp&&(c+=a.iconCmp.el.dom.offsetWidth),c+10},setIconCls:function(a){var b=this,c=!a||!a.length,d=b.iconCmp;b.iconCls=a,!b.iconCmp&&!c?(b.initIconCmp(),b.insert(0,b.iconCmp)):d&&(c?(b.iconCmp.destroy(),delete b.iconCmp):(d.removeCls(d.iconCls),d.addCls(a),d.iconCls=a))},setIcon:function(a){var b=this,c=!a||!a.length,d=b.iconCmp;b.icon=a,!b.iconCmp&&!c?(b.initIconCmp(),b.insert(0,b.iconCmp)):d&&(c?(b.iconCmp.destroy(),delete b.iconCmp):d.setSrc(b.icon))},addTool:function(a){this.tools.push(this.add(a))},onAdd:function(a,b){this.callParent(arguments),a instanceof Ext.panel.Tool&&(a.bindTo(this.ownerCt),this.tools[a.type]=a)},initRenderData:function(){return Ext.applyIf(this.callParent(),{bodyCls:this.bodyCls})}}),Ext.define("Ext.picker.Color",{extend:"Ext.Component",requires:"Ext.XTemplate",alias:"widget.colorpicker",alternateClassName:"Ext.ColorPalette",componentCls:Ext.baseCSSPrefix+"color-picker",selectedCls:Ext.baseCSSPrefix+"color-picker-selected",value:null,clickEvent:"click",allowReselect:!1,colors:["000000","993300","333300","003300","003366","000080","333399","333333","800000","FF6600","808000","008000","008080","0000FF","666699","808080","FF0000","FF9900","99CC00","339966","33CCCC","3366FF","800080","969696","FF00FF","FFCC00","FFFF00","00FF00","00FFFF","00CCFF","993366","C0C0C0","FF99CC","FFCC99","FFFF99","CCFFCC","CCFFFF","99CCFF","CC99FF","FFFFFF"],colorRe:/(?:^|\s)color-(.{6})(?:\s|$)/,renderTpl:['<tpl for="colors">','<a href="#" class="color-{.}" hidefocus="on">','<em><span style="background:#{.}" unselectable="on">&#160;</span></em>',"</a>","</tpl>"],initComponent:function(){var a=this;a.callParent(arguments),a.addEvents("select"),a.handler&&a.on("select",a.handler,a.scope,!0)},initRenderData:function(){var a=this;return Ext.apply(a.callParent(),{itemCls:a.itemCls,colors:a.colors})},onRender:function(){var a=this,b=a.clickEvent;a.callParent(arguments),a.mon(a.el,b,a.handleClick,a,{delegate:"a"}),b!="click"&&a.mon(a.el,"click",Ext.emptyFn,a,{delegate:"a",stopEvent:!0})},afterRender:function(){var a=this,b;a.callParent(arguments),a.value&&(b=a.value,a.value=null,a.select(b,!0))},handleClick:function(a,b){var c=this,d;a.stopEvent(),c.disabled||(d=b.className.match(c.colorRe)[1],c.select(d.toUpperCase()))},select:function(a,b){var c=this,d=c.selectedCls,e=c.value,f;a=a.replace("#","");if(!c.rendered){c.value=a;return}if(a!=e||c.allowReselect)f=c.el,c.value&&f.down("a.color-"+e).removeCls(d),f.down("a.color-"+a).addCls(d),c.value=a,b!==!0&&c.fireEvent("select",c,a)},getValue:function(){return this.value||null}}),Ext.define("Ext.picker.Month",{extend:"Ext.Component",requires:["Ext.XTemplate","Ext.util.ClickRepeater","Ext.Date","Ext.button.Button"],alias:"widget.monthpicker",alternateClassName:"Ext.MonthPicker",childEls:["bodyEl","prevEl","nextEl","buttonsEl","monthEl","yearEl"],renderTpl:['<div id="{id}-bodyEl" class="{baseCls}-body">','<div id="{id}-monthEl" class="{baseCls}-months">','<tpl for="months">','<div class="{parent.baseCls}-item {parent.baseCls}-month"><a style="{parent.monthStyle}" href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div id="{id}-yearEl" class="{baseCls}-years">','<div class="{baseCls}-yearnav">','<button id="{id}-prevEl" class="{baseCls}-yearnav-prev"></button>','<button id="{id}-nextEl" class="{baseCls}-yearnav-next"></button>',"</div>",'<tpl for="years">','<div class="{parent.baseCls}-item {parent.baseCls}-year"><a href="#" hidefocus="on">{.}</a></div>',"</tpl>","</div>",'<div class="'+Ext.baseCSSPrefix+'clear"></div>',"</div>",'<tpl if="showButtons">','<div id="{id}-buttonsEl" class="{baseCls}-buttons"></div>',"</tpl>"],okText:"OK",cancelText:"Cancel",baseCls:Ext.baseCSSPrefix+"monthpicker",showButtons:!0,width:178,measureWidth:35,measureMaxHeight:20,smallCls:Ext.baseCSSPrefix+"monthpicker-small",totalYears:10,yearOffset:5,monthOffset:6,initComponent:function(){var a=this;a.selectedCls=a.baseCls+"-selected",a.addEvents("cancelclick","monthclick","monthdblclick","okclick","select","yearclick","yeardblclick"),a.small&&a.addCls(a.smallCls),a.setValue(a.value),a.activeYear=a.getYear((new Date).getFullYear()-4,-4),this.callParent()},beforeRender:function(){var a=this,b=0,c=[],d=Ext.Date.getShortMonthName,e=a.monthOffset,f=a.monthMargin,g="";a.callParent();for(;b<e;++b)c.push(d(b),d(b+e));Ext.isDefined(f)&&(g="margin: 0 "+f+"px;"),Ext.apply(a.renderData,{months:c,years:a.getYears(),showButtons:a.showButtons,monthStyle:g})},afterRender:function(){var a=this,b=a.bodyEl,c=a.buttonsEl;a.callParent(),a.mon(b,"click",a.onBodyClick,a),a.mon(b,"dblclick",a.onBodyClick,a),a.years=b.select("."+a.baseCls+"-year a"),a.months=b.select("."+a.baseCls+"-month a"),a.showButtons&&(a.okBtn=new Ext.button.Button({text:a.okText,renderTo:c,handler:a.onOkClick,scope:a}),a.cancelBtn=new Ext.button.Button({text:a.cancelText,renderTo:c,handler:a.onCancelClick,scope:a})),a.backRepeater=new Ext.util.ClickRepeater(a.prevEl,{handler:Ext.Function.bind(a.adjustYear,a,[-a.totalYears])}),a.prevEl.addClsOnOver(a.baseCls+"-yearnav-prev-over"),a.nextRepeater=new Ext.util.ClickRepeater(a.nextEl,{handler:Ext.Function.bind(a.adjustYear,a,[a.totalYears])}),a.nextEl.addClsOnOver(a.baseCls+"-yearnav-next-over"),a.updateBody(),Ext.isDefined(a.monthMargin)||(Ext.picker.Month.prototype.monthMargin=a.calculateMonthMargin())},calculateMonthMargin:function(){var a=this,b=a.monthEl,c=a.months,d=c.first(),e=d.getMargin("l");while(e&&a.getLargest()>a.measureMaxHeight)--e,c.setStyle("margin","0 "+e+"px");return e},getLargest:function(a){var b=0;return this.months.each(function(a){var c=a.getHeight();c>b&&(b=c)}),b},setValue:function(a){var b=this,c=b.activeYear,d=b.monthOffset,e,f;return a?Ext.isDate(a)?b.value=[a.getMonth(),a.getFullYear()]:b.value=[a[0],a[1]]:b.value=[null,null],b.rendered&&(e=b.value[1],e!==null&&(e<c||e>c+b.yearOffset)&&(b.activeYear=e-b.yearOffset+1),b.updateBody()),b},getValue:function(){return this.value},hasSelection:function(){var a=this.value;return a[0]!==null&&a[1]!==null},getYears:function(){var a=this,b=a.yearOffset,c=a.activeYear,d=c+b,e=c,f=[];for(;e<d;++e)f.push(e,e+b);return f},updateBody:function(){var a=this,b=a.years,c=a.months,d=a.getYears(),e=a.selectedCls,f=a.getYear(null),g=a.value[0],h=a.monthOffset,i,j,k,l,m;if(a.rendered){b.removeCls(e),c.removeCls(e),j=b.elements,l=j.length;for(k=0;k<l;k++)m=Ext.fly(j[k]),i=d[k],m.dom.innerHTML=i,i==f&&(m.dom.className=e);g!==null&&(g<h?g*=2:g=(g-h)*2+1,c.item(g).addCls(e))}},getYear:function(a,b){var c=this.value[1];return b=b||0,c===null?a:c+b},onBodyClick:function(a,b){var c=this,d=a.type=="dblclick";a.getTarget("."+c.baseCls+"-month")?(a.stopEvent(),c.onMonthClick(b,d)):a.getTarget("."+c.baseCls+"-year")&&(a.stopEvent(),c.onYearClick(b,d))},adjustYear:function(a){typeof a!="number"&&(a=this.totalYears),this.activeYear+=a,this.updateBody()},onOkClick:function(){this.fireEvent("okclick",this,this.value)},onCancelClick:function(){this.fireEvent("cancelclick",this)},onMonthClick:function(a,b){var c=this;c.value[0]=c.resolveOffset(c.months.indexOf(a),c.monthOffset),c.updateBody(),c.fireEvent("month"+(b?"dbl":"")+"click",c,c.value),c.fireEvent("select",c,c.value)},onYearClick:function(a,b){var c=this;c.value[1]=c.activeYear+c.resolveOffset(c.years.indexOf(a),c.yearOffset),c.updateBody(),c.fireEvent("year"+(b?"dbl":"")+"click",c,c.value),c.fireEvent("select",c,c.value)},resolveOffset:function(a,b){return a%2===0?a/2:b+Math.floor(a/2)},beforeDestroy:function(){var a=this;a.years=a.months=null,Ext.destroyMembers(a,"backRepeater","nextRepeater","okBtn","cancelBtn"),a.callParent()}}),Ext.define("Ext.picker.Date",{extend:"Ext.Component",requires:["Ext.XTemplate","Ext.button.Button","Ext.button.Split","Ext.util.ClickRepeater","Ext.util.KeyNav","Ext.EventObject","Ext.fx.Manager","Ext.picker.Month"],alias:"widget.datepicker",alternateClassName:"Ext.DatePicker",childEls:["innerEl","eventEl","prevEl","nextEl","middleBtnEl","footerEl"],border:!0,renderTpl:['<div id="{id}-innerEl" role="grid">','<div role="presentation" class="{baseCls}-header">','<div class="{baseCls}-prev"><a id="{id}-prevEl" href="#" role="button" title="{prevText}"></a></div>','<div class="{baseCls}-month" id="{id}-middleBtnEl">{%this.renderMonthBtn(values, out)%}</div>','<div class="{baseCls}-next"><a id="{id}-nextEl" href="#" role="button" title="{nextText}"></a></div>',"</div>",'<table id="{id}-eventEl" class="{baseCls}-inner" cellspacing="0" role="presentation">','<thead role="presentation"><tr role="presentation">','<tpl for="dayNames">','<th role="columnheader" title="{.}"><span>{.:this.firstInitial}</span></th>',"</tpl>","</tr></thead>",'<tbody role="presentation"><tr role="presentation">','<tpl for="days">',"{#:this.isEndOfWeek}",'<td role="gridcell" id="{[Ext.id()]}">','<a role="presentation" href="#" hidefocus="on" class="{parent.baseCls}-date" tabIndex="1">','<em role="presentation"><span role="presentation"></span></em>',"</a>","</td>","</tpl>","</tr></tbody>","</table>",'<tpl if="showToday">','<div id="{id}-footerEl" role="presentation" class="{baseCls}-footer">{%this.renderTodayBtn(values, out)%}</div>',"</tpl>","</div>",{firstInitial:function(a){return Ext.picker.Date.prototype.getDayInitial(a)},isEndOfWeek:function(a){a--;var b=a%7===0&&a!==0;return b?'</tr><tr role="row">':""},renderTodayBtn:function(a,b){Ext.DomHelper.generateMarkup(a.$comp.todayBtn.getRenderTree(),b)},renderMonthBtn:function(a,b){Ext.DomHelper.generateMarkup(a.$comp.monthBtn.getRenderTree(),b)}}],todayText:"Today",ariaTitle:"Date Picker: {0}",ariaTitleDateFormat:"F d, Y",todayTip:"{0} (Spacebar)",minText:"This date is before the minimum date",maxText:"This date is after the maximum date",disabledDaysText:"Disabled",disabledDatesText:"Disabled",nextText:"Next Month (Control+Right)",prevText:"Previous Month (Control+Left)",monthYearText:"Choose a month (Control+Up/Down to move years)",monthYearFormat:"F Y",startDay:0,showToday:!0,disableAnim:!1,baseCls:Ext.baseCSSPrefix+"datepicker",longDayFormat:"F d, Y",focusOnShow:!1,focusOnSelect:!0,width:178,initHour:12,numDays:42,initComponent:function(){var a=this,b=Ext.Date.clearTime;a.selectedCls=a.baseCls+"-selected",a.disabledCellCls=a.baseCls+"-disabled",a.prevCls=a.baseCls+"-prevday",a.activeCls=a.baseCls+"-active",a.nextCls=a.baseCls+"-prevday",a.todayCls=a.baseCls+"-today",a.dayNames=a.dayNames.slice(a.startDay).concat(a.dayNames.slice(0,a.startDay)),a.listeners=Ext.apply(a.listeners||{},{mousewheel:{element:"eventEl",fn:a.handleMouseWheel,scope:a},click:{element:"eventEl",fn:a.handleDateClick,scope:a,delegate:"a."+a.baseCls+"-date"}}),this.callParent(),a.value=a.value?b(a.value,!0):b(new Date),a.addEvents("select"),a.initDisabledDays()},beforeRender:function(){var a=this,b=new Array(a.numDays),c=Ext.Date.format(new Date,a.format);a.monthBtn=new Ext.button.Split({ownerCt:a,ownerLayout:a.getComponentLayout(),text:"",tooltip:a.monthYearText,listeners:{click:a.showMonthPicker,arrowclick:a.showMonthPicker,scope:a}}),this.showToday&&(a.todayBtn=new Ext.button.Button({ownerCt:a,ownerLayout:a.getComponentLayout(),text:Ext.String.format(a.todayText,c),tooltip:Ext.String.format(a.todayTip,c),handler:a.selectToday,scope:a})),a.callParent(),Ext.applyIf(a,{renderData:{}}),Ext.apply(a.renderData,{dayNames:a.dayNames,showToday:a.showToday,prevText:a.prevText,nextText:a.nextText,days:b})},finishRenderChildren:function(){var a=this;a.callParent(),a.monthBtn.finishRender(),a.showToday&&a.todayBtn.finishRender()},onRender:function(a,b){var c=this;c.callParent(arguments),c.el.unselectable(),c.cells=c.eventEl.select("tbody td"),c.textNodes=c.eventEl.query("tbody td span")},initEvents:function(){var a=this,b=Ext.Date,c=b.DAY;a.callParent(),a.prevRepeater=new Ext.util.ClickRepeater(a.prevEl,{handler:a.showPrevMonth,scope:a,preventDefault:!0,stopDefault:!0}),a.nextRepeater=new Ext.util.ClickRepeater(a.nextEl,{handler:a.showNextMonth,scope:a,preventDefault:!0,stopDefault:!0}),a.keyNav=new Ext.util.KeyNav(a.eventEl,Ext.apply({scope:a,left:function(d){d.ctrlKey?a.showPrevMonth():a.update(b.add(a.activeDate,c,-1))},right:function(d){d.ctrlKey?a.showNextMonth():a.update(b.add(a.activeDate,c,1))},up:function(d){d.ctrlKey?a.showNextYear():a.update(b.add(a.activeDate,c,-7))},down:function(d){d.ctrlKey?a.showPrevYear():a.update(b.add(a.activeDate,c,7))},pageUp:a.showNextMonth,pageDown:a.showPrevMonth,enter:function(a){return a.stopPropagation(),!0}},a.keyNavConfig)),a.showToday&&(a.todayKeyListener=a.eventEl.addKeyListener(Ext.EventObject.SPACE,a.selectToday,a)),a.update(a.value)},initDisabledDays:function(){var a=this,b=a.disabledDates,c="(?:",d,e,f,g;if(!a.disabledDatesRE&&b){d=b.length-1,f=b.length;for(e=0;e<f;e++)g=b[e],c+=Ext.isDate(g)?"^"+Ext.String.escapeRegex(Ext.Date.dateFormat(g,a.format))+"$":g,e!=d&&(c+="|");a.disabledDatesRE=new RegExp(c+")")}},setDisabledDates:function(a){var b=this;return Ext.isArray(a)?(b.disabledDates=a,b.disabledDatesRE=null):b.disabledDatesRE=a,b.initDisabledDays(),b.update(b.value,!0),b},setDisabledDays:function(a){return this.disabledDays=a,this.update(this.value,!0)},setMinDate:function(a){return this.minDate=a,this.update(this.value,!0)},setMaxDate:function(a){return this.maxDate=a,this.update(this.value,!0)},setValue:function(a){return this.value=Ext.Date.clearTime(a,!0),this.update(this.value)},getValue:function(){return this.value},getDayInitial:function(a){return a.substr(0,1)},focus:function(){this.update(this.activeDate)},onEnable:function(){this.callParent(),this.setDisabledStatus(!1),this.update(this.activeDate)},onDisable:function(){this.callParent(),this.setDisabledStatus(!0)},setDisabledStatus:function(a){var b=this;b.keyNav.setDisabled(a),b.prevRepeater.setDisabled(a),b.nextRepeater.setDisabled(a),b.showToday&&(b.todayKeyListener.setDisabled(a),b.todayBtn.setDisabled(a))},getActive:function(){return this.activeDate||this.value},runAnimation:function(a){var b=this.monthPicker,c={duration:200,callback:function(){a?b.hide():b.show()}};a?b.el.slideOut("t",c):b.el.slideIn("t",c)},hideMonthPicker:function(a){var b=this,c=b.monthPicker;return c&&(b.shouldAnimate(a)?b.runAnimation(!0):c.hide()),b},showMonthPicker:function(a){var b=this,c;return b.rendered&&!b.disabled&&(c=b.createMonthPicker(),c.setValue(b.getActive()),c.setSize(b.getSize()),c.setPosition(-1,-1),b.shouldAnimate(a)?b.runAnimation(!1):c.show()),b},shouldAnimate:function(a){return Ext.isDefined(a)?a:!this.disableAnim},createMonthPicker:function(){var a=this,b=a.monthPicker;return b||(a.monthPicker=b=new Ext.picker.Month({renderTo:a.el,floating:!0,shadow:!1,small:a.showToday===!1,listeners:{scope:a,cancelclick:a.onCancelClick,okclick:a.onOkClick,yeardblclick:a.onOkClick,monthdblclick:a.onOkClick}}),a.disableAnim||b.el.setStyle("display","none"),a.on("beforehide",Ext.Function.bind(a.hideMonthPicker,a,[!1]))),b},onOkClick:function(a,b){var c=this,d=b[0],e=b[1],f=new Date(e,d,c.getActive().getDate());f.getMonth()!==d&&(f=Ext.Date.getLastDateOfMonth(new Date(e,d,1))),c.update(f),c.hideMonthPicker()},onCancelClick:function(){this.selectedUpdate(this.activeDate),this.hideMonthPicker()},showPrevMonth:function(a){return this.update(Ext.Date.add(this.activeDate,Ext.Date.MONTH,-1))},showNextMonth:function(a){return this.update(Ext.Date.add(this.activeDate,Ext.Date.MONTH,1))},showPrevYear:function(){this.update(Ext.Date.add(this.activeDate,Ext.Date.YEAR,-1))},showNextYear:function(){this.update(Ext.Date.add(this.activeDate,Ext.Date.YEAR,1))},handleMouseWheel:function(a){a.stopEvent();if(!this.disabled){var b=a.getWheelDelta();b>0?this.showPrevMonth():b<0&&this.showNextMonth()}},handleDateClick:function(a,b){var c=this,d=c.handler;a.stopEvent(),!c.disabled&&b.dateValue&&!Ext.fly(b.parentNode).hasCls(c.disabledCellCls)&&(c.doCancelFocus=c.focusOnSelect===!1,c.setValue(new Date(b.dateValue)),delete c.doCancelFocus,c.fireEvent("select",c,c.value),d&&d.call(c.scope||c,c,c.value),c.onSelect())},onSelect:function(){this.hideOnSelect&&this.hide()},selectToday:function(){var a=this,b=a.todayBtn,c=a.handler;return b&&!b.disabled&&(a.setValue(Ext.Date.clearTime(new Date)),a.fireEvent("select",a,a.value),c&&c.call(a.scope||a,a,a.value),a.onSelect()),a},selectedUpdate:function(a){var b=this,c=a.getTime(),d=b.cells,e=b.selectedCls,f=d.elements,g,h=f.length,i;d.removeCls(e);for(g=0;g<h;g++){i=Ext.fly(f[g]);if(i.dom.firstChild.dateValue==c){b.fireEvent("highlightitem",b,i),i.addCls(e),b.isVisible()&&!b.doCancelFocus&&Ext.fly(i.dom.firstChild).focus(50);break}}},fullUpdate:function(a){var b=this,c=b.cells.elements,d=b.textNodes,e=b.disabledCellCls,f=Ext.Date,g=0,h=0,i=b.isVisible(),j=+f.clearTime(a,!0),k=+f.clearTime(new Date),l=b.minDate?f.clearTime(b.minDate,!0):Number.NEGATIVE_INFINITY,m=b.maxDate?f.clearTime(b.maxDate,!0):Number.POSITIVE_INFINITY,n=b.disabledDatesRE,o=b.disabledDatesText,p=b.disabledDays?b.disabledDays.join(""):!1,q=b.disabledDaysText,r=b.format,s=f.getDaysInMonth(a),t=f.getFirstDateOfMonth(a),u=t.getDay()-b.startDay,v=f.add(a,f.MONTH,-1),w=b.longDayFormat,x,y,z,A,B,C,D,E,F;u<0&&(u+=7),s+=u,x=f.getDaysInMonth(v)-u,y=new Date(v.getFullYear(),v.getMonth(),x,b.initHour),b.showToday&&(A=f.clearTime(new Date),z=A<l||A>m||n&&r&&n.test(f.dateFormat(A,r))||p&&p.indexOf(A.getDay())!=-1,b.disabled||(b.todayBtn.setDisabled(z),b.todayKeyListener.setDisabled(z))),B=function(a){F=+f.clearTime(y,!0),a.title=f.format(y,w),a.firstChild.dateValue=F,F==k&&(a.className+=" "+b.todayCls,a.title=b.todayText),F==j&&(a.className+=" "+b.selectedCls,b.fireEvent("highlightitem",b,a),i&&b.floating&&Ext.fly(a.firstChild).focus(50));if(F<l){a.className=e,a.title=b.minText;return}if(F>m){a.className=e,a.title=b.maxText;return}p&&p.indexOf(y.getDay())!=-1&&(a.title=q,a.className=e),n&&r&&(E=f.dateFormat(y,r),n.test(E)&&(a.title=o.replace("%0",E),a.className=e))};for(;g<b.numDays;++g)g<u?(C=++x,D=b.prevCls):g>=s?(C=++h,D=b.nextCls):(C=g-u+1,D=b.activeCls),d[g].innerHTML=C,c[g].className=D,y.setDate(y.getDate()+1),B(c[g]);b.monthBtn.setText(Ext.Date.format(a,b.monthYearFormat))},update:function(a,b){var c=this,d=c.activeDate;return c.rendered&&(c.activeDate=a,!b&&d&&c.el&&d.getMonth()==a.getMonth()&&d.getFullYear()==a.getFullYear()?c.selectedUpdate(a,d):c.fullUpdate(a,d),c.innerEl.dom.title=Ext.String.format(c.ariaTitle,Ext.Date.format(c.activeDate,c.ariaTitleDateFormat))),c},beforeDestroy:function(){var a=this;a.rendered&&(Ext.destroy(a.todayKeyListener,a.keyNav,a.monthPicker,a.monthBtn,a.nextRepeater,a.prevRepeater,a.todayBtn),delete a.textNodes,delete a.cells.elements),a.callParent()},onShow:function(){this.callParent(arguments),this.focusOnShow&&this.focus()}},function(){var a=this.prototype,b=Ext.Date;a.monthNames=b.monthNames,a.dayNames=b.dayNames,a.format=b.defaultFormat}),Ext.define("Ext.form.field.Date",{extend:"Ext.form.field.Picker",alias:"widget.datefield",requires:["Ext.picker.Date"],alternateClassName:["Ext.form.DateField","Ext.form.Date"],format:"m/d/Y",altFormats:"m/d/Y|n/j/Y|n/j/y|m/j/y|n/d/y|m/j/Y|n/d/Y|m-d-y|m-d-Y|m/d|m-d|md|mdy|mdY|d|Y-m-d|n-j|n/j",disabledDaysText:"Disabled",disabledDatesText:"Disabled",minText:"The date in this field must be equal to or after {0}",maxText:"The date in this field must be equal to or before {0}",invalidText:"{0} is not a valid date - it must be in the format {1}",triggerCls:Ext.baseCSSPrefix+"form-date-trigger",showToday:!0,useStrict:undefined,initTime:"12",initTimeFormat:"H",matchFieldWidth:!1,startDay:0,initComponent:function(){var a=this,b=Ext.isString,c,d;c=a.minValue,d=a.maxValue,b(c)&&(a.minValue=a.parseDate(c)),b(d)&&(a.maxValue=a.parseDate(d)),a.disabledDatesRE=null,a.initDisabledDays(),a.callParent()},initValue:function(){var a=this,b=a.value;Ext.isString(b)&&(a.value=a.rawToValue(b)),a.callParent()},initDisabledDays:function(){if(this.disabledDates){var a=this.disabledDates,b=a.length-1,c="(?:",d,e=a.length,f;for(d=0;d<e;d++)f=a[d],c+=Ext.isDate(f)?"^"+Ext.String.escapeRegex(f.dateFormat(this.format))+"$":f,d!==b&&(c+="|");this.disabledDatesRE=new RegExp(c+")")}},setDisabledDates:function(a){var b=this,c=b.picker;b.disabledDates=a,b.initDisabledDays(),c&&c.setDisabledDates(b.disabledDatesRE)},setDisabledDays:function(a){var b=this.picker;this.disabledDays=a,b&&b.setDisabledDays(a)},setMinValue:function(a){var b=this,c=b.picker,d=Ext.isString(a)?b.parseDate(a):a;b.minValue=d,c&&(c.minText=Ext.String.format(b.minText,b.formatDate(b.minValue)),c.setMinDate(d))},setMaxValue:function(a){var b=this,c=b.picker,d=Ext.isString(a)?b.parseDate(a):a;b.maxValue=d,c&&(c.maxText=Ext.String.format(b.maxText,b.formatDate(b.maxValue)),c.setMaxDate(d))},getErrors:function(a){var b=this,c=Ext.String.format,d=Ext.Date.clearTime,e=b.callParent(arguments),f=b.disabledDays,g=b.disabledDatesRE,h=b.minValue,i=b.maxValue,j=f?f.length:0,k=0,l,m,n,o;a=b.formatDate(a||b.processRawValue(b.getRawValue()));if(a===null||a.length<1)return e;l=a,a=b.parseDate(a);if(!a)return e.push(c(b.invalidText,l,Ext.Date.unescapeFormat(b.format))),e;o=a.getTime(),h&&o<d(h).getTime()&&e.push(c(b.minText,b.formatDate(h))),i&&o>d(i).getTime()&&e.push(c(b.maxText,b.formatDate(i)));if(f){n=a.getDay();for(;k<j;k++)if(n===f[k]){e.push(b.disabledDaysText);break}}return m=b.formatDate(a),g&&g.test(m)&&e.push(c(b.disabledDatesText,m)),e},rawToValue:function(a){return this.parseDate(a)||a||null},valueToRaw:function(a){return this.formatDate(this.parseDate(a))},safeParse:function(a,b){var c=this,d=Ext.Date,e=null,f=c.useStrict,g;return d.formatContainsHourInfo(b)?e=d.parse(a,b,f):(g=d.parse(a+" "+c.initTime,b+" "+c.initTimeFormat,f),g&&(e=d.clearTime(g))),e},getSubmitValue:function(){var a=this.submitFormat||this.format,b=this.getValue();return b?Ext.Date.format(b,a):""},parseDate:function(a){if(!a||Ext.isDate(a))return a;var b=this,c=b.safeParse(a,b.format),d=b.altFormats,e=b.altFormatsArray,f=0,g;if(!c&&d){e=e||d.split("|"),g=e.length;for(;f<g&&!c;++f)c=b.safeParse(a,e[f])}return c},formatDate:function(a){return Ext.isDate(a)?Ext.Date.dateFormat(a,this.format):a},createPicker:function(){var a=this,b=Ext.String.format;return new Ext.picker.Date({pickerField:a,ownerCt:a.ownerCt,renderTo:document.body,floating:!0,hidden:!0,focusOnShow:!0,minDate:a.minValue,maxDate:a.maxValue,disabledDatesRE:a.disabledDatesRE,disabledDatesText:a.disabledDatesText,disabledDays:a.disabledDays,disabledDaysText:a.disabledDaysText,format:a.format,showToday:a.showToday,startDay:a.startDay,minText:b(a.minText,a.formatDate(a.minValue)),maxText:b(a.maxText,a.formatDate(a.maxValue)),listeners:{scope:a,select:a.onSelect},keyNavConfig:{esc:function(){a.collapse()}}})},onSelect:function(a,b){var c=this;c.setValue(b),c.fireEvent("select",c,b),c.collapse()},onExpand:function(){var a=this.getValue();this.picker.setValue(Ext.isDate(a)?a:new Date)},onCollapse:function(){this.focus(!1,60)},beforeBlur:function(){var a=this,b=a.parseDate(a.getRawValue()),c=a.focusTask;c&&c.cancel(),b&&a.setValue(b)}}),Ext.define("Ext.resizer.BorderSplitterTracker",{extend:"Ext.resizer.SplitterTracker",requires:["Ext.util.Region"],getPrevCmp:null,getNextCmp:null,calculateConstrainRegion:function(){var a=this,b=a.splitter,c=b.collapseTarget,d=b.defaultSplitMin,e=b.vertical?"Width":"Height",f="min"+e,g="max"+e,h="get"+e,i=b.neighbors,j=i.length,k=c.el.getBox(),l=k.x,m=k.y,n=k.right,o=k.bottom,p=b.vertical?n-l:o-m,q,r,s,t,u,v,w;s=(c[f]||Math.min(p,d))-p,t=c[g],t?t-=p:t=1e9,w=p;for(q=0;q<j;++q)r=i[q],p=r[h](),u=p-r[g],v=p-(r[f]||Math.min(p,d)),isNaN(u)||s<u&&(s=u),t>v&&(t=v);return t-s<2?null:(k=new Ext.util.Region(m,n,o,l),a.constraintAdjusters[b.collapseDirection](k,s,t,b),a.dragInfo={minRange:s,maxRange:t,targetSize:w},k)},constraintAdjusters:{left:function(a,b,c,d){a[0]=a.x=a.left=a.right+b,a.right+=c+d.getWidth()},top:function(a,b,c,d){a[1]=a.y=a.top=a.bottom+b,a.bottom+=c+d.getHeight()},bottom:function(a,b,c,d){a.bottom=a.top-b,a.top-=c+d.getHeight()},right:function(a,b,c,d){a.right=a.left-b,a.left-=c+d.getWidth()}},onBeforeStart:function(a){var b=this,c=b.splitter,d=c.collapseTarget,e=c.neighbors,f=b.getSplitter().collapseEl,g=a.getTarget(),h=e.length,i,j;if(f&&g===c.collapseEl.dom)return!1;if(d.collapsed)return!1;for(i=0;i<h;++i){j=e[i];if(j.collapsed&&j.isHorz===d.isHorz)return!1}return(b.constrainTo=b.calculateConstrainRegion())?(b.createDragOverlay(),!0):!1},performResize:function(a,b){var c=this,d=c.splitter,e=d.collapseDirection,f=d.collapseTarget,g=c.splitAdjusters[d.vertical?"horz":"vert"],h=b[g.index],i=c.dragInfo,j;if(e=="right"||e=="bottom")h=-h;h=Math.min(Math.max(i.minRange,h),i.maxRange),h&&((j=d.ownerCt).suspendLayouts(),g.adjustTarget(f,i.targetSize,h),j.resumeLayouts(!0))},splitAdjusters:{horz:{index:0,adjustTarget:function(a,b,c){a.flex=null,a.setSize(b+c)}},vert:{index:1,adjustTarget:function(a,b,c){a.flex=null,a.setSize(undefined,b+c)}}}}),Ext.define("Ext.resizer.Handle",{extend:"Ext.Component",handleCls:"",baseHandleCls:Ext.baseCSSPrefix+"resizable-handle",region:"",beforeRender:function(){var a=this;a.callParent(),a.addCls(a.baseHandleCls,a.baseHandleCls+"-"+a.region,a.handleCls)},onRender:function(){this.callParent(arguments),this.el.unselectable()}}),Ext.define("Ext.resizer.Splitter",{extend:"Ext.Component",requires:["Ext.XTemplate"],uses:["Ext.resizer.SplitterTracker"],alias:"widget.splitter",childEls:["collapseEl"],renderTpl:['<tpl if="collapsible===true">','<div id="{id}-collapseEl" class="',Ext.baseCSSPrefix,"collapse-el ",Ext.baseCSSPrefix,'layout-split-{collapseDir}">&#160;</div>',"</tpl>"],baseCls:Ext.baseCSSPrefix+"splitter",collapsedClsInternal:Ext.baseCSSPrefix+"splitter-collapsed",collapsible:!1,collapseOnDblClick:!0,defaultSplitMin:40,defaultSplitMax:1e3,width:5,height:5,collapseTarget:"next",horizontal:!1,vertical:!1,getTrackerConfig:function(){return{xclass:"Ext.resizer.SplitterTracker",el:this.el,splitter:this}},beforeRender:function(){var a=this,b=a.getCollapseTarget(),c=a.getCollapseDirection();a.callParent(),b.collapsed&&a.addCls(a.collapsedClsInternal),a.addCls(a.baseCls+"-"+a.orientation),Ext.applyIf(a.renderData,{collapseDir:c,collapsible:a.collapsible||b.collapsible})},onRender:function(){var a=this;a.callParent(arguments),a.performCollapse!==!1&&(a.renderData.collapsible&&a.mon(a.collapseEl,"click",a.toggleTargetCmp,a),a.collapseOnDblClick&&a.mon(a.el,"dblclick",a.toggleTargetCmp,a)),a.mon(a.getCollapseTarget(),{collapse:a.onTargetCollapse,expand:a.onTargetExpand,scope:a}),a.el.unselectable(),a.tracker=Ext.create(a.getTrackerConfig()),a.relayEvents(a.tracker,["beforedragstart","dragstart","dragend"])},getCollapseDirection:function(){var a=this,b=a.collapseDirection,c,d,e,f;return b||(c=a.collapseTarget,c.isComponent&&(b=c.collapseDirection),b||(f=a.ownerCt.layout.type,c.isComponent?(e=a.ownerCt.items,d=Number(e.indexOf(c)==e.indexOf(a)-1)<<1|Number(f=="hbox")):d=Number(a.collapseTarget=="prev")<<1|Number(f=="hbox"),b=["bottom","right","top","left"][d]),a.collapseDirection=b),a.orientation=b=="top"||b=="bottom"?"horizontal":"vertical",a[a.orientation]=!0,b},getCollapseTarget:function(){var a=this;return a.collapseTarget.isComponent?a.collapseTarget:a.collapseTarget=="prev"?a.previousSibling():a.nextSibling()},onTargetCollapse:function(a){this.el.addCls([this.collapsedClsInternal,this.collapsedCls])},onTargetExpand:function(a){this.el.removeCls([this.collapsedClsInternal,this.collapsedCls])},toggleTargetCmp:function(a,b){var c=this.getCollapseTarget(),d=c.placeholder,e;d&&!d.hidden?e=!0:e=!c.hidden,e&&(c.collapsed?c.expand():c.collapseDirection?c.collapse():c.collapse(this.renderData.collapseDir))},setSize:function(){var a=this;a.callParent(arguments),Ext.isIE&&a.el&&a.el.repaint()}}),Ext.define("Ext.resizer.BorderSplitter",{extend:"Ext.resizer.Splitter",uses:["Ext.resizer.BorderSplitterTracker"],alias:"widget.bordersplitter",collapseTarget:null,getTrackerConfig:function(){var a=this.callParent();return a.xclass="Ext.resizer.BorderSplitterTracker",a}}),Ext.define("Ext.layout.container.Border",{alias:"layout.border",extend:"Ext.layout.container.Container",requires:["Ext.resizer.BorderSplitter","Ext.Component","Ext.fx.Anim"],alternateClassName:"Ext.layout.BorderLayout",targetCls:Ext.baseCSSPrefix+"border-layout-ct",itemCls:[Ext.baseCSSPrefix+"border-item",Ext.baseCSSPrefix+"box-item"],type:"border",padding:undefined,percentageRe:/(\d+)%/,axisProps:{horz:{borderBegin:"west",borderEnd:"east",horizontal:!0,posProp:"x",sizeProp:"width",sizePropCap:"Width"},vert:{borderBegin:"north",borderEnd:"south",horizontal:!1,posProp:"y",sizeProp:"height",sizePropCap:"Height"}},centerRegion:null,collapseDirections:{north:"top",south:"bottom",east:"right",west:"left"},manageMargins:!0,panelCollapseAnimate:!0,panelCollapseMode:"placeholder",regionWeights:{north:20,south:10,center:0,west:-10,east:-20},beginAxis:function(a,b,c){var d=this,e=d.axisProps[c],f=!e.horizontal,g=e.sizeProp,h=0,i=a.childItems,j=i.length,k,l,m,n,o,p,q,r,s,t,u;for(l=0;l<j;++l){m=i[l],o=m.target,m.layoutPos={};if(o.region){m.region=p=o.region,m.isCenter=o.isCenter,m.isHorz=o.isHorz,m.isVert=o.isVert,m.weight=o.weight||d.regionWeights[p]||0,b[o.id]=m;if(o.isCenter){k=m,n=o.flex,a.centerRegion=k;continue}if(f!==m.isVert)continue;m.reverseWeighting=p==e.borderEnd,r=o[g],s=typeof r,o.collapsed||(s=="string"&&(q=d.percentageRe.exec(r))?m.percentage=parseInt(q[1],10):o.flex&&(h+=m.flex=o.flex))}}return k&&(t=k.target,(u=t.placeholderFor)?!n&&f===u.collapsedVertical()&&(n=0,k.collapseAxis=c):t.collapsed&&f===t.collapsedVertical()&&(n=0,k.collapseAxis=c)),n==null&&(n=1),h+=n,Ext.apply({before:f?"top":"left",totalFlex:h},e)},beginLayout:function(a){var b=this,c=b.getLayoutItems(),d=b.padding,e=typeof d,f=!1,g,h,i,j,k,l;if(d){if(e=="string"||e=="number")d=Ext.util.Format.parseBox(d)}else d=a.getEl("getTargetEl").getPaddingInfo(),f=!0;a.outerPad=d,a.padOnContainer=f;for(j=0,i=c.length;j<i;++j)h=c[j],l=b.getSplitterTarget(h),l&&h.hidden!==l.hidden&&(h.hidden?h.show():h.hide());b.callParent(arguments),c=a.childItems,i=c.length,k={},a.borderAxisHorz=b.beginAxis(a,k,"horz"),a.borderAxisVert=b.beginAxis(a,k,"vert");for(j=0;j<i;++j)g=c[j],l=b.getSplitterTarget(g.target),l&&(g.collapseTarget=l=k[l.id],g.weight=l.weight,g.reverseWeighting=l.reverseWeighting,l.splitter=g,g.isHorz=l.isHorz,g.isVert=l.isVert);b.sortWeightedItems(c,"reverseWeighting"),b.setupSplitterNeighbors(c)},calculate:function(a){var b=this,c=b.getContainerSize(a),d=a.childItems,e=d.length,f=a.borderAxisHorz,g=a.borderAxisVert,h=a.outerPad,i=a.padOnContainer,j,k,l,m,n,o;f.begin=h.left,g.begin=h.top,n=f.end=f.flexSpace=c.width+(i?h.left:-h.right),o=g.end=g.flexSpace=c.height+(i?h.top:-h.bottom);for(j=0;j<e;++j){k=d[j],l=k.getMarginInfo();if(k.isHorz||k.isCenter)f.addUnflexed(l.width),n-=l.width;if(k.isVert||k.isCenter)g.addUnflexed(l.height),o-=l.height;if(!k.flex&&!k.percentage)if(k.isHorz||k.isCenter&&k.collapseAxis==="horz")m=k.getProp("width"),f.addUnflexed(m),k.collapseTarget&&(n-=m);else if(k.isVert||k.isCenter&&k.collapseAxis==="vert")m=k.getProp("height"),g.addUnflexed(m),k.collapseTarget&&(o-=m)}for(j=0;j<e;++j)k=d[j],l=k.getMarginInfo(),k.percentage&&(k.isHorz?(m=Math.ceil(n*k.percentage/100),m=k.setWidth(m),f.addUnflexed(m)):k.isVert&&(m=Math.ceil(o*k.percentage/100),m=k.setHeight(m),g.addUnflexed(m)));for(j=0;j<e;++j)k=d[j],k.isCenter||(b.calculateChildAxis(k,f),b.calculateChildAxis(k,g));b.finishAxis(a,g)+b.finishAxis(a,f)<2?b.done=!1:b.finishPositions(d)},calculateChildAxis:function(a,b){var c=a.collapseTarget,d="set"+b.sizePropCap,e=b.sizeProp,f=a.getMarginInfo()[e],g,h,i,j,k;c?g=c.region:(g=a.region,i=a.flex),h=g==b.borderBegin,!h&&g!=b.borderEnd?(a[d](b.end-b.begin-f),j=b.begin):(i?(k=Math.ceil(b.flexSpace*(i/b.totalFlex)),k=a[d](k)):a.percentage?k=a.peek(e):k=a.getProp(e),k+=f,h?(j=b.begin,b.begin+=k):b.end=j=b.end-k),a.layoutPos[b.posProp]=j},finishAxis:function(a,b){var c=b.end-b.begin,d=a.centerRegion;return d&&(d["set"+b.sizePropCap](c-d.getMarginInfo()[b.sizeProp]),d.layoutPos[b.posProp]=b.begin),Ext.isNumber(c)?1:0},finishPositions:function(a){var b=a.length,c,d;for(c=0;c<b;++c)d=a[c],d.setProp("x",d.layoutPos.x+d.marginInfo.left),d.setProp("y",d.layoutPos.y+d.marginInfo.top)},getPlaceholder:function(a){return a.getPlaceholder&&a.getPlaceholder()},getSplitterTarget:function(a){var b=a.collapseTarget;return b&&b.collapsed?b.placeholder||b:b},isItemBoxParent:function(a){return!0},isItemShrinkWrap:function(a){return!0},insertSplitter:function(a,b){var c=a.region,d={xtype:"bordersplitter",collapseTarget:a,id:a.id+"-splitter",hidden:!!a.hidden},e=b+(c=="south"||c=="east"?0:1);a.isHorz?d.height=null:d.width=null,a.collapseMode=="mini"&&(d.collapsedCls=a.collapsedCls),a.splitter=this.owner.add(e,d)},onAdd:function(a,b){var c=this,d=a.placeholderFor,e=a.region;c.callParent(arguments),e?(Ext.apply(a,c.regionFlags[e]),e=="center"?c.centerRegion=a:(a.collapseDirection=this.collapseDirections[e],a.split&&(a.isHorz||a.isVert)&&c.insertSplitter(a,b)),a.hasOwnProperty("collapseMode")||(a.collapseMode=c.panelCollapseMode),a.hasOwnProperty("animCollapse")||(a.collapseMode!="placeholder"?a.animCollapse=!1:a.animCollapse=c.panelCollapseAnimate)):d&&(Ext.apply(a,c.regionFlags[d.region]),a.region=d.region,a.weight=d.weight)},onDestroy:function(){this.centerRegion=null,this.callParent()},onRemove:function(a){var b=this,c=a.region,d=a.splitter;c&&(a.isCenter&&(b.centerRegion=null),delete a.isCenter,delete a.isHorz,delete a.isVert,d&&(b.owner.doRemove(d,!0),delete a.splitter)),b.callParent(arguments)},regionFlags:{center:{isCenter:!0,isHorz:!1,isVert:!1},north:{isCenter:!1,isHorz:!1,isVert:!0},south:{isCenter:!1,isHorz:!1,isVert:!0},west:{isCenter:!1,isHorz:!0,isVert:!1},east:{isCenter:!1,isHorz:!0,isVert:!1}},setupSplitterNeighbors:function(a){var b={},c=a.length,d=this.touchedRegions,e,f,g,h,i,j,k,l,m;for(e=0;e<c;++e){j=a[e].target,k=j.region;if(j.isCenter)g=j;else if(k){m=d[k];for(f=0,h=m.length;f<h;++f)i=b[m[f]],i&&i.neighbors.push(j);j.placeholderFor?l=j.placeholderFor.splitter:l=j.splitter,l&&(l.neighbors=[]),b[k]=l}}if(g){m=d.center;for(f=0,h=m.length;f<h;++f)i=b[m[f]],i&&i.neighbors.push(g)}},touchedRegions:{center:["north","south","east","west"],north:["north","east","west"],south:["south","east","west"],east:["east","north","south"],west:["west","north","south"]},sizePolicies:{vert:{setsWidth:1,setsHeight:0},horz:{setsWidth:0,setsHeight:1},flexAll:{setsWidth:1,setsHeight:1}},getItemSizePolicy:function(a){var b=this,c=this.sizePolicies,d,e,f,g;if(a.isCenter)return g=a.placeholderFor,g?g.collapsedVertical()?c.vert:c.horz:a.collapsed?a.collapsedVertical()?c.vert:c.horz:c.flexAll;return d=a.collapseTarget,d?d.isVert?c.vert:c.horz:a.region?(a.isVert?(e=a.height,f=c.vert):(e=a.width,f=c.horz),a.flex||typeof e=="string"&&b.percentageRe.test(e)?c.flexAll:f):b.autoSizePolicy}},function(){var a={addUnflexed:function(a){this.flexSpace=Math.max(this.flexSpace-a,0)}},b=this.prototype.axisProps;Ext.apply(b.horz,a),Ext.apply(b.vert,a)}),Ext.define("Ext.selection.CellModel",{extend:"Ext.selection.Model",alias:"selection.cellmodel",requires:["Ext.util.KeyNav"],isCellModel:!0,enableKeyNav:!0,preventWrap:!1,noSelection:{row:-1,column:-1},constructor:function(){this.addEvents("deselect","select"),this.callParent(arguments)},bindComponent:function(a){var b=this;b.primaryView=a,b.views=b.views||[],b.views.push(a),b.bindStore(a.getStore(),!0),a.on({cellmousedown:b.onMouseDown,refresh:b.onViewRefresh,scope:b}),b.enableKeyNav&&b.initKeyNav(a)},initKeyNav:function(a){var b=this;if(!a.rendered){a.on("render",Ext.Function.bind(b.initKeyNav,b,[a],0),b,{single:!0});return}a.el.set({tabIndex:-1}),b.keyNav=new Ext.util.KeyNav(a.el,{up:b.onKeyUp,down:b.onKeyDown,right:b.onKeyRight,left:b.onKeyLeft,tab:b.onKeyTab,scope:b})},getHeaderCt:function(){return this.primaryView.headerCt},onKeyUp:function(a,b){this.keyNavigation=!0,this.move("up",a),this.keyNavigation=!1},onKeyDown:function(a,b){this.keyNavigation=!0,this.move("down",a),this.keyNavigation=!1},onKeyLeft:function(a,b){this.keyNavigation=!0,this.move("left",a),this.keyNavigation=!1},onKeyRight:function(a,b){this.keyNavigation=!0,this.move("right",a),this.keyNavigation=!1},move:function(a,b){var c=this,d=c.primaryView.walkCells(c.getCurrentPosition(),a,b,c.preventWrap);if(d)return c.setCurrentPosition(d)},getCurrentPosition:function(){return this.selection},setCurrentPosition:function(a){var b=this;b.lastSelection=b.selection,b.selection&&b.onCellDeselect(b.selection);if(a)return b.nextSelection=new b.Selection(b),b.nextSelection.setPosition(a),b.onCellSelect(b.nextSelection),b.selection=b.nextSelection},onStoreRemove:function(a,b,c){var d=this,e=d.getCurrentPosition();d.callParent(arguments),e&&(e.row==c?c<a.getCount()-1?(e.setPosition(c,e.column),d.setCurrentPosition(e)):delete d.selection:c<e.row&&(e.setPosition(e.row-1,e.column),d.setCurrentPosition(e)))},onMouseDown:function(a,b,c,d,e,f,g){this.setCurrentPosition({view:a,row:f,column:c})},onCellSelect:function(a,b){a&&a.row!==undefined&&this.doSelect(this.view.getStore().getAt(a.row),!1,b)},onCellDeselect:function(a,b){a&&a.row!==undefined&&this.doDeselect(this.view.getStore().getAt(a.row),b)},onSelectChange:function(a,b,c,d){var e=this,f,g,h=e.primaryView;b?(f=e.nextSelection,g="select"):(f=e.lastSelection||e.noSelection,g="deselect"),(c||e.fireEvent("before"+g,e,a,f.row,f.column))!==!1&&d()!==!1&&(b?(h.onCellSelect(f),h.onCellFocus(f)):(h.onCellDeselect(f),delete e.selection),c||e.fireEvent(g,e,a,f.row,f.column))},onKeyTab:function(a,b){var c=this,d=c.primaryView.editingPlugin;d&&c.wasEditing?c.onEditorTab(d,a):c.move(a.shiftKey?"left":"right",a)},onEditorTab:function(a,b){var c=this,d=b.shiftKey?"left":"right",e=c.move(d,b);e&&(a.startEditByPosition(e)?c.wasEditing=!1:(c.wasEditing=!0,e.columnHeader.dataIndex||c.onEditorTab(a,b)))},refresh:function(){var a=this.getCurrentPosition(),b;a&&(b=this.store.indexOf(this.selected.last()))!==-1&&(a.row=b)},onViewRefresh:function(){var a=this,b=a.getCurrentPosition(),c=a.primaryView,d=c.headerCt,e,f;b&&(e=b.record,f=b.columnHeader,a.onCellDeselect(b,!0),f.isDescendantOf(d)||(f=d.queryById(f.id)||d.down('[text="'+f.text+'"]')||d.down('[dataIndex="'+f.dataIndex+'"]')),f&&c.store.indexOfId(e.getId())!==-1&&((a.selection=new a.Selection(a)).setPosition(e,f),a.onCellSelect(a.selection,!0)))},selectByPosition:function(a){this.setCurrentPosition(a)}},function(){var a=this.prototype.Selection=function(a){this.model=a};a.prototype.setPosition=function(a,b){var c=this,d=c.model.primaryView,e;return arguments.length===1&&(a.view&&(d=a.view),b=a.column,a=a.row),e=d.store,typeof a=="number"?(c.row=a,c.record=e.getAt(a)):a.isModel?(c.record=a,c.row=d.indexOf(a)):a.tagName&&(c.record=d.getRecord(a),c.row=d.indexOf(c.record)),typeof b=="number"?(c.column=b,c.columnHeader=d.getHeaderAtIndex(b)):(c.columnHeader=b,c.column=b.getIndex()),c}}),Ext.define("Ext.selection.RowModel",{extend:"Ext.selection.Model",alias:"selection.rowmodel",requires:["Ext.util.KeyNav"],deltaScroll:5,enableKeyNav:!0,ignoreRightMouseSelection:!1,constructor:function(){this.addEvents("beforedeselect","beforeselect","deselect","select"),this.views=[],this.callParent(arguments)},bindComponent:function(a){var b=this;b.views=b.views||[],b.views.push(a),b.bindStore(a.getStore(),!0),a.on({itemmousedown:b.onRowMouseDown,scope:b}),b.enableKeyNav&&b.initKeyNav(a)},initKeyNav:function(a){var b=this;if(!a.rendered){a.on("render",Ext.Function.bind(b.initKeyNav,b,[a],0),b,{single:!0});return}a.el.set({tabIndex:-1}),b.keyNav=new Ext.util.KeyNav({target:a,eventName:"itemkeydown",processEvent:function(a,b,c,d,e){return e.record=b,e.recordIndex=d,e},up:b.onKeyUp,down:b.onKeyDown,right:b.onKeyRight,left:b.onKeyLeft,pageDown:b.onKeyPageDown,pageUp:b.onKeyPageUp,home:b.onKeyHome,end:b.onKeyEnd,space:b.onKeySpace,scope:b})},getRowsVisible:function(){var a=!1,b=this.views[0],c=b.getNode(0),d,e;return c&&(d=Ext.fly(c).getHeight(),e=b.el.getHeight(),a=Math.floor(e/d)),a},onKeyEnd:function(a){var b=this,c=b.store.getAt(b.store.getCount()-1);c&&(a.shiftKey?(b.selectRange(c,b.lastFocused||0),b.setLastFocused(c)):a.ctrlKey?b.setLastFocused(c):b.doSelect(c))},onKeyHome:function(a){var b=this,c=b.store.getAt(0);c&&(a.shiftKey?(b.selectRange(c,b.lastFocused||0),b.setLastFocused(c)):a.ctrlKey?b.setLastFocused(c):b.doSelect(c,!1))},onKeyPageUp:function(a){var b=this,c=b.getRowsVisible(),d,e,f;c&&(d=a.recordIndex,e=d-c,e<0&&(e=0),f=b.store.getAt(e),a.shiftKey?(b.selectRange(f,a.record,a.ctrlKey,"up"),b.setLastFocused(f)):a.ctrlKey?(a.preventDefault(),b.setLastFocused(f)):b.doSelect(f))},onKeyPageDown:function(a){var b=this,c=b.getRowsVisible(),d,e,f;c&&(d=a.recordIndex,e=d+c,e>=b.store.getCount()&&(e=b.store.getCount()-1),f=b.store.getAt(e),a.shiftKey?(b.selectRange(f,a.record,a.ctrlKey,"down"),b.setLastFocused(f)):a.ctrlKey?(a.preventDefault(),b.setLastFocused(f)):b.doSelect(f))},onKeySpace:function(a){var b=this,c=b.lastFocused;c&&(b.isSelected(c)?b.doDeselect(c,!1):b.doSelect(c,!0))},onKeyUp:function(a){var b=this,c=b.store.indexOf(b.lastFocused),d;c>0&&(d=b.store.getAt(c-1),a.shiftKey&&b.lastFocused?b.isSelected(b.lastFocused)&&b.isSelected(d)?(b.doDeselect(b.lastFocused,!0),b.setLastFocused(d)):b.isSelected(b.lastFocused)?b.doSelect(d,!0):(b.doSelect(b.lastFocused,!0),b.doSelect(d,!0)):a.ctrlKey?b.setLastFocused(d):b.doSelect(d))},onKeyDown:function(a){var b=this,c=b.store.indexOf(b.lastFocused),d;c+1<b.store.getCount()&&(d=b.store.getAt(c+1),b.selected.getCount()===0?a.ctrlKey?b.setLastFocused(d):b.doSelect(d):a.shiftKey&&b.lastFocused?b.isSelected(b.lastFocused)&&b.isSelected(d)?(b.doDeselect(b.lastFocused,!0),b.setLastFocused(d)):b.isSelected(b.lastFocused)?b.doSelect(d,!0):(b.doSelect(b.lastFocused,!0),b.doSelect(d,!0)):a.ctrlKey?b.setLastFocused(d):b.doSelect(d))},scrollByDeltaX:function(a){var b=this.views[0],c=b.up(),d=c.horizontalScroller;d&&d.scrollByDeltaX(a)},onKeyLeft:function(a){this.scrollByDeltaX(-this.deltaScroll)},onKeyRight:function(a){this.scrollByDeltaX(this.deltaScroll)},onRowMouseDown:function(a,b,c,d,e){if(!this.allowRightMouseSelection(e))return;(e.button===0||!this.isSelected(b))&&this.selectWithEvent(b,e)},allowRightMouseSelection:function(a){var b=this.ignoreRightMouseSelection&&a.button!==0;return b&&(b=this.hasSelection()),!b},onSelectChange:function(a,b,c,d){var e=this,f=e.views,g=f.length,h=e.store,i=h.indexOf(a),j=b?"select":"deselect",k=0;if((c||e.fireEvent("before"+j,e,a,i))!==!1&&d()!==!1){for(;k<g;k++)b?f[k].onRowSelect(i,c):f[k].onRowDeselect(i,c);c||e.fireEvent(j,e,a,i)}},onLastFocusChanged:function(a,b,c){var d=this.views,e=d.length,f=this.store,g,h=0;if(a){g=f.indexOf(a);if(g!=-1)for(;h<e;h++)d[h].onRowFocus(g,!1)}if(b){g=f.indexOf(b);if(g!=-1)for(h=0;h<e;h++)d[h].onRowFocus(g,!0,c)}this.callParent()},onEditorTab:function(a,b){var c=this,d=c.views[0],e=a.getActiveRecord(),f=a.getActiveColumn(),g=d.getPosition(e,f),h=b.shiftKey?"left":"right";do g=d.walkCells(g,h,b,c.preventWrap);while(g&&!d.headerCt.getHeaderAtIndex(g.column).getEditor());g&&a.startEditByPosition(g)},selectByPosition:function(a){var b=this.store.getAt(a.row);this.select(b)},selectNext:function(a,b){var c=this,d=c.store,e=c.getSelection(),f=e[e.length-1],g=d.indexOf(f)+1,h;return g===d.getCount()||g===0?h=!1:(c.doSelect(g,a,b),h=!0),h},selectPrevious:function(a,b){var c=this,d=c.getSelection(),e=d[0],f=c.store.indexOf(e)-1,g;return f<0?g=!1:(c.doSelect(f,a,b),g=!0),g}}),Ext.define("Ext.selection.CheckboxModel",{alias:"selection.checkboxmodel",extend:"Ext.selection.RowModel",mode:"MULTI",injectCheckbox:0,checkOnly:!1,showHeaderCheckbox:!0,headerWidth:24,checkerOnCls:Ext.baseCSSPrefix+"grid-hd-checker-on",bindComponent:function(a){var b=this;b.sortable=!1,b.callParent(arguments);if(!b.hasLockedHeader()||a.headerCt.lockedCt)b.showHeaderCheckbox!==!1&&a.headerCt.on("headerclick",b.onHeaderClick,b),b.addCheckbox(!0),b.mon(a.ownerCt,"reconfigure",b.onReconfigure,b)},hasLockedHeader:function(){var a=this.views,b=a.length,c;for(c=0;c<b;c++)if(a[c].headerCt.lockedCt)return!0;return!1},addCheckbox:function(a){var b=this,c=b.injectCheckbox,d=b.views[0],e=d.headerCt;c!==!1&&(c=="first"?c=0:c=="last"&&(c=e.getColumnCount()),Ext.suspendLayouts(),e.add(c,b.getHeaderConfig()),Ext.resumeLayouts()),a!==!0&&d.refresh()},onReconfigure:function(a,b,c){c&&this.addCheckbox()},toggleUiHeader:function(a){var b=this.views[0],c=b.headerCt,d=c.child("gridcolumn[isCheckerHd]");d&&(a?d.el.addCls(this.checkerOnCls):d.el.removeCls(this.checkerOnCls))},onHeaderClick:function(a,b,c){if(b.isCheckerHd){c.stopEvent();var d=this,e=b.el.hasCls(Ext.baseCSSPrefix+"grid-hd-checker-on");d.preventFocus=!0,e?d.deselectAll():d.selectAll(),delete d.preventFocus}},getHeaderConfig:function(){var a=this,b=a.showHeaderCheckbox!==!1;return{isCheckerHd:b,text:"&#160;",width:a.headerWidth,sortable:!1,draggable:!1,resizable:!1,hideable:!1,menuDisabled:!0,dataIndex:"",cls:b?Ext.baseCSSPrefix+"column-header-checkbox ":"",renderer:Ext.Function.bind(a.renderer,a),editRenderer:a.editRenderer||a.renderEmpty,locked:a.hasLockedHeader()}},renderEmpty:function(){return"&#160;"},renderer:function(a,b,c,d,e,f,g){var h=Ext.baseCSSPrefix;return b.tdCls=h+"grid-cell-special "+h+"grid-cell-row-checker",'<div class="'+h+'grid-row-checker">&#160;</div>'},onRowMouseDown:function(a,b,c,d,e){a.el.focus();var f=this,g=e.getTarget("."+Ext.baseCSSPrefix+"grid-row-checker"),h;if(!f.allowRightMouseSelection(e))return;if(f.checkOnly&&!g)return;g?(h=f.getSelectionMode(),h!=="SINGLE"&&f.setSelectionMode("SIMPLE"),f.selectWithEvent(b,e),f.setSelectionMode(h)):f.selectWithEvent(b,e)},onSelectChange:function(){this.callParent(arguments);var a=this.selected.getCount()===this.store.getCount();this.toggleUiHeader(a)}}),Ext.define("Ext.selection.TreeModel",{extend:"Ext.selection.RowModel",alias:"selection.treemodel",pruneRemoved:!1,onKeyRight:function(a,b){var c=this.getLastFocused(),d=this.view;c&&(c.isExpanded()?this.onKeyDown(a,b):c.isLeaf()||d.expand(c))},onKeyLeft:function(a,b){var c=this.getLastFocused(),d=this.view,e=d.getSelectionModel(),f,g;c&&(f=c.parentNode,c.isExpanded()?d.collapse(c):f&&!f.isRoot()&&(a.shiftKey?(e.selectRange(f,c,a.ctrlKey,"up"),e.setLastFocused(f)):a.ctrlKey?e.setLastFocused(f):e.select(f)))},onKeyPress:function(a,b){var c=a.getKey(),d,e;c===a.SPACE||c===a.ENTER?(a.stopEvent(),d=this.getLastSelected(),d&&this.view.onCheckChange(d)):this.callParent(arguments)}}),Ext.define("Ext.tab.Tab",{extend:"Ext.button.Button",alias:"widget.tab",requires:["Ext.layout.component.Tab","Ext.util.KeyNav"],componentLayout:"tab",isTab:!0,baseCls:Ext.baseCSSPrefix+"tab",activeCls:"active",closableCls:"closable",closable:!0,closeText:"Close Tab",active:!1,childEls:["closeEl"],scale:!1,position:"top",initComponent:function(){var a=this;a.addEvents("activate","deactivate","beforeclose","close"),a.callParent(arguments),a.card&&a.setCard(a.card)},getTemplateArgs:function(){var a=this,b=a.callParent();return b.closable=a.closable,b.closeText=a.closeText,b},beforeRender:function(){var a=this,b=a.up("tabbar"),c=a.up("tabpanel");a.callParent(),a.addClsWithUI(a.position),a.syncClosableUI(),a.minWidth||(a.minWidth=b?b.minTabWidth:a.minWidth,!a.minWidth&&c&&(a.minWidth=c.minTabWidth),a.minWidth&&a.iconCls&&(a.minWidth+=25)),a.maxWidth||(a.maxWidth=b?b.maxTabWidth:a.maxWidth,!a.maxWidth&&c&&(a.maxWidth=c.maxTabWidth))},onRender:function(){var a=this;a.callParent(arguments),a.keyNav=new Ext.util.KeyNav(a.el,{enter:a.onEnterKey,del:a.onDeleteKey,scope:a})},enable:function(a){var b=this;return b.callParent(arguments),b.removeClsWithUI(b.position+"-disabled"),b},disable:function(a){var b=this;return b.callParent(arguments),b.addClsWithUI(b.position+"-disabled"),b},onDestroy:function(){var a=this;Ext.destroy(a.keyNav),delete a.keyNav,a.callParent(arguments)},setClosable:function(a){var b=this;a=!arguments.length||!!a,b.closable!=a&&(b.closable=a,b.card&&(b.card.closable=a),b.syncClosableUI(),b.rendered&&(b.syncClosableElements(),b.updateLayout()))},syncClosableElements:function(){var a=this,b=a.closeEl;a.closable?b||(a.closeEl=a.btnWrap.insertSibling({tag:"a",cls:a.baseCls+"-close-btn",href:"#",title:a.closeText},"after")):b&&(b.remove(),delete a.closeEl)},syncClosableUI:function(){var a=this,b=[a.closableCls,a.closableCls+"-"+a.position];a.closable?a.addClsWithUI(b):a.removeClsWithUI(b)},setCard:function(a){var b=this;b.card=a,b.setText(b.title||a.title),b.setIconCls(b.iconCls||a.iconCls),b.setIcon(b.icon||a.icon)},onCloseClick:function(){var a=this;if(a.fireEvent("beforeclose",a)!==!1)if(a.tabBar){if(a.tabBar.closeTab(a)===!1)return}else a.fireClose()},fireClose:function(){this.fireEvent("close",this)},onEnterKey:function(a){var b=this;b.tabBar&&b.tabBar.onClick(a,b.el)},onDeleteKey:function(a){this.closable&&this.onCloseClick()},activate:function(a){var b=this;b.active=!0,b.addClsWithUI([b.activeCls,b.position+"-"+b.activeCls]),a!==!0&&b.fireEvent("activate",b)},deactivate:function(a){var b=this;b.active=!1,b.removeClsWithUI([b.activeCls,b.position+"-"+b.activeCls]),a!==!0&&b.fireEvent("deactivate",b)}}),Ext.define("Ext.tab.Bar",{extend:"Ext.panel.Header",alias:"widget.tabbar",baseCls:Ext.baseCSSPrefix+"tab-bar",requires:["Ext.tab.Tab"],isTabBar:!0,defaultType:"tab",plain:!1,childEls:["body","strip"],renderTpl:['<div id="{id}-body" class="{baseCls}-body {bodyCls}<tpl if="ui"> {baseCls}-body-{ui}<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl></tpl>"<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values)%}","</div>",'<div id="{id}-strip" class="{baseCls}-strip<tpl if="ui"> {baseCls}-strip-{ui}<tpl for="uiCls"> {parent.baseCls}-strip-{parent.ui}-{.}</tpl></tpl>"></div>'],initComponent:function(){var a=this;a.plain&&a.setUI(a.ui+"-plain"),a.addClsWithUI(a.dock),a.addEvents("change"),a.callParent(arguments),a.layout.align=a.orientation=="vertical"?"left":"top",a.layout.overflowHandler=new Ext.layout.container.boxOverflow.Scroller(a.layout),a.remove(a.titleCmp),delete a.titleCmp,Ext.apply(a.renderData,{bodyCls:a.bodyCls})},getLayout:function(){var a=this;return a.layout.type=a.dock==="top"||a.dock==="bottom"?"hbox":"vbox",a.callParent(arguments)},onAdd:function(a){a.position=this.dock,this.callParent(arguments)},onRemove:function(a){var b=this;a===b.previousTab&&(b.previousTab=null),b.callParent(arguments)},afterComponentLayout:function(a){this.callParent(arguments),this.strip.setWidth(a)},onClick:function(a,b){var c=this,d=a.getTarget("."+Ext.tab.Tab.prototype.baseCls),e=d&&Ext.getCmp(d.id),f=c.tabPanel,g=e&&e.closeEl&&b===e.closeEl.dom;g&&a.preventDefault(),e&&e.isDisabled&&!e.isDisabled()&&(e.closable&&g?e.onCloseClick():(f?f.setActiveTab(e.card):c.setActiveTab(e),e.focus()))},closeTab:function(a){var b=this,c=a.card,d=b.tabPanel,e;if(c&&c.fireEvent("beforeclose",c)===!1)return!1;e=b.findNextActivatable(a),Ext.suspendLayouts();if(d&&c){delete a.ownerCt,c.fireEvent("close",c),d.remove(c);if(!!d.getComponent(c))return a.ownerCt=b,Ext.resumeLayouts(!0),!1;a.fireClose(),b.remove(a)}e&&(d?d.setActiveTab(e.card):b.setActiveTab(e),e.focus()),Ext.resumeLayouts(!0)},findNextActivatable:function(a){var b=this;if(a.active&&b.items.getCount()>1)return b.previousTab&&b.previousTab!==a&&!b.previousTab.disabled?b.previousTab:a.next("tab[disabled=false]")||a.prev("tab[disabled=false]")},setActiveTab:function(a){var b=this;!a.disabled&&a!==b.activeTab&&(b.activeTab&&(b.activeTab.isDestroyed?b.previousTab=null:(b.previousTab=b.activeTab,b.activeTab.deactivate())),a.activate(),b.activeTab=a,b.fireEvent("change",b,a,a.card),b.on({afterlayout:b.afterTabActivate,scope:b,single:!0}),b.updateLayout())},afterTabActivate:function(){this.layout.overflowHandler.scrollToItem(this.activeTab)}}),Ext.define("Ext.toolbar.Fill",{extend:"Ext.Component",alias:"widget.tbfill",alternateClassName:"Ext.Toolbar.Fill",isFill:!0,flex:1}),Ext.define("Ext.toolbar.Item",{extend:"Ext.Component",alias:"widget.tbitem",alternateClassName:"Ext.Toolbar.Item",enable:Ext.emptyFn,disable:Ext.emptyFn,focus:Ext.emptyFn}),Ext.define("Ext.toolbar.Separator",{extend:"Ext.toolbar.Item",alias:"widget.tbseparator",alternateClassName:"Ext.Toolbar.Separator",baseCls:Ext.baseCSSPrefix+"toolbar-separator",focusable:!1}),Ext.define("Ext.layout.container.boxOverflow.Menu",{extend:"Ext.layout.container.boxOverflow.None",requires:["Ext.toolbar.Separator","Ext.button.Button"],alternateClassName:"Ext.layout.boxOverflow.Menu",noItemsMenuText:'<div class="'+Ext.baseCSSPrefix+'toolbar-no-items">(None)</div>',constructor:function(a){var b=this;b.callParent(arguments),b.triggerButtonCls=b.triggerButtonCls||Ext.baseCSSPrefix+"box-menu-"+a.getNames().right,b.menuItems=[]},beginLayout:function(a){this.callParent(arguments),this.clearOverflow(a)},beginLayoutCycle:function(a,b){this.callParent(arguments),b||(this.clearOverflow(a),this.layout.cacheChildItems(a))},onRemove:function(a){Ext.Array.remove(this.menuItems,a)},getSuffixConfig:function(){var a=this,b=a.layout,c=b.owner.id;return a.menu=new Ext.menu.Menu({listeners:{scope:a,beforeshow:a.beforeMenuShow}}),a.menuTrigger=new Ext.button.Button({id:c+"-menu-trigger",cls:Ext.layout.container.Box.prototype.innerCls+" "+a.triggerButtonCls,hidden:!0,ownerCt:b.owner,ownerLayout:b,iconCls:Ext.baseCSSPrefix+a.getOwnerType(b.owner)+"-more-icon",ui:b.owner instanceof Ext.toolbar.Toolbar?"default-toolbar":"default",menu:a.menu,getSplitCls:function(){return""}}),a.menuTrigger.getRenderTree()},getOverflowCls:function(){return Ext.baseCSSPrefix+this.layout.direction+"-box-overflow-body"},handleOverflow:function(a){var b=this,c=b.layout,d=c.getNames(),e="get"+d.widthCap,f=a.state.boxPlan,g=[null,null];return b.showTrigger(a),g[d.heightIndex]=(f.maxSize-b.menuTrigger["get"+d.heightCap]())/2,b.menuTrigger.setPosition.apply(b.menuTrigger,g),{reservedSpace:b.menuTrigger[e]()}},captureChildElements:function(){var a=this.menuTrigger;a.rendering&&a.finishRender()},clearOverflow:function(a){var b=this,c=b.menuItems,d,e=0,f=c.length,g=b.layout.owner;g.suspendLayouts(),b.captureChildElements(),b.hideTrigger(),g.resumeLayouts();for(;e<f;e++)d=c[e],d.suspendLayouts(),d.show(),d.resumeLayouts({isRoot:!0});c.length=0},showTrigger:function(a){var b=this,c=b.layout,d=c.owner,e=c.getNames(),f=e.x,g=e.width,h=a.state.boxPlan,i=h.targetSize[g],j=a.childItems,k=j.length,l=b.menuTrigger,m,n,o,p;l.suspendLayouts(),l.show(),l.resumeLayouts({isRoot:!0}),i-=b.menuTrigger.getWidth(),d.suspendLayouts(),b.menuItems.length=0;for(o=0;o<k;o++)m=j[o],p=m.props,p[f]+p[g]>i&&(n=m.target,b.menuItems.push(n),n.hide());d.resumeLayouts()},hideTrigger:function(){var a=this.menuTrigger;a&&a.hide()},beforeMenuShow:function(a){var b=this,c=b.menuItems,d=0,e=c.length,f,g,h=function(a,b){return a.isXType("buttongroup")&&!(b instanceof Ext.toolbar.Separator)};a.suspendLayouts(),b.clearMenu(),a.removeAll();for(;d<e;d++){f=c[d];if(!d&&f instanceof Ext.toolbar.Separator)continue;g&&(h(f,g)||h(g,f))&&a.add("-"),b.addComponentToMenu(a,f),g=f}a.items.length<1&&a.add(b.noItemsMenuText),a.resumeLayouts()},createMenuConfig:function(a,b){var c=Ext.apply({},a.initialConfig),d=a.toggleGroup;return Ext.copyTo(c,a,["iconCls","icon","itemId","disabled","handler","scope","menu"]),Ext.apply(c,{text:a.overflowText||a.text,hideOnClick:b,destroyMenu:!1}),(d||a.enableToggle)&&Ext.apply(c,{group:d,checked:a.pressed,listeners:{checkchange:function(b,c){a.toggle(c)}}}),delete c.ownerCt,delete c.xtype,delete c.id,c},addComponentToMenu:function(a,b){var c=this,d,e,f;if(b instanceof Ext.toolbar.Separator)a.add("-");else if(b.isComponent)if(b.isXType("splitbutton"))a.add(c.createMenuConfig(b,!0));else if(b.isXType("button"))a.add(c.createMenuConfig(b,!b.menu));else if(b.isXType("buttongroup")){e=b.items.items,f=e.length;for(d=0;d<f;d++)c.addComponentToMenu(a,e[d])}else a.add(Ext.create(Ext.getClassName(b),c.createMenuConfig(b)))},clearMenu:function(){var a=this.moreMenu,b,c,d,e;if(a&&a.items){b=a.items.items,d=b.length;for(c=0;c<d;c++)e=b[c],e.menu&&delete e.menu}},destroy:function(){Ext.destroy(this.menu,this.menuTrigger)}}),Ext.define("Ext.layout.container.Box",{alias:["layout.box"],extend:"Ext.layout.container.Container",alternateClassName:"Ext.layout.BoxLayout",requires:["Ext.layout.container.boxOverflow.None","Ext.layout.container.boxOverflow.Menu","Ext.layout.container.boxOverflow.Scroller","Ext.util.Format","Ext.dd.DragDropManager"],defaultMargins:{top:0,right:0,bottom:0,left:0},padding:0,pack:"start",flex:undefined,stretchMaxPartner:undefined,type:"box",scrollOffset:0,itemCls:Ext.baseCSSPrefix+"box-item",targetCls:Ext.baseCSSPrefix+"box-layout-ct",innerCls:Ext.baseCSSPrefix+"box-inner",availableSpaceOffset:0,reserveOffset:!0,manageMargins:!0,childEls:["innerCt","targetEl"],renderTpl:["{%var oc,l=values.$comp.layout,oh=l.overflowHandler;","if (oh.getPrefixConfig!==Ext.emptyFn) {","if(oc=oh.getPrefixConfig())dh.generateMarkup(oc, out)","}%}",'<div id="{ownerId}-innerCt" class="{[l.innerCls]} {[oh.getOverflowCls()]}" role="presentation">','<div id="{ownerId}-targetEl" style="position:absolute;',"width:20000px;","left:0px;top:0px;",'height:1px">',"{%this.renderBody(out, values)%}","</div>","</div>","{%if (oh.getSuffixConfig!==Ext.emptyFn) {","if(oc=oh.getSuffixConfig())dh.generateMarkup(oc, out)","}%}",{disableFormats:!0,definitions:"var dh=Ext.DomHelper;"}],constructor:function(a){var b=this,c;b.callParent(arguments),b.flexSortFn=Ext.Function.bind(b.flexSort,b),b.initOverflowHandler(),c=typeof b.padding;if(c=="string"||c=="number")b.padding=Ext.util.Format.parseBox(b.padding),b.padding.height=b.padding.top+b.padding.bottom,b.padding.width=b.padding.left+b.padding.right},getNames:function(){return this.names},getItemSizePolicy:function(a,b){var c=this,d=c.sizePolicy,e=c.align,f=e,g;return e==="stretch"?(g=(b||c.owner.getSizeModel())[c.names.height],g.shrinkWrap&&(f="stretchmax")):e!=="stretchmax"&&(f=""),a.flex&&(d=d.flex),d[f]},flexSort:function(a,b){var c=this.getNames().maxWidth,d=Infinity;return a=a.target[c]||d,b=b.target[c]||d,!isFinite(a)&&!isFinite(b)?0:a-b},isItemBoxParent:function(a){return!0},isItemShrinkWrap:function(a){return!0},minSizeSortFn:function(a,b){return b.available-a.available},roundFlex:function(a){return Math.ceil(a)},beginCollapse:function(a){var b=this;b.direction==="vertical"&&a.collapsedVertical()?(a.collapseMemento.capture(["flex"]),delete a.flex):b.direction==="horizontal"&&a.collapsedHorizontal()&&(a.collapseMemento.capture(["flex"]),delete a.flex)},beginExpand:function(a){a.collapseMemento.restore(["flex"])},beginLayout:function(a){var b=this,c=b.owner.stretchMaxPartner,d=b.innerCt.dom.style,e=b.getNames();b.overflowHandler.beginLayout(a),typeof c=="string"&&(c=Ext.getCmp(c)||b.owner.query(c)[0]),a.stretchMaxPartner=c&&a.context.getCmp(c),b.callParent(arguments),a.innerCtContext=a.getEl("innerCt",b),b.scrollParallel=!!b.owner.autoScroll||!!b.owner[e.overflowX],b.scrollPerpendicular=!!b.owner.autoScroll||!!b.owner[e.overflowY],b.scrollParallel&&(b.scrollPos=b.owner.getTargetEl().dom[e.scrollLeft]),d.width="",d.height="",b.cacheFlexes(a)},beginLayoutCycle:function(a,b){var c=this,d=c.align,e=c.getNames(),f=c.pack,g=e.heightModel,h,i,j,k,l;c.overflowHandler.beginLayoutCycle(a,b),c.callParent(arguments),a.parallelSizeModel=a[e.widthModel],a.perpendicularSizeModel=a[g],a.boxOptions={align:d={stretch:d=="stretch",stretchmax:d=="stretchmax",center:d==e.center},pack:f={center:f=="center",end:f=="end"}},d.stretch&&a.perpendicularSizeModel.shrinkWrap&&(d.stretchmax=!0,d.stretch=!1),a.parallelSizeModel.shrinkWrap&&(f.center=f.end=!1);if(d.stretchmax){h=a.childItems,k=h.length,l=c.sizeModels.shrinkWrap;for(j=0;j<k;++j)i=h[j],i[g].configured||(i[g]=l)}},cacheFlexes:function(a){var b=this.getNames(),c=b.widthModel,d=0,e=a.childItems,f=e.length,g=[],h=0,i=b.minWidth,j,k,l;while(f--)k=e[f],k[c].calculated&&(j=k.target,k.flex=l=j.flex,l&&(d+=l,g.push(k),h+=j[i]||0));a.flexedItems=g,a.flexedMinSize=h,a.totalFlex=d,Ext.Array.sort(g,this.flexSortFn)},calculate:function(a){var b=this,c=b.getContainerSize(a),d=b.getNames(),e=a.state,f=e.boxPlan||(e.boxPlan={}),g=Ext.getScrollbarSize()[d.width];f.targetSize=c;if(g&&b.scrollPerpendicular&&a.parallelSizeModel.shrinkWrap&&!a.boxOptions.align.stretch&&!a.perpendicularSizeModel.shrinkWrap){e.additionalScrollbarWidth=g;if(!c[d.gotHeight]){b.done=!1;return}}else e.additionalScrollbarWidth=0;if(!a.parallelSizeModel.shrinkWrap&&!c[d.gotWidth]){b.done=!1;return}e.parallelDone||(e.parallelDone=b.calculateParallel(a,d,f)),e.perpendicularDone||(e.perpendicularDone=b.calculatePerpendicular(a,d,f)),e.parallelDone&&e.perpendicularDone?(b.owner.dock&&(Ext.isIE6||Ext.isIE7||Ext.isIEQuirks)&&!b.owner.width&&!b.horizontal&&(f.isIEVerticalDock=!0,f.calculatedWidth=f.maxSize+a.getPaddingInfo().width+a.getFrameInfo().width),b.publishInnerCtSize(a,b.reserveOffset?b.availableSpaceOffset:0),b.done&&a.childItems.length>1&&a.boxOptions.align.stretchmax&&!e.stretchMaxDone&&(b.calculateStretchMax(a,d,f),e.stretchMaxDone=!0)):b.done=!1},calculateParallel:function(a,b,c){var d=this,e=a.parallelSizeModel.shrinkWrap,f=b.width,g=a.childItems,h=b.left,i=b.right,j=b.setWidth,k=g.length,l=a.flexedItems,m=l.length,n=a.boxOptions.pack,o=d.padding,p=o[h],q=p+o[i]+d.scrollOffset+(d.reserveOffset?d.availableSpaceOffset:0),r,s,t,u,v,w,x,y;for(r=0;r<k;++r){v=g[r],s=v.marginInfo||v.getMarginInfo(),q+=s[f];if(!v.flex){q+=v.getProp(f);if(isNaN(q))return!1}}if(e)c.availableSpace=0,c.tooNarrow=!1;else{c.availableSpace=c.targetSize[f]-q,c.tooNarrow=c.availableSpace<a.flexedMinSize;if(c.tooNarrow&&Ext.getScrollbarSize()[b.height]&&d.scrollParallel&&a.state.perpendicularDone){a.state.perpendicularDone=!1;for(r=0;r<k;++r)g[r].invalidate()}}y=q,t=c.availableSpace,u=a.totalFlex;for(r=0;r<m;r++)v=l[r],w=v.flex,x=d.roundFlex(w/u*t),x=v[j](x),y+=x,t=Math.max(0,t-x),u-=w;n.center?(p+=t/2,p<0&&(p=0)):n.end&&(p+=t);for(r=0;r<k;++r)v=g[r],s=v.marginInfo,p+=s[h],v.setProp(b.x,p),p+=s[i]+v.props[f];return a.state.contentWidth=y+a.targetContext.getPaddingInfo()[f],a.state.additionalScrollbarWidth||a[b.setContentWidth](a.state.contentWidth),!0},calculatePerpendicular:function(a,b,c){var d=this,e=a.perpendicularSizeModel.shrinkWrap,f=c.targetSize,g=a.childItems,h=g.length,i=Math.max,j=b.height,k=b.setHeight,l=b.top,m=b.y,n=d.padding,o=n[l],p=f[j]-o-n[b.bottom],q=a.boxOptions.align,r=q.stretch,s=q.stretchmax,t=q.center,u=0,v,w,x,y,z,A,B,C,D,E;if(r||t&&!e)if(isNaN(p))return!1;r&&d.scrollParallel&&c.tooNarrow&&(D=Ext.getScrollbarSize().height,p-=D,c.targetSize[j]-=D);if(r)A=p;else{for(w=0;w<h;w++){B=g[w],y=B.marginInfo||B.getMarginInfo(),x=B.getProp(j);if(isNaN(u=i(u,x+y[j],B.target[b.minHeight]||0)))return!1}C=a.stretchMaxPartner;if(C){a.setProp("maxChildHeight",u),E=C.childItems;if(E&&E.length){u=i(u,C.getProp("maxChildHeight"));if(isNaN(u))return!1}}c.maxSize=u,a[b.setContentHeight](u+d.padding[j]+a.targetContext.getPaddingInfo()[j]),s?A=u:t&&(A=e?u:i(p,u),A-=a.innerCtContext.getBorderInfo()[j])}for(w=0;w<h;w++)B=g[w],y=B.marginInfo||B.getMarginInfo(),v=o+y[l],r?B[k](A-y[j]):t&&(z=A-B.props[j],z>0&&(v=o+Math.round(z/2))),B.setProp(m,v);return!0},calculateStretchMax:function(a,b,c){var d=this,e=b.height,f=b.width,g=a.childItems,h=g.length,i=c.maxSize,j=d.onBeforeInvalidateChild,k=d.onAfterInvalidateChild,l,m,n,o;for(n=0;n<h;++n)l=g[n],m=l.props,o=i-l.getMarginInfo()[e],(o!=m[e]||l[b.heightModel].constrained)&&l.invalidate({before:j,after:k,layout:d,childWidth:m[f],childHeight:o,childX:m.x,childY:m.y,names:b})},completeLayout:function(a){var b=this;b.overflowHandler.completeLayout(a),b.scrollParallel&&(b.owner.getTargetEl().dom[b.getNames().scrollLeft]=b.scrollPos)},finishedLayout:function(a){this.overflowHandler.finishedLayout(a),this.callParent(arguments)},onBeforeInvalidateChild:function(a,b){var c=b.names.heightModel;a[c].constrainedMax||(a[c]=Ext.layout.SizeModel.calculated)},onAfterInvalidateChild:function(a,b){var c=b.names;a.setProp("x",b.childX),a.setProp("y",b.childY),a[c.heightModel].calculated&&a[c.setHeight](b.childHeight),a[c.widthModel].calculated&&a[c.setWidth](b.childWidth)},publishInnerCtSize:function(a,b){var c=this,d=c.getNames(),e=d.height,f=d.width,g=a.boxOptions.align,h=c.owner.dock,i=c.padding,j=a.state.boxPlan,k=j.targetSize,l=k[e],m=a.innerCtContext,n=d.contentWidth,o=(a.parallelSizeModel.shrinkWrap||j.tooNarrow&&c.scrollParallel?a.state.contentWidth:k[f])-(b||0),p;g.stretch?p=l:(p=j.maxSize+i[d.top]+i[d.bottom]+m.getBorderInfo()[e],!a.perpendicularSizeModel.shrinkWrap&&g.center&&(p=Math.max(l,p))),m[d.setWidth](o),m[d.setHeight](p),a.state.additionalScrollbarWidth&&(p>j.targetSize[d.height]?(a.setProp(n,a.state.contentWidth+a.state.additionalScrollbarWidth),(Ext.isIE6||Ext.isIE7||Ext.isIEQuirks)&&a[d.setWidth](a.props[n]+a.getPaddingInfo()[d.width]+a.getBorderInfo()[d.width])):a.setProp(n,a.state.contentWidth)),isNaN(o+p)&&(c.done=!1),j.calculatedWidth&&(h=="left"||h=="right")&&a.setWidth(j.calculatedWidth,!0,!0)},onRemove:function(a){var b=this;b.callParent(arguments),b.overflowHandler&&b.overflowHandler.onRemove(a),a.layoutMarginCap==b.id&&delete a.layoutMarginCap},initOverflowHandler:function(){var a=this,b=a.overflowHandler,c,d;typeof b=="string"&&(b={type:b}),c="None",b&&b.type!==undefined&&(c=b.type),d=Ext.layout.container.boxOverflow[c],d[a.type]&&(d=d[a.type]),a.overflowHandler=Ext.create("Ext.layout.container.boxOverflow."+c,a,b)},getRenderTarget:function(){return this.targetEl},getElementTarget:function(){return this.innerCt},destroy:function(){Ext.destroy(this.innerCt,this.overflowHandler),this.callParent(arguments)}}),Ext.define("Ext.layout.container.HBox",{alias:["layout.hbox"],extend:"Ext.layout.container.Box",alternateClassName:"Ext.layout.HBoxLayout",align:"top",type:"hbox",direction:"horizontal",horizontal:!0,names:{lr:"lr",left:"left",leftCap:"Left",right:"right",position:"left",width:"width",contentWidth:"contentWidth",minWidth:"minWidth",maxWidth:"maxWidth",widthCap:"Width",widthModel:"widthModel",widthIndex:0,x:"x",scrollLeft:"scrollLeft",overflowX:"overflowX",center:"middle",top:"top",topPosition:"top",bottom:"bottom",height:"height",contentHeight:"contentHeight",minHeight:"minHeight",maxHeight:"maxHeight",heightCap:"Height",heightModel:"heightModel",heightIndex:1,y:"y",scrollTop:"scrollTop",overflowY:"overflowY",getWidth:"getWidth",getHeight:"getHeight",setWidth:"setWidth",setHeight:"setHeight",gotWidth:"gotWidth",gotHeight:"gotHeight",setContentWidth:"setContentWidth",setContentHeight:"setContentHeight"},sizePolicy:{flex:{"":{setsWidth:1,setsHeight:0},stretch:{setsWidth:1,setsHeight:1},stretchmax:{readsHeight:1,setsWidth:1,setsHeight:1}},"":{setsWidth:0,setsHeight:0},stretch:{setsWidth:0,setsHeight:1},stretchmax:{readsHeight:1,setsWidth:0,setsHeight:1}}}),Ext.define("Ext.grid.ColumnLayout",{extend:"Ext.layout.container.HBox",alias:"layout.gridcolumn",type:"gridcolumn",reserveOffset:!1,firstHeaderCls:Ext.baseCSSPrefix+"column-header-first",lastHeaderCls:Ext.baseCSSPrefix+"column-header-last",beginLayout:function(a){var b=this,c=b.owner,d=c.up("[scrollerOwner]"),e=d.view,f=0,g=b.getVisibleItems(),h=g.length,i;d.lockable&&(b.owner.up("tablepanel")===e.normalGrid?e=e.normalGrid.getView():e=null),b.callParent(arguments);for(;f<h;f++)i=g[f],i.removeCls([b.firstHeaderCls,b.lastHeaderCls]),i.el.setStyle({height:"auto"}),i.titleEl.setStyle({height:"auto",paddingTop:""});h>0&&(g[0].addCls(b.firstHeaderCls),g[h-1].addCls(b.lastHeaderCls)),!b.owner.isHeader&&Ext.getScrollbarSize().width&&!d.collapsed&&e&&e.rendered&&(a.viewTable=e.el.child("table",!0))&&(a.viewContext=a.context.getCmp(e))},roundFlex:function(a){return Math.floor(a)},getContainerSize:function(a){var b=this,c=b.callParent(arguments),d=a.viewContext,e;return d&&!d.heightModel.shrinkWrap&&d.target.componentLayout.ownerContext&&(e=d.getProp("height"),isNaN(e)?b.done=!1:a.state.tableHeight>e&&(c.width-=Ext.getScrollbarSize().width,a.state.parallelDone=!1,d.invalidate())),c},calculate:function(a){var b=this,c=a.viewContext;c&&!a.state.tableHeight&&(a.state.tableHeight=a.viewTable.offsetHeight),b.callParent(arguments)},completeLayout:function(a){var b=this,c=b.owner,d=a.state,e=!1,f=b.sizeModels.calculated,g,h,i,j,k;b.callParent(arguments);if(!d.flexesCalculated&&c.forceFit&&!c.isHeader){g=a.childItems,h=g.length;for(i=0;i<h;i++)j=g[i],k=j.target,k.width&&(k.flex=a.childItems[i].flex=k.width,delete k.width,j.widthModel=f,e=!0);e&&(b.cacheFlexes(a),a.invalidate({state:{flexesCalculated:!0}}))}},finalizeLayout:function(){var a=this,b=0,c,d,e,f=a.owner,g=f.titleEl;c=a.getVisibleItems(),d=c.length,e=f.el.getViewSize().height,g&&(e-=g.getHeight());for(;b<d;b++)c[b].setPadding(e)},publishInnerCtSize:function(a){var b=this,c=a.state.boxPlan,d=c.targetSize,e=a.peek("contentWidth");return e!=null&&!b.owner.isHeader&&(d.width=e+Ext.getScrollbarSize().width),b.callParent(arguments)}}),Ext.define("Ext.grid.header.Container",{extend:"Ext.container.Container",requires:["Ext.grid.ColumnLayout","Ext.grid.plugin.HeaderResizer","Ext.grid.plugin.HeaderReorderer"],uses:["Ext.grid.column.Column","Ext.menu.Menu","Ext.menu.CheckItem","Ext.menu.Separator"],border:!0,alias:"widget.headercontainer",baseCls:Ext.baseCSSPrefix+"grid-header-ct",dock:"top",weight:100,defaultType:"gridcolumn",detachOnRemove:!1,defaultWidth:100,sortAscText:"Sort Ascending",sortDescText:"Sort Descending",sortClearText:"Clear Sort",columnsText:"Columns",headerOpenCls:Ext.baseCSSPrefix+"column-header-open",triStateSort:!1,ddLock:!1,dragging:!1,sortable:!0,initComponent:function(){var a=this;a.headerCounter=0,a.plugins=a.plugins||[],a.isHeader||(a.enableColumnResize&&(a.resizer=new Ext.grid.plugin.HeaderResizer,a.plugins.push(a.resizer)),a.enableColumnMove&&(a.reorderer=new Ext.grid.plugin.HeaderReorderer,a.plugins.push(a.reorderer))),a.isHeader&&!a.items?a.layout=a.layout||"auto":a.layout=Ext.apply({type:"gridcolumn",align:"stretchmax"},a.initialConfig.layout),a.defaults=a.defaults||{},Ext.applyIf(a.defaults,{triStateSort:a.triStateSort,sortable:a.sortable}),a.menuTask=new Ext.util.DelayedTask(a.updateMenuDisabledState,a),a.callParent(),a.addEvents("columnresize","headerclick","headertriggerclick","columnmove","columnhide","columnshow","sortchange","menucreate")},onDestroy:function(){var a=this;a.menuTask.cancel(),Ext.destroy(a.resizer,a.reorderer),a.callParent()},applyColumnsState:function(a){if(!a||!a.length)return;var b=this,c=b.items.items,d=c.length,e=0,f=a.length,g,h,i,j;for(g=0;g<f;g++){i=a[g];for(j=d;j--;){h=c[j];if(h.getStateId&&h.getStateId()==i.id){e!==j&&b.moveHeader(j,e),h.applyColumnState&&h.applyColumnState(i),++e;break}}}},getColumnsState:function(){var a=this,b=[],c;return a.items.each(function(a){c=a.getColumnState&&a.getColumnState(),c&&b.push(c)}),b},onAdd:function(a){var b=this;a.headerId||(a.headerId=a.initialConfig.id||Ext.id(null,"header-")),a.stateId||(a.stateId=a.initialConfig.id||"h"+ ++b.headerCounter),b.callParent(arguments),b.purgeCache()},onRemove:function(a){var b=this;b.callParent(arguments),b.purgeCache()},applyDefaults:function(a){var b;return a&&!a.isComponent&&a.xtype=="rownumberer"?b=a:(b=this.callParent(arguments),!("width"in b)&&!b.flex&&(b.width=this.defaultWidth)),b},afterRender:function(){this.callParent(),this.setSortState()},setSortState:function(){var a=this.up("[store]").store,b=a.sorters,c=b.first(),d;c&&(d=this.down("gridcolumn[dataIndex="+c.property+"]"),d&&d.setSortState(c.direction,!1,!0))},getHeaderMenu:function(){var a=this.getMenu(),b;if(a){b=a.child("#columnItem");if(b)return b.menu}return null},onHeaderVisibilityChange:function(a,b){var c=this,d=c.getHeaderMenu(),e;d&&(e=c.getMenuItemForHeader(d,a),e&&e.setChecked(b,!0),c.menuTask.delay(50))},getLeafMenuItems:function(){var a=this,b=a.getGridColumns(),c=[],d=0,e=0,f=b.length,g=a.getMenu(),h;for(;d<f;++d)h=b[d],h.hideable&&(h=a.getMenuItemForHeader(g,h),h&&(c.push(h),h.checked&&++e));return{items:c,checkedCount:e}},updateMenuDisabledState:function(){var a=this,b=a.getLeafMenuItems(),c=b.checkedCount,d=b.items,e=d.length,f=0,g=a.getMenu().child("#columnItem");if(c<=1)a.disableMenuItems(g,Ext.ComponentQuery.query("[checked=true]",d)[0]);else for(;f<e;++f)a.setMenuItemState(c,g,d[f])},disableMenuItems:function(a,b){while(b&&b!=a)b.disableCheckChange(),b=b.parentMenu.ownerItem},setMenuItemState:function(a,b,c){var d,e;while(c&&c!=b){d=c.parentMenu,e=c.parentMenu.query("[checked=true]:not([menu])").length,c.enableCheckChange(),c=d.ownerItem;if(e===a)break}this.disableMenuItems(b,c)},getMenuItemForHeader:function(a,b){return b?a.down("menucheckitem[headerId="+b.id+"]"):null},onHeaderShow:function(a){var b=this,c=b.ownerCt;b.onHeaderVisibilityChange(a,!0),a.isGroupHeader||(b.view&&b.view.onHeaderShow(b,a,!0),c&&c.onHeaderShow(b,a)),b.fireEvent("columnshow",b,a),b.updateLayout()},onHeaderHide:function(a){var b=this,c=b.ownerCt;b.onHeaderVisibilityChange(a,!1),a.isGroupHeader||(b.view&&(b.view.ignoreTemplate=!0,b.view.onHeaderHide(b,a,!0),b.view.ignoreTemplate=!1),c&&c.onHeaderHide(b,a),b.updateLayout()),b.fireEvent("columnhide",b,a)},tempLock:function(){this.ddLock=!0,Ext.Function.defer(function(){this.ddLock=!1},200,this)},onHeaderResize:function(a,b,c){var d=this,e=d.view,f=d.ownerCt,g;e&&(g=e.el)&&g.dom.firstChild&&(d.tempLock(),e.onHeaderResize(a,b,c),f&&f.onHeaderResize(d,a,b)),d.fireEvent("columnresize",this,a,b)},onHeaderClick:function(a,b,c){a.fireEvent("headerclick",this,a,b,c),this.fireEvent("headerclick",this,a,b,c)},onHeaderTriggerClick:function(a,b,c){var d=this;a.fireEvent("headertriggerclick",d,a,b,c)!==!1&&d.fireEvent("headertriggerclick",d,a,b,c)!==!1&&d.showMenuBy(c,a)},showMenuBy:function(a,b){var c=this.getMenu(),d=c.down("#ascItem"),e=c.down("#descItem"),f;c.activeHeader=c.ownerCt=b,c.setFloatParent(b),b.titleEl.addCls(this.headerOpenCls),f=b.sortable?"enable":"disable",d&&d[f](),e&&e[f](),c.showBy(a)},onMenuDeactivate:function(){var a=this.getMenu();a.activeHeader.titleEl.removeCls(this.headerOpenCls)},moveHeader:function(a,b){this.tempLock(),this.onHeaderMoved(this.move(a,b),a,b)},purgeCache:function(){var a=this;delete a.gridDataColumns,delete a.hideableColumns,a.menu&&(a.menu.hide(),a.menu.destroy(),delete a.menu)},onHeaderMoved:function(a,b,c,d){var e=this,f=e.ownerCt;f&&f.onHeaderMove&&f.onHeaderMove(e,a,b,c,d),e.fireEvent("columnmove",e,a,c,d)},getMenu:function(){var a=this;return a.menu||(a.menu=new Ext.menu.Menu({hideOnParentHide:!1,items:a.getMenuItems(),listeners:{deactivate:a.onMenuDeactivate,scope:a}}),a.updateMenuDisabledState(),a.fireEvent("menucreate",a,a.menu)),a.menu},getMenuItems:function(){var a=this,b=[],c=a.enableColumnHide?a.getColumnMenu(a):null;return a.sortable&&(b=[{itemId:"ascItem",text:a.sortAscText,cls:Ext.baseCSSPrefix+"hmenu-sort-asc",handler:a.onSortAscClick,scope:a},{itemId:"descItem",text:a.sortDescText,cls:Ext.baseCSSPrefix+"hmenu-sort-desc",handler:a.onSortDescClick,scope:a}]),c&&c.length&&b.push("-",{itemId:"columnItem",text:a.columnsText,cls:Ext.baseCSSPrefix+"cols-icon",menu:c}),b},onSortAscClick:function(){var a=this.getMenu(),b=a.activeHeader;b.setSortState("ASC")},onSortDescClick:function(){var a=this.getMenu(),b=a.activeHeader;b.setSortState("DESC")},getColumnMenu:function(a){var b=[],c=0,d,e=a.query(">gridcolumn[hideable]"),f=e.length,g;for(;c<f;c++)d=e[c],g=new Ext.menu.CheckItem({text:d.menuText||d.text,checked:!d.hidden,hideOnClick:!1,headerId:d.id,menu:d.isGroupHeader?this.getColumnMenu(d):undefined,checkHandler:this.onColumnCheckChange,scope:this}),b.push(g),d.on({destroy:Ext.Function.bind(g.destroy,g)});return b},onColumnCheckChange:function(a,b){var c=Ext.getCmp(a.headerId);c[b?"show":"hide"]()},getColumnsForTpl:function(a){var b=[],c=this.getGridColumns(a),d=c.length,e=0,f,g;for(;e<d;e++)f=c[e],f.hidden||f.up("headercontainer[hidden=true]")?g=0:g=f.getDesiredWidth(),b.push({dataIndex:f.dataIndex,align:f.align,width:g,id:f.id,cls:f.tdCls,columnId:f.getItemId()});return b},getColumnCount:function(){return this.getGridColumns().length},getFullWidth:function(a){var b=0,c=this.getVisibleGridColumns(a),d=c.length,e=0,f;for(;e<d;e++)f=c[e],f.getDesiredWidth?b+=f.getDesiredWidth()||0:b+=f.getWidth();return b},clearOtherSortStates:function(a){var b=this.getGridColumns(),c=b.length,d=0;for(;d<c;d++)b[d]!==a&&b[d].setSortState(null,!0)},getVisibleGridColumns:function(a){return Ext.ComponentQuery.query(":not([hidden])",this.getGridColumns(a))},getGridColumns:function(a){var b=this,c=a?null:b.gridDataColumns;return c||(b.gridDataColumns=c=[],b.cascade(function(a){a!==b&&!a.isGroupHeader&&c.push(a)})),c},getHideableColumns:function(a){var b=this,c=a?null:b.hideableColumns;return c||(c=b.hideableColumns=b.query("[hideable]")),c},getHeaderIndex:function(a){return a.isGroupHeader&&(a=a.down(":not([isgroupHeader])")),Ext.Array.indexOf(this.getGridColumns(),a)},getHeaderAtIndex:function(a){var b=this.getGridColumns();return b.length?b[a]:null},getVisibleHeaderClosestToIndex:function(a){var b=this.getHeaderAtIndex(a);return b&&b.hidden&&(b=b.next(":not([hidden])")||b.next(":not([hidden])")),b},prepareData:function(a,b,c,d,e){var f=this,g={},h=f.gridDataColumns||f.getGridColumns(),i=h.length,j=0,k,l,m,n,o,p=e.store;for(;j<i;j++){o={tdCls:"",style:""},k=h[j],l=k.id,m=k.renderer,n=a[k.dataIndex],typeof m=="function"&&(n=m.call(k.scope||f.ownerCt,n,o,c,b,j,p,d)),f.markDirty&&(g[l+"-modified"]=c.isModified(k.dataIndex)?Ext.baseCSSPrefix+"grid-dirty-cell":""),g[l+"-tdCls"]=o.tdCls,g[l+"-tdAttr"]=o.tdAttr,g[l+"-style"]=o.style;if(typeof n=="undefined"||n===null||n==="")n=k.emptyCellText;g[l]=n}return g},expandToFit:function(a){var b=this.view;b&&b.expandToFit(a)}}),Ext.define("Ext.grid.column.Column",{extend:"Ext.grid.header.Container",alias:"widget.gridcolumn",requires:["Ext.util.KeyNav","Ext.grid.ColumnComponentLayout","Ext.grid.ColumnLayout"],alternateClassName:"Ext.grid.Column",baseCls:Ext.baseCSSPrefix+"column-header "+Ext.baseCSSPrefix+"unselectable",hoverCls:Ext.baseCSSPrefix+"column-header-over",handleWidth:5,sortState:null,possibleSortStates:["ASC","DESC"],childEls:["titleEl","triggerEl","textEl"],renderTpl:'<div id="{id}-titleEl" class="'+Ext.baseCSSPrefix+'column-header-inner"><span id="{id}-textEl" class="'+Ext.baseCSSPrefix+'column-header-text">{text}</span><tpl if="!menuDisabled"><div id="{id}-triggerEl" class="'+Ext.baseCSSPrefix+'column-header-trigger"></div></tpl></div>{%this.renderContainer(out,values)%}',dataIndex:null,text:"&#160;",menuText:null,emptyCellText:"&#160;",sortable:!0,resizable:!0,hideable:!0,menuDisabled:!1,renderer:!1,editRenderer:!1,align:"left",draggable:!0,initDraggable:Ext.emptyFn,isHeader:!0,componentLayout:"columncomponent",initResizable:Ext.emptyFn,initComponent:function(){var a=this,b;Ext.isDefined(a.header)&&(a.text=a.header,delete a.header),a.triStateSort||(a.possibleSortStates.length=2),Ext.isDefined(a.columns)?(a.isGroupHeader=!0,a.items=a.columns,delete a.columns,delete a.flex,delete a.width,a.cls=(a.cls||"")+" "+Ext.baseCSSPrefix+"group-header",a.sortable=!1,a.resizable=!1,a.align="center"):(a.isContainer=!1,a.flex&&(a.minWidth=a.minWidth||Ext.grid.plugin.HeaderResizer.prototype.minColWidth)),a.addCls(Ext.baseCSSPrefix+"column-header-align-"+a.align),b=a.renderer,b?(typeof b=="string"&&(a.renderer=Ext.util.Format[b]),a.hasCustomRenderer=!0):a.defaultRenderer&&(a.scope=a,a.renderer=a.defaultRenderer),a.callParent(arguments),a.on({element:"el",click:a.onElClick,dblclick:a.onElDblClick,scope:a}),a.on({element:"titleEl",mouseenter:a.onTitleMouseOver,mouseleave:a.onTitleMouseOut,scope:a})},onAdd:function(a){a.isSubHeader=!0,a.addCls(Ext.baseCSSPrefix+"group-sub-header"),this.callParent(arguments)},onRemove:function(a){a.isSubHeader=!1,a.removeCls(Ext.baseCSSPrefix+"group-sub-header"),this.callParent(arguments)},initRenderData:function(){var a=this;return Ext.applyIf(a.callParent(arguments),{text:a.text,menuDisabled:a.menuDisabled})},applyColumnState:function(a){var b=this,c=Ext.isDefined;b.applyColumnsState(a.columns),c(a.hidden)&&(b.hidden=a.hidden),c(a.locked)&&(b.locked=a.locked),c(a.sortable)&&(b.sortable=a.sortable),c(a.width)?(delete b.flex,b.width=a.width):c(a.flex)&&(delete b.width,b.flex=a.flex)},getColumnState:function(){var a=this,b=a.items.items,c=b?b.length:0,d,e=[],f={id:a.getStateId()};a.savePropsToState(["hidden","sortable","locked","flex","width"],f);if(a.isGroupHeader){for(d=0;d<c;d++)e.push(b[d].getColumnState());e.length&&(f.columns=e)}else a.isSubHeader&&a.ownerCt.hidden&&delete a.hidden;return"width"in f&&delete f.flex,f},getStateId:function(){return this.stateId||this.headerId},setText:function(a){this.text=a,this.rendered&&this.textEl.update(a)},getOwnerHeaderCt:function(){return this.up(":not([isHeader])")},getIndex:function(){return this.isGroupColumn?!1:this.getOwnerHeaderCt().getHeaderIndex(this)},getVisibleIndex:function(){return this.isGroupColumn?!1:Ext.Array.indexOf(this.getOwnerHeaderCt().getVisibleGridColumns(),this)},beforeRender:function(){var a=this,b=a.up("tablepanel");a.callParent(),b&&(!a.sortable||b.sortableColumns===!1)&&!a.groupable&&!a.lockable&&(b.enableColumnHide===!1||!a.getOwnerHeaderCt().getHideableColumns().length)&&(a.menuDisabled=!0)},afterRender:function(){var a=this,b=a.el;a.callParent(arguments),a.overCls&&b.addClsOnOver(a.overCls),(!Ext.isIE8||!Ext.isStrict)&&a.mon(a.getFocusEl(),{focus:a.onTitleMouseOver,blur:a.onTitleMouseOut,scope:a}),a.keyNav=new Ext.util.KeyNav(b,{enter:a.onEnterKey,down:a.onDownKey,scope:a})},afterComponentLayout:function(a,b,c,d){var e=this,f=e.getOwnerHeaderCt();e.callParent(arguments),f&&(c!=null||e.flex)&&a!==c&&f.onHeaderResize(e,a,!0),delete e.oldWidth},setPadding:function(a){var b=this,c=parseInt(b.textEl.getStyle("line-height"),10),d=b.textEl.dom.offsetHeight,e=b.titleEl,f=a-b.el.getBorderWidth("tb"),g;b.isGroupHeader||e.getHeight()<f&&(e.setHeight(f),b.ownerCt.layout.innerCt.setHeight(a)),g=e.getViewSize().height,d&&(c&&(d=Math.ceil(d/c)*c),e.setStyle({paddingTop:Math.floor(Math.max((g-d)/2,0))+"px"})),Ext.isIE&&b.triggerEl&&b.triggerEl.setHeight(g)},onDestroy:function(){var a=this;Ext.destroy(a.textEl,a.keyNav),delete a.keyNav,a.callParent(arguments)},onTitleMouseOver:function(){this.titleEl.addCls(this.hoverCls)},onTitleMouseOut:function(){this.titleEl.removeCls(this.hoverCls)},onDownKey:function(a){this.triggerEl&&this.onElClick(a,this.triggerEl.dom||this.el.dom)},onEnterKey:function(a){this.onElClick(a,this.el.dom)},onElDblClick:function(a,b){var c=this,d=c.ownerCt;d&&Ext.Array.indexOf(d.items,c)!==0&&c.isOnLeftEdge(a)&&d.expandToFit(c.previousSibling("gridcolumn"))},onElClick:function(a,b){var c=this,d=c.getOwnerHeaderCt();if(d&&!d.ddLock)if(c.triggerEl&&(a.target===c.triggerEl.dom||b===c.triggerEl.dom||a.within(c.triggerEl)))d.onHeaderTriggerClick(c,a,b);else if(a.getKey()||!c.isOnLeftEdge(a)&&!c.isOnRightEdge(a))c.toggleSortState(),d.onHeaderClick(c,a,b)},processEvent:function(a,b,c,d,e,f){return this.fireEvent.apply(this,arguments)},toggleSortState:function(){var a=this,b,c;a.sortable&&(b=Ext.Array.indexOf(a.possibleSortStates,a.sortState),c=(b+1)%a.possibleSortStates.length,a.setSortState(a.possibleSortStates[c]))},doSort:function(a){var b=this.up("tablepanel").store;b.sort({property:this.getSortParam(),direction:a})},getSortParam:function(){return this.dataIndex},setSortState:function(a,b,c){var d=this,e=Ext.baseCSSPrefix+"column-header-sort-",f=e+"ASC",g=e+"DESC",h=e+"null",i=d.getOwnerHeaderCt(),j=d.sortState;if(j!==a&&d.getSortParam()){d.addCls(e+a),a&&!c&&d.doSort(a);switch(a){case"DESC":d.removeCls([f,h]);break;case"ASC":d.removeCls([g,h]);break;case null:d.removeCls([f,g])}i&&!d.triStateSort&&!b&&i.clearOtherSortStates(d),d.sortState=a,(d.triStateSort||a!=null)&&i.fireEvent("sortchange",i,d,a)}},hide:function(a){var b=this,c=b.getOwnerHeaderCt(),d=b.ownerCt,e=d.isGroupHeader,f,g,h,i;if(e&&!a){g=d.query(">:not([hidden])");if(g.length===1&&g[0]==b){b.ownerCt.hide();return}}Ext.suspendLayouts();if(b.isGroupHeader){g=b.items.items;for(i=0,h=g.length;i<h;i++)f=g[i],f.hidden||f.hide(!0)}b.callParent(),c.onHeaderHide(b),Ext.resumeLayouts(!0)},show:function(a,b){var c=this,d=c.ownerCt,e,f,g,h;Ext.suspendLayouts(),c.isSubHeader&&d.hidden&&d.show(!1,!0),c.callParent(arguments);if(c.isGroupHeader&&b!==!0&&!c.query(":not([hidden])").length){e=c.query(">*");for(g=0,f=e.length;g<f;g++)h=e[g],h.hidden&&h.show(!0)}Ext.resumeLayouts(!0),d=c.getOwnerHeaderCt(),d&&d.onHeaderShow(c)},getDesiredWidth:function(){var a=this;return a.rendered&&a.componentLayout&&a.componentLayout.lastComponentSize?a.componentLayout.lastComponentSize.width:a.flex?a.width:a.width},getCellSelector:function(){return"."+Ext.baseCSSPrefix+"grid-cell-"+this.getItemId()},getCellInnerSelector:function(){return this.getCellSelector()+" ."+Ext.baseCSSPrefix+"grid-cell-inner"},isOnLeftEdge:function(a){return a.getXY()[0]-this.el.getLeft()<=this.handleWidth},isOnRightEdge:function(a){return this.el.getRight()-a.getXY()[0]<=this.handleWidth}}),Ext.define("Ext.grid.RowNumberer",{extend:"Ext.grid.column.Column",alias:"widget.rownumberer",text:"&#160",width:23,sortable:!1,draggable:!1,align:"right",constructor:function(a){this.width=this.width,this.callParent(arguments),this.rowspan&&(this.renderer=Ext.Function.bind(this.renderer,this))},resizable:!1,hideable:!1,menuDisabled:!0,dataIndex:"",cls:Ext.baseCSSPrefix+"row-numberer",rowspan:undefined,renderer:function(a,b,c,d,e,f){return this.rowspan&&(b.cellAttr='rowspan="'+this.rowspan+'"'),b.tdCls=Ext.baseCSSPrefix+"grid-cell-special",f.indexOfTotal(c)+1}}),Ext.define("Ext.grid.column.Action",{extend:"Ext.grid.column.Column",alias:["widget.actioncolumn"],alternateClassName:"Ext.grid.ActionColumn",actionIdRe:new RegExp(Ext.baseCSSPrefix+"action-col-(\\d+)"),altText:"",menuText:"<i>Actions</i>",sortable:!1,constructor:function(a){var b=this,c=Ext.apply({},a),d=c.items||[b];b.origRenderer=c.renderer||b.renderer,b.origScope=c.scope||b.scope,delete b.renderer,delete b.scope,delete c.renderer,delete c.scope,delete c.items,b.callParent([c]),b.items=d,b.origRenderer&&(b.hasCustomRenderer=!0)},defaultRenderer:function(a,b){var c=this,d=Ext.baseCSSPrefix,e=c.origScope||c,f=c.items,g=f.length,h=0,i;a=Ext.isFunction(c.origRenderer)?c.origRenderer.apply(e,arguments)||"":"",b.tdCls+=" "+Ext.baseCSSPrefix+"action-col-cell";for(;h<g;h++)i=f[h],i.hasActionConfiguration||(i.stopSelection=c.stopSelection,i.disable=Ext.Function.bind(c.disableAction,c,[h],0),i.enable=Ext.Function.bind(c.enableAction,c,[h],0),i.hasActionConfiguration=!0),a+='<img alt="'+(i.altText||c.altText)+'" src="'+(i.icon||Ext.BLANK_IMAGE_URL)+'" class="'+d+"action-col-icon "+d+"action-col-"+String(h)+" "+(i.disabled?d+"item-disabled":" ")+" "+(Ext.isFunction(i.getClass)?i.getClass.apply(i.scope||e,arguments):i.iconCls||c.iconCls||"")+'"'+(i.tooltip?' data-qtip="'+i.tooltip+'"':"")+" />";return a},enableAction:function(a,b){var c=this;a?Ext.isNumber(a)||(a=Ext.Array.indexOf(c.items,a)):a=0,c.items[a].disabled=!1,c.up("tablepanel").el.select("."+Ext.baseCSSPrefix+"action-col-"+a).removeCls(c.disabledCls),b||c.fireEvent("enable",c)},disableAction:function(a,b){var c=this;a?Ext.isNumber(a)||(a=Ext.Array.indexOf(c.items,a)):a=0,c.items[a].disabled=!0,c.up("tablepanel").el.select("."+Ext.baseCSSPrefix+"action-col-"+a).addCls(c.disabledCls),b||c.fireEvent("disable",c)},destroy:function(){return delete this.items,delete this.renderer,this.callParent(arguments)},processEvent:function(a,b,c,d,e,f,g,h){var i=this,j=f.getTarget(),k,l,m,n=a=="keydown"&&f.getKey();n&&!Ext.fly(j).findParent(b.cellSelector)&&(j=Ext.fly(c).down("."+Ext.baseCSSPrefix+"action-col-icon",!0));if(j&&(k=j.className.match(i.actionIdRe))){l=i.items[parseInt(k[1],10)];if(l)if(a=="click"||n==f.ENTER||n==f.SPACE)m=l.handler||i.handler,m&&!l.disabled&&m.call(l.scope||i.scope||i,b,d,e,l,f,g,h);else if(a=="mousedown"&&l.stopSelection!==!1)return!1}return i.callParent(arguments)},cascade:function(a,b){a.call(b||this,this)},getRefItems:function(){return[]}}),Ext.define("Ext.grid.column.Boolean",{extend:"Ext.grid.column.Column",alias:["widget.booleancolumn"],alternateClassName:"Ext.grid.BooleanColumn",trueText:"true",falseText:"false",undefinedText:"&#160;",defaultRenderer:function(a){return a===undefined?this.undefinedText:!a||a==="false"?this.falseText:this.trueText}}),Ext.define("Ext.grid.column.Date",{extend:"Ext.grid.column.Column",alias:["widget.datecolumn"],requires:["Ext.Date"],alternateClassName:"Ext.grid.DateColumn",initComponent:function(){this.format||(this.format=Ext.Date.defaultFormat),this.callParent(arguments)},defaultRenderer:function(a){return Ext.util.Format.date(a,this.format)}}),Ext.define("Ext.grid.column.Number",{extend:"Ext.grid.column.Column",alias:["widget.numbercolumn"],requires:["Ext.util.Format"],alternateClassName:"Ext.grid.NumberColumn",format:"0,000.00",defaultRenderer:function(a){return Ext.util.Format.number(a,this.format)}}),Ext.define("Ext.grid.column.Template",{extend:"Ext.grid.column.Column",alias:["widget.templatecolumn"],requires:["Ext.XTemplate"],alternateClassName:"Ext.grid.TemplateColumn",initComponent:function(){var a=this;a.tpl=!Ext.isPrimitive(a.tpl)&&a.tpl.compile?a.tpl:new Ext.XTemplate(a.tpl),a.hasCustomRenderer=!0,a.callParent(arguments)},defaultRenderer:function(a,b,c){var d=Ext.apply({},c.data,c.getAssociatedData());return this.tpl.apply(d)}}),Ext.define("Ext.grid.plugin.Editing",{alias:"editing.editing",requires:["Ext.grid.column.Column","Ext.util.KeyNav"],mixins:{observable:"Ext.util.Observable"},clicksToEdit:2,triggerEvent:undefined,defaultFieldXType:"textfield",editStyle:"",constructor:function(a){var b=this;Ext.apply(b,a),b.addEvents("beforeedit","edit","validateedit","canceledit"),b.mixins.observable.constructor.call(b),b.on("edit",function(a,c){b.fireEvent("afteredit",a,c)})},init:function(a){var b=this;a.lockable&&(a=a.view.normalGrid),b.grid=a,b.view=a.view,b.initEvents(),b.mon(a,"reconfigure",b.onReconfigure,b),b.onReconfigure(),a.relayEvents(b,["beforeedit","edit","validateedit","canceledit"]),a.isEditable=!0,a.editingPlugin=a.view.editingPlugin=b},onReconfigure:function(){this.initFieldAccessors(this.view.getGridColumns())},destroy:function(){var a=this,b=a.grid;Ext.destroy(a.keyNav),a.removeFieldAccessors(b.getView().getGridColumns()),a.clearListeners(),delete a.grid.editingPlugin,delete a.grid.view.editingPlugin,delete a.grid,delete a.view,delete a.editor,delete a.keyNav},getEditStyle:function(){return this.editStyle},initFieldAccessors:function(a){a=[].concat(a);var b=this,c,d=a.length,e;for(c=0;c<d;c++)e=a[c],Ext.applyIf(e,{getEditor:function(a,c){return b.getColumnField(this,c)},setEditor:function(a){b.setColumnField(this,a)}})},removeFieldAccessors:function(a){a=[].concat(a);var b,c=a.length,d;for(b=0;b<c;b++)d=a[b],delete d.getEditor,delete d.setEditor},getColumnField:function(a,b){var c=a.field;!c&&a.editor&&(c=a.editor,delete a.editor),!c&&b&&(c=b);if(c)return Ext.isString(c)&&(c={xtype:c}),c.isFormField||(c=Ext.ComponentManager.create(c,this.defaultFieldXType)),a.field=c,Ext.apply(c,{name:a.dataIndex}),c},setColumnField:function(a,b){Ext.isObject(b)&&!b.isFormField&&(b=Ext.ComponentManager.create(b,this.defaultFieldXType)),a.field=b},initEvents:function(){var a=this;a.initEditTriggers(),a.initCancelTriggers()},initCancelTriggers:Ext.emptyFn,initEditTriggers:function(){var a=this,b=a.view;a.triggerEvent=="cellfocus"?a.mon(b,"cellfocus",a.onCellFocus,a):a.triggerEvent=="rowfocus"?a.mon(b,"rowfocus",a.onRowFocus,a):(b.selModel.isCellModel&&(b.onCellFocus=Ext.Function.bind(a.beforeViewCellFocus,a)),a.mon(b,a.triggerEvent||"cell"+(a.clicksToEdit===1?"click":"dblclick"),a.onCellClick,a)),b.on("render",a.addHeaderEvents,a,{single:!0})},beforeViewCellFocus:function(a){(this.view.selModel.keyNavigation||!this.isCellEditable||!this.isCellEditable(a.row,a.columnHeader))&&this.view.focusCell.apply(this.view,arguments)},onRowFocus:function(a,b,c){this.startEdit(b,0)},onCellFocus:function(a,b,c){this.startEdit(c.row,c.column)},onCellClick:function(a,b,c,d,e,f,g){(!a.expanderSelector||!g.getTarget(a.expanderSelector))&&this.startEdit(d,a.getHeaderAtIndex(c))},addHeaderEvents:function(){var a=this;a.mon(a.grid.headerCt,{scope:a,add:a.onColumnAdd,remove:a.onColumnRemove}),a.keyNav=Ext.create("Ext.util.KeyNav",a.view.el,{enter:a.onEnterKey,esc:a.onEscKey,scope:a})},onColumnAdd:function(a,b){b.isHeader&&this.initFieldAccessors(b)},onColumnRemove:function(a,b){b.isHeader&&this.removeFieldAccessors(b)},onEnterKey:function(a){var b=this,c=b.grid,d=c.getSelectionModel(),e,f,g=c.headerCt.getHeaderAtIndex(0);d.getCurrentPosition?(f=d.getCurrentPosition(),f&&(e=c.store.getAt(f.row),g=c.headerCt.getHeaderAtIndex(f.column))):e=d.getLastSelected(),e&&g&&b.startEdit(e,g)},onEscKey:function(a){this.cancelEdit()},beforeEdit:Ext.emptyFn,startEdit:function(a,b){var c=this,d=c.getEditingContext(a,b);if(c.beforeEdit(d)===!1||c.fireEvent("beforeedit",c,d)===!1||d.cancel||!c.grid.view.isVisible(!0))return!1;c.context=d,c.editing=!0},getEditingContext:function(a,b){var c=this,d=c.grid,e=d.getView(),f=e.getNode(a),g,h;if(!f)return;b=d.headerCt.getVisibleHeaderClosestToIndex(Ext.isNumber(b)?b:b.getIndex());if(!b)return;return h=b.getIndex(),Ext.isNumber(a)?(g=a,a=e.getRecord(f)):g=e.indexOf(f),{grid:d,record:a,field:b.dataIndex,value:a.get(b.dataIndex),row:e.getNode(g),column:b,rowIdx:g,colIdx:h}},cancelEdit:function(){var a=this;a.editing=!1,a.fireEvent("canceledit",a,a.context)},completeEdit:function(){var a=this;a.editing&&a.validateEdit()&&a.fireEvent("edit",a,a.context),delete a.context,a.editing=!1},validateEdit:function(){var a=this,b=a.context;return a.fireEvent("validateedit",a,b)!==!1&&!b.cancel}}),Ext.define("Ext.grid.plugin.CellEditing",{alias:"plugin.cellediting",extend:"Ext.grid.plugin.Editing",requires:["Ext.grid.CellEditor","Ext.util.DelayedTask"],constructor:function(){this.callParent(arguments),this.editors=new Ext.util.MixedCollection(!1,function(a){return a.editorId}),this.editTask=new Ext.util.DelayedTask},onReconfigure:function(){this.editors.clear(),this.callParent()},destroy:function(){var a=this;a.editTask.cancel(),a.editors.each(Ext.destroy,Ext),a.editors.clear(),a.callParent(arguments)},onBodyScroll:function(){var a=this,b=a.getActiveEditor(),c=a.view.el.getScroll();b&&b.editing&&(c.top!==a.scroll.top?b.field&&(b.field.triggerBlur?b.field.triggerBlur():b.field.blur()):b.realign()),a.scroll=c},initCancelTriggers:function(){var a=this,b=a.grid,c=b.view;c.addElListener("mousewheel",a.cancelEdit,a),a.mon(c,"bodyscroll",a.onBodyScroll,a),a.mon(b,{columnresize:a.cancelEdit,columnmove:a.cancelEdit,scope:a})},isCellEditable:function(a,b){var c=this,d=c.getEditingContext(a,b);if(c.grid.view.isVisible(!0)&&d){b=d.column,a=d.record;if(b&&c.getEditor(a,b))return!0}},startEdit:function(a,b){var c=this,d=c.getEditingContext(a,b),e,f;return c.completeEdit(),!d||!c.grid.view.isVisible(!0)?!1:(a=d.record,b=d.column,b&&!b.getEditor(a)?!1:(e=a.get(b.dataIndex),d.originalValue=d.value=e,c.beforeEdit(d)===!1||c.fireEvent("beforeedit",c,d)===!1||d.cancel?!1:(f=c.getEditor(a,b),c.grid.view.cancelFocus(),c.view.focusCell({row:d.row,column:d.colIdx}),f?(c.context=d,c.setActiveEditor(f),c.setActiveRecord(a),c.setActiveColumn(b),c.editTask.delay(15,f.startEdit,f,[c.getCell(a,b),e]),c.editing=!0,c.scroll=c.view.el.getScroll(),!0):!1)))},completeEdit:function(){var a=this.getActiveEditor();a&&(a.completeEdit(),this.editing=!1)},setActiveEditor:function(a){this.activeEditor=a},getActiveEditor:function(){return this.activeEditor},setActiveColumn:function(a){this.activeColumn=a},getActiveColumn:function(){return this.activeColumn},setActiveRecord:function(a){this.activeRecord=a},getActiveRecord:function(){return this.activeRecord},getEditor:function(a,b){var c=this,d=c.editors,e=b.getItemId(),f=d.getByKey(e);return f?f:(f=b.getEditor(a),f?(f instanceof Ext.grid.CellEditor||(f=new Ext.grid.CellEditor({editorId:e,field:f,ownerCt:c.grid})),f.editingPlugin=c,f.isForTree=c.grid.isTree,f.on({scope:c,specialkey:c.onSpecialKey,complete:c.onEditComplete,canceledit:c.cancelEdit}),d.add(f),f):!1)},setColumnField:function(a,b){var c=this.editors.getByKey(a.getItemId());Ext.destroy(c,a.field),this.editors.removeAtKey(a.getItemId()),this.callParent(arguments)},getCell:function(a,b){return this.grid.getView().getCell(a,b)},onSpecialKey:function(a,b,c){var d=this,e=d.grid,f;c.getKey()===c.TAB&&(c.stopEvent(),a&&a.onEditorTab(c),f=e.getSelectionModel(),f.onEditorTab&&f.onEditorTab(d,c))},onEditComplete:function(a,b,c){var d=this,e=d.grid,f=d.getActiveColumn(),g;if(f){g=d.context.record,d.setActiveEditor(null),d.setActiveColumn(null),d.setActiveRecord(null);if(!d.validateEdit())return;g.isEqual(b,c)?e.getView().getEl(f).focus():g.set(f.dataIndex,b),d.context.value=b,d.fireEvent("edit",d,d.context)}},cancelEdit:function(){var a=this,b=a.getActiveEditor(),c=a.grid.getView().getEl(a.getActiveColumn());a.setActiveEditor(null),a.setActiveColumn(null),a.setActiveRecord(null),b&&(b.cancelEdit(),c.focus(),a.callParent(arguments))},startEditByPosition:function(a){var b=this.grid.getSelectionModel();return a.column=this.view.getHeaderCt().getVisibleHeaderClosestToIndex(a.column).getIndex(),b.selectByPosition&&b.selectByPosition(a),this.startEdit(a.row,a.column)}}),Ext.define("Ext.grid.property.HeaderContainer",{extend:"Ext.grid.header.Container",alternateClassName:"Ext.grid.PropertyColumnModel",nameWidth:115,nameText:"Name",valueText:"Value",dateFormat:"m/j/Y",trueText:"true",falseText:"false",nameColumnCls:Ext.baseCSSPrefix+"grid-property-name",constructor:function(a,b){var c=this;c.grid=a,c.store=b,c.callParent([{items:[{header:c.nameText,width:a.nameColumnWidth||c.nameWidth,sortable:a.sortableColumns,dataIndex:a.nameField,renderer:Ext.Function.bind(c.renderProp,c),itemId:a.nameField,menuDisabled:!0,tdCls:c.nameColumnCls},{header:c.valueText,renderer:Ext.Function.bind(c.renderCell,c),getEditor:Ext.Function.bind(c.getCellEditor,c),sortable:a.sortableColumns,flex:1,fixed:!0,dataIndex:a.valueField,itemId:a.valueField,menuDisabled:!0}]}])},getCellEditor:function(a){return this.grid.getCellEditor(a,this)},renderProp:function(a){return this.getPropertyName(a)},renderCell:function(a,b,c){var d=this,e=d.grid.customRenderers[c.get(d.grid.nameField)],f=a;return e?e.apply(d,arguments):(Ext.isDate(a)?f=d.renderDate(a):Ext.isBoolean(a)&&(f=d.renderBool(a)),Ext.util.Format.htmlEncode(f))},renderDate:Ext.util.Format.date,renderBool:function(a){return this[a?"trueText":"falseText"]},getPropertyName:function(a){var b=this.grid.propertyNames;return b&&b[a]?b[a]:a}}),Ext.define("Ext.layout.container.VBox",{alias:["layout.vbox"],extend:"Ext.layout.container.Box",alternateClassName:"Ext.layout.VBoxLayout",align:"left",type:"vbox",direction:"vertical",horizontal:!1,names:{lr:"tb",left:"top",leftCap:"Top",right:"bottom",position:"top",width:"height",contentWidth:"contentHeight",minWidth:"minHeight",maxWidth:"maxHeight",widthCap:"Height",widthModel:"heightModel",widthIndex:1,x:"y",scrollLeft:"scrollTop",overflowX:"overflowY",center:"center",top:"left",topPosition:"left",bottom:"right",height:"width",contentHeight:"contentWidth",minHeight:"minWidth",maxHeight:"maxWidth",heightCap:"Width",heightModel:"widthModel",heightIndex:0,y:"x",scrollTop:"scrollLeft",overflowY:"overflowX",getWidth:"getHeight",getHeight:"getWidth",setWidth:"setHeight",setHeight:"setWidth",gotWidth:"gotHeight",gotHeight:"gotWidth",setContentWidth:"setContentHeight",setContentHeight:"setContentWidth"},sizePolicy:{flex:{"":{setsWidth:0,setsHeight:1},stretch:{setsWidth:1,setsHeight:1},stretchmax:{readsWidth:1,setsWidth:1,setsHeight:1}},"":{setsWidth:0,setsHeight:0},stretch:{setsWidth:1,setsHeight:0},stretchmax:{readsWidth:1,setsWidth:1,setsHeight:0}}}),Ext.define("Ext.layout.container.Accordion",{extend:"Ext.layout.container.VBox",alias:["layout.accordion"],alternateClassName:"Ext.layout.AccordionLayout",itemCls:[Ext.baseCSSPrefix+"box-item",Ext.baseCSSPrefix+"accordion-item"],align:"stretch",fill:!0,titleCollapse:!0,hideCollapseTool:!1,collapseFirst:!1,animate:!0,activeOnTop:!1,multi:!1,defaultAnimatePolicy:{y:!0,height:!0},constructor:function(){var a=this;a.callParent(arguments),a.animate?a.animatePolicy=Ext.apply({},a.defaultAnimatePolicy):a.animatePolicy=null},beforeRenderItems:function(a){var b=this,c=a.length,d=0,e;for(;d<c;d++)e=a[d],e.rendered||(b.collapseFirst&&(e.collapseFirst=b.collapseFirst),b.hideCollapseTool?(e.hideCollapseTool=b.hideCollapseTool,e.titleCollapse=!0):b.titleCollapse&&(e.titleCollapse=b.titleCollapse),delete e.hideHeader,delete e.width,e.collapsible=!0,e.title=e.title||"&#160;",e.addBodyCls(Ext.baseCSSPrefix+"accordion-body"),b.multi||(b.expandedItem!==undefined?e.collapsed=!0:e.hasOwnProperty("collapsed")&&e.collapsed===!1?b.expandedItem=d:e.collapsed=!0,b.owner.mon(e,{show:b.onComponentShow,beforeexpand:b.onComponentExpand,scope:b})),b.fill&&b.owner.mon(e,{beforecollapse:b.onComponentCollapse,scope:b}));c&&b.expandedItem===undefined&&(b.expandedItem=0,a[0].collapsed=!1)},getItemsRenderTree:function(a){return this.beforeRenderItems(a),this.callParent(arguments)},renderItems:function(a,b){this.beforeRenderItems(a),this.callParent(arguments)},configureItem:function(a){this.callParent(arguments),a.animCollapse=a.border=!1,this.fill&&(a.flex=1)},onChildPanelRender:function(a){a.header.addCls(Ext.baseCSSPrefix+"accordion-hd")},beginLayout:function(a){this.callParent(arguments),this.updatePanelClasses(a)},updatePanelClasses:function(a){var b=a.visibleItems,c=b.length,d=!0,e,f,g;for(e=0;e<c;e++)f=b[e],g=f.header,g.addCls(Ext.baseCSSPrefix+"accordion-hd"),d?g.removeCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded"):g.addCls(Ext.baseCSSPrefix+"accordion-hd-sibling-expanded"),e+1==c&&f.collapsed?g.addCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed"):g.removeCls(Ext.baseCSSPrefix+"accordion-hd-last-collapsed"),d=f.collapsed},onComponentExpand:function(a){var b=this,c=b.owner,d,e,f,g;if(!b.processing){b.processing=!0,g=c.deferLayouts,c.deferLayouts=!0,d=b.multi?[]:c.query(">panel:not([collapsed])"),e=d.length;for(f=0;f<e;f++)d[f].collapse();c.deferLayouts=g,b.processing=!1}},onComponentCollapse:function(a){var b=this,c=b.owner,d,e,f;b.processing||(b.processing=!0,f=c.deferLayouts,c.deferLayouts=!0,d=a.next()||a.prev(),b.multi?(e=b.owner.query(">panel:not([collapsed])"),e.length===1&&d.expand()):d&&d.expand(),c.deferLayouts=f,b.processing=!1)},onComponentShow:function(a){this.onComponentExpand(a)}}),Ext.define("Ext.toolbar.Spacer",{extend:"Ext.Component",alias:"widget.tbspacer",alternateClassName:"Ext.Toolbar.Spacer",baseCls:Ext.baseCSSPrefix+"toolbar-spacer",focusable:!1}),Ext.define("Ext.toolbar.TextItem",{extend:"Ext.toolbar.Item",requires:["Ext.XTemplate"],alias:"widget.tbtext",alternateClassName:"Ext.Toolbar.TextItem",text:"",renderTpl:"{text}",baseCls:Ext.baseCSSPrefix+"toolbar-text",beforeRender:function(){var a=this;a.callParent(),Ext.apply(a.renderData,{text:a.text})},setText:function(a){this.rendered?(this.el.update(a),this.ownerCt.doLayout()):this.text=a}}),Ext.define("Ext.toolbar.Toolbar",{extend:"Ext.container.Container",requires:["Ext.toolbar.Fill","Ext.layout.container.HBox","Ext.layout.container.VBox"],uses:["Ext.toolbar.Separator"],alias:"widget.toolbar",alternateClassName:"Ext.Toolbar",isToolbar:!0,baseCls:Ext.baseCSSPrefix+"toolbar",ariaRole:"toolbar",defaultType:"button",vertical:!1,enableOverflow:!1,menuTriggerCls:Ext.baseCSSPrefix+"toolbar-more-icon",trackMenus:!0,itemCls:Ext.baseCSSPrefix+"toolbar-item",statics:{shortcuts:{"-":"tbseparator"," ":"tbspacer"},shortcutsHV:{0:{"->":{xtype:"tbfill",height:0}},1:{"->":{xtype:"tbfill",width:0}}}},initComponent:function(){var a=this,b;!a.layout&&a.enableOverflow&&(a.layout={overflowHandler:"Menu"});if(a.dock==="right"||a.dock==="left")a.vertical=!0;a.layout=Ext.applyIf(Ext.isString(a.layout)?{type:a.layout}:a.layout||{},{type:a.vertical?"vbox":"hbox",align:a.vertical?"stretchmax":"middle"}),a.vertical&&a.addClsWithUI("vertical"),a.ui==="footer"&&(a.ignoreBorderManagement=!0),a.callParent(),a.addEvents("overflowchange")},getRefItems:function(a){var b=this,c=b.callParent(arguments),d=b.layout,e;return a&&b.enableOverflow&&(e=d.overflowHandler,e&&e.menu&&(c=c.concat(e.menu.getRefItems(a)))),c},lookupComponent:function(a){if(typeof a=="string"){var b=Ext.toolbar.Toolbar,c=b.shortcutsHV[this.vertical?1:0][a]||b.shortcuts[a];typeof c=="string"?a={xtype:c}:c?a=Ext.apply({},c):a={xtype:"tbtext",text:a},this.applyDefaults(a)}return this.callParent(arguments)},applyDefaults:function(a){if(!Ext.isString(a)){a=this.callParent(arguments);var b=this.internalDefaults;a.events?(Ext.applyIf(a.initialConfig,b),Ext.apply(a,b)):Ext.applyIf(a,b)}return a},trackMenu:function(a,b){if(this.trackMenus&&a.menu){var c=b?"mun":"mon",d=this;d[c](a,"mouseover",d.onButtonOver,d),d[c](a,"menushow",d.onButtonMenuShow,d),d[c](a,"menuhide",d.onButtonMenuHide,d)}},constructButton:function(a){return a.events?a:Ext.widget(a.split?"splitbutton":this.defaultType,a)},onBeforeAdd:function(a){if(a.is("field")||a.is("button")&&this.ui!="footer")a.ui=a.ui+"-toolbar";a instanceof Ext.toolbar.Separator&&a.setUI(this.vertical?"vertical":"horizontal"),this.callParent(arguments)},onAdd:function(a){this.callParent(arguments),this.trackMenu(a)},onRemove:function(a){this.callParent(arguments),this.trackMenu(a,!0)},getChildItemsToDisable:function(){return this.items.getRange()},onButtonOver:function(a){this.activeMenuBtn&&this.activeMenuBtn!=a&&(this.activeMenuBtn.hideMenu(),a.showMenu(),this.activeMenuBtn=a)},onButtonMenuShow:function(a){this.activeMenuBtn=a},onButtonMenuHide:function(a){delete this.activeMenuBtn}}),Ext.define("Ext.panel.AbstractPanel",{extend:"Ext.container.Container",mixins:{docking:"Ext.container.DockingContainer"},requires:["Ext.util.MixedCollection","Ext.Element","Ext.toolbar.Toolbar"],baseCls:Ext.baseCSSPrefix+"panel",isPanel:!0,componentLayout:"dock",childEls:["body"],renderTpl:["{% this.renderDockedItems(out,values,0); %}",Ext.isIE6||Ext.isIE7||Ext.isIEQuirks?"<div></div>":"",'<div id="{id}-body" class="{baseCls}-body<tpl if="bodyCls"> {bodyCls}</tpl>',' {baseCls}-body-{ui}<tpl if="uiCls">','<tpl for="uiCls"> {parent.baseCls}-body-{parent.ui}-{.}</tpl>','</tpl>"<tpl if="bodyStyle"> style="{bodyStyle}"</tpl>>',"{%this.renderContainer(out,values);%}","</div>","{% this.renderDockedItems(out,values,1); %}"],bodyPosProps:{x:"x",y:"y"},border:!0,initComponent:function(){var a=this;a.addEvents("bodyresize"),a.frame&&a.border&&a.bodyBorder===undefined&&(a.bodyBorder=!1),a.frame&&a.border&&(a.bodyBorder===!1||a.bodyBorder===0)&&(a.manageBodyBorders=!0),a.callParent()},beforeDestroy:function(){this.destroyDockedItems(),this.callParent()},initItems:function(){this.callParent(),this.initDockingItems()},initRenderData:function(){var a=this,b=a.callParent();return a.initBodyStyles(),a.protoBody.writeTo(b),delete a.protoBody,b},getComponent:function(a){var b=this.callParent(arguments);return b===undefined&&!Ext.isNumber(a)&&(b=this.getDockedComponent(a)),b},getProtoBody:function(){var a=this,b=a.protoBody;return b||(a.protoBody=b=new Ext.util.ProtoElement({cls:a.bodyCls,style:a.bodyStyle,clsProp:"bodyCls",styleProp:"bodyStyle",styleIsText:!0})),b},initBodyStyles:function(){var a=this,b=a.getProtoBody(),c=Ext.Element;a.bodyPadding!==undefined&&b.setStyle("padding",c.unitizeBox(a.bodyPadding===!0?5:a.bodyPadding)),a.frame&&a.bodyBorder&&(Ext.isNumber(a.bodyBorder)||(a.bodyBorder=1),b.setStyle("border-width",c.unitizeBox(a.bodyBorder)))},getCollapsedDockedItems:function(){return[this.getReExpander()]},setBodyStyle:function(a,b){var c=this,d=c.rendered?c.body:c.getProtoBody();Ext.isFunction(a)&&(a=a()),arguments.length==1&&Ext.isString(a)&&(a=Ext.Element.parseStyles(a)),d.setStyle.apply(c.body,arguments)},addBodyCls:function(a){var b=this,c=b.rendered?b.body:b.getProtoBody();c.addCls(a)},removeBodyCls:function(a){var b=this,c=b.rendered?b.body:b.getProtoBody();c.removeCls(a)},addUIClsToElement:function(a){var b=this,c=b.callParent(arguments);return b.addBodyCls([Ext.baseCSSPrefix+a,b.baseCls+"-body-"+a,b.baseCls+"-body-"+b.ui+"-"+a]),c},removeUIClsFromElement:function(a){var b=this,c=b.callParent(arguments);return b.removeBodyCls([Ext.baseCSSPrefix+a,b.baseCls+"-body-"+a,b.baseCls+"-body-"+b.ui+"-"+a]),c},addUIToElement:function(){var a=this;a.callParent(arguments),a.addBodyCls(a.baseCls+"-body-"+a.ui)},removeUIFromElement:function(){var a=this;a.callParent(arguments),a.removeBodyCls(a.baseCls+"-body-"+a.ui)},getTargetEl:function(){return this.body},getRefItems:function(a){var b=this.callParent(arguments);return this.getDockingRefItems(a,b)},setupRenderTpl:function(a){this.callParent(arguments),this.setupDockingRenderTpl(a)}}),Ext.define("Ext.panel.Panel",{extend:"Ext.panel.AbstractPanel",requires:["Ext.panel.Header","Ext.fx.Anim","Ext.util.KeyMap","Ext.panel.DD","Ext.XTemplate","Ext.layout.component.Dock","Ext.util.Memento"],alias:"widget.panel",alternateClassName:"Ext.Panel",collapsedCls:"collapsed",animCollapse:Ext.enableFx,minButtonWidth:75,collapsed:!1,collapseFirst:!0,hideCollapseTool:!1,titleCollapse:!1,floatable:!0,collapsible:!1,closable:!1,closeAction:"destroy",placeholderCollapseHideMode:Ext.Element.VISIBILITY,preventHeader:!1,header:undefined,headerPosition:"top",frame:!1,frameHeader:!0,titleAlign:"left",manageHeight:!0,initComponent:function(){var a=this;a.addEvents("beforeclose","close","beforeexpand","beforecollapse","expand","collapse","titlechange","iconchange","iconclschange"),a.collapsible&&this.addStateEvents(["expand","collapse"]),a.unstyled&&a.setUI("plain"),a.frame&&a.setUI(a.ui+"-framed"),a.bridgeToolbars(),a.callParent(),a.collapseDirection=a.collapseDirection||a.headerPosition||Ext.Component.DIRECTION_TOP,a.hiddenOnCollapse=new Ext.dom.CompositeElement},beforeDestroy:function(){var a=this;Ext.destroy(a.placeholder,a.ghostPanel,a.dd),a.callParent()},initAria:function(){this.callParent(),this.initHeaderAria()},getFocusEl:function(){return this.el},initHeaderAria:function(){var a=this,b=a.el,c=a.header;b&&c&&b.dom.setAttribute("aria-labelledby",c.titleCmp.id)},getHeader:function(){return this.header},setTitle:function(a){var b=this,c=b.title,d=b.header,e=b.reExpander,f=b.placeholder;b.title=a,d&&(d.isHeader?d.setTitle(a):d.title=a),e&&e.setTitle(a),f&&f.setTitle&&f.setTitle(a),b.fireEvent("titlechange",b,a,c)},setIconCls:function(a){var b=this,c=b.iconCls,d=b.header,e=b.placeholder;b.iconCls=a,d&&(d.isHeader?d.setIconCls(a):d.iconCls=a),e&&e.setIconCls&&e.setIconCls(a),b.fireEvent("iconclschange",b,a,c)},setIcon:function(a){var b=this,c=b.icon,d=b.header,e=b.placeholder;b.icon=a,d&&(d.isHeader?d.setIcon(a):d.icon=a),e&&e.setIcon&&e.setIcon(a),b.fireEvent("iconchange",b,a,c)},bridgeToolbars:function(){function f(b,c,d){Ext.isArray(b)?b={xtype:"toolbar",items:b}:b.xtype||(b.xtype="toolbar"),b.dock=c;if(c=="left"||c=="right")b.vertical=!0;return d&&(b.layout=Ext.applyIf(b.layout||{},{pack:{left:"start",center:"center"}[a.buttonAlign]||"end"})),b}var a=this,b=[],c,d,e=a.minButtonWidth;a.tbar&&(b.push(f(a.tbar,"top")),a.tbar=null),a.bbar&&(b.push(f(a.bbar,"bottom")),a.bbar=null),a.buttons&&(a.fbar=a.buttons,a.buttons=null),a.fbar&&(c=f(a.fbar,"bottom",!0),c.ui="footer",e&&(d=c.defaults,c.defaults=function(a){var b=d||{};return(!a.xtype||a.xtype==="button"||a.isComponent&&a.isXType("button"))&&!("minWidth"in b)&&(b=Ext.apply({minWidth:e},b)),b}),b.push(c),a.fbar=null),a.lbar&&(b.push(f(a.lbar,"left")),a.lbar=null),a.rbar&&(b.push(f(a.rbar,"right")),a.rbar=null),a.dockedItems?(Ext.isArray(a.dockedItems)||(a.dockedItems=[a.dockedItems]),a.dockedItems=a.dockedItems.concat(b)):a.dockedItems=b},isPlaceHolderCollapse:function(){return this.collapseMode=="placeholder"},onBoxReady:function(){this.callParent(),this.collapsed&&this.setHiddenDocked()},beforeRender:function(){var a=this,b;a.callParent(),a.initTools(),!a.preventHeader&&a.header!==!1&&a.updateHeader(),a.collapsed&&(a.isPlaceHolderCollapse()?(a.hidden=!0,a.placeholderCollapse(),b=a.collapsed,a.collapsed=!1):(a.beginCollapse(),a.addClsWithUI(a.collapsedCls))),b&&(a.collapsed=b)},initTools:function(){var a=this;a.tools=a.tools?Ext.Array.clone(a.tools):[],a.collapsible&&!a.hideCollapseTool&&a.header!==!1&&!a.preventHeader&&(a.collapseDirection=a.collapseDirection||a.headerPosition||"top",a.collapseTool=a.expandTool=Ext.widget({xtype:"tool",type:a.collapsed&&!a.isPlaceHolderCollapse()?"expand-"+a.getOppositeDirection(a.collapseDirection):"collapse-"+a.collapseDirection,handler:a.toggleCollapse,scope:a}),a.collapseFirst&&a.tools.unshift(a.collapseTool)),a.addTools(),a.closable&&(a.addClsWithUI("closable"),a.addTool({type:"close",handler:Ext.Function.bind(a.close,a,[])})),a.collapseTool&&!a.collapseFirst&&a.addTool(a.collapseTool)},addTools:Ext.emptyFn,close:function(){this.fireEvent("beforeclose",this)!==!1&&this.doClose()},doClose:function(){this.fireEvent("close",this),this[this.closeAction]()},updateHeader:function(a){var b=this,c=b.header,d=b.title,e=b.tools,f=b.headerPosition=="left"||b.headerPosition=="right";c!==!1&&(a||d||e&&e.length||b.collapsible&&!b.titleCollapse)?(c&&c.isHeader?c.show():(c=b.header=Ext.widget(Ext.apply({xtype:"header",title:d,titleAlign:b.titleAlign,orientation:f?"vertical":"horizontal",dock:b.headerPosition||"top",textCls:b.headerTextCls,iconCls:b.iconCls,icon:b.icon,baseCls:b.baseCls+"-header",tools:e,ui:b.ui,id:b.id+"_header",indicateDrag:b.draggable,frame:b.frame&&b.frameHeader,ignoreParentFrame:b.frame||b.overlapHeader,ignoreBorderManagement:b.frame||b.ignoreHeaderBorderManagement,listeners:b.collapsible&&b.titleCollapse?{click:b.toggleCollapse,scope:b}:null},b.header)),b.addDocked(c,0),b.tools=c.tools),b.initHeaderAria()):c&&c.hide()},setUI:function(a){var b=this;b.callParent(arguments),b.header&&b.header.rendered&&b.header.setUI(a)},getContentTarget:function(){return this.body},getTargetEl:function(){var a=this;return a.body||a.protoBody||a.frameBody||a.el},isVisible:function(a){var b=this;return b.collapsed&&b.placeholder?b.placeholder.isVisible(a):b.callParent(arguments)},onHide:function(){var a=this;a.collapsed&&a.placeholder?a.placeholder.hide():a.callParent(arguments)},onShow:function(){var a=this;a.collapsed&&a.placeholder?(a.hidden=!0,a.placeholder.show()):a.callParent(arguments)},onRemoved:function(a){var b=this;b.callParent(arguments),b.placeholder&&!a&&b.ownerCt.remove(b.placeholder,!1)},addTool:function(a){a=[].concat(a);var b=this,c=b.header,d,e=a.length,f;for(d=0;d<e;d++)f=a[d],b.tools.push(f),c&&c.addTool(f);b.updateHeader()},getOppositeDirection:function(a){var b=Ext.Component;switch(a){case b.DIRECTION_TOP:return b.DIRECTION_BOTTOM;case b.DIRECTION_RIGHT:return b.DIRECTION_LEFT;case b.DIRECTION_BOTTOM:return b.DIRECTION_TOP;case b.DIRECTION_LEFT:return b.DIRECTION_RIGHT}},getWidthAuthority:function(){return this.collapsed&&this.collapsedHorizontal()?1:this.callParent()},getHeightAuthority:function(){return this.collapsed&&this.collapsedVertical()?1:this.callParent()},collapsedHorizontal:function(){var a=this.getCollapsed();return a=="left"||a=="right"},collapsedVertical:function(){var a=this.getCollapsed();return a=="top"||a=="bottom"},getCollapsed:function(){var a=this;return a.collapsed===!0?a.collapseDirection:a.collapsed},getState:function(){var a=this,b=a.callParent(),c;return b=a.addPropertyToState(b,"collapsed"),a.collapsed&&(c=a.collapseMemento,c=c&&c.data,a.collapsedVertical()?(b&&delete b.height,c&&(b=a.addPropertyToState(b,"height",c.height))):(b&&delete b.width,c&&(b=a.addPropertyToState(b,"width",c.width)))),b},findReExpander:function(a){var b=this,c=Ext.Component,d=b.dockedItems.items,e=d.length,f,g;if(b.collapseMode=="mini")return;switch(a){case c.DIRECTION_TOP:case c.DIRECTION_BOTTOM:for(g=0;g<e;g++){f=d[g];if(!f.hidden&&f.isHeader&&(!f.dock||f.dock=="top"||f.dock=="bottom"))return f}break;case c.DIRECTION_LEFT:case c.DIRECTION_RIGHT:for(g=0;g<e;g++){f=d[g];if(!f.hidden&&f.isHeader&&(f.dock=="left"||f.dock=="right"))return f}break;default:throw"Panel#findReExpander must be passed a valid collapseDirection"}},getReExpander:function(a){var b=this,c=a||b.collapseDirection,d=b.reExpander||b.findReExpander(c);return b.expandDirection=b.getOppositeDirection(c),d||(b.reExpander=d=b.createReExpander(c,{dock:c,cls:Ext.baseCSSPrefix+"docked "+b.baseCls+"-"+b.ui+"-collapsed",ownerCt:b,ownerLayout:b.componentLayout}),b.dockedItems.insert(0,d)),d},createReExpander:function(a,b){var c=this,d=a=="left",e=a=="right",f=d||e,g,h=Ext.apply({hideMode:"offsets",title:c.title,orientation:f?"vertical":"horizontal",textCls:c.headerTextCls,icon:c.icon,iconCls:c.iconCls,baseCls:c.baseCls+"-header",ui:c.ui,frame:c.frame&&c.frameHeader,ignoreParentFrame:c.frame||c.overlapHeader,indicateDrag:c.draggable},b);return c.collapseMode=="mini"&&(f?h.width=1:h.height=1),c.hideCollapseTool||(g=d||e&&c.isPlaceHolderCollapse(),h[g?"items":"tools"]=[{xtype:"tool",type:"expand-"+c.getOppositeDirection(a),uiCls:["top"],handler:c.toggleCollapse,scope:c}]),h=new Ext.panel.Header(h),h.addClsWithUI(c.getHeaderCollapsedClasses(h)),h},getHeaderCollapsedClasses:function(a){var b=this,c=b.collapsedCls,d;return d=[c,c+"-"+a.dock],b.border&&(!b.frame||b.frame&&Ext.supports.CSS3BorderRadius)&&d.push(c+"-border-"+a.dock),d},beginCollapse:function(){var a=this,b=a.lastBox,c=a.rendered,d=a.collapseMemento||(a.collapseMemento=new Ext.util.Memento(a)),e=a.getSizeModel(),f;d.capture(["height","minHeight","width","minWidth"]),b&&d.capture(["x","y","height","width"],b,"last."),a.collapsedVertical()?(e.width.shrinkWrap&&(a.width=c?a.getWidth():a.width||a.minWidth||100),delete a.height,a.minHeight=0):a.collapsedHorizontal()&&(e.height.shrinkWrap&&(a.height=c?a.getHeight():a.height||a.minHeight||100),delete a.width,a.minWidth=0),a.ownerCt&&a.ownerCt.getLayout().beginCollapse(a),a.isPlaceHolderCollapse()||(a.header===(f=a.getReExpander())?(a.header.addClsWithUI(a.getHeaderCollapsedClasses(a.header)),a.header.rendered&&a.header.updateFrame()):f.el&&(f.el.show(),f.hidden=!1)),a.resizer&&a.resizer.disable()},beginExpand:function(){var a=this,b=a.lastBox,c=a.collapseMemento,d;c.restore(["height","minHeight","width","minWidth"]),b&&c.restore(["x","y","height","width"],!0,b,"last."),a.ownerCt&&a.ownerCt.getLayout().beginExpand(a),a.isPlaceHolderCollapse()||(a.header===(d=a.getReExpander())?(a.header.removeClsWithUI(a.getHeaderCollapsedClasses(a.header)),a.header.rendered&&a.header.updateFrame()):(d.hidden=!0,d.el.hide())),a.resizer&&a.resizer.enable()},collapse:function(a,b){var c=this,d=a||c.collapseDirection,e=c.ownerCt;return c.isCollapsingOrExpanding?c:(arguments.length<2&&(b=c.animCollapse),c.collapsed||c.fireEvent("beforecollapse",c,a,b)===!1?c:e&&c.isPlaceHolderCollapse()?c.placeholderCollapse(a,b):(c.collapsed=d,c.beginCollapse(),c.fireHierarchyEvent("collapse"),c.doCollapseExpand(1,b)))},doCollapseExpand:function(a,b){var c=this,d=c.animCollapse,e=c.ownerLayout;return c.animCollapse=b,c.isCollapsingOrExpanding=a,e&&!b?e.onContentChange(c):c.updateLayout({isRoot:!0}),c.animCollapse=d,c},afterCollapse:function(a){var b=this,c=b.ownerLayout;b.isCollapsingOrExpanding=0,b.collapseTool&&b.collapseTool.setType("expand-"+b.getOppositeDirection(b.collapseDirection)),c&&a&&c.onContentChange(b),b.setHiddenDocked(),b.fireEvent("collapse",b)},setHiddenDocked:function(){var a=this,b=a.hiddenOnCollapse,c=a.getReExpander(),d=a.getDockedItems(),e=d.length,f=0,g;b.add(a.body);for(;f<e;f++)g=d[f],g&&g!==c&&g.el&&b.add(g.el);b.setStyle("visibility","hidden")},restoreHiddenDocked:function(){var a=this.hiddenOnCollapse;a.setStyle("visibility",""),a.clear()},getPlaceholder:function(a){var b=this,c=a||b.collapseDirection,d=null,e=b.placeholder;if(!e){if(b.floatable||b.collapsible&&b.titleCollapse)d={click:{fn:b.floatable?b.floatCollapsedPanel:b.toggleCollapse,element:"el",scope:b}};b.placeholder=e=Ext.widget(b.createReExpander(c,{id:b.id+"-placeholder",listeners:d}))}return e.placeholderFor||(e.isComponent||(b.placeholder=e=b.lookupComponent(e)),Ext.applyIf(e,{margins:b.margins,placeholderFor:b}),e.addCls([Ext.baseCSSPrefix+"region-collapsed-placeholder",Ext.baseCSSPrefix+"region-collapsed-"+c+"-placeholder",b.collapsedCls])),e},placeholderCollapse:function(a,b){var c=this,d=c.ownerCt,e=a||c.collapseDirection,f=Ext.baseCSSPrefix+"border-region-slide-in",g=c.getPlaceholder(a);return c.isCollapsingOrExpanding=1,c.hidden=!0,c.collapsed=e,g.rendered?(g.el.dom.parentNode!==c.el.dom.parentNode&&c.el.dom.parentNode.insertBefore(g.el.dom,c.el.dom),g.hidden=!1,g.el.show(),d.updateLayout()):d.insert(d.items.indexOf(c),g),c.rendered?(c.el.setVisibilityMode(c.placeholderCollapseHideMode),b?(c.el.addCls(f),g.el.hide(),c.el.slideOut(e.substr(0,1),{preserveScroll:!0,duration:Ext.Number.from(b,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){c.el.removeCls(f),g.el.show().setStyle("display","none").slideIn(e.substr(0,1),{easing:"linear",duration:100,listeners:{afteranimate:function(){g.focus(),c.isCollapsingOrExpanding=0,c.fireEvent("collapse",c)}}})}}})):(c.el.hide(),c.isCollapsingOrExpanding=0,c.fireEvent("collapse",c))):(c.isCollapsingOrExpanding=0,c.fireEvent("collapse",c)),c},floatCollapsedPanel:function(){function i(c){var d=a.el.getRegion().union(b.el.getRegion()).adjust(1,-1,-1,1);d.contains(c.getPoint())||a.slideOutFloatedPanel()}var a=this,b=a.placeholder,c=b.getBox(!0),d,e=Ext.baseCSSPrefix+"border-region-slide-in",f=a.collapsed,g=a.ownerCt||a,h;if(a.el.hasCls(e)){a.slideOutFloatedPanel();return}if(a.isSliding)return;a.isSliding=!0,a.placeholder.el.hide(),a.placeholder.hidden=!0,a.el.show(),a.hidden=!1,a.collapsed=!1,g.updateLayout(),d=a.getBox(!0),a.placeholder.el.show(),a.placeholder.hidden=!1,a.el.hide(),a.hidden=!0,a.collapsed=f,g.updateLayout(),a.placeholderMouseMon=b.el.monitorMouseLeave(500,i),a.panelMouseMon=a.el.monitorMouseLeave(500,i),a.el.addCls(e),a.collapseTool&&a.collapseTool.el.hide();switch(a.collapsed){case"top":a.el.setLeftTop(c.x,c.y+c.height-1),h="t";break;case"right":a.el.setLeftTop(c.x-d.width+1,c.y),h="r";break;case"bottom":a.el.setLeftTop(c.x,c.y-d.height+1),h="b";break;case"left":a.el.setLeftTop(c.x+c.width-1,c.y),h="l"}a.floatedFromCollapse=a.collapsed,a.collapsed=a.hidden=!1,a.el.slideIn(h,{preserveScroll:!0,listeners:{afteranimate:function(){a.isSliding=!1}}})},isLayoutRoot:function(){return this.floatedFromCollapse?!0:this.callParent()},slideOutFloatedPanel:function(){var a=this,b=this.el,c;if(a.isSliding)return;a.isSliding=!0,a.slideOutFloatedPanelBegin(),typeof a.collapsed=="string"&&(c=a.collapsed.charAt(0)),b.slideOut(c,{preserveScroll:!0,listeners:{afteranimate:function(){a.slideOutFloatedPanelEnd(),a.el.removeCls(Ext.baseCSSPrefix+"border-region-slide-in"),a.isSliding=!1}}})},slideOutFloatedPanelBegin:function(){var a=this,b=this.el;a.collapsed=a.floatedFromCollapse,a.hidden=!0,a.floatedFromCollapse=null,b.un(a.panelMouseMon),a.placeholder.el.un(a.placeholderMouseMon)},slideOutFloatedPanelEnd:function(){this.collapseTool&&this.collapseTool.el.show()},expand:function(a){var b=this;return b.isCollapsingOrExpanding?b:(arguments.length||(a=b.animCollapse),!b.collapsed&&!b.floatedFromCollapse?b:b.fireEvent("beforeexpand",b,a)===!1?b:b.isPlaceHolderCollapse()?b.placeholderExpand(a):(b.restoreHiddenDocked(),b.beginExpand(),b.collapsed=!1,b.fireHierarchyEvent("expand"),b.doCollapseExpand(2,a)))},placeholderExpand:function(a){var b=this,c=b.collapsed,d=Ext.baseCSSPrefix+"border-region-slide-in",e,f,g;return b.floatedFromCollapse&&(f=b.getPosition(!0),b.slideOutFloatedPanelBegin(),b.slideOutFloatedPanelEnd()),b.isCollapsingOrExpanding=2,b.placeholder.hidden=!0,b.placeholder.el.hide(),b.collapsed=!1,b.show(),a?f?(e=b.el.getXY(),b.el.setLeftTop(f[0],f[1]),b.el.moveTo(e[0],e[1],{duration:Ext.Number.from(a,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){b.el.removeCls(d),b.isCollapsingOrExpanding=0,b.fireEvent("expand",b)}}})):(b.hidden=!0,b.el.addCls(d),b.el.hide(),b.collapsed=c,b.placeholder.show(),g=c.substr(0,1),b.hidden=!1,b.el.slideIn(g,{preserveScroll:!0,duration:Ext.Number.from(a,Ext.fx.Anim.prototype.duration),listeners:{afteranimate:function(){b.collapsed=!1,b.el.removeCls(d),b.placeholder.hide(),b.isCollapsingOrExpanding=0,b.fireEvent("expand",b)}}})):(b.isCollapsingOrExpanding=0,b.fireEvent("expand",b)),b},afterExpand:function(a){var b=this,c=b.ownerLayout;b.isCollapsingOrExpanding=0,b.collapseTool&&b.collapseTool.setType("collapse-"+b.collapseDirection),c&&a&&c.onContentChange(b),b.fireEvent("expand",b)},setBorder:function(a,b){if(b)return;var c=this,d=c.header;a?a=Ext.Element.unitizeBox(a===!0?1:a):a=0,d&&(d.isHeader?d.setBorder(a):d.border=a),c.rendered&&c.bodyBorder!==!1&&c.body.setStyle("border-width",a),c.updateLayout(),c.border=a},toggleCollapse:function(){return this.collapsed||this.floatedFromCollapse?this.expand():this.collapse()},getKeyMap:function(){return this.keyMap||(this.keyMap=new Ext.util.KeyMap(Ext.apply({target:this.el},this.keys)))},initDraggable:function(){this.dd=new Ext.panel.DD(this,Ext.isBoolean(this.draggable)?null:this.draggable)},ghostTools:function(){var a=[],b=this.header,c=b?b.query("tool[hidden=false]"):[],d,e,f;if(c.length){d=0,e=c.length;for(;d<e;d++)f=c[d],a.push({type:f.type})}else a=[{type:"placeholder"}];return a},ghost:function(a){var b=this,c=b.ghostPanel,d=b.getBox(),e;return c||(c=new Ext.panel.Panel({renderTo:document.body,floating:{shadow:!1},frame:b.frame&&!b.alwaysFramed,alwaysFramed:b.alwaysFramed,overlapHeader:b.overlapHeader,headerPosition:b.headerPosition,baseCls:b.baseCls,cls:b.baseCls+"-ghost "+(a||"")}),b.ghostPanel=c),c.floatParent=b.floatParent,b.floating?c.setZIndex(Ext.Number.from(b.el.getStyle("zIndex"),0)):c.toFront(),!b.preventHeader&&b.header!==!1&&(e=c.header,e&&(e.suspendLayouts(),Ext.Array.forEach(e.query("tool"),e.remove,e),e.resumeLayouts()),c.addTool(b.ghostTools()),c.setTitle(b.title),c.setIconCls(b.iconCls)),c.el.show(),c.setPagePosition(d.x,d.y),c.setSize(d.width,d.height),b.el.hide(),c},unghost:function(a,b){var c=this;if(!c.ghostPanel)return;a!==!1&&(c.el.show(),b!==!1&&(c.setPagePosition(c.ghostPanel.el.getXY()),c.hideMode=="offsets"&&delete c.el.hideModeStyles),Ext.defer(c.focus,10,c)),c.ghostPanel.el.hide()},beginDrag:function(){this.floatingItems&&this.floatingItems.hide()},endDrag:function(){this.floatingItems&&this.floatingItems.show()},initResizable:function(a){this.collapsed&&(a.disabled=!0),this.callParent([a])}},function(){this.prototype.animCollapse=Ext.enableFx}),Ext.define("Ext.container.ButtonGroup",{extend:"Ext.panel.Panel",alias:"widget.buttongroup",alternateClassName:"Ext.ButtonGroup",requires:["Ext.layout.container.Table"],baseCls:Ext.baseCSSPrefix+"btn-group",layout:{type:"table"},defaultType:"button",frame:!0,frameHeader:!1,internalDefaults:{removeMode:"container",hideParent:!0},titleAlign:"center",initComponent:function(){var a=this,b=a.columns;a.noTitleCls=a.baseCls+"-notitle",b&&(a.layout=Ext.apply({},{columns:b},a.layout)),a.title||a.addCls(a.noTitleCls),a.callParent(arguments)},onBeforeAdd:function(a){a.isButton&&(a.ui=a.ui+"-toolbar"),this.callParent(arguments)},applyDefaults:function(a){if(!Ext.isString(a)){a=this.callParent(arguments);var b=this.internalDefaults;a.events?(Ext.applyIf(a.initialConfig,b),Ext.apply(a,b)):Ext.applyIf(a,b)}return a}}),Ext.define("Ext.menu.Menu",{extend:"Ext.panel.Panel",alias:"widget.menu",requires:["Ext.layout.container.Fit","Ext.layout.container.VBox","Ext.menu.CheckItem","Ext.menu.Item","Ext.menu.KeyNav","Ext.menu.Manager","Ext.menu.Separator"],allowOtherMenus:!1,ariaRole:"menu",defaultAlign:"tl-bl?",floating:!0,constrain:!0,hidden:!0,hideMode:"visibility",ignoreParentClicks:!1,isMenu:!0,showSeparator:!0,minWidth:undefined,defaultMinWidth:120,initComponent:function(){var a=this,b=Ext.baseCSSPrefix,c=[b+"menu"],d=a.bodyCls?[a.bodyCls]:[],e=a.floating!==!1;a.addEvents("click","mouseenter","mouseleave","mouseover"),Ext.menu.Manager.register(a),a.plain&&c.push(b+"menu-plain"),a.cls=c.join(" "),d.unshift(b+"menu-body"),a.bodyCls=d.join(" "),a.layout||(a.layout={type:"vbox",align:"stretchmax",overflowHandler:"Scroller"}),e&&a.minWidth===undefined&&(a.minWidth=a.defaultMinWidth),!e&&a.initialConfig.hidden!==!0&&(a.hidden=!1),a.callParent(arguments),a.on("beforeshow",function(){var b=!!a.items.length;return b&&a.rendered&&a.el.setStyle("visibility",null),b})},beforeRender:function(){this.callParent(arguments),this.getSizeModel().width.shrinkWrap||(this.layout.align="stretch")},onBoxReady:function(){var a=this,b;a.callParent(arguments);if(a.showSeparator){b={cls:Ext.baseCSSPrefix+"menu-icon-separator",html:"&#160;"};if(!Ext.isStrict&&Ext.isIE||Ext.isIE6)b.style="height:"+a.el.getHeight()+"px";a.iconSepEl=a.layout.getElementTarget().insertFirst(b)}a.mon(a.el,{click:a.onClick,mouseover:a.onMouseOver,scope:a}),a.mouseMonitor=a.el.monitorMouseLeave(100,a.onMouseLeave,a),a.keyNav=new Ext.menu.KeyNav(a)},getBubbleTarget:function(){return this.parentMenu||this.ownerButton||this.callParent(arguments)},canActivateItem:function(a){return a&&!a.isDisabled()&&a.isVisible()&&(a.canActivate||a.getXTypes().indexOf("menuitem")<0)},deactivateActiveItem:function(a){var b=this,c=b.activeItem,d=b.focusedItem;c&&(c.deactivate(),c.activated||delete b.activeItem),d&&a&&(d.blur(),delete b.focusedItem)},getFocusEl:function(){return this.focusedItem||this.el},hide:function(){this.deactivateActiveItem(!0),this.callParent(arguments)},getItemFromEvent:function(a){return this.getChildByElement(a.getTarget())},lookupComponent:function(a){var b=this;return typeof a=="string"?a=b.lookupItemFromString(a):Ext.isObject(a)&&(a=b.lookupItemFromObject(a)),a.minWidth=a.minWidth||b.minWidth,a},lookupItemFromObject:function(a){var b=this,c=Ext.baseCSSPrefix,d;return a.isComponent||(a.xtype?a=Ext.ComponentManager.create(a,a.xtype):a=Ext.create("Ext.menu."+(Ext.isBoolean(a.checked)?"Check":"")+"Item",a)),a.isMenuItem&&(a.parentMenu=b),!a.isMenuItem&&!a.dock&&(d=[c+"menu-item",c+"menu-item-cmp"],!b.plain&&(a.indent===!0||a.iconCls==="no-icon")&&d.push(c+"menu-item-indent"),a.rendered?a.el.addCls(d):a.cls=(a.cls?a.cls:"")+" "+d.join(" ")),a},lookupItemFromString:function(a){return a=="separator"||a=="-"?new Ext.menu.Separator:new Ext.menu.Item({canActivate:!1,hideOnClick:!1,plain:!0,text:a})},onClick:function(a){var b=this,c;if(b.disabled){a.stopEvent();return}c=a.type==="click"?b.getItemFromEvent(a):b.activeItem,c&&c.isMenuItem&&(!c.menu||!b.ignoreParentClicks?c.onClick(a):a.stopEvent());if(!c||c.disabled)c=undefined;b.fireEvent("click",b,c,a)},onDestroy:function(){var a=this;Ext.menu.Manager.unregister(a),delete a.parentMenu,delete a.ownerButton,a.rendered&&(a.el.un(a.mouseMonitor),a.keyNav.destroy(),delete a.keyNav),a.callParent(arguments)},onMouseLeave:function(a){var b=this;b.deactivateActiveItem();if(b.disabled)return;b.fireEvent("mouseleave",b,a)},onMouseOver:function(a){var b=this,c=a.getRelatedTarget(),d=!b.el.contains(c),e=b.getItemFromEvent(a),f=b.parentMenu,g=b.parentItem;d&&f&&(f.setActiveItem(g),g.cancelDeferHide(),f.mouseMonitor.mouseenter());if(b.disabled)return;e&&!e.activated&&(b.setActiveItem(e),e.activated&&e.expandMenu&&e.expandMenu()),d&&b.fireEvent("mouseenter",b,a),b.fireEvent("mouseover",b,e,a)},setActiveItem:function(a){var b=this;a&&a!=b.activeItem&&(b.deactivateActiveItem(),b.canActivateItem(a)&&(a.activate?(a.activate(),a.activated&&(b.activeItem=a,b.focusedItem=a,b.focus())):(a.focus(),b.focusedItem=a)),a.el.scrollIntoView(b.layout.getRenderTarget()))},showBy:function(a,b,c){var d=this;return d.floating&&a&&(d.show(),d.setPagePosition(d.el.getAlignToXY(a.el||a,b||d.defaultAlign,c)),d.setVerticalPosition()),d},show:function(){var a=this,b,c,d,e=a.maxHeight;return a.rendered||a.doAutoRender(),a.floating&&(b=Ext.fly(a.el.getScopeParent()),c=b.getViewSize().height,a.maxHeight=Math.min(e||c,c)),d=a.callParent(arguments),a.maxHeight=e,d},afterComponentLayout:function(a,b,c,d){var e=this;e.callParent(arguments),e.showSeparator&&e.iconSepEl.setHeight(e.componentLayout.lastComponentSize.contentHeight)},setVerticalPosition:function(){var a=this,b,c=a.el.getY(),d=c,e=a.getHeight(),f=Ext.Element.getViewportHeight().height,g=Ext.fly(a.el.getScopeParent()),h=g.getViewSize().height,i=c-g.getScroll().top;g=null,a.floating&&(b=a.maxHeight?a.maxHeight:h-i,e>h?d=c-i:b<e?d=c-(e-b):c+e>f&&(d=f-e)),a.el.setY(d)}}),Ext.define("Ext.menu.ColorPicker",{extend:"Ext.menu.Menu",alias:"widget.colormenu",requires:["Ext.picker.Color"],hideOnClick:!0,pickerId:null,initComponent:function(){var a=this,b=Ext.apply({},a.initialConfig);delete b.listeners,Ext.apply(a,{plain:!0,showSeparator:!1,items:Ext.applyIf({cls:Ext.baseCSSPrefix+"menu-color-item",id:a.pickerId,xtype:"colorpicker"},b)}),a.callParent(arguments),a.picker=a.down("colorpicker"),a.relayEvents(a.picker,["select"]),a.hideOnClick&&a.on("select",a.hidePickerOnSelect,a)},hidePickerOnSelect:function(){Ext.menu.Manager.hideAll()}}),Ext.define("Ext.menu.DatePicker",{extend:"Ext.menu.Menu",alias:"widget.datemenu",requires:["Ext.picker.Date"],hideOnClick:!0,pickerId:null,initComponent:function(){var a=this;Ext.apply(a,{showSeparator:!1,plain:!0,border:!1,bodyPadding:0,items:Ext.applyIf({cls:Ext.baseCSSPrefix+"menu-date-item",id:a.pickerId,xtype:"datepicker"},a.initialConfig)}),a.callParent(arguments),a.picker=a.down("datepicker"),a.relayEvents(a.picker,["select"]),a.hideOnClick&&a.on("select",a.hidePickerOnSelect,a)},hidePickerOnSelect:function(){Ext.menu.Manager.hideAll()}}),Ext.define("Ext.panel.Table",{extend:"Ext.panel.Panel",alias:"widget.tablepanel",uses:["Ext.selection.RowModel","Ext.grid.PagingScroller","Ext.grid.header.Container","Ext.grid.Lockable"],extraBaseCls:Ext.baseCSSPrefix+"grid",extraBodyCls:Ext.baseCSSPrefix+"grid-body",layout:"fit",hasView:!1,viewType:null,selType:"rowmodel",scroll:!0,deferRowRender:!0,sortableColumns:!0,enableLocking:!1,scrollerOwner:!0,enableColumnMove:!0,restrictColumnReorder:!1,enableColumnResize:!0,enableColumnHide:!0,rowLines:!0,initComponent:function(){var a=this,b=a.scroll,c=!1,d=!1,e=a.columns||a.colModel,f,g=a.border,h,i;a.columnLines&&a.addCls(Ext.baseCSSPrefix+"grid-with-col-lines"),a.rowLines&&a.addCls(Ext.baseCSSPrefix+"grid-with-row-lines"),a.store=Ext.data.StoreManager.lookup(a.store||"ext-empty-store");if(e instanceof Ext.grid.header.Container)a.headerCt=e,a.headerCt.border=g,a.columns=a.headerCt.items.items;else{Ext.isArray(e)&&(e={items:e,border:g}),Ext.apply(e,{forceFit:a.forceFit,sortable:a.sortableColumns,enableColumnMove:a.enableColumnMove,enableColumnResize:a.enableColumnResize,enableColumnHide:a.enableColumnHide,border:g,restrictReorder:a.restrictColumnReorder}),a.columns=e.items;if(a.enableLocking||Ext.ComponentQuery.query("{locked !== undefined}{processed != true}",a.columns).length)a.self.mixin("lockable",Ext.grid.Lockable),a.injectLockable()}a.scrollTask=new Ext.util.DelayedTask(a.syncHorizontalScroll,a),a.addEvents("reconfigure","viewready"),a.bodyCls=a.bodyCls||"",a.bodyCls+=" "+a.extraBodyCls,a.cls=a.cls||"",a.cls+=" "+a.extraBaseCls,delete a.autoScroll;if(!a.hasView){a.headerCt||(a.headerCt=new Ext.grid.header.Container(e)),a.columns=a.headerCt.items.items;if(a.store.buffered&&!a.store.remoteSort)for(h=0,i=a.columns.length;h<i;h++)a.columns[h].sortable=!1;a.hideHeaders&&(a.headerCt.height=0,a.headerCt.addCls(Ext.baseCSSPrefix+"grid-header-ct-hidden"),a.addCls(Ext.baseCSSPrefix+"grid-header-hidden"),Ext.isIEQuirks&&(a.headerCt.style={display:"none"})),b===!0||b==="both"?c=d=!0:b==="horizontal"?d=!0:b==="vertical"&&(c=!0),a.relayHeaderCtEvents(a.headerCt),a.features=a.features||[],Ext.isArray(a.features)||(a.features=[a.features]),a.dockedItems=[].concat(a.dockedItems||[]),a.dockedItems.unshift(a.headerCt),a.viewConfig=a.viewConfig||{},a.store&&a.store.buffered?a.viewConfig.preserveScrollOnRefresh=!0:a.invalidateScrollerOnRefresh!==undefined&&(a.viewConfig.preserveScrollOnRefresh=!a.invalidateScrollerOnRefresh),f=a.getView(),a.items=[f],a.hasView=!0,c&&a.store.buffered&&(a.verticalScroller=new Ext.grid.PagingScroller(Ext.apply({panel:a,store:a.store,view:a.view},a.verticalScroller))),d&&(a.hideHeaders||f.on({scroll:{fn:a.onHorizontalScroll,element:"el",scope:a}})),a.mon(f.store,{load:a.onStoreLoad,scope:a}),a.mon(f,{viewready:a.onViewReady,refresh:a.onRestoreHorzScroll,scope:a})}this.relayEvents(a.view,["beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","beforecontainermousedown","beforecontainermouseup","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","containermouseup","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","selectionchange","beforeselect","select","beforedeselect","deselect"]),a.callParent(arguments),a.addStateEvents(["columnresize","columnmove","columnhide","columnshow","sortchange"]),a.headerCt&&a.headerCt.on("afterlayout",a.onRestoreHorzScroll,a)},relayHeaderCtEvents:function(a){this.relayEvents(a,["columnresize","columnmove","columnhide","columnshow","sortchange"])},getState:function(){var a=this,b=a.callParent(),c=a.store.sorters.first();return b=a.addPropertyToState(b,"columns",(a.headerCt||a).getColumnsState()),c&&(b=a.addPropertyToState(b,"sort",{property:c.property,direction:c.direction,root:c.root})),b},applyState:function(a){var b=this,c=a.sort,d=b.store,e=a.columns;delete a.columns,b.callParent(arguments),e&&(b.headerCt||b).applyColumnsState(e),c&&(d.remoteSort?d.sort({property:c.property,direction:c.direction,root:c.root},null,!1):d.sort(c.property,c.direction))},getStore:function(){return this.store},getView:function(){var a=this,b;return a.view||(b=a.getSelectionModel(),a.view=Ext.widget(Ext.apply({},a.viewConfig,{grid:a,deferInitialRefresh:a.deferRowRender!==!1,scroll:a.scroll,xtype:a.viewType,store:a.store,headerCt:a.headerCt,selModel:b,features:a.features,panel:a,emptyText:a.emptyText?'<div class="'+Ext.baseCSSPrefix+'grid-empty">'+a.emptyText+"</div>":""})),a.mon(a.view,{uievent:a.processEvent,scope:a}),b.view=a.view,a.headerCt.view=a.view,a.relayEvents(a.view,["cellclick","celldblclick"])),a.view},setAutoScroll:Ext.emptyFn,processEvent:function(a,b,c,d,e,f){var g=this,h;if(e!==-1)return h=g.headerCt.getGridColumns()[e],h.processEvent.apply(h,arguments)},determineScrollbars:function(){},invalidateScroller:function(){},scrollByDeltaY:function(a,b){this.getView().scrollBy(0,a,b)},scrollByDeltaX:function(a,b){this.getView().scrollBy(a,0,b)},afterCollapse:function(){var a=this;a.saveScrollPos(),a.saveScrollPos(),a.callParent(arguments)},afterExpand:function(){var a=this;a.callParent(arguments),a.restoreScrollPos(),a.restoreScrollPos()},saveScrollPos:Ext.emptyFn,restoreScrollPos:Ext.emptyFn,onHeaderResize:function(){this.delayScroll()},onHeaderMove:function(a,b,c,d,e){var f=this;f.optimizedColumnMove===!1?f.view.refresh():f.view.moveColumn(d,e,c),f.delayScroll()},onHeaderHide:function(a,b){this.delayScroll()},onHeaderShow:function(a,b){this.delayScroll()},delayScroll:function(){var a=this.getScrollTarget().el;a&&this.scrollTask.delay(10,null,null,[a.dom.scrollLeft])},onViewReady:function(){this.fireEvent("viewready",this)},onRestoreHorzScroll:function(){var a=this.scrollLeftPos;a&&this.syncHorizontalScroll(a)},setScrollTop:function(a){var b=this,c=b.getScrollerOwner();c.virtualScrollTop=a},getScrollerOwner:function(){var a=this;return this.scrollerOwner||(a=this.up("[scrollerOwner]")),a},getLhsMarker:function(){var a=this;return a.lhsMarker||(a.lhsMarker=Ext.DomHelper.append(a.el,{cls:Ext.baseCSSPrefix+"grid-resize-marker"},!0))},getRhsMarker:function(){var a=this;return a.rhsMarker||(a.rhsMarker=Ext.DomHelper.append(a.el,{cls:Ext.baseCSSPrefix+"grid-resize-marker"},!0))},getSelectionModel:function(){this.selModel||(this.selModel={});var a="SINGLE",b;return this.simpleSelect?a="SIMPLE":this.multiSelect&&(a="MULTI"),Ext.applyIf(this.selModel,{allowDeselect:this.allowDeselect,mode:a}),this.selModel.events||(b=this.selModel.selType||this.selType,this.selModel=Ext.create("selection."+b,this.selModel)),this.selModel.hasRelaySetup||(this.relayEvents(this.selModel,["selectionchange","beforeselect","beforedeselect","select","deselect"]),this.selModel.hasRelaySetup=!0),this.disableSelection&&(this.selModel.locked=!0),this.selModel},getScrollTarget:function(){var a=this.getScrollerOwner(),b=a.query("tableview");return b[1]||b[0]},onHorizontalScroll:function(a,b){this.syncHorizontalScroll(b.scrollLeft)},syncHorizontalScroll:function(a){var b=this,c;b.rendered&&(c=b.getScrollTarget(),c.el.dom.scrollLeft=a,b.headerCt.el.dom.scrollLeft=a,b.scrollLeftPos=a)},onStoreLoad:Ext.emptyFn,getEditorParent:function(){return this.body},bindStore:function(a){var b=this;b.store=a,b.getView().bindStore(a)},beforeDestroy:function(){Ext.destroy(this.verticalScroller),this.callParent()},reconfigure:function(a,b){var c=this,d=c.headerCt;c.lockable?c.reconfigureLockable(a,b):(b&&(delete c.scrollLeftPos,d.suspendLayouts(),d.removeAll(),d.add(b)),a?(a=Ext.StoreManager.lookup(a),c.bindStore(a)):c.getView().refresh(),b&&d.resumeLayouts(!0),d.setSortState()),c.fireEvent("reconfigure",c,a,b)}}),Ext.define("Ext.tab.Panel",{extend:"Ext.panel.Panel",alias:"widget.tabpanel",alternateClassName:["Ext.TabPanel"],requires:["Ext.layout.container.Card","Ext.tab.Bar"],tabPosition:"top",removePanelHeader:!0,plain:!1,itemCls:Ext.baseCSSPrefix+"tabpanel-child",minTabWidth:undefined,maxTabWidth:undefined,deferredRender:!0,initComponent:function(){var a=this,b=[].concat(a.dockedItems||[]),c=a.activeTab||(a.activeTab=0);a.layout=new Ext.layout.container.Card(Ext.apply({owner:a,deferredRender:a.deferredRender,itemCls:a.itemCls,activeItem:a.activeTab},a.layout)),a.tabBar=new Ext.tab.Bar(Ext.apply({dock:a.tabPosition,plain:a.plain,border:a.border,cardLayout:a.layout,tabPanel:a},a.tabBar)),b.push(a.tabBar),a.dockedItems=b,a.addEvents("beforetabchange","tabchange"),a.callParent(arguments),a.activeTab=a.getComponent(c),a.activeTab&&(a.activeTab.tab.activate(!0),a.tabBar.activeTab=a.activeTab.tab)},setActiveTab:function(a){var b=this,c;a=b.getComponent(a);if(a)return c=b.getActiveTab(),c!==a&&b.fireEvent("beforetabchange",b,a,c)===!1?!1:(a.isComponent||(Ext.suspendLayouts(),a=b.add(a),Ext.resumeLayouts()),b.activeTab=a,Ext.suspendLayouts(),b.layout.setActiveItem(a),a=b.activeTab=b.layout.getActiveItem(),a&&a!==c?(b.tabBar.setActiveTab(a.tab),Ext.resumeLayouts(!0),c!==a&&b.fireEvent("tabchange",b,a,c)):Ext.resumeLayouts(!0),a)},getActiveTab:function(){var a=this,b=a.getComponent(a.activeTab);return b&&a.items.indexOf(b)!=-1?a.activeTab=b:a.activeTab=null,a.activeTab},getTabBar:function(){return this.tabBar},onAdd:function(a,b){var c=this,d=a.tabConfig||{},e={xtype:"tab",card:a,disabled:a.disabled,closable:a.closable,hidden:a.hidden&&!a.hiddenByLayout,tooltip:a.tooltip,tabBar:c.tabBar,closeText:a.closeText};d=Ext.applyIf(d,e),a.tab=c.tabBar.insert(b,d),a.on({scope:c,enable:c.onItemEnable,disable:c.onItemDisable,beforeshow:c.onItemBeforeShow,iconchange:c.onItemIconChange,iconclschange:c.onItemIconClsChange,titlechange:c.onItemTitleChange}),a.isPanel&&(c.removePanelHeader&&(a.rendered?a.header&&a.header.hide():a.header=!1),a.isPanel&&c.border&&a.setBorder(!1))},onItemEnable:function(a){a.tab.enable()},onItemDisable:function(a){a.tab.disable()},onItemBeforeShow:function(a){if(a!==this.activeTab)return this.setActiveTab(a),!1},onItemIconChange:function(a,b){a.tab.setIcon(b)},onItemIconClsChange:function(a,b){a.tab.setIconCls(b)},onItemTitleChange:function(a,b){a.tab.setText(b)},doRemove:function(a,b){var c=this,d;c.destroying||c.items.getCount()==1?c.activeTab=null:(d=c.tabBar.items.indexOf(c.tabBar.findNextActivatable(a.tab)))!==-1&&c.setActiveTab(d),this.callParent(arguments),delete a.tab.card,delete a.tab},onRemove:function(a,b){var c=this;a.un({scope:c,enable:c.onItemEnable,disable:c.onItemDisable,beforeshow:c.onItemBeforeShow}),!c.destroying&&a.tab.ownerCt===c.tabBar&&c.tabBar.remove(a.tab)}}),Ext.define("Ext.tip.Tip",{extend:"Ext.panel.Panel",alternateClassName:"Ext.Tip",minWidth:40,maxWidth:300,shadow:"sides",defaultAlign:"tl-bl?",constrainPosition:!0,autoRender:!0,hidden:!0,baseCls:Ext.baseCSSPrefix+"tip",floating:{shadow:!0,shim:!0,constrain:!0},focusOnToFront:!1,closeAction:"hide",ariaRole:"tooltip",alwaysFramed:!0,frameHeader:!1,initComponent:function(){var a=this;a.floating=Ext.apply({},{shadow:a.shadow},a.self.prototype.floating),a.callParent(arguments),a.constrain=a.constrain||a.constrainPosition},showAt:function(a){var b=this;this.callParent(arguments),b.isVisible()&&(b.setPagePosition(a[0],a[1]),(b.constrainPosition||b.constrain)&&b.doConstrain(),b.toFront(!0))},showBy:function(a,b){this.showAt(this.el.getAlignToXY(a,b||this.defaultAlign))},initDraggable:function(){var a=this;a.draggable={el:a.getDragEl(),delegate:a.header.el,constrain:a,constrainTo:a.el.getScopeParent()},Ext.Component.prototype.initDraggable.call(a)},ghost:undefined,unghost:undefined}),Ext.define("Ext.slider.Tip",{extend:"Ext.tip.Tip",minWidth:10,alias:"widget.slidertip",offsets:null,align:null,position:"",defaultVerticalPosition:"left",defaultHorizontalPosition:"top",isSliderTip:!0,init:function(a){var b=this,c,d;b.position||(b.position=a.vertical?b.defaultVerticalPosition:b.defaultHorizontalPosition);switch(b.position){case"top":d=[0,-10],c="b-t?";break;case"bottom":d=[0,10],c="t-b?";break;case"left":d=[-10,0],c="r-l?";break;case"right":d=[10,0],c="l-r?"}b.align||(b.align=c),b.offsets||(b.offsets=d),a.on({scope:b,dragstart:b.onSlide,drag:b.onSlide,dragend:b.hide,destroy:b.destroy})},onSlide:function(a,b,c){var d=this;d.show(),d.update(d.getText(c)),d.el.alignTo(c.el,d.align,d.offsets)},getText:function(a){return String(a.value)}}),Ext.define("Ext.slider.Multi",{extend:"Ext.form.field.Base",alias:"widget.multislider",alternateClassName:"Ext.slider.MultiSlider",requires:["Ext.slider.Thumb","Ext.slider.Tip","Ext.Number","Ext.util.Format","Ext.Template","Ext.layout.component.field.Slider"],childEls:["endEl","innerEl"],fieldSubTpl:['<div id="{id}" class="'+Ext.baseCSSPrefix+'slider {fieldCls} {vertical}" aria-valuemin="{minValue}" aria-valuemax="{maxValue}" aria-valuenow="{value}" aria-valuetext="{value}">','<div id="{cmpId}-endEl" class="'+Ext.baseCSSPrefix+'slider-end" role="presentation">','<div id="{cmpId}-innerEl" class="'+Ext.baseCSSPrefix+'slider-inner" role="presentation">',"{%this.renderThumbs(out, values)%}","</div>","</div>","</div>",{renderThumbs:function(a,b){var c=b.$comp,d=0,e=c.thumbs,f=e.length,g,h;for(;d<f;d++)g=e[d],h=g.getElConfig(),h.id=c.id+"-thumb-"+d,Ext.DomHelper.generateMarkup(h,a)},disableFormats:!0}],vertical:!1,minValue:0,maxValue:100,decimalPrecision:0,keyIncrement:1,increment:0,clickRange:[5,15],clickToChange:!0,animate:!0,dragging:!1,constrainThumbs:!0,componentLayout:"sliderfield",useTips:!0,tipText:null,ariaRole:"slider",initValue:function(){var a=this,b=Ext.value,c=b(a.values,[b(a.value,b(a.minValue,0))]),d=0,e=c.length;a.originalValue=c;for(;d<e;d++)a.addThumb(c[d])},initComponent:function(){var a=this,b,c,d,e,f;a.thumbs=[],a.keyIncrement=Math.max(a.increment,a.keyIncrement),a.addEvents("beforechange","change","changecomplete","dragstart","drag","dragend"),a.increment&&(a.maxValue=Ext.Number.snapInRange(a.maxValue,a.increment,a.minValue),a.value=a.normalizeValue(a.value)),a.callParent();if(a.useTips){Ext.isObject(a.useTips)?b=Ext.apply({},a.useTips):b=a.tipText?{getText:a.tipText}:{},f=a.plugins=a.plugins||[],e=f.length;for(d=0;d<e;d++)if(f[d].isSliderTip){c=!0;break}c||a.plugins.push(new Ext.slider.Tip(b))}},addThumb:function(a){var b=this,c=new Ext.slider.Thumb({ownerCt:b,ownerLayout:b.getComponentLayout(),value:a,slider:b,index:b.thumbs.length,constrain:b.constrainThumbs});return b.thumbs.push(c),b.rendered&&c.render(),c},promoteThumb:function(a){var b=this.thumbs,c=b.length,d,e,f;for(f=0;f<c;f++)e=b[f],e==a?e.bringToFront():e.sendToBack()},getSubTplData:function(){var a=this;return Ext.apply(a.callParent(),{$comp:a,vertical:a.vertical?Ext.baseCSSPrefix+"slider-vert":Ext.baseCSSPrefix+"slider-horz",minValue:a.minValue,maxValue:a.maxValue,value:a.value})},onRender:function(){var a=this,b=a.thumbs,c=b.length,d=0,e;a.callParent(arguments);for(d=0;d<c;d++)e=b[d],e.el=a.el.getById(a.id+"-thumb-"+d),e.onRender()},initEvents:function(){var a=this;a.mon(a.el,{scope:a,mousedown:a.onMouseDown,keydown:a.onKeyDown})},getTrackpoint:function(a){var b=this,c,d,e=b.innerEl,f;return b.vertical?(d="top",f=e.getHeight()):(d="left",f=e.getWidth()),c=Ext.Number.constrain(e.translatePoints(a)[d],0,f),b.vertical?f-c:c},onMouseDown:function(a){var b=this,c=!1,d=0,e=b.thumbs,f=e.length,g;if(b.disabled)return;for(;d<f;d++)c=c||a.target==e[d].el.dom;b.clickToChange&&!c&&(g=b.getTrackpoint(a.getXY()),g!==undefined&&b.onClickChange(g)),b.focus()},onClickChange:function(a){var b=this,c,d;c=b.getNearest(a),c.disabled||(d=c.index,b.setValue(d,Ext.util.Format.round(b.reversePixelValue(a),b.decimalPrecision),undefined,!0))},getNearest:function(a){var b=this,c=b.reversePixelValue(a),d=b.maxValue-b.minValue+5,e=null,f=b.thumbs,g=0,h=f.length,i,j,k;for(;g<h;g++)i=b.thumbs[g],j=i.value,k=Math.abs(j-c),Math.abs(k<=d)&&(e=i,d=k);return e},onKeyDown:function(a){var b=this,c,d;if(b.disabled||b.thumbs.length!==1){a.preventDefault();return}c=a.getKey();switch(c){case a.UP:case a.RIGHT:a.stopEvent(),d=a.ctrlKey?b.maxValue:b.getValue(0)+b.keyIncrement,b.setValue(0,d,undefined,!0);break;case a.DOWN:case a.LEFT:a.stopEvent(),d=a.ctrlKey?b.minValue:b.getValue(0)-b.keyIncrement,b.setValue(0,d,undefined,!0);break;default:a.preventDefault()}},normalizeValue:function(a){var b=this,c=Ext.Number,d=c[b.zeroBasedSnapping?"snap":"snapInRange"];return a=d.call(c,a,b.increment,b.minValue,b.maxValue),a=Ext.util.Format.round(a,b.decimalPrecision),a=Ext.Number.constrain(a,b.minValue,b.maxValue),a},setMinValue:function(a){var b=this,c=0,d=b.thumbs,e=d.length,f;b.minValue=a,b.rendered&&b.inputEl.dom.setAttribute("aria-valuemin",a);for(;c<e;++c)f=d[c],f.value=f.value<a?a:f.value;b.syncThumbs()},setMaxValue:function(a){var b=this,c=0,d=b.thumbs,e=d.length,f;b.maxValue=a,b.rendered&&b.inputEl.dom.setAttribute("aria-valuemax",a);for(;c<e;++c)f=d[c],f.value=f.value>a?a:f.value;b.syncThumbs()},setValue:function(a,b,c,d){var e=this,f=e.thumbs[a];b=e.normalizeValue(b),b!==f.value&&e.fireEvent("beforechange",e,b,f.value,f)!==!1&&(f.value=b,e.rendered&&(e.inputEl.set({"aria-valuenow":b,"aria-valuetext":b}),f.move(e.calculateThumbPosition(b),Ext.isDefined(c)?c!==!1:e.animate),e.fireEvent("change",e,b,f),e.checkDirty(),d&&e.fireEvent("changecomplete",e,b,f)))},calculateThumbPosition:function(a){return(a-this.minValue)/(this.maxValue-this.minValue)*100},getRatio:function(){var a=this,b=this.vertical?this.innerEl.getHeight():this.innerEl.getWidth(),c=this.maxValue-this.minValue;return c===0?b:b/c},reversePixelValue:function(a){return this.minValue+a/this.getRatio()},reversePercentageValue:function(a){return this.minValue+(this.maxValue-this.minValue)*(a/100)},onDisable:function(){var a=this,b=0,c=a.thumbs,d=c.length,e,f,g;a.callParent();for(;b<d;b++)e=c[b],f=e.el,e.disable(),Ext.isIE&&(g=f.getXY(),f.hide(),a.innerEl.addCls(a.disabledCls).dom.disabled=!0,a.thumbHolder||(a.thumbHolder=a.endEl.createChild({cls:Ext.baseCSSPrefix+"slider-thumb "+a.disabledCls})),a.thumbHolder.show().setXY(g))},onEnable:function(){var a=this,b=0,c=a.thumbs,d=c.length,e,f;this.callParent();for(;b<d;b++)e=c[b],f=e.el,e.enable(),Ext.isIE&&(a.innerEl.removeCls(a.disabledCls).dom.disabled=!1,a.thumbHolder&&a.thumbHolder.hide(),f.show(),a.syncThumbs())},syncThumbs:function(){if(this.rendered){var a=this.thumbs,b=a.length,c=0;for(;c<b;c++)a[c].move(this.calculateThumbPosition(a[c].value))}},getValue:function(a){return Ext.isNumber(a)?this.thumbs[a].value:this.getValues()},getValues:function(){var a=[],b=0,c=this.thumbs,d=c.length;for(;b<d;b++)a.push(c[b].value);return a},getSubmitValue:function(){var a=this;return a.disabled||!a.submitValue?null:a.getValue()},reset:function(){var a=this,b=[].concat(a.originalValue),c=0,d=b.length,e;for(;c<d;c++)e=b[c],a.setValue(c,e);a.clearInvalid(),delete a.wasValid},beforeDestroy:function(){var a=this,b=a.thumbs,c=0,d=b.length,e;Ext.destroy(a.innerEl,a.endEl,a.focusEl);for(;c<d;c++)e=b[c],Ext.destroy(e);a.callParent()}}),Ext.define("Ext.slider.Single",{extend:"Ext.slider.Multi",alias:["widget.slider","widget.sliderfield"],alternateClassName:["Ext.Slider","Ext.form.SliderField","Ext.slider.SingleSlider","Ext.slider.Slider"],getValue:function(){return this.callParent([0])},setValue:function(a,b){var c=arguments,d=c.length;if(d==1||d<=3&&typeof c[1]!="number")c=Ext.toArray(c),c.unshift(0);return this.callParent(c)},getNearest:function(){return this.thumbs[0]}}),Ext.define("Ext.tip.ToolTip",{extend:"Ext.tip.Tip",alias:"widget.tooltip",alternateClassName:"Ext.ToolTip",autoHide:!0,showDelay:500,hideDelay:200,dismissDelay:5e3,trackMouse:!1,anchorToTarget:!0,anchorOffset:0,targetCounter:0,quickShowInterval:250,initComponent:function(){var a=this;a.callParent(arguments),a.lastActive=new Date,a.setTarget(a.target),a.origAnchor=a.anchor},onRender:function(a,b){var c=this;c.callParent(arguments),c.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+c.getAnchorPosition(),c.anchorEl=c.el.createChild({cls:Ext.baseCSSPrefix+"tip-anchor "+c.anchorCls})},setTarget:function(a){var b=this,c=Ext.get(a),d;b.target&&(d=Ext.get(b.target),b.mun(d,"mouseover",b.onTargetOver,b),b.mun(d,"mouseout",b.onTargetOut,b),b.mun(d,"mousemove",b.onMouseMove,b)),b.target=c,c&&b.mon(c,{freezeEvent:!0,mouseover:b.onTargetOver,mouseout:b.onTargetOut,mousemove:b.onMouseMove,scope:b}),b.anchor&&(b.anchorTarget=b.target)},onMouseMove:function(a){var b=this,c=b.delegate?a.getTarget(b.delegate):b.triggerElement=!0,d;c?(b.targetXY=a.getXY(),c===b.triggerElement?!b.hidden&&b.trackMouse&&(d=b.getTargetXY(),b.constrainPosition&&(d=b.el.adjustForConstraints(d,b.el.getScopeParent())),b.setPagePosition(d)):(b.hide(),b.lastActive=new Date(0),b.onTargetOver(a))):!b.closable&&b.isVisible()&&b.autoHide!==!1&&b.hide()},getTargetXY:function(){var a=this,b,c,d,e,f,g,h,i,j,k,l,m;a.delegate&&(a.anchorTarget=a.triggerElement);if(a.anchor){a.targetCounter++,c=a.getOffsets(),d=a.anchorToTarget&&!a.trackMouse?a.el.getAlignToXY(a.anchorTarget,a.getAnchorAlign()):a.targetXY,e=Ext.Element.getViewWidth()-5,f=Ext.Element.getViewHeight()-5,g=document.documentElement,h=document.body,i=(g.scrollLeft||h.scrollLeft||0)+5,j=(g.scrollTop||h.scrollTop||0)+5,k=[d[0]+c[0],d[1]+c[1]],l=a.getSize(),m=a.constrainPosition,a.anchorEl.removeCls(a.anchorCls);if(a.targetCounter<2&&m){if(k[0]<i)return a.anchorToTarget&&(a.defaultAlign="l-r",a.mouseOffset&&(a.mouseOffset[0]*=-1)),a.anchor="left",a.getTargetXY();if(k[0]+l.width>e)return a.anchorToTarget&&(a.defaultAlign="r-l",a.mouseOffset&&(a.mouseOffset[0]*=-1)),a.anchor="right",a.getTargetXY();if(k[1]<j)return a.anchorToTarget&&(a.defaultAlign="t-b",a.mouseOffset&&(a.mouseOffset[1]*=-1)),a.anchor="top",a.getTargetXY();if(k[1]+l.height>f)return a.anchorToTarget&&(a.defaultAlign="b-t",a.mouseOffset&&(a.mouseOffset[1]*=-1)),a.anchor="bottom",a.getTargetXY()}return a.anchorCls=Ext.baseCSSPrefix+"tip-anchor-"+a.getAnchorPosition(),a.anchorEl.addCls(a.anchorCls),a.targetCounter=0,k}return b=a.getMouseOffset(),a.targetXY?[a.targetXY[0]+b[0],a.targetXY[1]+b[1]]:b},getMouseOffset:function(){var a=this,b=a.anchor?[0,0]:[15,18];return a.mouseOffset&&(b[0]+=a.mouseOffset[0],b[1]+=a.mouseOffset[1]),b},getAnchorPosition:function(){var a=this,b;a.anchor?a.tipAnchor=a.anchor.charAt(0):(b=a.defaultAlign.match(/^([a-z]+)-([a-z]+)(\?)?$/),a.tipAnchor=b[1].charAt(0));switch(a.tipAnchor){case"t":return"top";case"b":return"bottom";case"r":return"right"}return"left"},getAnchorAlign:function(){switch(this.anchor){case"top":return"tl-bl";case"left":return"tl-tr";case"right":return"tr-tl";default:return"bl-tl"}},getOffsets:function(){var a=this,b,c,d=a.getAnchorPosition().charAt(0);if(a.anchorToTarget&&!a.trackMouse)switch(d){case"t":c=[0,9];break;case"b":c=[0,-13];break;case"r":c=[-13,0];break;default:c=[9,0]}else switch(d){case"t":c=[-15-a.anchorOffset,30];break;case"b":c=[-19-a.anchorOffset,-13-a.el.dom.offsetHeight];break;case"r":c=[-15-a.el.dom.offsetWidth,-13-a.anchorOffset];break;default:c=[25,-13-a.anchorOffset]}return b=a.getMouseOffset(),c[0]+=b[0],c[1]+=b[1],c},onTargetOver:function(a){var b=this,c;if(b.disabled||a.within(b.target.dom,!0))return;c=a.getTarget(b.delegate),c&&(b.triggerElement=c,b.clearTimer("hide"),b.targetXY=a.getXY(),b.delayShow())},delayShow:function(){var a=this;a.hidden&&!a.showTimer?Ext.Date.getElapsed(a.lastActive)<a.quickShowInterval?a.show():a.showTimer=Ext.defer(a.show,a.showDelay,a):!a.hidden&&a.autoHide!==!1&&a.show()},onTargetOut:function(a){var b=this;if(b.disabled||a.within(b.target.dom,!0))return;b.clearTimer("show"),b.autoHide!==!1&&b.delayHide()},delayHide:function(){var a=this;!a.hidden&&!a.hideTimer&&(a.hideTimer=Ext.defer(a.hide,a.hideDelay,a))},hide:function(){var a=this;a.clearTimer("dismiss"),a.lastActive=new Date,a.anchorEl&&a.anchorEl.hide(),a.callParent(arguments),delete a.triggerElement},show:function(){var a=this;this.callParent(),this.hidden===!1&&(a.setPagePosition(-1e4,-1e4),a.anchor&&(a.anchor=a.origAnchor),a.calledFromShowAt||a.showAt(a.getTargetXY()),a.anchor?(a.syncAnchor(),a.anchorEl.show()):a.anchorEl.hide())},showAt:function(a){var b=this;b.lastActive=new Date,b.clearTimers(),b.calledFromShowAt=!0,b.isVisible()||this.callParent(arguments),b.isVisible()&&(b.setPagePosition(a[0],a[1]),(b.constrainPosition||b.constrain)&&b.doConstrain(),b.toFront(!0),b.el.sync(!0),b.dismissDelay&&b.autoHide!==!1&&(b.dismissTimer=Ext.defer(b.hide,b.dismissDelay,b)),b.anchor?(b.syncAnchor(),b.anchorEl.isVisible()||b.anchorEl.show()):b.anchorEl.hide()),delete b.calledFromShowAt},syncAnchor:function(){var a=this,b,c,d;switch(a.tipAnchor.charAt(0)){case"t":b="b",c="tl",d=[20+a.anchorOffset,1];break;case"r":b="l",c="tr",d=[-1,12+a.anchorOffset];break;case"b":b="t",c="bl",d=[20+a.anchorOffset,-1];break;default:b="r",c="tl",d=[1,12+a.anchorOffset]}a.anchorEl.alignTo(a.el,b+"-"+c,d),a.anchorEl.setStyle("z-index",parseInt(a.el.getZIndex(),10)||1).setVisibilityMode(Ext.Element.DISPLAY)},setPagePosition:function(a,b){var c=this;c.callParent(arguments),c.anchor&&c.syncAnchor()},clearTimer:function(a){a+="Timer",clearTimeout(this[a]),delete this[a]},clearTimers:function(){var a=this;a.clearTimer("show"),a.clearTimer("dismiss"),a.clearTimer("hide")},onShow:function(){var a=this;a.callParent(),a.mon(Ext.getDoc(),"mousedown",a.onDocMouseDown,a)},onHide:function(){var a=this;a.callParent(),a.mun(Ext.getDoc(),"mousedown",a.onDocMouseDown,a)},onDocMouseDown:function(a){var b=this;!b.closable&&!a.within(b.el.dom)&&(b.disable(),Ext.defer(b.doEnable,100,b))},doEnable:function(){this.isDestroyed||this.enable()},onDisable:function(){this.callParent(),this.clearTimers(),this.hide()},beforeDestroy:function(){var a=this;a.clearTimers(),Ext.destroy(a.anchorEl),delete a.anchorEl,delete a.target,delete a.anchorTarget,delete a.triggerElement,a.callParent()},onDestroy:function(){Ext.getDoc().un("mousedown",this.onDocMouseDown,this),this.callParent()}}),Ext.define("Ext.chart.Tip",{requires:["Ext.tip.ToolTip","Ext.chart.TipSurface"],constructor:function(a){var b=this,c,d,e;a.tips&&(b.tipTimeout=null,b.tipConfig=Ext.apply({},a.tips,{renderer:Ext.emptyFn,constrainPosition:!0,autoHide:!0}),b.tooltip=new Ext.tip.ToolTip(b.tipConfig),b.chart.surface.on("mousemove",b.tooltip.onMouseMove,b.tooltip),b.chart.surface.on("mouseleave",function(){b.hideTip()}),b.tipConfig.surface&&(c=b.tipConfig.surface,d=c.sprites,e=new Ext.chart.TipSurface({id:"tipSurfaceComponent",sprites:d}),c.width&&c.height&&e.setSize(c.width,c.height),b.tooltip.add(e),b.spriteTip=e))},showTip:function(a){var b=this,c,d,e,f,g,h,i,j,k,l;if(!b.tooltip)return;clearTimeout(b.tipTimeout),c=b.tooltip,d=b.spriteTip,e=b.tipConfig,f=c.trackMouse,f||(c.trackMouse=!0,g=a.sprite,h=g.surface,i=Ext.get(h.getId()),i&&(j=i.getXY(),k=j[0]+(g.attr.x||0)+(g.attr.translation&&g.attr.translation.x||0),l=j[1]+(g.attr.y||0)+(g.attr.translation&&g.attr.translation.y||0),c.targetXY=[k,l])),d?e.renderer.call(c,a.storeItem,a,d.surface):e.renderer.call(c,a.storeItem,a),c.show(),c.trackMouse=f},hideTip:function(a){var b=this.tooltip;if(!b)return;clearTimeout(this.tipTimeout),this.tipTimeout=setTimeout(function(){b.hide()},0)}}),Ext.define("Ext.chart.series.Series",{mixins:{observable:"Ext.util.Observable",labels:"Ext.chart.Label",highlights:"Ext.chart.Highlight",tips:"Ext.chart.Tip",callouts:"Ext.chart.Callout"},type:null,title:null,showInLegend:!0,renderer:function(a,b,c,d,e){return c},shadowAttributes:null,triggerAfterDraw:!1,constructor:function(a){var b=this;a&&Ext.apply(b,a),b.shadowGroups=[],b.mixins.labels.constructor.call(b,a),b.mixins.highlights.constructor.call(b,a),b.mixins.tips.constructor.call(b,a),b.mixins.callouts.constructor.call(b,a),b.addEvents({scope:b,itemmouseover:!0,itemmouseout:!0,itemmousedown:!0,itemmouseup:!0,mouseleave:!0,afterdraw:!0,titlechange:!0}),b.mixins.observable.constructor.call(b,a),b.on({scope:b,itemmouseover:b.onItemMouseOver,itemmouseout:b.onItemMouseOut,mouseleave:b.onMouseLeave}),b.style&&Ext.apply(b.seriesStyle,b.style)},eachRecord:function(a,b){var c=this.chart;(c.substore||c.store).each(a,b)},getRecordCount:function(){var a=this.chart,b=a.substore||a.store;return b?b.getCount():0},isExcluded:function(a){var b=this.__excludes;return!!b&&!!b[a]},setBBox:function(a){var b=this,c=b.chart,d=c.chartBBox,e=a?0:c.maxGutter[0],f=a?0:c.maxGutter[1],g,h;g={x:d.x,y:d.y,width:d.width,height:d.height},b.clipBox=g,h={x:g.x+e-c.zoom.x*c.zoom.width,y:g.y+f-c.zoom.y*c.zoom.height,width:(g.width-e*2)*c.zoom.width,height:(g.height-f*2)*c.zoom.height},b.bbox=h},onAnimate:function(a,b){var c=this;return a.stopAnimation(),c.triggerAfterDraw?a.animate(Ext.applyIf(b,c.chart.animate)):(c.triggerAfterDraw=!0,a.animate(Ext.apply(Ext.applyIf(b,c.chart.animate),{listeners:{afteranimate:function(){c.triggerAfterDraw=!1,c.fireEvent("afterrender")}}})))},getGutters:function(){return[0,0]},onItemMouseOver:function(a){var b=this;a.series===b&&(b.highlight&&b.highlightItem(a),b.tooltip&&b.showTip(a))},onItemMouseOut:function(a){var b=this;a.series===b&&(b.unHighlightItem(),b.tooltip&&b.hideTip(a))},onMouseLeave:function(){var a=this;a.unHighlightItem(),a.tooltip&&a.hideTip()},getItemForPoint:function(a,b){if(!this.items||!this.items.length||this.seriesIsHidden)return null;var c=this,d=c.items,e=c.bbox,f,g,h;if(!Ext.draw.Draw.withinBox(a,b,e))return null;for(g=0,h=d.length;g<h;g++)if(d[g]&&this.isItemInPoint(a,b,d[g],g))return d[g];return null},isItemInPoint:function(a,b,c,d){return!1},hideAll:function(){var a=this,b=a.items,c,d,e,f,g,h,i;a.seriesIsHidden=!0,a._prevShowMarkers=a.showMarkers,a.showMarkers=!1,a.hideLabels(0);for(e=0,d=b.length;e<d;e++){c=b[e],h=c.sprite,h&&h.setAttributes({hidden:!0},!0);if(h&&h.shadows){i=h.shadows;for(f=0,g=i.length;f<g;++f)i[f].setAttributes({hidden:!0},!0)}}},showAll:function(){var a=this,b=a.chart.animate;a.chart.animate=!1,a.seriesIsHidden=!1,a.showMarkers=a._prevShowMarkers,a.drawSeries(),a.chart.animate=b},hide:function(){if(this.items){var a=this,b=a.items,c,d,e,f,g;if(b&&b.length){for(c=0,f=b.length;c<f;++c)if(b[c].sprite){b[c].sprite.hide(!0),g=b[c].shadows||b[c].sprite.shadows;if(g)for(d=0,e=g.length;d<e;++d)g[d].hide(!0)}a.hideLabels()}}},getLegendColor:function(a){var b=this,c,d;if(b.seriesStyle){c=b.seriesStyle.fill,d=b.seriesStyle.stroke;if(c&&c!="none")return c;if(d)return d}return b.colorArrayStyle?b.colorArrayStyle[b.seriesIdx%b.colorArrayStyle.length]:"#000"},visibleInLegend:function(a){var b=this.__excludes;return b?!b[a]:!this.seriesIsHidden},setTitle:function(a,b){var c=this,d=c.title;Ext.isString(a)&&(b=a,a=0),Ext.isArray(d)?d[a]=b:c.title=b,c.fireEvent("titlechange",b,a)}}),Ext.define("Ext.chart.series.Cartesian",{extend:"Ext.chart.series.Series",alternateClassName:["Ext.chart.CartesianSeries","Ext.chart.CartesianChart"],xField:null,yField:null,axis:"left",getLegendLabels:function(){var a=this,b=[],c,d,e,f=a.combinations,g,h,i,j;c=[].concat(a.yField);for(d=0,e=c.length;d<e;d++)g=a.title,b.push((Ext.isArray(g)?g[d]:g)||c[d]);if(f){f=Ext.Array.from(f);for(d=0,e=f.length;d<e;d++)h=f[d],i=b[h[0]],j=b[h[1]],b[h[1]]=i+" & "+j,b.splice(h[0],1)}return b},eachYValue:function(a,b,c){var d=this,e=d.getYValueAccessors(),f,g,h;for(f=0,g=e.length;f<g;f++)h=e[f],b.call(c,h(a),f)},getYValueCount:function(){return this.getYValueAccessors().length},combine:function(a,b){var c=this,d=c.getYValueAccessors(),e=d[a],f=d[b];d[b]=function(a){return e(a)+f(a)},d.splice(a,1),c.callParent([a,b])},clearCombinations:function(){delete this.yValueAccessors,this.callParent()},getYValueAccessors:function(){var a=this,b=a.yValueAccessors,c,d,e,f;if(!b){b=a.yValueAccessors=[],c=[].concat(a.yField);for(e=0,f=c.length;e<f;e++)d=c[e],b.push(function(a){return a.get(d)})}return b},getMinMaxXValues:function(){var a=this,b=a.chart,c=b.getChartStore(),d=c.data.items,e,f,g,h,i,j=a.xField,k;if(a.getRecordCount()>0){h=Infinity,i=-h;for(e=0,f=d.length;e<f;e++)g=d[e],k=g.get(j),k>i&&(i=k),k<h&&(h=k)}else h=i=0;return[h,i]},getMinMaxYValues:function(){function m(b,c){a.isExcluded(c)||(b<0?l+=b:k+=b)}function n(b,c){a.isExcluded(c)||(b>j&&(j=b),b<i&&(i=b))}var a=this,b=a.chart,c=b.getChartStore(),d=c.data.items,e,f,g,h=a.stacked,i,j,k,l;if(a.getRecordCount()>0){i=Infinity,j=-i;for(e=0,f=d.length;e<f;e++)g=d[e],h?(k=0,l=0,a.eachYValue(g,m),k>j&&(j=k),l<i&&(i=l)):a.eachYValue(g,n)}else i=j=0;return[i,j]},getAxesForXAndYFields:function(){var a=this,b=a.chart.axes,c=[].concat(a.axis),d={},e=[].concat(a.yField),f={},g=[].concat(a.xField),h,i,j,k,l,m;m=a.type==="bar"&&a.column===!1,m&&(h=e,e=g,g=h);if(Ext.Array.indexOf(c,"top")>-1)i="top";else if(Ext.Array.indexOf(c,"bottom")>-1)i="bottom";else if(b.get("top")&&b.get("bottom")){for(k=0,l=g.length;k<l;k++)f[g[k]]=!0;h=[].concat(b.get("bottom").fields);for(k=0,l=h.length;k<l;k++)if(f[h[k]]){i="bottom";break}h=[].concat(b.get("top").fields);for(k=0,l=h.length;k<l;k++)if(f[h[k]]){i="top";break}}else b.get("top")?i="top":b.get("bottom")&&(i="bottom");if(Ext.Array.indexOf(c,"left")>-1)j="left";else if(Ext.Array.indexOf(c,"right")>-1)j="right";else if(b.get("left")&&b.get("right")){for(k=0,l=e.length;k<l;k++)d[e[k]]=!0;h=[].concat(b.get("right").fields);for(k=0,l=h.length;k<l;k++)if(d[h[k]])break;h=[].concat(b.get("left").fields);for(k=0,l=h.length;k<l;k++)if(d[h[k]]){j="left";break}}else b.get("left")?j="left":b.get("right")&&(j="right");return m?{xAxis:j,yAxis:i}:{xAxis:i,yAxis:j}}}),Ext.define("Ext.chart.series.Area",{extend:"Ext.chart.series.Cartesian",alias:"series.area",requires:["Ext.chart.axis.Axis","Ext.draw.Color","Ext.fx.Anim"],type:"area",stacked:!0,style:{},constructor:function(a){this.callParent(arguments);var b=this,c=b.chart.surface,d,e;a.highlightCfg=Ext.Object.merge({},{lineWidth:3,stroke:"#55c",opacity:.8,color:"#f00"},a.highlightCfg),Ext.apply(b,a,{__excludes:[]}),b.highlight&&(b.highlightSprite=c.add({type:"path",path:["M",0,0],zIndex:1e3,opacity:.3,lineWidth:5,hidden:!0,stroke:"#444"})),b.group=c.getGroup(b.seriesId)},shrink:function(a,b,c){var d=a.length,e=Math.floor(d/c),f,g,h=0,i=this.areas.length,j=[],k=[],l=[];for(g=0;g<i;++g)j[g]=0;for(f=0;f<d;++f){h+=+a[f];for(g=0;g<i;++g)j[g]+=+b[f][g];if(f%e==0){k.push(h/e);for(g=0;g<i;++g)j[g]/=e;l.push(j),h=0;for(g=0,j=[];g<i;++g)j[g]=0}}return{x:k,y:l}},getBounds:function(){var a=this,b=a.chart,c=b.getChartStore(),d=c.data.items,e,f,g,h=[].concat(a.yField),i=h.length,j=[],k=[],l=Infinity,m=l,n=l,o=-l,p=-l,q=Math,r=q.min,s=q.max,t=a.getAxesForXAndYFields(),u=t.xAxis,v=t.yAxis,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;a.setBBox(),y=a.bbox;if(J=b.axes.get(u))J.type==="Time"&&(x=!0),w=J.applyData(),m=w.from,o=w.to;if(J=b.axes.get(v))w=J.applyData(),n=w.from,p=w.to;a.xField&&!Ext.isNumber(m)&&(J=a.getMinMaxXValues(),x=!0,m=J[0],o=J[1]),a.yField&&!Ext.isNumber(n)&&(J=a.getMinMaxYValues(),n=J[0],p=J[1]),Ext.isNumber(n)||(n=0),Ext.isNumber(p)||(p=0);for(e=0,f=d.length;e<f;e++){g=d[e],B=g.get(a.xField),C=[],typeof B!="number"&&(x?B=+B:B=e),j.push(B),E=0;for(D=0;D<i;D++){if(a.__excludes[D])continue;I=g.get(h[D]),typeof I=="number"&&(n=r(n,I),C.push(I),E+=I)}m=r(m,B),o=s(o,B),p=s(p,E),k.push(C)}return z=y.width/(o-m||1),A=y.height/(p-n||1),F=j.length,F>y.width&&a.areas&&(G=a.shrink(j,k,y.width),j=G.x,k=G.y),{bbox:y,minX:m,minY:n,xValues:j,yValues:k,xScale:z,yScale:A,areasLen:i}},getPaths:function(){var a=this,b=a.chart,c=b.getChartStore(),d=!0,e=a.getBounds(),f=e.bbox,g=a.items=[],h=[],i,j=0,k=[],l,m,n,o,p,q,r,s,t,u,v;m=e.xValues.length;for(l=0;l<m;l++){p=e.xValues[l],q=e.yValues[l],n=f.x+(p-e.minX)*e.xScale,r=0,j=0;for(s=0;s<e.areasLen;s++){if(a.__excludes[s])continue;h[s]||(h[s]=[]),u=q[j],r+=u,o=f.y+f.height-(r-e.minY)*e.yScale,k[s]?(k[s].push("L",n,o),h[s].push(["L",n,o])):(k[s]=["M",n,o],h[s].push(["L",n,o])),g[s]||(g[s]={pointsUp:[],pointsDown:[],series:a}),g[s].pointsUp.push([n,o]),j++}}for(s=0;s<e.areasLen;s++){if(a.__excludes[s])continue;v=k[s];if(s==0||d)d=!1,v.push("L",n,f.y+f.height,"L",f.x,f.y+f.height,"Z");else{i=h[t],i.reverse(),v.push("L",n,i[0][2]);for(l=0;l<m;l++)v.push(i[l][0],i[l][1],i[l][2]),g[s].pointsDown[m-l-1]=[i[l][1],i[l][2]];v.push("L",f.x,v[2],"Z")}t=s}return{paths:k,areasLen:e.areasLen}},drawSeries:function(){var a=this,b=a.chart,c=b.getChartStore(),d=b.surface,e=b.animate,f=a.group,g=Ext.apply(a.seriesStyle,a.style),h=a.colorArrayStyle,i=h&&h.length||0,j,k,l,m,n;a.unHighlightItem(),a.cleanHighlights();if(!c||!c.getCount()||a.seriesIsHidden){a.hide(),a.items=[];return}l=a.getPaths(),a.areas||(a.areas=[]);for(j=0;j<l.areasLen;j++){if(a.__excludes[j])continue;a.areas[j]||(a.items[j].sprite=a.areas[j]=d.add(Ext.apply({},{type:"path",group:f,path:l.paths[j],stroke:g.stroke||h[j%i],fill:h[j%i]},g||{}))),k=a.areas[j],m=l.paths[j],e?(n=a.renderer(k,!1,{path:m,fill:h[j%i],stroke:g.stroke||h[j%i]},j,c),a.animation=a.onAnimate(k,{to:n})):(n=a.renderer(k,!1,{path:m,hidden:!1,fill:h[j%i],stroke:g.stroke||h[j%i]},j,c),a.areas[j].setAttributes(n,!0))}a.renderLabels(),a.renderCallouts()},onAnimate:function(a,b){return a.show(),this.callParent(arguments)},onCreateLabel:function(a,b,c,d){var e=this,f=e.labelsGroup,g=e.label,h=e.bbox,i=Ext.apply(g,e.seriesLabelStyle);return e.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:f,x:b.point[0],y:h.y+h.height/2},i||{}))},onPlaceLabel:function(a,b,c,d,e,f,g){var h=this,i=h.chart,j=i.resizing,k=h.label,l=k.renderer,m=k.field,n=h.bbox,o=c.point[0],p=c.point[1],q,r,s;a.setAttributes({text:l(b.get(m[g])),hidden:!0},!0),q=a.getBBox(),r=q.width/2,s=q.height/2,o=o-r<n.x?n.x+r:o,o=o+r>n.x+n.width?o-(o+r-n.x-n.width):o,p=p-s<n.y?n.y+s:p,p=p+s>n.y+n.height?p-(p+s-n.y-n.height):p,h.chart.animate&&!h.chart.resizing?(a.show(!0),h.onAnimate(a,{to:{x:o,y:p}})):(a.setAttributes({x:o,y:p},!0),j?h.animation.on("afteranimate",function(){a.show(!0)}):a.show(!0))},onPlaceCallout:function(a,b,c,d,e,f,g){var h=this,i=h.chart,j=i.surface,k=i.resizing,l=h.callouts,m=h.items,n=d==0?!1:m[d-1].point,o=d==m.length-1?!1:m[d+1].point,p=c.point,q,r,s,t,u,v,w=a.label.getBBox(),x=30,y=10,z=3,A,B,C,D,E,F=h.clipRect,G,H;n||(n=p),o||(o=p),t=(o[1]-n[1])/(o[0]-n[0]),u=(p[1]-n[1])/(p[0]-n[0]),v=(o[1]-p[1])/(o[0]-p[0]),r=Math.sqrt(1+t*t),q=[1/r,t/r],s=[-q[1],q[0]];if(u>0&&v<0&&s[1]<0||u<0&&v>0&&s[1]>0)s[0]*=-1,s[1]*=-1;else if(Math.abs(u)<Math.abs(v)&&s[0]<0||Math.abs(u)>Math.abs(v)&&s[0]>0)s[0]*=-1,s[1]*=-1;G=p[0]+s[0]*x,H=p[1]+s[1]*x,A=G+(s[0]>0?0:-(w.width+2*z)),B=H-w.height/2-z,C=w.width+2*z,D=w.height+2*z;if(A<F[0]||A+C>F[0]+F[2])s[0]*=-1;if(B<F[1]||B+D>F[1]+F[3])s[1]*=-1;G=p[0]+s[0]*x,H=p[1]+s[1]*x,A=G+(s[0]>0?0:-(w.width+2*z)),B=H-w.height/2-z,C=w.width+2*z,D=w.height+2*z,a.lines.setAttributes({path:["M",p[0],p[1],"L",G,H,"Z"]},!0),a.box.setAttributes({x:A,y:B,width:C,height:D},!0),a.label.setAttributes({x:G+(s[0]>0?z:-(w.width+z)),y:H},!0);for(E in a)a[E].show(!0)},isItemInPoint:function(a,b,c,d){var e=this,f=c.pointsUp,g=c.pointsDown,h=Math.abs,i=!1,j=!1,k=Infinity,l,m,n;for(l=0,m=f.length;l<m;l++){n=[f[l][0],f[l][1]],i=!1,j=l==m-1,k>h(a-n[0])&&(k=h(a-n[0]),i=!0,j&&++l);if(!i||i&&j){n=f[l-1];if(b>=n[1]&&(!g.length||b<=g[l-1][1]))return c.storeIndex=l-1,c.storeField=e.yField[d],c.storeItem=e.chart.store.getAt(l-1),c._points=g.length?[n,g[l-1]]:[n],!0;break}}return!1},highlightSeries:function(){var a,b,c;this._index!==undefined&&(a=this.areas[this._index],a.__highlightAnim&&(a.__highlightAnim.paused=!0),a.__highlighted=!0,a.__prevOpacity=a.__prevOpacity||a.attr.opacity||1,a.__prevFill=a.__prevFill||a.attr.fill,a.__prevLineWidth=a.__prevLineWidth||a.attr.lineWidth,c=Ext.draw.Color.fromString(a.__prevFill),b={lineWidth:(a.__prevLineWidth||0)+2},c?b.fill=c.getLighter(.2).toString():b.opacity=Math.max(a.__prevOpacity-.3,0),this.chart.animate?a.__highlightAnim=new Ext.fx.Anim(Ext.apply({target:a,to:b},this.chart.animate)):a.setAttributes(b,!0))},unHighlightSeries:function(){var a;this._index!==undefined&&(a=this.areas[this._index],a.__highlightAnim&&(a.__highlightAnim.paused=!0),a.__highlighted&&(a.__highlighted=!1,a.__highlightAnim=new Ext.fx.Anim({target:a,to:{fill:a.__prevFill,opacity:a.__prevOpacity,lineWidth:a.__prevLineWidth}})))},highlightItem:function(a){var b=this,c,d;if(!a){this.highlightSeries();return}c=a._points,d=c.length==2?["M",c[0][0],c[0][1],"L",c[1][0],c[1][1]]:["M",c[0][0],c[0][1],"L",c[0][0],b.bbox.y+b.bbox.height],b.highlightSprite.setAttributes({path:d,hidden:!1},!0)},unHighlightItem:function(a){a||this.unHighlightSeries(),this.highlightSprite&&this.highlightSprite.hide(!0)},hideAll:function(a){var b=this;a=(isNaN(b._index)?a:b._index)||0,b.__excludes[a]=!0,b.areas[a].hide(!0),b.redraw()},showAll:function(a){var b=this;a=(isNaN(b._index)?a:b._index)||0,b.__excludes[a]=!1,b.areas[a].show(!0),b.redraw()},redraw:function(){var a=this,b;b=a.chart.legend.rebuild,a.chart.legend.rebuild=!1,a.chart.redraw(),a.chart.legend.rebuild=b},hide:function(){if(this.areas){var a=this,b=a.areas,c,d,e,f,g;if(b&&b.length){for(c=0,f=b.length;c<f;++c)b[c]&&b[c].hide(!0);a.hideLabels()}}},getLegendColor:function(a){var b=this;return b.colorArrayStyle[a%b.colorArrayStyle.length]}}),Ext.define("Ext.chart.series.Bar",{extend:"Ext.chart.series.Cartesian",alternateClassName:["Ext.chart.BarSeries","Ext.chart.BarChart","Ext.chart.StackedBarChart"],requires:["Ext.chart.axis.Axis","Ext.fx.Anim"],type:"bar",alias:"series.bar",column:!1,style:{},gutter:38.2,groupGutter:38.2,xPadding:0,yPadding:10,constructor:function(a){this.callParent(arguments);var b=this,c=b.chart.surface,d=b.chart.shadow,e,f;a.highlightCfg=Ext.Object.merge({lineWidth:3,stroke:"#55c",opacity:.8,color:"#f00"},a.highlightCfg),Ext.apply(b,a,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":.05,stroke:"rgb(200, 200, 200)",translate:{x:1.2,y:1.2}},{"stroke-width":4,"stroke-opacity":.1,stroke:"rgb(150, 150, 150)",translate:{x:.9,y:.9}},{"stroke-width":2,"stroke-opacity":.15,stroke:"rgb(100, 100, 100)",translate:{x:.6,y:.6}}]}),b.group=c.getGroup(b.seriesId+"-bars");if(d)for(e=0,f=b.shadowAttributes.length;e<f;e++)b.shadowGroups.push(c.getGroup(b.seriesId+"-shadows"+e))},getBarGirth:function(){var a=this,b=a.chart.getChartStore(),c=a.column,d=b.getCount(),e=a.gutter/100;return(a.chart.chartBBox[c?"width":"height"]-a[c?"xPadding":"yPadding"]*2)/(d*(e+1)-e)},getGutters:function(){var a=this,b=a.column,c=Math.ceil(a[b?"xPadding":"yPadding"]+a.getBarGirth()/2);return a.column?[c,0]:[0,c]},getBounds:function(){var a=this,b=a.chart,c=b.getChartStore(),d=c.data.items,e,f,g,h=[].concat(a.yField),i=h.length,j=i,k=a.groupGutter/100,l=a.column,m=a.xPadding,n=a.yPadding,o=a.stacked,p=a.getBarGirth(),q=l?"width":"height",r=Math,s=r.min,t=r.max,u=r.abs,v=a.getAxesForXAndYFields(),w=v.yAxis,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;a.setBBox(!0),A=a.bbox;if(a.__excludes)for(J=0,H=a.__excludes.length;J<H;J++)a.__excludes[J]&&j--;D=b.axes.get(w),D&&(x=D.applyData(),B=x.from,C=x.to),a.yField&&!Ext.isNumber(B)&&(E=a.getMinMaxYValues(),B=E[0],C=E[1]),Ext.isNumber(B)||(B=0),Ext.isNumber(C)||(C=0),F=(l?A.height-n*2:A.width-m*2)/(C-B),y=p,z=p/((o?1:j)*(k+1)-k),q in a.style&&(z=s(z,a.style[q]),y=z*((o?1:j)*(k+1)-k)),G=l?A.y+A.height-n:A.x+m;if(o){H=[[],[]];for(e=0,f=d.length;e<f;e++){g=d[e],H[0][e]=H[0][e]||0,H[1][e]=H[1][e]||0;for(J=0;J<i;J++){if(a.__excludes&&a.__excludes[J])continue;I=g.get(h[J]),H[+(I>0)][e]+=u(I)}}H[+(C>0)].push(u(C)),H[+(B>0)].push(u(B)),L=t.apply(r,H[0]),K=t.apply(r,H[1]),F=(l?A.height-n*2:A.width-m*2)/(K+L),G+=L*F*(l?-1:1)}else B/C<0&&(G-=B*F*(l?-1:1));return{bars:h,bbox:A,shrunkBarWidth:y,barsLen:i,groupBarsLen:j,barWidth:p,groupBarWidth:z,scale:F,zero:G,xPadding:m,yPadding:n,signed:B/C<0,minY:B,maxY:C}},getPaths:function(){var a=this,b=a.chart,c=b.getChartStore(),d=c.data.items,e,f,g,h=a.bounds=a.getBounds(),i=a.items=[],j=a.yField,k=a.gutter/100,l=a.groupGutter/100,m=b.animate,n=a.column,o=a.group,p=b.shadow,q=a.shadowGroups,r=a.shadowAttributes,s=q.length,t=h.bbox,u=h.barWidth,v=h.shrunkBarWidth,w=a.xPadding,x=a.yPadding,y=a.stacked,z=h.barsLen,A=a.colorArrayStyle,B=A&&A.length||0,C=Math,D=C.max,E=C.min,F=C.abs,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V;for(e=0,f=d.length;e<f;e++){g=d[e],L=h.zero,M=h.zero,J=0,K=0,N=!1;for(G=0,Q=0;G<z;G++){if(a.__excludes&&a.__excludes[G])continue;H=g.get(h.bars[G]),I=Math.round((H-D(h.minY,0))*h.scale),O={fill:A[(z>1?G:0)%B]},n?Ext.apply(O,{height:I,width:D(h.groupBarWidth,0),x:t.x+w+(u-v)*.5+e*u*(1+k)+Q*h.groupBarWidth*(1+l)*!y,y:L-I}):(U=f-1-e,Ext.apply(O,{height:D(h.groupBarWidth,0),width:I+(L==h.zero),x:L+(L!=h.zero),y:t.y+x+(u-v)*.5+U*u*(1+k)+Q*h.groupBarWidth*(1+l)*!y+1})),I<0&&(n?(O.y=M,O.height=F(I)):(O.x=M+I,O.width=F(I))),y&&(I<0?M+=I*(n?-1:1):L+=I*(n?-1:1),J+=F(I),I<0&&(K+=F(I))),O.x=Math.floor(O.x)+1,V=Math.floor(O.y),!Ext.isIE9&&O.y>V&&V--,O.y=V,O.width=Math.floor(O.width),O.height=Math.floor(O.height),i.push({series:a,yField:j[G],storeItem:g,value:[g.get(a.xField),H],attr:O,point:n?[O.x+O.width/2,H>=0?O.y:O.y+O.height]:[H>=0?O.x+O.width:O.x,O.y+O.height/2]});if(m&&b.resizing){P=n?{x:O.x,y:h.zero,width:O.width,height:0}:{x:h.zero,y:O.y,width:0,height:O.height};if(p&&(y&&!N||!y)){N=!0;for(R=0;R<s;R++)S=q[R].getAt(y?e:e*z+G),S&&S.setAttributes(P,!0)}T=o.getAt(e*z+G),T&&T.setAttributes(P,!0)}Q++}y&&i.length&&(i[e*Q].totalDim=J,i[e*Q].totalNegDim=K)}},renderShadows:function(a,b,c,d){var e=this,f=e.chart,g=f.surface,h=f.animate,i=e.stacked,j=e.shadowGroups,k=e.shadowAttributes,l=j.length,m=f.getChartStore(),n=e.column,o=e.items,p=[],q=d.zero,r,s,t,u,v,w,x;if(i&&a%d.groupBarsLen===0||!i){w=a/d.groupBarsLen;for(r=0;r<l;r++)s=Ext.apply({},k[r]),t=j[r].getAt(i?w:a),Ext.copyTo(s,b,"x,y,width,height"),t||(t=g.add(Ext.apply({type:"rect",group:j[r]},Ext.apply({},c,s)))),i&&(u=o[a].totalDim,v=o[a].totalNegDim,n?(s.y=q+v-u-1,s.height=u):(s.x=q-v,s.width=u)),x=e.renderer(t,m.getAt(w),s,a,m),x.hidden=!!b.hidden,h?e.onAnimate(t,{to:x}):t.setAttributes(x,!0),p.push(t)}return p},drawSeries:function(){var a=this,b=a.chart,c=b.getChartStore(),d=b.surface,e=b.animate,f=a.stacked,g=a.column,h=b.shadow,i=a.shadowGroups,j=i.length,k=a.group,l=a.seriesStyle,m,n,o,p,q,r,s,t,u,v,w,x,y,z;if(!c||!c.getCount()||a.seriesIsHidden){a.hide(),a.items=[];return}w=Ext.apply({},this.style,l),delete w.fill,delete w.x,delete w.y,delete w.width,delete w.height,a.unHighlightItem(),a.cleanHighlights(),a.getPaths(),v=a.bounds,m=a.items,q=g?{y:v.zero,height:0}:{x:v.zero,width:0},n=m.length;for(o=0;o<n;o++){r=k.getAt(o),x=m[o].attr,h&&(m[o].shadows=a.renderShadows(o,x,q,v)),r||(y=Ext.apply({},q,x),y=Ext.apply(y,w||{}),r=d.add(Ext.apply({},{type:"rect",group:k},y)));if(e){s=a.renderer(r,c.getAt(o),x,o,c),r._to=s,z=a.onAnimate(r,{to:Ext.apply(s,w)});if(h&&f&&o%v.barsLen===0){p=o/v.barsLen;for(t=0;t<j;t++)z.on("afteranimate",function(){this.show(!0)},i[t].getAt(p))}}else s=a.renderer(r,c.getAt(o),Ext.apply(x,{hidden:!1}),o,c),r.setAttributes(Ext.apply(s,w),!0);m[o].sprite=r}n=k.getCount();for(p=o;p<n;p++)k.getAt(p).hide(!0);a.stacked&&(o=c.getCount());if(h)for(t=0;t<j;t++){u=i[t],n=u.getCount();for(p=o;p<n;p++)u.getAt(p).hide(!0)}a.renderLabels()},onCreateLabel:function(a,b,c,d){var e=this,f=e.chart.surface,g=e.labelsGroup,h=e.label,i=Ext.apply({},h,e.seriesLabelStyle||{}),j;return f.add(Ext.apply({type:"text",group:g},i||{}))},onPlaceLabel:function(a,b,c,d,e,f,g,h){var i=this,j=i.bounds,k=j.groupBarWidth,l=i.column,m=i.chart,n=m.chartBBox,o=m.resizing,p=c.value[0],q=c.value[1],r=c.attr,s=i.label,t=s.orientation=="vertical",u=[].concat(s.field),v=s.renderer,w=v(b.get(u[h])),x=i.getLabelSize(w),y=x.width,z=x.height,A=j.zero,B="outside",C="insideStart",D="insideEnd",E=10,F=6,G=j.signed,H,I,J;a.setAttributes({text:w}),a.isOutside=!1,l?(e==B?z+F+r.height>(q>=0?A-n.y:n.y+n.height-A)&&(e=D):z+F>r.height&&(e=B,a.isOutside=!0),H=r.x+k/2,I=e==C?A+(z/2+3)*(q>=0?-1:1):q>=0?r.y+(z/2+3)*(e==B?-1:1):r.y+r.height+(z/2+3)*(e===B?1:-1)):(e==B?y+E+r.width>(q>=0?n.x+n.width-A:A-n.x)&&(e=D):y+E>r.width&&(e=B,a.isOutside=!0),H=e==C?A+(y/2+5)*(q>=0?1:-1):q>=0?r.x+r.width+(y/2+5)*(e===B?1:-1):r.x+(y/2+5)*(e===B?-1:1),I=r.y+k/2),J={x:H,y:I},t&&(J.rotate={x:H,y:I,degrees:270}),f&&o&&(l?(H=r.x+r.width/2,I=A):(H=A,I=r.y+r.height/2),a.setAttributes({x:H,y:I},!0),t&&a.setAttributes({rotate:{x:H,y:I,degrees:270}},!0)),f?i.onAnimate(a,{to:J}):a.setAttributes(Ext.apply(J,{hidden:!1}),!0)},getLabelSize:function(a){var b=this.testerLabel,c=this.label,d=Ext.apply({},c,this.seriesLabelStyle||{}),e=c.orientation==="vertical",f,g,h,i;return b||(b=this.testerLabel=this.chart.surface.add(Ext.apply({type:"text",opacity:0},d))),b.setAttributes({text:a},!0),f=b.getBBox(),g=f.width,h=f.height,{width:e?h:g,height:e?g:h}},onAnimate:function(a,b){return a.show(),this.callParent(arguments)},isItemInPoint:function(a,b,c){var d=c.sprite.getBBox();return d.x<=a&&d.y<=b&&d.x+d.width>=a&&d.y+d.height>=b},hideAll:function(a){var b=this.chart.axes,c=b.items,d=c.length,e=0;a=(isNaN(this._index)?a:this._index)||0,this.__excludes||(this.__excludes=[]),this.__excludes[a]=!0,this.drawSeries();for(e;e<d;e++)c[e].drawAxis()},showAll:function(a){var b=this.chart.axes,c=b.items,d=c.length,e=0;a=(isNaN(this._index)?a:this._index)||0,this.__excludes||(this.__excludes=[]),this.__excludes[a]=!1,this.drawSeries();for(e;e<d;e++)c[e].drawAxis()},getLegendColor:function(a){var b=this,c=b.colorArrayStyle.length;return b.style&&b.style.fill?b.style.fill:b.colorArrayStyle[a%c]},highlightItem:function(a){this.callParent(arguments),this.renderLabels()},unHighlightItem:function(){this.callParent(arguments),this.renderLabels()},cleanHighlights:function(){this.callParent(arguments),this.renderLabels()}}),Ext.define("Ext.chart.series.Column",{alternateClassName:["Ext.chart.ColumnSeries","Ext.chart.ColumnChart","Ext.chart.StackedColumnChart"],extend:"Ext.chart.series.Bar",type:"column",alias:"series.column",column:!0,xPadding:10,yPadding:0}),Ext.define("Ext.chart.series.Gauge",{extend:"Ext.chart.series.Series",type:"gauge",alias:"series.gauge",rad:Math.PI/180,highlightDuration:150,angleField:!1,needle:!1,donut:!1,showInLegend:!1,style:{},constructor:function(a){this.callParent(arguments);var b=this,c=b.chart,d=c.surface,e=c.store,f=c.shadow,g,h,i;Ext.apply(b,a,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":1,stroke:"rgb(200, 200, 200)",translate:{x:1.2,y:2}},{"stroke-width":4,"stroke-opacity":1,stroke:"rgb(150, 150, 150)",translate:{x:.9,y:1.5}},{"stroke-width":2,"stroke-opacity":1,stroke:"rgb(100, 100, 100)",translate:{x:.6,y:1}}]}),b.group=d.getGroup(b.seriesId);if(f)for(g=0,h=b.shadowAttributes.length;g<h;g++)b.shadowGroups.push(d.getGroup(b.seriesId+"-shadows"+g));d.customAttributes.segment=function(a){return b.getSegment(a)}},initialize:function(){var a=this,b=a.chart.getChartStore(),c=b.data.items,d,e,f;a.yField=[];if(a.label.field)for(d=0,e=c.length;d<e;d++)f=c[d],a.yField.push(f.get(a.label.field))},getSegment:function(a){var b=this,c=b.rad,d=Math.cos,e=Math.sin,f=Math.abs,g=b.centerX,h=b.centerY,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=.01,r=a.endRho-a.startRho,s=a.startAngle,t=a.endAngle,u=(s+t)/2*c,v=a.margin||0,w=f(t-s)>180,x=Math.min(s,t)*c,y=Math.max(s,t)*c,z=!1;return g+=v*d(u),h+=v*e(u),i=g+a.startRho*d(x),m=h+a.startRho*e(x),j=g+a.endRho*d(x),n=h+a.endRho*e(x),k=g+a.startRho*d(y),o=h+a.startRho*e(y),l=g+a.endRho*d(y),p=h+a.endRho*e(y),f(i-k)<=q&&f(m-o)<=q&&(z=!0),z?{path:[["M",i,m],["L",j,n],["A",a.endRho,a.endRho,0,+w,1,l,p],["Z"]]}:{path:[["M",i,m],["L",j,n],["A",a.endRho,a.endRho,0,+w,1,l,p],["L",k,o],["A",a.startRho,a.startRho,0,+w,0,i,m],["Z"]]}},calcMiddle:function(a){var b=this,c=b.rad,d=a.slice,e=b.centerX,f=b.centerY,g=d.startAngle,h=d.endAngle,i=Math.max("rho"in d?d.rho:b.radius,b.label.minMargin),j=+b.donut,k=Math.min(g,h)*c,l=Math.max(g,h)*c,m=-(k+(l-k)/2),n=e+(a.endRho+a.startRho)/2*Math.cos(m),o=f-(a.endRho+a.startRho)/2*Math.sin(m);a.middle={x:n,y:o}},drawSeries:function(){var a=this,b=a.chart,c=b.getChartStore(),d=a.group,e=a.chart.animate,f=a.chart.axes.get(0),g=f&&f.minimum||a.minimum||0,h=f&&f.maximum||a.maximum||0,i=a.angleField||a.field||a.xField,j=b.surface,k=b.chartBBox,l=a.rad,m=+a.donut,n={},o=[],p=a.seriesStyle,q=a.seriesLabelStyle,r=a.colorArrayStyle,s=r&&r.length||0,t=b.maxGutter[0],u=b.maxGutter[1],v=Math.cos,w=Math.sin,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;Ext.apply(p,a.style||{}),a.setBBox(),Q=a.bbox,a.colorSet&&(r=a.colorSet,s=r.length);if(!c||!c.getCount()||a.seriesIsHidden){a.hide(),a.items=[];return}y=a.centerX=k.x+k.width/2,z=a.centerY=k.y+k.height,a.radius=Math.min(y-k.x,z-k.y),a.slices=B=[],a.items=o=[],a.value||(G=c.getAt(0),a.value=G.get(i)),D=a.value,a.needle?(S={series:a,value:D,startAngle:-180,endAngle:0,rho:a.radius},R=-180*(1-(D-g)/(h-g)),B.push(S)):(R=-180*(1-(D-g)/(h-g)),S={series:a,value:D,startAngle:-180,endAngle:R,rho:a.radius},T={series:a,value:a.maximum-D,startAngle:R,endAngle:0,rho:a.radius},B.push(S,T));for(H=0,F=B.length;H<F;H++)A=B[H],C=d.getAt(H),x=Ext.apply({segment:{startAngle:A.startAngle,endAngle:A.endAngle,margin:0,rho:A.rho,startRho:A.rho*+m/100,endRho:A.rho}},Ext.apply(p,r&&{fill:r[H%s]}||{})),E=Ext.apply({},x.segment,{slice:A,series:a,storeItem:G,index:H}),o[H]=E,C||(P=Ext.apply({type:"path",group:d},Ext.apply(p,r&&{fill:r[H%s]}||{})),C=j.add(Ext.apply(P,x))),A.sprite=A.sprite||[],E.sprite=C,A.sprite.push(C),e?(x=a.renderer(C,G,x,H,c),C._to=x,a.onAnimate(C,{to:x})):(x=a.renderer(C,G,Ext.apply(x,{hidden:!1}),H,c),C.setAttributes(x,!0));a.needle&&(R=R*Math.PI/180,a.needleSprite?e?a.onAnimate(a.needleSprite,{to:{path:["M",y+a.radius*+m/100*v(R),z+ -Math.abs(a.radius*+m/100*w(R)),"L",y+a.radius*v(R),z+ -Math.abs(a.radius*w(R))]}}):a.needleSprite.setAttributes({type:"path",path:["M",y+a.radius*+m/100*v(R),z+ -Math.abs(a.radius*+m/100*w(R)),"L",y+a.radius*v(R),z+ -Math.abs(a.radius*w(R))]}):a.needleSprite=a.chart.surface.add({type:"path",path:["M",y+a.radius*+m/100*v(R),z+ -Math.abs(a.radius*+m/100*w(R)),"L",y+a.radius*v(R),z+ -Math.abs(a.radius*w(R))],"stroke-width":4,stroke:"#222"}),a.needleSprite.setAttributes({hidden:!1},!0)),delete a.value},setValue:function(a){this.value=a,this.drawSeries()},onCreateLabel:function(a,b,c,d){},onPlaceLabel:function(a,b,c,d,e,f,g){},onPlaceCallout:function(){},onAnimate:function(a,b){return a.show(),this.callParent(arguments)},isItemInPoint:function(a,b,c,d){var e=this,f=e.centerX,g=e.centerY,h=Math.abs,i=h(a-f),j=h(b-g),k=c.startAngle,l=c.endAngle,m=Math.sqrt(i*i+j*j),n=Math.atan2(b-g,a-f)/e.rad;return d===0&&n>=k&&n<l&&m>=c.startRho&&m<=c.endRho},showAll:function(){isNaN(this._index)||(this.__excludes[this._index]=!1,this.drawSeries())},getLegendColor:function(a){var b=this;return b.colorArrayStyle[a%b.colorArrayStyle.length]}}),Ext.define("Ext.chart.series.Line",{extend:"Ext.chart.series.Cartesian",alternateClassName:["Ext.chart.LineSeries","Ext.chart.LineChart"],requires:["Ext.chart.axis.Axis","Ext.chart.Shape","Ext.draw.Draw","Ext.fx.Anim"],type:"line",alias:"series.line",selectionTolerance:20,showMarkers:!0,markerConfig:{},style:{},smooth:!1,defaultSmoothness:3,fill:!1,constructor:function(a){this.callParent(arguments);var b=this,c=b.chart.surface,d=b.chart.shadow,e,f;a.highlightCfg=Ext.Object.merge({"stroke-width":3},a.highlightCfg),Ext.apply(b,a,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":.05,stroke:"rgb(0, 0, 0)",translate:{x:1,y:1}},{"stroke-width":4,"stroke-opacity":.1,stroke:"rgb(0, 0, 0)",translate:{x:1,y:1}},{"stroke-width":2,"stroke-opacity":.15,stroke:"rgb(0, 0, 0)",translate:{x:1,y:1}}]}),b.group=c.getGroup(b.seriesId),b.showMarkers&&(b.markerGroup=c.getGroup(b.seriesId+"-markers"));if(d)for(e=0,f=b.shadowAttributes.length;e<f;e++)b.shadowGroups.push(c.getGroup(b.seriesId+"-shadows"+e))},shrink:function(a,b,c){var d=a.length,e=Math.floor(d/c),f=1,g=0,h=0,i=[+a[0]],j=[+b[0]];for(;f<d;++f)g+=+a[f]||0,h+=+b[f]||0,f%e==0&&(i.push(g/e),j.push(h/e),g=0,h=0);return{x:i,y:j}},drawSeries:function(){var a=this,b=a.chart,c=b.axes,d=b.getChartStore(),e=d.data.items,f,g=d.getCount(),h=a.chart.surface,i={},j=a.group,k=a.showMarkers,l=a.markerGroup,m=b.shadow,n=a.shadowGroups,o=a.shadowAttributes,p=a.smooth,q=n.length,r=["M"],s=["M"],t=["M"],u=["M"],v=b.markerIndex,w=[].concat(a.axis),x,y=[],z={},A=[],B={},C=!1,D=[],E=a.markerStyle,F=a.seriesStyle,G=a.colorArrayStyle,H=G&&G.length||0,I=Ext.isNumber,J=a.seriesIdx,K=a.getAxesForXAndYFields(),L=K.xAxis,M=K.yAxis,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb;if(a.fireEvent("beforedraw",a)===!1)return;if(!g||a.seriesIsHidden){a.hide(),a.items=[];if(a.line){a.line.hide(!0);if(a.line.shadows){N=a.line.shadows;for(ab=0,q=N.length;ab<q;ab++)O=N[ab],O.hide(!0)}a.fillPath&&a.fillPath.hide(!0)}a.line=null,a.fillPath=null;return}sb=Ext.apply(E||{},a.markerConfig,{fill:a.seriesStyle.fill||G[J%G.length]}),ub=sb.type,delete sb.type,tb=F,tb["stroke-width"]||(tb["stroke-width"]=.5),wb="opacity"in tb?tb.opacity:1,zb="opacity"in tb?tb.opacity:.3,xb="lineOpacity"in tb?tb.lineOpacity:wb,yb="fillOpacity"in tb?tb.fillOpacity:zb;if(v&&l&&l.getCount())for(_=0;_<v;_++)eb=l.getAt(_),l.remove(eb),l.add(eb),fb=l.getAt(l.getCount()-2),eb.setAttributes({x:0,y:0,translate:{x:fb.attr.translation.x,y:fb.attr.translation.y}},!0);a.unHighlightItem(),a.cleanHighlights(),a.setBBox(),i=a.bbox,a.clipRect=[i.x,i.y,i.width,i.height];if(cb=c.get(L))db=cb.applyData(),mb=db.from,nb=db.to;if(cb=c.get(M))db=cb.applyData(),ob=db.from,pb=db.to;a.xField&&!Ext.isNumber(mb)&&(cb=a.getMinMaxXValues(),mb=cb[0],nb=cb[1]),a.yField&&!Ext.isNumber(ob)&&(cb=a.getMinMaxYValues(),ob=cb[0],pb=cb[1]),isNaN(mb)?(mb=0,kb=i.width/(g-1||1)):kb=i.width/(nb-mb||g-1||1),isNaN(ob)?(ob=0,lb=i.height/(g-1||1)):lb=i.height/(pb-ob||g-1||1);for(_=0,bb=e.length;_<bb;_++){f=e[_],hb=f.get(a.xField);if(typeof hb=="string"||typeof hb=="object"&&!Ext.isDate(hb)||L&&c.get(L)&&c.get(L).type=="Category")hb in z?hb=z[hb]:hb=z[hb]=_;ib=f.get(a.yField);if(typeof ib=="undefined"||typeof ib=="string"&&!ib)continue;if(typeof ib=="string"||typeof ib=="object"&&!Ext.isDate(ib)||M&&c.get(M)&&c.get(M).type=="Category")ib=_;D.push(_),y.push(hb),A.push(ib)}bb=y.length,bb>i.width&&(jb=a.shrink(y,A,i.width),y=jb.x,A=jb.y),a.items=[],vb=0,bb=y.length;for(_=0;_<bb;_++){hb=y[_],ib=A[_];if(ib===!1){s.length==1&&(s=[]),C=!0,a.items.push(!1);continue}U=(i.x+(hb-mb)*kb).toFixed(2),V=(i.y+i.height-(ib-ob)*lb).toFixed(2),C&&(C=!1,s.push("M")),s=s.concat([U,V]),typeof Z=="undefined"&&typeof V!="undefined"&&(Z=V,Y=U);if(!a.line||b.resizing)r=r.concat([U,i.y+i.height/2]);if(b.animate&&b.resizing&&a.line){a.line.setAttributes({path:r,opacity:xb},!0),a.fillPath&&a.fillPath.setAttributes({path:r,opacity:yb},!0);if(a.line.shadows){N=a.line.shadows;for(ab=0,q=N.length;ab<q;ab++)O=N[ab],O.setAttributes({path:r},!0)}}k&&(eb=l.getAt(vb++),eb?(eb.setAttributes({value:'"'+hb+", "+ib+'"',x:0,y:0,hidden:!1},!0),eb._to={translate:{x:+U,y:+V}}):(eb=Ext.chart.Shape[ub](h,Ext.apply({group:[j,l],x:0,y:0,translate:{x:+(W||U),y:X||i.y+i.height/2},value:'"'+hb+", "+ib+'"',zIndex:4e3},sb)),eb._to={translate:{x:+U,y:+V}})),a.items.push({series:a,value:[hb,ib],point:[U,V],sprite:eb,storeItem:d.getAt(D[_])}),W=U,X=V}if(s.length<=1)return;a.smooth&&(u=Ext.draw.Draw.smooth(s,I(p)?p:a.defaultSmoothness)),t=p?u:s,b.markerIndex&&a.previousPath?(Q=a.previousPath,p||Ext.Array.erase(Q,1,2)):Q=s;if(!a.line){a.line=h.add(Ext.apply({type:"path",group:j,path:r,stroke:tb.stroke||tb.fill},tb||{})),a.line.setAttributes({opacity:xb},!0),m&&a.line.setAttributes(Ext.apply({},a.shadowOptions),!0),a.line.setAttributes({fill:"none",zIndex:3e3}),!tb.stroke&&H&&a.line.setAttributes({stroke:G[J%H]},!0);if(m){N=a.line.shadows=[];for(P=0;P<q;P++)x=o[P],x=Ext.apply({},x,{path:r}),O=h.add(Ext.apply({},{type:"path",group:n[P]},x)),N.push(O)}}a.fill&&(S=t.concat([["L",U,i.y+i.height],["L",Y,i.y+i.height],["L",Y,Z]]),a.fillPath||(a.fillPath=h.add({group:j,type:"path",fill:tb.fill||G[J%H],path:r}))),$=k&&l.getCount();if(b.animate){R=a.fill,qb=a.line,T=a.renderer(qb,!1,{path:t},_,d),Ext.apply(T,tb||{},{stroke:tb.stroke||tb.fill}),delete T.fill,qb.show(!0),b.markerIndex&&a.previousPath?a.animation=rb=a.onAnimate(qb,{to:T,from:{path:Q}}):a.animation=rb=a.onAnimate(qb,{to:T});if(m){N=qb.shadows;for(ab=0;ab<q;ab++)N[ab].show(!0),b.markerIndex&&a.previousPath?a.onAnimate(N[ab],{to:{path:t},from:{path:Q}}):a.onAnimate(N[ab],{to:{path:t}})}R&&(a.fillPath.show(!0),a.onAnimate(a.fillPath,{to:Ext.apply({},{path:S,fill:tb.fill||G[J%H],"stroke-width":0,opacity:yb},tb||{})}));if(k){vb=0;for(_=0;_<bb;_++)a.items[_]&&(gb=l.getAt(vb++),gb&&(T=a.renderer(gb,d.getAt(_),gb._to,_,d),a.onAnimate(gb,{to:Ext.apply(T,sb||{})}),gb.show(!0)));for(;vb<$;vb++)gb=l.getAt(vb),gb.hide(!0)}}else{T=a.renderer(a.line,!1,{path:t,hidden:!1},_,d),Ext.apply(T,tb||{},{stroke:tb.stroke||tb.fill}),delete T.fill,a.line.setAttributes(T,!0),a.line.setAttributes({opacity:xb},!0);if(m){N=a.line.shadows;for(ab=0;ab<q;ab++)N[ab].setAttributes({path:t,hidden:!1},!0)}a.fill&&a.fillPath.setAttributes({path:S,hidden:!1,opacity:yb},!0);if(k){vb=0;for(_=0;_<bb;_++)a.items[_]&&(gb=l.getAt(vb++),gb&&(T=a.renderer(gb,d.getAt(_),gb._to,_,d),gb.setAttributes(Ext.apply(sb||{},T||{}),!0),gb.attr.hidden||gb.show(!0)));for(;vb<$;vb++)gb=l.getAt(vb),gb.hide(!0)}}b.markerIndex&&(a.smooth?Ext.Array.erase(s,1,2):Ext.Array.splice(s,1,0,s[1],s[2]),a.previousPath=s),a.renderLabels(),a.renderCallouts(),a.fireEvent("draw",a)},onCreateLabel:function(a,b,c,d){var e=this,f=e.labelsGroup,g=e.label,h=e.bbox,i=Ext.apply(g,e.seriesLabelStyle);return e.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:f,x:b.point[0],y:h.y+h.height/2},i||{}))},onPlaceLabel:function(a,b,c,d,e,f){var g=this,h=g.chart,i=h.resizing,j=g.label,k=j.renderer,l=j.field,m=g.bbox,n=c.point[0],o=c.point[1],p=c.sprite.attr.radius,q,r,s;a.setAttributes({text:k(b.get(l)),hidden:!0},!0);if(e=="rotate")a.setAttributes({"text-anchor":"start",rotation:{x:n,y:o,degrees:-45}},!0),q=a.getBBox(),r=q.width,s=q.height,n=n<m.x?m.x:n,n=n+r>m.x+m.width?n-(n+r-m.x-m.width):n,o=o-s<m.y?m.y+s:o;else if(e=="under"||e=="over")q=c.sprite.getBBox(),q.width=q.width||p*2,q.height=q.height||p*2,o+=e=="over"?-q.height:q.height,q=a.getBBox(),r=q.width/2,s=q.height/2,n=n-r<m.x?m.x+r:n,n=n+r>m.x+m.width?n-(n+r-m.x-m.width):n,o=o-s<m.y?m.y+s:o,o=o+s>m.y+m.height?o-(o+s-m.y-m.height):o;g.chart.animate&&!g.chart.resizing?(a.show(!0),g.onAnimate(a,{to:{x:n,y:o}})):(a.setAttributes({x:n,y:o},!0),i&&g.animation?g.animation.on("afteranimate",function(){a.show(!0)}):a.show(!0))},highlightItem:function(){var a=this;a.callParent(arguments),a.line&&!a.highlighted&&("__strokeWidth"in a.line||(a.line.__strokeWidth=parseFloat(a.line.attr["stroke-width"])||0),a.line.__anim&&(a.line.__anim.paused=!0),a.line.__anim=Ext.create("Ext.fx.Anim",{target:a.line,to:{"stroke-width":a.line.__strokeWidth+3}}),a.highlighted=!0)},unHighlightItem:function(){var a=this;a.callParent(arguments),a.line&&a.highlighted&&(a.line.__anim=Ext.create("Ext.fx.Anim",{target:a.line,to:{"stroke-width":a.line.__strokeWidth}}),a.highlighted=!1)},onPlaceCallout:function(a,b,c,d,e,f,g){if(!e)return;var h=this,i=h.chart,j=i.surface,k=i.resizing,l=h.callouts,m=h.items,n=d==0?!1:m[d-1].point,o=d==m.length-1?!1:m[d+1].point,p=[+c.point[0],+c.point[1]],q,r,s,t,u,v,w=l.offsetFromViz||30,x=l.offsetToSide||10,y=l.offsetBox||3,z,A,B,C,D,E=h.clipRect,F={width:l.styles.width||10,height:l.styles.height||10},G,H;n||(n=p),o||(o=p),t=(o[1]-n[1])/(o[0]-n[0]),u=(p[1]-n[1])/(p[0]-n[0]),v=(o[1]-p[1])/(o[0]-p[0]),r=Math.sqrt(1+t*t),q=[1/r,t/r],s=[-q[1],q[0]];if(u>0&&v<0&&s[1]<0||u<0&&v>0&&s[1]>0)s[0]*=-1,s[1]*=-1;else if(Math.abs(u)<Math.abs(v)&&s[0]<0||Math.abs(u)>Math.abs(v)&&s[0]>0)s[0]*=-1,s[1]*=-1;G=p[0]+s[0]*w,H=p[1]+s[1]*w,z=G+(s[0]>0?0:-(F.width+2*y)),A=H-F.height/2-y,B=F.width+2*y,C=F.height+2*y;if(z<E[0]||z+B>E[0]+E[2])s[0]*=-1;if(A<E[1]||A+C>E[1]+E[3])s[1]*=-1;G=p[0]+s[0]*w,H=p[1]+s[1]*w,z=G+(s[0]>0?0:-(F.width+2*y)),A=H-F.height/2-y,B=F.width+2*y,C=F.height+2*y,i.animate?(h.onAnimate(a.lines,{to:{path:["M",p[0],p[1],"L",G,H,"Z"]}}),a.panel&&a.panel.setPosition(z,A,!0)):(a.lines.setAttributes({path:["M",p[0],p[1],"L",G,H,"Z"]},!0),a.panel&&a.panel.setPosition(z,A));for(D in a)a[D].show(!0)},isItemInPoint:function(a,b,c,d){var e=this,f=e.items,g=e.selectionTolerance,h=null,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=Math.sqrt,z=Math.abs;return j=f[d],i=d&&f[d-1],d>=m&&(i=f[m-1]),k=i&&i.point,l=j&&j.point,n=i?k[0]:l[0]-g,o=i?k[1]:l[1],p=j?l[0]:k[0]+g,q=j?l[1]:k[1],t=y((a-n)*(a-n)+(b-o)*(b-o)),u=y((a-p)*(a-p)+(b-q)*(b-q)),v=Math.min(t,u),v<=g?v==t?i:j:!1},toggleAll:function(a){var b=this,c,d,e,f;a?Ext.chart.series.Cartesian.prototype.showAll.call(b):Ext.chart.series.Cartesian.prototype.hideAll.call(b);if(b.line){b.line.setAttributes({hidden:!a},!0);if(b.line.shadows)for(c=0,f=b.line.shadows,d=f.length;c<d;c++)e=f[c],e.setAttributes({hidden:!a},!0)}b.fillPath&&b.fillPath.setAttributes({hidden:!a},!0)},hideAll:function(){this.toggleAll(!1)},showAll:function(){this.toggleAll(!0)}}),Ext.define("Ext.chart.series.Pie",{alternateClassName:["Ext.chart.PieSeries","Ext.chart.PieChart"],extend:"Ext.chart.series.Series",type:"pie",alias:"series.pie",accuracy:1e5,rad:Math.PI*2/1e5,highlightDuration:150,angleField:!1,lengthField:!1,donut:!1,showInLegend:!1,style:{},constructor:function(a){this.callParent(arguments);var b=this,c=b.chart,d=c.surface,e=c.store,f=c.shadow,g,h,i;a.highlightCfg=Ext.merge({segment:{margin:20}},a.highlightCfg),Ext.apply(b,a,{shadowAttributes:[{"stroke-width":6,"stroke-opacity":1,stroke:"rgb(200, 200, 200)",translate:{x:1.2,y:2}},{"stroke-width":4,"stroke-opacity":1,stroke:"rgb(150, 150, 150)",translate:{x:.9,y:1.5}},{"stroke-width":2,"stroke-opacity":1,stroke:"rgb(100, 100, 100)",translate:{x:.6,y:1}}]}),b.group=d.getGroup(b.seriesId);if(f)for(g=0,h=b.shadowAttributes.length;g<h;g++)b.shadowGroups.push(d.getGroup(b.seriesId+"-shadows"+g));d.customAttributes.segment=function(a){var c=b.getSegment(a);if(!c.path||c.path.length===0)c.path=["M",0,0];return c},b.__excludes=b.__excludes||[]},initialize:function(){var a=this,b=a.chart.getChartStore(),c=b.data.items,d,e,f;a.yField=[];if(a.label.field)for(d=0,e=c.length;d<e;d++)f=c[d],a.yField.push(f.get(a.label.field))},getSegment:function(a){var b=this,c=b.rad,d=Math.cos,e=Math.sin,f=b.centerX,g=b.centerY,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=.01,u=a.startAngle,v=a.endAngle,w=(u+v)/2*c,x=a.margin||0,y=Math.min(u,v)*c,z=Math.max(u,v)*c,A=d(y),B=e(y),C=d(z),D=e(z),E=d(w),F=e(w),G=0,H=.7071067811865476;return z-y<t?{path:""}:(x!==0&&(f+=x*E,g+=x*F),i=f+a.endRho*A,m=g+a.endRho*B,k=f+a.endRho*C,o=g+a.endRho*D,r=f+a.endRho*E,s=g+a.endRho*F,a.startRho!==0?(h=f+a.startRho*A,l=g+a.startRho*B,j=f+a.startRho*C,n=g+a.startRho*D,p=f+a.startRho*E,q=g+a.startRho*F,{path:[["M",i,m],["A",a.endRho,a.endRho,0,0,1,r,s],["L",r,s],["A",a.endRho,a.endRho,0,G,1,k,o],["L",k,o],["L",j,n],["A",a.startRho,a.startRho,0,G,0,p,q],["L",p,q],["A",a.startRho,a.startRho,0,0,0,h,l],["L",h,l],["Z"]]}):{path:[["M",f,g],["L",i,m],["A",a.endRho,a.endRho,0,0,1,r,s],["L",r,s],["A",a.endRho,a.endRho,0,G,1,k,o],["L",k,o],["L",f,g],["Z"]]})},calcMiddle:function(a){var b=this,c=b.rad,d=a.slice,e=b.centerX,f=b.centerY,g=d.startAngle,h=d.endAngle,i=+b.donut,j=-(g+h)*c/2,k=(a.endRho+a.startRho)/2,l=e+k*Math.cos(j),m=f-k*Math.sin(j);a.middle={x:l,y:m}},drawSeries:function(){var a=this,b=a.chart.getChartStore(),c=b.data.items,d,e=a.group,f=a.chart.animate,g=a.angleField||a.field||a.xField,h=[].concat(a.lengthField),i=0,j=a.chart,k=j.surface,l=j.chartBBox,m=j.shadow,n=a.shadowGroups,o=a.shadowAttributes,p=n.length,q=h.length,r=0,s=+a.donut,t=[],u=[],v=0,w=0,x=0,y=a.seriesStyle,z=a.colorArrayStyle,A=z&&z.length||0,B,C,D,E,F,G,H,I,J=0,K,L,M,N,O,P,Q,R,S,T,U,V,W,X;Ext.apply(y,a.style||{}),a.setBBox(),X=a.bbox,a.colorSet&&(z=a.colorSet,A=z.length);if(!b||!b.getCount()||a.seriesIsHidden){a.hide(),a.items=[];return}a.unHighlightItem(),a.cleanHighlights(),G=a.centerX=l.x+l.width/2,H=a.centerY=l.y+l.height/2,a.radius=Math.min(G-l.x,H-l.y),a.slices=L=[],a.items=u=[];for(R=0,Q=c.length;R<Q;R++){d=c[R];if(this.__excludes&&this.__excludes[R])continue;v+=+d.get(g);if(h[0]){for(S=0,i=0;S<q;S++)i+=+d.get(h[S]);t[R]=i,w=Math.max(w,i)}}v=v||1;for(R=0,Q=c.length;R<Q;R++){d=c[R],this.__excludes&&this.__excludes[R]?N=0:(N=d.get(g),J==0&&(J=1));if(J==1){J=2,a.firstAngle=x=a.accuracy*N/v/2;for(S=0;S<R;S++)L[S].startAngle=L[S].endAngle=a.firstAngle}T=x-a.accuracy*N/v,K={series:a,value:N,startAngle:x,endAngle:T,storeItem:d},h[0]?(P=+t[R],K.rho=Math.floor(a.radius/w*P)):K.rho=a.radius,L[R]=K,function(){x=T}()}if(m)for(R=0,Q=L.length;R<Q;R++){K=L[R],K.shadowAttrs=[];for(S=0,r=0,D=[];S<q;S++){M=e.getAt(R*q+S),I=h[S]?b.getAt(R).get(h[S])/t[R]*K.rho:K.rho,B={segment:{startAngle:K.startAngle,endAngle:K.endAngle,margin:0,rho:K.rho,startRho:r+I*s/100,endRho:r+I},hidden:!K.value&&K.startAngle%a.accuracy==K.endAngle%a.accuracy};for(F=0,D=[];F<p;F++)C=o[F],E=n[F].getAt(R),E||(E=j.surface.add(Ext.apply({},{type:"path",group:n[F],strokeLinejoin:"round"},B,C))),f?(C=a.renderer(E,b.getAt(R),Ext.apply({},B,C),R,b),a.onAnimate(E,{to:C})):(C=a.renderer(E,b.getAt(R),C,R,b),E.setAttributes(C,!0)),D.push(E);K.shadowAttrs[S]=D}}for(R=0,Q=L.length;R<Q;R++){K=L[R];for(S=0,r=0;S<q;S++)M=e.getAt(R*q+S),I=h[S]?b.getAt(R).get(h[S])/t[R]*K.rho:K.rho,B=Ext.apply({segment:{startAngle:K.startAngle,endAngle:K.endAngle,margin:0,rho:K.rho,startRho:r+I*s/100,endRho:r+I},hidden:!K.value&&K.startAngle%a.accuracy==K.endAngle%a.accuracy},Ext.apply(y,z&&{fill:z[(q>1?S:R)%A]}||{})),O=Ext.apply({},B.segment,{slice:K,series:a,storeItem:K.storeItem,index:R}),a.calcMiddle(O),m&&(O.shadows=K.shadowAttrs[S]),u[R]=O,M||(W=Ext.apply({type:"path",group:e,middle:O.middle},Ext.apply(y,z&&{fill:z[(q>1?S:R)%A]}||{})),M=k.add(Ext.apply(W,B))),K.sprite=K.sprite||[],O.sprite=M,K.sprite.push(M),K.point=[O.middle.x,O.middle.y],f?(B=a.renderer(M,b.getAt(R),B,R,b),M._to=B,M._animating=!0,a.onAnimate(M,{to:B,listeners:{afteranimate:{fn:function(){this._animating=!1},scope:M}}})):(B=a.renderer(M,b.getAt(R),Ext.apply(B,{hidden:!1}),R,b),M.setAttributes(B,!0)),r+=I}Q=e.getCount();for(R=0;R<Q;R++)!L[R/q>>0]&&e.getAt(R)&&e.getAt(R).hide(!0);if(m){p=n.length;for(F=0;F<Q;F++)if(!L[F/q>>0])for(S=0;S<p;S++)n[S].getAt(F)&&n[S].getAt(F).hide(!0)}a.renderLabels(),a.renderCallouts()},onCreateLabel:function(a,b,c,d){var e=this,f=e.labelsGroup,g=e.label,h=e.centerX,i=e.centerY,j=b.middle,k=Ext.apply(e.seriesLabelStyle||{},g||{});return e.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:f,x:j.x,y:j.y},k))},onPlaceLabel:function(a,b,c,d,e,f,g){function y(a){return a<0&&(a+=360),a%360}var h=this,i=h.chart,j=i.resizing,k=h.label,l=k.renderer,m=[].concat(k.field),n=h.centerX,o=h.centerY,p=c.middle,q={x:p.x,y:p.y},r=p.x-n,s=p.y-o,t={},u=1,v=Math.atan2(s,r||1),w=v*180/Math.PI,x;q.hidden=!1,this.__excludes&&this.__excludes[d]&&(q.hidden=!0),a.setAttributes({text:l(b.get(m[g]))},!0);switch(e){case"outside":u=Math.sqrt(r*r+s*s)*2,q.x=u*Math.cos(v)+n,q.y=u*Math.sin(v)+o;break;case"rotate":w=y(w),w=w>90&&w<270?w+180:w,x=a.attr.rotation.degrees,x!=null&&Math.abs(x-w)>90?(w>x?w-=360:w+=360,w%=360):w=y(w),q.rotate={degrees:w,x:q.x,y:q.y};break;default:}q.translate={x:0,y:0},f&&!j&&(e!="rotate"||x!=null)?h.onAnimate(a,{to:q}):a.setAttributes(q,!0),a._from=t},onPlaceCallout:function(a,b,c,d,e,f,g){var h=this,i=h.chart,j=h.centerX,k=h.centerY,l=c.middle,m={x:l.x,y:l.y},n=l.x-j,o=l.y-k,p=1,q,r=Math.atan2(o,n||1),s=a.label.getBBox(),t=20,u=10,v=10,w;p=c.endRho+t,q=(c.endRho+c.startRho)/2+(c.endRho-c.startRho)/3,m.x=p*Math.cos(r)+j,m.y=p*Math.sin(r)+k,n=q*Math.cos(r),o=q*Math.sin(r),i.animate?(h.onAnimate(a.lines,{to:{path:["M",n+j,o+k,"L",m.x,m.y,"Z","M",m.x,m.y,"l",n>0?u:-u,0,"z"]}}),h.onAnimate(a.box,{to:{x:m.x+(n>0?u:-(u+s.width+2*v)),y:m.y+(o>0?-s.height-v/2:-s.height-v/2),width:s.width+2*v,height:s.height+2*v}}),h.onAnimate(a.label,{to:{x:m.x+(n>0?u+v:-(u+s.width+v)),y:m.y+(o>0?-s.height/4:-s.height/4)}})):(a.lines.setAttributes({path:["M",n+j,o+k,"L",m.x,m.y,"Z","M",m.x,m.y,"l",n>0?u:-u,0,"z"]},!0),a.box.setAttributes({x:m.x+(n>0?u:-(u+s.width+2*v)),y:m.y+(o>0?-s.height-v/2:-s.height-v/2),width:s.width+2*v,height:s.height+2*v},!0),a.label.setAttributes({x:m.x+(n>0?u+v:-(u+s.width+v)),y:m.y+(o>0?-s.height/4:-s.height/4)},!0));for(w in a)a[w].show(!0)},onAnimate:function(a,b){return a.show(),this.callParent(arguments)},isItemInPoint:function(a,b,c,d){var e=this,f=e.centerX,g=e.centerY,h=Math.abs,i=h(a-f),j=h(b-g),k=c.startAngle,l=c.endAngle,m=Math.sqrt(i*i+j*j),n=Math.atan2(b-g,a-f)/e.rad;return n>e.firstAngle&&(n-=e.accuracy),n<=k&&n>l&&m>=c.startRho&&m<=c.endRho},hideAll:function(a){var b,c,d,e,f,g,h;a=(isNaN(this._index)?a:this._index)||0,this.__excludes=this.__excludes||[],this.__excludes[a]=!0,h=this.slices[a].sprite;for(f=0,g=h.length;f<g;f++)h[f].setAttributes({hidden:!0},!0);if(this.slices[a].shadowAttrs)for(b=0,e=this.slices[a].shadowAttrs,c=e.length;b<c;b++){d=e[b];for(f=0,g=d.length;f<g;f++)d[f].setAttributes({hidden:!0},!0)}this.drawSeries()},showAll:function(a){a=(isNaN(this._index)?a:this._index)||0,this.__excludes[a]=!1,this.drawSeries()},highlightItem:function(a){var b=this,c=b.rad,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;a=a||this.items[this._index],this.unHighlightItem();if(!a||a.sprite&&a.sprite._animating)return;b.callParent([a]);if(!b.highlight)return;if("segment"in b.highlightCfg){d=b.highlightCfg.segment,e=b.chart.animate,b.labelsGroup&&(n=b.labelsGroup,o=b.label.display,p=n.getAt(a.index),q=(a.startAngle+a.endAngle)/2*c,r=d.margin||0,s=r*Math.cos(q),t=r*Math.sin(q),Math.abs(s)<1e-10&&(s=0),Math.abs(t)<1e-10&&(t=0),e?(p.stopAnimation(),p.animate({to:{translate:{x:s,y:t}},duration:b.highlightDuration})):p.setAttributes({translate:{x:s,y:t}},!0));if(b.chart.shadow&&a.shadows){g=0,h=a.shadows,j=h.length;for(;g<j;g++){i=h[g],k={},l=a.sprite._from.segment;for(m in l)m in d||(k[m]=l[m]);f={segment:Ext.applyIf(k,b.highlightCfg.segment)},e?(i.stopAnimation(),i.animate({to:f,duration:b.highlightDuration})):i.setAttributes(f,!0)}}}},unHighlightItem:function(){var a=this,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;if(!a.highlight)return;if("segment"in a.highlightCfg&&a.items){b=a.items,c=a.chart.animate,d=!!a.chart.shadow,e=a.labelsGroup,f=b.length,g=0,h=0,i=a.label.display;for(;g<f;g++){r=b[g];if(!r)continue;o=r.sprite;if(o&&o._highlighted){e&&(s=e.getAt(r.index),t=Ext.apply({translate:{x:0,y:0}},i=="rotate"?{rotate:{x:s.attr.x,y:s.attr.y,degrees:s.attr.rotation.degrees}}:{}),c?(s.stopAnimation(),s.animate({to:t,duration:a.highlightDuration})):s.setAttributes(t,!0));if(d){p=r.shadows,j=p.length;for(;h<j;h++){l={},m=r.sprite._to.segment,n=r.sprite._from.segment,Ext.apply(l,n);for(k in m)k in n||(l[k]=m[k]);q=p[h],c?(q.stopAnimation(),q.animate({to:{segment:l},duration:a.highlightDuration})):q.setAttributes({segment:l},!0)}}}}}a.callParent(arguments)},getLegendColor:function(a){var b=this;return b.colorSet&&b.colorSet[a%b.colorSet.length]||b.colorArrayStyle[a%b.colorArrayStyle.length]}}),Ext.define("Ext.chart.series.Radar",{extend:"Ext.chart.series.Series",requires:["Ext.chart.Shape","Ext.fx.Anim"],type:"radar",alias:"series.radar",rad:Math.PI/180,showInLegend:!1,style:{},constructor:function(a){this.callParent(arguments);var b=this,c=b.chart.surface,d,e;b.group=c.getGroup(b.seriesId),b.showMarkers&&(b.markerGroup=c.getGroup(b.seriesId+"-markers"))},drawSeries:function(){var a=this,b=a.chart.getChartStore(),c=b.data.items,d,e,f=a.group,g,h=a.chart,i=h.series.items,j,k,l,m=h.animate,n=a.field||a.yField,o=h.surface,p=h.chartBBox,q=a.seriesIdx,r=a.colorArrayStyle,s,t,u,v,w=0,x=[],y=Math.max,z=Math.cos,A=Math.sin,B=Math.PI*2,C=b.getCount(),D,E,F,G,H,I,J,K=a.seriesStyle,L=a.seriesLabelStyle,M=h.resizing||!a.radar,N=h.axes&&h.axes.get(0),O=!N||!N.maximum;a.setBBox(),w=O?0:N.maximum||0,Ext.apply(K,a.style||{});if(!b||!b.getCount()||a.seriesIsHidden){a.hide(),a.items=[],a.radar&&a.radar.hide(!0),a.radar=null;return}K.stroke||(K.stroke=r[q%r.length]),a.unHighlightItem(),a.cleanHighlights(),s=a.centerX=p.x+p.width/2,t=a.centerY=p.y+p.height/2,a.radius=v=Math.min(p.width,p.height)/2,a.items=u=[];if(O){for(j=0,k=i.length;j<k;j++)l=i[j],x.push(l.yField);for(d=0;d<C;d++){e=c[d];for(I=0,J=x.length;I<J;I++)w=y(+e.get(x[I]),w)}}w=w||1,D=[],E=[];for(I=0;I<C;I++)e=c[I],H=v*e.get(n)/w,F=H*z(I/C*B),G=H*A(I/C*B),I==0?(E.push("M",F+s,G+t),D.push("M",.01*F+s,.01*G+t)):(E.push("L",F+s,G+t),D.push("L",.01*F+s,.01*G+t)),u.push({sprite:!1,point:[s+F,t+G],storeItem:e,series:a});E.push("Z"),a.radar||(a.radar=o.add(Ext.apply({type:"path",group:f,path:D},K||{}))),h.resizing&&a.radar.setAttributes({path:D},!0),h.animate?a.onAnimate(a.radar,{to:Ext.apply({path:E},K||{})}):a.radar.setAttributes(Ext.apply({path:E},K||{}),!0),a.showMarkers&&a.drawMarkers(),a.renderLabels(),a.renderCallouts()},drawMarkers:function(){var a=this,b=a.chart,c=b.surface,d=Ext.apply({},a.markerStyle||{}),e=Ext.apply(d,a.markerConfig,{fill:a.colorArrayStyle[a.seriesIdx%a.colorArrayStyle.length]}),f=a.items,g=e.type,h=a.markerGroup,i=a.centerX,j=a.centerY,k,l,m,n;delete e.type;for(l=0,m=f.length;l<m;l++)k=f[l],n=h.getAt(l),n?n.show():n=Ext.chart.Shape[g](c,Ext.apply({group:h,x:0,y:0,translate:{x:i,y:j}},e)),k.sprite=n,b.resizing&&n.setAttributes({x:0,y:0,translate:{x:i,y:j}},!0),n._to={translate:{x:k.point[0],y:k.point[1]}},b.animate?a.onAnimate(n,{to:n._to}):n.setAttributes(Ext.apply(n._to,e||{}),!0)},isItemInPoint:function(a,b,c){var d,e=10,f=Math.abs;return d=c.point,f(d[0]-a)<=e&&f(d[1]-b)<=e},onCreateLabel:function(a,b,c,d){var e=this,f=e.labelsGroup,g=e.label,h=e.centerX,i=e.centerY,j=b.point,k=Ext.apply(e.seriesLabelStyle||{},g);return e.chart.surface.add(Ext.apply({type:"text","text-anchor":"middle",group:f,x:h,y:i},g||{}))},onPlaceLabel:function(a,b,c,d,e,f){var g=this,h=g.chart,i=h.resizing,j=g.label,k=j.renderer,l=j.field,m=g.centerX,n=g.centerY,o={x:c.point[0],y:c.point[1]},p=o.x-m,q=o.y-n;a.setAttributes({text:k(b.get(l)),hidden:!0},!0),i&&a.setAttributes({x:m,y:n},!0),f?(a.show(!0),g.onAnimate(a,{to:o})):(a.setAttributes(o,!0),a.show(!0))},toggleAll:function(a){var b=this,c,d,e,f;a?Ext.chart.series.Radar.superclass.showAll.call(b):Ext.chart.series.Radar.superclass.hideAll.call(b);if(b.radar){b.radar.setAttributes({hidden:!a},!0);if(b.radar.shadows)for(c=0,f=b.radar.shadows,d=f.length;c<d;c++)e=f[c],e.setAttributes({hidden:!a},!0)}},hideAll:function(){this.toggleAll(!1),this.hideMarkers(0)},showAll:function(){this.toggleAll(!0)},hideMarkers:function(a){var b=this,c=b.markerGroup&&b.markerGroup.getCount()||0,d=a||0;for(;d<c;d++)b.markerGroup.getAt(d).hide(!0)}}),Ext.define("Ext.chart.series.Scatter",{extend:"Ext.chart.series.Cartesian",requires:["Ext.chart.axis.Axis","Ext.chart.Shape","Ext.fx.Anim"],type:"scatter",alias:"series.scatter",constructor:function(a){this.callParent(arguments);var b=this,c=b.chart.shadow,d=b.chart.surface,e,f;Ext.apply(b,a,{style:{},markerConfig:{},shadowAttributes:[{"stroke-width":6,"stroke-opacity":.05,stroke:"rgb(0, 0, 0)"},{"stroke-width":4,"stroke-opacity":.1,stroke:"rgb(0, 0, 0)"},{"stroke-width":2,"stroke-opacity":.15,stroke:"rgb(0, 0, 0)"}]}),b.group=d.getGroup(b.seriesId);if(c)for(e=0,f=b.shadowAttributes.length;e<f;e++)b.shadowGroups.push(d.getGroup(b.seriesId+"-shadows"+e))},getBounds:function(){var a=this,b=a.chart,c=b.getChartStore(),d=b.axes,e=a.getAxesForXAndYFields(),f=e.xAxis,g=e.yAxis,h,i,j,k,l,m,n,o,p,q,r;a.setBBox(),h=a.bbox;if(q=d.get(f))r=q.applyData(),l=r.from,n=r.to;if(q=d.get(g))r=q.applyData(),m=r.from,o=r.to;return a.xField&&!Ext.isNumber(l)&&(q=a.getMinMaxXValues(),l=q[0],n=q[1]),a.yField&&!Ext.isNumber(m)&&(q=a.getMinMaxYValues(),m=q[0],o=q[1]),isNaN(l)?(l=0,n=c.getCount()-1,i=h.width/(c.getCount()-1)):i=h.width/(n-l),isNaN(m)?(m=0,o=c.getCount()-1,j=h.height/(c.getCount()-1)):j=h.height/(o-m),{bbox:h,minX:l,minY:m,xScale:i,yScale:j}},getPaths:function(){var a=this,b=a.chart,c=b.shadow,d=b.getChartStore(),e=d.data.items,f,g,h,i=a.group,j=a.bounds=a.getBounds(),k=a.bbox,l=j.xScale,m=j.yScale,n=j.minX,o=j.minY,p=k.x,q=k.y,r=k.height,s=a.items=[],t=[],u,v,w,x,y;for(f=0,g=e.length;f<g;f++){h=e[f],w=h.get(a.xField),x=h.get(a.yField);if(typeof x=="undefined"||typeof x=="string"&&!x||w==null||x==null)continue;if(typeof w=="string"||typeof w=="object"&&!Ext.isDate(w))w=f;if(typeof x=="string"||typeof x=="object"&&!Ext.isDate(x))x=f;u=p+(w-n)*l,v=q+r-(x-o)*m,t.push({x:u,y:v}),a.items.push({series:a,value:[w,x],point:[u,v],storeItem:h}),b.animate&&b.resizing&&(y=i.getAt(f),y&&(a.resetPoint(y),c&&a.resetShadow(y)))}return t},resetPoint:function(a){var b=this.bbox;a.setAttributes({translate:{x:(b.x+b.width)/2,y:(b.y+b.height)/2}},!0)},resetShadow:function(a){var b=this,c=a.shadows,d=b.shadowAttributes,e=b.shadowGroups.length,f=b.bbox,g,h;for(g=0;g<e;g++)h=Ext.apply({},d[g]),h.translate?(h.translate.x+=(f.x+f.width)/2,h.translate.y+=(f.y+f.height)/2):h.translate={x:(f.x+f.width)/2,y:(f.y+f.height)/2},c[g].setAttributes(h,!0)},createPoint:function(a,b){var c=this,d=c.chart,e=c.group,f=c.bbox;return Ext.chart.Shape[b](d.surface,Ext.apply({},{x:0,y:0,group:e,translate:{x:(f.x+f.width)/2,y:(f.y+f.height)/2}},a))},createShadow:function(a,b,c){var d=this,e=d.chart,f=d.shadowGroups,g=d.shadowAttributes,h=f.length,i=d.bbox,j,k,l,m;a.shadows=l=[];for(j=0;j<h;j++)m=Ext.apply({},g[j]),m.translate?(m.translate.x+=(i.x+i.width)/2,m.translate.y+=(i.y+i.height)/2):Ext.apply(m,{translate:{x:(i.x+i.width)/2,y:(i.y+i.height)/2}}),Ext.apply(m,b),k=Ext.chart.Shape[c](e.surface,Ext.apply({},{x:0,y:0,group:f[j]},m)),l.push(k)},drawSeries:function(){var a=this,b=a.chart,c=b.getChartStore(),d=a.group,e=b.shadow,f=a.shadowGroups,g=a.shadowAttributes,h=f.length,i,j,k,l,m,n,o,p,q,r,s;n=Ext.apply(a.markerStyle,a.markerConfig),p=n.type,delete n.type;if(!c||!c.getCount()){a.hide(),a.items=[];return}a.unHighlightItem(),a.cleanHighlights(),j=a.getPaths(),l=j.length;for(m=0;m<l;m++){k=j[m],i=d.getAt(m),Ext.apply(k,n),i||(i=a.createPoint(k,p),e&&a.createShadow(i,n,p)),q=i.shadows;if(b.animate){r=a.renderer(i,c.getAt(m),{translate:k},m,c),i._to=r,a.onAnimate(i,{to:r});for(o=0;o<h;o++)s=Ext.apply({},g[o]),r=a.renderer(q[o],c.getAt(m),Ext.apply({},{hidden:!1,translate:{x:k.x+(s.translate?s.translate.x:0),y:k.y+(s.translate?s.translate.y:0)}},s),m,c),a.onAnimate(q[o],{to:r})}else{r=a.renderer(i,c.getAt(m),{translate:k},m,c),i._to=r,i.setAttributes(r,!0);for(o=0;o<h;o++)s=Ext.apply({},g[o]),r=a.renderer(q[o],c.getAt(m),Ext.apply({},{hidden:!1,translate:{x:k.x+(s.translate?s.translate.x:0),y:k.y+(s.translate?s.translate.y:0)}},s),m,c),q[o].setAttributes(r,!0)}a.items[m].sprite=i}l=d.getCount();for(m=j.length;m<l;m++)d.getAt(m).hide(!0);a.renderLabels(),a.renderCallouts()},onCreateLabel:function(a,b,c,d){var e=this,f=e.labelsGroup,g=e.label,h=Ext.apply({},g,e.seriesLabelStyle),i=e.bbox;return e.chart.surface.add(Ext.apply({type:"text",group:f,x:b.point[0],y:i.y+i.height/2},h))},onPlaceLabel:function(a,b,c,d,e,f){var g=this,h=g.chart,i=h.resizing,j=g.label,k=j.renderer,l=j.field,m=g.bbox,n=c.point[0],o=c.point[1],p=c.sprite.attr.radius,q,r,s,t;a.setAttributes({text:k(b.get(l)),hidden:!0},!0);if(e=="rotate")a.setAttributes({"text-anchor":"start",rotation:{x:n,y:o,degrees:-45}},!0),q=a.getBBox(),r=q.width,s=q.height,n=n<m.x?m.x:n,n=n+r>m.x+m.width?n-(n+r-m.x-m.width):n,o=o-s<m.y?m.y+s:o;else if(e=="under"||e=="over")q=c.sprite.getBBox(),q.width=q.width||p*2,q.height=q.height||p*2,o+=e=="over"?-q.height:q.height,q=a.getBBox(),r=q.width/2,s=q.height/2,n=n-r<m.x?m.x+r:n,n=n+r>m.x+m.width?n-(n+r-m.x-m.width):n,o=o-s<m.y?m.y+s:o,o=o+s>m.y+m.height?o-(o+s-m.y-m.height):o;h.animate?i?(t=c.sprite.getActiveAnimation(),t?t.on("afteranimate",function(){a.setAttributes({x:n,y:o},!0),a.show(!0)}):a.show(!0)):g.onAnimate(a,{to:{x:n,y:o}}):(a.setAttributes({x:n,y:o},!0),a.show(!0))},onPlaceCallout:function(a,b,c,d,e,f,g){var h=this,i=h.chart,j=i.surface,k=i.resizing,l=h.callouts,m=h.items,n=c.point,o,p=a.label.getBBox(),q=30,r=10,s=3,t,u,v,w,x,y=h.bbox,z,A;o=[Math.cos(Math.PI/4),-Math.sin(Math.PI/4)],z=n[0]+o[0]*q,A=n[1]+o[1]*q,t=z+(o[0]>0?0:-(p.width+2*s)),u=A-p.height/2-s,v=p.width+2*s,w=p.height+2*s;if(t<y[0]||t+v>y[0]+y[2])o[0]*=-1;if(u<y[1]||u+w>y[1]+y[3])o[1]*=-1;z=n[0]+o[0]*q,A=n[1]+o[1]*q,t=z+(o[0]>0?0:-(p.width+2*s)),u=A-p.height/2-s,v=p.width+2*s,w=p.height+2*s,i.animate?(h.onAnimate(a.lines,{to:{path:["M",n[0],n[1],"L",z,A,"Z"]}},!0),h.onAnimate(a.box,{to:{x:t,y:u,width:v,height:w}},!0),h.onAnimate(a.label,{to:{x:z+(o[0]>0?s:-(p.width+s)),y:A}},!0)):(a.lines.setAttributes({path:["M",n[0],n[1],"L",z,A,"Z"]},!0),a.box.setAttributes({x:t,y:u,width:v,height:w},!0),a.label.setAttributes({x:z+(o[0]>0?s:-(p.width+s)),y:A},!0));for(x in a)a[x].show(!0)},onAnimate:function(a,b){return a.show(),this.callParent(arguments)},isItemInPoint:function(a,b,c){function g(c){var d=f(c[0]-a),e=f(c[1]-b);return Math.sqrt(d*d+e*e)}var d,e=10,f=Math.abs;return d=c.point,d[0]-e<=a&&d[0]+e>=a&&d[1]-e<=b&&d[1]+e>=b}}),Ext.define("Ext.tip.QuickTip",{extend:"Ext.tip.ToolTip",alias:"widget.quicktip",alternateClassName:"Ext.QuickTip",interceptTitles:!1,title:"&#160;",tagConfig:{namespace:"data-",attribute:"qtip",width:"qwidth",target:"target",title:"qtitle",hide:"hide",cls:"qclass",align:"qalign",anchor:"anchor"},initComponent:function(){var a=this;a.target=a.target||Ext.getDoc(),a.targets=a.targets||{},a.callParent()},register:function(a){var b=Ext.isArray(a)?a:arguments,c=0,d=b.length,e,f,g;for(;c<d;c++){a=b[c],e=a.target;if(e)if(Ext.isArray(e))for(f=0,g=e.length;f<g;f++)this.targets[Ext.id(e[f])]=a;else this.targets[Ext.id(e)]=a}},unregister:function(a){delete this.targets[Ext.id(a)]},cancelShow:function(a){var b=this,c=b.activeTarget;a=Ext.get(a).dom,b.isVisible()?c&&c.el==a&&b.hide():c&&c.el==a&&b.clearTimer("show")},getTipCfg:function(a){var b=a.getTarget(),c=b.title,d;if(this.interceptTitles&&c&&Ext.isString(c))return b.qtip=c,b.removeAttribute("title"),a.preventDefault(),{text:c};d=this.tagConfig,b=a.getTarget("["+d.namespace+d.attribute+"]");if(b)return{target:b,text:b.getAttribute(d.namespace+d.attribute)}},onTargetOver:function(a){var b=this,c=a.getTarget(b.delegate),d,e,f,g,h,i,j,k,l,m,n;if(b.disabled)return;b.targetXY=a.getXY();if(!c||c.nodeType!==1||c==document.documentElement||c==document.body)return;if(b.activeTarget&&(c==b.activeTarget.el||Ext.fly(b.activeTarget.el).contains(c))){b.clearTimer("hide"),b.show();return}if(c){k=b.targets;for(n in k)if(k.hasOwnProperty(n)){m=k[n],l=Ext.fly(m.target);if(l&&(l.dom===c||l.contains(c))){f=l.dom;break}}if(f){b.activeTarget=b.targets[f.id],b.activeTarget.el=c,b.anchor=b.activeTarget.anchor,b.anchor&&(b.anchorTarget=c),d=Ext.isDefined(b.activeTarget.showDelay),d&&(e=b.showDelay,b.showDelay=b.activeTarget.showDelay),b.delayShow(),d&&(b.showDelay=e);return}}f=Ext.fly(c,"_quicktip-target"),g=b.tagConfig,h=g.namespace,i=b.getTipCfg(a),i&&(i.target&&(c=i.target,f=Ext.fly(c,"_quicktip-target")),j=f.getAttribute(h+g.hide),b.activeTarget={el:c,text:i.text,width:+f.getAttribute(h+g.width)||null,autoHide:j!="user"&&j!=="false",title:f.getAttribute(h+g.title),cls:f.getAttribute(h+g.cls),align:f.getAttribute(h+g.align)},b.anchor=f.getAttribute(h+g.anchor),b.anchor&&(b.anchorTarget=c),d=Ext.isDefined(b.activeTarget.showDelay),d&&(e=b.showDelay,b.showDelay=b.activeTarget.showDelay),b.delayShow(),d&&(b.showDelay=e))},onTargetOut:function(a){var b=this,c=b.activeTarget,d,e;if(c&&a.within(b.activeTarget.el)&&!b.getTipCfg(a))return;b.clearTimer("show"),delete b.activeTarget,b.autoHide!==!1&&(d=c&&Ext.isDefined(c.hideDelay),d&&(e=b.hideDelay,b.hideDelay=c.hideDelay),b.delayHide(),d&&(b.hideDelay=e))},showAt:function(a){var b=this,c=b.activeTarget,d;c&&(b.rendered||(b.render(Ext.getBody()),b.activeTarget=c),b.suspendLayouts(),c.title?(b.setTitle(c.title),b.header.show()):b.header.hide(),b.update(c.text),b.autoHide=c.autoHide,b.dismissDelay=c.dismissDelay||b.dismissDelay,d=b.lastCls,d&&(b.removeCls(d),delete b.lastCls),d=c.cls,d&&(b.addCls(d),b.lastCls=d),b.setWidth(c.width),b.anchor?b.constrainPosition=!1:c.align?(a=b.el.getAlignToXY(c.el,c.align),b.constrainPosition=!1):b.constrainPosition=!0,b.resumeLayouts(!0)),b.callParent([a])},hide:function(){delete this.activeTarget,this.callParent()}}),Ext.define("Ext.tip.QuickTipManager",function(){var a,b=!1;return{requires:["Ext.tip.QuickTip"],singleton:!0,alternateClassName:"Ext.QuickTips",init:function(c,d){if(!a){if(!Ext.isReady){Ext.onReady(function(){Ext.tip.QuickTipManager.init(c,d)});return}var e=Ext.apply({disabled:b,id:"ext-quicktips-tip"},d),f=e.className,g=e.xtype;f?delete e.className:g&&(f="widget."+g,delete e.xtype),c!==!1&&(e.renderTo=document.body),a=Ext.create(f||"Ext.tip.QuickTip",e)}},destroy:function(){if(a){var b;a.destroy(),a=b}},ddDisable:function(){a&&!b&&a.disable()},ddEnable:function(){a&&!b&&a.enable()},enable:function(){a&&a.enable(),b=!1},disable:function(){a&&a.disable(),b=!0},isEnabled:function(){return a!==undefined&&!a.disabled},getQuickTip:function(){return a},register:function(){a.register.apply(a,arguments)},unregister:function(){a.unregister.apply(a,arguments)},tips:function(){a.register.apply(a,arguments)}}}()),Ext.define("Ext.app.Application",{extend:"Ext.app.Controller",requires:["Ext.ModelManager","Ext.data.Model","Ext.data.StoreManager","Ext.tip.QuickTipManager","Ext.ComponentManager","Ext.app.EventBus"],scope:undefined,enableQuickTips:!0,appFolder:"app",autoCreateViewport:!1,constructor:function(a){a=a||{},Ext.apply(this,a);var b=a.requires||[],c,d,e,f,g,h,i;Ext.Loader.setPath(this.name,this.appFolder);if(this.paths){g=this.paths;for(i in g)g.hasOwnProperty(i)&&(h=g[i],Ext.Loader.setPath(i,h))}this.callParent(arguments),this.eventbus=new Ext.app.EventBus,c=Ext.Array.from(this.controllers),d=c&&c.length,this.controllers=new Ext.util.MixedCollection,this.autoCreateViewport&&b.push(this.getModuleClassName("Viewport","view"));for(e=0;e<d;e++)b.push(this.getModuleClassName(c[e],"controller"));Ext.require(b),Ext.onReady(function(){for(e=0;e<d;e++)f=this.getController(c[e]),f.init(this);this.onBeforeLaunch.call(this)},this)},control:function(a,b,c){this.eventbus.control(a,b,c)},launch:Ext.emptyFn,onBeforeLaunch:function(){var a=this,b,c,d,e;a.enableQuickTips&&Ext.tip.QuickTipManager.init(),a.autoCreateViewport&&a.getView("Viewport").create(),a.launch.call(this.scope||this),a.launched=!0,a.fireEvent("launch",this),b=a.controllers.items,d=b.length;for(c=0;c<d;c++)e=b[c],e.onLaunch(this)},getModuleClassName:function(a,b){return a.indexOf(".")!==-1&&(Ext.ClassManager.isCreated(a)||Ext.Loader.isAClassNameWithAKnownPrefix(a))?a:this.name+"."+b+"."+a},getController:function(a){var b=this.controllers.get(a);return b||(b=Ext.create(this.getModuleClassName(a,"controller"),{application:this,id:a}),this.controllers.add(b)),b},getStore:function(a){var b=Ext.StoreManager.get(a);return b||(b=Ext.create(this.getModuleClassName(a,"store"),{storeId:a})),b},getModel:function(a){return a=this.getModuleClassName(a,"model"),Ext.ModelManager.getModel(a)},getView:function(a){return a=this.getModuleClassName(a,"view"),Ext.ClassManager.get(a)}}),Ext.define("Ext.form.field.HtmlEditor",{extend:"Ext.Component",mixins:{labelable:"Ext.form.Labelable",field:"Ext.form.field.Field"},alias:"widget.htmleditor",alternateClassName:"Ext.form.HtmlEditor",requires:["Ext.tip.QuickTipManager","Ext.picker.Color","Ext.toolbar.Item","Ext.toolbar.Toolbar","Ext.util.Format","Ext.layout.component.field.HtmlEditor"],childEls:["iframeEl","textareaEl"],fieldSubTpl:["{%Ext.DomHelper.generateMarkup(values.$comp.toolbar.getRenderTree(), out)%}","{beforeTextAreaTpl}",'<textarea id="{cmpId}-textareaEl" name="{name}" tabIndex="-1" {inputAttrTpl}',' class="{textareaCls}" style="{size}" autocomplete="off">',"{[Ext.util.Format.htmlEncode(values.value)]}","</textarea>","{afterTextAreaTpl}","{beforeIFrameTpl}",'<iframe id="{cmpId}-iframeEl" name="{iframeName}" frameBorder="0" {iframeAttrTpl}',' style="overflow:auto;{size}" src="{iframeSrc}"></iframe>',"{afterIFrameTpl}",{disableFormats:!0}],subTplInsertions:["beforeTextAreaTpl","afterTextAreaTpl","beforeIFrameTpl","afterIFrameTpl","iframeAttrTpl","inputAttrTpl"],enableFormat:!0,enableFontSize:!0,enableColors:!0,enableAlignments:!0,enableLists:!0,enableSourceEdit:!0,enableLinks:!0,enableFont:!0,createLinkText:"Please enter the URL for the link:",defaultLinkValue:"http://",fontFamilies:["Arial","Courier New","Tahoma","Times New Roman","Verdana"],defaultFont:"tahoma",defaultValue:Ext.isOpera||Ext.isIE6?"&#160;":"&#8203;",fieldBodyCls:Ext.baseCSSPrefix+"html-editor-wrap",componentLayout:"htmleditor",initialized:!1,activated:!1,sourceEditMode:!1,iframePad:3,hideMode:"offsets",maskOnDisable:!0,initComponent:function(){var a=this;a.addEvents("initialize","activate","beforesync","beforepush","sync","push","editmodechange"),a.callParent(arguments),a.createToolbar(a),a.initLabelable(),a.initField()},getRefItems:function(){return[this.toolbar]},createToolbar:function(a){function j(b,c,d){return{itemId:b,cls:f+"btn-icon",iconCls:f+"edit-"+b,enableToggle:c!==!1,scope:a,handler:d||a.relayBtnCmd,clickEvent:"mousedown",tooltip:e?a.buttonTips[b]||i:i,overflowText:a.buttonTips[b].title||i,tabIndex:-1}}var b=this,c=[],d,e=Ext.tip.QuickTipManager&&Ext.tip.QuickTipManager.isEnabled(),f=Ext.baseCSSPrefix,g,h,i;b.enableFont&&!Ext.isSafari2&&(g=Ext.widget("component",{renderTpl:['<select id="{id}-selectEl" class="{cls}">','<tpl for="fonts">','<option value="{[values.toLowerCase()]}" style="font-family:{.}"<tpl if="values.toLowerCase()==parent.defaultFont"> selected</tpl>>{.}</option>',"</tpl>","</select>"],renderData:{cls:f+"font-select",fonts:b.fontFamilies,defaultFont:b.defaultFont},childEls:["selectEl"],afterRender:function(){b.fontSelect=this.selectEl,Ext.Component.prototype.afterRender.apply(this,arguments)},onDisable:function(){var a=this.selectEl;a&&(a.dom.disabled=!0),Ext.Component.prototype.onDisable.apply(this,arguments)},onEnable:function(){var a=this.selectEl;a&&(a.dom.disabled=!1),Ext.Component.prototype.onEnable.apply(this,arguments)},listeners:{change:function(){b.relayCmd("fontname",b.fontSelect.dom.value),b.deferFocus()},element:"selectEl"}}),c.push(g,"-")),b.enableFormat&&c.push(j("bold"),j("italic"),j("underline")),b.enableFontSize&&c.push("-",j("increasefontsize",!1,b.adjustFont),j("decreasefontsize",!1,b.adjustFont)),b.enableColors&&c.push("-",{itemId:"forecolor",cls:f+"btn-icon",iconCls:f+"edit-forecolor",overflowText:a.buttonTips.forecolor.title,tooltip:e?a.buttonTips.forecolor||i:i,tabIndex:-1,menu:Ext.widget("menu",{plain:!0,items:[{xtype:"colorpicker",allowReselect:!0,focus:Ext.emptyFn,value:"000000",plain:!0,clickEvent:"mousedown",handler:function(a,c){b.execCmd("forecolor",Ext.isWebKit||Ext.isIE?"#"+c:c),b.deferFocus(),this.up("menu").hide()}}]})},{itemId:"backcolor",cls:f+"btn-icon",iconCls:f+"edit-backcolor",overflowText:a.buttonTips.backcolor.title,tooltip:e?a.buttonTips.backcolor||i:i,tabIndex:-1,menu:Ext.widget("menu",{plain:!0,items:[{xtype:"colorpicker",focus:Ext.emptyFn,value:"FFFFFF",plain:!0,allowReselect:!0,clickEvent:"mousedown",handler:function(a,c){Ext.isGecko?(b.execCmd("useCSS",!1),b.execCmd("hilitecolor",c),b.execCmd("useCSS",!0),b.deferFocus()):(b.execCmd(Ext.isOpera?"hilitecolor":"backcolor",Ext.isWebKit||Ext.isIE?"#"+c:c),b.deferFocus()),this.up("menu").hide()}}]})}),b.enableAlignments&&c.push("-",j("justifyleft"),j("justifycenter"),j("justifyright")),Ext.isSafari2||(b.enableLinks&&c.push("-",j("createlink",!1,b.createLink)),b.enableLists&&c.push("-",j("insertorderedlist"),j("insertunorderedlist")),b.enableSourceEdit&&c.push("-",j("sourceedit",!0,function(a){b.toggleSourceEdit(!b.sourceEditMode)})));for(d=0;d<c.length;d++)c[d].itemId!=="sourceedit"&&(c[d].disabled=!0);h=Ext.widget("toolbar",{id:b.id+"-toolbar",ownerCt:b,cls:Ext.baseCSSPrefix+"html-editor-tb",enableOverflow:!0,items:c,ownerLayout:b.getComponentLayout(),listeners:{click:function(a){a.preventDefault()},element:"el"}}),b.toolbar=h},getMaskTarget:function(){return this.bodyEl},setReadOnly:function(a){var b=this,c=b.textareaEl,d=b.iframeEl,e;b.readOnly=a,c&&(c.dom.readOnly=a),b.initialized&&(e=b.getEditorBody(),Ext.isIE?(d.setDisplayed(!1),e.contentEditable=!a,d.setDisplayed(!0)):b.setDesignMode(!a),e&&(e.style.cursor=a?"default":"text"),b.disableItems(a))},getDocMarkup:function(){var a=this,b=a.iframeEl.getHeight()-a.iframePad*2;return Ext.String.format('<html><head><style type="text/css">body{border:0;margin:0;padding:{0}px;height:{1}px;box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;cursor:text}</style></head><body></body></html>',a.iframePad,b)},getEditorBody:function(){var a=this.getDoc();return a.body||a.documentElement},getDoc:function(){return!Ext.isIE&&this.iframeEl.dom.contentDocument||this.getWin().document},getWin:function(){return Ext.isIE?this.iframeEl.dom.contentWindow:window.frames[this.iframeEl.dom.name]},finishRenderChildren:function(){this.callParent(),this.toolbar.finishRender()},onRender:function(){var a=this;a.callParent(arguments),a.inputEl=a.iframeEl,a.monitorTask=Ext.TaskManager.start({run:a.checkDesignMode,scope:a,interval:100})},initRenderTpl:function(){var a=this;return a.hasOwnProperty("renderTpl")||(a.renderTpl=a.getTpl("labelableRenderTpl")),a.callParent()},initRenderData:function(){return Ext.applyIf(this.callParent(),this.getLabelableRenderData())},getSubTplData:function(){return{$comp:this,cmpId:this.id,id:this.getInputId(),textareaCls:Ext.baseCSSPrefix+"hidden",value:this.value,iframeName:Ext.id(),iframeSrc:Ext.SSL_SECURE_URL,size:"height:100px;width:100%"}},getSubTplMarkup:function(){return this.getTpl("fieldSubTpl").apply(this.getSubTplData())},initFrameDoc:function(){var a=this,b,c;Ext.TaskManager.stop(a.monitorTask),b=a.getDoc(),a.win=a.getWin(),b.open(),b.write(a.getDocMarkup()),b.close(),c={run:function(){var b=a.getDoc();if(b.body||b.readyState==="complete")Ext.TaskManager.stop(c),a.setDesignMode(!0),Ext.defer(a.initEditor,10,a)},interval:10,duration:1e4,scope:a},Ext.TaskManager.start(c)},checkDesignMode:function(){var a=this,b=a.getDoc();b&&(!b.editorInitialized||a.getDesignMode()!=="on")&&a.initFrameDoc()},setDesignMode:function(a){var b=this,c=b.getDoc();c&&(b.readOnly&&(a=!1),c.designMode=/on|true/i.test(String(a).toLowerCase())?"on":"off")},getDesignMode:function(){var a=this.getDoc();return a?String(a.designMode).toLowerCase():""},disableItems:function(a){var b=this.getToolbar().items.items,c,d=b.length,e;for(c=0;c<d;c++)e=b[c],e.getItemId()!=="sourceedit"&&e.setDisabled(a)},toggleSourceEdit:function(a){var b=this,c=b.iframeEl,d=b.textareaEl,e=Ext.baseCSSPrefix+"hidden",f=b.getToolbar().getComponent("sourceedit");Ext.isBoolean(a)||(a=!b.sourceEditMode),b.sourceEditMode=a,f.pressed!==a&&f.toggle(a),a?(b.disableItems(!0),b.syncValue(),c.addCls(e),d.removeCls(e),d.dom.removeAttribute("tabIndex"),d.focus(),b.inputEl=d):(b.initialized&&b.disableItems(b.readOnly),b.pushValue(),c.removeCls(e),d.addCls(e),d.dom.setAttribute("tabIndex",-1),b.deferFocus(),b.inputEl=c),b.fireEvent("editmodechange",b,a),b.updateLayout()},createLink:function(){var a=prompt(this.createLinkText,this.defaultLinkValue);a&&a!=="http://"&&this.relayCmd("createlink",a)},clearInvalid:Ext.emptyFn,setValue:function(a){var b=this,c=b.textareaEl;b.mixins.field.setValue.call(b,a);if(a===null||a===undefined)a="";return c&&(c.dom.value=a),b.pushValue(),this},cleanHtml:function(a){return a=String(a),Ext.isWebKit&&(a=a.replace(/\sclass="(?:Apple-style-span|khtml-block-placeholder)"/gi,"")),a.charCodeAt(0)===parseInt(this.defaultValue.replace(/\D/g,""),10)&&(a=a.substring(1)),a},syncValue:function(){var a=this,b,c,d,e,f,g;a.initialized&&(b=a.getEditorBody(),d=b.innerHTML,Ext.isWebKit&&(e=b.getAttribute("style"),f=e.match(/text-align:(.*?);/i),f&&f[1]&&(d='<div style="'+f[0]+'">'+d+"</div>")),d=a.cleanHtml(d),a.fireEvent("beforesync",a,d)!==!1&&(a.textareaEl.dom.value!=d&&(a.textareaEl.dom.value=d,c=!0),a.fireEvent("sync",a,d),c&&a.checkChange()))},getValue:function(){var a=this,b;return a.sourceEditMode||a.syncValue(),b=a.rendered?a.textareaEl.dom.value:a.value,a.value=b,b},pushValue:function(){var a=this,b;a.initialized&&(b=a.textareaEl.dom.value||"",!a.activated&&b.length<1&&(b=a.defaultValue),a.fireEvent("beforepush",a,b)!==!1&&(a.getEditorBody().innerHTML=b,Ext.isGecko&&(a.setDesignMode(!1),a.setDesignMode(!0)),a.fireEvent("push",a,b)))},deferFocus:function(){this.focus(!1,!0)},getFocusEl:function(){var a=this,b=a.win;return b&&!a.sourceEditMode?b:a.textareaEl},initEditor:function(){try{var a=this,b=a.getEditorBody(),c=a.textareaEl.getStyles("font-size","font-family","background-image","background-repeat","background-color","color"),d,e;c["background-attachment"]="fixed",b.bgProperties="fixed",Ext.DomHelper.applyStyles(b,c),d=a.getDoc();if(d)try{Ext.EventManager.removeAll(d)}catch(f){}e=Ext.Function.bind(a.onEditorEvent,a),Ext.EventManager.on(d,{mousedown:e,dblclick:e,click:e,keyup:e,buffer:100}),e=a.onRelayedEvent,Ext.EventManager.on(d,{mousedown:e,mousemove:e,mouseup:e,click:e,dblclick:e,scope:a}),Ext.isGecko&&Ext.EventManager.on(d,"keypress",a.applyCommand,a),a.fixKeys&&Ext.EventManager.on(d,"keydown",a.fixKeys,a),Ext.EventManager.on(window,"unload",a.beforeDestroy,a),d.editorInitialized=!0,a.initialized=!0,a.pushValue(),a.setReadOnly(a.readOnly),a.fireEvent("initialize",a)}catch(g){}},beforeDestroy:function(){var a=this,b=a.monitorTask,c,d;b&&Ext.TaskManager.stop(b);if(a.rendered){try{c=a.getDoc();if(c){Ext.EventManager.removeAll(c);for(d in c)c.hasOwnProperty&&c.hasOwnProperty(d)&&delete c[d]}}catch(e){}Ext.destroyMembers(a,"toolbar","iframeEl","textareaEl")}a.callParent()},onRelayedEvent:function(a){var b=this.iframeEl,c=b.getXY(),d=a.getXY();a.xy=[c[0]+d[0],c[1]+d[1]],a.injectEvent(b),a.xy=d},onFirstFocus:function(){var a=this,b,c;a.activated=!0,a.disableItems(a.readOnly);if(Ext.isGecko){a.win.focus(),b=a.win.getSelection();if(!b.focusNode||b.focusNode.nodeType!==3)c=b.getRangeAt(0),c.selectNodeContents(a.getEditorBody()),c.collapse(!0),a.deferFocus();try{a.execCmd("useCSS",!0),a.execCmd("styleWithCSS",!1)}catch(d){}}a.fireEvent("activate",a)},adjustFont:function(a){var b=a.getItemId()==="increasefontsize"?1:-1,c=this.getDoc().queryCommandValue("FontSize")||"2",d=Ext.isString(c)&&c.indexOf("px")!==-1,e;c=parseInt(c,10),d?(c<=10?c=1+b:c<=13?c=2+b:c<=16?c=3+b:c<=18?c=4+b:c<=24?c=5+b:c=6+b,c=Ext.Number.constrain(c,1,6)):(e=Ext.isSafari,e&&(b*=2),c=Math.max(1,c+b)+(e?"px":0)),this.execCmd("FontSize",c)},onEditorEvent:function(a){this.updateToolbar()},updateToolbar:function(){function f(){for(var a=0,d=arguments.length,e;a<d;a++)e=arguments[a],b[e].toggle(c.queryCommandState(e))}var a=this,b,c,d,e;if(a.readOnly)return;if(!a.activated){a.onFirstFocus();return}b=a.getToolbar().items.map,c=a.getDoc(),a.enableFont&&!Ext.isSafari2&&(d=(c.queryCommandValue("FontName")||a.defaultFont).toLowerCase(),e=a.fontSelect.dom,d!==e.value&&(e.value=d)),a.enableFormat&&f("bold","italic","underline"),a.enableAlignments&&f("justifyleft","justifycenter","justifyright"),!Ext.isSafari2&&a.enableLists&&f("insertorderedlist","insertunorderedlist"),Ext.menu.Manager.hideAll(),a.syncValue()},relayBtnCmd:function(a){this.relayCmd(a.getItemId())},relayCmd:function(a,b){Ext.defer(function(){var c=this;c.focus(),c.execCmd(a,b),c.updateToolbar()},10,this)},execCmd:function(a,b){var c=this,d=c.getDoc(),e;d.execCommand(a,!1,b===e?null:b),c.syncValue()},applyCommand:function(a){if(a.ctrlKey){var b=this,c=a.getCharCode(),d;if(c>0){c=String.fromCharCode(c);switch(c){case"b":d="bold";break;case"i":d="italic";break;case"u":d="underline"}d&&(b.win.focus(),b.execCmd(d),b.deferFocus(),a.preventDefault())}}},insertAtCursor:function(a){var b=this,c;b.activated&&(b.win.focus(),Ext.isIE?(c=b.getDoc().selection.createRange(),c&&(c.pasteHTML(a),b.syncValue(),b.deferFocus())):(b.execCmd("InsertHTML",a),b.deferFocus()))},fixKeys:function(){return Ext.isIE?function(a){var b=this,c=a.getKey(),d=b.getDoc(),e=b.readOnly,f,g;if(c===a.TAB)a.stopEvent(),e||(f=d.selection.createRange(),f&&(f.collapse(!0),f.pasteHTML("&#160;&#160;&#160;&#160;"),b.deferFocus()));else if(c===a.ENTER&&!e){f=d.selection.createRange();if(f){g=f.parentElement();if(!g||g.tagName.toLowerCase()!=="li")a.stopEvent(),f.pasteHTML("<br />"),f.collapse(!1),f.select()}}}:Ext.isOpera?function(a){var b=this;a.getKey()===a.TAB&&(a.stopEvent(),b.readOnly||(b.win.focus(),b.execCmd("InsertHTML","&#160;&#160;&#160;&#160;"),b.deferFocus()))}:Ext.isWebKit?function(a){var b=this,c=a.getKey(),d=b.readOnly;c===a.TAB?(a.stopEvent(),d||(b.execCmd("InsertText","	"),b.deferFocus())):c===a.ENTER&&(a.stopEvent(),d||(b.execCmd("InsertHtml","<br /><br />"),b.deferFocus()))}:null}(),getToolbar:function(){return this.toolbar},buttonTips:{bold:{title:"Bold (Ctrl+B)",text:"Make the selected text bold.",cls:Ext.baseCSSPrefix+"html-editor-tip"},italic:{title:"Italic (Ctrl+I)",text:"Make the selected text italic.",cls:Ext.baseCSSPrefix+"html-editor-tip"},underline:{title:"Underline (Ctrl+U)",text:"Underline the selected text.",cls:Ext.baseCSSPrefix+"html-editor-tip"},increasefontsize:{title:"Grow Text",text:"Increase the font size.",cls:Ext.baseCSSPrefix+"html-editor-tip"},decreasefontsize:{title:"Shrink Text",text:"Decrease the font size.",cls:Ext.baseCSSPrefix+"html-editor-tip"},backcolor:{title:"Text Highlight Color",text:"Change the background color of the selected text.",cls:Ext.baseCSSPrefix+"html-editor-tip"},forecolor:{title:"Font Color",text:"Change the color of the selected text.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifyleft:{title:"Align Text Left",text:"Align text to the left.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifycenter:{title:"Center Text",text:"Center text in the editor.",cls:Ext.baseCSSPrefix+"html-editor-tip"},justifyright:{title:"Align Text Right",text:"Align text to the right.",cls:Ext.baseCSSPrefix+"html-editor-tip"},insertunorderedlist:{title:"Bullet List",text:"Start a bulleted list.",cls:Ext.baseCSSPrefix+"html-editor-tip"},insertorderedlist:{title:"Numbered List",text:"Start a numbered list.",cls:Ext.baseCSSPrefix+"html-editor-tip"},createlink:{title:"Hyperlink",text:"Make the selected text a hyperlink.",cls:Ext.baseCSSPrefix+"html-editor-tip"},sourceedit:{title:"Source Edit",text:"Switch to source editing mode.",cls:Ext.baseCSSPrefix+"html-editor-tip"}}}),Ext.define("Ext.panel.Tool",{extend:"Ext.Component",requires:["Ext.tip.QuickTipManager"],alias:"widget.tool",baseCls:Ext.baseCSSPrefix+"tool",disabledCls:Ext.baseCSSPrefix+"tool-disabled",toolPressedCls:Ext.baseCSSPrefix+"tool-pressed",toolOverCls:Ext.baseCSSPrefix+"tool-over",ariaRole:"button",childEls:["toolEl"],renderTpl:['<img id="{id}-toolEl" src="{blank}" class="{baseCls}-{type}" role="presentation"/>'],tooltipType:"qtip",stopEvent:!0,height:15,width:15,initComponent:function(){var a=this;a.addEvents("click"),a.type=a.type||a.id,Ext.applyIf(a.renderData,{baseCls:a.baseCls,blank:Ext.BLANK_IMAGE_URL,type:a.type}),a.tooltip=a.tooltip||a.qtip,a.callParent(),a.on({element:"toolEl",click:a.onClick,mousedown:a.onMouseDown,mouseover:a.onMouseOver,mouseout:a.onMouseOut,scope:a})},afterRender:function(){var a=this,b;a.callParent(arguments),a.tooltip&&(Ext.isObject(a.tooltip)?Ext.tip.QuickTipManager.register(Ext.apply({target:a.id},a.tooltip)):(b=a.tooltipType=="qtip"?"data-qtip":"title",a.toolEl.dom.setAttribute(b,a.tooltip)))},getFocusEl:function(){return this.el},setType:function(a){var b=this;return b.type=a,b.rendered&&(b.toolEl.dom.className=b.baseCls+"-"+a),b},bindTo:function(a){this.owner=a},onClick:function(a,b){var c=this,d;return c.disabled?!1:(d=c.owner||c.ownerCt,c.el.removeCls(c.toolPressedCls),c.el.removeCls(c.toolOverCls),c.stopEvent!==!1&&a.stopEvent(),Ext.callback(c.handler,c.scope||c,[a,b,d,c]),c.fireEvent("click",c,a),!0)},onDestroy:function(){Ext.isObject(this.tooltip)&&Ext.tip.QuickTipManager.unregister(this.id),this.callParent()},onMouseDown:function(){if(this.disabled)return!1;this.el.addCls(this.toolPressedCls)},onMouseOver:function(){if(this.disabled)return!1;this.el.addCls(this.toolOverCls)},onMouseOut:function(){this.el.removeCls(this.toolOverCls)}}),Ext.define("Ext.toolbar.Paging",{extend:"Ext.toolbar.Toolbar",alias:"widget.pagingtoolbar",alternateClassName:"Ext.PagingToolbar",requires:["Ext.toolbar.TextItem","Ext.form.field.Number"],mixins:{bindable:"Ext.util.Bindable"},displayInfo:!1,prependButtons:!1,displayMsg:"Displaying {0} - {1} of {2}",emptyMsg:"No data to display",beforePageText:"Page",afterPageText:"of {0}",firstText:"First Page",prevText:"Previous Page",nextText:"Next Page",lastText:"Last Page",refreshText:"Refresh",inputItemWidth:30,getPagingItems:function(){var a=this;return[{itemId:"first",tooltip:a.firstText,overflowText:a.firstText,iconCls:Ext.baseCSSPrefix+"tbar-page-first",disabled:!0,handler:a.moveFirst,scope:a},{itemId:"prev",tooltip:a.prevText,overflowText:a.prevText,iconCls:Ext.baseCSSPrefix+"tbar-page-prev",disabled:!0,handler:a.movePrevious,scope:a},"-",a.beforePageText,{xtype:"numberfield",itemId:"inputItem",name:"inputItem",cls:Ext.baseCSSPrefix+"tbar-page-number",allowDecimals:!1,minValue:1,hideTrigger:!0,enableKeyEvents:!0,keyNavEnabled:!1,selectOnFocus:!0,submitValue:!1,isFormField:!1,width:a.inputItemWidth,margins:"-1 2 3 2",listeners:{scope:a,keydown:a.onPagingKeyDown,blur:a.onPagingBlur}},{xtype:"tbtext",itemId:"afterTextItem",text:Ext.String.format(a.afterPageText,1)},"-",{itemId:"next",tooltip:a.nextText,overflowText:a.nextText,iconCls:Ext.baseCSSPrefix+"tbar-page-next",disabled:!0,handler:a.moveNext,scope:a},{itemId:"last",tooltip:a.lastText,overflowText:a.lastText,iconCls:Ext.baseCSSPrefix+"tbar-page-last",disabled:!0,handler:a.moveLast,scope:a},"-",{itemId:"refresh",tooltip:a.refreshText,overflowText:a.refreshText,iconCls:Ext.baseCSSPrefix+"tbar-loading",handler:a.doRefresh,scope:a}]},initComponent:function(){var a=this,b=a.getPagingItems(),c=a.items||a.buttons||[];a.prependButtons?a.items=c.concat(b):a.items=b.concat(c),delete a.buttons,a.displayInfo&&(a.items.push("->"),a.items.push({xtype:"tbtext",itemId:"displayItem"})),a.callParent(),a.addEvents("change","beforechange"),a.on("beforerender",a.onLoad,a,{single:!0}),a.bindStore(a.store||"ext-empty-store",!0)},updateInfo:function(){var a=this,b=a.child("#displayItem"),c=a.store,d=a.getPageData(),e,f;b&&(e=c.getCount(),e===0?f=a.emptyMsg:f=Ext.String.format(a.displayMsg,d.fromRecord,d.toRecord,d.total),b.setText(f))},onLoad:function(){var a=this,b,c,d,e,f,g;f=a.store.getCount(),g=f===0,g?(c=0,d=0,e=Ext.String.format(a.afterPageText,0)):(b=a.getPageData(),c=b.currentPage,d=b.pageCount,e=Ext.String.format(a.afterPageText,isNaN(d)?1:d)),Ext.suspendLayouts(),a.child("#afterTextItem").setText(e),a.child("#inputItem").setDisabled(g).setValue(c),a.child("#first").setDisabled(c===1||g),a.child("#prev").setDisabled(c===1||g),a.child("#next").setDisabled(c===d||g),a.child("#last").setDisabled(c===d||g),a.child("#refresh").enable(),a.updateInfo(),Ext.resumeLayouts(!0),a.rendered&&a.fireEvent("change",a,b)},getPageData:function(){var a=this.store,b=a.getTotalCount();return{total:b,currentPage:a.currentPage,pageCount:Math.ceil(b/a.pageSize),fromRecord:(a.currentPage-1)*a.pageSize+1,toRecord:Math.min(a.currentPage*a.pageSize,b)}},onLoadError:function(){if(!this.rendered)return;this.child("#refresh").enable()},readPageFromInput:function(a){var b=this.child("#inputItem").getValue(),c=parseInt(b,10);return!b||isNaN(c)?(this.child("#inputItem").setValue(a.currentPage),!1):c},onPagingFocus:function(){this.child("#inputItem").select()},onPagingBlur:function(a){var b=this.getPageData().currentPage;this.child("#inputItem").setValue(b)},onPagingKeyDown:function(a,b){var c=this,d=b.getKey(),e=c.getPageData(),f=b.shiftKey?10:1,g;if(d==b.RETURN)b.stopEvent(),g=c.readPageFromInput(e),g!==!1&&(g=Math.min(Math.max(1,g),e.pageCount),c.fireEvent("beforechange",c,g)!==!1&&c.store.loadPage(g));else if(d==b.HOME||d==b.END)b.stopEvent(),g=d==b.HOME?1:e.pageCount,a.setValue(g);else if(d==b.UP||d==b.PAGE_UP||d==b.DOWN||d==b.PAGE_DOWN){b.stopEvent(),g=c.readPageFromInput(e);if(g){if(d==b.DOWN||d==b.PAGE_DOWN)f*=-1;g+=f,g>=1&&g<=e.pageCount&&a.setValue(g)}}},beforeLoad:function(){this.rendered&&this.refresh&&this.refresh.disable()},moveFirst:function(){this.fireEvent("beforechange",this,1)!==!1&&this.store.loadPage(1)},movePrevious:function(){var a=this,b=a.store.currentPage-1;b>0&&a.fireEvent("beforechange",a,b)!==!1&&a.store.previousPage()},moveNext:function(){var a=this,b=a.getPageData().pageCount,c=a.store.currentPage+1;c<=b&&a.fireEvent("beforechange",a,c)!==!1&&a.store.nextPage()},moveLast:function(){var a=this,b=a.getPageData().pageCount;a.fireEvent("beforechange",a,b)!==!1&&a.store.loadPage(b)},doRefresh:function(){var a=this,b=a.store.currentPage;a.fireEvent("beforechange",a,b)!==!1&&a.store.loadPage(b)},getStoreListeners:function(){return{beforeload:this.beforeLoad,load:this.onLoad,exception:this.onLoadError}},unbind:function(a){this.bindStore(null)},bind:function(a){this.bindStore(a)},onDestroy:function(){this.unbind(),this.callParent()}}),Ext.define("Ext.tree.Column",{extend:"Ext.grid.column.Column",alias:"widget.treecolumn",tdCls:Ext.baseCSSPrefix+"grid-cell-treecolumn",initComponent:function(){var a=this.renderer||this.defaultRenderer,b=this.scope||window;this.renderer=function(c,d,e,f,g,h,i){var j=[],k=Ext.String.format,l=e.getDepth(),m=Ext.baseCSSPrefix+"tree-",n=m+"elbow-",o=m+"expander",p='<img src="{1}" class="{0}" />',q='<input type="button" role="checkbox" class="{0}" {1} />',r=a.apply(b,arguments),s=e.get("href"),t=e.get("hrefTarget"),u=e.get("cls");while(e){if(!e.isRoot()||e.isRoot()&&i.rootVisible)e.getDepth()===l?(j.unshift(k(p,m+"icon "+m+"icon"+(e.get("icon")?"-inline ":e.isLeaf()?"-leaf ":"-parent ")+(e.get("iconCls")||""),e.get("icon")||Ext.BLANK_IMAGE_URL)),e.get("checked")!==null&&(j.unshift(k(q,m+"checkbox"+(e.get("checked")?" "+m+"checkbox-checked":""),e.get("checked")?'aria-checked="true"':"")),e.get("checked")&&(d.tdCls+=" "+m+"checked")),e.isLast()?e.isExpandable()?j.unshift(k(p,n+"end-plus "+o,Ext.BLANK_IMAGE_URL)):j.unshift(k(p,n+"end",Ext.BLANK_IMAGE_URL)):e.isExpandable()?j.unshift(k(p,n+"plus "+o,Ext.BLANK_IMAGE_URL)):j.unshift(k(p,m+"elbow",Ext.BLANK_IMAGE_URL))):e.isLast()||e.getDepth()===0?j.unshift(k(p,n+"empty",Ext.BLANK_IMAGE_URL)):e.getDepth()!==0&&j.unshift(k(p,n+"line",Ext.BLANK_IMAGE_URL));e=e.parentNode}return s?j.push('<a href="',s,'" target="',t,'">',r,"</a>"):j.push(r),u&&(d.tdCls+=" "+u),j.join("")},this.callParent(arguments)},defaultRenderer:function(a){return a}}),Ext.define("Ext.view.DragZone",{extend:"Ext.dd.DragZone",containerScroll:!1,constructor:function(a){var b=this;Ext.apply(b,a),b.ddGroup||(b.ddGroup="view-dd-zone-"+b.view.id),b.callParent([b.view.el.dom.parentNode]),b.ddel=Ext.get(document.createElement("div")),b.ddel.addCls(Ext.baseCSSPrefix+"grid-dd-wrap")},init:function(a,b,c){this.initTarget(a,b,c),this.view.mon(this.view,{itemmousedown:this.onItemMouseDown,scope:this})},onItemMouseDown:function(a,b,c,d,e){if(!this.isPreventDrag(e,b,c,d)){this.handleMouseDown(e);if(a.getSelectionModel().selectionMode=="MULTI"&&!e.ctrlKey&&a.getSelectionModel().isSelected(b))return!1}},isPreventDrag:function(a){return!1},getDragData:function(a){var b=this.view,c=a.getTarget(b.getItemSelector());if(c)return{copy:b.copy||b.allowCopy&&a.ctrlKey,event:new Ext.EventObjectImpl(a),view:b,ddel:this.ddel,item:c,records:b.getSelectionModel().getSelection(),fromPosition:Ext.fly(c).getXY()}},onInitDrag:function(a,b){var c=this,d=c.dragData,e=d.view,f=e.getSelectionModel(),g=e.getRecord(d.item),h=d.event;return(!f.isSelected(g)||h.hasModifier())&&f.selectWithEvent(g,h,!0),d.records=f.getSelection(),c.ddel.update(c.getDragText()),c.proxy.update(c.ddel.dom),c.onStartDrag(a,b),!0},getDragText:function(){var a=this.dragData.records.length;return Ext.String.format(this.dragText,a,a==1?"":"s")},getRepairXY:function(a,b){return b?b.fromPosition:!1}}),Ext.define("Ext.tree.ViewDragZone",{extend:"Ext.view.DragZone",isPreventDrag:function(a,b){return b.get("allowDrag")===!1||!!a.getTarget(this.view.expanderSelector)},afterRepair:function(){var a=this,b=a.view,c=b.selectedItemCls,d=a.dragData.records,e,f=d.length,g=Ext.fly,h;if(Ext.enableFx&&a.repairHighlight)for(e=0;e<f;e++)h=b.getNode(d[e]),g(h.firstChild).highlight(a.repairHighlightColor,{listeners:{beforeanimate:function(){b.isSelected(h)&&g(h).removeCls(c)},afteranimate:function(){b.isSelected(h)&&g(h).addCls(c)}}});a.dragging=!1}}),Ext.define("Ext.view.DropZone",{extend:"Ext.dd.DropZone",indicatorHtml:'<div class="'+Ext.baseCSSPrefix+'grid-drop-indicator-left"></div><div class="'+Ext.baseCSSPrefix+'grid-drop-indicator-right"></div>',indicatorCls:Ext.baseCSSPrefix+"grid-drop-indicator",constructor:function(a){var b=this;Ext.apply(b,a),b.ddGroup||(b.ddGroup="view-dd-zone-"+b.view.id),b.callParent([b.view.el])},fireViewEvent:function(){var a=this,b;return a.lock(),b=a.view.fireEvent.apply(a.view,arguments),a.unlock(),b},getTargetFromEvent:function(a){var b=a.getTarget(this.view.getItemSelector()),c,d,e,f,g,h;if(!b){c=a.getPageY();for(f=0,d=this.view.getNodes(),g=d.length;f<g;f++){e=d[f],h=Ext.fly(e).getBox();if(c<=h.bottom)return e}}return b},getIndicator:function(){var a=this;return a.indicator||(a.indicator=new Ext.Component({html:a.indicatorHtml,cls:a.indicatorCls,ownerCt:a.view,floating:!0,shadow:!1})),a.indicator},getPosition:function(a,b){var c=a.getXY()[1],d=Ext.fly(b).getRegion(),e;return d.bottom-c>=(d.bottom-d.top)/2?e="before":e="after",e},containsRecordAtOffset:function(a,b,c){if(!b)return!1;var d=this.view,e=d.indexOf(b),f=d.getNode(e+c),g=f?d.getRecord(f):null;return g&&Ext.Array.contains(a,g)},positionIndicator:function(a,b,c){var d=this,e=d.view,f=d.getPosition(c,a),g=e.getRecord(a),h=b.records,i;if(!Ext.Array.contains(h,g)&&(f=="before"&&!d.containsRecordAtOffset(h,g,-1)||f=="after"&&!d.containsRecordAtOffset(h,g,1))){d.valid=!0;if(d.overRecord!=g||d.currentPosition!=f)i=Ext.fly(a).getY()-e.el.getY()-1,f=="after"&&(i+=Ext.fly(a).getHeight()),d.getIndicator().setWidth(Ext.fly(e.el).getWidth()).showAt(0,i),d.overRecord=g,d.currentPosition=f}else d.invalidateDrop()},invalidateDrop:function(){this.valid&&(this.valid=!1,this.getIndicator().hide())},onNodeOver:function(a,b,c,d){var e=this;return Ext.Array.contains(d.records,e.view.getRecord(a))||e.positionIndicator(a,d,c),e.valid?e.dropAllowed:e.dropNotAllowed},notifyOut:function(a,b,c,d){var e=this;e.callParent(arguments),delete e.overRecord,delete e.currentPosition,e.indicator&&e.indicator.hide()},onContainerOver:function(a,b,c){var d=this,e=d.view,f=e.store.getCount();return f?d.positionIndicator(e.getNode(f-1),c,b):(delete d.overRecord,delete d.currentPosition,d.getIndicator().setWidth(Ext.fly(e.el).getWidth()).showAt(0,0),d.valid=!0),d.dropAllowed},onContainerDrop:function(a,b,c){return this.onNodeDrop(a,null,b,c)},onNodeDrop:function(a,b,c,d){var e=this,f=!1,g={wait:!1,processDrop:function(){e.invalidateDrop(),e.handleNodeDrop(d,e.overRecord,e.currentPosition),f=!0,e.fireViewEvent("drop",a,d,e.overRecord,e.currentPosition)},cancelDrop:function(){e.invalidateDrop(),f=!0}},h=!1;if(e.valid){h=e.fireViewEvent("beforedrop",a,d,e.overRecord,e.currentPosition,g);if(g.wait)return;h!==!1&&(f||g.processDrop())}return h},destroy:function(){Ext.destroy(this.indicator),delete this.indicator,this.callParent()}}),Ext.define("Ext.grid.ViewDropZone",{extend:"Ext.view.DropZone",indicatorHtml:'<div class="'+Ext.baseCSSPrefix+'grid-drop-indicator-left"></div><div class="'+Ext.baseCSSPrefix+'grid-drop-indicator-right"></div>',indicatorCls:Ext.baseCSSPrefix+"grid-drop-indicator",handleNodeDrop:function(a,b,c){var d=this.view,e=d.getStore(),f,g,h,i;if(a.copy){g=a.records,a.records=[];for(h=0,i=g.length;h<i;h++)a.records.push(g[h].copy(g[h].getId()))}else a.view.store.remove(a.records,a.view===d);f=e.indexOf(b),c!=="before"&&f++,e.insert(f,a.records),d.getSelectionModel().select(a.records)}}),Ext.define("Ext.tree.ViewDropZone",{extend:"Ext.view.DropZone",allowParentInserts:!1,allowContainerDrops:!1,appendOnly:!1,expandDelay:500,indicatorCls:Ext.baseCSSPrefix+"tree-ddindicator",expandNode:function(a){var b=this.view;!a.isLeaf()&&!a.isExpanded()&&(b.expand(a),this.expandProcId=!1)},queueExpand:function(a){this.expandProcId=Ext.Function.defer(this.expandNode,this.expandDelay,this,[a])},cancelExpand:function(){this.expandProcId&&(clearTimeout(this.expandProcId),this.expandProcId=!1)},getPosition:function(a,b){var c=this.view,d=c.getRecord(b),e=a.getPageY(),f=d.isLeaf(),g=!1,h=Ext.fly(b).getRegion(),i;return d.isRoot()?"append":this.appendOnly?f?!1:"append":(this.allowParentInsert||(g=d.hasChildNodes()&&d.isExpanded()),i=(h.bottom-h.top)/(f?2:3),e>=h.top&&e<h.top+i?"before":!g&&(f||e>=h.bottom-i&&e<=h.bottom)?"after":"append")},isValidDropPoint:function(a,b,c,d,e){if(!a||!e.item)return!1;var f=this.view,g=f.getRecord(a),h=e.records,i=h.length,j=h.length,k,l;if(!(g&&b&&i))return!1;for(k=0;k<j;k++){l=h[k];if(l.isNode&&l.contains(g))return!1}return b==="append"&&g.get("allowDrop")===!1?!1:b!="append"&&g.parentNode.get("allowDrop")===!1?!1:Ext.Array.contains(h,g)?!1:!0},onNodeOver:function(a,b,c,d){var e=this.getPosition(c,a),f=this.dropNotAllowed,g=this.view,h=g.getRecord(a),i=this.getIndicator(),j=0,k=0;return this.cancelExpand(),e=="append"&&!this.expandProcId&&!Ext.Array.contains(d.records,h)&&!h.isLeaf()&&!h.isExpanded()&&this.queueExpand(h),this.isValidDropPoint(a,e,b,c,d)?(this.valid=!0,this.currentPosition=e,this.overRecord=h,i.setWidth(Ext.fly(a).getWidth()),k=Ext.fly(a).getY()-Ext.fly(g.el).getY()-1,e=="before"?(f=h.isFirst()?Ext.baseCSSPrefix+"tree-drop-ok-above":Ext.baseCSSPrefix+"tree-drop-ok-between",i.showAt(0,k),b.proxy.show()):e=="after"?(f=h.isLast()?Ext.baseCSSPrefix+"tree-drop-ok-below":Ext.baseCSSPrefix+"tree-drop-ok-between",k+=Ext.fly(a).getHeight(),i.showAt(0,k),b.proxy.show()):(f=Ext.baseCSSPrefix+"tree-drop-ok-append",i.hide())):this.valid=!1,this.currentCls=f,f},onContainerOver:function(a,b,c){return b.getTarget("."+this.indicatorCls)?this.currentCls:this.dropNotAllowed},notifyOut:function(){this.callParent(arguments),this.cancelExpand()},handleNodeDrop:function(a,b,c){var d=this,e=d.view,f=b.parentNode,g=e.getStore(),h=[],i,j,k,l,m,n,o,p;if(a.copy){i=a.records,a.records=[];for(j=0,k=i.length;j<k;j++)a.records.push(Ext.apply({},i[j].data))}d.cancelExpand(),c=="before"?(l=f.insertBefore,m=[null,b],b=f):c=="after"?(b.nextSibling?(l=f.insertBefore,m=[null,b.nextSibling]):(l=f.appendChild,m=[null]),b=f):(b.isExpanded()||(n=!0),l=b.appendChild,m=[null]),o=function(){var c,f,g,i,n;for(j=0,k=a.records.length;j<k;j++)m[0]=a.records[j],c=l.apply(b,m),Ext.enableFx&&d.dropHighlight&&h.push(e.getNode(c));if(Ext.enableFx&&d.dropHighlight){g=h.length,i=d.dropHighlightColor;for(f=0;f<g;f++)n=h[f],n&&Ext.fly(n.firstChild?n.firstChild:n).highlight(i)}},n?b.expand(!1,o):o()}}),Ext.define("Ext.view.TableChunker",{singleton:!0,requires:["Ext.XTemplate"],metaTableTpl:["{%if (this.openTableWrap)out.push(this.openTableWrap())%}",'<table class="'+Ext.baseCSSPrefix+"grid-table "+Ext.baseCSSPrefix+'grid-table-resizer" border="0" cellspacing="0" cellpadding="0" {[this.embedFullWidth(values)]}>',"<tbody>",'<tr class="'+Ext.baseCSSPrefix+'grid-header-row">','<tpl for="columns">','<th class="'+Ext.baseCSSPrefix+'grid-col-resizer-{id}" style="width: {width}px; height: 0px;"></th>',"</tpl>","</tr>","{[this.openRows()]}","{row}",'<tpl for="features">',"{[this.embedFeature(values, parent, xindex, xcount)]}","</tpl>","{[this.closeRows()]}","</tbody>","</table>","{%if (this.closeTableWrap)out.push(this.closeTableWrap())%}"],constructor:function(){Ext.XTemplate.prototype.recurse=function(a,b){return this.apply(b?a[b]:a)}},embedFeature:function(a,b,c,d){var e="";return a.disabled||(e=a.getFeatureTpl(a,b,c,d)),e},embedFullWidth:function(a){var b='style="width:{fullWidth}px;';return a.rowCount||(b+="height:1px;"),b+'"'},openRows:function(){return'<tpl for="rows">'},closeRows:function(){return"</tpl>"},metaRowTpl:['<tr class="'+Ext.baseCSSPrefix+'grid-row {[this.embedRowCls()]}" {[this.embedRowAttr()]}>','<tpl for="columns">','<td class="{cls} '+Ext.baseCSSPrefix+"grid-cell "+Ext.baseCSSPrefix+'grid-cell-{columnId} {{id}-modified} {{id}-tdCls} {[this.firstOrLastCls(xindex, xcount)]}" {{id}-tdAttr}>','<div {unselectableAttr} class="'+Ext.baseCSSPrefix+'grid-cell-inner {unselectableCls}" style="text-align: {align}; {{id}-style};">{{id}}</div>',"</td>","</tpl>","</tr>"],firstOrLastCls:function(a,b){if(a===1)return Ext.view.Table.prototype.firstCls;if(a===b)return Ext.view.Table.prototype.lastCls},embedRowCls:function(){return"{rowCls}"},embedRowAttr:function(){return"{rowAttr}"},openTableWrap:undefined,closeTableWrap:undefined,getTableTpl:function(a,b){var c,d={openRows:this.openRows,closeRows:this.closeRows,embedFeature:this.embedFeature,embedFullWidth:this.embedFullWidth,openTableWrap:this.openTableWrap,closeTableWrap:this.closeTableWrap},e={},f=a.features||[],g=f.length,h=0,i={embedRowCls:this.embedRowCls,embedRowAttr:this.embedRowAttr,firstOrLastCls:this.firstOrLastCls,unselectableAttr:a.enableTextSelection?"":'unselectable="on"',unselectableCls:a.enableTextSelection?"":Ext.baseCSSPrefix+"unselectable"},j=Array.prototype.slice.call(this.metaRowTpl,0),k;for(;h<g;h++)f[h].disabled||(f[h].mutateMetaRowTpl(j),Ext.apply(i,f[h].getMetaRowTplFragments()),Ext.apply(e,f[h].getFragmentTpl()),Ext.apply(d,f[h].getTableFragments()));return j=new Ext.XTemplate(j.join(""),i),a.row=j.applyTemplate(a),k=new Ext.XTemplate(this.metaTableTpl.join(""),d),c=k.applyTemplate(a),b||(c=new Ext.XTemplate(c,e)),c}}),Ext.define("Ext.view.View",{extend:"Ext.view.AbstractView",alternateClassName:"Ext.DataView",alias:"widget.dataview",inheritableStatics:{EventMap:{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut",mouseenter:"MouseEnter",mouseleave:"MouseLeave",keydown:"KeyDown",focus:"Focus"}},addCmpEvents:function(){this.addEvents("beforeitemmousedown","beforeitemmouseup","beforeitemmouseenter","beforeitemmouseleave","beforeitemclick","beforeitemdblclick","beforeitemcontextmenu","beforeitemkeydown","itemmousedown","itemmouseup","itemmouseenter","itemmouseleave","itemclick","itemdblclick","itemcontextmenu","itemkeydown","beforecontainermousedown","beforecontainermouseup","beforecontainermouseover","beforecontainermouseout","beforecontainerclick","beforecontainerdblclick","beforecontainercontextmenu","beforecontainerkeydown","containermouseup","containermouseover","containermouseout","containerclick","containerdblclick","containercontextmenu","containerkeydown","selectionchange","beforeselect","highlightitem","unhighlightitem")},getFocusEl:function(){return this.getTargetEl()},afterRender:function(){var a=this;a.callParent(),a.mon(a.getTargetEl(),{scope:a,freezeEvent:!0,click:a.handleEvent,mousedown:a.handleEvent,mouseup:a.handleEvent,dblclick:a.handleEvent,contextmenu:a.handleEvent,mouseover:a.handleEvent,mouseout:a.handleEvent,keydown:a.handleEvent})},handleEvent:function(a){var b=a.type=="keydown"&&a.getKey();this.processUIEvent(a)!==!1&&this.processSpecialEvent(a),b===a.SPACE&&a.stopEvent()},processItemEvent:Ext.emptyFn,processContainerEvent:Ext.emptyFn,processSpecialEvent:Ext.emptyFn,stillOverItem:function(a,b){var c;return b&&typeof b.offsetParent=="object"?(c=a.type=="mouseout"?a.getRelatedTarget():a.getTarget(),Ext.fly(b).contains(c)):!1},processUIEvent:function(a){var b=this,c=a.getTarget(b.getItemSelector(),b.getTargetEl()),d=this.statics().EventMap,e,f,g=a.type,h=b.mouseOverItem,i;c||(g=="mouseover"&&b.stillOverItem(a,h)&&(c=h),g=="keydown"&&(f=b.getSelectionModel().getLastSelected(),f&&(c=b.getNode(f))));if(c){e=b.indexOf(c),f||(f=b.getRecord(c));if(!f||b.processItemEvent(f,c,e,a)===!1)return!1;i=b.isNewItemEvent(c,a);if(i===!1)return!1;if(b["onBeforeItem"+d[i]](f,c,e,a)===!1||b.fireEvent("beforeitem"+i,b,f,c,e,a)===!1||b["onItem"+d[i]](f,c,e,a)===!1)return!1;b.fireEvent("item"+i,b,f,c,e,a)}else{if(b.processContainerEvent(a)===!1||b["onBeforeContainer"+d[g]](a)===!1||b.fireEvent("beforecontainer"+g,b,a)===!1||b["onContainer"+d[g]](a)===!1)return!1;b.fireEvent("container"+g,b,a)}return!0},isNewItemEvent:function(a,b){var c=this,d=c.mouseOverItem,e=b.type;switch(e){case"mouseover":if(a===d)return!1;return c.mouseOverItem=a,"mouseenter";case"mouseout":if(c.stillOverItem(b,d))return!1;return c.mouseOverItem=null,"mouseleave"}return e},onItemMouseEnter:function(a,b,c,d){this.trackOver&&this.highlightItem(b)},onItemMouseLeave:function(a,b,c,d){this.trackOver&&this.clearHighlight()},onItemMouseDown:Ext.emptyFn,onItemMouseUp:Ext.emptyFn,onItemFocus:Ext.emptyFn,onItemClick:Ext.emptyFn,onItemDblClick:Ext.emptyFn,onItemContextMenu:Ext.emptyFn,onItemKeyDown:Ext.emptyFn,onBeforeItemMouseDown:Ext.emptyFn,onBeforeItemMouseUp:Ext.emptyFn,onBeforeItemFocus:Ext.emptyFn,onBeforeItemMouseEnter:Ext.emptyFn,onBeforeItemMouseLeave:Ext.emptyFn,onBeforeItemClick:Ext.emptyFn,onBeforeItemDblClick:Ext.emptyFn,onBeforeItemContextMenu:Ext.emptyFn,onBeforeItemKeyDown:Ext.emptyFn,onContainerMouseDown:Ext.emptyFn,onContainerMouseUp:Ext.emptyFn,onContainerMouseOver:Ext.emptyFn,onContainerMouseOut:Ext.emptyFn,onContainerClick:Ext.emptyFn,onContainerDblClick:Ext.emptyFn,onContainerContextMenu:Ext.emptyFn,onContainerKeyDown:Ext.emptyFn,onBeforeContainerMouseDown:Ext.emptyFn,onBeforeContainerMouseUp:Ext.emptyFn,onBeforeContainerMouseOver:Ext.emptyFn,onBeforeContainerMouseOut:Ext.emptyFn,onBeforeContainerClick:Ext.emptyFn,onBeforeContainerDblClick:Ext.emptyFn,onBeforeContainerContextMenu:Ext.emptyFn,onBeforeContainerKeyDown:Ext.emptyFn,highlightItem:function(a){var b=this;b.clearHighlight(),b.highlightedItem=a,Ext.fly(a).addCls(b.overItemCls),b.fireEvent("highlightitem",b,a)},clearHighlight:function(){var a=this,b=a.highlightedItem;b&&(Ext.fly(b).removeCls(a.overItemCls),a.fireEvent("unhighlightitem",a,b),delete a.highlightedItem)},onUpdate:function(a,b){var c=this,d,e,f;c.rendered&&(d=c.getNode(b),e=c.callParent(arguments),f=c.highlightedItem,f&&f===d&&(delete c.highlightedItem,e&&c.highlightItem(e)))},refresh:function(){this.clearHighlight(),this.callParent(arguments)}}),Ext.define("Ext.view.BoundList",{extend:"Ext.view.View",alias:"widget.boundlist",alternateClassName:"Ext.BoundList",requires:["Ext.layout.component.BoundList","Ext.toolbar.Paging"],pageSize:0,baseCls:Ext.baseCSSPrefix+"boundlist",itemCls:Ext.baseCSSPrefix+"boundlist-item",listItemCls:"",shadow:!1,trackOver:!0,refreshed:0,deferInitialRefresh:!1,componentLayout:"boundlist",childEls:["listEl"],renderTpl:['<div id="{id}-listEl" class="{baseCls}-list-ct" style="overflow:auto"></div>',"{%","var me=values.$comp, pagingToolbar=me.pagingToolbar;","if (pagingToolbar) {","pagingToolbar.ownerLayout = me.componentLayout;","Ext.DomHelper.generateMarkup(pagingToolbar.getRenderTree(), out);","}","%}",{disableFormats:!0}],initComponent:function(){var a=this,b=a.baseCls,c=a.itemCls;a.selectedItemCls=b+"-selected",a.overItemCls=b+"-item-over",a.itemSelector="."+c,a.floating&&a.addCls(b+"-floating"),a.tpl?Ext.isString(a.tpl)&&(a.tpl=new Ext.XTemplate(a.tpl)):a.tpl=new Ext.XTemplate('<ul><tpl for=".">','<li role="option" class="'+c+'">'+a.getInnerTpl(a.displayField)+"</li>","</tpl></ul>"),a.pageSize&&(a.pagingToolbar=a.createPagingToolbar()),a.callParent()},up:function(a){var b=this.pickerField;if(a)for(;b;b=b.ownerCt)if(Ext.ComponentQuery.is(b,a))return b;return b},createPagingToolbar:function(){return Ext.widget("pagingtoolbar",{id:this.id+"-paging-toolbar",pageSize:this.pageSize,store:this.store,border:!1})},finishRenderChildren:function(){var a=this.pagingToolbar;this.callParent(arguments),a&&a.finishRender()},refresh:function(){var a=this,b=a.pagingToolbar;a.callParent(),a.rendered&&b&&!a.preserveScrollOnRefresh&&a.el.appendChild(b.el)},bindStore:function(a,b){var c=this.pagingToolbar;this.callParent(arguments),c&&c.bindStore(this.store,b)},getTargetEl:function(){return this.listEl||this.el},getInnerTpl:function(a){return"{"+a+"}"},onDestroy:function(){Ext.destroyMembers(this,"pagingToolbar","listEl"),this.callParent()}}),Ext.define("Ext.picker.Time",{extend:"Ext.view.BoundList",alias:"widget.timepicker",requires:["Ext.data.Store","Ext.Date"],increment:15,format:"g:i A",displayField:"disp",initDate:[2008,0,1],componentCls:Ext.baseCSSPrefix+"timepicker",loadMask:!1,initComponent:function(){var a=this,b=Ext.Date,c=b.clearTime,d=a.initDate;a.absMin=c(new Date(d[0],d[1],d[2])),a.absMax=b.add(c(new Date(d[0],d[1],d[2])),"mi",1439),a.store=a.createStore(),a.updateList(),a.callParent()},setMinValue:function(a){this.minValue=a,this.updateList()},setMaxValue:function(a){this.maxValue=a,this.updateList()},normalizeDate:function(a){var b=this.initDate;return a.setFullYear(b[0],b[1],b[2]),a},updateList:function(){var a=this,b=a.normalizeDate(a.minValue||a.absMin),c=a.normalizeDate(a.maxValue||a.absMax);a.store.filterBy(function(a){var d=a.get("date");return d>=b&&d<=c})},createStore:function(){var a=this,b=Ext.Date,c=[],d=a.absMin,e=a.absMax;while(d<=e)c.push({disp:b.dateFormat(d,a.format),date:d}),d=b.add(d,"mi",a.increment);return new Ext.data.Store({fields:["disp","date"],data:c})}}),Ext.define("Ext.view.BoundListKeyNav",{extend:"Ext.util.KeyNav",requires:"Ext.view.BoundList",constructor:function(a,b){var c=this;c.boundList=b.boundList,c.callParent([a,Ext.apply({},b,c.defaultHandlers)])},defaultHandlers:{up:function(){var a=this,b=a.boundList,c=b.all,d=b.highlightedItem,e=d?b.indexOf(d):-1,f=e>0?e-1:c.getCount()-1;a.highlightAt(f)},down:function(){var a=this,b=a.boundList,c=b.all,d=b.highlightedItem,e=d?b.indexOf(d):-1,f=e<c.getCount()-1?e+1:0;a.highlightAt(f)},pageup:function(){},pagedown:function(){},home:function(){this.highlightAt(0)},end:function(){var a=this;a.highlightAt(a.boundList.all.getCount()-1)},enter:function(a){this.selectHighlighted(a)}},highlightAt:function(a){var b=this.boundList,c=b.all.item(a);c&&(c=c.dom,b.highlightItem(c),b.getTargetEl().scrollChildIntoView(c,!1))},selectHighlighted:function(a){var b=this,c=b.boundList,d=c.highlightedItem,e=c.getSelectionModel();d&&e.selectWithEvent(c.getRecord(d),a)}}),Ext.define("Ext.form.field.ComboBox",{extend:"Ext.form.field.Picker",requires:["Ext.util.DelayedTask","Ext.EventObject","Ext.view.BoundList","Ext.view.BoundListKeyNav","Ext.data.StoreManager","Ext.layout.component.field.ComboBox"],alternateClassName:"Ext.form.ComboBox",alias:["widget.combobox","widget.combo"],mixins:{bindable:"Ext.util.Bindable"},componentLayout:"combobox",triggerCls:Ext.baseCSSPrefix+"form-arrow-trigger",hiddenName:"",hiddenDataCls:Ext.baseCSSPrefix+"hide-display "+Ext.baseCSSPrefix+"form-data-hidden",fieldSubTpl:['<div class="{hiddenDataCls}" role="presentation"></div>','<input id="{id}" type="{type}" {inputAttrTpl} class="{fieldCls} {typeCls}" autocomplete="off"','<tpl if="value"> value="{[Ext.util.Format.htmlEncode(values.value)]}"</tpl>','<tpl if="name"> name="{name}"</tpl>','<tpl if="placeholder"> placeholder="{placeholder}"</tpl>','<tpl if="size"> size="{size}"</tpl>','<tpl if="maxLength !== undefined"> maxlength="{maxLength}"</tpl>','<tpl if="readOnly"> readonly="readonly"</tpl>','<tpl if="disabled"> disabled="disabled"</tpl>','<tpl if="tabIdx"> tabIndex="{tabIdx}"</tpl>','<tpl if="fieldStyle"> style="{fieldStyle}"</tpl>',"/>",{compiled:!0,disableFormats:!0}],getSubTplData:function(){var a=this;return Ext.applyIf(a.subTplData,{hiddenDataCls:a.hiddenDataCls}),a.callParent(arguments)},afterRender:function(){var a=this;a.callParent(arguments),a.setHiddenValue(a.value)},multiSelect:!1,delimiter:", ",displayField:"text",triggerAction:"all",allQuery:"",queryParam:"query",queryMode:"remote",queryCaching:!0,pageSize:0,autoSelect:!0,typeAhead:!1,typeAheadDelay:250,selectOnTab:!0,forceSelection:!1,growToLongestValue:!0,defaultListConfig:{loadingHeight:70,minWidth:70,maxHeight:300,shadow:"sides"},ignoreSelection:0,removingRecords:null,resizeComboToGrow:function(){var a=this;return a.grow&&a.growToLongestValue},initComponent:function(){var a=this,b=Ext.isDefined,c=a.store,d=a.transform,e,f;Ext.applyIf(a.renderSelectors,{hiddenDataEl:"."+a.hiddenDataCls.split(" ").join(".")}),this.addEvents("beforequery","select","beforeselect","beforedeselect"),d&&(e=Ext.getDom(d),e&&(a.store||(c=Ext.Array.map(Ext.Array.from(e.options),function(a){return[a.value,a.text]})),a.name||(a.name=e.name),"value"in a||(a.value=e.value))),a.bindStore(c||"ext-empty-store",!0),c=a.store,c.autoCreated&&(a.queryMode="local",a.valueField=a.displayField="field1",c.expanded||(a.displayField="field2")),b(a.valueField)||(a.valueField=a.displayField),f=a.queryMode==="local",b(a.queryDelay)||(a.queryDelay=f?10:500),b(a.minChars)||(a.minChars=f?0:4),a.displayTpl?Ext.isString(a.displayTpl)&&(a.displayTpl=new Ext.XTemplate(a.displayTpl)):a.displayTpl=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : values["'+a.displayField+'"]]}<tpl if="xindex < xcount">'+a.delimiter+"</tpl></tpl>"),a.callParent(),a.doQueryTask=new Ext.util.DelayedTask(a.doRawQuery,a),a.store.getCount()>0&&a.setValue(a.value),e&&(a.render(e.parentNode,e),Ext.removeNode(e),delete a.renderTo)},getStore:function(){return this.store},beforeBlur:function(){this.doQueryTask.cancel(),this.assertValue()},assertValue:function(){var a=this,b=a.getRawValue(),c;a.forceSelection&&(a.multiSelect?b!==a.getDisplayValue()&&a.setValue(a.lastSelection):(c=a.findRecordByDisplay(b),c?a.select(c):a.setValue(a.lastSelection))),a.collapse()},onTypeAhead:function(){var a=this,b=a.displayField,c=a.store.findRecord(b,a.getRawValue()),d=a.getPicker(),e,f,g;c&&(e=c.get(b),f=e.length,g=a.getRawValue().length,d.highlightItem(d.getNode(c)),g!==0&&g!==f&&(a.setRawValue(e),a.selectText(g,e.length)))},resetToDefault:function(){},onUnbindStore:function(a){var b=this.picker;!a&&b&&b.bindStore(null)},onBindStore:function(a,b){var c=this.picker;b||this.resetToDefault(),c&&c.bindStore(a)},getStoreListeners:function(){var a=this;return{beforeload:a.onBeforeLoad,clear:a.onClear,datachanged:a.onDataChanged,load:a.onLoad,exception:a.onException,remove:a.onRemove}},onBeforeLoad:function(){++this.ignoreSelection},onDataChanged:function(){var a=this;a.resizeComboToGrow()&&a.updateLayout()},onClear:function(){var a=this;a.resizeComboToGrow()&&(a.removingRecords=!0,a.onDataChanged())},onRemove:function(){var a=this;a.resizeComboToGrow()&&(a.removingRecords=!0)},onException:function(){this.ignoreSelection>0&&--this.ignoreSelection,this.collapse()},onLoad:function(){var a=this,b=a.value;a.ignoreSelection>0&&--a.ignoreSelection,a.rawQuery?(a.rawQuery=!1,a.syncSelection(),a.picker&&!a.picker.getSelectionModel().hasSelection()&&a.doAutoSelect()):a.value||a.value===0?a.setValue(a.value):a.store.getCount()?a.doAutoSelect():a.setValue(a.value)},doRawQuery:function(){this.doQuery(this.getRawValue(),!1,!0)},doQuery:function(a,b,c){a=a||"";var d=this,e={query:a,forceAll:b,combo:d,cancel:!1},f=d.store,g=d.queryMode==="local",h;if(d.fireEvent("beforequery",e)===!1||e.cancel)return!1;a=e.query,b=e.forceAll;if(b||a.length>=d.minChars){d.expand();if(!d.queryCaching||d.lastQuery!==a)d.lastQuery=a,g?(f.suspendEvents(),h=d.clearFilter(),a||!b?(d.activeFilter=new Ext.util.Filter({root:"data",property:d.displayField,value:a}),f.filter(d.activeFilter),h=!0):delete d.activeFilter,f.resumeEvents(),d.rendered&&h&&d.getPicker().refresh()):(d.rawQuery=c,d.pageSize?d.loadPage(1):f.load({params:d.getParams(a)}));d.getRawValue()!==d.getDisplayValue()&&(d.ignoreSelection++,d.picker.getSelectionModel().deselectAll(),d.ignoreSelection--),g&&d.doAutoSelect(),d.typeAhead&&d.doTypeAhead()}return!0},clearFilter:function(){var a=this.store,b=a.filters,c=this.activeFilter,d;return c&&(b.getCount()>1&&(b.remove(c),d=b.getRange()),a.clearFilter(!0),d&&a.filter(d)),!!c},loadPage:function(a){this.store.loadPage(a,{params:this.getParams(this.lastQuery)})},onPageChange:function(a,b){return this.loadPage(b),!1},getParams:function(a){var b={},c=this.queryParam;return c&&(b[c]=a),b},doAutoSelect:function(){var a=this,b=a.picker,c,d;b&&a.autoSelect&&a.store.getCount()>0&&(c=b.getSelectionModel().lastSelected,d=b.getNode(c||0),d&&(b.highlightItem(d),b.listEl.scrollChildIntoView(d,!1)))},doTypeAhead:function(){this.typeAheadTask||(this.typeAheadTask=new Ext.util.DelayedTask(this.onTypeAhead,this)),this.lastKey!=Ext.EventObject.BACKSPACE&&this.lastKey!=Ext.EventObject.DELETE&&this.typeAheadTask.delay(this.typeAheadDelay)},onTriggerClick:function(){var a=this;!a.readOnly&&!a.disabled&&(a.isExpanded?a.collapse():(a.onFocus({}),a.triggerAction==="all"?a.doQuery(a.allQuery,!0):a.doQuery(a.getRawValue(),!1,!0)),a.inputEl.focus())},onKeyUp:function(a,b){var c=this,d=a.getKey();!c.readOnly&&!c.disabled&&c.editable&&(c.lastKey=d,(!a.isSpecialKey()||d==a.BACKSPACE||d==a.DELETE)&&c.doQueryTask.delay(c.queryDelay)),c.enableKeyEvents&&c.callParent(arguments)},initEvents:function(){var a=this;a.callParent(),a.enableKeyEvents||a.mon(a.inputEl,"keyup",a.onKeyUp,a)},onDestroy:function(){this.bindStore(null),this.callParent()},onAdded:function(){var a=this;a.callParent(arguments),a.picker&&(a.picker.ownerCt=a.up("[floating]"),a.picker.registerWithOwnerCt())},createPicker:function(){var a=this,b,c=Ext.baseCSSPrefix+"menu",d=Ext.apply({xtype:"boundlist",pickerField:a,selModel:{mode:a.multiSelect?"SIMPLE":"SINGLE"},floating:!0,hidden:!0,ownerCt:a.up("[floating]"),cls:a.el&&a.el.up("."+c)?c:"",store:a.store,displayField:a.displayField,focusOnToFront:!1,pageSize:a.pageSize,tpl:a.tpl},a.listConfig,a.defaultListConfig);return b=a.picker=Ext.widget(d),a.pageSize&&b.pagingToolbar.on("beforechange",a.onPageChange,a),a.mon(b,{itemclick:a.onItemClick,refresh:a.onListRefresh,scope:a}),a.mon(b.getSelectionModel(),{beforeselect:a.onBeforeSelect,beforedeselect:a.onBeforeDeselect,selectionchange:a.onListSelectionChange,scope:a}),b},alignPicker:function(){var a=this,b=a.getPicker(),c=a.getPosition()[1]-Ext.getBody().getScroll().top,d=Ext.Element.getViewHeight()-c-a.getHeight(),e=Math.max(c,d);b.height&&(delete b.height,b.updateLayout()),b.getHeight()>e-5&&b.setHeight(e-5),a.callParent()},onListRefresh:function(){this.alignPicker(),this.syncSelection()},onItemClick:function(a,b){var c=this,d=c.picker.getSelectionModel().getSelection(),e=c.valueField;!c.multiSelect&&d.length&&b.get(e)===d[0].get(e)&&(c.displayTplData=[b.data],c.setRawValue(c.getDisplayValue()),c.collapse())},onBeforeSelect:function(a,b){return this.fireEvent("beforeselect",this,b,b.index)},onBeforeDeselect:function(a,b){return this.fireEvent("beforedeselect",this,b,b.index)},onListSelectionChange:function(a,b){var c=this,d=c.multiSelect,e=b.length>0;!c.ignoreSelection&&c.isExpanded&&(d||Ext.defer(c.collapse,1,c),(d||e)&&c.setValue(b,!1),e&&c.fireEvent("select",c,b),c.inputEl.focus())},onExpand:function(){var a=this,b=a.listKeyNav,c=a.selectOnTab,d=a.getPicker();b?b.enable():b=a.listKeyNav=new Ext.view.BoundListKeyNav(this.inputEl,{boundList:d,forceKeyDown:!0,tab:function(b){return c&&(this.selectHighlighted(b),a.triggerBlur()),!0}}),c&&(a.ignoreMonitorTab=!0),Ext.defer(b.enable,1,b),a.inputEl.focus()},onCollapse:function(){var a=this,b=a.listKeyNav;b&&(b.disable(),a.ignoreMonitorTab=!1)},select:function(a){this.setValue(a,!0)},findRecord:function(a,b){var c=this.store,d=c.findExact(a,b);return d!==-1?c.getAt(d):!1},findRecordByValue:function(a){return this.findRecord(this.valueField,a)},findRecordByDisplay:function(a){return this.findRecord(this.displayField,a)},setValue:function(a,b){var c=this,d=c.valueNotFoundText,e=c.inputEl,f,g,h,i,j=[],k=[],l=[];if(c.store.loading)return c.value=a,c.setHiddenValue(c.value),c;a=Ext.Array.from(a);for(f=0,g=a.length;f<g;f++){h=a[f];if(!h||!h.isModel)h=c.findRecordByValue(h);h?(j.push(h),k.push(h.data),l.push(h.get(c.valueField))):c.forceSelection?Ext.isDefined(d)&&k.push(d):(l.push(a[f]),i={},i[c.displayField]=a[f],k.push(i))}return c.setHiddenValue(l),c.value=c.multiSelect?l:l[0],Ext.isDefined(c.value)||(c.value=null),c.displayTplData=k,c.lastSelection=c.valueModels=j,e&&c.emptyText&&!Ext.isEmpty(a)&&e.removeCls(c.emptyCls),c.setRawValue(c.getDisplayValue()),c.checkChange(),b!==!1&&c.syncSelection(),c.applyEmptyText(),c},setHiddenValue:function(a){var b=this,c=b.hiddenName,d,e,f,g,h,i;if(!b.hiddenDataEl||!c)return;a=Ext.Array.from(a),e=b.hiddenDataEl.dom,f=e.childNodes,g=f[0],h=a.length,i=f.length,!g&&h>0&&(b.hiddenDataEl.update(Ext.DomHelper.markup({tag:"input",type:"hidden",name:c})),i=1,g=e.firstChild);while(i>h)e.removeChild(f[0]),--i;while(i<h)e.appendChild(g.cloneNode(!0)),++i;for(d=0;d<h;d++)f[d].value=a[d]},getDisplayValue:function(){return this.displayTpl.apply(this.displayTplData)},getValue:function(){var a=this,b=a.picker,c=a.getRawValue(),d=a.value;return a.getDisplayValue()!==c&&(d=c,a.value=a.displayTplData=a.valueModels=null,b&&(a.ignoreSelection++,b.getSelectionModel().deselectAll(),a.ignoreSelection--)),d},getSubmitValue:function(){return this.getValue()},isEqual:function(a,b){var c=Ext.Array.from,d,e;a=c(a),b=c(b),e=a.length;if(e!==b.length)return!1;for(d=0;d<e;d++)if(b[d]!==a[d])return!1;return!0},clearValue:function(){this.setValue([])},syncSelection:function(){var a=this,b=a.picker,c,d,e=a.valueModels||[],f=e.length,g,h;if(b){c=[];for(g=0;g<f;g++)h=e[g],h&&h.isModel&&a.store.indexOf(h)>=0&&c.push(h);a.ignoreSelection++,d=b.getSelectionModel(),d.deselectAll(),c.length&&d.select(c),a.ignoreSelection--}},onEditorTab:function(a){var b=this.listKeyNav;this.selectOnTab&&b&&b.selectHighlighted(a)}}),Ext.define("Ext.form.field.Time",{extend:"Ext.form.field.ComboBox",alias:"widget.timefield",requires:["Ext.form.field.Date","Ext.picker.Time","Ext.view.BoundListKeyNav","Ext.Date"],alternateClassName:["Ext.form.TimeField","Ext.form.Time"],triggerCls:Ext.baseCSSPrefix+"form-time-trigger",minText:"The time in this field must be equal to or after {0}",maxText:"The time in this field must be equal to or before {0}",invalidText:"{0} is not a valid time",format:"g:i A",submitFormat:"g:i A",altFormats:"g:ia|g:iA|g:i a|g:i A|h:i|g:i|H:i|ga|ha|gA|h a|g a|g A|gi|hi|gia|hia|g|H|gi a|hi a|giA|hiA|gi A|hi A",increment:15,pickerMaxHeight:300,selectOnTab:!0,snapToIncrement:!1,initDate:"1/1/2008",initDateFormat:"j/n/Y",ignoreSelection:0,queryMode:"local",displayField:"disp",valueField:"date",initComponent:function(){var a=this,b=a.minValue,c=a.maxValue;b&&a.setMinValue(b),c&&a.setMaxValue(c),a.displayTpl=new Ext.XTemplate('<tpl for=".">{[typeof values === "string" ? values : this.formatDate(values["'+a.displayField+'"])]}<tpl if="xindex < xcount">'+a.delimiter+"</tpl></tpl>",{formatDate:Ext.Function.bind(a.formatDate,a)}),this.callParent()},setMinValue:function(a){var b=this,c=b.picker;b.setLimit(a,!0),c&&c.setMinValue(b.minValue)},setMaxValue:function(a){var b=this,c=b.picker;b.setLimit(a,!1),c&&c.setMaxValue(b.maxValue)},setLimit:function(a,b){var c=this,d,e;Ext.isString(a)?d=c.parseDate(a):Ext.isDate(a)&&(d=a),d?(e=Ext.Date.clearTime(new Date(c.initDate)),e.setHours(d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds())):e=null,c[b?"minValue":"maxValue"]=e},rawToValue:function(a){return this.parseDate(a)||a||null},valueToRaw:function(a){return this.formatDate(this.parseDate(a))},getErrors:function(a){var b=this,c=Ext.String.format,d=b.callParent(arguments),e=b.minValue,f=b.maxValue,g;return a=b.formatDate(a||b.processRawValue(b.getRawValue())),a===null||a.length<1?d:(g=b.parseDate(a),g?(e&&g<e&&d.push(c(b.minText,b.formatDate(e))),f&&g>f&&d.push(c(b.maxText,b.formatDate(f))),d):(d.push(c(b.invalidText,a,Ext.Date.unescapeFormat(b.format))),d))},formatDate:function(){return Ext.form.field.Date.prototype.formatDate.apply(this,arguments)},parseDate:function(a){var b=this,c=a,d=b.altFormats,e=b.altFormatsArray,f=0,g;if(a&&!Ext.isDate(a)){c=b.safeParse(a,b.format);if(!c&&d){e=e||d.split("|"),g=e.length;for(;f<g&&!c;++f)c=b.safeParse(a,e[f])}}return c&&b.snapToIncrement&&(c=new Date(Ext.Number.snap(c.getTime(),b.increment*60*1e3))),c},safeParse:function(a,b){var c=this,d=Ext.Date,e,f=null;return d.formatContainsDateInfo(b)?f=d.parse(a,b):(e=d.parse(c.initDate+" "+a,c.initDateFormat+" "+b),e&&(f=e)),f},getSubmitValue:function(){var a=this,b=a.submitFormat||a.format,c=a.getValue();return c?Ext.Date.format(c,b):null},createPicker:function(){var a=this,b;return a.listConfig=Ext.apply({xtype:"timepicker",selModel:{mode:"SINGLE"},cls:undefined,minValue:a.minValue,maxValue:a.maxValue,increment:a.increment,format:a.format,maxHeight:a.pickerMaxHeight},a.listConfig),b=a.callParent(),a.store=b.store,b},onItemClick:function(a,b){var c=this,d=a.getSelectionModel().getSelection();d.length>0&&(d=d[0],d&&Ext.Date.isEqual(b.get("date"),d.get("date"))&&c.collapse())},onListSelectionChange:function(a,b){var c=this,d=b[0],e=d?d.get("date"):null;c.ignoreSelection||(c.skipSync=!0,c.setValue(e),c.skipSync=!1,c.fireEvent("select",c,e),c.picker.clearHighlight(),c.collapse(),c.inputEl.focus())},syncSelection:function(){var a=this,b=a.picker,c,d,e,f,g,h,i;if(b&&!a.skipSync){b.clearHighlight(),e=a.getValue(),d=b.getSelectionModel(),a.ignoreSelection++;if(e===null)d.deselectAll();else if(Ext.isDate(e)){f=b.store.data.items,h=f.length;for(g=0;g<h;g++){i=f[g];if(Ext.Date.isEqual(i.get("date"),e)){c=i;break}}d.select(c)}a.ignoreSelection--}},postBlur:function(){var a=this;a.callParent(arguments),a.setRawValue(a.formatDate(a.getValue()))},setValue:function(a){this.getPicker(),this.callParent([this.parseDate(a)])},getValue:function(){var a=this.callParent(arguments);return this.parseDate(a)}}),Ext.define("Ext.view.Table",{extend:"Ext.view.View",alias:"widget.tableview",uses:["Ext.view.TableChunker","Ext.util.DelayedTask","Ext.util.MixedCollection"],baseCls:Ext.baseCSSPrefix+"grid-view",itemSelector:"tr."+Ext.baseCSSPrefix+"grid-row",cellSelector:"td."+Ext.baseCSSPrefix+"grid-cell",rowSelector:"tr."+Ext.baseCSSPrefix+"grid-row",firstCls:Ext.baseCSSPrefix+"grid-cell-first",lastCls:Ext.baseCSSPrefix+"grid-cell-last",headerRowSelector:"tr."+Ext.baseCSSPrefix+"grid-header-row",selectedItemCls:Ext.baseCSSPrefix+"grid-row-selected",selectedCellCls:Ext.baseCSSPrefix+"grid-cell-selected",focusedItemCls:Ext.baseCSSPrefix+"grid-row-focused",overItemCls:Ext.baseCSSPrefix+"grid-row-over",altRowCls:Ext.baseCSSPrefix+"grid-row-alt",rowClsRe:new RegExp("(?:^|\\s*)"+Ext.baseCSSPrefix+"grid-row-(first|last|alt)(?:\\s+|$)","g"),cellRe:new RegExp(Ext.baseCSSPrefix+"grid-cell-([^\\s]+) ",""),trackOver:!0,getRowClass:null,stripeRows:!0,markDirty:!0,initComponent:function(){var a=this,b=a.scroll;a.autoScroll=undefined,b===!0||b==="both"?a.style=Ext.apply(a.style||{},{overflow:"auto"}):b==="horizontal"?a.style=Ext.apply(a.style||{},{"overflow-x":"auto","overflow-y":"hidden"}):b==="vertical"?a.style=Ext.apply(a.style||{},{"overflow-x":"hidden","overflow-y":"auto"}):a.style=Ext.apply(a.style||{},{overflow:"hidden"}),a.selModel.view=a,a.headerCt.view=a,a.headerCt.markDirty=a.markDirty,a.initFeatures(a.grid),delete a.grid,a.tpl="<div></div>",a.callParent()},moveColumn:function(a,b,c){var d=this,e=c>1?document.createDocumentFragment():undefined,f=b,g=d.getGridColumns().length,h=g-1,i=(d.firstCls||d.lastCls)&&(b==0||b==g||a==0||a==h),j,k,l,m,n,o;if(d.rendered){o=d.el.query(d.headerRowSelector),l=d.el.query(d.rowSelector),b>a&&e&&(f-=c);for(j=0,m=o.length;j<m;++j){n=o[j];if(e){for(k=0;k<c;k++)e.appendChild(n.cells[a]);n.insertBefore(e,n.cells[f]||null)}else n.insertBefore(n.cells[a],n.cells[f]||null)}for(j=0,m=l.length;j<m;j++){n=l[j],i&&(a===0?(Ext.fly(n.cells[0]).removeCls(d.firstCls),Ext.fly(n.cells[1]).addCls(d.firstCls)):a===h&&(Ext.fly(n.cells[h]).removeCls(d.lastCls),Ext.fly(n.cells[h-1]).addCls(d.lastCls)),b===0?(Ext.fly(n.cells[0]).removeCls(d.firstCls),Ext.fly(n.cells[a]).addCls(d.firstCls)):b===g&&(Ext.fly(n.cells[h]).removeCls(d.lastCls),Ext.fly(n.cells[a]).addCls(d.lastCls)));if(e){for(k=0;k<c;k++)e.appendChild(n.cells[a]);n.insertBefore(e,n.cells[f]||null)}else n.insertBefore(n.cells[a],n.cells[f]||null)}d.setNewTemplate()}},scrollToTop:Ext.emptyFn,addElListener:function(a,b,c){this.mon(this,a,b,c,{element:"el"})},getGridColumns:function(){return this.headerCt.getGridColumns()},getHeaderAtIndex:function(a){return this.headerCt.getHeaderAtIndex(a)},getCell:function(a,b){var c=this.getNode(a);return Ext.fly(c).down(b.getCellSelector())},getFeature:function(a){var b=this.featuresMC;if(b)return b.get(a)},initFeatures:function(a){var b=this,c,d,e,f;b.featuresMC=new Ext.util.MixedCollection,d=b.features=b.prepareFeatures(),f=d?d.length:0;for(c=0;c<f;c++)e=d[c],e.view=b,e.grid=a,b.featuresMC.add(e),e.init()},prepareFeatures:function(){var a=this,b=a.features,c,d,e=0,f;if(b){d=[],f=b.length;for(;e<f;e++)c=b[e],c.isFeature||(c=Ext.create("feature."+c.ftype,c)),d[e]=c}return d},attachEventsForFeatures:function(){var a=this.features,b=a.length,c=0;for(;c<b;c++)a[c].isFeature&&a[c].attachEvents()},afterRender:function(){var a=this;a.callParent(),a.enableTextSelection||a.el.unselectable(),a.attachEventsForFeatures()},onViewScroll:function(a,b){this.callParent(arguments),this.fireEvent("bodyscroll",a,b)},prepareData:function(a,b,c){var d=this,e=d.headerCt.prepareData(a,b,c,d,d.ownerCt),f=d.features,g=f.length,h=0,i;for(;h<g;h++)i=f[h],i.isFeature&&Ext.apply(e,i.getAdditionalData(a,b,c,e,d));return e},collectData:function(a,b){var c=this.callParent(arguments),d=this.headerCt,e=d.getFullWidth(),f=this.features,g=f.length,h={rows:c,fullWidth:e},i=0,j,k=0,l,m,n,o;l=c.length;if(this.getRowClass)for(;k<l;k++)m={},n=c[k],o=n.rowCls||"",n.rowCls=this.getRowClass(a[k],k,m,this.store)+" "+o;for(;i<g;i++){j=f[i];if(j.isFeature&&j.collectData&&!j.disabled){h=j.collectData(a,c,b,e,h);break}}return h},forceReflow:Ext.isGecko10?function(){var a=this.el.down("table"),b;a&&(b=a.getWidth())}:Ext.emptyFn,onHeaderResize:function(a,b,c){var d=this,e=d.el;e&&(e.select("th."+Ext.baseCSSPrefix+"grid-col-resizer-"+a.id).setWidth(b),e.select("table."+Ext.baseCSSPrefix+"grid-table-resizer").setWidth(d.headerCt.getFullWidth()),d.ignoreTemplate||d.setNewTemplate(),c||d.el.focus(),d.forceReflow())},onHeaderShow:function(a,b,c){var d=this;d.ignoreTemplate=!0,b.oldWidth?(d.onHeaderResize(b,b.oldWidth,c),delete b.oldWidth):b.width&&!b.flex?d.onHeaderResize(b,b.width,c):b.el&&d.onHeaderResize(b,b.el.getWidth(),c),delete d.ignoreTemplate,d.setNewTemplate()},onHeaderHide:function(a,b,c){this.onHeaderResize(b,0,c)},refreshSize:function(){var a=this,b;a.hasLoadingHeight||(b=a.up("tablepanel"),Ext.suspendLayouts(),a.callParent(),b&&Ext.getScrollbarSize().width&&b.updateLayout(),Ext.resumeLayouts(!0))},setNewTemplate:function(){var a=this,b=a.headerCt.getColumnsForTpl(!0);a.tpl=a.getTableChunker().getTableTpl({rowCount:a.store.getCount(),columns:b,features:a.features,enableTextSelection:a.enableTextSelection})},getTableChunker:function(){return this.chunker||Ext.view.TableChunker},addRowCls:function(a,b){var c=this.getNode(a);c&&Ext.fly(c).addCls(b)},removeRowCls:function(a,b){var c=this.getNode(a);c&&Ext.fly(c).removeCls(b)},onRowSelect:function(a){this.addRowCls(a,this.selectedItemCls)},onRowDeselect:function(a){var b=this;b.removeRowCls(a,b.selectedItemCls),b.removeRowCls(a,b.focusedItemCls)},onCellSelect:function(a){var b=this.getCellByPosition(a);b&&b.addCls(this.selectedCellCls)},onCellDeselect:function(a){var b=this.getCellByPosition(a);b&&b.removeCls(this.selectedCellCls)},onCellFocus:function(a){this.focusCell(a)},getCellByPosition:function(a){if(a){var b=this.getNode(a.row),c=this.headerCt.getHeaderAtIndex(a.column);if(c&&b)return Ext.fly(b).down(c.getCellSelector())}return!1},onRowFocus:function(a,b,c){var d=this;b?(d.addRowCls(a,d.focusedItemCls),c||d.focusRow(a)):d.removeRowCls(a,d.focusedItemCls)},focusRow:function(a){var b=this,c=b.getNode(a),d=b.el,e=0,f=b.ownerCt,g,h,i,j;c&&d&&(h=d.getY(),i=h+d.dom.clientHeight,g=Ext.fly(c).getRegion(),g.top<h?e=g.top-h:g.bottom>i&&(e=g.bottom-i),j=b.getRecord(c),a=b.store.indexOf(j),e&&f.scrollByDeltaY(e),b.fireEvent("rowfocus",j,c,a))},focusCell:function(a){var b=this,c=b.getCellByPosition(a),d=b.el,e=0,f=0,g=d.getRegion(),h=b.ownerCt,i,j;g.bottom=g.top+d.dom.clientHeight,g.right=g.left+d.dom.clientWidth,c&&(i=c.getRegion(),i.top<g.top?e=i.top-g.top:i.bottom>g.bottom&&(e=i.bottom-g.bottom),i.left<g.left?f=i.left-g.left:i.right>g.right&&(f=i.right-g.right),e&&h.scrollByDeltaY(e),f&&h.scrollByDeltaX(f),d.focus(),b.fireEvent("cellfocus",j,c,a))},scrollByDelta:function(a,b){b=b||"scrollTop";var c=this.el.dom;c[b]=c[b]+=a},onUpdate:function(a,b,c,d){var e=this,f,g,h,i,j,k,l,m,n,o,p;if(e.rendered){f=e.store.indexOf(b),m=e.headerCt.getGridColumns(),n=e.overItemCls;if(m.length&&f>-1){g=e.bufferRender([b],f)[0],h=e.all.item(f),o=h.hasCls(n),h.dom.className=g.className,o&&h.addCls(n),i=h.query(this.cellSelector),j=Ext.fly(g).query(this.cellSelector),k=j.length,p=i[0].parentNode;for(l=0;l<k;l++)e.shouldUpdateCell(m[l],d)&&(p.insertBefore(j[l],i[l]),p.removeChild(i[l]));e.selModel.refresh(),e.doStripeRows(f,f),e.fireEvent("itemupdate",b,f,g)}}},shouldUpdateCell:function(a,b){return a.hasCustomRenderer?!0:!b||Ext.Array.contains(b,a.dataIndex)},refresh:function(){this.setNewTemplate(),this.callParent(arguments),this.doStripeRows(0)},processItemEvent:function(a,b,c,d){var e=this,f=d.getTarget(e.cellSelector,b),g=f?f.cellIndex:-1,h=e.statics().EventMap,i=e.getSelectionModel(),j=d.type,k;return j=="keydown"&&!f&&i.getCurrentPosition&&(f=e.getCellByPosition(i.getCurrentPosition()),f&&(f=f.dom,g=f.cellIndex)),k=e.fireEvent("uievent",j,e,f,c,g,d,a,b),k===!1||e.callParent(arguments)===!1?!1:j=="mouseover"||j=="mouseout"?!0:f?e["onBeforeCell"+h[j]](f,g,a,b,c,d)!==!1&&e.fireEvent("beforecell"+j,e,f,g,a,b,c,d)!==!1&&e["onCell"+h[j]](f,g,a,b,c,d)!==!1&&e.fireEvent("cell"+j,e,f,g,a,b,c,d)!==!1:!0},processSpecialEvent:function(a){var b=this,c=b.statics().EventMap,d=b.features,e=d.length,f=a.type,g,h,i,j,k,l,m=b.ownerCt;b.callParent(arguments);if(f=="mouseover"||f=="mouseout")return;for(g=0;g<e;g++){h=d[g];if(h.hasFeatureEvent){j=a.getTarget(h.eventSelector,b.getTargetEl());if(j){i=h.eventPrefix,k=h.getFireEventArgs("before"+i+f,b,j,a),l=h.getFireEventArgs(i+f,b,j,a);if(b.fireEvent.apply(b,k)===!1||m.fireEvent.apply(m,k)===!1||b.fireEvent.apply(b,l)===!1||m.fireEvent.apply(m,l)===!1)return!1}}}return!0},onCellMouseDown:Ext.emptyFn,onCellMouseUp:Ext.emptyFn,onCellClick:Ext.emptyFn,onCellDblClick:Ext.emptyFn,onCellContextMenu:Ext.emptyFn,onCellKeyDown:Ext.emptyFn,onBeforeCellMouseDown:Ext.emptyFn,onBeforeCellMouseUp:Ext.emptyFn,onBeforeCellClick:Ext.emptyFn,onBeforeCellDblClick:Ext.emptyFn,onBeforeCellContextMenu:Ext.emptyFn,onBeforeCellKeyDown:Ext.emptyFn,expandToFit:function(a){if(a){var b=this.getMaxContentWidth(a);delete a.flex,a.setWidth(b)}},getMaxContentWidth:function(a){var b=a.getCellInnerSelector(),c=this.el.query(b),d=0,e=c.length,f=a.el.dom.scrollWidth,g;for(;d<e;d++)g=c[d].scrollWidth,g>f&&(f=g);return f},getPositionByEvent:function(a){var b=this,c=a.getTarget(b.cellSelector),d=a.getTarget(b.itemSelector),e=b.getRecord(d),f=b.getHeaderByCell(c);return b.getPosition(e,f)},getHeaderByCell:function(a){if(a){var b=a.className.match(this.cellRe);if(b&&b[1])return Ext.getCmp(b[1])}return!1},walkCells:function(a,b,c,d,e,f){if(!a)return;var g=this,h=a.row,i=a.column,j=g.store.getCount(),k=g.getFirstVisibleColumnIndex(),l=g.getLastVisibleColumnIndex(),m={row:h,column:i},n=g.headerCt.getHeaderAtIndex(i);if(!n||n.hidden)return!1;c=c||{},b=b.toLowerCase();switch(b){case"right":if(i===l){if(d||h===j-1)return!1;c.ctrlKey||(m.row=h+1,m.column=k)}else c.ctrlKey?m.column=l:m.column=i+g.getRightGap(n);break;case"left":if(i===k){if(d||h===0)return!1;c.ctrlKey||(m.row=h-1,m.column=l)}else c.ctrlKey?m.column=k:m.column=i+g.getLeftGap(n);break;case"up":if(h===0)return!1;c.ctrlKey?m.row=0:m.row=h-1;break;case"down":if(h===j-1)return!1;c.ctrlKey?m.row=j-1:m.row=h+1}return e&&e.call(f||window,m)!==!0?!1:m},getFirstVisibleColumnIndex:function(){var a=this.getHeaderCt().getVisibleGridColumns()[0];return a?a.getIndex():-1},getLastVisibleColumnIndex:function(){var a=this.getHeaderCt().getVisibleGridColumns(),b=a[a.length-1];return b.getIndex()},getHeaderCt:function(){return this.headerCt},getPosition:function(a,b){var c=this,d=c.store,e=c.headerCt.getGridColumns();return{row:d.indexOf(a),column:Ext.Array.indexOf(e,b)}},getRightGap:function(a){var b=this.getHeaderCt(),c=b.getGridColumns(),d=Ext.Array.indexOf(c,a),e=d+1,f;for(;e<=c.length;e++)if(!c[e].hidden){f=e;break}return f-d},beforeDestroy:function(){this.rendered&&this.el.removeAllListeners(),this.callParent(arguments)},getLeftGap:function(a){var b=this.getHeaderCt(),c=b.getGridColumns(),d=Ext.Array.indexOf(c,a),e=d-1,f;for(;e>=0;e--)if(!c[e].hidden){f=e;break}return f-d},onAdd:function(a,b,c){this.callParent(arguments),this.doStripeRows(c)},onRemove:function(a,b,c){this.callParent(arguments),this.doStripeRows(c)},doStripeRows:function(a,b){var c=this,d,e,f,g;if(c.rendered&&c.stripeRows){d=c.getNodes(a,b);for(f=0,e=d.length;f<e;f++)g=d[f],g.className=g.className.replace(c.rowClsRe," "),a++,a%2===0&&(g.className+=" "+c.altRowCls)}}}),Ext.define("Ext.grid.Lockable",{requires:["Ext.grid.LockingView","Ext.view.Table"],syncRowHeight:!0,headerCounter:0,scrollDelta:40,unlockText:"Unlock",lockText:"Lock",determineXTypeToCreate:function(){var a=this,b,c,d,e,f;return a.subGridXType?b=a.subGridXType:(c=this.getXTypes().split("/"),d=c.length,e=c[d-1],f=c[d-2],f!=="tablepanel"?b=f:b=e),b},injectLockable:function(){this.lockable=!0,this.hasView=!0;var a=this,b=Ext.getScrollbarSize().width===0,c=a.store=Ext.StoreManager.lookup(a.store),d=a.determineXTypeToCreate(),e=a.getSelectionModel(),f=a.prepareFeatures(),g=a.prepareFeatures(),h,i,j=0,k,l,m,n,o,p,q;for(j=0,k=f?f.length:0;j<k;j++)f[j].lockingPartner=g[j],g[j].lockingPartner=f[j];h=Ext.apply({xtype:d,store:c,scrollerOwner:!1,enableAnimations:!1,scroll:b?"vertical":!1,selModel:e,border:!1,cls:Ext.baseCSSPrefix+"grid-inner-locked",isLayoutRoot:function(){return!1},features:f},a.lockedGridConfig),i=Ext.apply({xtype:d,store:c,scrollerOwner:!1,enableAnimations:!1,selModel:e,border:!1,isLayoutRoot:function(){return!1},features:g},a.normalGridConfig),a.addCls(Ext.baseCSSPrefix+"grid-locked"),Ext.copyTo(i,a,a.bothCfgCopy),Ext.copyTo(h,a,a.bothCfgCopy),Ext.copyTo(i,a,a.normalCfgCopy),Ext.copyTo(h,a,a.lockedCfgCopy);for(j=0;j<a.normalCfgCopy.length;j++)delete a[a.normalCfgCopy[j]];for(j=0;j<a.lockedCfgCopy.length;j++)delete a[a.lockedCfgCopy[j]];a.addEvents("lockcolumn","unlockcolumn"),a.addStateEvents(["lockcolumn","unlockcolumn"]),a.lockedHeights=[],a.normalHeights=[],l=a.processColumns(a.columns),h.width=l.lockedWidth+Ext.num(e.headerWidth,0),h.columns=l.locked,i.columns=l.normal,i.flex=1,h.viewConfig=a.lockedViewConfig||{},h.viewConfig.loadingUseMsg=!1,i.viewConfig=a.normalViewConfig||{},Ext.applyIf(h.viewConfig,a.viewConfig),Ext.applyIf(i.viewConfig,a.viewConfig),a.normalGrid=Ext.ComponentManager.create(i),a.lockedGrid=Ext.ComponentManager.create(h),a.view=new Ext.grid.LockingView({locked:a.lockedGrid,normal:a.normalGrid,panel:a}),o=a.lockedGrid.getView(),p=a.normalGrid.getView(),b?q={scroll:{fn:a.onLockedViewScroll,element:"el",scope:a}}:q={mousewheel:{fn:a.onLockedViewMouseWheel,element:"el",scope:a}},a.syncRowHeight&&(q.refresh=a.onLockedViewRefresh,q.itemupdate=a.onLockedViewItemUpdate,q.scope=a),o.on(q),q={scroll:{fn:a.onNormalViewScroll,element:"el",scope:a},refresh:a.syncRowHeight?a.onNormalViewRefresh:a.updateSpacer,scope:a},p.on(q),m=a.lockedGrid.headerCt,n=a.normalGrid.headerCt,m.lockedCt=!0,m.lockableInjected=!0,n.lockableInjected=!0,m.on({columnshow:a.onLockedHeaderShow,columnhide:a.onLockedHeaderHide,columnmove:a.onLockedHeaderMove,sortchange:a.onLockedHeaderSortChange,columnresize:a.onLockedHeaderResize,scope:a}),n.on({columnmove:a.onNormalHeaderMove,sortchange:a.onNormalHeaderSortChange,scope:a}),a.modifyHeaderCt(),a.items=[a.lockedGrid,a.normalGrid],a.relayHeaderCtEvents(m),a.relayHeaderCtEvents(n),a.layout={type:"hbox",align:"stretch"}},processColumns:function(a){var b=0,c=a.length,d=0,e=[],f=[],g;for(;b<c;++b)g=a[b],g.isComponent||(g=Ext.apply({},a[b])),g.processed=!0,g.locked?(g.hidden||(d+=g.width||Ext.grid.header.Container.prototype.defaultWidth),e.push(g)):f.push(g),g.headerId||(g.headerId=(g.initialConfig||g).id||"L"+ ++this.headerCounter);return{lockedWidth:d,locked:{items:e,itemId:"lockedHeaderCt",stretchMaxPartner:"^^>>#normalHeaderCt"},normal:{items:f,itemId:"normalHeaderCt",stretchMaxPartner:"^^>>#lockedHeaderCt"}}},onLockedViewMouseWheel:function(a){var b=this,c=-b.scrollDelta,d=c*a.getWheelDeltas().y,e=b.lockedGrid.getView().el.dom,f,g;e&&(f=e.scrollTop!==e.scrollHeight-e.clientHeight,g=e.scrollTop!==0);if(d<0&&g||d>0&&f)a.stopEvent(),b.scrolling=!0,e.scrollTop+=d,b.normalGrid.getView().el.dom.scrollTop=e.scrollTop,b.scrolling=!1,b.onNormalViewScroll()},onLockedViewScroll:function(){var a=this,b=a.lockedGrid.getView(),c=a.normalGrid.getView(),d,e;a.scrolling||(a.scrolling=!0,c.el.dom.scrollTop=b.el.dom.scrollTop,a.store.buffered&&(e=b.el.child("table",!0),d=c.el.child("table",!0),e.style.position="absolute"),a.scrolling=!1)},onNormalViewScroll:function(){var a=this,b=a.lockedGrid.getView(),c=a.normalGrid.getView(),d,e;a.scrolling||(a.scrolling=!0,b.el.dom.scrollTop=c.el.dom.scrollTop,a.store.buffered&&(e=b.el.child("table",!0),d=c.el.child("table",!0),e.style.position="absolute",e.style.top=d.style.top),a.scrolling=!1)},onLockedHeaderMove:function(){this.syncRowHeight&&this.onNormalViewRefresh()},onNormalHeaderMove:function(){this.syncRowHeight&&this.onLockedViewRefresh()},updateSpacer:function(){var a=this,b=a.lockedGrid.getView().el,c=a.normalGrid.getView().el.dom,d=b.dom.id+"-spacer",e=c.offsetHeight-c.clientHeight+"px";a.spacerEl=Ext.getDom(d),a.spacerEl?a.spacerEl.style.height=e:Ext.core.DomHelper.append(b,{id:d,style:"height: "+e})},onLockedViewRefresh:function(){if(this.normalGrid.headerCt.getGridColumns().length){var a=this,b=a.lockedGrid.getView(),c=b.el,d=c.query(b.getItemSelector()),e=d.length,f=0;a.lockedHeights=[];for(;f<e;f++)a.lockedHeights[f]=d[f].clientHeight;a.syncRowHeights()}},onNormalViewRefresh:function(){if(this.lockedGrid.headerCt.getGridColumns().length){var a=this,b=a.normalGrid.getView(),c=b.el,d=c.query(b.getItemSelector()),e=d.length,f=0;a.normalHeights=[];for(;f<e;f++)a.normalHeights[f]=d[f].clientHeight;a.syncRowHeights(),a.updateSpacer()}},onLockedViewItemUpdate:function(a,b,c){this.normalGrid.headerCt.getGridColumns().length&&(this.lockedHeights[b]=c.clientHeight,this.syncRowHeights())},onNormalViewItemUpdate:function(a,b,c){this.lockedGrid.headerCt.getGridColumns().length&&(this.normalHeights[b]=c.clientHeight,this.syncRowHeights())},syncRowHeights:function(){var a=this,b=a.lockedHeights,c=a.normalHeights,d=[],e=b.length,f=0,g,h,i,j,k;if(b.length&&c.length){g=a.lockedGrid.getView(),h=a.normalGrid.getView(),i=g.el.query(g.getItemSelector()),j=h.el.query(h.getItemSelector());for(;f<e;f++)!isNaN(b[f])&&!isNaN(c[f])&&(b[f]>c[f]?Ext.fly(j[f]).setHeight(b[f]):b[f]<c[f]&&Ext.fly(i[f]).setHeight(c[f]));k=h.el.dom.scrollTop,h.el.dom.scrollTop=k,g.el.dom.scrollTop=k,a.lockedHeights=[],a.normalHeights=[]}},modifyHeaderCt:function(){var a=this;a.lockedGrid.headerCt.getMenuItems=a.getMenuItems(!0),a.normalGrid.headerCt.getMenuItems=a.getMenuItems(!1)},onUnlockMenuClick:function(){this.unlock()},onLockMenuClick:function(){this.lock()},getMenuItems:function(a){var b=this,c=b.unlockText,d=b.lockText,e=Ext.baseCSSPrefix+"hmenu-unlock",f=Ext.baseCSSPrefix+"hmenu-lock",g=Ext.Function.bind(b.onUnlockMenuClick,b),h=Ext.Function.bind(b.onLockMenuClick,b);return function(){var b=Ext.grid.header.Container.prototype.getMenuItems.call(this);return b.push("-",{cls:e,text:c,handler:g,disabled:!a}),b.push({cls:f,text:d,handler:h,disabled:a}),b}},lock:function(a,b){var c=this,d=c.normalGrid,e=c.lockedGrid,f=d.headerCt,g=e.headerCt;a=a||f.getMenu().activeHeader,a.flex&&(a.width=a.getWidth(),delete a.flex),Ext.suspendLayouts(),f.remove(a,!1),a.locked=!0,Ext.isDefined(b)?g.insert(b,a):g.add(a),c.syncLockedSection(),Ext.resumeLayouts(!0),c.updateSpacer(),c.fireEvent("lockcolumn",c,a)},syncLockedSection:function(){var a=this;a.syncLockedWidth(),a.lockedGrid.getView().refresh(),a.normalGrid.getView().refresh()},syncLockedWidth:function(){var a=this,b=a.lockedGrid,c=b.headerCt.getFullWidth(!0);return Ext.suspendLayouts(),c>0?(b.setWidth(c),b.show()):b.hide(),Ext.resumeLayouts(!0),c>0},onLockedHeaderResize:function(){this.syncLockedWidth()},onLockedHeaderHide:function(){this.syncLockedWidth()},onLockedHeaderShow:function(){this.syncLockedWidth()},onLockedHeaderSortChange:function(a,b,c){c&&this.normalGrid.headerCt.clearOtherSortStates(null,!0)},onNormalHeaderSortChange:function(a,b,c){c&&this.lockedGrid.headerCt.clearOtherSortStates(null,!0)},unlock:function(a,b){var c=this,d=c.normalGrid,e=c.lockedGrid,f=d.headerCt,g=e.headerCt,h=!1;Ext.isDefined(b)||(b=0),a=a||g.getMenu().activeHeader,Ext.suspendLayouts(),g.remove(a,!1),c.syncLockedWidth()&&(h=!0),a.locked=!1,f.insert(b,a),c.normalGrid.getView().refresh(),h&&c.lockedGrid.getView().refresh(),Ext.resumeLayouts(!0),c.fireEvent("unlockcolumn",c,a)},applyColumnsState:function(a){var b=this,c=b.lockedGrid,d=c.headerCt,e=b.normalGrid.headerCt,f=Ext.Array.toMap(d.items,"headerId"),g=Ext.Array.toMap(e.items,"headerId"),h=[],i=[],j=1,k=a.length,l,m,n,o;for(l=0;l<k;l++)o=a[l],n=f[o.id],m=n||g[o.id],m&&(m.applyColumnState&&m.applyColumnState(o),m.locked===undefined&&(m.locked=!!n),m.locked?(h.push(m),!m.hidden&&typeof m.width=="number"&&(j+=m.width)):i.push(m));h.length+i.length==d.items.getCount()+e.items.getCount()&&(d.removeAll(!1),e.removeAll(!1),d.add(h),e.add(i),c.setWidth(j))},getColumnsState:function(){var a=this,b=a.lockedGrid.headerCt.getColumnsState(),c=a.normalGrid.headerCt.getColumnsState();return b.concat(c)},reconfigureLockable:function(a,b){var c=this,d=c.lockedGrid,e=c.normalGrid;b&&(Ext.suspendLayouts(),d.headerCt.removeAll(),e.headerCt.removeAll(),b=c.processColumns(b),d.setWidth(b.lockedWidth),d.headerCt.add(b.locked.items),e.headerCt.add(b.normal.items),Ext.resumeLayouts(!0)),a?(a=Ext.data.StoreManager.lookup(a),c.store=a,d.bindStore(a),e.bindStore(a)):(d.getView().refresh(),e.getView().refresh())}},function(){this.borrow(Ext.view.Table,["prepareFeatures"])}),Ext.define("Ext.grid.View",{extend:"Ext.view.Table",alias:"widget.gridview",stripeRows:!0,autoScroll:!0}),Ext.define("Ext.grid.Panel",{extend:"Ext.panel.Table",requires:["Ext.grid.View"],alias:["widget.gridpanel","widget.grid"],alternateClassName:["Ext.list.ListView","Ext.ListView","Ext.grid.GridPanel"],viewType:"gridview",lockable:!1,bothCfgCopy:["invalidateScrollerOnRefresh","hideHeaders","enableColumnHide","enableColumnMove","enableColumnResize","sortableColumns"],normalCfgCopy:["verticalScroller","verticalScrollDock","verticalScrollerType","scroll"],lockedCfgCopy:[],rowLines:!0}),Ext.define("Ext.grid.property.Grid",{extend:"Ext.grid.Panel",alias:"widget.propertygrid",alternateClassName:"Ext.grid.PropertyGrid",uses:["Ext.grid.plugin.CellEditing","Ext.grid.property.Store","Ext.grid.property.HeaderContainer","Ext.XTemplate","Ext.grid.CellEditor","Ext.form.field.Date","Ext.form.field.Text","Ext.form.field.Number","Ext.form.field.ComboBox"],valueField:"value",nameField:"name",enableColumnMove:!1,columnLines:!0,stripeRows:!1,trackMouseOver:!1,clicksToEdit:1,enableHdMenu:!1,initComponent:function(){var a=this;a.addCls(Ext.baseCSSPrefix+"property-grid"),a.plugins=a.plugins||[],a.plugins.push(new Ext.grid.plugin.CellEditing({clicksToEdit:a.clicksToEdit,startEdit:function(b,c){return this.self.prototype.startEdit.call(this,b,a.headerCt.child("#"+a.valueField))}})),a.selModel={selType:"cellmodel",onCellSelect:function(a){return a.column!=1&&(a.column=1),this.self.prototype.onCellSelect.call(this,a)}},a.customRenderers=a.customRenderers||{},a.customEditors=a.customEditors||{},a.store||(a.propStore=a.store=new Ext.grid.property.Store(a,a.source)),a.sortableColumns&&a.store.sort("name","ASC"),a.columns=new Ext.grid.property.HeaderContainer(a,a.store),a.addEvents("beforepropertychange","propertychange"),a.callParent(),a.getView().walkCells=this.walkCells,a.editors={date:new Ext.grid.CellEditor({field:new Ext.form.field.Date({selectOnFocus:!0})}),string:new Ext.grid.CellEditor({field:new Ext.form.field.Text({selectOnFocus:!0})}),number:new Ext.grid.CellEditor({field:new Ext.form.field.Number({selectOnFocus:!0})}),"boolean":new Ext.grid.CellEditor({field:new Ext.form.field.ComboBox({editable:!1,store:[[!0,a.headerCt.trueText],[!1,a.headerCt.falseText]]})})},a.store.on("update",a.onUpdate,a)},onUpdate:function(a,b,c){var d=this,e,f;d.rendered&&c==Ext.data.Model.EDIT&&(e=b.get(d.valueField),f=b.modified.value,d.fireEvent("beforepropertychange",d.source,b.getId(),e,f)!==!1?(d.source&&(d.source[b.getId()]=e),b.commit(),d.fireEvent("propertychange",d.source,b.getId(),e,f)):b.reject())},walkCells:function(a,b,c,d,e,f){return b=="left"?b="up":b=="right"&&(b="down"),a=Ext.view.Table.prototype.walkCells.call(this,a,b,c,d,e,f),a.column||(a.column=1),a},getCellEditor:function(a,b){var c=this,d=a.get(c.nameField),e=a.get(c.valueField),f=c.customEditors[d];return f?f instanceof Ext.grid.CellEditor||(f instanceof Ext.form.field.Base||(f=Ext.ComponentManager.create(f,"textfield")),f=c.customEditors[d]=new Ext.grid.CellEditor({field:f})):Ext.isDate(e)?f=c.editors.date:Ext.isNumber(e)?f=c.editors.number:Ext.isBoolean(e)?f=c.editors["boolean"]:f=c.editors.string,f.editorId=d,f},beforeDestroy:function(){var a=this;a.callParent(),a.destroyEditors(a.editors),a.destroyEditors(a.customEditors),delete a.source},destroyEditors:function(a){for(var b in a)a.hasOwnProperty(b)&&Ext.destroy(a[b])},setSource:function(a){this.source=a,this.propStore.setSource(a)},getSource:function(){return this.propStore.getSource()},setProperty:function(a,b,c){this.propStore.setValue(a,b,c)},removeProperty:function(a){this.propStore.remove(a)}}),Ext.define("Ext.tree.View",{extend:"Ext.view.Table",alias:"widget.treeview",requires:["Ext.data.NodeStore"],loadingCls:Ext.baseCSSPrefix+"grid-tree-loading",expandedCls:Ext.baseCSSPrefix+"grid-tree-node-expanded",leafCls:Ext.baseCSSPrefix+"grid-tree-node-leaf",expanderSelector:"."+Ext.baseCSSPrefix+"tree-expander",checkboxSelector:"."+Ext.baseCSSPrefix+"tree-checkbox",expanderIconOverCls:Ext.baseCSSPrefix+"tree-expander-over",nodeAnimWrapCls:Ext.baseCSSPrefix+"tree-animator-wrap",blockRefresh:!0,rootVisible:!0,deferInitialRefresh:!1,expandDuration:250,collapseDuration:250,toggleOnDblClick:!0,stripeRows:!1,uiFields:["expanded","loaded","checked","expandable","leaf","icon","iconCls","loading"],initComponent:function(){var a=this,b=a.panel.getStore();a.initialConfig.animate===undefined&&(a.animate=Ext.enableFx),a.store=new Ext.data.NodeStore({treeStore:b,recursive:!0,rootVisible:a.rootVisible,listeners:{beforeexpand:a.onBeforeExpand,expand:a.onExpand,beforecollapse:a.onBeforeCollapse,collapse:a.onCollapse,write:a.onStoreWrite,datachanged:a.onStoreDataChanged,scope:a}}),a.node&&a.setRootNode(a.node),a.animQueue={},a.animWraps={},a.addEvents("afteritemexpand","afteritemcollapse"),a.callParent(arguments),a.on({element:"el",scope:a,delegate:a.expanderSelector,mouseover:a.onExpanderMouseOver,mouseout:a.onExpanderMouseOut}),a.on({element:"el",scope:a,delegate:a.checkboxSelector,click:a.onCheckboxChange})},afterComponentLayout:function(){this.callParent(arguments);var a=this.stretcher;a&&a.setWidth(this.getWidth()-Ext.getScrollbarSize().width)},processUIEvent:function(a){return a.getTarget("."+this.nodeAnimWrapCls,this.el)?!1:this.callParent(arguments)},onClear:function(){this.store.removeAll()},setRootNode:function(a){var b=this;b.store.setNode(a),b.node=a},onCheckboxChange:function(a,b){var c=this,d=a.getTarget(c.getItemSelector(),c.getTargetEl());d&&c.onCheckChange(c.getRecord(d))},onCheckChange:function(a){var b=a.get("checked");Ext.isBoolean(b)&&(b=!b,a.set("checked",b),this.fireEvent("checkchange",a,b))},getChecked:function(){var a=[];return this.node.cascadeBy(function(b){b.get("checked")&&a.push(b)}),a},isItemChecked:function(a){return a.get("checked")},createAnimWrap:function(a,b){var c="",d=this.panel.headerCt,e=d.getGridColumns(),f=0,g=e.length,h,i=this.getNode(a),j,k;for(;f<g;f++)h=e[f],c+='<th style="width: '+(h.hidden?0:h.getDesiredWidth())+'px; height: 0px;"></th>';return k=Ext.get(i),j=k.insertSibling({tag:"tr",html:['<td colspan="'+d.getColumnCount()+'">','<div class="'+this.nodeAnimWrapCls+'">','<table class="'+Ext.baseCSSPrefix+'grid-table" style="width: '+d.getFullWidth()+'px;"><tbody>',c,"</tbody></table>","</div>","</td>"].join("")},"after"),{record:a,node:i,el:j,expanding:!1,collapsing:!1,animating:!1,animateEl:j.down("div"),targetEl:j.down("tbody")}},getAnimWrap:function(a,b){if(!this.animate)return null;var c=this.animWraps,d=c[a.internalId];if(b!==!1)while(!d&&a)a=a.parentNode,a&&(d=c[a.internalId]);return d},doAdd:function(a,b,c){var d=this,e=b[0],f=e.parentNode,g=d.all.elements,h=0,i=d.getAnimWrap(f),j,k,l;if(!i||!i.expanding)return d.callParent(arguments);f=i.record,j=i.targetEl,k=j.dom.childNodes,l=k.length-1,h=c-d.indexOf(f)-1,!l||h>=l?j.appendChild(a):Ext.fly(k[h+1]).insertSibling(a,"before",!0),Ext.Array.insert(g,c,a),i.isAnimating&&d.onExpand(f)},beginBulkUpdate:function(){this.bulkUpdate=!0,this.ownerCt.changingScrollbars=!0},endBulkUpdate:function(){this.bulkUpdate=!1,this.ownerCt.changingScrollbars=!0},onRemove:function(a,b,c){var d=this,e=d.bulkUpdate;d.rendered&&(d.doRemove(b,c),e||d.updateIndexes(c),d.store.getCount()===0&&d.refresh(),e||d.fireEvent("itemremove",b,c))},doRemove:function(a,b){var c=this,d=c.all,e=c.getAnimWrap(a),f=d.item(b).dom;if(!e||!e.collapsing)return c.callParent(arguments);e.targetEl.appendChild(f),d.removeElement(b)},onBeforeExpand:function(a,b,c){var d=this,e;if(!d.rendered||!d.animate)return;d.getNode(a)&&(e=d.getAnimWrap(a,!1),e?e.collapsing&&e.targetEl.select(d.itemSelector).remove():(e=d.animWraps[a.internalId]=d.createAnimWrap(a),e.animateEl.setHeight(0)),e.expanding=!0,e.collapsing=!1)},onExpand:function(a){var b=this,c=b.animQueue,d=a.getId(),e=b.getNode(a),f=e?b.indexOf(e):-1,g,h,i;b.singleExpand&&b.ensureSingleExpand(a);if(f===-1)return;g=b.getAnimWrap(a,!1);if(!g){b.isExpandingOrCollapsing=!1,b.fireEvent("afteritemexpand",a,f,e);return}h=g.animateEl,i=g.targetEl,h.stopAnimation(),c[d]=!0,h.slideIn("t",{duration:b.expandDuration,listeners:{scope:b,lastframe:function(){g.el.insertSibling(i.query(b.itemSelector),"before"),g.el.remove(),delete b.animWraps[g.record.internalId],delete c[d]}},callback:function(){b.isExpandingOrCollapsing=!1,b.fireEvent("afteritemexpand",a,f,e)}}),g.isAnimating=!0},onBeforeCollapse:function(a,b,c){var d=this,e;if(!d.rendered||!d.animate)return;d.getNode(a)&&(e=d.getAnimWrap(a),e?e.expanding&&e.targetEl.select(this.itemSelector).remove():e=d.animWraps[a.internalId]=d.createAnimWrap(a,c),e.expanding=!1,e.collapsing=!0)},onCollapse:function(a){var b=this,c=b.animQueue,d=a.getId(),e=b.getNode(a),f=e?b.indexOf(e):-1,g=b.getAnimWrap(a),h,i;if(f===-1)return;if(!g){b.isExpandingOrCollapsing=!1,b.fireEvent("afteritemcollapse",a,f,e);return}h=g.animateEl,i=g.targetEl,c[d]=!0,h.stopAnimation(),h.slideOut("t",{duration:b.collapseDuration,listeners:{scope:b,lastframe:function(){g.el.remove(),delete b.animWraps[g.record.internalId],delete c[d]}},callback:function(){b.isExpandingOrCollapsing=!1,b.fireEvent("afteritemcollapse",a,f,e)}}),g.isAnimating=!0},isAnimating:function(a){return!!this.animQueue[a.getId()]},collectData:function(a){var b=this.callParent(arguments),c=b.rows,d=c.length,e=0,f,g;for(;e<d;e++)f=c[e],g=a[e],g.get("qtip")&&(f.rowAttr='data-qtip="'+g.get("qtip")+'"',g.get("qtitle")&&(f.rowAttr+=' data-qtitle="'+g.get("qtitle")+'"')),g.isExpanded()&&(f.rowCls=(f.rowCls||"")+" "+this.expandedCls),g.isLeaf()&&(f.rowCls=(f.rowCls||"")+" "+this.leafCls),g.isLoading()&&(f.rowCls=(f.rowCls||"")+" "+this.loadingCls);return b},expand:function(a,b,c,d){return a.expand(b,c,d)},collapse:function(a,b,c,d){return a.collapse(b,c,d)},toggle:function(a,b,c,d){var e=this,f=!!this.animate;if(!f||!this.isExpandingOrCollapsing)a.isLeaf()||(this.isExpandingOrCollapsing=f),a.isExpanded()?e.collapse(a,b,c,d):e.expand(a,b,c,d)},onItemDblClick:function(a,b,c){var d=this.editingPlugin;this.callParent(arguments),this.toggleOnDblClick&&(!d||d.clicksToEdit!==2)&&this.toggle(a)},onBeforeItemMouseDown:function(a,b,c,d){return d.getTarget(this.expanderSelector,b)?!1:this.callParent(arguments)},onItemClick:function(a,b,c,d){return d.getTarget(this.expanderSelector,b)?(this.toggle(a,d.ctrlKey),!1):this.callParent(arguments)},onExpanderMouseOver:function(a,b){a.getTarget(this.cellSelector,10,!0).addCls(this.expanderIconOverCls)},onExpanderMouseOut:function(a,b){a.getTarget(this.cellSelector,10,!0).removeCls(this.expanderIconOverCls)},getTreeStore:function(){return this.panel.store},ensureSingleExpand:function(a){var b=a.parentNode;b&&b.eachChild(function(b){b!==a&&b.isExpanded()&&b.collapse()})},shouldUpdateCell:function(a,b){return Ext.Array.contains(this.uiFields,a.dataIndex)||this.callParent(arguments)},onStoreWrite:function(a,b){var c=this.panel.store;c.fireEvent("write",c,b)},onStoreDataChanged:function(a,b){var c=this.panel.store;c.fireEvent("datachanged",c)}}),Ext.define("Ext.tree.Panel",{extend:"Ext.panel.Table",alias:"widget.treepanel",alternateClassName:["Ext.tree.TreePanel","Ext.TreePanel"],requires:["Ext.tree.View","Ext.selection.TreeModel","Ext.tree.Column","Ext.data.TreeStore"],viewType:"treeview",selType:"treemodel",treeCls:Ext.baseCSSPrefix+"tree-panel",deferRowRender:!1,rowLines:!1,lines:!0,useArrows:!1,singleExpand:!1,ddConfig:{enableDrag:!0,enableDrop:!0},rootVisible:!0,displayField:"text",root:null,normalCfgCopy:["displayField","root","singleExpand","useArrows","lines","rootVisible","scroll"],lockedCfgCopy:["displayField","root","singleExpand","useArrows","lines","rootVisible"],isTree:!0,constructor:function(a){a=a||{},a.animate===undefined&&(a.animate=Ext.isDefined(this.animate)?this.animate:Ext.enableFx),this.enableAnimations=a.animate,delete a.animate,this.callParent([a])},initComponent:function(){var a=this,b=[a.treeCls],c;a.useArrows&&(b.push(Ext.baseCSSPrefix+"tree-arrows"),a.lines=!1),a.lines?b.push(Ext.baseCSSPrefix+"tree-lines"):a.useArrows||b.push(Ext.baseCSSPrefix+"tree-no-lines"),Ext.isString(a.store)?a.store=Ext.StoreMgr.lookup(a.store):!a.store||Ext.isObject(a.store)&&!a.store.isStore?a.store=new Ext.data.TreeStore(Ext.apply({},a.store||{},{root:a.root,fields:a.fields,model:a.model,folderSort:a.folderSort})):a.root&&(a.store=Ext.data.StoreManager.lookup(a.store),a.store.setRootNode(a.root),a.folderSort!==undefined&&(a.store.folderSort=a.folderSort,a.store.sort())),a.viewConfig=Ext.apply({},a.viewConfig),a.viewConfig=Ext.applyIf(a.viewConfig,{rootVisible:a.rootVisible,animate:a.enableAnimations,singleExpand:a.singleExpand,node:a.store.getRootNode(),hideHeaders:a.hideHeaders}),a.mon(a.store,{scope:a,rootchange:a.onRootChange,clear:a.onClear}),a.relayEvents(a.store,["beforeload","load"]),a.store.on({append:a.createRelayer("itemappend"),remove:a.createRelayer("itemremove"),move:a.createRelayer("itemmove",[0,4]),insert:a.createRelayer("iteminsert"),beforeappend:a.createRelayer("beforeitemappend"),beforeremove:a.createRelayer("beforeitemremove"),beforemove:a.createRelayer("beforeitemmove"),beforeinsert:a.createRelayer("beforeiteminsert"),expand:a.createRelayer("itemexpand",[0,1]),collapse:a.createRelayer("itemcollapse",[0,1]),beforeexpand:a.createRelayer("beforeitemexpand",[0,1]),beforecollapse:a.createRelayer("beforeitemcollapse",[0,1])}),a.columns||(a.initialConfig.hideHeaders===undefined&&(a.hideHeaders=!0),a.addCls(Ext.baseCSSPrefix+"autowidth-table"),a.columns=[{xtype:"treecolumn",text:"Name",width:Ext.isIE6?null:1e4,dataIndex:a.displayField}]),a.cls&&b.push(a.cls),a.cls=b.join(" "),a.callParent(),c=a.getView(),a.relayEvents(c,["checkchange","afteritemexpand","afteritemcollapse"]),!c.rootVisible&&!a.getRootNode()&&a.setRootNode({expanded:!0})},onClear:function(){this.view.onClear()},setRootNode:function(){return this.store.setRootNode.apply(this.store,arguments)},getRootNode:function(){return this.store.getRootNode()},onRootChange:function(a){this.view.setRootNode(a)},getChecked:function(){return this.getView().getChecked()},isItemChecked:function(a){return a.get("checked")},expandAll:function(a,b){var c=this.getRootNode(),d=this.enableAnimations,e=this.getView();c&&(d||e.beginBulkUpdate(),c.expand(!0,a,b),d||e.endBulkUpdate())},collapseAll:function(a,b){var c=this.getRootNode(),d=this.enableAnimations,e=this.getView();c&&(d||e.beginBulkUpdate(),e.rootVisible?c.collapse(!0,a,b):c.collapseChildren(!0,a,b),d||e.endBulkUpdate())},expandPath:function(a,b,c,d,e){var f=this,g=f.getRootNode(),h=1,i=f.getView(),j,k;b=b||f.getRootNode().idProperty,c=c||"/";if(Ext.isEmpty(a)){Ext.callback(d,e||f,[!1,null]);return}j=a.split(c);if(g.get(b)!=j[1]){Ext.callback(d,e||f,[!1,g]);return}k=function(){if(++h===j.length){Ext.callback(d,e||f,[!0,g]);return}var a=g.findChild(b,j[h]);if(!a){Ext.callback(d,e||f,[!1,g]);return}g=a,g.expand(!1,k)},g.expand(!1,k)},selectPath:function(a,b,c,d,e){var f=this,g,h;b=b||f.getRootNode().idProperty,c=c||"/",g=a.split(c),h=g.pop(),f.expandPath(g.join(c),b,c,function(a,c){var g=!1;a&&c?(c=c.findChild(b,h),c&&(f.getSelectionModel().select(c),Ext.callback(d,e||f,[!0,c]),g=!0)):c===f.getRootNode()&&(g=!0),Ext.callback(d,e||f,[g,c])},f)}}),Ext.define("Ext.window.Window",{extend:"Ext.panel.Panel",alternateClassName:"Ext.Window",requires:["Ext.util.ComponentDragger","Ext.util.Region","Ext.EventManager"],alias:"widget.window",baseCls:Ext.baseCSSPrefix+"window",resizable:!0,draggable:!0,constrain:!1,constrainHeader:!1,plain:!1,minimizable:!1,maximizable:!1,minHeight:50,minWidth:50,expandOnShow:!0,collapsible:!1,closable:!0,hidden:!0,autoRender:!0,hideMode:"offsets",floating:!0,ariaRole:"alertdialog",itemCls:Ext.baseCSSPrefix+"window-item",overlapHeader:!0,ignoreHeaderBorderManagement:!0,alwaysFramed:!0,isWindow:!0,initComponent:function(){var a=this;a.callParent(),a.addEvents("resize","maximize","minimize","restore"),a.plain&&a.addClsWithUI("plain"),a.modal&&(a.ariaRole="dialog"),a.floating&&a.on({element:"el",mousedown:a.onMouseDown,scope:a}),a.addStateEvents(["maximize","restore","resize","dragend"])},getElConfig:function(){var a=this,b;return b=a.callParent(),b.tabIndex=-1,b},getState:function(){var a=this,b=a.callParent()||{},c=!!a.maximized;return b.maximized=c,Ext.apply(b,{size:c?a.restoreSize:a.getSize(),pos:c?a.restorePos:a.getPosition()}),b},applyState:function(a){var b=this;a&&(b.maximized=a.maximized,b.maximized?(b.hasSavedRestore=!0,b.restoreSize=a.size,b.restorePos=a.pos):Ext.apply(b,{width:a.size.width,height:a.size.height,x:a.pos[0],y:a.pos[1]}))},onMouseDown:function(a){var b;this.floating&&(Ext.fly(a.getTarget()).focusable()&&(b=!0),this.toFront(b))},onRender:function(a,b){var c=this;c.callParent(arguments),c.focusEl=c.el,c.maximizable&&c.header.on({scope:c,dblclick:c.toggleMaximize})},afterRender:function(){var a=this,b;a.callParent(),a.maximized&&(a.maximized=!1,a.maximize()),a.closable&&(b=a.getKeyMap(),b.on(27,a.onEsc,a),b.disable())},initDraggable:function(){var a=this,b;a.header||a.updateHeader(!0);if(a.header){b=Ext.applyIf({el:a.el,delegate:"#"+Ext.escapeId(a.header.id)},a.draggable);if(a.constrain||a.constrainHeader)b.constrain=a.constrain,b.constrainDelegate=a.constrainHeader,b.constrainTo=a.constrainTo||a.container;a.dd=new Ext.util.ComponentDragger(this,b),a.relayEvents(a.dd,["dragstart","drag","dragend"])}},onEsc:function(a,b){if(!Ext.FocusManager||!Ext.FocusManager.enabled||Ext.FocusManager.focusedCmp===this)b.stopEvent(),this.close()},beforeDestroy:function(){var a=this;a.rendered&&(delete this.animateTarget,a.hide(),Ext.destroy(a.keyMap)),a.callParent()},addTools:function(){var a=this;a.callParent(),a.minimizable&&a.addTool({type:"minimize",handler:Ext.Function.bind(a.minimize,a,[])}),a.maximizable&&(a.addTool({type:"maximize",handler:Ext.Function.bind(a.maximize,a,[])}),a.addTool({type:"restore",handler:Ext.Function.bind(a.restore,a,[]),hidden:!0}))},getFocusEl:function(){return this.getDefaultFocus()},getDefaultFocus:function(){var a=this,b,c=a.defaultButton||a.defaultFocus,d;return c!==undefined&&(Ext.isNumber(c)?b=a.query("button")[c]:Ext.isString(c)?(d=c,d.substr(0,1)!=="#"&&(d="#"+d),b=a.down(d)):c.focus&&(b=c)),b||a.el},onFocus:function(){var a=this,b;Ext.FocusManager&&Ext.FocusManager.enabled||(b=a.getDefaultFocus())===a?a.callParent(arguments):b.focus()},afterShow:function(a){var b=this,c=a||b.animateTarget;this.expandOnShow&&this.expand(!1),b.callParent(arguments),b.maximized&&b.fitContainer(),b.syncMonitorWindowResize(),c||b.doConstrain(),b.keyMap&&b.keyMap.enable()},doClose:function(){var a=this;a.hidden?(a.fireEvent("close",a),a.closeAction=="destroy"&&this.destroy()):a.hide(a.animateTarget,a.doClose,a)},afterHide:function(){var a=this;a.syncMonitorWindowResize(),a.keyMap&&a.keyMap.disable(),a.callParent(arguments)},onWindowResize:function(){this.maximized&&this.fitContainer(),this.doConstrain()},minimize:function(){return this.fireEvent("minimize",this),this},afterCollapse:function(){var a=this;a.maximizable&&(a.tools.maximize.hide(),a.tools.restore.hide()),a.resizer&&a.resizer.disable(),a.callParent(arguments)},afterExpand:function(){var a=this;a.maximized?a.tools.restore.show():a.maximizable&&a.tools.maximize.show(),a.resizer&&a.resizer.enable(),a.callParent(arguments)},maximize:function(){var a=this;return a.maximized||(a.expand(!1),a.hasSavedRestore||(a.restoreSize=a.getSize(),a.restorePos=a.getPosition(!0)),a.maximizable&&(a.tools.maximize.hide(),a.tools.restore.show()),a.maximized=!0,a.el.disableShadow(),a.dd&&a.dd.disable(),a.resizer&&a.resizer.disable(),a.collapseTool&&a.collapseTool.hide(),a.el.addCls(Ext.baseCSSPrefix+"window-maximized"),a.container.addCls(Ext.baseCSSPrefix+"window-maximized-ct"),a.syncMonitorWindowResize(),a.setPosition(0,0),a.fitContainer(),a.fireEvent("maximize",a)),a},restore:function(){var a=this,b=a.tools;return a.maximized&&(delete a.hasSavedRestore,a.removeCls(Ext.baseCSSPrefix+"window-maximized"),b.restore&&b.restore.hide(),b.maximize&&b.maximize.show(),a.collapseTool&&a.collapseTool.show(),a.setPosition(a.restorePos),a.setSize(a.restoreSize),delete a.restorePos,delete a.restoreSize,a.maximized=!1,a.el.enableShadow(!0),a.dd&&a.dd.enable(),a.resizer&&a.resizer.enable(),a.container.removeCls(Ext.baseCSSPrefix+"window-maximized-ct"),a.syncMonitorWindowResize(),a.doConstrain(),a.fireEvent("restore",a)),a},syncMonitorWindowResize:function(){var a=this,b=a._monitoringResize,c=a.monitorResize||a.constrain||a.constrainHeader||a.maximized,d=a.hidden||a.destroying||a.isDestroyed;c&&!d?b||(Ext.EventManager.onWindowResize(a.onWindowResize,a),a._monitoringResize=!0):b&&(Ext.EventManager.removeResizeListener(a.onWindowResize,a),a._monitoringResize=!1)},toggleMaximize:function(){return this[this.maximized?"restore":"maximize"]()}}),Ext.define("Ext.window.MessageBox",{extend:"Ext.window.Window",requires:["Ext.toolbar.Toolbar","Ext.form.field.Text","Ext.form.field.TextArea","Ext.form.field.Display","Ext.button.Button","Ext.layout.container.Anchor","Ext.layout.container.HBox","Ext.ProgressBar"],alias:"widget.messagebox",OK:1,YES:2,NO:4,CANCEL:8,OKCANCEL:9,YESNO:6,YESNOCANCEL:14,INFO:Ext.baseCSSPrefix+"message-box-info",WARNING:Ext.baseCSSPrefix+"message-box-warning",QUESTION:Ext.baseCSSPrefix+"message-box-question",ERROR:Ext.baseCSSPrefix+"message-box-error",hideMode:"offsets",closeAction:"hide",resizable:!1,title:"&#160;",width:600,height:500,minWidth:250,maxWidth:600,minHeight:110,maxHeight:500,constrain:!0,cls:Ext.baseCSSPrefix+"message-box",layout:{type:"vbox",align:"stretch"},defaultTextHeight:75,minProgressWidth:250,minPromptWidth:250,buttonText:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel"},buttonIds:["ok","yes","no","cancel"],titleText:{confirm:"Confirm",prompt:"Prompt",wait:"Loading...",alert:"Attention"},iconHeight:35,makeButton:function(a){var b=this.buttonIds[a];return new Ext.button.Button({handler:this.btnCallback,itemId:b,scope:this,text:this.buttonText[b],minWidth:75})},btnCallback:function(a){var b=this,c,d;if(b.cfg.prompt||b.cfg.multiline)b.cfg.multiline?d=b.textArea:d=b.textField,c=d.getValue(),d.reset();a.blur(),b.hide(),b.userCallback(a.itemId,c,b.cfg)},hide:function(){var a=this;a.dd.endDrag(),a.progressBar.reset(),a.removeCls(a.cfg.cls),a.callParent(arguments)},initComponent:function(){var a=this,b=a.id,c,d,e;a.title="&#160;",a.topContainer=new Ext.container.Container({layout:"hbox",style:{padding:"10px",overflow:"hidden"},items:[a.iconComponent=new Ext.Component({cls:a.baseCls+"-icon",width:50,height:a.iconHeight}),a.promptContainer=new Ext.container.Container({flex:1,layout:{type:"anchor"},items:[a.msg=new Ext.form.field.Display({id:b+"-displayfield",cls:a.baseCls+"-text"}),a.textField=new Ext.form.field.Text({id:b+"-testfield",anchor:"100%",enableKeyEvents:!0,listeners:{keydown:a.onPromptKey,scope:a}}),a.textArea=new Ext.form.field.TextArea({id:b+"-textarea",anchor:"100%",height:75})]})]}),a.progressBar=new Ext.ProgressBar({id:b+"-progressbar",margins:"0 10 0 10"}),a.items=[a.topContainer,a.progressBar],a.msgButtons=[];for(c=0;c<4;c++)d=a.makeButton(c),a.msgButtons[d.itemId]=d,a.msgButtons.push(d);a.bottomTb=new Ext.toolbar.Toolbar({id:b+"-toolbar",ui:"footer",dock:"bottom",layout:{pack:"center"},items:[a.msgButtons[0],a.msgButtons[1],a.msgButtons[2],a.msgButtons[3]]}),a.dockedItems=[a.bottomTb],e=a.bottomTb.getLayout(),e.finishedLayout=Ext.Function.createInterceptor(e.finishedLayout,function(b){a.tbWidth=b.getProp("contentWidth")}),a.on("close",a.onClose,a),a.callParent()},onClose:function(){var a=this.header.child("[type=close]");a.itemId="cancel",this.btnCallback(a),delete a.itemId},onPromptKey:function(a,b){var c=this,d;if(b.keyCode===Ext.EventObject.RETURN||b.keyCode===10)c.msgButtons.ok.isVisible()?(d=!0,c.msgButtons.ok.handler.call(c,c.msgButtons.ok)):c.msgButtons.yes.isVisible()&&(c.msgButtons.yes.handler.call(c,c.msgButtons.yes),d=!0),d&&c.textField.blur()},reconfigure:function(a){var b=this,c=0,d=!0,e=b.maxWidth,f=b.buttonText,g;b.updateButtonText(),a=a||{},b.cfg=a,a.width&&(e=a.width),delete b.defaultFocus,b.animateTarget=a.animateTarget||undefined,b.modal=a.modal!==!1,a.title&&b.setTitle(a.title||"&#160;"),Ext.isObject(a.buttons)?(b.buttonText=a.buttons,c=0):(b.buttonText=a.buttonText||b.buttonText,c=Ext.isNumber(a.buttons)?a.buttons:0),c|=b.updateButtonText(),b.buttonText=f,Ext.suspendLayouts(),b.hidden=!1,b.rendered?b.setSize(e,b.maxHeight):(b.width=e,b.render(Ext.getBody())),b.closable=a.closable&&!a.wait,b.header.child("[type=close]").setVisible(a.closable!==!1),!a.title&&!b.closable?b.header.hide():b.header.show(),b.liveDrag=!a.proxyDrag,b.userCallback=Ext.Function.bind(a.callback||a.fn||Ext.emptyFn,a.scope||Ext.global),b.setIcon(a.icon),a.msg?(b.msg.setValue(a.msg),b.msg.show()):b.msg.hide(),Ext.resumeLayouts(!0),Ext.suspendLayouts(),a.prompt||a.multiline?(b.multiline=a.multiline,a.multiline?(b.textArea.setValue(a.value),b.textArea.setHeight(a.defaultTextHeight||b.defaultTextHeight),b.textArea.show(),b.textField.hide(),b.defaultFocus=b.textArea):(b.textField.setValue(a.value),b.textArea.hide(),b.textField.show(),b.defaultFocus=b.textField)):(b.textArea.hide(),b.textField.hide()),a.progress||a.wait?(b.progressBar.show(),b.updateProgress(0,a.progressText),a.wait===!0&&b.progressBar.wait(a.waitConfig)):b.progressBar.hide();for(g=0;g<4;g++)c&Math.pow(2,g)?(b.defaultFocus||(b.defaultFocus=b.msgButtons[g]),b.msgButtons[g].show(),d=!1):b.msgButtons[g].hide();d?b.bottomTb.hide():b.bottomTb.show(),Ext.resumeLayouts(!0)},updateButtonText:function(){var a=this,b=a.buttonText,c=0,d,e;for(d in b)b.hasOwnProperty(d)&&(e=a.msgButtons[d],e&&(a.cfg&&a.cfg.buttonText&&(c|=Math.pow(2,Ext.Array.indexOf(a.buttonIds,d))),e.text!=b[d]&&e.setText(b[d])));return c},show:function(a){var b=this;return b.reconfigure(a),b.addCls(a.cls),b.doAutoSize(),b.hidden=!0,b.callParent(),b},onShow:function(){this.callParent(arguments),this.center()},doAutoSize:function(){var a=this,b=a.header.rendered&&a.header.isVisible(),c=a.bottomTb.rendered&&a.bottomTb.isVisible(),d,e;return Ext.isDefined(a.frameWidth)||(a.frameWidth=a.el.getWidth()-a.body.getWidth()),a.minWidth=a.cfg.minWidth||Ext.getClass(this).prototype.minWidth,d=Math.max(b?a.header.getMinWidth():0,a.cfg.width||a.msg.getWidth()+a.iconComponent.getWidth()+25,c?a.tbWidth:0),e=(b?a.header.getHeight():0)+a.topContainer.getHeight()+a.progressBar.getHeight()+(c?a.bottomTb.getHeight()+a.bottomTb.el.getMargin("tb"):0),a.setSize(d+a.frameWidth,e+a.frameWidth),a},updateText:function(a){return this.msg.setValue(a),this.doAutoSize(!0)},setIcon:function(a){var b=this;return b.iconComponent.removeCls(b.messageIconCls),a?(b.iconComponent.show(),b.iconComponent.addCls(Ext.baseCSSPrefix+"dlg-icon"),b.iconComponent.addCls(b.messageIconCls=a)):(b.iconComponent.removeCls(Ext.baseCSSPrefix+"dlg-icon"),b.iconComponent.hide()),b},updateProgress:function(a,b,c){return this.progressBar.updateProgress(a,b),c&&this.updateText(c),this},onEsc:function(){this.closable!==!1&&this.callParent(arguments)},confirm:function(a,b,c,d){return Ext.isString(a)&&(a={title:a,icon:this.QUESTION,msg:b,buttons:this.YESNO,callback:c,scope:d}),this.show(a)},prompt:function(a,b,c,d,e,f){return Ext.isString(a)&&(a={prompt:!0,title:a,minWidth:this.minPromptWidth,msg:b,buttons:this.OKCANCEL,callback:c,scope:d,multiline:e,value:f}),this.show(a)},wait:function(a,b,c){return Ext.isString(a)&&(a={title:b,msg:a,closable:!1,wait:!0,modal:!0,minWidth:this.minProgressWidth,waitConfig:c}),this.show(a)},alert:function(a,b,c,d){return Ext.isString(a)&&(a={title:a,msg:b,buttons:this.OK,fn:c,scope:d,minWidth:this.minWidth}),this.show(a)},progress:function(a,b,c){return Ext.isString(a)&&(a={title:a,msg:b,progress:!0,progressText:c}),this.show(a)}},function(){Ext.MessageBox=Ext.Msg=new this}),Ext.define("Ext.form.Basic",{extend:"Ext.util.Observable",alternateClassName:"Ext.form.BasicForm",requires:["Ext.util.MixedCollection","Ext.form.action.Load","Ext.form.action.Submit","Ext.window.MessageBox","Ext.data.Errors","Ext.util.DelayedTask"],constructor:function(a,b){var c=this,d=c.onItemAddOrRemove,e,f;c.owner=a,c.mon(a,{add:d,remove:d,scope:c}),Ext.apply(c,b),Ext.isString(c.paramOrder)&&(c.paramOrder=c.paramOrder.split(/[\s,|]/));if(c.api){e=c.api=Ext.apply({},c.api);for(f in e)e.hasOwnProperty(f)&&(e[f]=Ext.direct.Manager.parseMethod(e[f]))}c.checkValidityTask=new Ext.util.DelayedTask(c.checkValidity,c),c.addEvents("beforeaction","actionfailed","actioncomplete","validitychange","dirtychange"),c.callParent()},initialize:function(){var a=this;a.initialized=!0,a.onValidityChange(!a.hasInvalidField())},timeout:30,paramsAsHash:!1,waitTitle:"Please Wait...",trackResetOnLoad:!1,wasDirty:!1,destroy:function(){this.clearListeners(),this.checkValidityTask.cancel()},onItemAddOrRemove:function(a,b){function f(a){c[d?"mon":"mun"](a,{validitychange:c.checkValidity,dirtychange:c.checkDirty,scope:c,buffer:100}),delete c._fields}var c=this,d=!!b.ownerCt,e=b.isContainer;b.isFormField?f(b):e&&(b.isDestroyed?delete c._fields:Ext.Array.forEach(b.query("[isFormField]"),f)),delete this._boundItems,c.initialized&&c.checkValidityTask.delay(10)},getFields:function(){var a=this._fields;return a||(a=this._fields=new Ext.util.MixedCollection,a.addAll(this.owner.query("[isFormField]"))),a},getBoundItems:function(){var a=this._boundItems;if(!a||a.getCount()===0)a=this._boundItems=new Ext.util.MixedCollection,a.addAll(this.owner.query("[formBind]"));return a},hasInvalidField:function(){return!!this.getFields().findBy(function(a){var b=a.preventMark,c;return a.preventMark=!0,c=a.isValid(),a.preventMark=b,!c})},isValid:function(){var a=this,b;return Ext.suspendLayouts(),b=a.getFields().filterBy(function(a){return!a.validate()}),Ext.resumeLayouts(!0),b.length<1},checkValidity:function(){var a=this,b=!a.hasInvalidField();b!==a.wasValid&&(a.onValidityChange(b),a.fireEvent("validitychange",a,b),a.wasValid=b)},onValidityChange:function(a){var b=this.getBoundItems(),c,d,e,f;if(b){c=b.items,e=c.length;for(d=0;d<e;d++)f=c[d],f.disabled===a&&f.setDisabled(!a)}},isDirty:function(){return!!this.getFields().findBy(function(a){return a.isDirty()})},checkDirty:function(){var a=this.isDirty();a!==this.wasDirty&&(this.fireEvent("dirtychange",this,a),this.wasDirty=a)},hasUpload:function(){return!!this.getFields().findBy(function(a){return a.isFileUpload()})},doAction:function(a,b){return Ext.isString(a)&&(a=Ext.ClassManager.instantiateByAlias("formaction."+a,Ext.apply({},b,{form:this}))),this.fireEvent("beforeaction",this,a)!==!1&&(this.beforeAction(a),Ext.defer(a.run,100,a)),this},submit:function(a){return this.doAction(this.standardSubmit?"standardsubmit":this.api?"directsubmit":"submit",a)},load:function(a){return this.doAction(this.api?"directload":"load",a)},updateRecord:function(a){a=a||this._record;var b=a.fields.items,c=this.getFieldValues(),d={},e=0,f=b.length,g;for(;e<f;++e)g=b[e].name,c.hasOwnProperty(g)&&(d[g]=c[g]);return a.beginEdit(),a.set(d),a.endEdit(),this},loadRecord:function(a){return this._record=a,this.setValues(a.data)},getRecord:function(){return this._record},beforeAction:function(a){var b=a.waitMsg,c=Ext.baseCSSPrefix+"mask-loading",d=this.getFields().items,e,f=d.length,g,h;for(e=0;e<f;e++)g=d[e],g.isFormField&&g.syncValue&&g.syncValue();b&&(h=this.waitMsgTarget,h===!0?this.owner.el.mask(b,c):h?(h=this.waitMsgTarget=Ext.get(h),h.mask(b,c)):Ext.MessageBox.wait(b,a.waitTitle||this.waitTitle))},afterAction:function(a,b){if(a.waitMsg){var c=Ext.MessageBox,d=this.waitMsgTarget;d===!0?this.owner.el.unmask():d?d.unmask():(c.updateProgress(1),c.hide())}b?(a.reset&&this.reset(),Ext.callback(a.success,a.scope||a,[this,a]),this.fireEvent("actioncomplete",this,a)):(Ext.callback(a.failure,a.scope||a,[this,a]),this.fireEvent("actionfailed",this,a))},findField:function(a){return this.getFields().findBy(function(b){return b.id===a||b.getName()===a})},markInvalid:function(a){function h(a,c){var d=b.findField(a);d&&d.markInvalid(c)}var b=this,c,d,e,f,g;if(Ext.isArray(a)){d=a.length;for(c=0;c<d;c++)e=a[c],h(e.id,e.msg)}else if(a instanceof Ext.data.Errors){d=a.items.length;for(c=0;c<d;c++)e=a.items[c],h(e.field,e.message)}else for(g in a)a.hasOwnProperty(g)&&(f=a[g],h(g,f,a));return this},setValues:function(a){function g(a,c){var d=b.findField(a);d&&(d.setValue(c),b.trackResetOnLoad&&d.resetOriginalValue())}var b=this,c,d,e,f;if(Ext.isArray(a)){d=a.length;for(c=0;c<d;c++)e=a[c],g(e.id,e.value)}else Ext.iterate(a,g);return this},getValues:function(a,b,c,d){var e={},f=this.getFields().items,g,h=f.length,i=Ext.isArray,j,k,l,m,n;for(g=0;g<h;g++){j=f[g];if(!b||j.isDirty()){k=j[d?"getModelData":"getSubmitData"](c);if(Ext.isObject(k))for(n in k)k.hasOwnProperty(n)&&(l=k[n],c&&l===""&&(l=j.emptyText||""),e.hasOwnProperty(n)?(m=e[n],i(m)||(m=e[n]=[m]),i(l)?e[n]=e[n]=m.concat(l):m.push(l)):e[n]=l)}}return a&&(e=Ext.Object.toQueryString(e)),e},getFieldValues:function(a){return this.getValues(!1,a,!1,!0)},clearInvalid:function(){Ext.suspendLayouts();var a=this,b=a.getFields().items,c,d=b.length;for(c=0;c<d;c++)b[c].clearInvalid();return Ext.resumeLayouts(!0),a},reset:function(){Ext.suspendLayouts();var a=this,b=a.getFields().items,c,d=b.length;for(c=0;c<d;c++)b[c].reset();return Ext.resumeLayouts(!0),a},applyToFields:function(a){var b=this.getFields().items,c,d=b.length;for(c=0;c<d;c++)Ext.apply(b[c],a);return this},applyIfToFields:function(a){var b=this.getFields().items,c,d=b.length;for(c=0;c<d;c++)Ext.applyIf(b[c],a);return this}}),Ext.define("Ext.form.Panel",{extend:"Ext.panel.Panel",mixins:{fieldAncestor:"Ext.form.FieldAncestor"},alias:"widget.form",alternateClassName:["Ext.FormPanel","Ext.form.FormPanel"],requires:["Ext.form.Basic","Ext.util.TaskRunner"],layout:"anchor",ariaRole:"form",initComponent:function(){var a=this;a.frame&&(a.border=!1),a.initFieldAncestor(),a.callParent(),a.relayEvents(a.form,["beforeaction","actionfailed","actioncomplete","validitychange","dirtychange"]),a.pollForChanges&&a.startPolling(a.pollInterval||500)},initItems:function(){var a=this;a.form=a.createForm(),a.callParent()},afterFirstLayout:function(){this.callParent(),this.form.initialize()},createForm:function(){return new Ext.form.Basic(this,Ext.applyIf({listeners:{}},this.initialConfig))},getForm:function(){return this.form},loadRecord:function(a){return this.getForm().loadRecord(a)},getRecord:function(){return this.getForm().getRecord()},getValues:function(a,b,c,d){return this.getForm().getValues(a,b,c,d)},beforeDestroy:function(){this.stopPolling(),this.form.destroy(),this.callParent()},load:function(a){this.form.load(a)},submit:function(a){this.form.submit(a)},startPolling:function(a){this.stopPolling();var b=new Ext.util.TaskRunner(a);b.start({interval:0,run:this.checkChange,scope:this}),this.pollTask=b},stopPolling:function(){var a=this.pollTask;a&&(a.stopAll(),delete this.pollTask)},checkChange:function(){var a=this.form.getFields().items,b,c=a.length,d;for(b=0;b<c;b++)a[b].checkChange()}}),Ext.define("Ext.grid.RowEditor",{extend:"Ext.form.Panel",requires:["Ext.tip.ToolTip","Ext.util.HashMap","Ext.util.KeyNav"],saveBtnText:"Update",cancelBtnText:"Cancel",errorsText:"Errors",dirtyText:"You need to commit or cancel your changes",lastScrollLeft:0,lastScrollTop:0,border:!1,hideMode:"offsets",initComponent:function(){var a=this,b;a.cls=Ext.baseCSSPrefix+"grid-row-editor",a.layout={type:"hbox",align:"middle"},a.columns=new Ext.util.HashMap,a.columns.getKey=function(a){var b;if(a.getEditor){b=a.getEditor();if(b)return b.id}return a.id},a.mon(a.columns,{add:a.onFieldAdd,remove:a.onFieldRemove,replace:a.onFieldReplace,scope:a}),a.callParent(arguments),a.fields&&(a.setField(a.fields),delete a.fields),b=a.getForm(),b.trackResetOnLoad=!0},onFieldChange:function(){var a=this,b=a.getForm(),c=b.isValid();a.errorSummary&&a.isVisible()&&a[c?"hideToolTip":"showToolTip"](),a.floatingButtons&&a.floatingButtons.child("#update").setDisabled(!c),a.isValid=c},afterRender:function(){var a=this,b=a.editingPlugin;a.callParent(arguments),a.mon(a.renderTo,"scroll",a.onCtScroll,a,{buffer:100}),a.mon(a.el,{click:Ext.emptyFn,stopPropagation:!0}),a.el.swallowEvent(["keypress","keydown"]),a.keyNav=new Ext.util.KeyNav(a.el,{enter:b.completeEdit,esc:b.onEscKey,scope:b}),a.mon(b.view,{beforerefresh:a.onBeforeViewRefresh,refresh:a.onViewRefresh,scope:a})},onBeforeViewRefresh:function(a){var b=this,c=a.el.dom;b.el.dom.parentNode===c&&c.removeChild(b.el.dom)},onViewRefresh:function(a){var b=this,c=a.el.dom,d=b.context,e;c.appendChild(b.el.dom),d&&(e=d.store.indexOf(d.record))>=0?(d.row=a.getNode(e),b.reposition(),b.tooltip&&b.tooltip.isVisible()&&b.tooltip.setTarget(d.row)):b.editingPlugin.cancelEdit()},onCtScroll:function(a,b){var c=this,d=b.scrollTop,e=b.scrollLeft;d!==c.lastScrollTop&&(c.lastScrollTop=d,(c.tooltip&&c.tooltip.isVisible()||c.hiddenTip)&&c.repositionTip()),e!==c.lastScrollLeft&&(c.lastScrollLeft=e,c.reposition())},onColumnAdd:function(a){a.isGroupHeader||this.setField(a)},onColumnRemove:function(a){this.columns.remove(a)},onColumnResize:function(a,b){a.isGroupHeader||(a.getEditor().setWidth(b-2),this.isVisible()&&this.reposition())},onColumnHide:function(a){a.isGroupHeader||(a.getEditor().hide(),this.isVisible()&&this.reposition())},onColumnShow:function(a){var b=a.getEditor();b.setWidth(a.getWidth()-2).show(),this.isVisible()&&this.reposition()},onColumnMove:function(a,b,c){if(!a.isGroupHeader){var d=a.getEditor();this.items.indexOf(d)!=c&&this.move(b,c)}},onFieldAdd:function(a,b,c){var d=this,e,f;c.isGroupHeader||(e=d.editingPlugin.grid.headerCt.getHeaderIndex(c),f=c.getEditor({xtype:"displayfield"}),d.insert(e,f))},onFieldRemove:function(a,b,c){var d=this,e,f;c.isGroupHeader||(e=c.getEditor(),f=e.el,d.remove(e,!1),f&&f.remove())},onFieldReplace:function(a,b,c,d){this.onFieldRemove(a,b,d)},clearFields:function(){var a=this.columns,b;for(b in a)a.hasOwnProperty(b)&&a.removeAtKey(b)},getFloatingButtons:function(){var a=this,b=Ext.baseCSSPrefix,c=b+"grid-row-editor-buttons",d=a.editingPlugin,e;return a.floatingButtons||(e=a.floatingButtons=new Ext.Container({renderTpl:['<div class="{baseCls}-ml"></div>','<div class="{baseCls}-mr"></div>','<div class="{baseCls}-bl"></div>','<div class="{baseCls}-br"></div>','<div class="{baseCls}-bc"></div>',"{%this.renderContainer(out,values)%}"],width:200,renderTo:a.el,baseCls:c,layout:{type:"hbox",align:"middle"},defaults:{flex:1,margins:"0 1 0 1"},items:[{itemId:"update",xtype:"button",handler:d.completeEdit,scope:d,text:a.saveBtnText,disabled:!a.isValid,minWidth:Ext.panel.Panel.prototype.minButtonWidth},{xtype:"button",handler:d.cancelEdit,scope:d,text:a.cancelBtnText,minWidth:Ext.panel.Panel.prototype.minButtonWidth}]}),a.mon(e.el,{mousedown:Ext.emptyFn,click:Ext.emptyFn,stopEvent:!0})),a.floatingButtons},reposition:function(a){var b=this,c=b.context,d=c&&Ext.get(c.row),e=b.getFloatingButtons(),f=e.el,g=b.editingPlugin.grid,h=g.view.el,i=g.headerCt.getFullWidth(),j=g.getWidth(),k=Math.min(i,j),l=g.view.el.dom.scrollLeft,m=e.getWidth(),n=(k-m)/2+l,o,p,q,r=function(){f.scrollIntoView(h,!1),a&&a.callback&&a.callback.call(a.scope||b)},s;d&&Ext.isElement(d.dom)&&(d.scrollIntoView(h,!1),o=d.getXY()[1]-5,p=d.getHeight(),q=p+(b.editingPlugin.grid.rowLines?9:10),b.getHeight()!=q&&(b.setHeight(q),b.el.setLeft(0)),a?(s={to:{y:o},duration:a.duration||125,listeners:{afteranimate:function(){r(),o=d.getXY()[1]-5}}},b.el.animate(s)):(b.el.setY(o),r())),b.getWidth()!=i&&b.setWidth(i),f.setLeft(n)},getEditor:function(a){var b=this;if(Ext.isNumber(a))return b.query(">[isFormField]")[a];if(a.isHeader&&!a.isGroupHeader)return a.getEditor()},removeField:function(a){var b=this;a=b.getEditor(a),b.mun(a,"validitychange",b.onValidityChange,b),b.columns.removeAtKey(a.id),Ext.destroy(a)},setField:function(a){var b=this,c,d,e;if(Ext.isArray(a)){d=a.length;for(c=0;c<d;c++)b.setField(a[c]);return}e=a.getEditor(null,{xtype:"displayfield",getModelData:function(){return null}}),e.margins="0 0 0 2",b.mon(e,"change",b.onFieldChange,b),b.isVisible()&&b.context&&(e.is("displayfield")?b.renderColumnData(e,b.context.record,a):(e.suspendEvents(),e.setValue(b.context.record.get(a.dataIndex)),e.resumeEvents())),b.columns.add(e.id,a),a.hidden?b.onColumnHide(a):a.rendered&&b.onColumnShow(a)},loadRecord:function(a){var b=this,c=b.getForm(),d=c.getFields(),e=d.items,f=e.length,g,h;for(g=0;g<f;g++)e[g].suspendEvents();c.loadRecord(a);for(g=0;g<f;g++)e[g].resumeEvents();b.errorSummary&&(c.isValid()?b.hideToolTip():b.showToolTip()),h=b.query(">displayfield"),f=h.length;for(g=0;g<f;g++)b.renderColumnData(h[g],a)},renderColumnData:function(a,b,c){var d=this,e=d.editingPlugin.grid,f=e.headerCt,g=e.view,h=g.store,i=c||d.columns.get(a.id),j=b.get(i.dataIndex),k=i.editRenderer||i.renderer,l,m,n;k&&(l={tdCls:"",style:""},m=h.indexOf(b),n=f.getHeaderIndex(i),j=k.call(i.scope||f.ownerCt,j,l,b,m,n,h,g)),a.setRawValue(j),a.resetOriginalValue()},beforeEdit:function(){var a=this;if(a.isVisible()&&a.errorSummary&&!a.autoCancel&&a.isDirty())return a.showToolTip(),!1},startEdit:function(a,b){var c=this,d=c.editingPlugin.grid,e=d.store,f=c.context=Ext.apply(c.editingPlugin.context,{view:d.getView(),store:e});f.grid.getSelectionModel().select(a),c.loadRecord(a),c.isVisible()?c.reposition({callback:this.focusContextCell}):(c.show(),c.focusContextCell())},focusContextCell:function(){var a=this.getEditor(this.context.colIdx);a&&a.focus&&a.focus()},cancelEdit:function(){var a=this,b=a.getForm(),c=b.getFields(),d=c.items,e=d.length,f;a.hide(),b.clearInvalid();for(f=0;f<e;f++)d[f].suspendEvents();b.reset();for(f=0;f<e;f++)d[f].resumeEvents()},completeEdit:function(){var a=this,b=a.getForm();if(!b.isValid())return;return b.updateRecord(a.context.record),a.hide(),!0},onShow:function(){this.callParent(arguments),this.reposition()},onHide:function(){var a=this;a.callParent(arguments),a.tooltip&&a.hideToolTip(),a.context&&(a.context.view.focus(),a.context=null)},isDirty:function(){var a=this,b=a.getForm();return b.isDirty()},getToolTip:function(){return this.tooltip||(this.tooltip=new Ext.tip.ToolTip({cls:Ext.baseCSSPrefix+"grid-row-editor-errors",title:this.errorsText,autoHide:!1,closable:!0,closeAction:"disable",anchor:"left"}))},hideToolTip:function(){var a=this,b=a.getToolTip();b.rendered&&b.disable(),a.hiddenTip=!1},showToolTip:function(){var a=this,b=a.getToolTip(),c=a.context,d=Ext.get(c.row),e=c.grid.view.el;b.setTarget(d),b.showAt([-1e4,-1e4]),b.update(a.getErrors()),b.mouseOffset=[e.getWidth()-d.getWidth()+a.lastScrollLeft+15,0],a.repositionTip(),b.doLayout(),b.enable()},repositionTip:function(){var a=this,b=a.getToolTip(),c=a.context,d=Ext.get(c.row),e=c.grid.view.el,f=e.getHeight(),g=a.lastScrollTop,h=g+f,i=d.getHeight(),j=d.dom.offsetTop,k=j+i;k>g&&j<h?(b.show(),a.hiddenTip=!1):(b.hide(),a.hiddenTip=!0)},getErrors:function(){function g(a){return"<li>"+a+"</li>"}var a=this,b=!a.autoCancel&&a.isDirty()?a.dirtyText+"<br />":"",c=[],d=a.query(">[isFormField]"),e=d.length,f;for(f=0;f<e;f++)c=c.concat(Ext.Array.map(d[f].getErrors(),g));return b+"<ul>"+c.join("")+"</ul>"},beforeDestroy:function(){Ext.destroy(this.floatingButtons,this.tooltip),this.callParent()}}),Ext.define("Ext.grid.plugin.RowEditing",{extend:"Ext.grid.plugin.Editing",alias:"plugin.rowediting",requires:["Ext.grid.RowEditor"],editStyle:"row",autoCancel:!0,errorSummary:!0,constructor:function(){var a=this;a.callParent(arguments),a.clicksToMoveEditor||(a.clicksToMoveEditor=a.clicksToEdit),a.autoCancel=!!a.autoCancel},init:function(a){this.callParent([a])},destroy:function(){var a=this;Ext.destroy(a.editor),a.callParent(arguments)},startEdit:function(a,b){var c=this,d=c.getEditor();return c.callParent(arguments)!==!1&&d.beforeEdit()!==!1?(d.startEdit(c.context.record,c.context.column),!0):!1},cancelEdit:function(){var a=this;a.editing&&(a.getEditor().cancelEdit(),a.callParent(arguments))},completeEdit:function(){var a=this;a.editing&&a.validateEdit()&&(a.editing=!1,a.fireEvent("edit",a,a.context))},validateEdit:function(){var a=this,b=a.editor,c=a.context,d=c.record,e={},f={},g=b.items.items,h,i=g.length,j,k;for(h=0;h<i;h++)k=g[h],j=k.name,e[j]=k.getValue(),f[j]=d.get(j);return Ext.apply(c,{newValues:e,originalValues:f}),a.callParent(arguments)&&a.getEditor().completeEdit()},getEditor:function(){var a=this;return a.editor||(a.editor=a.initEditor()),a.editor},initEditor:function(){var a=this,b=a.grid,c=a.view,d=b.headerCt,e=["saveBtnText","cancelBtnText","errorsText","dirtyText"],f,g=e.length,h={autoCancel:a.autoCancel,errorSummary:a.errorSummary,fields:d.getGridColumns(),hidden:!0,editingPlugin:a,renderTo:c.el},i;for(f=0;f<g;f++)i=e[f],Ext.isDefined(a[i])&&(h[i]=a[i]);return Ext.create("Ext.grid.RowEditor",h)},initEditTriggers:function(){var a=this,b=a.clicksToMoveEditor===1?"click":"dblclick";a.callParent(arguments),a.clicksToMoveEditor!==a.clicksToEdit&&a.mon(a.view,"cell"+b,a.moveEditorByClick,a)},addHeaderEvents:function(){var a=this;a.callParent(),a.mon(a.grid.headerCt,{scope:a,columnresize:a.onColumnResize,columnhide:a.onColumnHide,columnshow:a.onColumnShow,columnmove:a.onColumnMove})},startEditByClick:function(){var a=this;(!a.editing||a.clicksToMoveEditor===a.clicksToEdit)&&a.callParent(arguments)},moveEditorByClick:function(){var a=this;a.editing&&a.superclass.onCellClick.apply(a,arguments)},onColumnAdd:function(a,b){if(b.isHeader){var c=this,d;c.initFieldAccessors(b),d=c.editor,d&&d.onColumnAdd&&d.onColumnAdd(b)}},onColumnRemove:function(a,b){if(b.isHeader){var c=this,d=c.getEditor();d&&d.onColumnRemove&&d.onColumnRemove(b),c.removeFieldAccessors(b)}},onColumnResize:function(a,b,c){if(b.isHeader){var d=this,e=d.getEditor();e&&e.onColumnResize&&e.onColumnResize(b,c)}},onColumnHide:function(a,b){var c=this,d=c.getEditor();d&&d.onColumnHide&&d.onColumnHide(b)},onColumnShow:function(a,b){var c=this,d=c.getEditor();d&&d.onColumnShow&&d.onColumnShow(b)},onColumnMove:function(a,b,c,d){var e=this,f=e.getEditor();f&&f.onColumnMove&&f.onColumnMove(b,c,d)},setColumnField:function(a,b){var c=this,d=c.getEditor();d.removeField(a),c.callParent(arguments),c.getEditor().setField(a)}}),Ext._endTime=(new Date).getTime(),Ext._beforereadyhandler&&Ext._beforereadyhandler();
(function(a,b){function c(a){return D.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function d(a){if(!ac[a]){var b=D("<"+a+">").appendTo("body"),c=b.css("display");b.remove();if(c==="none"||c==="")c="block";ac[a]=c}return ac[a]}function e(a,b){var c={};return D.each(ec.concat.apply([],ec.slice(0,b)),function(){c[this]=a}),c}function f(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function g(){try{return new a.XMLHttpRequest}catch(b){}}function h(){D(a).unload(function(){for(var a in $b)$b[a](0,1)})}function i(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},f,g,h=d.length,i,j=d[0],k,l,m,n,o;for(f=1;f<h;f++){if(f===1)for(g in a.converters)typeof g=="string"&&(e[g.toLowerCase()]=a.converters[g]);k=j,j=d[f];if(j==="*")j=k;else if(k!=="*"&&k!==j){l=k+" "+j,m=e[l]||e["* "+j];if(!m){o=b;for(n in e){i=n.split(" ");if(i[0]===k||i[0]==="*"){o=e[i[1]+" "+j];if(o){n=e[n],n===!0?m=o:o===!0&&(m=n);break}}}}!m&&!o&&D.error("No conversion from "+l.replace(" "," to ")),m!==!0&&(c=m?m(c):o(n(c)))}}return c}function j(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j)return j!==f[0]&&f.unshift(j),d[j]}function k(a,b,c,d){if(D.isArray(b)&&b.length)D.each(b,function(b,e){c||Bb.test(a)?d(a,e):k(a+"["+(typeof e=="object"||D.isArray(e)?b:"")+"]",e,c,d)});else if(c||b==null||typeof b!="object")d(a,b);else if(D.isArray(b)||D.isEmptyObject(b))d(a,"");else for(var e in b)k(a+"["+e+"]",b[e],c,d)}function l(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===Sb,m;for(;i<j&&(k||!m);i++)m=h[i](c,d,e),typeof m=="string"&&(!k||g[m]?m=b:(c.dataTypes.unshift(m),m=l(a,c,d,e,m,g)));return(k||!m)&&!g["*"]&&(m=l(a,c,d,e,"*",g)),m}function m(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(D.isFunction(c)){var d=b.toLowerCase().split(Mb),e=0,f=d.length,g,h,i;for(;e<f;e++)g=d[e],i=/^\+/.test(g),i&&(g=g.substr(1)||"*"),h=a[g]=a[g]||[],h[i?"unshift":"push"](c)}}}function n(a,b,c){var d=b==="width"?ub:vb,e=b==="width"?a.offsetWidth:a.offsetHeight;return c==="border"?e:(D.each(d,function(){c||(e-=parseFloat(D.css(a,"padding"+this))||0),c==="margin"?e+=parseFloat(D.css(a,"margin"+this))||0:e-=parseFloat(D.css(a,"border"+this+"Width"))||0}),e)}function o(a,b){b.src?D.ajax({url:b.src,async:!1,dataType:"script"}):D.globalEval(b.text||b.textContent||b.innerHTML||""),b.parentNode&&b.parentNode.removeChild(b)}function p(a){return"getElementsByTagName"in a?a.getElementsByTagName("*"):"querySelectorAll"in a?a.querySelectorAll("*"):[]}function q(a,b){if(b.nodeType===1){var c=b.nodeName.toLowerCase();b.clearAttributes(),b.mergeAttributes(a);if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(D.expando)}}function r(a,b){if(b.nodeType===1&&D.hasData(a)){var c=D.expando,d=D.data(a),e=D.data(b,d);if(d=d[c]){var f=d.events;e=e[c]=D.extend({},d);if(f){delete e.handle,e.events={};for(var g in f)for(var h=0,i=f[g].length;h<i;h++)D.event.add(b,g+(f[g][h].namespace?".":"")+f[g][h].namespace,f[g][h],f[g][h].data)}}}}function s(a,b){return D.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function t(a,b,c){if(D.isFunction(b))return D.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return D.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=D.grep(a,function(a){return a.nodeType===1});if(ab.test(b))return D.filter(b,d,!c);b=D.filter(b,d)}return D.grep(a,function(a,d){return D.inArray(a,b)>=0===c})}function u(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function v(a,b){return(a&&a!=="*"?a+".":"")+b.replace(P,"`").replace(Q,"&")}function w(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=[],p=[],q=D._data(this,"events");if(a.liveFired!==this&&q&&q.live&&!a.target.disabled&&(!a.button||a.type!=="click")){a.namespace&&(m=new RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")),a.liveFired=this;var r=q.live.slice(0);for(h=0;h<r.length;h++)f=r[h],f.origType.replace(N,"")===a.type?p.push(f.selector):r.splice(h--,1);e=D(a.target).closest(p,a.currentTarget);for(i=0,j=e.length;i<j;i++){l=e[i];for(h=0;h<r.length;h++){f=r[h];if(l.selector===f.selector&&(!m||m.test(f.namespace))&&!l.elem.disabled){g=l.elem,d=null;if(f.preType==="mouseenter"||f.preType==="mouseleave")a.type=f.preType,d=D(a.relatedTarget).closest(f.selector)[0];(!d||d!==g)&&o.push({elem:g,handleObj:f,level:l.level})}}}for(i=0,j=o.length;i<j;i++){e=o[i];if(c&&e.level>c)break;a.currentTarget=e.elem,a.data=e.handleObj.data,a.handleObj=e.handleObj,n=e.handleObj.origHandler.apply(e.elem,arguments);if(n===!1||a.isPropagationStopped()){c=e.level,n===!1&&(b=!1);if(a.isImmediatePropagationStopped())break}}return b}}function x(a,c,d){var e=D.extend({},d[0]);e.type=a,e.originalEvent={},e.liveFired=b,D.event.handle.call(c,e),e.isDefaultPrevented()&&d[0].preventDefault()}function y(){return!0}function z(){return!1}function A(a){for(var b in a)if(b!=="toJSON")return!1;return!0}function B(a,c,d){if(d===b&&a.nodeType===1){d=a.getAttribute("data-"+c);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:D.isNaN(d)?E.test(d)?D.parseJSON(d):d:parseFloat(d)}catch(e){}D.data(a,c,d)}else d=b}return d}var C=a.document,D=function(){function c(){if(!d.isReady){try{C.documentElement.doScroll("left")}catch(a){setTimeout(c,1);return}d.ready()}}var d=function(a,b){return new d.fn.init(a,b,g)},e=a.jQuery,f=a.$,g,h=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]+)$)/,i=/\S/,j=/^\s+/,k=/\s+$/,l=/\d/,m=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,p=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,q=/(?:^|:|,)(?:\s*\[)+/g,r=/(webkit)[ \/]([\w.]+)/,s=/(opera)(?:.*version)?[ \/]([\w.]+)/,t=/(msie) ([\w.]+)/,u=/(mozilla)(?:.*? rv:([\w.]+))?/,v=navigator.userAgent,w,x=!1,y,z="then done fail isResolved isRejected promise".split(" "),A,B=Object.prototype.toString,D=Object.prototype.hasOwnProperty,E=Array.prototype.push,F=Array.prototype.slice,G=String.prototype.trim,H=Array.prototype.indexOf,I={};return d.fn=d.prototype={constructor:d,init:function(a,c,e){var f,g,i,j;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(a==="body"&&!c&&C.body)return this.context=C,this[0]=C.body,this.selector="body",this.length=1,this;if(typeof a=="string"){f=h.exec(a);if(!f||!f[1]&&c)return!c||c.jquery?(c||e).find(a):this.constructor(c).find(a);if(f[1])return c=c instanceof d?c[0]:c,j=c?c.ownerDocument||c:C,i=m.exec(a),i?d.isPlainObject(c)?(a=[C.createElement(i[1])],d.fn.attr.call(a,c,!0)):a=[j.createElement(i[1])]:(i=d.buildFragment([f[1]],[j]),a=(i.cacheable?d.clone(i.fragment):i.fragment).childNodes),d.merge(this,a);g=C.getElementById(f[2]);if(g&&g.parentNode){if(g.id!==f[2])return e.find(a);this.length=1,this[0]=g}return this.context=C,this.selector=a,this}return d.isFunction(a)?e.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),d.makeArray(a,this))},selector:"",jquery:"1.5.1",length:0,size:function(){return this.length},toArray:function(){return F.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var e=this.constructor();return d.isArray(a)?E.apply(e,a):d.merge(e,a),e.prevObject=this,e.context=this.context,b==="find"?e.selector=this.selector+(this.selector?" ":"")+c:b&&(e.selector=this.selector+"."+b+"("+c+")"),e},each:function(a,b){return d.each(this,a,b)},ready:function(a){return d.bindReady(),y.done(a),this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(F.apply(this,arguments),"slice",F.call(arguments).join(","))},map:function(a){return this.pushStack(d.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:E,sort:[].sort,splice:[].splice},d.fn.init.prototype=d.fn,d.extend=d.fn.extend=function(){var a,c,e,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!d.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){e=i[c],f=a[c];if(i===f)continue;l&&f&&(d.isPlainObject(f)||(g=d.isArray(f)))?(g?(g=!1,h=e&&d.isArray(e)?e:[]):h=e&&d.isPlainObject(e)?e:{},i[c]=d.extend(l,h,f)):f!==b&&(i[c]=f)}return i},d.extend({noConflict:function(b){return a.$=f,b&&(a.jQuery=e),d},isReady:!1,readyWait:1,ready:function(a){a===!0&&d.readyWait--;if(!d.readyWait||a!==!0&&!d.isReady){if(!C.body)return setTimeout(d.ready,1);d.isReady=!0;if(a!==!0&&--d.readyWait>0)return;y.resolveWith(C,[d]),d.fn.trigger&&d(C).trigger("ready").unbind("ready")}},bindReady:function(){if(!x){x=!0;if(C.readyState==="complete")return setTimeout(d.ready,1);if(C.addEventListener)C.addEventListener("DOMContentLoaded",A,!1),a.addEventListener("load",d.ready,!1);else if(C.attachEvent){C.attachEvent("onreadystatechange",A),a.attachEvent("onload",d.ready);var b=!1;try{b=a.frameElement==null}catch(e){}C.documentElement.doScroll&&b&&c()}}},isFunction:function(a){return d.type(a)==="function"},isArray:Array.isArray||function(a){return d.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNaN:function(a){return a==null||!l.test(a)||isNaN(a)},type:function(a){return a==null?String(a):I[B.call(a)]||"object"},isPlainObject:function(a){if(!a||d.type(a)!=="object"||a.nodeType||d.isWindow(a))return!1;if(a.constructor&&!D.call(a,"constructor")&&!D.call(a.constructor.prototype,"isPrototypeOf"))return!1;var c;for(c in a);return c===b||D.call(a,c)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=d.trim(b);if(n.test(b.replace(o,"@").replace(p,"]").replace(q,"")))return a.JSON&&a.JSON.parse?a.JSON.parse(b):(new Function("return "+b))();d.error("Invalid JSON: "+b)},parseXML:function(b,c,e){return a.DOMParser?(e=new DOMParser,c=e.parseFromString(b,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(b)),e=c.documentElement,(!e||!e.nodeName||e.nodeName==="parsererror")&&d.error("Invalid XML: "+b),c},noop:function(){},globalEval:function(a){if(a&&i.test(a)){var b=C.head||C.getElementsByTagName("head")[0]||C.documentElement,c=C.createElement("script");d.support.scriptEval()?c.appendChild(C.createTextNode(a)):c.text=a,b.insertBefore(c,b.firstChild),b.removeChild(c)}},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,e){var f,g=0,h=a.length,i=h===b||d.isFunction(a);if(e){if(i){for(f in a)if(c.apply(a[f],e)===!1)break}else for(;g<h;)if(c.apply(a[g++],e)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(var j=a[0];g<h&&c.call(j,g,j)!==!1;j=a[++g]);return a},trim:G?function(a){return a==null?"":G.call(a)}:function(a){return a==null?"":(a+"").replace(j,"").replace(k,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var e=d.type(a);a.length==null||e==="string"||e==="function"||e==="regexp"||d.isWindow(a)?E.call(c,a):d.merge(c,a)}return c},inArray:function(a,b){if(b.indexOf)return b.indexOf(a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];return a.length=d,a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,b,c){var d=[],e;for(var f=0,g=a.length;f<g;f++)e=b(a[f],f,c),e!=null&&(d[d.length]=e);return d.concat.apply([],d)},guid:1,proxy:function(a,c,e){return arguments.length===2&&(typeof c=="string"?(e=a,a=e[c],c=b):c&&!d.isFunction(c)&&(e=c,c=b)),!c&&a&&(c=function(){return a.apply(e||this,arguments)}),a&&(c.guid=a.guid=a.guid||c.guid||d.guid++),c},access:function(a,c,e,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)d.access(a,j,c[j],f,g,e);return a}if(e!==b){f=!h&&f&&d.isFunction(e);for(var k=0;k<i;k++)g(a[k],c,f?e.call(a[k],k,g(a[k],c)):e,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},_Deferred:function(){var a=[],b,c,e,f={done:function(){if(!e){var c=arguments,g,h,i,j,k;b&&(k=b,b=0);for(g=0,h=c.length;g<h;g++)i=c[g],j=d.type(i),j==="array"?f.done.apply(f,i):j==="function"&&a.push(i);k&&f.resolveWith(k[0],k[1])}return this},resolveWith:function(d,f){if(!e&&!b&&!c){c=1;try{while(a[0])a.shift().apply(d,f)}catch(g){throw g}finally{b=[d,f],c=0}}return this},resolve:function(){return f.resolveWith(d.isFunction(this.promise)?this.promise():this,arguments),this},isResolved:function(){return c||b},cancel:function(){return e=1,a=[],this}};return f},Deferred:function(a){var b=d._Deferred(),c=d._Deferred(),e;return d.extend(b,{then:function(a,c){return b.done(a).fail(c),this},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,promise:function(a){if(a==null){if(e)return e;e=a={}}var c=z.length;while(c--)a[z[c]]=b[z[c]];return a}}),b.done(c.cancel).fail(b.cancel),delete b.cancel,a&&a.call(b,b),b},when:function(a){var b=arguments.length,c=b<=1&&a&&d.isFunction(a.promise)?a:d.Deferred(),e=c.promise();if(b>1){var f=F.call(arguments,0),g=b,h=function(a){return function(b){f[a]=arguments.length>1?F.call(arguments,0):b,--g||c.resolveWith(e,f)}};while(b--)a=f[b],a&&d.isFunction(a.promise)?a.promise().then(h(b),c.reject):--g;g||c.resolveWith(e,f)}else c!==a&&c.resolve(a);return e},uaMatch:function(a){a=a.toLowerCase();var b=r.exec(a)||s.exec(a)||t.exec(a)||a.indexOf("compatible")<0&&u.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}d.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.subclass=this.subclass,a.fn.init=function c(c,e){return e&&e instanceof d&&!(e instanceof a)&&(e=a(e)),d.fn.init.call(this,c,e,b)},a.fn.init.prototype=a.fn;var b=a(C);return a},browser:{}}),y=d._Deferred(),d.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){I["[object "+b+"]"]=b.toLowerCase()}),w=d.uaMatch(v),w.browser&&(d.browser[w.browser]=!0,d.browser.version=w.version),d.browser.webkit&&(d.browser.safari=!0),H&&(d.inArray=function(a,b){return H.call(b,a)}),i.test(" ")&&(j=/^[\s\xA0]+/,k=/[\s\xA0]+$/),g=d(C),C.addEventListener?A=function(){C.removeEventListener("DOMContentLoaded",A,!1),d.ready()}:C.attachEvent&&(A=function(){C.readyState==="complete"&&(C.detachEvent("onreadystatechange",A),d.ready())}),d}();(function(){D.support={};var b=C.createElement("div");b.style.display="none",b.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var c=b.getElementsByTagName("*"),d=b.getElementsByTagName("a")[0],e=C.createElement("select"),f=e.appendChild(C.createElement("option")),g=b.getElementsByTagName("input")[0];if(c&&c.length&&d){D.support={leadingWhitespace:b.firstChild.nodeType===3,tbody:!b.getElementsByTagName("tbody").length,htmlSerialize:!!b.getElementsByTagName("link").length,style:/red/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.55$/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:g.value==="on",optSelected:f.selected,deleteExpando:!0,optDisabled:!1,checkClone:!1,noCloneEvent:!0,noCloneChecked:!0,boxModel:null,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableHiddenOffsets:!0},g.checked=!0,D.support.noCloneChecked=g.cloneNode(!0).checked,e.disabled=!0,D.support.optDisabled=!f.disabled;var h=null;D.support.scriptEval=function(){if(h===null){var b=C.documentElement,c=C.createElement("script"),d="script"+D.now();try{c.appendChild(C.createTextNode("window."+d+"=1;"))}catch(e){}b.insertBefore(c,b.firstChild),a[d]?(h=!0,delete a[d]):h=!1,b.removeChild(c),b=c=d=null}return h};try{delete b.test}catch(i){D.support.deleteExpando=!1}!b.addEventListener&&b.attachEvent&&b.fireEvent&&(b.attachEvent("onclick",function l(){D.support.noCloneEvent=!1,b.detachEvent("onclick",l)}),b.cloneNode(!0).fireEvent("onclick")),b=C.createElement("div"),b.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";var j=C.createDocumentFragment();j.appendChild(b.firstChild),D.support.checkClone=j.cloneNode(!0).cloneNode(!0).lastChild.checked,D(function(){var a=C.createElement("div"),b=C.getElementsByTagName("body")[0];if(b){a.style.width=a.style.paddingLeft="1px",b.appendChild(a),D.boxModel=D.support.boxModel=a.offsetWidth===2,"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,D.support.inlineBlockNeedsLayout=a.offsetWidth===2,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",D.support.shrinkWrapBlocks=a.offsetWidth!==2),a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";var c=a.getElementsByTagName("td");D.support.reliableHiddenOffsets=c[0].offsetHeight===0,c[0].style.display="",c[1].style.display="none",D.support.reliableHiddenOffsets=D.support.reliableHiddenOffsets&&c[0].offsetHeight===0,a.innerHTML="",b.removeChild(a).style.display="none",a=c=null}});var k=function(a){var b=C.createElement("div");a="on"+a;if(!b.attachEvent)return!0;var c=a in b;return c||(b.setAttribute(a,"return;"),c=typeof b[a]=="function"),b=null,c};D.support.submitBubbles=k("submit"),D.support.changeBubbles=k("change"),b=c=d=null}})();var E=/^(?:\{.*\}|\[.*\])$/;D.extend({cache:{},uuid:0,expando:"jQuery"+(D.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?D.cache[a[D.expando]]:a[D.expando],!!a&&!A(a)},data:function(a,c,d,e){if(D.acceptData(a)){var f=D.expando,g=typeof c=="string",h,i=a.nodeType,j=i?D.cache:a,k=i?a[D.expando]:a[D.expando]&&D.expando;if((!k||e&&k&&!j[k][f])&&g&&d===b)return;k||(i?a[D.expando]=k=++D.uuid:k=D.expando),j[k]||(j[k]={},i||(j[k].toJSON=D.noop));if(typeof c=="object"||typeof c=="function")e?j[k][f]=D.extend(j[k][f],c):j[k]=D.extend(j[k],c);return h=j[k],e&&(h[f]||(h[f]={}),h=h[f]),d!==b&&(h[c]=d),c==="events"&&!h[c]?h[f]&&h[f].events:g?h[c]:h}},removeData:function(b,c,d){if(D.acceptData(b)){var e=D.expando,f=b.nodeType,g=f?D.cache:b,h=f?b[D.expando]:D.expando;if(!g[h])return;if(c){var i=d?g[h][e]:g[h];if(i){delete i[c];if(!A(i))return}}if(d){delete g[h][e];if(!A(g[h]))return}var j=g[h][e];D.support.deleteExpando||g!=a?delete g[h]:g[h]=null,j?(g[h]={},f||(g[h].toJSON=D.noop),g[h][e]=j):f&&(D.support.deleteExpando?delete b[D.expando]:b.removeAttribute?b.removeAttribute(D.expando):b[D.expando]=null)}},_data:function(a,b,c){return D.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=D.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),D.fn.extend({data:function(a,c){var d=null;if(typeof a=="undefined"){if(this.length){d=D.data(this[0]);if(this[0].nodeType===1){var e=this[0].attributes,f;for(var g=0,h=e.length;g<h;g++)f=e[g].name,f.indexOf("data-")===0&&(f=f.substr(5),B(this[0],f,d[f]))}}return d}if(typeof a=="object")return this.each(function(){D.data(this,a)});var i=a.split(".");return i[1]=i[1]?"."+i[1]:"",c===b?(d=this.triggerHandler("getData"+i[1]+"!",[i[0]]),d===b&&this.length&&(d=D.data(this[0],a),d=B(this[0],a,d)),d===b&&i[1]?this.data(i[0]):d):this.each(function(){var b=D(this),d=[i[0],c];b.triggerHandler("setData"+i[1]+"!",d),D.data(this,a,c),b.triggerHandler("changeData"+i[1]+"!",d)})},removeData:function(a){return this.each(function(){D.removeData(this,a)})}}),D.extend({queue:function(a,b,c){if(a){b=(b||"fx")+"queue";var d=D._data(a,b);return c?(!d||D.isArray(c)?d=D._data(a,b,D.makeArray(c)):d.push(c),d):d||[]}},dequeue:function(a,b){b=b||"fx";var c=D.queue(a,b),d=c.shift();d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),d.call(a,function(){D.dequeue(a,b)})),c.length||D.removeData(a,b+"queue",!0)}}),D.fn.extend({queue:function(a,c){return typeof a!="string"&&(c=a,a="fx"),c===b?D.queue(this[0],a):this.each(function(b){var d=D.queue(this,a,c);a==="fx"&&d[0]!=="inprogress"&&D.dequeue(this,a)})},dequeue:function(a){return this.each(function(){D.dequeue(this,a)})},delay:function(a,b){return a=D.fx?D.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(){var c=this;setTimeout(function(){D.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])}});var F=/[\n\t\r]/g,G=/\s+/,H=/\r/g,I=/^(?:href|src|style)$/,J=/^(?:button|input)$/i,K=/^(?:button|input|object|select|textarea)$/i,L=/^a(?:rea)?$/i,M=/^(?:radio|checkbox)$/i;D.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"},D.fn.extend({attr:function(a,b){return D.access(this,a,b,!0,D.attr)},removeAttr:function(a,b){return this.each(function(){D.attr(this,a,""),this.nodeType===1&&this.removeAttribute(a)})},addClass:function(a){if(D.isFunction(a))return this.each(function(b){var c=D(this);c.addClass(a.call(this,b,c.attr("class")))});if(a&&typeof a=="string"){var b=(a||"").split(G);for(var c=0,d=this.length;c<d;c++){var e=this[c];if(e.nodeType===1)if(e.className){var f=" "+e.className+" ",g=e.className;for(var h=0,i=b.length;h<i;h++)f.indexOf(" "+b[h]+" ")<0&&(g+=" "+b[h]);e.className=D.trim(g)}else e.className=a}}return this},removeClass:function(a){if(D.isFunction(a))return this.each(function(b){var c=D(this);c.removeClass(a.call(this,b,c.attr("class")))});if(a&&typeof a=="string"||a===b){var c=(a||"").split(G);for(var d=0,e=this.length;d<e;d++){var f=this[d];if(f.nodeType===1&&f.className)if(a){var g=(" "+f.className+" ").replace(F," ");for(var h=0,i=c.length;h<i;h++)g=g.replace(" "+c[h]+" "," ");f.className=D.trim(g)}else f.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";return D.isFunction(a)?this.each(function(c){var d=D(this);d.toggleClass(a.call(this,c,d.attr("class"),b),b)}):this.each(function(){if(c==="string"){var e,f=0,g=D(this),h=b,i=a.split(G);while(e=i[f++])h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&D._data(this,"__className__",this.className),this.className=this.className||a===!1?"":D._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ";for(var c=0,d=this.length;c<d;c++)if((" "+this[c].className+" ").replace(F," ").indexOf(b)>-1)return!0;return!1},val:function(a){if(!arguments.length){var c=this[0];if(c){if(D.nodeName(c,"option")){var d=c.attributes.value;return!d||d.specified?c.value:c.text}if(D.nodeName(c,"select")){var e=c.selectedIndex,f=[],g=c.options,h=c.type==="select-one";if(e<0)return null;for(var i=h?e:0,j=h?e+1:g.length;i<j;i++){var k=g[i];if(k.selected&&(D.support.optDisabled?!k.disabled:k.getAttribute("disabled")===null)&&(!k.parentNode.disabled||!D.nodeName(k.parentNode,"optgroup"))){a=D(k).val();if(h)return a;f.push(a)}}return h&&!f.length&&g.length?D(g[e]).val():f}return M.test(c.type)&&!D.support.checkOn?c.getAttribute("value")===null?"on":c.value:(c.value||"").replace(H,"")}return b}var l=D.isFunction(a);return this.each(function(b){var c=D(this),d=a;if(this.nodeType===1){l&&(d=a.call(this,b,c.val())),d==null?d="":typeof d=="number"?d+="":D.isArray(d)&&(d=D.map(d,function(a){return a==null?"":a+""}));if(D.isArray(d)&&M.test(this.type))this.checked=D.inArray(c.val(),d)>=0;else if(D.nodeName(this,"select")){var e=D.makeArray(d);D("option",this).each(function(){this.selected=D.inArray(D(this).val(),e)>=0}),e.length||(this.selectedIndex=-1)}else this.value=d}})}}),D.extend({attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){if(!a||a.nodeType===3||a.nodeType===8||a.nodeType===2)return b;if(e&&c in D.attrFn)return D(a)[c](d);var f=a.nodeType!==1||!D.isXMLDoc(a),g=d!==b;c=f&&D.props[c]||c;if(a.nodeType===1){var h=I.test(c);if(c==="selected"&&!D.support.optSelected){var i=a.parentNode;i&&(i.selectedIndex,i.parentNode&&i.parentNode.selectedIndex)}if((c in a||a[c]!==b)&&f&&!h){g&&(c==="type"&&J.test(a.nodeName)&&a.parentNode&&D.error("type property can't be changed"),d===null?a.nodeType===1&&a.removeAttribute(c):a[c]=d);if(D.nodeName(a,"form")&&a.getAttributeNode(c))return a.getAttributeNode(c).nodeValue;if(c==="tabIndex"){var j=a.getAttributeNode("tabIndex");return j&&j.specified?j.value:K.test(a.nodeName)||L.test(a.nodeName)&&a.href?0:b}return a[c]}if(!D.support.style&&f&&c==="style")return g&&(a.style.cssText=""+d),a.style.cssText;g&&a.setAttribute(c,""+d);if(!a.attributes[c]&&a.hasAttribute&&!a.hasAttribute(c))return b;var k=!D.support.hrefNormalized&&f&&h?a.getAttribute(c,2):a.getAttribute(c);return k===null?b:k}return g&&(a[c]=d),a[c]}});var N=/\.(.*)$/,O=/^(?:textarea|input|select)$/i,P=/\./g,Q=/ /g,R=/[^\w\s.|`]/g,S=function(a){return a.replace(R,"\\$&")};D.event={add:function(c,d,e,f){if(c.nodeType!==3&&c.nodeType!==8){try{D.isWindow(c)&&c!==a&&!c.frameElement&&(c=a)}catch(g){}if(e===!1)e=z;else if(!e)return;var h,i;e.handler&&(h=e,e=h.handler),e.guid||(e.guid=D.guid++);var j=D._data(c);if(!j)return;var k=j.events,l=j.handle;k||(j.events=k={}),l||(j.handle=l=function(){return typeof D!="undefined"&&!D.event.triggered?D.event.handle.apply(l.elem,arguments):b}),l.elem=c,d=d.split(" ");var m,n=0,o;while(m=d[n++]){i=h?D.extend({},h):{handler:e,data:f},m.indexOf(".")>-1?(o=m.split("."),m=o.shift(),i.namespace=o.slice(0).sort().join(".")):(o=[],i.namespace=""),i.type=m,i.guid||(i.guid=e.guid);var p=k[m],q=D.event.special[m]||{};if(!p){p=k[m]=[];if(!q.setup||q.setup.call(c,f,o,l)===!1)c.addEventListener?c.addEventListener(m,l,!1):c.attachEvent&&c.attachEvent("on"+m,l)}q.add&&(q.add.call(c,i),i.handler.guid||(i.handler.guid=e.guid)),p.push(i),D.event.global[m]=!0}c=null}},global:{},remove:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){d===!1&&(d=z);var f,g,h,i,j=0,k,l,m,n,o,p,q,r=D.hasData(a)&&D._data(a),s=r&&r.events;if(!r||!s)return;c&&c.type&&(d=c.handler,c=c.type);if(!c||typeof c=="string"&&c.charAt(0)==="."){c=c||"";for(g in s)D.event.remove(a,g+c);return}c=c.split(" ");while(g=c[j++]){q=g,p=null,k=g.indexOf(".")<0,l=[],k||(l=g.split("."),g=l.shift(),m=new RegExp("(^|\\.)"+D.map(l.slice(0).sort(),S).join("\\.(?:.*\\.)?")+"(\\.|$)")),o=s[g];if(!o)continue;if(!d){for(i=0;i<o.length;i++){p=o[i];if(k||m.test(p.namespace))D.event.remove(a,q,p.handler,i),o.splice(i--,1)}continue}n=D.event.special[g]||{};for(i=e||0;i<o.length;i++){p=o[i];if(d.guid===p.guid){if(k||m.test(p.namespace))e==null&&o.splice(i--,1),n.remove&&n.remove.call(a,p);if(e!=null)break}}if(o.length===0||e!=null&&o.length===1)(!n.teardown||n.teardown.call(a,l)===!1)&&D.removeEvent(a,g,r.handle),f=null,delete s[g]}if(D.isEmptyObject(s)){var t=r.handle;t&&(t.elem=null),delete r.events,delete r.handle,D.isEmptyObject(r)&&D.removeData(a,b,!0)}}},trigger:function(a,c,d){var e=a.type||a,f=arguments[3];if(!f){a=typeof a=="object"?a[D.expando]?a:D.extend(D.Event(e),a):D.Event(e),e.indexOf("!")>=0&&(a.type=e=e.slice(0,-1),a.exclusive=!0),d||(a.stopPropagation(),D.event.global[e]&&D.each(D.cache,function(){var b=D.expando,d=this[b];d&&d.events&&d.events[e]&&D.event.trigger(a,c,d.handle.elem)}));if(!d||d.nodeType===3||d.nodeType===8)return b;a.result=b,a.target=d,c=D.makeArray(c),c.unshift(a)}a.currentTarget=d;var g=D._data(d,"handle");g&&g.apply(d,c);var h=d.parentNode||d.ownerDocument;try{d&&d.nodeName&&D.noData[d.nodeName.toLowerCase()]||d["on"+e]&&d["on"+e].apply(d,c)===!1&&(a.result=!1,a.preventDefault())}catch(i){}if(!a.isPropagationStopped()&&h)D.event.trigger(a,c,h,!0);else if(!a.isDefaultPrevented()){var j,k=a.target,l=e.replace(N,""),m=D.nodeName(k,"a")&&l==="click",n=D.event.special[l]||{};if((!n._default||n._default.call(d,a)===!1)&&!m&&!(k&&k.nodeName&&D.noData[k.nodeName.toLowerCase()])){try{k[l]&&(j=k["on"+l],j&&(k["on"+l]=null),D.event.triggered=!0,k[l]())}catch(o){}j&&(k["on"+l]=j),D.event.triggered=!1}}},handle:function(c){var d,e,f,g,h,i=[],j=D.makeArray(arguments);c=j[0]=D.event.fix(c||a.event),c.currentTarget=this,d=c.type.indexOf(".")<0&&!c.exclusive,d||(f=c.type.split("."),c.type=f.shift(),i=f.slice(0).sort(),g=new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)")),c.namespace=c.namespace||i.join("."),h=D._data(this,"events"),e=(h||{})[c.type];if(h&&e){e=e.slice(0);for(var k=0,l=e.length;k<l;k++){var m=e[k];if(d||g.test(m.namespace)){c.handler=m.handler,c.data=m.data,c.handleObj=m;var n=m.handler.apply(this,j);n!==b&&(c.result=n,n===!1&&(c.preventDefault(),c.stopPropagation()));if(c.isImmediatePropagationStopped())break}}}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[D.expando])return a;var c=a;a=D.Event(c);for(var d=this.props.length,e;d;)e=this.props[--d],a[e]=c[e];a.target||(a.target=a.srcElement||C),a.target.nodeType===3&&(a.target=a.target.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);if(a.pageX==null&&a.clientX!=null){var f=C.documentElement,g=C.body;a.pageX=a.clientX+(f&&f.scrollLeft||g&&g.scrollLeft||0)-(f&&f.clientLeft||g&&g.clientLeft||0),a.pageY=a.clientY+(f&&f.scrollTop||g&&g.scrollTop||0)-(f&&f.clientTop||g&&g.clientTop||0)}return a.which==null&&(a.charCode!=null||a.keyCode!=null)&&(a.which=a.charCode!=null?a.charCode:a.keyCode),!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey),!a.which&&a.button!==b&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0),a},guid:1e8,proxy:D.proxy,special:{ready:{setup:D.bindReady,teardown:D.noop},live:{add:function(a){D.event.add(this,v(a.origType,a.selector),D.extend({},a,{handler:w,guid:a.handler.guid}))},remove:function(a){D.event.remove(this,v(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){D.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}},D.removeEvent=C.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},D.Event=function(a){if(!this.preventDefault)return new D.Event(a);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?y:z):this.type=a,this.timeStamp=D.now(),this[D.expando]=!0},D.Event.prototype={preventDefault:function(){this.isDefaultPrevented=y;var a=this.originalEvent;a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=y;var a=this.originalEvent;a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=y,this.stopPropagation()},isDefaultPrevented:z,isPropagationStopped:z,isImmediatePropagationStopped:z};var T=function(a){var b=a.relatedTarget;try{if(b!==C&&!b.parentNode)return;while(b&&b!==this)b=b.parentNode;b!==this&&(a.type=a.data,D.event.handle.apply(this,arguments))}catch(c){}},U=function(a){a.type=a.data,D.event.handle.apply(this,arguments)};D.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){D.event.special[a]={setup:function(c){D.event.add(this,b,c&&c.selector?U:T,a)},teardown:function(a){D.event.remove(this,b,a&&a.selector?U:T)}}}),D.support.submitBubbles||(D.event.special.submit={setup:function(a,b){if(!this.nodeName||this.nodeName.toLowerCase()==="form")return!1;D.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=b.type;(c==="submit"||c==="image")&&D(b).closest("form").length&&x("submit",this,arguments)}),D.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=b.type;(c==="text"||c==="password")&&D(b).closest("form").length&&a.keyCode===13&&x("submit",this,arguments)})},teardown:function(a){D.event.remove(this,".specialSubmit")}});if(!D.support.changeBubbles){var V,W=function(a){var b=a.type,c=a.value;return b==="radio"||b==="checkbox"?c=a.checked:b==="select-multiple"?c=a.selectedIndex>-1?D.map(a.options,function(a){return a.selected}).join("-"):"":a.nodeName.toLowerCase()==="select"&&(c=a.selectedIndex),c},X=function(c){var d=c.target,e,f;if(O.test(d.nodeName)&&!d.readOnly){e=D._data(d,"_change_data"),f=W(d),(c.type!=="focusout"||d.type!=="radio")&&D._data(d,"_change_data",f);if(e===b||f===e)return;if(e!=null||f)c.type="change",c.liveFired=b,D.event.trigger(c,arguments[1],d)}};D.event.special.change={filters:{focusout:X,beforedeactivate:X,click:function(a){var b=a.target,c=b.type;(c==="radio"||c==="checkbox"||b.nodeName.toLowerCase()==="select")&&X.call(this,a)},keydown:function(a){var b=a.target,c=b.type;(a.keyCode===13&&b.nodeName.toLowerCase()!=="textarea"||a.keyCode===32&&(c==="checkbox"||c==="radio")||c==="select-multiple")&&X.call(this,a)},beforeactivate:function(a){var b=a.target;D._data(b,"_change_data",W(b))}},setup:function(a,b){if(this.type==="file")return!1;for(var c in V)D.event.add(this,c+".specialChange",V[c]);return O.test(this.nodeName)},teardown:function(a){return D.event.remove(this,".specialChange"),O.test(this.nodeName)}},V=D.event.special.change.filters,V.focus=V.beforeactivate}C.addEventListener&&D.each({focus:"focusin",blur:"focusout"},function(a,b){function c(a){return a=D.event.fix(a),a.type=b,D.event.handle.call(this,a)}D.event.special[b]={setup:function(){this.addEventListener(a,c,!0)},teardown:function(){this.removeEventListener(a,c,!0)}}}),D.each(["bind","one"],function(a,c){D.fn[c]=function(a,d,e){if(typeof a=="object"){for(var f in a)this[c](f,d,a[f],e);return this}if(D.isFunction(d)||d===!1)e=d,d=b;var g=c==="one"?D.proxy(e,function(a){return D(this).unbind(a,g),e.apply(this,arguments)}):e;if(a==="unload"&&c!=="one")this.one(a,d,e);else for(var h=0,i=this.length;h<i;h++)D.event.add(this[h],a,g,d);return this}}),D.fn.extend({unbind:function(a,b){if(typeof a!="object"||a.preventDefault)for(var c=0,d=this.length;c<d;c++)D.event.remove(this[c],a,b);else for(var e in a)this.unbind(e,a[e]);return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return arguments.length===0?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){D.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0]){var c=D.Event(a);return c.preventDefault(),c.stopPropagation(),D.event.trigger(c,b,this[0]),c.result}},toggle:function(a){var b=arguments,c=1;while(c<b.length)D.proxy(a,b[c++]);return this.click(D.proxy(a,function(d){var e=(D._data(this,"lastToggle"+a.guid)||0)%c;return D._data(this,"lastToggle"+a.guid,e+1),d.preventDefault(),b[e].apply(this,arguments)||!1}))},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var Y={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};D.each(["live","die"],function(a,c){D.fn[c]=function(a,d,e,f){var g,h=0,i,j,k,l=f||this.selector,m=f?this:D(this.context);if(typeof a=="object"&&!a.preventDefault){for(var n in a)m[c](n,d,a[n],l);return this}D.isFunction(d)&&(e=d,d=b),a=(a||"").split(" ");while((g=a[h++])!=null){i=N.exec(g),j="",i&&(j=i[0],g=g.replace(N,""));if(g==="hover"){a.push("mouseenter"+j,"mouseleave"+j);continue}k=g,g==="focus"||g==="blur"?(a.push(Y[g]+j),g+=j):g=(Y[g]||g)+j;if(c==="live")for(var o=0,p=m.length;o<p;o++)D.event.add(m[o],"live."+v(g,l),{data:d,selector:l,handler:e,origType:g,origHandler:e,preType:k});else m.unbind("live."+v(g,l),e)}return this}}),D.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){D.fn[b]=function(a,c){return c==null&&(c=a,a=null),arguments.length>0?this.bind(b,a,c):this.trigger(b)},D.attrFn&&(D.attrFn[b]=!0)}),function(){function a(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}if(i.nodeType===1){f||(i.sizcache=c,i.sizset=g);if(typeof b!="string"){if(i===b){j=!0;break}}else if(k.filter(b,[i]).length>0){j=i;break}}i=i[a]}d[g]=j}}}function c(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}i.nodeType===1&&!f&&(i.sizcache=c,i.sizset=g);if(i.nodeName.toLowerCase()===b){j=i;break}i=i[a]}d[g]=j}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e=0,f=Object.prototype.toString,g=!1,h=!0,i=/\\/g,j=/\W/;[0,0].sort(function(){return h=!1,0});var k=function(a,b,c,e){c=c||[],b=b||C;var g=b;if(b.nodeType!==1&&b.nodeType!==9)return[];if(!a||typeof a!="string")return c;var h,i,j,n,o,q,r,s,u=!0,v=k.isXML(b),w=[],x=a;do{d.exec(""),h=d.exec(x);if(h){x=h[3],w.push(h[1]);if(h[2]){n=h[3];break}}}while(h);if(w.length>1&&m.exec(a))if(w.length===2&&l.relative[w[0]])i=t(w[0]+w[1],b);else{i=l.relative[w[0]]?[b]:k(w.shift(),b);while(w.length)a=w.shift(),l.relative[a]&&(a+=w.shift()),i=t(a,i)}else{!e&&w.length>1&&b.nodeType===9&&!v&&l.match.ID.test(w[0])&&!l.match.ID.test(w[w.length-1])&&(o=k.find(w.shift(),b,v),b=o.expr?k.filter(o.expr,o.set)[0]:o.set[0]);if(b){o=e?{expr:w.pop(),set:p(e)}:k.find(w.pop(),w.length!==1||w[0]!=="~"&&w[0]!=="+"||!b.parentNode?b:b.parentNode,v),i=o.expr?k.filter(o.expr,o.set):o.set,w.length>0?j=p(i):u=!1;while(w.length)q=w.pop(),r=q,l.relative[q]?r=w.pop():q="",r==null&&(r=b),l.relative[q](j,r,v)}else j=w=[]}j||(j=i),j||k.error(q||a);if(f.call(j)==="[object Array]")if(u)if(b&&b.nodeType===1)for(s=0;j[s]!=null;s++)j[s]&&(j[s]===!0||j[s].nodeType===1&&k.contains(b,j[s]))&&c.push(i[s]);else for(s=0;j[s]!=null;s++)j[s]&&j[s].nodeType===1&&c.push(i[s]);else c.push.apply(c,j);else p(j,c);return n&&(k(n,g,c,e),k.uniqueSort(c)),c};k.uniqueSort=function(a){if(r){g=h,a.sort(r);if(g)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},k.matches=function(a,b){return k(a,null,null,b)},k.matchesSelector=function(a,b){return k(b,null,null,[a]).length>0},k.find=function(a,b,c){var d;if(!a)return[];for(var e=0,f=l.order.length;e<f;e++){var g,h=l.order[e];if(g=l.leftMatch[h].exec(a)){var j=g[1];g.splice(1,1);if(j.substr(j.length-1)!=="\\"){g[1]=(g[1]||"").replace(i,""),d=l.find[h](g,b,c);if(d!=null){a=a.replace(l.match[h],"");break}}}}return d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]),{set:d,expr:a}},k.filter=function(a,c,d,e){var f,g,h=a,i=[],j=c,m=c&&c[0]&&k.isXML(c[0]);while(a&&c.length){for(var n in l.filter)if((f=l.leftMatch[n].exec(a))!=null&&f[2]){var o,p,q=l.filter[n],r=f[1];g=!1,f.splice(1,1);if(r.substr(r.length-1)==="\\")continue;j===i&&(i=[]);if(l.preFilter[n]){f=l.preFilter[n](f,j,d,i,e,m);if(f){if(f===!0)continue}else g=o=!0}if(f)for(var s=0;(p=j[s])!=null;s++)if(p){o=q(p,f,s,j);var t=e^!!o;d&&o!=null?t?g=!0:j[s]=!1:t&&(i.push(p),g=!0)}if(o!==b){d||(j=i),a=a.replace(l.match[n],"");if(!g)return[];break}}if(a===h){if(g!=null)break;k.error(a)}h=a}return j},k.error=function(a){throw"Syntax error, unrecognized expression: "+a};var l=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!j.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&k.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!j.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&k.filter(b,a,!0)}},"":function(b,d,f){var g,h=e++,i=a;typeof d=="string"&&!j.test(d)&&(d=d.toLowerCase(),g=d,i=c),i("parentNode",d,h,b,g,f)},"~":function(b,d,f){var g,h=e++,i=a;typeof d=="string"&&!j.test(d)&&(d=d.toLowerCase(),g=d,i=c),i("previousSibling",d,h,b,g,f)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(i,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(i,"")},TAG:function(a,b){return a[1].replace(i,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||k.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&k.error(a[0]);return a[0]=e++,a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(i,"");return!f&&l.attrMap[g]&&(a[1]=l.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(i,""),a[2]==="~="&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(a,b,c,e,f){if(a[1]==="not"){if(!((d.exec(a[3])||"").length>1||/^\w/.test(a[3]))){var g=k.filter(a[3],b,c,!0^f);return c||e.push.apply(e,g),!1}a[3]=k(a[3],null,null,b)}else if(l.match.POS.test(a[0])||l.match.CHILD.test(a[0]))return!0;return a},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){return"text"===a.getAttribute("type")},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===a.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===a.type},button:function(a){return"button"===a.type||a.nodeName.toLowerCase()==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=l.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||k.getText([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}k.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case"only":case"first":while(d=d.previousSibling)if(d.nodeType===1)return!1;if(c==="first")return!0;d=a;case"last":while(d=d.nextSibling)if(d.nodeType===1)return!1;return!0;case"nth":var e=b[2],f=b[3];if(e===1&&f===0)return!0;var g=b[0],h=a.parentNode;if(h&&(h.sizcache!==g||!a.nodeIndex)){var i=0;for(d=h.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++i);h.sizcache=g}var j=a.nodeIndex-f;return e===0?j===0:j%e===0&&j/e>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=l.attrHandle[c]?l.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=l.setFilters[e];if(f)return f(a,c,b,d)}}},m=l.match.POS,n=function(a,b){return"\\"+(b-0+1)};for(var o in l.match)l.match[o]=new RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n));var p=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(C.documentElement.childNodes,0)[0].nodeType}catch(q){p=function(a,b){var c=0,d=b||[];if(f.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var r,s;C.documentElement.compareDocumentPosition?r=function(a,b){return a===b?(g=!0,0):!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(r=function(a,b){var c,d,e=[],f=[],h=a.parentNode,i=b.parentNode,j=h;if(a===b)return g=!0,0;if(h===i)return s(a,b);if(!h)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return s(e[k],f[k]);return k===c?s(a,f[k],-1):s(e[k],b,1)},s=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),k.getText=function(a){var b="",c;for(var d=0;a[d];d++)c=a[d],c.nodeType===3||c.nodeType===4?b+=c.nodeValue:c.nodeType!==8&&(b+=k.getText(c.childNodes));return b},function(){var a=C.createElement("div"),c="script"+(new Date).getTime(),d=C.documentElement;a.innerHTML="<a name='"+c+"'/>",d.insertBefore(a,d.firstChild),C.getElementById(c)&&(l.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},l.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),d.removeChild(a),d=a=null}(),function(){var a=C.createElement("div");a.appendChild(C.createComment("")),a.getElementsByTagName("*").length>0&&(l.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(l.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),C.querySelectorAll&&function(){var a=k,b=C.createElement("div"),c="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){k=function(b,d,e,f){d=d||C;if(!f&&!k.isXML(d)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(g&&(d.nodeType===1||d.nodeType===9)){if(g[1])return p(d.getElementsByTagName(b),e);if(g[2]&&l.find.CLASS&&d.getElementsByClassName)return p(d.getElementsByClassName(g[2]),e)}if(d.nodeType===9){if(b==="body"&&d.body)return p([d.body],e);if(g&&g[3]){var h=d.getElementById(g[3]);if(!h||!h.parentNode)return p([],e);if(h.id===g[3])return p([h],e)}try{return p(d.querySelectorAll(b),e)}catch(i){}}else if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var j=d,m=d.getAttribute("id"),n=m||c,o=d.parentNode,q=/^\s*[+~]/.test(b);m?n=n.replace(/'/g,"\\$&"):d.setAttribute("id",n),q&&o&&(d=d.parentNode);try{if(!q||o)return p(d.querySelectorAll("[id='"+n+"'] "+b),e)}catch(r){}finally{m||j.removeAttribute("id")}}}return a(b,d,e,f)};for(var d in a)k[d]=a[d];b=null}}(),function(){var a=C.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector,c=!1;try{b.call(C.documentElement,"[test!='']:sizzle")}catch(d){c=!0}b&&(k.matchesSelector=function(a,d){d=d.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!k.isXML(a))try{if(c||!l.match.PSEUDO.test(d)&&!/!=/.test(d))return b.call(a,d)}catch(e){}return k(d,null,null,[a]).length>0})}(),function(){var a=C.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;l.order.splice(1,0,"CLASS"),l.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),C.documentElement.contains?k.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:C.documentElement.compareDocumentPosition?k.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:k.contains=function(){return!1},k.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var t=function(a,b){var c,d=[],e="",f=b.nodeType?[b]:b;while(c=l.match.PSEUDO.exec(a))e+=c[0],a=a.replace(l.match.PSEUDO,"");a=l.relative[a]?a+"*":a;for(var g=0,h=f.length;g<h;g++)k(a,f[g],d);return k.filter(e,d)};D.find=k,D.expr=k.selectors,D.expr[":"]=D.expr.filters,D.unique=k.uniqueSort,D.text=k.getText,D.isXMLDoc=k.isXML,D.contains=k.contains}();var Z=/Until$/,$=/^(?:parents|prevUntil|prevAll)/,_=/,/,ab=/^.[^:#\[\.,]*$/,bb=Array.prototype.slice,cb=D.expr.match.POS,db={children:!0,contents:!0,next:!0,prev:!0};D.fn.extend({find:function(a){var b=this.pushStack("","find",a),c=0;for(var d=0,e=this.length;d<e;d++){c=b.length,D.find(a,this[d],b);if(d>0)for(var f=c;f<b.length;f++)for(var g=0;g<c;g++)if(b[g]===b[f]){b.splice(f--,1);break}}return b},has:function(a){var b=D(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(D.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(t(this,a,!1),"not",a)},filter:function(a){return this.pushStack(t(this,a,!0),"filter",a)},is:function(a){return!!a&&D.filter(a,this).length>0},closest:function(a,b){var c=[],d,e,f=this[0];if(D.isArray(a)){var g,h,i={},j=1;if(f&&a.length){for(d=0,e=a.length;d<e;d++)h=a[d],i[h]||(i[h]=D.expr.match.POS.test(h)?D(h,b||this.context):h);while(f&&f.ownerDocument&&f!==b){for(h in i)g=i[h],(g.jquery?g.index(f)>-1:D(f).is(g))&&c.push({selector:h,elem:f,level:j});f=f.parentNode,j++}}return c}var k=cb.test(a)?D(a,b||this.context):null;for(d=0,e=this.length;d<e;d++){f=this[d];while(f){if(k?k.index(f)>-1:D.find.matchesSelector(f,a)){c.push(f);break}f=f.parentNode;if(!f||!f.ownerDocument||f===b)break}}return c=c.length>1?D.unique(c):c,this.pushStack(c,"closest",a)},index:function(a){return!a||typeof a=="string"?D.inArray(this[0],a?D(a):this.parent().children()):D.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?D(a,b):D.makeArray(a),d=D.merge(this.get(),c);return this.pushStack(u(c[0])||u(d[0])?d:D.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),D.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return D.dir(a,"parentNode")},parentsUntil:function(a,b,c){return D.dir(a,"parentNode",c)},next:function(a){return D.nth(a,2,"nextSibling")},prev:function(a){return D.nth(a,2,"previousSibling")},nextAll:function(a){return D.dir(a,"nextSibling")},prevAll:function(a){return D.dir(a,"previousSibling")},nextUntil:function(a,b,c){return D.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return D.dir(a,"previousSibling",c)},siblings:function(a){return D.sibling(a.parentNode.firstChild,a)},children:function(a){return D.sibling(a.firstChild)},contents:function(a){return D.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:D.makeArray(a.childNodes)}},function(a,b){D.fn[a]=function(c,d){var e=D.map(this,b,c),f=bb.call(arguments);return Z.test(a)||(d=c),d&&typeof d=="string"&&(e=D.filter(d,e)),e=this.length>1&&!db[a]?D.unique(e):e,(this.length>1||_.test(d))&&$.test(a)&&(e=e.reverse()),this.pushStack(e,a,f.join(","))}}),D.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),b.length===1?D.find.matchesSelector(b[0],a)?[b[0]]:[]:D.find.matches(a,b)},dir:function(a,c,d){var e=[],f=a[c];while(f&&f.nodeType!==9&&(d===b||f.nodeType!==1||!D(f).is(d)))f.nodeType===1&&e.push(f),f=f[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var eb=/ jQuery\d+="(?:\d+|null)"/g,fb=/^\s+/,gb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,hb=/<([\w:]+)/,ib=/<tbody/i,jb=/<|&#?\w+;/,kb=/<(?:script|object|embed|option|style)/i,lb=/checked\s*(?:[^=]|=\s*.checked.)/i,mb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};mb.optgroup=mb.option,mb.tbody=mb.tfoot=mb.colgroup=mb.caption=mb.thead,mb.th=mb.td,D.support.htmlSerialize||(mb._default=[1,"div<div>","</div>"]),D.fn.extend({text:function(a){return D.isFunction(a)?this.each(function(b){var c=D(this);c.text(a.call(this,b,c.text()))}):typeof a!="object"&&a!==b?this.empty().append((this[0]&&this[0].ownerDocument||C).createTextNode(a)):D.text(this)},wrapAll:function(a){if(D.isFunction(a))return this.each(function(b){D(this).wrapAll(a.call(this,b))});if(this[0]){var b=D(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return D.isFunction(a)?this.each(function(b){D(this).wrapInner(a.call(this,b))}):this.each(function(){var b=D(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){D(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){D.nodeName(this,"body")||D(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=D(arguments[0]);return a.push.apply(a,this.toArray()),this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);return a.push.apply(a,D(arguments[0]).toArray()),a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||D.filter(a,[d]).length)!b&&d.nodeType===1&&(D.cleanData(d.getElementsByTagName("*")),D.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&D.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){return a=a==null?!1:a,b=b==null?a:b,this.map(function(){return D.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(eb,""):null;if(typeof a!="string"||kb.test(a)||!D.support.leadingWhitespace&&fb.test(a)||mb[(hb.exec(a)||["",""])[1].toLowerCase()])D.isFunction(a)?this.each(function(b){var c=D(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);else{a=a.replace(gb,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(D.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}return this},replaceWith:function(a){return this[0]&&this[0].parentNode?D.isFunction(a)?this.each(function(b){var c=D(this),d=c.html();c.replaceWith(a.call(this,b,d))}):(typeof a!="string"&&(a=D(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;D(this).remove(),b?D(b).before(a):D(c).append(a)})):this.pushStack(D(D.isFunction(a)?a():a),"replaceWith",a)},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,f,g,h,i=a[0],j=[];if(!D.support.checkClone&&arguments.length===3&&typeof i=="string"&&lb.test(i))return this.each(function(){D(this).domManip(a,c,d,!0)});if(D.isFunction(i))return this.each(function(e){var f=D(this);a[0]=i.call(this,e,c?f.html():b),f.domManip(a,c,d)});if(this[0]){h=i&&i.parentNode,D.support.parentNode&&h&&h.nodeType===11&&h.childNodes.length===this.length?e={fragment:h}:e=D.buildFragment(a,this,j),g=e.fragment,g.childNodes.length===1?f=g=g.firstChild:f=g.firstChild;if(f){c=c&&D.nodeName(f,"tr");for(var k=0,l=this.length,m=l-1;k<l;k++)d.call(c?s(this[k],f):this[k],e.cacheable||l>1&&k<m?D.clone(g,!0,!0):g)}j.length&&D.each(j,o)}return this}}),D.buildFragment=function(a,b,c){var d,e,f,g=b&&b[0]?b[0].ownerDocument||b[0]:C;return a.length===1&&typeof a[0]=="string"&&a[0].length<512&&g===C&&a[0].charAt(0)==="<"&&!kb.test(a[0])&&(D.support.checkClone||!lb.test(a[0]))&&(e=!0,f=D.fragments[a[0]],f&&f!==1&&(d=f)),d||(d=g.createDocumentFragment(),D.clean(a,g,d,c)),e&&(D.fragments[a[0]]=f?d:1),{fragment:d,cacheable:e}},D.fragments={},D.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){D.fn[a]=function(c){var d=[],e=D(c),f=this.length===1&&this[0].parentNode;if(f&&f.nodeType===11&&f.childNodes.length===1&&e.length===1)return e[b](this[0]),this;for(var g=0,h=e.length;g<h;g++){var i=(g>0?this.clone(!0):this).get();D(e[g])[b](i),d=d.concat(i)}return this.pushStack(d,a,e.selector)}}),D.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,f,g;if((!D.support.noCloneEvent||!D.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!D.isXMLDoc(a)){q(a,d),e=p(a),f=p(d);for(g=0;e[g];++g)q(e[g],f[g])}if(b){r(a,d);if(c){e=p(a),f=p(d);for(g=0;e[g];++g)r(e[g],f[g])}}return d},clean:function(a,b,c,d){b=b||C,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||C);var e=[];for(var f=0,g;(g=a[f])!=null;f++){typeof g=="number"&&(g+="");if(!g)continue;if(typeof g!="string"||jb.test(g)){if(typeof g=="string"){g=g.replace(gb,"<$1></$2>");var h=(hb.exec(g)||["",""])[1].toLowerCase(),i=mb[h]||mb._default,j=i[0],k=b.createElement("div");k.innerHTML=i[1]+g+i[2];while(j--)k=k.lastChild;if(!D.support.tbody){var l=ib.test(g),m=h==="table"&&!l?k.firstChild&&k.firstChild.childNodes:i[1]==="<table>"&&!l?k.childNodes:[];for(var n=m.length-1;n>=0;--n)D.nodeName(m[n],"tbody")&&!m[n].childNodes.length&&m[n].parentNode.removeChild(m[n])}!D.support.leadingWhitespace&&fb.test(g)&&k.insertBefore(b.createTextNode(fb.exec(g)[0]),k.firstChild),g=k.childNodes}}else g=b.createTextNode(g);g.nodeType?e.push(g):e=D.merge(e,g)}if(c)for(f=0;e[f];f++)!d||!D.nodeName(e[f],"script")||e[f].type&&e[f].type.toLowerCase()!=="text/javascript"?(e[f].nodeType===1&&e.splice.apply(e,[f+1,0].concat(D.makeArray(e[f].getElementsByTagName("script")))),c.appendChild(e[f])):d.push(e[f].parentNode?e[f].parentNode.removeChild(e[f]):e[f]);return e},cleanData:function(a){var b,c,d=D.cache,e=D.expando,f=D.event.special,g=D.support.deleteExpando;for(var h=0,i;(i=a[h])!=null;h++){if(i.nodeName&&D.noData[i.nodeName.toLowerCase()])continue;c=i[D.expando];if(c){b=d[c]&&d[c][e];if(b&&b.events){for(var j in b.events)f[j]?D.event.remove(i,j):D.removeEvent(i,j,b.handle);b.handle&&(b.handle.elem=null)}g?delete i[D.expando]:i.removeAttribute&&i.removeAttribute(D.expando),delete d[c]}}}});var nb=/alpha\([^)]*\)/i,ob=/opacity=([^)]*)/,pb=/-([a-z])/ig,qb=/([A-Z])/g,rb=/^-?\d+(?:px)?$/i,sb=/^-?\d/,tb={position:"absolute",visibility:"hidden",display:"block"},ub=["Left","Right"],vb=["Top","Bottom"],wb,xb,yb,zb=function(a,b){return b.toUpperCase()};D.fn.css=function(a,c){return arguments.length===2&&c===b?this:D.access(this,a,c,!0,function(a,c,d){return d!==b?D.style(a,c,d):D.css(a,c)})},D.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=wb(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{zIndex:!0,fontWeight:!0,opacity:!0,zoom:!0,lineHeight:!0},cssProps:{"float":D.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&a.nodeType!==3&&a.nodeType!==8&&a.style){var f,g=D.camelCase(c),h=a.style,i=D.cssHooks[g];c=D.cssProps[g]||g;if(d===b)return i&&"get"in i&&(f=i.get(a,!1,e))!==b?f:h[c];if(typeof d=="number"&&isNaN(d)||d==null)return;typeof d=="number"&&!D.cssNumber[g]&&(d+="px");if(!i||!("set"in i)||(d=i.set(a,d))!==b)try{h[c]=d}catch(j){}}},css:function(a,c,d){var e,f=D.camelCase(c),g=D.cssHooks[f];c=D.cssProps[f]||f;if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(wb)return wb(a,c,f)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]},camelCase:function(a){return a.replace(pb,zb)}}),D.curCSS=D.css,D.each(["height","width"],function(a,b){D.cssHooks[b]={get:function(a,c,d){var e;if(c){a.offsetWidth!==0?e=n(a,b,d):D.swap(a,tb,function(){e=n(a,b,d)});if(e<=0){e=wb(a,b,b),e==="0px"&&yb&&(e=yb(a,b,b));if(e!=null)return e===""||e==="auto"?"0px":e}return e<0||e==null?(e=a.style[b],e===""||e==="auto"?"0px":e):typeof e=="string"?e:e+"px"}},set:function(a,b){if(!rb.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),D.support.opacity||(D.cssHooks.opacity={get:function(a,b){return ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style;c.zoom=1;var d=D.isNaN(b)?"":"alpha(opacity="+b*100+")",e=c.filter||"";c.filter=nb.test(e)?e.replace(nb,d):c.filter+" "+d}}),C.defaultView&&C.defaultView.getComputedStyle&&(xb=function(a,c,d){var e,f,g;d=d.replace(qb,"-$1").toLowerCase();if(!(f=a.ownerDocument.defaultView))return b;if(g=f.getComputedStyle(a,null))e=g.getPropertyValue(d),e===""&&!D.contains(a.ownerDocument.documentElement,a)&&(e=D.style(a,d));return e}),C.documentElement.currentStyle&&(yb=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;return!rb.test(d)&&sb.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e)),d===""?"auto":d}),wb=xb||yb,D.expr&&D.expr.filters&&(D.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!D.support.reliableHiddenOffsets&&(a.style.display||D.css(a,"display"))==="none"},D.expr.filters.visible=function(a){return!D.expr.filters.hidden(a)});var Ab=/%20/g,Bb=/\[\]$/,Cb=/\r?\n/g,Db=/#.*$/,Eb=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,Fb=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Gb=/(?:^file|^widget|\-extension):$/,Hb=/^(?:GET|HEAD)$/,Ib=/^\/\//,Jb=/\?/,Kb=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,Lb=/^(?:select|textarea)/i,Mb=/\s+/,Nb=/([?&])_=[^&]*/,Ob=/(^|\-)([a-z])/g,Pb=function(a,b,c){return b+c.toUpperCase()},Qb=/^([\w\+\.\-]+:)\/\/([^\/?#:]*)(?::(\d+))?/,Rb=D.fn.load,Sb={},Tb={},Ub,Vb;try{Ub=C.location.href}catch(Wb){Ub=C.createElement("a"),Ub.href="",Ub=Ub.href}Vb=Qb.exec(Ub.toLowerCase()),D.fn.extend({load:function(a,c,d){if(typeof a!="string"&&Rb)return Rb.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var f=a.slice(e,a.length);a=a.slice(0,e)}var g="GET";c&&(D.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=D.param(c,D.ajaxSettings.traditional),g="POST"));var h=this;return D.ajax({url:a,type:g,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),h.html(f?D("<div>").append(c.replace(Kb,"")).find(f):c)),d&&h.each(d,[c,b,a])}}),this},serialize:function(){return D.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?D.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||Lb.test(this.nodeName)||Fb.test(this.type))}).map(function(a,b){var c=D(this).val();return c==null?null:D.isArray(c)?D.map(c,function(a,c){return{name:b.name,value:a.replace(Cb,"\r\n")}}):{name:b.name,value:c.replace(Cb,"\r\n")}}).get()}}),D.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){D.fn[b]=function(a){return this.bind(b,a)}}),D.each(["get","post"],function(a,c){D[c]=function(a,d,e,f){return D.isFunction(d)&&(f=f||e,e=d,d=b),D.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),D.extend({getScript:function(a,c){return D.get(a,b,c,"script")},getJSON:function(a,b,c){return D.get(a,b,c,"json")},ajaxSetup:function(a,b){b?D.extend(!0,a,D.ajaxSettings,b):(b=a,a=D.extend(!0,D.ajaxSettings,b));for(var c in{context:1,url:1})c in b?a[c]=b[c]:c in D.ajaxSettings&&(a[c]=D.ajaxSettings[c]);return a},ajaxSettings:{url:Ub,isLocal:Gb.test(Vb[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":D.parseJSON,"text xml":D.parseXML}},ajaxPrefilter:m(Sb),ajaxTransport:m(Tb),ajax:function(a,c){function d(a,c,d,l){if(u!==2){u=2,s&&clearTimeout(s),r=b,p=l||"",x.readyState=a?4:0;var o,q,t,w=d?j(e,x,d):b,y,z;if(a>=200&&a<300||a===304){if(e.ifModified){if(y=x.getResponseHeader("Last-Modified"))D.lastModified[n]=y;if(z=x.getResponseHeader("Etag"))D.etag[n]=z}if(a===304)c="notmodified",o=!0;else try{q=i(e,w),c="success",o=!0}catch(A){c="parsererror",t=A}}else{t=c;if(!c||a)c="error",a<0&&(a=0)}x.status=a,x.statusText=c,o?h.resolveWith(f,[q,c,x]):h.rejectWith(f,[x,c,t]),x.statusCode(m),m=b,v&&g.trigger("ajax"+(o?"Success":"Error"),[x,e,o?q:t]),k.resolveWith(f,[x,c]),v&&(g.trigger("ajaxComplete",[x,e]),--D.active||D.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var e=D.ajaxSetup({},c),f=e.context||e,g=f!==e&&(f.nodeType||f instanceof D)?D(f):D.event,h=D.Deferred(),k=D._Deferred(),m=e.statusCode||{},n,o={},p,q,r,s,t,u=0,v,w,x={readyState:0,setRequestHeader:function(a,b){return u||(o[a.toLowerCase().replace(Ob,Pb)]=b),this},getAllResponseHeaders:function(){return u===2?p:null},getResponseHeader:function(a){var c;if(u===2){if(!q){q={};while(c=Eb.exec(p))q[c[1].toLowerCase()]=c[2]}c=q[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return u||(e.mimeType=a),this},abort:function(a){return a=a||"abort",r&&r.abort(a),d(0,a),this}};h.promise(x),x.success=x.done,x.error=x.fail,x.complete=k.done,x.statusCode=function(a){if(a){var b;if(u<2)for(b in a)m[b]=[m[b],a[b]];else b=a[x.status],x.then(b,b)}return this},e.url=((a||e.url)+"").replace(Db,"").replace(Ib,Vb[1]+"//"),e.dataTypes=D.trim(e.dataType||"*").toLowerCase().split(Mb),e.crossDomain||(t=Qb.exec(e.url.toLowerCase()),e.crossDomain=t&&(t[1]!=Vb[1]||t[2]!=Vb[2]||(t[3]||(t[1]==="http:"?80:443))!=(Vb[3]||(Vb[1]==="http:"?80:443)))),e.data&&e.processData&&typeof e.data!="string"&&(e.data=D.param(e.data,e.traditional)),l(Sb,e,c,x);if(u===2)return!1;v=e.global,e.type=e.type.toUpperCase(),e.hasContent=!Hb.test(e.type),v&&D.active++===0&&D.event.trigger("ajaxStart");if(!e.hasContent){e.data&&(e.url+=(Jb.test(e.url)?"&":"?")+e.data),n=e.url;if(e.cache===!1){var y=D.now(),z=e.url.replace(Nb,"$1_="+y);e.url=z+(z===e.url?(Jb.test(e.url)?"&":"?")+"_="+y:"")}}if(e.data&&e.hasContent&&e.contentType!==!1||c.contentType)o["Content-Type"]=e.contentType;e.ifModified&&(n=n||e.url,D.lastModified[n]&&(o["If-Modified-Since"]=D.lastModified[n]),D.etag[n]&&(o["If-None-Match"]=D.etag[n])),o.Accept=e.dataTypes[0]&&e.accepts[e.dataTypes[0]]?e.accepts[e.dataTypes[0]]+(e.dataTypes[0]!=="*"?", */*; q=0.01":""):e.accepts["*"];for(w in e.headers)x.setRequestHeader(w,e.headers[w]);if(!e.beforeSend||e.beforeSend.call(f,x,e)!==!1&&u!==2){for(w in{success:1,error:1,complete:1})x[w](e[w]);r=l(Tb,e,c,x);if(r){x.readyState=1,v&&g.trigger("ajaxSend",[x,e]),e.async&&e.timeout>0&&(s=setTimeout(function(){x.abort("timeout")},e.timeout));try{u=1,r.send(o,d)}catch(A){status<2?d(-1,A):D.error(A)}}else d(-1,"No Transport");return x}return x.abort(),!1},param:function(a,c){var d=[],e=function(a,b){b=D.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=D.ajaxSettings.traditional);if(D.isArray(a)||a.jquery&&!D.isPlainObject(a))D.each(a,function(){e(this.name,this.value)});else for(var f in a)k(f,a[f],c,e);return d.join("&").replace(Ab,"+")}}),D.extend({active:0,lastModified:{},etag:{}});var Xb=D.now(),Yb=/(\=)\?(&|$)|()\?\?()/i;D.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return D.expando+"_"+Xb++}}),D.ajaxPrefilter("json jsonp",function(b,c,d){var e=typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||c.jsonpCallback||c.jsonp!=null||b.jsonp!==!1&&(Yb.test(b.url)||e&&Yb.test(b.data))){var f,g=b.jsonpCallback=D.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h=a[g],i=b.url,j=b.data,k="$1"+g+"$2",l=function(){a[g]=h,f&&D.isFunction(h)&&a[g](f[0])};return b.jsonp!==!1&&(i=i.replace(Yb,k),b.url===i&&(e&&(j=j.replace(Yb,k)),b.data===j&&(i+=(/\?/.test(i)?"&":"?")+b.jsonp+"="+g))),b.url=i,b.data=j,a[g]=function(a){f=[a]},d.then(l,l),b.converters["script json"]=function(){return f||D.error(g+" was not called"),f[0]},b.dataTypes[0]="json","script"}}),D.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return D.globalEval(a),a}}}),D.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),D.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=C.head||C.getElementsByTagName("head")[0]||C.documentElement;return{send:function(e,f){c=C.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){if(!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var Zb=D.now(),$b,_b;D.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&g()||f()}:g,_b=D.ajaxSettings.xhr(),D.support.ajax=!!_b,D.support.cors=_b&&"withCredentials"in _b,_b=b,D.support.ajax&&D.ajaxTransport(function(a){if(!a.crossDomain||D.support.cors){var c;return{send:function(d,e){var f=a.xhr(),g,i;a.username?f.open(a.type,a.url,a.async,a.username,a.password):f.open(a.type,a.url,a.async);if(a.xhrFields)for(i in a.xhrFields)f[i]=a.xhrFields[i];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),(!a.crossDomain||a.hasContent)&&!d["X-Requested-With"]&&(d["X-Requested-With"]="XMLHttpRequest");try{for(i in d)f.setRequestHeader(i,d[i])}catch(j){}f.send(a.hasContent&&a.data||null),c=function(d,h){var i,j,k,l,m;try{if(c&&(h||f.readyState===4)){c=b,g&&(f.onreadystatechange=D.noop,delete $b[g]);if(h)f.readyState!==4&&f.abort();else{i=f.status,k=f.getAllResponseHeaders(),l={},m=f.responseXML,m&&m.documentElement&&(l.xml=m),l.text=f.responseText;try{j=f.statusText}catch(n){j=""}i||!a.isLocal||a.crossDomain?i===1223&&(i=204):i=l.text?200:404}}}catch(o){h||e(-1,o)}l&&e(i,j,l,k)},a.async&&f.readyState!==4?($b||($b={},h()),g=Zb++,f.onreadystatechange=$b[g]=c):c()},abort:function(){c&&c(0,1)}}}});var ac={},bc=/^(?:toggle|show|hide)$/,cc=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,dc,ec=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];D.fn.extend({show:function(a,b,c){var f,g;if(a||a===0)return this.animate(e("show",3),a,b,c);for(var h=0,i=this.length;h<i;h++)f=this[h],g=f.style.display,!D._data(f,"olddisplay")&&g==="none"&&(g=f.style.display=""),g===""&&D.css(f,"display")==="none"&&D._data(f,"olddisplay",d(f.nodeName));for(h=0;h<i;h++){f=this[h],g=f.style.display;if(g===""||g==="none")f.style.display=D._data(f,"olddisplay")||""}return this},hide:function(a,b,c){if(a||a===0)return this.animate(e("hide",3),a,b,c);for(var d=0,f=this.length;d<f;d++){var g=D.css(this[d],"display");g!=="none"&&!D._data(this[d],"olddisplay")&&D._data(this[d],"olddisplay",g)}for(d=0;d<f;d++)this[d].style.display="none";return this},_toggle:D.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";return D.isFunction(a)&&D.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:D(this).is(":hidden");D(this)[b?"show":"hide"]()}):this.animate(e("toggle",3),a,b,c),this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,e){var f=D.speed(b,c,e);return D.isEmptyObject(a)?this.each(f.complete):this[f.queue===!1?"each":"queue"](function(){var b=D.extend({},f),c,e=this.nodeType===1,g=e&&D(this).is(":hidden"),h=this;for(c in a){var i=D.camelCase(c);c!==i&&(a[i]=a[c],delete a[c],c=i);if(a[c]==="hide"&&g||a[c]==="show"&&!g)return b.complete.call(this);if(e&&(c==="height"||c==="width")){b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(D.css(this,"display")==="inline"&&D.css(this,"float")==="none")if(D.support.inlineBlockNeedsLayout){var j=d(this.nodeName);j==="inline"?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)}else this.style.display="inline-block"}D.isArray(a[c])&&((b.specialEasing=b.specialEasing||{})[c]=a[c][1],a[c]=a[c][0])}return b.overflow!=null&&(this.style.overflow="hidden"),b.curAnim=D.extend({},a),D.each(a,function(c,d){var e=new D.fx(h,b,c);if(bc.test(d))e[d==="toggle"?g?"show":"hide":d](a);else{var f=cc.exec(d),i=e.cur();if(f){var j=parseFloat(f[2]),k=f[3]||(D.cssNumber[c]?"":"px");k!=="px"&&(D.style(h,c,(j||1)+k),i=(j||1)/e.cur()*i,D.style(h,c,i+k)),f[1]&&(j=(f[1]==="-="?-1:1)*j+i),e.custom(i,j,k)}else e.custom(i,d,"")}}),!0})},stop:function(a,b){var c=D.timers;return a&&this.queue([]),this.each(function(){for(var a=c.length-1;a>=0;a--)c[a].elem===this&&(b&&c[a](!0),c.splice(a,1))}),b||this.dequeue(),this}}),D.each({slideDown:e("show",1),slideUp:e("hide",1),slideToggle:e("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){D.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),D.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?D.extend({},a):{complete:c||!c&&b||D.isFunction(a)&&a,duration:a,easing:c&&b||b&&!D.isFunction(b)&&b};return d.duration=D.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in D.fx.speeds?D.fx.speeds[d.duration]:D.fx.speeds._default,d.old=d.complete,d.complete=function(){d.queue!==!1&&D(this).dequeue(),D.isFunction(d.old)&&d.old.call(this)},d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig||(b.orig={})}}),D.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(D.fx.step[this.prop]||D.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]==null||!!this.elem.style&&this.elem.style[this.prop]!=null){var a,b=D.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a}return this.elem[this.prop]},custom:function(a,b,c){function d(a){return e.step(a)}var e=this,f=D.fx;this.startTime=D.now(),this.start=a,this.end=b,this.unit=c||this.unit||(D.cssNumber[this.prop]?"":"px"),this.now=this.start,this.pos=this.state=0,d.elem=this.elem,d()&&D.timers.push(d)&&!dc&&(dc=setInterval(f.tick,f.interval))},show:function(){this.options.orig[this.prop]=D.style(this.elem,this.prop),this.options.show=!0,this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),D(this.elem).show()},hide:function(){this.options.orig[this.prop]=D.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b=D.now(),c=!0;if(a||b>=this.options.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),this.options.curAnim[this.prop]=!0;for(var d in this.options.curAnim)this.options.curAnim[d]!==!0&&(c=!1);if(c){if(this.options.overflow!=null&&!D.support.shrinkWrapBlocks){var e=this.elem,f=this.options;D.each(["","X","Y"],function(a,b){e.style["overflow"+b]=f.overflow[a]})}this.options.hide&&D(this.elem).hide();if(this.options.hide||this.options.show)for(var g in this.options.curAnim)D.style(this.elem,g,this.options.orig[g]);this.options.complete.call(this.elem)}return!1}var h=b-this.startTime;this.state=h/this.options.duration;var i=this.options.specialEasing&&this.options.specialEasing[this.prop],j=this.options.easing||(D.easing.swing?"swing":"linear");return this.pos=D.easing[i||j](this.state,h,0,1,this.options.duration),this.now=this.start+(this.end-this.start)*this.pos,this.update(),!0}},D.extend(D.fx,{tick:function(){var a=D.timers;for(var b=0;b<a.length;b++)a[b]()||a.splice(b--,1);a.length||D.fx.stop()},interval:13,stop:function(){clearInterval(dc),dc=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){D.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}}),D.expr&&D.expr.filters&&(D.expr.filters.animated=function(a){return D.grep(D.timers,function(b){return a===b.elem}).length});var fc=/^t(?:able|d|h)$/i,gc=/^(?:body|html)$/i;"getBoundingClientRect"in C.documentElement?D.fn.offset=function(a){var b=this[0],d;if(a)return this.each(function(b){D.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return D.offset.bodyOffset(b);try{d=b.getBoundingClientRect()}catch(e){}var f=b.ownerDocument,g=f.documentElement;if(!d||!D.contains(g,b))return d?{top:d.top,left:d.left}:{top:0,left:0};var h=f.body,i=c(f),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||D.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||D.support.boxModel&&g.scrollLeft||h.scrollLeft,n=d.top+l-j,o=d.left+m-k;return{top:n,left:o}}:D.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){D.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return D.offset.bodyOffset(b);D.offset.initialize();var c,d=b.offsetParent,e=b,f=b.ownerDocument,g=f.documentElement,h=f.body,i=f.defaultView,j=i?i.getComputedStyle(b,null):b.currentStyle,k=b.offsetTop,l=b.offsetLeft;while((b=b.parentNode)&&b!==h&&b!==g){if(D.offset.supportsFixedPosition&&j.position==="fixed")break;c=i?i.getComputedStyle(b,null):b.currentStyle,k-=b.scrollTop,l-=b.scrollLeft,b===d&&(k+=b.offsetTop,l+=b.offsetLeft,D.offset.doesNotAddBorder&&(!D.offset.doesAddBorderForTableAndCells||!fc.test(b.nodeName))&&(k+=parseFloat(c.borderTopWidth)||0,l+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),D.offset.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(k+=parseFloat(c.borderTopWidth)||0,l+=parseFloat(c.borderLeftWidth)||0),j=c}if(j.position==="relative"||j.position==="static")k+=h.offsetTop,l+=h.offsetLeft;return D.offset.supportsFixedPosition&&j.position==="fixed"&&(k+=Math.max(g.scrollTop,h.scrollTop),l+=Math.max(g.scrollLeft,h.scrollLeft)),{top:k,left:l}},D.offset={initialize:function(){var a=C.body,b=C.createElement("div"),c,d,e,f,g=parseFloat(D.css(a,"marginTop"))||0,h="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";D.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),b.innerHTML=h,a.insertBefore(b,a.firstChild),c=b.firstChild,d=c.firstChild,f=c.nextSibling.firstChild.firstChild,this.doesNotAddBorder=d.offsetTop!==5,this.doesAddBorderForTableAndCells=f.offsetTop===5,d.style.position="fixed",d.style.top="20px",this.supportsFixedPosition=d.offsetTop===20||d.offsetTop===15,d.style.position=d.style.top="",c.style.overflow="hidden",c.style.position="relative",this.subtractsBorderForOverflowNotVisible=d.offsetTop===-5,this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==g,a.removeChild(b),a=b=c=d=e=f=null,D.offset.initialize=D.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return D.offset.initialize(),D.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(D.css(a,"marginTop"))||0,c+=parseFloat(D.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=D.css(a,"position");d==="static"&&(a.style.position="relative");var e=D(a),f=e.offset(),g=D.css(a,"top"),h=D.css(a,"left"),i=d==="absolute"&&D.inArray("auto",[g,h])>-1,j={},k={},l,m;i&&(k=e.position()),l=i?k.top:parseInt(g,10)||0,m=i?k.left:parseInt(h,10)||0,D.isFunction(b)&&(b=b.call(a,c,f)),b.top!=null&&(j.top=b.top-f.top+l),b.left!=null&&(j.left=b.left-f.left+m),"using"in b?b.using.call(a,j):e.css(j)}},D.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=gc.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(D.css(a,"marginTop"))||0,c.left-=parseFloat(D.css(a,"marginLeft"))||0,d.top+=parseFloat(D.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(D.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||C.body;while(a&&!gc.test(a.nodeName)&&D.css(a,"position")==="static")a=a.offsetParent;return a})}}),D.each(["Left","Top"],function(a,d){var e="scroll"+d;D.fn[e]=function(d){var f=this[0],g;return f?d!==b?this.each(function(){g=c(this),g?g.scrollTo(a?D(g).scrollLeft():d,a?d:D(g).scrollTop()):this[e]=d}):(g=c(f),g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:D.support.boxModel&&g.document.documentElement[e]||g.document.body[e]:f[e]):null}}),D.each(["Height","Width"],function(a,c){var d=c.toLowerCase();D.fn["inner"+c]=function(){return this[0]?parseFloat(D.css(this[0],d,"padding")):null},D.fn["outer"+c]=function(a){return this[0]?parseFloat(D.css(this[0],d,a?"margin":"border")):null},D.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(D.isFunction(a))return this.each(function(b){var c=D(this);c[d](a.call(this,b,c[d]()))});if(D.isWindow(e)){var f=e.document.documentElement["client"+c];return e.document.compatMode==="CSS1Compat"&&f||e.document.body["client"+c]||f}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var g=D.css(e,d),h=parseFloat(g);return D.isNaN(h)?g:h}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=D})(window);
(function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(w.has(a,h)){f++;if(!(g=w.has(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(w.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new E(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=w),exports._=w):a._=w,w.VERSION="1.3.1";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(w.has(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=w.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=w.toArray(a).reverse();return d&&!e&&(b=w.bind(b,d)),e?w.reduce(f,b,c,d):w.reduce(f,b)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var y=w.some=w.any=function(a,b,d){b||(b=w.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(w.isFunction(b)?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return w.reduce(d,function(c,d,f){if(0==f||(b===!0?w.last(c)!=d:!w.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a){var b=w.flatten(g.call(arguments,1));return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return w.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},w.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},w.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)w.has(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(w.has(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return i.call(a)=="[object Arguments]"},w.isArguments(arguments)||(w.isArguments=function(a){return!!a&&!!w.has(a,"callee")}),w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.has=function(a,b){return j.call(a,b)},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.mixin=function(a){x(w.functions(a),function(b){G(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||C,function(a,b){return"',_.escape("+D(b)+"),'"}).replace(c.interpolate||C,function(a,b){return"',"+D(b)+",'"}).replace(c.evaluate||C,function(a,b){return"');"+D(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,w):function(a){return e.call(this,a,w)}},w.chain=function(a){return w(a).chain()};var E=function(a){this._wrapped=a};w.prototype=E.prototype;var F=function(a,b){return b?w(a).chain():a},G=function(a,b){E.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),F(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];E.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],F(c,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];E.prototype[a]=function(){return F(b.apply(this._wrapped,arguments),this._chain)}}),E.prototype.chain=function(){return this._chain=!0,this},E.prototype.value=function(){return this._wrapped}}).call(this);
Ext.apply(String.prototype,function(){function a(a,b){return a=a||30,b=Object.isUndefined(b)?"...":b,this.length>a?this.slice(0,a-b.length)+b:String(this)}function b(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}function c(){return this.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")}function d(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function e(){return this.stripTags().replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}function f(){return this.split("")}function g(a){return a<1?"":(new Array(a+1)).join(this)}function h(){var a=this.split("-"),b=a.length;if(b==1)return a[0];var c=this.charAt(0)=="-"?a[0].charAt(0).toUpperCase()+a[0].substring(1):a[0];for(var d=1;d<b;d++)c+=a[d].charAt(0).toUpperCase()+a[d].substring(1);return c}function i(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase()}function j(){return this.charAt(0).toLowerCase()+this.substring(1)}function k(){return this.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/-/g,"_").toLowerCase()}function l(){return this.replace(/_/g,"-")}function m(a){return this.indexOf(a)>-1}function n(a){return this.indexOf(a)===0}function o(a){var b=this.length-a.length;return b>=0&&this.lastIndexOf(a)===b}function p(){return this==""}function q(){return/^\s*$/.test(this)}return{truncate:a,strip:String.prototype.trim?String.prototype.trim:b,stripTags:c,escapeHTML:d,unescapeHTML:e,toArray:f,times:g,camelize:h,capitalize:i,uncapitalize:j,underscore:k,dasherize:l,include:m,startsWith:n,endsWith:o,empty:p,blank:q}}());
Ext.define("Ext.ux.ColorField",{extend:"Ext.form.TriggerField",alias:"widget.colorfield",invalidText:"'{0}' is not a valid color - it must be in a the hex format (# followed by 3 or 6 letters/numbers 0-9 A-F)",triggerClass:"x-form-color-trigger",defaultAutoCreate:{tag:"input",type:"text",size:"10",maxlength:"7",autocomplete:"off"},maskRe:/[#a-f0-9]/i,initComponent:function(){this.pickerOptions||(this.pickerOptions={}),Ext.apply(this.pickerOptions,{allowReselect:!0}),this.callParent(arguments)},validateValue:function(a){if(!Ext.ux.ColorField.superclass.validateValue.call(this,a))return!1;if(a.length<1)return this.setColor(""),!0;var b=this.parseColor(a);return!a||b==0?(this.markInvalid(String.format(this.invalidText,a)),!1):(this.setColor(a),!0)},setColor:function(a){if(a==""||a==undefined)this.emptyText!=""&&this.parseColor(this.emptyText)?a=this.emptyText:a="transparent";this.trigger?this.trigger.setStyle({"background-color":a}):this.on("render",function(){this.setColor(a)},this)},validateBlur:function(){return!this.menu||!this.menu.isVisible()},getValue:function(){return Ext.ux.ColorField.superclass.getValue.call(this)||""},setValue:function(a){Ext.ux.ColorField.superclass.setValue.call(this,this.formatColor(a)),this.setColor(this.formatColor(a))},parseColor:function(a){return!a||a.substring(0,1)!="#"?!1:a.length==4||a.length==7},formatColor:function(a){return!a||this.parseColor(a)?a:a.length==3||a.length==6?"#"+a:""},menuListeners:{select:function(a,b){this.setValue(b)},show:function(){this.onFocus()},hide:function(){Ext.Function.defer(this.focus,10,this);var a=this.menuListeners;this.menu.un("select",a.select,this),this.menu.un("show",a.show,this),this.menu.un("hide",a.hide,this)}},onTriggerClick:function(){if(this.disabled)return;this.menu==null&&(this.menu=Ext.create("Ext.menu.ColorPicker",this.pickerOptions||{})),this.menu.on(Ext.apply({},this.menuListeners,{scope:this})),this.menu.showBy(this.el,"tl-bl?");var a=this.getValue();this.menu.colors.indexOf(a)!=-1&&this.menu.select(a)}});
(function(a){var b="0.4.0",c="hasOwnProperty",d=/[\.\/]/,e="*",f=function(){},g=function(a,b){return a-b},h,i,j={n:{}},k=function(a,b){var c=j,d=i,e=Array.prototype.slice.call(arguments,2),f=k.listeners(a),l=0,m=!1,n,o=[],p={},q=[],r=[];h=a,i=0;for(var s=0,t=f.length;s<t;s++)"zIndex"in f[s]&&(o.push(f[s].zIndex),f[s].zIndex<0&&(p[f[s].zIndex]=f[s]));o.sort(g);while(o[l]<0){n=p[o[l++]],q.push(n.apply(b,e));if(i)return i=d,q}for(s=0;s<t;s++){n=f[s];if("zIndex"in n)if(n.zIndex==o[l]){q.push(n.apply(b,e));if(i)return i=d,q;do{l++,n=p[o[l]],n&&q.push(n.apply(b,e));if(i)return i=d,q}while(n)}else p[n.zIndex]=n;else{q.push(n.apply(b,e));if(i)return i=d,q}}return i=d,q.length?q:null};k.listeners=function(a){var b=a.split(d),c=j,f,g,h,i,k,l,m,n,o=[c],p=[];for(i=0,k=b.length;i<k;i++){n=[];for(l=0,m=o.length;l<m;l++){c=o[l].n,g=[c[b[i]],c[e]],h=2;while(h--)f=g[h],f&&(n.push(f),p=p.concat(f.f||[]))}o=n}return p},k.on=function(a,b){var c=a.split(d),e=j;for(var g=0,h=c.length;g<h;g++)e=e.n,!e[c[g]]&&(e[c[g]]={n:{}}),e=e[c[g]];e.f=e.f||[];for(g=0,h=e.f.length;g<h;g++)if(e.f[g]==b)return f;return e.f.push(b),function(a){+a==+a&&(b.zIndex=+a)}},k.stop=function(){i=1},k.nt=function(a){return a?(new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)")).test(h):h},k.unbind=function(a,b){var f=a.split(d),g,h,i,k,l,m,n,o=[j];for(k=0,l=f.length;k<l;k++)for(m=0;m<o.length;m+=i.length-2){i=[m,1],g=o[m].n;if(f[k]!=e)g[f[k]]&&i.push(g[f[k]]);else for(h in g)g[c](h)&&i.push(g[h]);o.splice.apply(o,i)}for(k=0,l=o.length;k<l;k++){g=o[k];while(g.n){if(b){if(g.f){for(m=0,n=g.f.length;m<n;m++)if(g.f[m]==b){g.f.splice(m,1);break}!g.f.length&&delete g.f}for(h in g.n)if(g.n[c](h)&&g.n[h].f){var p=g.n[h].f;for(m=0,n=p.length;m<n;m++)if(p[m]==b){p.splice(m,1);break}!p.length&&delete g.n[h].f}}else{delete g.f;for(h in g.n)g.n[c](h)&&g.n[h].f&&delete g.n[h].f}g=g.n}}},k.once=function(a,b){var c=function(){b.apply(this,arguments),k.unbind(a,c)};return k.on(a,c)},k.version=b,k.toString=function(){return"You are running Eve "+b},typeof module!="undefined"&&module.exports?module.exports=k:a.eve=k})(this),function(){function a(a,b,d,e,g,h){d=$(d);var i,j,l,n=[],o,p,r,s=a.ms,t={},u={},v={};if(e)for(y=0,z=oc.length;y<z;y++){var w=oc[y];if(w.el.id==b.id&&w.anim==a){w.percent!=d?(oc.splice(y,1),l=1):j=w,b.attr(w.totalOrigin);break}}else e=+u;for(var y=0,z=a.percents.length;y<z;y++){if(a.percents[y]==d||a.percents[y]>e*a.top){d=a.percents[y],p=a.percents[y-1]||0,s=s/a.top*(d-p),o=a.percents[y+1],i=a.anim[d];break}e&&b.attr(a.anim[a.percents[y]])}if(!!i){if(!j){for(var A in i)if(i[q](A))if(cb[q](A)||b.paper.customAttributes[q](A)){t[A]=b.attr(A),t[A]==null&&(t[A]=bb[A]),u[A]=i[A];switch(cb[A]){case M:v[A]=(u[A]-t[A])/s;break;case"colour":t[A]=k.getRGB(t[A]);var D=k.getRGB(u[A]);v[A]={r:(D.r-t[A].r)/s,g:(D.g-t[A].g)/s,b:(D.b-t[A].b)/s};break;case"path":var E=Mb(t[A],u[A]),F=E[1];t[A]=E[0],v[A]=[];for(y=0,z=t[A].length;y<z;y++){v[A][y]=[0];for(var G=1,H=t[A][y].length;G<H;G++)v[A][y][G]=(F[y][G]-t[A][y][G])/s}break;case"transform":var I=b._,J=Vb(I[A],u[A]);if(J){t[A]=J.from,u[A]=J.to,v[A]=[],v[A].real=!0;for(y=0,z=t[A].length;y<z;y++){v[A][y]=[t[A][y][0]];for(G=1,H=t[A][y].length;G<H;G++)v[A][y][G]=(u[A][y][G]-t[A][y][G])/s}}else{var K=b.matrix||new f,L={_:{transform:I.transform},getBBox:function(){return b.getBBox(1)}};t[A]=[K.a,K.b,K.c,K.d,K.e,K.f],Tb(L,u[A]),u[A]=L._.transform,v[A]=[(L.matrix.a-K.a)/s,(L.matrix.b-K.b)/s,(L.matrix.c-K.c)/s,(L.matrix.d-K.d)/s,(L.matrix.e-K.e)/s,(L.matrix.e-K.f)/s]}break;case"csv":var N=B(i[A])[C](m),O=B(t[A])[C](m);if(A=="clip-rect"){t[A]=O,v[A]=[],y=O.length;while(y--)v[A][y]=(N[y]-t[A][y])/s}u[A]=N;break;default:N=[][x](i[A]),O=[][x](t[A]),v[A]=[],y=b.paper.customAttributes[A].length;while(y--)v[A][y]=((N[y]||0)-(O[y]||0))/s}}var P=i.easing,Q=k.easing_formulas[P];if(!Q){Q=B(P).match(X);if(Q&&Q.length==5){var R=Q;Q=function(a){return c(a,+R[1],+R[2],+R[3],+R[4],s)}}else Q=ob}r=i.start||a.start||+(new Date),w={anim:a,percent:d,timestamp:r,start:r+(a.del||0),status:0,initstatus:e||0,stop:!1,ms:s,easing:Q,from:t,diff:v,to:u,el:b,callback:i.callback,prev:p,next:o,repeat:h||a.times,origin:b.attr(),totalOrigin:g},oc.push(w);if(e&&!j&&!l){w.stop=!0,w.start=new Date-s*e;if(oc.length==1)return qc()}l&&(w.start=new Date-w.ms*e),oc.length==1&&pc(qc)}else j.initstatus=e,j.start=new Date-j.ms*e;eve("anim.start."+b.id,b,a)}}function b(a,b){var c=[],d={};this.ms=b,this.times=1;if(a){for(var e in a)a[q](e)&&(d[$(e)]=a[e],c.push($(e)));c.sort(mb)}this.anim=d,this.top=c[c.length-1],this.percents=c}function c(a,b,c,d,e,f){function g(a,b){var c,d,e,f,g,h;for(e=a,h=0;h<8;h++){f=i(e)-a;if(J(f)<b)return e;g=(3*l*e+2*k)*e+j;if(J(g)<1e-6)break;e-=f/g}c=0,d=1,e=a;if(e<c)return c;if(e>d)return d;while(c<d){f=i(e);if(J(f-a)<b)return e;a>f?c=e:d=e,e=(d-c)/2+c}return e}function h(a,b){var c=g(a,b);return((o*c+n)*c+m)*c}function i(a){return((l*a+k)*a+j)*a}var j=3*b,k=3*(d-b)-j,l=1-j-k,m=3*c,n=3*(e-c)-m,o=1-m-n;return h(a,1/(200*f))}function d(){return this.x+A+this.y+A+this.width+" × "+this.height}function e(){return this.x+A+this.y}function f(a,b,c,d,e,f){a!=null?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function g(a){var b=[];for(var c=0,d=a.length;d-2>c;c+=2){var e=[{x:+a[c],y:+a[c+1]},{x:+a[c],y:+a[c+1]},{x:+a[c+2],y:+a[c+3]},{x:+a[c+4],y:+a[c+5]}];d-4==c?(e[0]={x:+a[c-2],y:+a[c-1]},e[3]=e[2]):c&&(e[0]={x:+a[c-2],y:+a[c-1]}),b.push(["C",(-e[0].x+6*e[1].x+e[2].x)/6,(-e[0].y+6*e[1].y+e[2].y)/6,(e[1].x+6*e[2].x-e[3].x)/6,(e[1].y+6*e[2].y-e[3].y)/6,e[2].x,e[2].y])}return b}function h(){return this.hex}function i(a,b,c){function d(){var e=Array.prototype.slice.call(arguments,0),f=e.join("␀"),g=d.cache=d.cache||{},h=d.count=d.count||[];return g[q](f)?(j(h,f),c?c(g[f]):g[f]):(h.length>=1e3&&delete g[h.shift()],h.push(f),g[f]=a[w](b,e),c?c(g[f]):g[f])}return d}function j(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return a.push(a.splice(c,1)[0])}function k(a){if(k.is(a,"function"))return l?a():eve.on("DOMload",a);if(k.is(a,O))return k._engine.create[w](k,a.splice(0,3+k.is(a[0],M))).add(a);var b=Array.prototype.slice.call(arguments,0);if(k.is(b[b.length-1],"function")){var c=b.pop();return l?c.call(k._engine.create[w](k,b)):eve.on("DOMload",function(){c.call(k._engine.create[w](k,b))})}return k._engine.create[w](k,arguments)}k.version="2.0.1",k.eve=eve;var l,m=/[, ]+/,n={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},o=/\{(\d+)\}/g,p="prototype",q="hasOwnProperty",r={doc:document,win:window},s={was:Object.prototype[q].call(r.win,"Raphael"),is:r.win.Raphael},t=function(){this.ca=this.customAttributes={}},u,v="appendChild",w="apply",x="concat",y="createTouch"in r.doc,z="",A=" ",B=String,C="split",D="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[C](A),E={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},F=B.prototype.toLowerCase,G=Math,H=G.max,I=G.min,J=G.abs,K=G.pow,L=G.PI,M="number",N="string",O="array",P="toString",Q="fill",R=Object.prototype.toString,S={},T="push",U=k._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,V=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,W={NaN:1,Infinity:1,"-Infinity":1},X=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Y=G.round,Z="setAttribute",$=parseFloat,_=parseInt,ab=B.prototype.toUpperCase,bb=k._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},cb=k._availableAnimAttrs={blur:M,"clip-rect":"csv",cx:M,cy:M,fill:"colour","fill-opacity":M,"font-size":M,height:M,opacity:M,path:"path",r:M,rx:M,ry:M,stroke:"colour","stroke-opacity":M,"stroke-width":M,transform:"transform",width:M,x:M,y:M},db=/\s*,\s*/,eb={hs:1,rg:1},fb=/,?([achlmqrstvxz]),?/gi,gb=/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,hb=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,ib=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/ig,jb=k._radial_gradient=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,kb={},lb=function(a,b){return a.key-b.key},mb=function(a,b){return $(a)-$(b)},nb=function(){},ob=function(a){return a},pb=k._rectPath=function(a,b,c,d,e){return e?[["M",a+e,b],["l",c-e*2,0],["a",e,e,0,0,1,e,e],["l",0,d-e*2],["a",e,e,0,0,1,-e,e],["l",e*2-c,0],["a",e,e,0,0,1,-e,-e],["l",0,e*2-d],["a",e,e,0,0,1,e,-e],["z"]]:[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]]},qb=function(a,b,c,d){return d==null&&(d=c),[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]]},rb=k._getPath={path:function(a){return a.attr("path")},circle:function(a){var b=a.attrs;return qb(b.cx,b.cy,b.r)},ellipse:function(a){var b=a.attrs;return qb(b.cx,b.cy,b.rx,b.ry)},rect:function(a){var b=a.attrs;return pb(b.x,b.y,b.width,b.height,b.r)},image:function(a){var b=a.attrs;return pb(b.x,b.y,b.width,b.height)},text:function(a){var b=a._getBBox();return pb(b.x,b.y,b.width,b.height)}},sb=k.mapPath=function(a,b){if(!b)return a;var c,d,e,f,g,h,i;a=Mb(a);for(e=0,g=a.length;e<g;e++){i=a[e];for(f=1,h=i.length;f<h;f+=2)c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d}return a};k._g=r,k.type=r.win.SVGAngle||r.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(k.type=="VML"){var tb=r.doc.createElement("div"),ub;tb.innerHTML='<v:shape adj="1"/>',ub=tb.firstChild,ub.style.behavior="url(#default#VML)";if(!ub||typeof ub.adj!="object")return k.type=z;tb=null}k.svg=!(k.vml=k.type=="VML"),k._Paper=t,k.fn=u=t.prototype=k.prototype,k._id=0,k._oid=0,k.is=function(a,b){return b=F.call(b),b=="finite"?!W[q](+a):b=="array"?a instanceof Array:b=="null"&&a===null||b==typeof a&&a!==null||b=="object"&&a===Object(a)||b=="array"&&Array.isArray&&Array.isArray(a)||R.call(a).slice(8,-1).toLowerCase()==b},k.angle=function(a,b,c,d,e,f){if(e==null){var g=a-c,h=b-d;return!g&&!h?0:(180+G.atan2(-h,-g)*180/L+360)%360}return k.angle(a,b,e,f)-k.angle(c,d,e,f)},k.rad=function(a){return a%360*L/180},k.deg=function(a){return a*180/L%360},k.snapTo=function(a,b,c){c=k.is(c,"finite")?c:10;if(k.is(a,O)){var d=a.length;while(d--)if(J(a[d]-b)<=c)return a[d]}else{a=+a;var e=b%a;if(e<c)return b-e;if(e>a-c)return b-e+a}return b};var vb=k.createUUID=function(a,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=G.random()*16|0,c=a=="x"?b:b&3|8;return c.toString(16)});k.setWindow=function(a){eve("setWindow",k,r.win,a),r.win=a,r.doc=r.win.document,k._engine.initWin&&k._engine.initWin(r.win)};var wb=function(a){if(k.vml){var b=/^\s+|\s+$/g,c;try{var d=new ActiveXObject("htmlfile");d.write("<body>"),d.close(),c=d.body}catch(e){c=createPopup().document.body}var f=c.createTextRange();wb=i(function(a){try{c.style.color=B(a).replace(b,z);var d=f.queryCommandValue("ForeColor");return d=(d&255)<<16|d&65280|(d&16711680)>>>16,"#"+("000000"+d.toString(16)).slice(-6)}catch(e){return"none"}})}else{var g=r.doc.createElement("i");g.title="Raphaël Colour Picker",g.style.display="none",r.doc.body.appendChild(g),wb=i(function(a){return g.style.color=a,r.doc.defaultView.getComputedStyle(g,z).getPropertyValue("color")})}return wb(a)},xb=function(){return"hsb("+[this.h,this.s,this.b]+")"},yb=function(){return"hsl("+[this.h,this.s,this.l]+")"},zb=function(){return this.hex},Ab=function(a,b,c){b==null&&k.is(a,"object")&&"r"in a&&"g"in a&&"b"in a&&(c=a.b,b=a.g,a=a.r);if(b==null&&k.is(a,N)){var d=k.getRGB(a);a=d.r,b=d.g,c=d.b}if(a>1||b>1||c>1)a/=255,b/=255,c/=255;return[a,b,c]},Bb=function(a,b,c,d){a*=255,b*=255,c*=255;var e={r:a,g:b,b:c,hex:k.rgb(a,b,c),toString:zb};return k.is(d,"finite")&&(e.opacity=d),e};k.color=function(a){var b;return k.is(a,"object")&&"h"in a&&"s"in a&&"b"in a?(b=k.hsb2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):k.is(a,"object")&&"h"in a&&"s"in a&&"l"in a?(b=k.hsl2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):(k.is(a,"string")&&(a=k.getRGB(a)),k.is(a,"object")&&"r"in a&&"g"in a&&"b"in a?(b=k.rgb2hsl(a),a.h=b.h,a.s=b.s,a.l=b.l,b=k.rgb2hsb(a),a.v=b.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=zb,a},k.hsb2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"b"in a&&(c=a.b,b=a.s,a=a.h,d=a.o),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-J(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],Bb(e,f,g,d)},k.hsl2rgb=function(a,b,c,d){this.is(a,"object")&&"h"in a&&"s"in a&&"l"in a&&(c=a.l,b=a.s,a=a.h);if(a>1||b>1||c>1)a/=360,b/=100,c/=100;a*=360;var e,f,g,h,i;return a=a%360/60,i=2*b*(c<.5?c:1-c),h=i*(1-J(a%2-1)),e=f=g=c-i/2,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],Bb(e,f,g,d)},k.rgb2hsb=function(a,b,c){c=Ab(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;return f=H(a,b,c),g=f-I(a,b,c),d=g==0?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=g==0?0:g/f,{h:d,s:e,b:f,toString:xb}},k.rgb2hsl=function(a,b,c){c=Ab(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;return g=H(a,b,c),h=I(a,b,c),i=g-h,d=i==0?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=(d+360)%6*60/360,f=(g+h)/2,e=i==0?0:f<.5?i/(2*f):i/(2-2*f),{h:d,s:e,l:f,toString:yb}},k._path2string=function(){return this.join(",").replace(fb,"$1")};var Cb=k._preload=function(a,b){var c=r.doc.createElement("img");c.style.cssText="position:absolute;left:-9999em;top:-9999em",c.onload=function(){b.call(this),this.onload=null,r.doc.body.removeChild(this)},c.onerror=function(){r.doc.body.removeChild(this)},r.doc.body.appendChild(c),c.src=a};k.getRGB=i(function(a){if(!a||!!((a=B(a)).indexOf("-")+1))return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:h};if(a=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:h};!eb[q](a.toLowerCase().substring(0,2))&&a.charAt()!="#"&&(a=wb(a));var b,c,d,e,f,g,i,j=a.match(V);return j?(j[2]&&(e=_(j[2].substring(5),16),d=_(j[2].substring(3,5),16),c=_(j[2].substring(1,3),16)),j[3]&&(e=_((g=j[3].charAt(3))+g,16),d=_((g=j[3].charAt(2))+g,16),c=_((g=j[3].charAt(1))+g,16)),j[4]&&(i=j[4][C](db),c=$(i[0]),i[0].slice(-1)=="%"&&(c*=2.55),d=$(i[1]),i[1].slice(-1)=="%"&&(d*=2.55),e=$(i[2]),i[2].slice(-1)=="%"&&(e*=2.55),j[1].toLowerCase().slice(0,4)=="rgba"&&(f=$(i[3])),i[3]&&i[3].slice(-1)=="%"&&(f/=100)),j[5]?(i=j[5][C](db),c=$(i[0]),i[0].slice(-1)=="%"&&(c*=2.55),d=$(i[1]),i[1].slice(-1)=="%"&&(d*=2.55),e=$(i[2]),i[2].slice(-1)=="%"&&(e*=2.55),(i[0].slice(-3)=="deg"||i[0].slice(-1)=="°")&&(c/=360),j[1].toLowerCase().slice(0,4)=="hsba"&&(f=$(i[3])),i[3]&&i[3].slice(-1)=="%"&&(f/=100),k.hsb2rgb(c,d,e,f)):j[6]?(i=j[6][C](db),c=$(i[0]),i[0].slice(-1)=="%"&&(c*=2.55),d=$(i[1]),i[1].slice(-1)=="%"&&(d*=2.55),e=$(i[2]),i[2].slice(-1)=="%"&&(e*=2.55),(i[0].slice(-3)=="deg"||i[0].slice(-1)=="°")&&(c/=360),j[1].toLowerCase().slice(0,4)=="hsla"&&(f=$(i[3])),i[3]&&i[3].slice(-1)=="%"&&(f/=100),k.hsl2rgb(c,d,e,f)):(j={r:c,g:d,b:e,toString:h},j.hex="#"+(16777216|e|d<<8|c<<16).toString(16).slice(1),k.is(f,"finite")&&(j.opacity=f),j)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:h}},k),k.hsb=i(function(a,b,c){return k.hsb2rgb(a,b,c).hex}),k.hsl=i(function(a,b,c){return k.hsl2rgb(a,b,c).hex}),k.rgb=i(function(a,b,c){return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)}),k.getColor=function(a){var b=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||.75},c=this.hsb2rgb(b.h,b.s,b.b);return b.h+=.075,b.h>1&&(b.h=0,b.s-=.2,b.s<=0&&(this.getColor.start={h:0,s:1,b:b.b})),c.hex},k.getColor.reset=function(){delete this.start},k.parsePathString=i(function(a){if(!a)return null;var b={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},c=[];return k.is(a,O)&&k.is(a[0],O)&&(c=Eb(a)),c.length||B(a).replace(gb,function(a,d,e){var f=[],g=d.toLowerCase();e.replace(ib,function(a,b){b&&f.push(+b)}),g=="m"&&f.length>2&&(c.push([d][x](f.splice(0,2))),g="l",d=d=="m"?"l":"L");if(g=="r")c.push([d][x](f));else while(f.length>=b[g]){c.push([d][x](f.splice(0,b[g])));if(!b[g])break}}),c.toString=k._path2string,c}),k.parseTransformString=i(function(a){if(!a)return null;var b={r:3,s:4,t:2,m:6},c=[];return k.is(a,O)&&k.is(a[0],O)&&(c=Eb(a)),c.length||B(a).replace(hb,function(a,b,d){var e=[],f=F.call(b);d.replace(ib,function(a,b){b&&e.push(+b)}),c.push([b][x](e))}),c.toString=k._path2string,c}),k.findDotsAtSegment=function(a,b,c,d,e,f,g,h,i){var j=1-i,k=K(j,3),l=K(j,2),m=i*i,n=m*i,o=k*a+l*3*i*c+j*3*i*i*e+n*g,p=k*b+l*3*i*d+j*3*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,w=j*e+i*g,x=j*f+i*h,y=90-G.atan2(q-s,r-t)*180/L;return(q>s||r<t)&&(y+=180),{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:w,y:x},alpha:y}},k._removedFactory=function(a){return function(){throw new Error("Raphaël: you are calling to method “"+a+"” of removed object")}};var Db=i(function(a){if(!a)return{x:0,y:0,width:0,height:0};a=Mb(a);var b=0,c=0,d=[],e=[],f;for(var g=0,h=a.length;g<h;g++){f=a[g];if(f[0]=="M")b=f[1],c=f[2],d.push(b),e.push(c);else{var i=Lb(b,c,f[1],f[2],f[3],f[4],f[5],f[6]);d=d[x](i.min.x,i.max.x),e=e[x](i.min.y,i.max.y),b=f[5],c=f[6]}}var j=I[w](0,d),k=I[w](0,e);return{x:j,y:k,width:H[w](0,d)-j,height:H[w](0,e)-k}},null,function(a){return{x:a.x,y:a.y,width:a.width,height:a.height}}),Eb=function(a){var b=[];if(!k.is(a,O)||!k.is(a&&a[0],O))a=k.parsePathString(a);for(var c=0,d=a.length;c<d;c++){b[c]=[];for(var e=0,f=a[c].length;e<f;e++)b[c][e]=a[c][e]}return b.toString=k._path2string,b},Fb=k._pathToRelative=i(function(a){if(!k.is(a,O)||!k.is(a&&a[0],O))a=k.parsePathString(a);var b=[],c=0,d=0,e=0,f=0,g=0;a[0][0]=="M"&&(c=a[0][1],d=a[0][2],e=c,f=d,g++,b.push(["M",c,d]));for(var h=g,i=a.length;h<i;h++){var j=b[h]=[],l=a[h];if(l[0]!=F.call(l[0])){j[0]=F.call(l[0]);switch(j[0]){case"a":j[1]=l[1],j[2]=l[2],j[3]=l[3],j[4]=l[4],j[5]=l[5],j[6]=+(l[6]-c).toFixed(3),j[7]=+(l[7]-d).toFixed(3);break;case"v":j[1]=+(l[1]-d).toFixed(3);break;case"m":e=l[1],f=l[2];default:for(var m=1,n=l.length;m<n;m++)j[m]=+(l[m]-(m%2?c:d)).toFixed(3)}}else{j=b[h]=[],l[0]=="m"&&(e=l[1]+c,f=l[2]+d);for(var o=0,p=l.length;o<p;o++)b[h][o]=l[o]}var q=b[h].length;switch(b[h][0]){case"z":c=e,d=f;break;case"h":c+=+b[h][q-1];break;case"v":d+=+b[h][q-1];break;default:c+=+b[h][q-2],d+=+b[h][q-1]}}return b.toString=k._path2string,b},0,Eb),Gb=k._pathToAbsolute=i(function(a){if(!k.is(a,O)||!k.is(a&&a[0],O))a=k.parsePathString(a);if(!a||!a.length)return[["M",0,0]];var b=[],c=0,d=0,e=0,f=0,h=0;a[0][0]=="M"&&(c=+a[0][1],d=+a[0][2],e=c,f=d,h++,b[0]=["M",c,d]);for(var i,j,l=h,m=a.length;l<m;l++){b.push(i=[]),j=a[l];if(j[0]!=ab.call(j[0])){i[0]=ab.call(j[0]);switch(i[0]){case"A":i[1]=j[1],i[2]=j[2],i[3]=j[3],i[4]=j[4],i[5]=j[5],i[6]=+(j[6]+c),i[7]=+(j[7]+d);break;case"V":i[1]=+j[1]+d;break;case"H":i[1]=+j[1]+c;break;case"R":var n=[c,d][x](j.slice(1));for(var o=2,p=n.length;o<p;o++)n[o]=+n[o]+c,n[++o]=+n[o]+d;b.pop(),b=b[x](g(n));break;case"M":e=+j[1]+c,f=+j[2]+d;default:for(o=1,p=j.length;o<p;o++)i[o]=+j[o]+(o%2?c:d)}}else if(j[0]=="R")n=[c,d][x](j.slice(1)),b.pop(),b=b[x](g(n)),i=["R"][x](j.slice(-2));else for(var q=0,r=j.length;q<r;q++)i[q]=j[q];switch(i[0]){case"Z":c=e,d=f;break;case"H":c=i[1];break;case"V":d=i[1];break;case"M":e=i[i.length-2],f=i[i.length-1];default:c=i[i.length-2],d=i[i.length-1]}}return b.toString=k._path2string,b},null,Eb),Hb=function(a,b,c,d){return[a,b,c,d,c,d]},Ib=function(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]},Jb=function(a,b,c,d,e,f,g,h,j,k){var l=L*120/180,m=L/180*(+e||0),n=[],o,p=i(function(a,b,c){var d=a*G.cos(c)-b*G.sin(c),e=a*G.sin(c)+b*G.cos(c);return{x:d,y:e}});if(!k){o=p(a,b,-m),a=o.x,b=o.y,o=p(h,j,-m),h=o.x,j=o.y;var q=G.cos(L/180*e),r=G.sin(L/180*e),s=(a-h)/2,t=(b-j)/2,u=s*s/(c*c)+t*t/(d*d);u>1&&(u=G.sqrt(u),c=u*c,d=u*d);var v=c*c,w=d*d,y=(f==g?-1:1)*G.sqrt(J((v*w-v*t*t-w*s*s)/(v*t*t+w*s*s))),z=y*c*t/d+(a+h)/2,A=y*-d*s/c+(b+j)/2,B=G.asin(((b-A)/d).toFixed(9)),D=G.asin(((j-A)/d).toFixed(9));B=a<z?L-B:B,D=h<z?L-D:D,B<0&&(B=L*2+B),D<0&&(D=L*2+D),g&&B>D&&(B-=L*2),!g&&D>B&&(D-=L*2)}else B=k[0],D=k[1],z=k[2],A=k[3];var E=D-B;if(J(E)>l){var F=D,H=h,I=j;D=B+l*(g&&D>B?1:-1),h=z+c*G.cos(D),j=A+d*G.sin(D),n=Jb(h,j,c,d,e,0,g,H,I,[D,F,z,A])}E=D-B;var K=G.cos(B),M=G.sin(B),N=G.cos(D),O=G.sin(D),P=G.tan(E/4),Q=4/3*c*P,R=4/3*d*P,S=[a,b],T=[a+Q*M,b-R*K],U=[h+Q*O,j-R*N],V=[h,j];T[0]=2*S[0]-T[0],T[1]=2*S[1]-T[1];if(k)return[T,U,V][x](n);n=[T,U,V][x](n).join()[C](",");var W=[];for(var X=0,Y=n.length;X<Y;X++)W[X]=X%2?p(n[X-1],n[X],m).y:p(n[X],n[X+1],m).x;return W},Kb=function(a,b,c,d,e,f,g,h,i){var j=1-i;return{x:K(j,3)*a+K(j,2)*3*i*c+j*3*i*i*e+K(i,3)*g,y:K(j,3)*b+K(j,2)*3*i*d+j*3*i*i*f+K(i,3)*h}},Lb=i(function(a,b,c,d,e,f,g,h){var i=e-2*c+a-(g-2*e+c),j=2*(c-a)-2*(e-c),k=a-c,l=(-j+G.sqrt(j*j-4*i*k))/2/i,m=(-j-G.sqrt(j*j-4*i*k))/2/i,n=[b,h],o=[a,g],p;return J(l)>"1e12"&&(l=.5),J(m)>"1e12"&&(m=.5),l>0&&l<1&&(p=Kb(a,b,c,d,e,f,g,h,l),o.push(p.x),n.push(p.y)),m>0&&m<1&&(p=Kb(a,b,c,d,e,f,g,h,m),o.push(p.x),n.push(p.y)),i=f-2*d+b-(h-2*f+d),j=2*(d-b)-2*(f-d),k=b-d,l=(-j+G.sqrt(j*j-4*i*k))/2/i,m=(-j-G.sqrt(j*j-4*i*k))/2/i,J(l)>"1e12"&&(l=.5),J(m)>"1e12"&&(m=.5),l>0&&l<1&&(p=Kb(a,b,c,d,e,f,g,h,l),o.push(p.x),n.push(p.y)),m>0&&m<1&&(p=Kb(a,b,c,d,e,f,g,h,m),o.push(p.x),n.push(p.y)),{min:{x:I[w](0,o),y:I[w](0,n)},max:{x:H[w](0,o),y:H[w](0,n)}}}),Mb=k._path2curve=i(function(a,b){var c=Gb(a),d=b&&Gb(b),e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g=function(a,b){var c,d;if(!a)return["C",b.x,b.y,b.x,b.y,b.x,b.y];!(a[0]in{T:1,Q:1})&&(b.qx=b.qy=null);switch(a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"][x](Jb[w](0,[b.x,b.y][x](a.slice(1))));break;case"S":c=b.x+(b.x-(b.bx||b.x)),d=b.y+(b.y-(b.by||b.y)),a=["C",c,d][x](a.slice(1));break;case"T":b.qx=b.x+(b.x-(b.qx||b.x)),b.qy=b.y+(b.y-(b.qy||b.y)),a=["C"][x](Ib(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"][x](Ib(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][x](Hb(b.x,b.y,a[1],a[2]));break;case"H":a=["C"][x](Hb(b.x,b.y,a[1],b.y));break;case"V":a=["C"][x](Hb(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"][x](Hb(b.x,b.y,b.X,b.Y))}return a},h=function(a,b){if(a[b].length>7){a[b].shift();var e=a[b];while(e.length)a.splice(b++,0,["C"][x](e.splice(0,6)));a.splice(b,1),k=H(c.length,d&&d.length||0)}},i=function(a,b,e,f,g){a&&b&&a[g][0]=="M"&&b[g][0]!="M"&&(b.splice(g,0,["M",f.x,f.y]),e.bx=0,e.by=0,e.x=a[g][1],e.y=a[g][2],k=H(c.length,d&&d.length||0))};for(var j=0,k=H(c.length,d&&d.length||0);j<k;j++){c[j]=g(c[j],e),h(c,j),d&&(d[j]=g(d[j],f)),d&&h(d,j),i(c,d,e,f,j),i(d,c,f,e,j);var l=c[j],m=d&&d[j],n=l.length,o=d&&m.length;e.x=l[n-2],e.y=l[n-1],e.bx=$(l[n-4])||e.x,e.by=$(l[n-3])||e.y,f.bx=d&&($(m[o-4])||f.x),f.by=d&&($(m[o-3])||f.y),f.x=d&&m[o-2],f.y=d&&m[o-1]}return d?[c,d]:c},null,Eb),Nb=k._parseDots=i(function(a){var b=[];for(var c=0,d=a.length;c<d;c++){var e={},f=a[c].match(/^([^:]*):?([\d\.]*)/);e.color=k.getRGB(f[1]);if(e.color.error)return null;e.color=e.color.hex,f[2]&&(e.offset=f[2]+"%"),b.push(e)}for(c=1,d=b.length-1;c<d;c++)if(!b[c].offset){var g=$(b[c-1].offset||0),h=0;for(var i=c+1;i<d;i++)if(b[i].offset){h=b[i].offset;break}h||(h=100,i=d),h=$(h);var j=(h-g)/(i-c+1);for(;c<i;c++)g+=j,b[c].offset=g+"%"}return b}),Ob=k._tear=function(a,b){a==b.top&&(b.top=a.prev),a==b.bottom&&(b.bottom=a.next),a.next&&(a.next.prev=a.prev),a.prev&&(a.prev.next=a.next)},Pb=k._tofront=function(a,b){b.top!==a&&(Ob(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)},Qb=k._toback=function(a,b){b.bottom!==a&&(Ob(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)},Rb=k._insertafter=function(a,b,c){Ob(a,c),b==c.top&&(c.top=a),b.next&&(b.next.prev=a),a.next=b.next,a.prev=b,b.next=a},Sb=k._insertbefore=function(a,b,c){Ob(a,c),b==c.bottom&&(c.bottom=a),b.prev&&(b.prev.next=a),a.prev=b.prev,b.prev=a,a.next=b},Tb=k._extractTransform=function(a,b){if(b==null)return a._.transform;b=B(b).replace(/\.{3}|\u2026/g,a._.transform||z);var c=k.parseTransformString(b),d=0,e=0,g=0,h=1,i=1,j=a._,l=new f;j.transform=c||[];if(c)for(var m=0,n=c.length;m<n;m++){var o=c[m],p=o.length,q=B(o[0]).toLowerCase(),r=o[0]!=q,s=r?l.invert():0,t,u,v,w,x;q=="t"&&p==3?r?(t=s.x(0,0),u=s.y(0,0),v=s.x(o[1],o[2]),w=s.y(o[1],o[2]),l.translate(v-t,w-u)):l.translate(o[1],o[2]):q=="r"?p==2?(x=x||a.getBBox(1),l.rotate(o[1],x.x+x.width/2,x.y+x.height/2),d+=o[1]):p==4&&(r?(v=s.x(o[2],o[3]),w=s.y(o[2],o[3]),l.rotate(o[1],v,w)):l.rotate(o[1],o[2],o[3]),d+=o[1]):q=="s"?p==2||p==3?(x=x||a.getBBox(1),l.scale(o[1],o[p-1],x.x+x.width/2,x.y+x.height/2),h*=o[1],i*=o[p-1]):p==5&&(r?(v=s.x(o[3],o[4]),w=s.y(o[3],o[4]),l.scale(o[1],o[2],v,w)):l.scale(o[1],o[2],o[3],o[4]),h*=o[1],i*=o[2]):q=="m"&&p==7&&l.add(o[1],o[2],o[3],o[4],o[5],o[6]),j.dirtyT=1,a.matrix=l}a.matrix=l,j.sx=h,j.sy=i,j.deg=d,j.dx=e=l.e,j.dy=g=l.f,h==1&&i==1&&!d&&j.bbox?(j.bbox.x+=+e,j.bbox.y+=+g):j.dirtyT=1},Ub=function(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return a.length==4?[b,0,a[2],a[3]]:[b,0];case"s":return a.length==5?[b,1,1,a[3],a[4]]:a.length==3?[b,1,1]:[b,1]}},Vb=k._equaliseTransform=function(a,b){b=B(b).replace(/\.{3}|\u2026/g,a),a=k.parseTransformString(a)||[],b=k.parseTransformString(b)||[];var c=H(a.length,b.length),d=[],e=[],f=0,g,h,i,j;for(;f<c;f++){i=a[f]||Ub(b[f]),j=b[f]||Ub(i);if(i[0]!=j[0]||i[0].toLowerCase()=="r"&&(i[2]!=j[2]||i[3]!=j[3])||i[0].toLowerCase()=="s"&&(i[3]!=j[3]||i[4]!=j[4]))return;d[f]=[],e[f]=[];for(g=0,h=H(i.length,j.length);g<h;g++)g in i&&(d[f][g]=i[g]),g in j&&(e[f][g]=j[g])}return{from:d,to:e}};k._getContainer=function(a,b,c,d){var e;e=d==null&&!k.is(a,"object")?r.doc.getElementById(a):a;if(e!=null)return e.tagName?b==null?{container:e,width:e.style.pixelWidth||e.offsetWidth,height:e.style.pixelHeight||e.offsetHeight}:{container:e,width:b,height:c}:{container:1,x:a,y:b,width:c,height:d}},k.pathToRelative=Fb,k._engine={},k.path2curve=Mb,k.matrix=function(a,b,c,d,e,g){return new f(a,b,c,d,e,g)},function(a){function b(a){var b=G.sqrt(c(a));a[0]&&(a[0]/=b),a[1]&&(a[1]/=b)}function c(a){return a[0]*a[0]+a[1]*a[1]}a.add=function(a,b,c,d,e,g){var h=[[],[],[]],i=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],j=[[a,c,e],[b,d,g],[0,0,1]],k,l,m,n;a&&a instanceof f&&(j=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]);for(k=0;k<3;k++)for(l=0;l<3;l++){n=0;for(m=0;m<3;m++)n+=i[k][m]*j[m][l];h[k][l]=n}this.a=h[0][0],this.b=h[1][0],this.c=h[0][1],this.d=h[1][1],this.e=h[0][2],this.f=h[1][2]},a.invert=function(){var a=this,b=a.a*a.d-a.b*a.c;return new f(a.d/b,-a.b/b,-a.c/b,a.a/b,(a.c*a.f-a.d*a.e)/b,(a.b*a.e-a.a*a.f)/b)},a.clone=function(){return new f(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(a,b){this.add(1,0,0,1,a,b)},a.scale=function(a,b,c,d){b==null&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d)},a.rotate=function(a,b,c){a=k.rad(a),b=b||0,c=c||0;var d=+G.cos(a).toFixed(9),e=+G.sin(a).toFixed(9);this.add(d,e,-e,d,b,c),this.add(1,0,0,1,-b,-c)},a.x=function(a,b){return a*this.a+b*this.c+this.e},a.y=function(a,b){return a*this.b+b*this.d+this.f},a.get=function(a){return+this[B.fromCharCode(97+a)].toFixed(4)},a.toString=function(){return k.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var a={};a.dx=this.e,a.dy=this.f;var d=[[this.a,this.c],[this.b,this.d]];a.scalex=G.sqrt(c(d[0])),b(d[0]),a.shear=d[0][0]*d[1][0]+d[0][1]*d[1][1],d[1]=[d[1][0]-d[0][0]*a.shear,d[1][1]-d[0][1]*a.shear],a.scaley=G.sqrt(c(d[1])),b(d[1]),a.shear/=a.scaley;var e=-d[0][1],f=d[1][1];return f<0?(a.rotate=k.deg(G.acos(f)),e<0&&(a.rotate=360-a.rotate)):a.rotate=k.deg(G.asin(e)),a.isSimple=!+a.shear.toFixed(9)&&(a.scalex.toFixed(9)==a.scaley.toFixed(9)||!a.rotate),a.isSuperSimple=!+a.shear.toFixed(9)&&a.scalex.toFixed(9)==a.scaley.toFixed(9)&&!a.rotate,a.noRotation=!+a.shear.toFixed(9)&&!a.rotate,a},a.toTransformString=function(a){var b=a||this[C]();return b.isSimple?(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx&&b.dy?"t"+[b.dx,b.dy]:z)+(b.scalex!=1||b.scaley!=1?"s"+[b.scalex,b.scaley,0,0]:z)+(b.rotate?"r"+[b.rotate,0,0]:z)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(f.prototype);var Wb=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(Wb&&Wb[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&Wb&&Wb[1]<8?u.safari=function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){a.remove()})}:u.safari=nb;var Xb=function(){this.returnValue=!1},Yb=function(){return this.originalEvent.preventDefault()},Zb=function(){this.cancelBubble=!0},$b=function(){return this.originalEvent.stopPropagation()},_b=function(){if(r.doc.addEventListener)return function(a,b,c,d){var e=y&&E[b]?E[b]:b,f=function(e){var f=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,g=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft,h=e.clientX+g,i=e.clientY+f;if(y&&E[q](b))for(var j=0,k=e.targetTouches&&e.targetTouches.length;j<k;j++)if(e.targetTouches[j].target==a){var l=e;e=e.targetTouches[j],e.originalEvent=l,e.preventDefault=Yb,e.stopPropagation=$b;break}return c.call(d,e,h,i)};return a.addEventListener(e,f,!1),function(){return a.removeEventListener(e,f,!1),!0}};if(r.doc.attachEvent)return function(a,b,c,d){var e=function(a){a=a||r.win.event;var b=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,e=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft,f=a.clientX+e,g=a.clientY+b;return a.preventDefault=a.preventDefault||Xb,a.stopPropagation=a.stopPropagation||Zb,c.call(d,a,f,g)};a.attachEvent("on"+b,e);var f=function(){return a.detachEvent("on"+b,e),!0};return f}}(),ac=[],bc=function(a){var b=a.clientX,c=a.clientY,d=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,e=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft,f,g=ac.length;while(g--){f=ac[g];if(y){var h=a.touches.length,i;while(h--){i=a.touches[h];if(i.identifier==f.el._drag.id){b=i.clientX,c=i.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}}else a.preventDefault();var j=f.el.node,k,l=j.nextSibling,m=j.parentNode,n=j.style.display;r.win.opera&&m.removeChild(j),j.style.display="none",k=f.el.paper.getElementByPoint(b,c),j.style.display=n,r.win.opera&&(l?m.insertBefore(j,l):m.appendChild(j)),k&&eve("drag.over."+f.el.id,f.el,k),b+=e,c+=d,eve("drag.move."+f.el.id,f.move_scope||f.el,b-f.el._drag.x,c-f.el._drag.y,b,c,a)}},cc=function(a){k.unmousemove(bc).unmouseup(cc);var b=ac.length,c;while(b--)c=ac[b],c.el._drag={},eve("drag.end."+c.el.id,c.end_scope||c.start_scope||c.move_scope||c.el,a);ac=[]},dc=k.el={};for(var ec=D.length;ec--;)(function(a){k[a]=dc[a]=function(b,c){return k.is(b,"function")&&(this.events=this.events||[],this.events.push({name:a,f:b,unbind:_b(this.shape||this.node||r.doc,a,b,c||this)})),this},k["un"+a]=dc["un"+a]=function(b){var c=this.events,d=c.length;while(d--)if(c[d].name==a&&c[d].f==b)return c[d].unbind(),c.splice(d,1),!c.length&&delete this.events,this;return this}})(D[ec]);dc.data=function(a,b){var c=kb[this.id]=kb[this.id]||{};if(arguments.length==1){if(k.is(a,"object")){for(var d in a)a[q](d)&&this.data(d,a[d]);return this}return eve("data.get."+this.id,this,c[a],a),c[a]}return c[a]=b,eve("data.set."+this.id,this,b,a),this},dc.removeData=function(a){return a==null?kb[this.id]={}:kb[this.id]&&delete kb[this.id][a],this},dc.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},dc.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var fc=[];dc.drag=function(a,b,c,d,e,f){function g(g){(g.originalEvent||g).preventDefault();var h=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,i=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft;this._drag.x=g.clientX+i,this._drag.y=g.clientY+h,this._drag.id=g.identifier,!ac.length&&k.mousemove(bc).mouseup(cc),ac.push({el:this,move_scope:d,start_scope:e,end_scope:f}),b&&eve.on("drag.start."+this.id,b),a&&eve.on("drag.move."+this.id,a),c&&eve.on("drag.end."+this.id,c),eve("drag.start."+this.id,e||d||this,g.clientX+i,g.clientY+h,g)}return this._drag={},fc.push({el:this,start:g}),this.mousedown(g),this},dc.onDragOver=function(a){a?eve.on("drag.over."+this.id,a):eve.unbind("drag.over."+this.id)},dc.undrag=function(){var a=fc.length;while(a--)fc[a].el==this&&(this.unmousedown(fc[a].start),fc.splice(a,1),eve.unbind("drag.*."+this.id));!fc.length&&k.unmousemove(bc).unmouseup(cc)},u.circle=function(a,b,c){var d=k._engine.circle(this,a||0,b||0,c||0);return this.__set__&&this.__set__.push(d),d},u.rect=function(a,b,c,d,e){var f=k._engine.rect(this,a||0,b||0,c||0,d||0,e||0);return this.__set__&&this.__set__.push(f),f},u.ellipse=function(a,b,c,d){var e=k._engine.ellipse(this,a||0,b||0,c||0,d||0);return this.__set__&&this.__set__.push(e),e},u.path=function(a){a&&!k.is(a,N)&&!k.is(a[0],O)&&(a+=z);var b=k._engine.path(k.format[w](k,arguments),this);return this.__set__&&this.__set__.push(b),b},u.image=function(a,b,c,d,e){var f=k._engine.image(this,a||"about:blank",b||0,c||0,d||0,e||0);return this.__set__&&this.__set__.push(f),f},u.text=function(a,b,c){var d=k._engine.text(this,a||0,b||0,B(c));return this.__set__&&this.__set__.push(d),d},u.set=function(a){!k.is(a,"array")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var b=new sc(a);return this.__set__&&this.__set__.push(b),b},u.setStart=function(a){this.__set__=a||this.set()},u.setFinish=function(a){var b=this.__set__;return delete this.__set__,b},u.setSize=function(a,b){return k._engine.setSize.call(this,a,b)},u.setViewBox=function(a,b,c,d,e){return k._engine.setViewBox.call(this,a,b,c,d,e)},u.top=u.bottom=null,u.raphael=k;var gc=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,h=b.top+(r.win.pageYOffset||e.scrollTop||d.scrollTop)-f,i=b.left+(r.win.pageXOffset||e.scrollLeft||d.scrollLeft)-g;return{y:h,x:i}};u.getElementByPoint=function(a,b){var c=this,d=c.canvas,e=r.doc.elementFromPoint(a,b);if(r.win.opera&&e.tagName=="svg"){var f=gc(d),g=d.createSVGRect();g.x=a-f.x,g.y=b-f.y,g.width=g.height=1;var h=d.getIntersectionList(g,null);h.length&&(e=h[h.length-1])}if(!e)return null;while(e.parentNode&&e!=d.parentNode&&!e.raphael)e=e.parentNode;return e==c.canvas.parentNode&&(e=d),e=e&&e.raphael?c.getById(e.raphaelid):null,e},u.getById=function(a){var b=this.bottom;while(b){if(b.id==a)return b;b=b.next}return null},u.forEach=function(a,b){var c=this.bottom;while(c){if(a.call(b,c)===!1)return this;c=c.next}return this},dc.getBBox=function(a){if(this.removed)return{};var b=this._;if(a){if(b.dirty||!b.bboxwt)this.realPath=rb[this.type](this),b.bboxwt=Db(this.realPath),b.bboxwt.toString=d,b.dirty=0;return b.bboxwt}if(b.dirty||b.dirtyT||!b.bbox){if(b.dirty||!this.realPath)b.bboxwt=0,this.realPath=rb[this.type](this);b.bbox=Db(sb(this.realPath,this.matrix)),b.bbox.toString=d,b.dirty=b.dirtyT=0}return b.bbox},dc.clone=function(){if(this.removed)return null;var a=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(a),a},dc.glow=function(a){if(this.type=="text")return null;a=a||{};var b={width:(a.width||10)+(+this.attr("stroke-width")||1),fill:a.fill||!1,opacity:a.opacity||.5,offsetx:a.offsetx||0,offsety:a.offsety||0,color:a.color||"#000"},c=b.width/2,d=this.paper,e=d.set(),f=this.realPath||rb[this.type](this);f=this.matrix?sb(f,this.matrix):f;for(var g=1;g<c+1;g++)e.push(d.path(f).attr({stroke:b.color,fill:b.fill?b.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(b.width/c*g).toFixed(3),opacity:+(b.opacity/c).toFixed(3)}));return e.insertBefore(this).translate(b.offsetx,b.offsety)};var hc={},ic=function(a,b,c,d,e,f,g,h,i){var j=0,l=100,m=[a,b,c,d,e,f,g,h].join(),n=hc[m],o,p;!n&&(hc[m]=n={data:[]}),n.timer&&clearTimeout(n.timer),n.timer=setTimeout(function(){delete hc[m]},2e3);if(i!=null&&!n.precision){var q=ic(a,b,c,d,e,f,g,h);n.precision=~~q*10,n.data=[]}l=n.precision||l;for(var r=0;r<l+1;r++){n.data[r*l]?p=n.data[r*l]:(p=k.findDotsAtSegment(a,b,c,d,e,f,g,h,r/l),n.data[r*l]=p),r&&(j+=K(K(o.x-p.x,2)+K(o.y-p.y,2),.5));if(i!=null&&j>=i)return p;o=p}if(i==null)return j},jc=function(a,b){return function(c,d,e){c=Mb(c);var f,g,h,i,j="",l={},m,n=0;for(var o=0,p=c.length;o<p;o++){h=c[o];if(h[0]=="M")f=+h[1],g=+h[2];else{i=ic(f,g,h[1],h[2],h[3],h[4],h[5],h[6]);if(n+i>d){if(b&&!l.start){m=ic(f,g,h[1],h[2],h[3],h[4],h[5],h[6],d-n),j+=["C"+m.start.x,m.start.y,m.m.x,m.m.y,m.x,m.y];if(e)return j;l.start=j,j=["M"+m.x,m.y+"C"+m.n.x,m.n.y,m.end.x,m.end.y,h[5],h[6]].join(),n+=i,f=+h[5],g=+h[6];continue}if(!a&&!b)return m=ic(f,g,h[1],h[2],h[3],h[4],h[5],h[6],d-n),{x:m.x,y:m.y,alpha:m.alpha}}n+=i,f=+h[5],g=+h[6]}j+=h.shift()+h}return l.end=j,m=a?n:b?l:k.findDotsAtSegment(f,g,h[0],h[1],h[2],h[3],h[4],h[5],1),m.alpha&&(m={x:m.x,y:m.y,alpha:m.alpha}),m}},kc=jc(1),lc=jc(),mc=jc(0,1);k.getTotalLength=kc,k.getPointAtLength=lc,k.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<1e-6)return mc(a,b).end;var d=mc(a,c,1);return b?mc(d,b).end:d},dc.getTotalLength=function(){if(this.type=="path")return this.node.getTotalLength?this.node.getTotalLength():kc(this.attrs.path)},dc.getPointAtLength=function(a){if(this.type=="path")return lc(this.attrs.path,a)},dc.getSubpath=function(a,b){if(this.type=="path")return k.getSubpath(this.attrs.path,a,b)};var nc=k.easing_formulas={linear:function(a){return a},"<":function(a){return K(a,1.7)},">":function(a){return K(a,.48)},"<>":function(a){var b=.48-a/1.04,c=G.sqrt(.1734+b*b),d=c-b,e=K(J(d),1/3)*(d<0?-1:1),f=-c-b,g=K(J(f),1/3)*(f<0?-1:1),h=e+g+.5;return(1-h)*3*h*h+h*h*h},backIn:function(a){var b=1.70158;return a*a*((b+1)*a-b)},backOut:function(a){a-=1;var b=1.70158;return a*a*((b+1)*a+b)+1},elastic:function(a){return a==!!a?a:K(2,-10*a)*G.sin((a-.075)*2*L/.3)+1},bounce:function(a){var b=7.5625,c=2.75,d;return a<1/c?d=b*a*a:a<2/c?(a-=1.5/c,d=b*a*a+.75):a<2.5/c?(a-=2.25/c,d=b*a*a+.9375):(a-=2.625/c,d=b*a*a+.984375),d}};nc.easeIn=nc["ease-in"]=nc["<"],nc.easeOut=nc["ease-out"]=nc[">"],nc.easeInOut=nc["ease-in-out"]=nc["<>"],nc["back-in"]=nc.backIn,nc["back-out"]=nc.backOut;var oc=[],pc=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,16)},qc=function(){var b=+(new Date),c=0;for(;c<oc.length;c++){var d=oc[c];if(d.el.removed||d.paused)continue;var e=b-d.start,f=d.ms,g=d.easing,h=d.from,i=d.diff,j=d.to,l=d.t,m=d.el,n={},o,p={},r;d.initstatus?(e=(d.initstatus*d.anim.top-d.prev)/(d.percent-d.prev)*f,d.status=d.initstatus,delete d.initstatus,d.stop&&oc.splice(c--,1)):d.status=(d.prev+(d.percent-d.prev)*(e/f))/d.anim.top;if(e<0)continue;if(e<f){var s=g(e/f);for(var t in h)if(h[q](t)){switch(cb[t]){case M:o=+h[t]+s*f*i[t];break;case"colour":o="rgb("+[rc(Y(h[t].r+s*f*i[t].r)),rc(Y(h[t].g+s*f*i[t].g)),rc(Y(h[t].b+s*f*i[t].b))].join(",")+")";break;case"path":o=[];for(var u=0,v=h[t].length;u<v;u++){o[u]=[h[t][u][0]];for(var w=1,y=h[t][u].length;w<y;w++)o[u][w]=+h[t][u][w]+s*f*i[t][u][w];o[u]=o[u].join(A)}o=o.join(A);break;case"transform":if(i[t].real){o=[];for(u=0,v=h[t].length;u<v;u++){o[u]=[h[t][u][0]];for(w=1,y=h[t][u].length;w<y;w++)o[u][w]=h[t][u][w]+s*f*i[t][u][w]}}else{var z=function(a){return+h[t][a]+s*f*i[t][a]};o=[["m",z(0),z(1),z(2),z(3),z(4),z(5)]]}break;case"csv":if(t=="clip-rect"){o=[],u=4;while(u--)o[u]=+h[t][u]+s*f*i[t][u]}break;default:var B=[][x](h[t]);o=[],u=m.paper.customAttributes[t].length;while(u--)o[u]=+B[u]+s*f*i[t][u]}n[t]=o}m.attr(n),function(a,b,c){setTimeout(function(){eve("anim.frame."+a,b,c)})}(m.id,m,d.anim)}else{(function(a,b,c){setTimeout(function(){eve("anim.frame."+b.id,b,c),eve("anim.finish."+b.id,b,c),k.is(a,"function")&&a.call(b)})})(d.callback,m,d.anim),m.attr(j),oc.splice(c--,1);if(d.repeat>1&&!d.next){for(r in j)j[q](r)&&(p[r]=d.totalOrigin[r]);d.el.attr(p),a(d.anim,d.el,d.anim.percents[0],null,d.totalOrigin,d.repeat-1)}d.next&&!d.stop&&a(d.anim,d.el,d.next,null,d.totalOrigin,d.repeat)}}k.svg&&m&&m.paper&&m.paper.safari(),oc.length&&pc(qc)},rc=function(a){return a>255?255:a<0?0:a};dc.animateWith=function(a,b,c,d,e,f){var g=c?k.animation(c,d,e,f):b,h=a.status(b);return this.animate(g).status(g,h*b.ms/g.ms)},dc.onAnimation=function(a){return a?eve.on("anim.frame."+this.id,a):eve.unbind("anim.frame."+this.id),this},b.prototype.delay=function(a){var c=new b(this.anim,this.ms);return c.times=this.times,c.del=+a||0,c},b.prototype.repeat=function(a){var c=new b(this.anim,this.ms);return c.del=this.del,c.times=G.floor(H(a,0))||1,c},k.animation=function(a,c,d,e){if(a instanceof b)return a;if(k.is(d,"function")||!d)e=e||d||null,d=null;a=Object(a),c=+c||0;var f={},g,h;for(h in a)a[q](h)&&$(h)!=h&&$(h)+"%"!=h&&(g=!0,f[h]=a[h]);return g?(d&&(f.easing=d),e&&(f.callback=e),new b({100:f},c)):new b(a,c)},dc.animate=function(c,d,e,f){var g=this;if(g.removed)return f&&f.call(g),g;var h=c instanceof b?c:k.animation(c,d,e,f);return a(h,g,h.percents[0],null,g.attr()),g},dc.setTime=function(a,b){return a&&b!=null&&this.status(a,I(b,a.ms)/a.ms),this},dc.status=function(b,c){var d=[],e=0,f,g;if(c!=null)return a(b,this,-1,I(c,1)),this;f=oc.length;for(;e<f;e++){g=oc[e];if(g.el.id==this.id&&(!b||g.anim==b)){if(b)return g.status;d.push({anim:g.anim,status:g.status})}}return b?0:d},dc.pause=function(a){for(var b=0;b<oc.length;b++)oc[b].el.id==this.id&&(!a||oc[b].anim==a)&&eve("anim.pause."+this.id,this,oc[b].anim)!==!1&&(oc[b].paused=!0);return this},dc.resume=function(a){for(var b=0;b<oc.length;b++)if(oc[b].el.id==this.id&&(!a||oc[b].anim==a)){var c=oc[b];eve("anim.resume."+this.id,this,c.anim)!==!1&&(delete c.paused,this.status(c.anim,c.status))}return this},dc.stop=function(a){for(var b=0;b<oc.length;b++)oc[b].el.id==this.id&&(!a||oc[b].anim==a)&&eve("anim.stop."+this.id,this,oc[b].anim)!==!1&&oc.splice(b--,1);return this},dc.toString=function(){return"Raphaël’s object"};var sc=function(a){this.items=[],this.length=0,this.type="set";if(a)for(var b=0,c=a.length;b<c;b++)a[b]&&(a[b].constructor==dc.constructor||a[b].constructor==sc)&&(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)},tc=sc.prototype;tc.push=function(){var a,b;for(var c=0,d=arguments.length;c<d;c++)a=arguments[c],a&&(a.constructor==dc.constructor||a.constructor==sc)&&(b=this.items.length,this[b]=this.items[b]=a,this.length++);return this},tc.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},tc.forEach=function(a,b){for(var c=0,d=this.items.length;c<d;c++)if(a.call(b,this.items[c],c)===!1)return this;return this};for(var uc in dc)dc[q](uc)&&(tc[uc]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a][w](c,b)})}}(uc));tc.attr=function(a,b){if(a&&k.is(a,O)&&k.is(a[0],"object"))for(var c=0,d=a.length;c<d;c++)this.items[c].attr(a[c]);else for(var e=0,f=this.items.length;e<f;e++)this.items[e].attr(a,b);return this},tc.clear=function(){while(this.length)this.pop()},tc.splice=function(a,b,c){a=a<0?H(this.length+a,0):a,b=H(0,I(this.length-a,b));var d=[],e=[],f=[],g;for(g=2;g<arguments.length;g++)f.push(arguments[g]);for(g=0;g<b;g++)e.push(this[a+g]);for(;g<this.length-a;g++)d.push(this[a+g]);var h=f.length;for(g=0;g<h+d.length;g++)this.items[a+g]=this[a+g]=g<h?f[g]:d[g-h];g=this.items.length=this.length-=b-h;while(this[g])delete this[g++];return new sc(e)},tc.exclude=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]==a)return this.splice(b,1),!0},tc.animate=function(a,b,c,d){(k.is(c,"function")||!c)&&(d=c||null);var e=this.items.length,f=e,g,h=this,i;if(!e)return this;d&&(i=function(){!--e&&d.call(h)}),c=k.is(c,N)?c:i;var j=k.animation(a,b,c,i);g=this.items[--f].animate(j);while(f--)this.items[f]&&!this.items[f].removed&&this.items[f].animateWith(g,j);return this},tc.insertAfter=function(a){var b=this.items.length;while(b--)this.items[b].insertAfter(a);return this},tc.getBBox=function(){var a=[],b=[],c=[],d=[];for(var e=this.items.length;e--;)if(!this.items[e].removed){var f=this.items[e].getBBox();a.push(f.x),b.push(f.y),c.push(f.x+f.width),d.push(f.y+f.height)}return a=I[w](0,a),b=I[w](0,b),{x:a,y:b,width:H[w](0,c)-a,height:H[w](0,d)-b}},tc.clone=function(a){a=new sc;for(var b=0,c=this.items.length;b<c;b++)a.push(this.items[b].clone());return a},tc.toString=function(){return"Raphaël‘s set"},k.registerFont=function(a){if(!a.face)return a;this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face["font-family"];for(var d in a.face)a.face[q](d)&&(b.face[d]=a.face[d]);this.fonts[c]?this.fonts[c].push(b):this.fonts[c]=[b];if(!a.svg){b.face["units-per-em"]=_(a.face["units-per-em"],10);for(var e in a.glyphs)if(a.glyphs[q](e)){var f=a.glyphs[e];b.glyphs[e]={w:f.w,k:{},d:f.d&&"M"+f.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"};if(f.k)for(var g in f.k)f[q](g)&&(b.glyphs[e].k[g]=f.k[g])}}return a},u.getFont=function(a,b,c,d){d=d||"normal",c=c||"normal",b=+b||{normal:400,bold:700,lighter:300,bolder:800}[b]||400;if(!!k.fonts){var e=k.fonts[a];if(!e){var f=new RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,z)+"(\\s|$)","i");for(var g in k.fonts)if(k.fonts[q](g)&&f.test(g)){e=k.fonts[g];break}}var h;if(e)for(var i=0,j=e.length;i<j;i++){h=e[i];if(h.face["font-weight"]==b&&(h.face["font-style"]==c||!h.face["font-style"])&&h.face["font-stretch"]==d)break}return h}},u.print=function(a,b,c,d,e,f,g){f=f||"middle",g=H(I(g||0,1),-1);var h=this.set(),i=B(c)[C](z),j=0,l=z,n;k.is(d,c)&&(d=this.getFont(d));if(d){n=(e||16)/d.face["units-per-em"];var o=d.face.bbox[C](m),p=+o[0],q=+o[1]+(f=="baseline"?o[3]-o[1]+ +d.face.descent:(o[3]-o[1])/2);for(var r=0,s=i.length;r<s;r++){var t=r&&d.glyphs[i[r-1]]||{},u=d.glyphs[i[r]];j+=r?(t.w||d.w)+(t.k&&t.k[i[r]]||0)+d.w*g:0,u&&u.d&&h.push(this.path(u.d).attr({fill:"#000",stroke:"none",transform:[["t",j*n,0]]}))}h.transform(["...s",n,n,p,q,"t",(a-p)/n,(b-q)/n])}return h},u.add=function(a){if(k.is(a,"array")){var b=this.set(),c=0,d=a.length,e;for(;c<d;c++)e=a[c]||{},n[q](e.type)&&b.push(this[e.type]().attr(e))}return b},k.format=function(a,b){var c=k.is(b,O)?[0][x](b):arguments;return a&&k.is(a,N)&&c.length-1&&(a=a.replace(o,function(a,b){return c[++b]==null?z:c[b]})),a||z},k.fullfill=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),typeof e=="function"&&f&&(e=e()))}),e=(e==null||e==d?a:e)+"",e};return function(b,d){return String(b).replace(a,function(a,b){return c(a,b,d)})}}(),k.ninja=function(){return s.was?r.win.Raphael=s.is:delete Raphael,k},k.st=tc,function(a,b,c){function d(){/in/.test(a.readyState)?setTimeout(d,9):k.eve("DOMload")}a.readyState==null&&a.addEventListener&&(a.addEventListener(b,c=function(){a.removeEventListener(b,c,!1),a.readyState="complete"},!1),a.readyState="loading"),d()}(document,"DOMContentLoaded"),s.was?r.win.Raphael=k:Raphael=k,eve.on("DOMload",function(){l=!0})}(),window.Raphael.svg&&function(a){var b="hasOwnProperty",c=String,d=parseFloat,e=parseInt,f=Math,g=f.max,h=f.abs,i=f.pow,j=/[, ]+/,k=a.eve,l="",m=" ",n="http://www.w3.org/1999/xlink",o={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},p={};a.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var q=function(d,e){if(e){typeof d=="string"&&(d=q(d));for(var f in e)e[b](f)&&(f.substring(0,6)=="xlink:"?d.setAttributeNS(n,f.substring(6),c(e[f])):d.setAttribute(f,c(e[f])))}else d=a._g.doc.createElementNS("http://www.w3.org/2000/svg",d),d.style&&(d.style.webkitTapHighlightColor="rgba(0,0,0,0)");return d},r=function(b,e){var j="linear",k=b.id+e,m=.5,n=.5,o=b.node,p=b.paper,r=o.style,s=a._g.doc.getElementById(k);if(!s){e=c(e).replace(a._radial_gradient,function(a,b,c){j="radial";if(b&&c){m=d(b),n=d(c);var e=(n>.5)*2-1;i(m-.5,2)+i(n-.5,2)>.25&&(n=f.sqrt(.25-i(m-.5,2))*e+.5)&&n!=.5&&(n=n.toFixed(5)-1e-5*e)}return l}),e=e.split(/\s*\-\s*/);if(j=="linear"){var t=e.shift();t=-d(t);if(isNaN(t))return null;var u=[0,0,f.cos(a.rad(t)),f.sin(a.rad(t))],v=1/(g(h(u[2]),h(u[3]))||1);u[2]*=v,u[3]*=v,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var w=a._parseDots(e);if(!w)return null;k=k.replace(/[\(\)\s,\xb0#]/g,"_"),b.gradient&&k!=b.gradient.id&&(p.defs.removeChild(b.gradient),delete b.gradient);if(!b.gradient){s=q(j+"Gradient",{id:k}),b.gradient=s,q(s,j=="radial"?{fx:m,fy:n}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:b.matrix.invert()}),p.defs.appendChild(s);for(var x=0,y=w.length;x<y;x++)s.appendChild(q("stop",{offset:w[x].offset?w[x].offset:x?"100%":"0%","stop-color":w[x].color||"#fff"}))}}return q(o,{fill:"url(#"+k+")",opacity:1,"fill-opacity":1}),r.fill=l,r.opacity=1,r.fillOpacity=1,1},s=function(a){var b=a.getBBox(1);q(a.pattern,{patternTransform:a.matrix.invert()+" translate("+b.x+","+b.y+")"})},t=function(d,e,f){if(d.type=="path"){var g=c(e).toLowerCase().split("-"),h=d.paper,i=f?"end":"start",j=d.node,k=d.attrs,l=k["stroke-width"],n=g.length,r="classic",s,t,u,v,w,x=3,y=3,z=5;while(n--)switch(g[n]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":r=g[n];break;case"wide":y=5;break;case"narrow":y=2;break;case"long":x=5;break;case"short":x=2}r=="open"?(x+=2,y+=2,z+=2,u=1,v=f?4:1,w={fill:"none",stroke:k.stroke}):(v=u=x/2,w={fill:k.stroke,stroke:"none"}),d._.arrows?f?(d._.arrows.endPath&&p[d._.arrows.endPath]--,d._.arrows.endMarker&&p[d._.arrows.endMarker]--):(d._.arrows.startPath&&p[d._.arrows.startPath]--,d._.arrows.startMarker&&p[d._.arrows.startMarker]--):d._.arrows={};if(r!="none"){var A="raphael-marker-"+r,B="raphael-marker-"+i+r+x+y;a._g.doc.getElementById(A)?p[A]++:(h.defs.appendChild(q(q("path"),{"stroke-linecap":"round",d:o[r],id:A})),p[A]=1);var C=a._g.doc.getElementById(B),D;C?(p[B]++,D=C.getElementsByTagName("use")[0]):(C=q(q("marker"),{id:B,markerHeight:y,markerWidth:x,orient:"auto",refX:v,refY:y/2}),D=q(q("use"),{"xlink:href":"#"+A,transform:(f?" rotate(180 "+x/2+" "+y/2+") ":m)+"scale("+x/z+","+y/z+")","stroke-width":1/((x/z+y/z)/2)}),C.appendChild(D),h.defs.appendChild(C),p[B]=1),q(D,w);var E=u*(r!="diamond"&&r!="oval");f?(s=d._.arrows.startdx*l||0,t=a.getTotalLength(k.path)-E*l):(s=E*l,t=a.getTotalLength(k.path)-(d._.arrows.enddx*l||0)),w={},w["marker-"+i]="url(#"+B+")";if(t||s)w.d=Raphael.getSubpath(k.path,s,t);q(j,w),d._.arrows[i+"Path"]=A,d._.arrows[i+"Marker"]=B,d._.arrows[i+"dx"]=E,d._.arrows[i+"Type"]=r,d._.arrows[i+"String"]=e}else f?(s=d._.arrows.startdx*l||0,t=a.getTotalLength(k.path)-s):(s=0,t=a.getTotalLength(k.path)-(d._.arrows.enddx*l||0)),d._.arrows[i+"Path"]&&q(j,{d:Raphael.getSubpath(k.path,s,t)}),delete d._.arrows[i+"Path"],delete d._.arrows[i+"Marker"],delete d._.arrows[i+"dx"],delete d._.arrows[i+"Type"],delete d._.arrows[i+"String"];for(w in p)if(p[b](w)&&!p[w]){var F=a._g.doc.getElementById(w);F&&F.parentNode.removeChild(F)}}},u={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},v=function(a,b,d){b=u[c(b).toLowerCase()];if(b){var e=a.attrs["stroke-width"]||"1",f={round:e,square:e,butt:0}[a.attrs["stroke-linecap"]||d["stroke-linecap"]]||0,g=[],h=b.length;while(h--)g[h]=b[h]*e+(h%2?1:-1)*f;q(a.node,{"stroke-dasharray":g.join(",")})}},w=function(d,f){var i=d.node,k=d.attrs,m=i.style.visibility;i.style.visibility="hidden";for(var o in f)if(f[b](o)){if(!a._availableAttrs[b](o))continue;var p=f[o];k[o]=p;switch(o){case"blur":d.blur(p);break;case"href":case"title":case"target":var u=i.parentNode;if(u.tagName.toLowerCase()!="a"){var w=q("a");u.insertBefore(w,i),w.appendChild(i),u=w}o=="target"&&p=="blank"?u.setAttributeNS(n,"show","new"):u.setAttributeNS(n,o,p);break;case"cursor":i.style.cursor=p;break;case"transform":d.transform(p);break;case"arrow-start":t(d,p);break;case"arrow-end":t(d,p,1);break;case"clip-rect":var x=c(p).split(j);if(x.length==4){d.clip&&d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);var z=q("clipPath"),A=q("rect");z.id=a.createUUID(),q(A,{x:x[0],y:x[1],width:x[2],height:x[3]}),z.appendChild(A),d.paper.defs.appendChild(z),q(i,{"clip-path":"url(#"+z.id+")"}),d.clip=A}if(!p){var B=i.getAttribute("clip-path");if(B){var C=a._g.doc.getElementById(B.replace(/(^url\(#|\)$)/g,l));C&&C.parentNode.removeChild(C),q(i,{"clip-path":l}),delete d.clip}}break;case"path":d.type=="path"&&(q(i,{d:p?k.path=a._pathToAbsolute(p):"M0,0"}),d._.dirty=1,d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1)));break;case"width":i.setAttribute(o,p),d._.dirty=1;if(!k.fx)break;o="x",p=k.x;case"x":k.fx&&(p=-k.x-(k.width||0));case"rx":if(o=="rx"&&d.type=="rect")break;case"cx":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"height":i.setAttribute(o,p),d._.dirty=1;if(!k.fy)break;o="y",p=k.y;case"y":k.fy&&(p=-k.y-(k.height||0));case"ry":if(o=="ry"&&d.type=="rect")break;case"cy":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"r":d.type=="rect"?q(i,{rx:p,ry:p}):i.setAttribute(o,p),d._.dirty=1;break;case"src":d.type=="image"&&i.setAttributeNS(n,"href",p);break;case"stroke-width":if(d._.sx!=1||d._.sy!=1)p/=g(h(d._.sx),h(d._.sy))||1;d.paper._vbSize&&(p*=d.paper._vbSize),i.setAttribute(o,p),k["stroke-dasharray"]&&v(d,k["stroke-dasharray"],f),d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"stroke-dasharray":v(d,p,f);break;case"fill":var D=c(p).match(a._ISURL);if(D){z=q("pattern");var E=q("image");z.id=a.createUUID(),q(z,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),q(E,{x:0,y:0,"xlink:href":D[1]}),z.appendChild(E),function(b){a._preload(D[1],function(){var a=this.offsetWidth,c=this.offsetHeight;q(b,{width:a,height:c}),q(E,{width:a,height:c}),d.paper.safari()})}(z),d.paper.defs.appendChild(z),i.style.fill="url(#"+z.id+")",q(i,{fill:"url(#"+z.id+")"}),d.pattern=z,d.pattern&&s(d);break}var F=a.getRGB(p);if(!F.error)delete f.gradient,delete k.gradient,!a.is(k.opacity,"undefined")&&a.is(f.opacity,"undefined")&&q(i,{opacity:k.opacity}),!a.is(k["fill-opacity"],"undefined")&&a.is(f["fill-opacity"],"undefined")&&q(i,{"fill-opacity":k["fill-opacity"]});else if((d.type=="circle"||d.type=="ellipse"||c(p).charAt()!="r")&&r(d,p)){if("opacity"in k||"fill-opacity"in k){var G=a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l));if(G){var H=G.getElementsByTagName("stop");q(H[H.length-1],{"stop-opacity":("opacity"in k?k.opacity:1)*("fill-opacity"in k?k["fill-opacity"]:1)})}}k.gradient=p,k.fill="none";break}F[b]("opacity")&&q(i,{"fill-opacity":F.opacity>1?F.opacity/100:F.opacity});case"stroke":F=a.getRGB(p),i.setAttribute(o,F.hex),o=="stroke"&&F[b]("opacity")&&q(i,{"stroke-opacity":F.opacity>1?F.opacity/100:F.opacity}),o=="stroke"&&d._.arrows&&("startString"in d._.arrows&&t(d,d._.arrows.startString),"endString"in d._.arrows&&t(d,d._.arrows.endString,1));break;case"gradient":(d.type=="circle"||d.type=="ellipse"||c(p).charAt()!="r")&&r(d,p);break;case"opacity":k.gradient&&!k[b]("stroke-opacity")&&q(i,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(k.gradient){G=a._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l)),G&&(H=G.getElementsByTagName("stop"),q(H[H.length-1],{"stop-opacity":p}));break};default:o=="font-size"&&(p=e(p,10)+"px");var I=o.replace(/(\-.)/g,function(a){return a.substring(1).toUpperCase()});i.style[I]=p,d._.dirty=1,i.setAttribute(o,p)}}y(d,f),i.style.visibility=m},x=1.2,y=function(d,f){if(d.type=="text"&&!!(f[b]("text")||f[b]("font")||f[b]("font-size")||f[b]("x")||f[b]("y"))){var g=d.attrs,h=d.node,i=h.firstChild?e(a._g.doc.defaultView.getComputedStyle(h.firstChild,l).getPropertyValue("font-size"),10):10;if(f[b]("text")){g.text=f.text;while(h.firstChild)h.removeChild(h.firstChild);var j=c(f.text).split("\n"),k=[],m;for(var n=0,o=j.length;n<o;n++)m=q("tspan"),n&&q(m,{dy:i*x,x:g.x}),m.appendChild(a._g.doc.createTextNode(j[n])),h.appendChild(m),k[n]=m}else{k=h.getElementsByTagName("tspan");for(n=0,o=k.length;n<o;n++)n?q(k[n],{dy:i*x,x:g.x}):q(k[0],{dy:0})}q(h,{x:g.x,y:g.y}),d._.dirty=1;var p=d._getBBox(),r=g.y-(p.y+p.height/2);r&&a.is(r,"finite")&&q(k[0],{dy:r})}},z=function(b,c){var d=0,e=0;this[0]=this.node=b,b.raphael=!0,this.id=a._oid++,b.raphaelid=this.id,this.matrix=a.matrix(),this.realPath=null,this.paper=c,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},A=a.el;z.prototype=A,A.constructor=z,a._engine.path=function(a,b){var c=q("path");b.canvas&&b.canvas.appendChild(c);var d=new z(c,b);return d.type="path",w(d,{fill:"none",stroke:"#000",path:a}),d},A.rotate=function(a,b,e){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1]),e=d(a[2])),a=d(a[0]),e==null&&(b=e);if(b==null||e==null){var f=this.getBBox(1);b=f.x+f.width/2,e=f.y+f.height/2}return this.transform(this._.transform.concat([["r",a,b,e]])),this},A.scale=function(a,b,e,f){if(this.removed)return this;a=c(a).split(j),a.length-1&&(b=d(a[1]),e=d(a[2]),f=d(a[3])),a=d(a[0]),b==null&&(b=a),f==null&&(e=f);if(e==null||f==null)var g=this.getBBox(1);return e=e==null?g.x+g.width/2:e,f=f==null?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,b,e,f]])),this},A.translate=function(a,b){return this.removed?this:(a=c(a).split(j),a.length-1&&(b=d(a[1])),a=d(a[0])||0,b=+b||0,this.transform(this._.transform.concat([["t",a,b]])),this)},A.transform=function(c){var d=this._;if(c==null)return d.transform;a._extractTransform(this,c),this.clip&&q(this.clip,{transform:this.matrix.invert()}),this.pattern&&s(this),this.node&&q(this.node,{transform:this.matrix});if(d.sx!=1||d.sy!=1){var e=this.attrs[b]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":e})}return this},A.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},A.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},A.remove=function(){if(!this.removed){var b=this.paper;b.__set__&&b.__set__.exclude(this),k.unbind("*.*."+this.id),this.gradient&&b.defs.removeChild(this.gradient),a._tear(this,b),this.node.parentNode.removeChild(this.node);for(var c in this)this[c]=typeof this[c]=="function"?a._removedFactory(c):null;this.removed=!0}},A._getBBox=function(){if(this.node.style.display=="none"){this.show();var a=!0}var b={};try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}return a&&this.hide(),b},A.attr=function(c,d){if(this.removed)return this;if(c==null){var e={};for(var f in this.attrs)this.attrs[b](f)&&(e[f]=this.attrs[f]);return e.gradient&&e.fill=="none"&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(d==null&&a.is(c,"string")){if(c=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(c=="transform")return this._.transform;var g=c.split(j),h={};for(var i=0,l=g.length;i<l;i++)c=g[i],c in this.attrs?h[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?h[c]=this.paper.customAttributes[c].def:h[c]=a._availableAttrs[c];return l-1?h:h[g[0]]}if(d==null&&a.is(c,"array")){h={};for(i=0,l=c.length;i<l;i++)h[c[i]]=this.attr(c[i]);return h}if(d!=null){var m={};m[c]=d}else c!=null&&a.is(c,"object")&&(m=c);for(var n in m)k("attr."+n+"."+this.id,this,m[n]);for(n in this.paper.customAttributes)if(this.paper.customAttributes[b](n)&&m[b](n)&&a.is(this.paper.customAttributes[n],"function")){var o=this.paper.customAttributes[n].apply(this,[].concat(m[n]));this.attrs[n]=m[n];for(var p in o)o[b](p)&&(m[p]=o[p])}return w(this,m),this},A.toFront=function(){if(this.removed)return this;this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var b=this.paper;return b.top!=this&&a._tofront(this,b),this},A.toBack=function(){if(this.removed)return this;var b=this.node.parentNode;b.tagName.toLowerCase()=="a"?b.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):b.firstChild!=this.node&&b.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper);var c=this.paper;return this},A.insertAfter=function(b){if(this.removed)return this;var c=b.node||b[b.length-1].node;return c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode.appendChild(this.node),a._insertafter(this,b,this.paper),this},A.insertBefore=function(b){if(this.removed)return this;var c=b.node||b[0].node;return c.parentNode.insertBefore(this.node,c),a._insertbefore(this,b,this.paper),this},A.blur=function(b){var c=this;if(+b!==0){var d=q("filter"),e=q("feGaussianBlur");c.attrs.blur=b,d.id=a.createUUID(),q(e,{stdDeviation:+b||1.5}),d.appendChild(e),c.paper.defs.appendChild(d),c._blur=d,q(c.node,{filter:"url(#"+d.id+")"})}else c._blur&&(c._blur.parentNode.removeChild(c._blur),delete c._blur,delete c.attrs.blur),c.node.removeAttribute("filter")},a._engine.circle=function(a,b,c,d){var e=q("circle");a.canvas&&a.canvas.appendChild(e);var f=new z(e,a);return f.attrs={cx:b,cy:c,r:d,fill:"none",stroke:"#000"},f.type="circle",q(e,f.attrs),f},a._engine.rect=function(a,b,c,d,e,f){var g=q("rect");a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:b,y:c,width:d,height:e,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"},h.type="rect",q(g,h.attrs),h},a._engine.ellipse=function(a,b,c,d,e){var f=q("ellipse");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);return g.attrs={cx:b,cy:c,rx:d,ry:e,fill:"none",stroke:"#000"},g.type="ellipse",q(f,g.attrs),g},a._engine.image=function(a,b,c,d,e,f){var g=q("image");q(g,{x:c,y:d,width:e,height:f,preserveAspectRatio:"none"}),g.setAttributeNS(n,"href",b),a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:c,y:d,width:e,height:f,src:b},h.type="image",h},a._engine.text=function(b,c,d,e){var f=q("text");b.canvas&&b.canvas.appendChild(f);var g=new z(f,b);return g.attrs={x:c,y:d,"text-anchor":"middle",text:e,font:a._availableAttrs.font,stroke:"none",fill:"#000"},g.type="text",w(g,g.attrs),g},a._engine.setSize=function(a,b){return this.width=a||this.width,this.height=b||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b&&b.container,d=b.x,e=b.y,f=b.width,g=b.height;if(!c)throw new Error("SVG container not found.");var h=q("svg"),i="overflow:hidden;",j;return d=d||0,e=e||0,f=f||512,g=g||342,q(h,{height:g,version:1.1,width:f,xmlns:"http://www.w3.org/2000/svg"}),c==1?(h.style.cssText=i+"position:absolute;left:"+d+"px;top:"+e+"px",a._g.doc.body.appendChild(h),j=1):(h.style.cssText=i+"position:relative",c.firstChild?c.insertBefore(h,c.firstChild):c.appendChild(h)),c=new a._Paper,c.width=f,c.height=g,c.canvas=h,c.clear(),c._left=c._top=0,j&&(c.renderfix=function(){}),c.renderfix(),c},a._engine.setViewBox=function(a,b,c,d,e){k("setViewBox",this,this._viewBox,[a,b,c,d,e]);var f=g(c/this.width,d/this.height),h=this.top,i=e?"meet":"xMinYMin",j,l;a==null?(this._vbSize&&(f=1),delete this._vbSize,j="0 0 "+this.width+m+this.height):(this._vbSize=f,j=a+m+b+m+c+m+d),q(this.canvas,{viewBox:j,preserveAspectRatio:i});while(f&&h)l="stroke-width"in h.attrs?h.attrs["stroke-width"]:1,h.attr({"stroke-width":l}),h._.dirty=1,h._.dirtyT=1,h=h.prev;return this._viewBox=[a,b,c,d,!!e],this},a.prototype.renderfix=function(){var a=this.canvas,b=a.style,c=a.getScreenCTM()||a.createSVGMatrix(),d=-c.e%1,e=-c.f%1;if(d||e)d&&(this._left=(this._left+d)%1,b.left=this._left+"px"),e&&(this._top=(this._top+e)%1,b.top=this._top+"px")},a.prototype.clear=function(){a.eve("clear",this);var b=this.canvas;while(b.firstChild)b.removeChild(b.firstChild);this.bottom=this.top=null,(this.desc=q("desc")).appendChild(a._g.doc.createTextNode("Created with Raphaël "+a.version)),b.appendChild(this.desc),b.appendChild(this.defs=q("defs"))},a.prototype.remove=function(){k("remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null};var B=a.st;for(var C in A)A[b](C)&&!B[b](C)&&(B[C]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(C))}(window.Raphael),window.Raphael.vml&&function(a){var b="hasOwnProperty",c=String,d=parseFloat,e=Math,f=e.round,g=e.max,h=e.min,i=e.abs,j="fill",k=/[, ]+/,l=a.eve,m=" progid:DXImageTransform.Microsoft",n=" ",o="",p={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},q=/([clmz]),?([^clmz]*)/gi,r=/ progid:\S+Blur\([^\)]+\)/g,s=/-?[^,\s-]+/g,t="position:absolute;left:0;top:0;width:1px;height:1px",u=21600,v={path:1,rect:1,image:1},w={circle:1,ellipse:1},x=function(b){var d=/[ahqstv]/ig,e=a._pathToAbsolute;c(b).match(d)&&(e=a._path2curve),d=/[clmz]/g;if(e==a._pathToAbsolute&&!c(b).match(d)){var g=c(b).replace(q,function(a,b,c){var d=[],e=b.toLowerCase()=="m",g=p[b];return c.replace(s,function(a){e&&d.length==2&&(g+=d+p[b=="m"?"l":"L"],d=[]),d.push(f(a*u))}),g+d});return g}var h=e(b),i,j;g=[];for(var k=0,l=h.length;k<l;k++){i=h[k],j=h[k][0].toLowerCase(),j=="z"&&(j="x");for(var m=1,r=i.length;m<r;m++)j+=f(i[m]*u)+(m!=r-1?",":o);g.push(j)}return g.join(n)},y=function(b,c,d){var e=a.matrix();return e.rotate(-b,.5,.5),{dx:e.x(c,d),dy:e.y(c,d)}},z=function(a,b,c,d,e,f){var g=a._,h=a.matrix,k=g.fillpos,l=a.node,m=l.style,o=1,p="",q,r=u/b,s=u/c;m.visibility="hidden";if(!!b&&!!c){l.coordsize=i(r)+n+i(s),m.rotation=f*(b*c<0?-1:1);if(f){var t=y(f,d,e);d=t.dx,e=t.dy}b<0&&(p+="x"),c<0&&(p+=" y")&&(o=-1),m.flip=p,l.coordorigin=d*-r+n+e*-s;if(k||g.fillsize){var v=l.getElementsByTagName(j);v=v&&v[0],l.removeChild(v),k&&(t=y(f,h.x(k[0],k[1]),h.y(k[0],k[1])),v.position=t.dx*o+n+t.dy*o),g.fillsize&&(v.size=g.fillsize[0]*i(b)+n+g.fillsize[1]*i(c)),l.appendChild(v)}m.visibility="visible"}};a.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var A=function(a,b,d){var e=c(b).toLowerCase().split("-"),f=d?"end":"start",g=e.length,h="classic",i="medium",j="medium";while(g--)switch(e[g]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":h=e[g];break;case"wide":case"narrow":j=e[g];break;case"long":case"short":i=e[g]}var k=a.node.getElementsByTagName("stroke")[0];k[f+"arrow"]=h,k[f+"arrowlength"]=i,k[f+"arrowwidth"]=j},B=function(e,i){e.attrs=e.attrs||{};var l=e.node,m=e.attrs,p=l.style,q,r=v[e.type]&&(i.x!=m.x||i.y!=m.y||i.width!=m.width||i.height!=m.height||i.cx!=m.cx||i.cy!=m.cy||i.rx!=m.rx||i.ry!=m.ry||i.r!=m.r),s=w[e.type]&&(m.cx!=i.cx||m.cy!=i.cy||m.r!=i.r||m.rx!=i.rx||m.ry!=i.ry),t=e;for(var y in i)i[b](y)&&(m[y]=i[y]);r&&(m.path=a._getPath[e.type](e),e._.dirty=1),i.href&&(l.href=i.href),i.title&&(l.title=i.title),i.target&&(l.target=i.target),i.cursor&&(p.cursor=i.cursor),"blur"in i&&e.blur(i.blur);if(i.path&&e.type=="path"||r)l.path=x(~c(m.path).toLowerCase().indexOf("r")?a._pathToAbsolute(m.path):m.path),e.type=="image"&&(e._.fillpos=[m.x,m.y],e._.fillsize=[m.width,m.height],z(e,1,1,0,0,0));"transform"in i&&e.transform(i.transform);if(s){var B=+m.cx,D=+m.cy,E=+m.rx||+m.r||0,G=+m.ry||+m.r||0;l.path=a.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",f((B-E)*u),f((D-G)*u),f((B+E)*u),f((D+G)*u),f(B*u))}if("clip-rect"in i){var H=c(i["clip-rect"]).split(k);if(H.length==4){H[2]=+H[2]+ +H[0],H[3]=+H[3]+ +H[1];var I=l.clipRect||a._g.doc.createElement("div"),J=I.style;J.clip=a.format("rect({1}px {2}px {3}px {0}px)",H),l.clipRect||(J.position="absolute",J.top=0,J.left=0,J.width=e.paper.width+"px",J.height=e.paper.height+"px",l.parentNode.insertBefore(I,l),I.appendChild(l),l.clipRect=I)}i["clip-rect"]||l.clipRect&&(l.clipRect.style.clip="auto")}if(e.textpath){var K=e.textpath.style;i.font&&(K.font=i.font),i["font-family"]&&(K.fontFamily='"'+i["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,o)+'"'),i["font-size"]&&(K.fontSize=i["font-size"]),i["font-weight"]&&(K.fontWeight=i["font-weight"]),i["font-style"]&&(K.fontStyle=i["font-style"])}"arrow-start"in i&&A(t,i["arrow-start"]),"arrow-end"in i&&A(t,i["arrow-end"],1);if(i.opacity!=null||i["stroke-width"]!=null||i.fill!=null||i.src!=null||i.stroke!=null||i["stroke-width"]!=null||i["stroke-opacity"]!=null||i["fill-opacity"]!=null||i["stroke-dasharray"]!=null||i["stroke-miterlimit"]!=null||i["stroke-linejoin"]!=null||i["stroke-linecap"]!=null){var L=l.getElementsByTagName(j),M=!1;L=L&&L[0],!L&&(M=L=F(j)),e.type=="image"&&i.src&&(L.src=i.src),i.fill&&(L.on=!0);if(L.on==null||i.fill=="none"||i.fill===null)L.on=!1;if(L.on&&i.fill){var N=c(i.fill).match(a._ISURL);if(N){L.parentNode==l&&l.removeChild(L),L.rotate=!0,L.src=N[1],L.type="tile";var O=e.getBBox(1);L.position=O.x+n+O.y,e._.fillpos=[O.x,O.y],a._preload(N[1],function(){e._.fillsize=[this.offsetWidth,this.offsetHeight]})}else L.color=a.getRGB(i.fill).hex,L.src=o,L.type="solid",a.getRGB(i.fill).error&&(t.type in{circle:1,ellipse:1}||c(i.fill).charAt()!="r")&&C(t,i.fill,L)&&(m.fill="none",m.gradient=i.fill,L.rotate=!1)}if("fill-opacity"in i||"opacity"in i){var P=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+a.getRGB(i.fill).o+1||2)-1);P=h(g(P,0),1),L.opacity=P,L.src&&(L.color="none")}l.appendChild(L);var Q=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0],R=!1;!Q&&(R=Q=F("stroke"));if(i.stroke&&i.stroke!="none"||i["stroke-width"]||i["stroke-opacity"]!=null||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])Q.on=!0;(i.stroke=="none"||i.stroke===null||Q.on==null||i.stroke==0||i["stroke-width"]==0)&&(Q.on=!1);var S=a.getRGB(i.stroke);Q.on&&i.stroke&&(Q.color=S.hex),P=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+S.o+1||2)-1);var T=(d(i["stroke-width"])||1)*.75;P=h(g(P,0),1),i["stroke-width"]==null&&(T=m["stroke-width"]),i["stroke-width"]&&(Q.weight=T),T&&T<1&&(P*=T)&&(Q.weight=1),Q.opacity=P,i["stroke-linejoin"]&&(Q.joinstyle=i["stroke-linejoin"]||"miter"),Q.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(Q.endcap=i["stroke-linecap"]=="butt"?"flat":i["stroke-linecap"]=="square"?"square":"round");if(i["stroke-dasharray"]){var U={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};Q.dashstyle=U[b](i["stroke-dasharray"])?U[i["stroke-dasharray"]]:o}R&&l.appendChild(Q)}if(t.type=="text"){t.paper.canvas.style.display=o;var V=t.paper.span,W=100,X=m.font&&m.font.match(/\d+(?:\.\d*)?(?=px)/);p=V.style,m.font&&(p.font=m.font),m["font-family"]&&(p.fontFamily=m["font-family"]),m["font-weight"]&&(p.fontWeight=m["font-weight"]),m["font-style"]&&(p.fontStyle=m["font-style"]),X=d(m["font-size"]||X&&X[0])||10,p.fontSize=X*W+"px",t.textpath.string&&(V.innerHTML=c(t.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var Y=V.getBoundingClientRect();t.W=m.w=(Y.right-Y.left)/W,t.H=m.h=(Y.bottom-Y.top)/W,t.X=m.x,t.Y=m.y+t.H/2,("x"in i||"y"in i)&&(t.path.v=a.format("m{0},{1}l{2},{1}",f(m.x*u),f(m.y*u),f(m.x*u)+1));var Z=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var $=0,_=Z.length;$<_;$++)if(Z[$]in i){t._.dirty=1;break}switch(m["text-anchor"]){case"start":t.textpath.style["v-text-align"]="left",t.bbx=t.W/2;break;case"end":t.textpath.style["v-text-align"]="right",t.bbx=-t.W/2;break;default:t.textpath.style["v-text-align"]="center",t.bbx=0}t.textpath.style["v-text-kern"]=!0}},C=function(b,f,g){b.attrs=b.attrs||{};var h=b.attrs,i=Math.pow,j,k,l="linear",m=".5 .5";b.attrs.gradient=f,f=c(f).replace(a._radial_gradient,function(a,b,c){return l="radial",b&&c&&(b=d(b),c=d(c),i(b-.5,2)+i(c-.5,2)>.25&&(c=e.sqrt(.25-i(b-.5,2))*((c>.5)*2-1)+.5),m=b+n+c),o}),f=f.split(/\s*\-\s*/);if(l=="linear"){var p=f.shift();p=-d(p);if(isNaN(p))return null}var q=a._parseDots(f);if(!q)return null;b=b.shape||b.node;if(q.length){b.removeChild(g),g.on=!0,g.method="none",g.color=q[0].color,g.color2=q[q.length-1].color;var r=[];for(var s=0,t=q.length;s<t;s++)q[s].offset&&r.push(q[s].offset+n+q[s].color);g.colors=r.length?r.join():"0% "+g.color,l=="radial"?(g.type="gradientTitle",g.focus="100%",g.focussize="0 0",g.focusposition=m,g.angle=0):(g.type="gradient",g.angle=(270-p)%360),b.appendChild(g)}return 1},D=function(b,c){this[0]=this.node=b,b.raphael=!0,this.id=a._oid++,b.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=c,this.matrix=a.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!c.bottom&&(c.bottom=this),this.prev=c.top,c.top&&(c.top.next=this),c.top=this,this.next=null},E=a.el;D.prototype=E,E.constructor=D,E.transform=function(b){if(b==null)return this._.transform;var d=this.paper._viewBoxShift,e=d?"s"+[d.scale,d.scale]+"-1-1t"+[d.dx,d.dy]:o,f;d&&(f=b=c(b).replace(/\.{3}|\u2026/g,this._.transform||o)),a._extractTransform(this,e+b);var g=this.matrix.clone(),h=this.skew,i=this.node,j,k=~c(this.attrs.fill).indexOf("-"),l=!c(this.attrs.fill).indexOf("url(");g.translate(-0.5,-0.5);if(l||k||this.type=="image"){h.matrix="1 0 0 1",h.offset="0 0",j=g.split();if(k&&j.noRotation||!j.isSimple){i.style.filter=g.toFilter();var m=this.getBBox(),p=this.getBBox(1),q=m.x-p.x,r=m.y-p.y;i.coordorigin=q*-u+n+r*-u,z(this,1,1,q,r,0)}else i.style.filter=o,z(this,j.scalex,j.scaley,j.dx,j.dy,j.rotate)}else i.style.filter=o,h.matrix=c(g),h.offset=g.offset();return f&&(this._.transform=f),this},E.rotate=function(a,b,e){if(this.removed)return this;if(a!=null){a=c(a).split(k),a.length-1&&(b=d(a[1]),e=d(a[2])),a=d(a[0]),e==null&&(b=e);if(b==null||e==null){var f=this.getBBox(1);b=f.x+f.width/2,e=f.y+f.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",a,b,e]])),this}},E.translate=function(a,b){return this.removed?this:(a=c(a).split(k),a.length-1&&(b=d(a[1])),a=d(a[0])||0,b=+b||0,this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=b),this.transform(this._.transform.concat([["t",a,b]])),this)},E.scale=function(a,b,e,f){if(this.removed)return this;a=c(a).split(k),a.length-1&&(b=d(a[1]),e=d(a[2]),f=d(a[3]),isNaN(e)&&(e=null),isNaN(f)&&(f=null)),a=d(a[0]),b==null&&(b=a),f==null&&(e=f);if(e==null||f==null)var g=this.getBBox(1);return e=e==null?g.x+g.width/2:e,f=f==null?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,b,e,f]])),this._.dirtyT=1,this},E.hide=function(){return!this.removed&&(this.node.style.display="none"),this},E.show=function(){return!this.removed&&(this.node.style.display=o),this},E._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},E.remove=function(){if(!this.removed){this.paper.__set__&&this.paper.__set__.exclude(this),a.eve.unbind("*.*."+this.id),a._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null;this.removed=!0}},E.attr=function(c,d){if(this.removed)return this;if(c==null){var e={};for(var f in this.attrs)this.attrs[b](f)&&(e[f]=this.attrs[f]);return e.gradient&&e.fill=="none"&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(d==null&&a.is(c,"string")){if(c==j&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;var g=c.split(k),h={};for(var i=0,m=g.length;i<m;i++)c=g[i],c in this.attrs?h[c]=this.attrs[c]:a.is(this.paper.customAttributes[c],"function")?h[c]=this.paper.customAttributes[c].def:h[c]=a._availableAttrs[c];return m-1?h:h[g[0]]}if(this.attrs&&d==null&&a.is(c,"array")){h={};for(i=0,m=c.length;i<m;i++)h[c[i]]=this.attr(c[i]);return h}var n;d!=null&&(n={},n[c]=d),d==null&&a.is(c,"object")&&(n=c);for(var o in n)l("attr."+o+"."+this.id,this,n[o]);if(n){for(o in this.paper.customAttributes)if(this.paper.customAttributes[b](o)&&n[b](o)&&a.is(this.paper.customAttributes[o],"function")){var p=this.paper.customAttributes[o].apply(this,[].concat(n[o]));this.attrs[o]=n[o];for(var q in p)p[b](q)&&(n[q]=p[q])}n.text&&this.type=="text"&&(this.textpath.string=n.text),B(this,n)}return this},E.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&a._tofront(this,this.paper),this},E.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),a._toback(this,this.paper)),this)},E.insertAfter=function(b){return this.removed?this:(b.constructor==a.st.constructor&&(b=b[b.length-1]),b.node.nextSibling?b.node.parentNode.insertBefore(this.node,b.node.nextSibling):b.node.parentNode.appendChild(this.node),a._insertafter(this,b,this.paper),this)},E.insertBefore=function(b){return this.removed?this:(b.constructor==a.st.constructor&&(b=b[0]),b.node.parentNode.insertBefore(this.node,b.node),a._insertbefore(this,b,this.paper),this)},E.blur=function(b){var c=this.node.runtimeStyle,d=c.filter;d=d.replace(r,o),+b!==0?(this.attrs.blur=b,c.filter=d+n+m+".Blur(pixelradius="+(+b||1.5)+")",c.margin=a.format("-{0}px 0 0 -{0}px",f(+b||1.5))):(c.filter=d,c.margin=0,delete this.attrs.blur)},a._engine.path=function(a,b){var c=F("shape");c.style.cssText=t,c.coordsize=u+n+u,c.coordorigin=b.coordorigin;var d=new D(c,b),e={fill:"none",stroke:"#000"};a&&(e.path=a),d.type="path",d.path=[],d.Path=o,B(d,e),b.canvas.appendChild(c);var f=F("skew");return f.on=!0,c.appendChild(f),d.skew=f,d.transform(o),d},a._engine.rect=function(b,c,d,e,f,g){var h=a._rectPath(c,d,e,f,g),i=b.path(h),j=i.attrs;return i.X=j.x=c,i.Y=j.y=d,i.W=j.width=e,i.H=j.height=f,j.r=g,j.path=h,i.type="rect",i},a._engine.ellipse=function(a,b,c,d,e){var f=a.path(),g=f.attrs;return f.X=b-d,f.Y=c-e,f.W=d*2,f.H=e*2,f.type="ellipse",B(f,{cx:b,cy:c,rx:d,ry:e}),f},a._engine.circle=function(a,b,c,d){var e=a.path(),f=e.attrs;return e.X=b-d,e.Y=c-d,e.W=e.H=d*2,e.type="circle",B(e,{cx:b,cy:c,r:d}),e},a._engine.image=function(b,c,d,e,f,g){var h=a._rectPath(d,e,f,g),i=b.path(h).attr({stroke:"none"}),k=i.attrs,l=i.node,m=l.getElementsByTagName(j)[0];return k.src=c,i.X=k.x=d,i.Y=k.y=e,i.W=k.width=f,i.H=k.height=g,k.path=h,i.type="image",m.parentNode==l&&l.removeChild(m),m.rotate=!0,m.src=c,m.type="tile",i._.fillpos=[d,e],i._.fillsize=[f,g],l.appendChild(m),z(i,1,1,0,0,0),i},a._engine.text=function(b,d,e,g){var h=F("shape"),i=F("path"),j=F("textpath");d=d||0,e=e||0,g=g||"",i.v=a.format("m{0},{1}l{2},{1}",f(d*u),f(e*u),f(d*u)+1),i.textpathok=!0,j.string=c(g),j.on=!0,h.style.cssText=t,h.coordsize=u+n+u,h.coordorigin="0 0";var k=new D(h,b),l={fill:"#000",stroke:"none",font:a._availableAttrs.font,text:g};k.shape=h,k.path=i,k.textpath=j,k.type="text",k.attrs.text=c(g),k.attrs.x=d,k.attrs.y=e,k.attrs.w=1,k.attrs.h=1,B(k,l),h.appendChild(j),h.appendChild(i),b.canvas.appendChild(h);var m=F("skew");return m.on=!0,h.appendChild(m),k.skew=m,k.transform(o),k},a._engine.setSize=function(b,c){var d=this.canvas.style;return this.width=b,this.height=c,b==+b&&(b+="px"),c==+c&&(c+="px"),d.width=b,d.height=c,d.clip="rect(0 "+b+" "+c+" 0)",this._viewBox&&a._engine.setViewBox.apply(this,this._viewBox),this},a._engine.setViewBox=function(b,c,d,e,f){a.eve("setViewBox",this,this._viewBox,[b,c,d,e,f]);var h=this.width,i=this.height,j=1/g(d/h,e/i),k,l;return f&&(k=i/e,l=h/d,d*k<h&&(b-=(h-d*k)/2/k),e*l<i&&(c-=(i-e*l)/2/l)),this._viewBox=[b,c,d,e,!!f],this._viewBoxShift={dx:-b,dy:-c,scale:j},this.forEach(function(a){a.transform("...")}),this};var F;a._engine.initWin=function(a){var b=a.document;b.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!b.namespaces.rvml&&b.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),F=function(a){return b.createElement("<rvml:"+a+' class="rvml">')}}catch(c){F=function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},a._engine.initWin(a._g.win),a._engine.create=function(){var b=a._getContainer.apply(0,arguments),c=b.container,d=b.height,e,f=b.width,g=b.x,h=b.y;if(!c)throw new Error("VML container not found.");var i=new a._Paper,j=i.canvas=a._g.doc.createElement("div"),k=j.style;return g=g||0,h=h||0,f=f||512,d=d||342,i.width=f,i.height=d,f==+f&&(f+="px"),d==+d&&(d+="px"),i.coordsize=u*1e3+n+u*1e3,i.coordorigin="0 0",i.span=a._g.doc.createElement("span"),i.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",j.appendChild(i.span),k.cssText=a.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",f,d),c==1?(a._g.doc.body.appendChild(j),k.left=g+"px",k.top=h+"px",k.position="absolute"):c.firstChild?c.insertBefore(j,c.firstChild):c.appendChild(j),i.renderfix=function(){},i},a.prototype.clear=function(){a.eve("clear",this),this.canvas.innerHTML=o,this.span=a._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},a.prototype.remove=function(){a.eve("remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=typeof this[b]=="function"?a._removedFactory(b):null;return!0};var G=a.st;for(var H in E)E[b](H)&&!G[b](H)&&(G[H]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(H))}(window.Raphael);
Raphael.fn.star=function(a,b,c,d,e){d=d||c*.382,e=e||5;var f=["M",a,b+d,"L"],g;for(var h=1;h<e*2;h++)g=h%2?c:d,f=f.concat([a+g*Math.sin(h*Math.PI/e),b+g*Math.cos(h*Math.PI/e)]);return f.push("z"),this.path(f.join())},Raphael.fn.flower=function(a,b,c,d,e){d=d||c*.5,e=+e<3||!e?5:e;var f=["M",a,b+d,"Q"],g;for(var h=1;h<e*2+1;h++)g=h%2?c:d,f=f.concat([+(a+g*Math.sin(h*Math.PI/e)).toFixed(3),+(b+g*Math.cos(h*Math.PI/e)).toFixed(3)]);return f.push("z"),this.path(f)},Raphael.fn.spike=function(a,b,c,d,e){d=d||c*.5,e=+e<3||!e?5:e;var f=["M",a,b-c,"Q"],g;for(var h=1;h<e*2+1;h++)g=h%2?d:c,f=f.concat([a+g*Math.sin(h*Math.PI/e-Math.PI),b+g*Math.cos(h*Math.PI/e-Math.PI)]);return f.push("z"),this.path(f)},Raphael.fn.polyline=function(){var a="M".concat(arguments[0]||0,",",arguments[1]||0,"L");for(var b=2,c=arguments.length-1;b<c;b++)a+=arguments[b]+","+arguments[++b];return arguments[c].toLowerCase()=="z"&&(a+="z"),this.path(a)},Raphael.fn.polygon=function(a,b,c,d){d=+d<3||!d?5:d;var e=["M",a,b-c,"L"],f;for(var g=1;g<d;g++)e=e.concat([a+c*Math.sin(g*Math.PI*2/d-Math.PI),b+c*Math.cos(g*Math.PI*2/d-Math.PI)]);return e.push("z"),this.path(e)},Raphael.fn.line=function(a,b,c,d){return this.path(["M",a,b,"L",c,d])},Raphael.fn.drawGrid=function(a,b,c,d,e,f,g){g=g||"#000";var h=["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,a,b],i=d/f,j=c/e;for(var k=1;k<f;k++)h=h.concat(["M",a,b+k*i,"L",a+c,b+k*i]);for(var k=1;k<e;k++)h=h.concat(["M",a+k*j,b,"L",a+k*j,b+d]);return this.path(h.join(",")).attr({stroke:g})},Raphael.fn.square=function(a,b,c){return c*=.7,this.rect(a-c,b-c,2*c,2*c)},Raphael.fn.triangle=function(a,b,c){return c*=1.75,this.path("M".concat(a,",",b,"m0-",c*.58,"l",c*.5,",",c*.87,"-",c,",0z"))},Raphael.fn.triangle2=function(a,b,c){return c*=1.75,this.path("M".concat(a,",",b,"m-",c*.58,",0l",c*.87,",",c*.5,"l0,-",c," z"))},Raphael.fn.circ=function(a,b,c){return this.path(["m",-c,",",0,"a",c,",",c,0,1,0,c*2,",",0,"a",c,",",c,0,1,0,-(c*2),",",0].join(" "))},Raphael.fn.diamond=function(a,b,c){return this.path(["M",a,b-c,"l",c,c,-c,c,-c,-c,c,-c,"z"])},Raphael.fn.cross=function(a,b,c){return c/=2.5,this.path("M".concat(a-c,",",b,"l",[-c,-c,c,-c,c,c,c,-c,c,c,-c,c,c,c,-c,c,-c,-c,-c,c,-c,-c,"z"]))},Raphael.fn.plus=function(a,b,c){return c/=2,this.path("M".concat(a-c/2,",",b-c/2,"l",[0,-c,c,0,0,c,c,0,0,c,-c,0,0,c,-c,0,0,-c,-c,0,0,-c,"z"]))},Raphael.fn.arrow=function(a,b,c){return this.path("M".concat(a-c*.7,",",b-c*.4,"l",[c*.6,0,0,-c*.4,c,c*.8,-c,c*.8,0,-c*.4,-c*.6,0],"z"))};
var jsonlint=function(){var a=!0,b=!1,c={},d=function(){var a={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(a,b,c,d,e,f,g){var h=f.length-1;switch(e){case 1:this.$=a;break;case 2:this.$=Number(a);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=f[h-1];case 13:this.$={};break;case 14:this.$=f[h-1];break;case 15:this.$=[f[h-2],f[h]];break;case 16:this.$={},this.$[f[h][0]]=f[h][1];break;case 17:this.$=f[h-2],f[h-2][f[h][0]]=f[h][1];break;case 18:this.$=[];break;case 19:this.$=f[h-1];break;case 20:this.$=[f[h]];break;case 21:this.$=f[h-2],f[h-2].push(f[h])}},table:[{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],12:1,13:2,15:7,16:8,17:[1,14],23:[1,15]},{1:[3]},{14:[1,16]},{14:[2,7],18:[2,7],22:[2,7],24:[2,7]},{14:[2,8],18:[2,8],22:[2,8],24:[2,8]},{14:[2,9],18:[2,9],22:[2,9],24:[2,9]},{14:[2,10],18:[2,10],22:[2,10],24:[2,10]},{14:[2,11],18:[2,11],22:[2,11],24:[2,11]},{14:[2,12],18:[2,12],22:[2,12],24:[2,12]},{14:[2,3],18:[2,3],22:[2,3],24:[2,3]},{14:[2,4],18:[2,4],22:[2,4],24:[2,4]},{14:[2,5],18:[2,5],22:[2,5],24:[2,5]},{14:[2,1],18:[2,1],21:[2,1],22:[2,1],24:[2,1]},{14:[2,2],18:[2,2],22:[2,2],24:[2,2]},{3:20,4:[1,12],18:[1,17],19:18,20:19},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:23,15:7,16:8,17:[1,14],23:[1,15],24:[1,21],25:22},{1:[2,6]},{14:[2,13],18:[2,13],22:[2,13],24:[2,13]},{18:[1,24],22:[1,25]},{18:[2,16],22:[2,16]},{21:[1,26]},{14:[2,18],18:[2,18],22:[2,18],24:[2,18]},{22:[1,28],24:[1,27]},{22:[2,20],24:[2,20]},{14:[2,14],18:[2,14],22:[2,14],24:[2,14]},{3:20,4:[1,12],20:29},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:30,15:7,16:8,17:[1,14],23:[1,15]},{14:[2,19],18:[2,19],22:[2,19],24:[2,19]},{3:5,4:[1,12],5:6,6:[1,13],7:3,8:[1,9],9:4,10:[1,10],11:[1,11],13:31,15:7,16:8,17:[1,14],23:[1,15]},{18:[2,17],22:[2,17]},{18:[2,15],22:[2,15]},{22:[2,21],24:[2,21]}],defaultActions:{16:[2,6]},parseError:function(a,b){throw new Error(a)},parse:function(a){function b(){var a;return a=d.lexer.lex()||1,typeof a!="number"&&(a=d.symbols_[a]||a),a}function c(a){e.length=e.length-2*a,f.length=f.length-a,g.length=g.length-a}var d=this,e=[0],f=[null],g=[],h=this.table,i="",j=0,k=0,l=0,m=2,n=1;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var o=this.lexer.yylloc;g.push(o),typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var p,q,r,s,t,u,v={},w,x,y,z;for(;;){r=e[e.length-1],this.defaultActions[r]?s=this.defaultActions[r]:(p==null&&(p=b()),s=h[r]&&h[r][p]);if(typeof s=="undefined"||!s.length||!s[0]){if(!l){z=[];for(w in h[r])this.terminals_[w]&&w>2&&z.push("'"+this.terminals_[w]+"'");var A="";this.lexer.showPosition?A="Parse error on line "+(j+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+z.join(", "):A="Parse error on line "+(j+1)+": Unexpected "+(p==1?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(A,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:o,expected:z})}if(l==3){if(p==n)throw new Error(A||"Parsing halted.");k=this.lexer.yyleng,i=this.lexer.yytext,j=this.lexer.yylineno,o=this.lexer.yylloc,p=b()}for(;;){if(m.toString()in h[r])break;if(r==0)throw new Error(A||"Parsing halted.");c(1),r=e[e.length-1]}q=p,p=m,r=e[e.length-1],s=h[r]&&h[r][m],l=3}if(s[0]instanceof Array&&s.length>1)throw new Error("Parse Error: multiple actions possible at state: "+r+", token: "+p);switch(s[0]){case 1:e.push(p),f.push(this.lexer.yytext),g.push(this.lexer.yylloc),e.push(s[1]),p=null,q?(p=q,q=null):(k=this.lexer.yyleng,i=this.lexer.yytext,j=this.lexer.yylineno,o=this.lexer.yylloc,l>0&&l--);break;case 2:x=this.productions_[s[1]][1],v.$=f[f.length-x],v._$={first_line:g[g.length-(x||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(x||1)].first_column,last_column:g[g.length-1].last_column},u=this.performAction.call(v,i,k,j,this.yy,s[1],f,g);if(typeof u!="undefined")return u;x&&(e=e.slice(0,-1*x*2),f=f.slice(0,-1*x),g=g.slice(0,-1*x)),e.push(this.productions_[s[1]][0]),f.push(v.$),g.push(v._$),y=h[e[e.length-2]][e[e.length-1]],e.push(y);break;case 3:return!0}}return!0}},b=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parseError)throw new Error(a);this.yy.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.match+=a,this.matched+=a;var b=a.match(/\n/);return b&&this.yylineno++,this._input=this._input.slice(1),a},unput:function(a){return this._input=a+this._input,this},more:function(){return this._more=!0,this},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d;this._more||(this.yytext="",this.match="");var e=this._currentRules();for(var f=0;f<e.length;f++){b=this._input.match(this.rules[e[f]]);if(b){d=b[0].match(/\n.*/g),d&&(this.yylineno+=d.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:d?d[d.length-1].length-1:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,e[f],this.conditionStack[this.conditionStack.length-1]);if(a)return a;return}}if(this._input==="")return this.EOF;this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return typeof a!="undefined"?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules}};return a.performAction=function(a,b,c,d){var e=d;switch(c){case 0:break;case 1:return 6;case 2:return b.yytext=b.yytext.substr(1,b.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},a.rules=[/^\s+/,/^-?([0-9]|[1-9][0-9]+)(\.[0-9]+)?([eE][-+]?[0-9]+)?\b/,/^"(\\["bfnrt/\\]|\\u[a-fA-F0-9]{4}|[^\0-\x09\x0a-\x1f"\\])*"/,/^\{/,/^\}/,/^\[/,/^\]/,/^,/,/^:/,/^true\b/,/^false\b/,/^null\b/,/^$/,/^./],a.conditions={INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}},a}();return a.lexer=b,a}();return typeof a!="undefined"&&typeof c!="undefined"&&(c.parser=d,c.parse=function(){return d.parse.apply(d,arguments)},c.main=function(b){if(!b[1])throw new Error("Usage: "+b[0]+" FILE");if(typeof process!="undefined")var d=a("fs").readFileSync(a("path").join(process.cwd(),b[1]),"utf8");else var e=a("file").path(a("file").cwd()),d=e.join(b[1]).read({charset:"utf-8"});return c.parser.parse(d)},typeof b!="undefined"&&a.main===b&&c.main(typeof process!="undefined"?process.argv.slice(1):a("system").args)),c}();
var CodeMirror=function(){function a(d,e){function Xb(a){return a>=0&&a<tb.size}function Zb(a){return v(tb,a)}function $b(a,b){Kb=!0;var c=b-a.height;for(var d=a;d;d=d.parent)d.height+=c}function _b(a){var b={line:0,ch:0};pc(b,{line:tb.size-1,ch:Zb(tb.size-1).text.length},hb(a),b,b),Eb=!0}function ac(){var a=[];return tb.iter(0,tb.size,function(b){a.push(b.text)}),a.join("\n")}function bc(a){function l(a){var b=Id(a,!0);if(b&&!_(b,g)){vb||nc(),g=b,Qc(d,b),Eb=!1;var c=Jc();if(b.line>=c.to||b.line<c.from)h=setTimeout(Vd(function(){l(a)}),150)}}function m(a){clearTimeout(h);var b=Id(a);b&&Qc(d,b),C(a),Fc(),Eb=!0,n(),j()}Pc(H(a,"shiftKey"));for(var b=F(a);b!=s;b=b.parentNode)if(b.parentNode==U&&b!=W)return;for(var b=F(a);b!=s;b=b.parentNode)if(b.parentNode==cb)return f.onGutterClick&&f.onGutterClick(Yb,fb(cb.childNodes,b)+Nb,a),C(a);var d=Id(a);switch(G(a)){case 3:L&&!c&&Jd(a);return;case 2:d&&Tc(d.line,d.ch,!0);return}if(!d){F(a)==R&&C(a);return}vb||nc();var e=+(new Date);if(zb&&zb.time>e-400&&_(zb.pos,d))return C(a),setTimeout(Fc,20),ad(d.line);if(yb&&yb.time>e-400&&_(yb.pos,d))return zb={time:e,pos:d},C(a),_c(d);yb={time:e,pos:d};var g=d,h;if(f.dragDrop&&T&&!f.readOnly&&!_(wb.from,wb.to)&&!ab(d,wb.from)&&!ab(wb.to,d)){P&&(db.draggable=!0);function i(b){P&&(db.draggable=!1),Bb=!1,j(),k(),Math.abs(a.clientX-b.clientX)+Math.abs(a.clientY-b.clientY)<10&&(C(b),Tc(d.line,d.ch,!0),Fc())}var j=I(document,"mouseup",Vd(i),!0),k=I(R,"drop",Vd(i),!0);Bb=!0,db.dragDrop&&db.dragDrop();return}C(a),Tc(d.line,d.ch,!0);var n=I(document,"mousemove",Vd(function(a){clearTimeout(h),C(a),!M&&!G(a)?m(a):l(a)}),!0),j=I(document,"mouseup",Vd(m),!0)}function cc(a){for(var b=F(a);b!=s;b=b.parentNode)if(b.parentNode==cb)return C(a);var c=Id(a);if(!c)return;zb={time:+(new Date),pos:c},C(a),_c(c)}function dc(a){if(f.onDragEvent&&f.onDragEvent(Yb,B(a)))return;a.preventDefault();var b=Id(a,!0),c=a.dataTransfer.files;if(!b||f.readOnly)return;if(c&&c.length&&window.FileReader&&window.File){function d(a,c){var d=new FileReader;d.onload=function(){g[c]=d.result,++h==e&&(b=Vc(b),Vd(function(){var a=uc(g.join(""),b,b);Qc(b,a)})())},d.readAsText(a)}var e=c.length,g=Array(e),h=0;for(var i=0;i<e;++i)d(c[i],i)}else try{var g=a.dataTransfer.getData("Text");g&&Wd(function(){var a=wb.from,c=wb.to;Qc(b,b),Bb&&uc("",a,c),vc(g),Fc()})}catch(a){}}function ec(a){var b=yc();a.dataTransfer.setData("Text",b);if(L||Q){var c=document.createElement("img");c.scr="data:image/gif;base64,R0lGODdhAgACAIAAAAAAAP///ywAAAAAAgACAAACAoRRADs=",a.dataTransfer.setDragImage(c,0,0)}}function fc(a,b){if(typeof a=="string"){a=h[a];if(!a)return!1}var c=xb;try{f.readOnly&&(Db=!0),b&&(xb=null),a(Yb)}catch(d){if(d!=K)throw d;return!1}finally{xb=c,Db=!1}return!0}function gc(a){function h(){g=!0}var b=j(f.keyMap),c=b.auto;clearTimeout(jc),c&&!l(a)&&(jc=setTimeout(function(){j(f.keyMap)==b&&(f.keyMap=c.call?c.call(null,Yb):c)},50));var d=jb[H(a,"keyCode")],e=!1;if(d==null||a.altGraphKey)return!1;H(a,"altKey")&&(d="Alt-"+d),H(a,"ctrlKey")&&(d="Ctrl-"+d),H(a,"metaKey")&&(d="Cmd-"+d);var g=!1;return H(a,"shiftKey")?e=k("Shift-"+d,f.extraKeys,f.keyMap,function(a){return fc(a,!0)},h)||k(d,f.extraKeys,f.keyMap,function(a){if(typeof a=="string"&&/^go[A-Z]/.test(a))return fc(a)},h):e=k(d,f.extraKeys,f.keyMap,fc,h),g&&(e=!1),e&&(C(a),M&&(a.oldKeyCode=a.keyCode,a.keyCode=0)),e}function hc(a,b){var c=k("'"+b+"'",f.extraKeys,f.keyMap,function(a){return fc(a,!0)});return c&&C(a),c}function kc(a){vb||nc(),M&&a.keyCode==27&&(a.returnValue=!1),zc&&Dc()&&(zc=!1);if(f.onKeyEvent&&f.onKeyEvent(Yb,B(a)))return;var b=H(a,"keyCode");Pc(b==16||H(a,"shiftKey"));var d=gc(a);window.opera&&(ic=d?b:null,!d&&b==88&&H(a,c?"metaKey":"ctrlKey")&&vc(""))}function lc(a){zc&&Dc();if(f.onKeyEvent&&f.onKeyEvent(Yb,B(a)))return;var b=H(a,"keyCode"),c=H(a,"charCode");if(window.opera&&b==ic){ic=null,C(a);return}if((window.opera&&!a.which||S)&&gc(a))return;var d=String.fromCharCode(c==null?b:c);f.electricChars&&sb.electricChars&&f.smartIndent&&!f.readOnly&&sb.electricChars.indexOf(d)>-1&&setTimeout(Vd(function(){cd(wb.to.line,"smart")}),75);if(hc(a,d))return;Bc()}function mc(a){if(f.onKeyEvent&&f.onKeyEvent(Yb,B(a)))return;H(a,"keyCode")==16&&(xb=null)}function nc(){if(f.readOnly=="nocursor")return;vb||(f.onFocus&&f.onFocus(Yb),vb=!0,s.className.search(/\bCodeMirror-focused\b/)==-1&&(s.className+=" CodeMirror-focused"),Jb||Ec(!0)),Ac(),Kd()}function oc(){vb&&(f.onBlur&&f.onBlur(Yb),vb=!1,Qb&&Vd(function(){Qb&&(Qb(),Qb=null)})(),s.className=s.className.replace(" CodeMirror-focused","")),clearInterval(rb),setTimeout(function(){vb||(xb=null)},150)}function pc(a,b,c,d,e){if(Db)return;if(Ub){var g=[];tb.iter(a.line,b.line+1,function(a){g.push(a.text)}),Ub.addChange(a.line,c.length,g);while(Ub.done.length>f.undoDepth)Ub.done.shift()}tc(a,b,c,d,e)}function qc(a,b){if(!a.length)return;var c=a.pop(),d=[];for(var e=c.length-1;e>=0;e-=1){var f=c[e],g=[],h=f.start+f.added;tb.iter(f.start,h,function(a){g.push(a.text)}),d.push({start:f.start,added:f.old.length,old:g});var i=Vc({line:f.start+f.old.length-1,ch:eb(g[g.length-1],f.old[f.old.length-1])});tc({line:f.start,ch:0},{line:h-1,ch:Zb(h-1).text.length},f.old,i,i)}Eb=!0,b.push(d)}function rc(){qc(Ub.done,Ub.undone)}function sc(){qc(Ub.undone,Ub.done)}function tc(a,b,c,d,e){function y(a){return a<=Math.min(b.line,b.line+s)?a:a+s}if(Db)return;var g=!1,h=Rb.length;f.lineWrapping||tb.iter(a.line,b.line+1,function(a){if(a.text.length==h)return g=!0,!0});if(a.line!=b.line||c.length>1)Kb=!0;var i=b.line-a.line,j=Zb(a.line),k=Zb(b.line);if(a.ch==0&&b.ch==0&&c[c.length-1]==""){var l=[],m=null;a.line?(m=Zb(a.line-1),m.fixMarkEnds(k)):k.fixMarkStarts();for(var n=0,o=c.length-1;n<o;++n)l.push(r.inheritMarks(c[n],m));i&&tb.remove(a.line,i,Lb),l.length&&tb.insert(a.line,l)}else if(j==k)if(c.length==1)j.replace(a.ch,b.ch,c[0]);else{k=j.split(b.ch,c[c.length-1]),j.replace(a.ch,null,c[0]),j.fixMarkEnds(k);var l=[];for(var n=1,o=c.length-1;n<o;++n)l.push(r.inheritMarks(c[n],j));l.push(k),tb.insert(a.line+1,l)}else if(c.length==1)j.replace(a.ch,null,c[0]),k.replace(null,b.ch,""),j.append(k),tb.remove(a.line+1,i,Lb);else{var l=[];j.replace(a.ch,null,c[0]),k.replace(null,b.ch,c[c.length-1]),j.fixMarkEnds(k);for(var n=1,o=c.length-1;n<o;++n)l.push(r.inheritMarks(c[n],j));i>1&&tb.remove(a.line+1,i-1,Lb),tb.insert(a.line+1,l)}if(f.lineWrapping){var p=Math.max(5,R.clientWidth/Fd()-3);tb.iter(a.line,a.line+c.length,function(a){if(a.hidden)return;var b=Math.ceil(a.text.length/p)||1;b!=a.height&&$b(a,b)})}else tb.iter(a.line,a.line+c.length,function(a){var b=a.text;b.length>h&&(Rb=b,h=b.length,Sb=null,g=!1)}),g&&(h=0,Rb="",Sb=null,tb.iter(0,tb.size,function(a){var b=a.text;b.length>h&&(h=b.length,Rb=b)}));var q=[],s=c.length-i-1;for(var n=0,t=ub.length;n<t;++n){var u=ub[n];u<a.line?q.push(u):u>b.line&&q.push(u+s)}var v=a.line+Math.min(c.length,500);Pd(a.line,v),q.push(v),ub=q,Rd(100),Gb.push({from:a.line,to:b.line+1,diff:s});var w={from:a,to:b,text:c};if(Hb){for(var x=Hb;x.next;x=x.next);x.next=w}else Hb=w;Rc(d,e,y(wb.from.line),y(wb.to.line)),R.clientHeight&&(U.style.height=tb.height*Cd()+2*Gd()+"px")}function uc(a,b,c){function d(d){if(ab(d,b))return d;if(!ab(c,d))return e;var f=d.line+a.length-(c.line-b.line)-1,g=d.ch;return d.line==c.line&&(g+=a[a.length-1].length-(c.ch-(c.line==b.line?b.ch:0))),{line:f,ch:g}}b=Vc(b),c?c=Vc(c):c=b,a=hb(a);var e;return wc(a,b,c,function(a){return e=a,{from:d(wb.from),to:d(wb.to)}}),e}function vc(a,b){wc(hb(a),wb.from,wb.to,function(a){return b=="end"?{from:a,to:a}:b=="start"?{from:wb.from,to:wb.from}:{from:wb.from,to:a}})}function wc(a,b,c,d){var e=a.length==1?a[0].length+b.ch:a[a.length-1].length,f=d({line:b.line+a.length-1,ch:e});pc(b,c,a,f.from,f.to)}function xc(a,b){var c=a.line,d=b.line;if(c==d)return Zb(c).text.slice(a.ch,b.ch);var e=[Zb(c).text.slice(a.ch)];return tb.iter(c+1,d,function(a){e.push(a.text)}),e.push(Zb(d).text.slice(0,b.ch)),e.join("\n")}function yc(){return xc(wb.from,wb.to)}function Ac(){if(zc)return;pb.set(f.pollInterval,function(){Sd(),Dc(),vb&&Ac(),Td()})}function Bc(){function b(){Sd();var c=Dc();!c&&!a?(a=!0,pb.set(60,b)):(zc=!1,Ac()),Td()}var a=!1;zc=!0,pb.set(20,b)}function Dc(){if(Jb||!vb||ib(D)||f.readOnly)return!1;var a=D.value;if(a==Cc)return!1;xb=null;var b=0,c=Math.min(Cc.length,a.length);while(b<c&&Cc[b]==a[b])++b;return b<Cc.length?wb.from={line:wb.from.line,ch:wb.from.ch-(Cc.length-b)}:Cb&&_(wb.from,wb.to)&&(wb.to={line:wb.to.line,ch:Math.min(Zb(wb.to.line).text.length,wb.to.ch+(a.length-b))}),vc(a.slice(b),"end"),Cc=a,!0}function Ec(a){_(wb.from,wb.to)?a&&(Cc=D.value=""):(Cc="",D.value=yc(),$(D))}function Fc(){f.readOnly!="nocursor"&&D.focus()}function Gc(){if(!lb.getBoundingClientRect)return;var a=lb.getBoundingClientRect();if(M&&a.top==a.bottom)return;var b=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(a.top<0||a.bottom>b)&&lb.scrollIntoView()}function Hc(){var a=wd(wb.inverted?wb.from:wb.to),b=f.lineWrapping?Math.min(a.x,db.offsetWidth):a.x;return Ic(b,a.y,b,a.yBot)}function Ic(a,b,c,d){var e=Hd(),g=Gd();b+=g,d+=g,a+=e,c+=e;var h=R.clientHeight,i=R.scrollTop,j=!1,k=!0;b<i?(R.scrollTop=Math.max(0,b),j=!0):d>i+h&&(R.scrollTop=d-h,j=!0);var l=R.clientWidth,m=R.scrollLeft,n=f.fixedGutter?X.clientWidth:0,o=a<n+e+10;return a<m+n||o?(o&&(a=0),R.scrollLeft=Math.max(0,a-10-n),j=!0):c>l+m-3&&(R.scrollLeft=c+10-l,j=!0,c>U.clientWidth&&(k=!1)),j&&f.onScroll&&f.onScroll(Yb),k}function Jc(){var a=Cd(),b=R.scrollTop-Gd(),c=Math.max(0,Math.floor(b/a)),d=Math.ceil((b+R.clientHeight)/a);return{from:x(tb,c),to:x(tb,d)}}function Kc(a,b){function n(){Sb=R.clientWidth;var a=nb.firstChild,b=!1;return tb.iter(Nb,Ob,function(c){if(!c.hidden){var d=Math.round(a.offsetHeight/k)||1;c.height!=d&&($b(c,d),Kb=b=!0)}a=a.nextSibling}),b&&(U.style.height=tb.height*k+2*Gd()+"px"),b}if(!R.clientWidth){Nb=Ob=Mb=0;return}var c=Jc();if(a!==!0&&a.length==0&&c.from>Nb&&c.to<Ob)return;var d=Math.max(c.from-100,0),e=Math.min(tb.size,c.to+100);Nb<d&&d-Nb<20&&(d=Nb),Ob>e&&Ob-e<20&&(e=Math.min(tb.size,Ob));var g=a===!0?[]:Lc([{from:Nb,to:Ob,domStart:0}],a),h=0;for(var i=0;i<g.length;++i){var j=g[i];j.from<d&&(j.domStart+=d-j.from,j.from=d),j.to>e&&(j.to=e),j.from>=j.to?g.splice(i--,1):h+=j.to-j.from}if(h==e-d&&d==Nb&&e==Ob)return;g.sort(function(a,b){return a.domStart-b.domStart});var k=Cd(),l=X.style.display;nb.style.display="none",Mc(d,e,g),nb.style.display=X.style.display="";var m=d!=Nb||e!=Ob||Pb!=R.clientHeight+k;m&&(Pb=R.clientHeight+k),Nb=d,Ob=e,Mb=y(tb,d),W.style.top=Mb*k+"px",R.clientHeight&&(U.style.height=tb.height*k+2*Gd()+"px");if(nb.childNodes.length!=Ob-Nb)throw new Error("BAD PATCH! "+JSON.stringify(g)+" size="+(Ob-Nb)+" nodes="+nb.childNodes.length);return f.lineWrapping?n():(Sb==null&&(Sb=sd(Rb)),Sb>R.clientWidth?(db.style.width=Sb+"px",U.style.width="",U.style.width=R.scrollWidth+"px"):db.style.width=U.style.width=""),X.style.display=l,(m||Kb)&&Nc()&&f.lineWrapping&&n()&&Nc(),Oc(),!b&&f.onUpdate&&f.onUpdate(Yb),!0}function Lc(a,b){for(var c=0,d=b.length||0;c<d;++c){var e=b[c],f=[],g=e.diff||0;for(var h=0,i=a.length;h<i;++h){var j=a[h];e.to<=j.from&&e.diff?f.push({from:j.from+g,to:j.to+g,domStart:j.domStart}):e.to<=j.from||e.from>=j.to?f.push(j):(e.from>j.from&&f.push({from:j.from,to:e.from,domStart:j.domStart}),e.to<j.to&&f.push({from:e.to+g,to:j.to+g,domStart:j.domStart+(e.to-j.from)}))}a=f}return a}function Mc(a,b,c){if(!c.length)nb.innerHTML="";else{function d(a){var b=a.nextSibling;return a.parentNode.removeChild(a),b}var e=0,f=nb.firstChild,g;for(var h=0;h<c.length;++h){var i=c[h];while(i.domStart>e)f=d(f),e++;for(var j=0,k=i.to-i.from;j<k;++j)f=f.nextSibling,e++}while(f)f=d(f)}var l=c.shift(),f=nb.firstChild,j=a,m=document.createElement("div");tb.iter(a,b,function(a){l&&l.to==j&&(l=c.shift());if(!l||l.from>j){if(a.hidden)var b=m.innerHTML="<pre></pre>";else{var b="<pre"+(a.className?' class="'+a.className+'"':"")+">"+a.getHTML(gd)+"</pre>";a.bgClassName&&(b='<div style="position: relative"><pre class="'+a.bgClassName+'" style="position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: -2">&#160;</pre>'+b+"</div>")}m.innerHTML=b,nb.insertBefore(m.firstChild,f)}else f=f.nextSibling;++j})}function Nc(){if(!f.gutter&&!f.lineNumbers)return;var a=W.offsetHeight,b=R.clientHeight;X.style.height=(a-b<2?b:a)+"px";var c=[],d=Nb,e;tb.iter(Nb,Math.max(Ob,Nb+1),function(a){if(a.hidden)c.push("<pre></pre>");else{var b=a.gutterMarker,g=f.lineNumbers?d+f.firstLineNumber:null;b&&b.text?g=b.text.replace("%N%",g!=null?g:""):g==null&&(g=" "),c.push(b&&b.style?'<pre class="'+b.style+'">':"<pre>",g);for(var h=1;h<a.height;++h)c.push("<br/>&#160;");c.push("</pre>"),b||(e=d)}++d}),X.style.display="none",cb.innerHTML=c.join("");if(e!=null){var g=cb.childNodes[e-Nb],h=String(tb.size).length,i=Z(g),j="";while(i.length+j.length<h)j+=" ";j&&g.insertBefore(document.createTextNode(j),g.firstChild)}X.style.display="";var k=Math.abs((parseInt(db.style.marginLeft)||0)-X.offsetWidth)>2;return db.style.marginLeft=X.offsetWidth+"px",Kb=!1,k}function Oc(){var a=_(wb.from,wb.to),b=wd(wb.from,!0),c=a?b:wd(wb.to,!0),d=wb.inverted?b:c,e=Cd(),g=Y(s),h=Y(nb);A.style.top=Math.max(0,Math.min(R.offsetHeight,d.y+h.top-g.top))+"px",A.style.left=Math.max(0,Math.min(R.offsetWidth,d.x+h.left-g.left))+"px";if(a)lb.style.top=d.y+"px",lb.style.left=(f.lineWrapping?Math.min(d.x,db.offsetWidth):d.x)+"px",lb.style.display="",mb.style.display="none";else{var i=b.y==c.y,j="",k=db.clientWidth||db.offsetWidth,l=db.clientHeight||db.offsetHeight;function m(a,b,c,d){var e=O?"width: "+(c?k-c-a:k)+"px":"right: "+c+"px";j+='<div class="CodeMirror-selected" style="position: absolute; left: '+a+"px; top: "+b+"px; "+e+"; height: "+d+'px"></div>'}if(wb.from.ch&&b.y>=0){var n=i?k-c.x:0;m(b.x,b.y,n,e)}var o=Math.max(0,b.y+(wb.from.ch?e:0)),p=Math.min(c.y,l)-o;p>.2*e&&m(0,o,0,p),(!i||!wb.from.ch)&&c.y<l-.5*e&&m(0,c.y,k-c.x,e),mb.innerHTML=j,lb.style.display="none",mb.style.display=""}}function Pc(a){a?xb=xb||(wb.inverted?wb.to:wb.from):xb=null}function Qc(a,b){var c=xb&&Vc(xb);c&&(ab(c,a)?a=c:ab(b,c)&&(b=c)),Rc(a,b),Fb=!0}function Rc(a,b,c,d){Zc=null,c==null&&(c=wb.from.line,d=wb.to.line);if(_(wb.from,a)&&_(wb.to,b))return;if(ab(b,a)){var e=b;b=a,a=e}if(a.line!=c){var g=Sc(a,c,wb.from.ch);g?a=g:qd(a.line,!1)}b.line!=d&&(b=Sc(b,d,wb.to.ch)),_(a,b)?wb.inverted=!1:_(a,wb.to)?wb.inverted=!1:_(b,wb.from)&&(wb.inverted=!0);if(f.autoClearEmptyLines&&_(wb.from,wb.to)){var h=wb.inverted?a:b;if(h.line!=wb.from.line&&wb.from.line<tb.size){var i=Zb(wb.from.line);/^\s+$/.test(i.text)&&setTimeout(Vd(function(){if(i.parent&&/^\s+$/.test(i.text)){var a=w(i);uc("",{line:a,ch:0},{line:a,ch:i.text.length})}},10))}}wb.from=a,wb.to=b,Ib=!0}function Sc(a,b,c){function d(b){var d=a.line+b,e=b==1?tb.size:-1;while(d!=e){var g=Zb(d);if(!g.hidden){var h=a.ch;if(f||h>c||h>g.text.length)h=g.text.length;return{line:d,ch:h}}d+=b}}var e=Zb(a.line),f=a.ch==e.text.length&&a.ch!=c;return e.hidden?a.line>=b?d(1)||d(-1):d(-1)||d(1):a}function Tc(a,b,c){var d=Vc({line:a,ch:b||0});(c?Qc:Rc)(d,d)}function Uc(a){return Math.max(0,Math.min(a,tb.size-1))}function Vc(a){if(a.line<0)return{line:0,ch:0};if(a.line>=tb.size)return{line:tb.size-1,ch:Zb(tb.size-1).text.length};var b=a.ch,c=Zb(a.line).text.length;return b==null||b>c?{line:a.line,ch:c}:b<0?{line:a.line,ch:0}:a}function Wc(a,b){function g(){for(var b=d+a,c=a<0?-1:tb.size;b!=c;b+=a){var e=Zb(b);if(!e.hidden)return d=b,f=e,!0}}function h(b){if(e==(a<0?0:f.text.length)){if(!!b||!g())return!1;e=a<0?f.text.length:0}else e+=a;return!0}var c=wb.inverted?wb.from:wb.to,d=c.line,e=c.ch,f=Zb(d);if(b=="char")h();else if(b=="column")h(!0);else if(b=="word"){var i=!1;for(;;){if(a<0&&!h())break;if(gb(f.text.charAt(e)))i=!0;else if(i){a<0&&(a=1,h());break}if(a>0&&!h())break}}return{line:d,ch:e}}function Xc(a,b){var c=a<0?wb.from:wb.to;if(xb||_(wb.from,wb.to))c=Wc(a,b);Tc(c.line,c.ch,!0)}function Yc(a,b){_(wb.from,wb.to)?a<0?uc("",Wc(a,b),wb.to):uc("",wb.from,Wc(a,b)):uc("",wb.from,wb.to),Fb=!0}function $c(a,b){var c=0,d=wd(wb.inverted?wb.from:wb.to,!0);Zc!=null&&(d.x=Zc),b=="page"?c=Math.min(R.clientHeight,window.innerHeight||document.documentElement.clientHeight):b=="line"&&(c=Cd());var e=xd(d.x,d.y+c*a+2);b=="page"&&(R.scrollTop+=wd(e,!0).y-d.y),Tc(e.line,e.ch,!0),Zc=d.x}function _c(a){var b=Zb(a.line).text,c=a.ch,d=a.ch;while(c>0&&gb(b.charAt(c-1)))--c;while(d<b.length&&gb(b.charAt(d)))++d;Qc({line:a.line,ch:c},{line:a.line,ch:d})}function ad(a){Qc({line:a,ch:0},Vc({line:a+1,ch:0}))}function bd(a){if(_(wb.from,wb.to))return cd(wb.from.line,a);var b=wb.to.line-(wb.to.ch?0:1);for(var c=wb.from.line;c<=b;++c)cd(c,a)}function cd(a,b){b||(b="add");if(b=="smart")if(!sb.indent)b="prev";else var c=Od(a);var d=Zb(a),e=d.indentation(f.tabSize),g=d.text.match(/^\s*/)[0],h;b=="prev"?a?h=Zb(a-1).indentation(f.tabSize):h=0:b=="smart"?h=sb.indent(c,d.text.slice(g.length),d.text):b=="add"?h=e+f.indentUnit:b=="subtract"&&(h=e-f.indentUnit),h=Math.max(0,h);var i=h-e;if(!i){if(wb.from.line!=a&&wb.to.line!=a)return;var j=g}else{var j="",k=0;if(f.indentWithTabs)for(var l=Math.floor(h/f.tabSize);l;--l)k+=f.tabSize,j+="	";while(k<h)++k,j+=" "}uc(j,{line:a,ch:0},{line:a,ch:g.length})}function dd(){sb=a.getMode(f,f.mode),tb.iter(0,tb.size,function(a){a.stateAfter=null}),ub=[0],Rd()}function ed(){var a=f.gutter||f.lineNumbers;X.style.display=a?"":"none",a?Kb=!0:nb.parentNode.style.marginLeft=0}function fd(a,b){if(f.lineWrapping){s.className+=" CodeMirror-wrap";var c=R.clientWidth/Fd()-3;tb.iter(0,tb.size,function(a){if(a.hidden)return;var b=Math.ceil(a.text.length/c)||1;b!=1&&$b(a,b)}),db.style.width=U.style.width=""}else s.className=s.className.replace(" CodeMirror-wrap",""),Sb=null,Rb="",tb.iter(0,tb.size,function(a){a.height!=1&&!a.hidden&&$b(a,1),a.text.length>Rb.length&&(Rb=a.text)});Gb.push({from:0,to:tb.size})}function gd(a){var b=f.tabSize-a%f.tabSize,c=Tb[b];if(c)return c;for(var d='<span class="cm-tab">',e=0;e<b;++e)d+=" ";return Tb[b]={html:d+"</span>",width:b}}function hd(){R.className=R.className.replace(/\s*cm-s-\S+/g,"")+f.theme.replace(/(^|\s)\s*/g," cm-s-")}function id(){this.set=[]}function jd(a,b,c){function e(a,b,c,e){Zb(a).addMark(new p(b,c,e,d))}a=Vc(a),b=Vc(b);var d=new id;if(!ab(a,b))return d;if(a.line==b.line)e(a.line,a.ch,b.ch,c);else{e(a.line,a.ch,null,c);for(var f=a.line+1,g=b.line;f<g;++f)e(f,null,null,c);e(b.line,null,b.ch,c)}return Gb.push({from:a.line,to:b.line+1}),d}function kd(a){a=Vc(a);var b=new q(a.ch);return Zb(a.line).addMark(b),b}function ld(a){a=Vc(a);var b=[],c=Zb(a.line).marked;if(!c)return b;for(var d=0,e=c.length;d<e;++d){var f=c[d];(f.from==null||f.from<=a.ch)&&(f.to==null||f.to>=a.ch)&&b.push(f.marker||f)}return b}function md(a,b,c){return typeof a=="number"&&(a=Zb(Uc(a))),a.gutterMarker={text:b,style:c},Kb=!0,a}function nd(a){typeof a=="number"&&(a=Zb(Uc(a))),a.gutterMarker=null,Kb=!0}function od(a,b){var c=a,d=a;return typeof a=="number"?d=Zb(Uc(a)):c=w(a),c==null?null:b(d,c)?(Gb.push({from:c,to:c+1}),d):null}function pd(a,b,c){return od(a,function(a){if(a.className!=b||a.bgClassName!=c)return a.className=b,a.bgClassName=c,!0})}function qd(a,b){return od(a,function(a,c){if(a.hidden!=b){a.hidden=b,$b(a,b?0:1);var d=wb.from.line,e=wb.to.line;if(b&&(d==c||e==c)){var f=d==c?Sc({line:d,ch:0},d,0):wb.from,g=e==c?Sc({line:e,ch:0},e,0):wb.to;if(!g)return;Rc(f,g)}return Kb=!0}})}function rd(a){if(typeof a=="number"){if(!Xb(a))return null;var b=a;a=Zb(a);if(!a)return null}else{var b=w(a);if(b==null)return null}var c=a.gutterMarker;return{line:b,handle:a,text:a.text,markerText:c&&c.text,markerClass:c&&c.style,lineClass:a.className,bgClass:a.bgClassName}}function sd(a){return kb.innerHTML="<pre><span>x</span></pre>",kb.firstChild.firstChild.firstChild.nodeValue=a,kb.firstChild.firstChild.offsetWidth||10}function td(a,b){function e(a){return vd(c,a).left}if(b<=0)return 0;var c=Zb(a),d=c.text,f=0,g=0,h=d.length,i,j=Math.min(h,Math.ceil(b/Fd()));for(;;){var k=e(j);if(!(k<=b&&j<h)){i=k,h=j;break}j=Math.min(h,Math.ceil(j*1.2))}if(b>i)return h;j=Math.floor(h*.8),k=e(j),k<b&&(f=j,g=k);for(;;){if(h-f<=1)return i-b>b-g?f:h;var l=Math.ceil((f+h)/2),m=e(l);m>b?(h=l,i=m):(f=l,g=m)}}function vd(a,b){if(b==0)return{top:0,left:0};var c=f.lineWrapping&&b<a.text.length&&V.test(a.text.slice(b-1,b+1));kb.innerHTML="<pre>"+a.getHTML(gd,b,ud,c)+"</pre>";var d=document.getElementById(ud),e=d.offsetTop,g=d.offsetLeft;if(M&&e==0&&g==0){var h=document.createElement("span");h.innerHTML="x",d.parentNode.insertBefore(h,d.nextSibling),e=h.offsetTop}return{top:e,left:g}}function wd(a,b){var c,d=Cd(),e=d*(y(tb,a.line)-(b?Mb:0));if(a.ch==0)c=0;else{var g=vd(Zb(a.line),a.ch);c=g.left,f.lineWrapping&&(e+=Math.max(0,g.top))}return{x:c,y:e,yBot:e+d}}function xd(a,b){function l(a){var b=vd(h,a);if(j){var d=Math.round(b.top/c);return Math.max(0,b.left+(d-k)*R.clientWidth)}return b.left}b<0&&(b=0);var c=Cd(),d=Fd(),e=Mb+Math.floor(b/c),g=x(tb,e);if(g>=tb.size)return{line:tb.size-1,ch:Zb(tb.size-1).text.length};var h=Zb(g),i=h.text,j=f.lineWrapping,k=j?e-y(tb,g):0;if(a<=0&&k==0)return{line:g,ch:0};var m=0,n=0,o=i.length,p,q=Math.min(o,Math.ceil((a+k*R.clientWidth*.9)/d));for(;;){var r=l(q);if(!(r<=a&&q<o)){p=r,o=q;break}q=Math.min(o,Math.ceil(q*1.2))}if(a>p)return{line:g,ch:o};q=Math.floor(o*.8),r=l(q),r<a&&(m=q,n=r);for(;;){if(o-m<=1)return{line:g,ch:p-a>a-n?m:o};var s=Math.ceil((m+o)/2),t=l(s);t>a?(o=s,p=t):(m=s,n=t)}}function yd(a){var b=wd(a,!0),c=Y(db);return{x:c.left+b.x,y:c.top+b.y,yBot:c.top+b.yBot}}function Cd(){if(Bd==null){Bd="<pre>";for(var a=0;a<49;++a)Bd+="x<br/>";Bd+="x</pre>"}var b=nb.clientHeight;return b==Ad?zd:(Ad=b,kb.innerHTML=Bd,zd=kb.firstChild.offsetHeight/50||1,kb.innerHTML="",zd)}function Fd(){return R.clientWidth==Ed?Dd:(Ed=R.clientWidth,Dd=sd("x"))}function Gd(){return db.offsetTop}function Hd(){return db.offsetLeft}function Id(a,b){var c=Y(R,!0),d,e;try{d=a.clientX,e=a.clientY}catch(a){return null}if(!b&&(d-c.left>R.clientWidth||e-c.top>R.clientHeight))return null;var f=Y(db,!0);return xd(d-f.left,e-f.top)}function Jd(a){function f(){var a=hb(D.value).join("\n");a!=e&&Vd(vc)(a,"end"),A.style.position="relative",D.style.cssText=d,N&&(R.scrollTop=c),Jb=!1,Ec(!0),Ac()}var b=Id(a),c=R.scrollTop;if(!b||window.opera)return;(_(wb.from,wb.to)||ab(b,wb.from)||!ab(b,wb.to))&&Vd(Tc)(b.line,b.ch);var d=D.style.cssText;A.style.position="absolute",D.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(a.clientY-5)+"px; left: "+(a.clientX-5)+"px; z-index: 1000; background: white; "+"border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",Jb=!0;var e=D.value=yc();Fc(),$(D);if(L){E(a);var g=I(window,"mouseup",function(){g(),setTimeout(f,20)},!0)}else setTimeout(f,50)}function Kd(){clearInterval(rb);var a=!0;lb.style.visibility="",rb=setInterval(function(){lb.style.visibility=(a=!a)?"":"hidden"},650)}function Md(a){function p(a,b,c){if(!a.text)return;var d=a.styles,e=g?0:a.text.length-1,f;for(var i=g?0:d.length-2,j=g?d.length:-2;i!=j;i+=2*h){var k=d[i];if(d[i+1]!=null&&d[i+1]!=m){e+=h*k.length;continue}for(var l=g?0:k.length-1,p=g?k.length:-1;l!=p;l+=h,e+=h)if(e>=b&&e<c&&o.test(f=k.charAt(l))){var q=Ld[f];if(q.charAt(1)==">"==g)n.push(f);else{if(n.pop()!=q.charAt(0))return{pos:e,match:!1};if(!n.length)return{pos:e,match:!0}}}}}var b=wb.inverted?wb.from:wb.to,c=Zb(b.line),d=b.ch-1,e=d>=0&&Ld[c.text.charAt(d)]||Ld[c.text.charAt(++d)];if(!e)return;var f=e.charAt(0),g=e.charAt(1)==">",h=g?1:-1,i=c.styles;for(var j=d+1,k=0,l=i.length;k<l;k+=2)if((j-=i[k].length)<=0){var m=i[k+1];break}var n=[c.text.charAt(d)],o=/[(){}[\]]/;for(var k=b.line,l=g?Math.min(k+100,tb.size):Math.max(-1,k-100);k!=l;k+=h){var c=Zb(k),q=k==b.line,r=p(c,q&&g?d+1:0,q&&!g?d:c.text.length);if(r)break}r||(r={pos:null,match:!1});var m=r.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",s=jd({line:b.line,ch:d},{line:b.line,ch:d+1},m),t=r.pos!=null&&jd({line:k,ch:r.pos},{line:k,ch:r.pos+1},m),u=Vd(function(){s.clear(),t&&t.clear()});a?setTimeout(u,800):Qb=u}function Nd(a){var b,c;for(var d=a,e=a-40;d>e;--d){if(d==0)return 0;var g=Zb(d-1);if(g.stateAfter)return d;var h=g.indentation(f.tabSize);if(c==null||b>h)c=d-1,b=h}return c}function Od(a){var b=Nd(a),c=b&&Zb(b-1).stateAfter;return c?c=m(sb,c):c=n(sb),tb.iter(b,a,function(a){a.highlight(sb,c,f.tabSize),a.stateAfter=m(sb,c)}),b<a&&Gb.push({from:b,to:a}),a<tb.size&&!Zb(a).stateAfter&&ub.push(a),c}function Pd(a,b){var c=Od(a);tb.iter(a,b,function(a){a.highlight(sb,c,f.tabSize),a.stateAfter=m(sb,c)})}function Qd(){var a=+(new Date)+f.workTime,b=ub.length;while(ub.length){if(!Zb(Nb).stateAfter)var c=Nb;else var c=ub.pop();if(c>=tb.size)continue;var d=Nd(c),e=d&&Zb(d-1).stateAfter;e?e=m(sb,e):e=n(sb);var g=0,h=sb.compareStates,i=!1,j=d,k=!1;tb.iter(j,tb.size,function(b){var d=b.stateAfter;if(+(new Date)>a)return ub.push(j),Rd(f.workDelay),i&&Gb.push({from:c,to:j+1}),k=!0;var l=b.highlight(sb,e,f.tabSize);l&&(i=!0),b.stateAfter=m(sb,e);var n=null;if(h){var o=d&&h(d,e);o!=K&&(n=!!o)}n==null&&(l!==!1||!d?g=0:++g>3&&(!sb.indent||sb.indent(d,"")==sb.indent(e,""))&&(n=!0));if(n)return!0;++j});if(k)return;i&&Gb.push({from:c,to:j+1})}b&&f.onHighlightComplete&&f.onHighlightComplete(Yb)}function Rd(a){if(!ub.length)return;qb.set(a,Vd(Qd))}function Sd(){Eb=Fb=Hb=null,Gb=[],Ib=!1,Lb=[]}function Td(){var a=!1,b;Ib&&(a=!Hc()),Gb.length?b=Kc(Gb,!0):(Ib&&Oc(),Kb&&Nc()),a&&Hc(),Ib&&(Gc(),Kd()),vb&&!Jb&&(Eb===!0||Eb!==!1&&Ib)&&Ec(Fb),Ib&&f.matchBrackets&&setTimeout(Vd(function(){Qb&&(Qb(),Qb=null),_(wb.from,wb.to)&&Md(!1)}),20);var c=Hb,d=Lb;Ib&&f.onCursorActivity&&f.onCursorActivity(Yb),c&&f.onChange&&Yb&&f.onChange(Yb,c);for(var e=0;e<d.length;++e)d[e](Yb);b&&f.onUpdate&&f.onUpdate(Yb)}function Vd(a){return function(){Ud++||Sd();try{var b=a.apply(this,arguments)}finally{--Ud||Td()}return b}}function Wd(a){Ub.startCompound();try{return a()}finally{Ub.endCompound()}}var f={},i=a.defaults;for(var o in i)i.hasOwnProperty(o)&&(f[o]=(e&&e.hasOwnProperty(o)?e:i)[o]);var s=document.createElement("div");s.className="CodeMirror"+(f.lineWrapping?" CodeMirror-wrap":""),s.innerHTML='<div style="overflow: hidden; position: relative; width: 3px; height: 0px;"><textarea style="position: absolute; padding: 0; width: 1px; height: 1em" wrap="off" autocorrect="off" autocapitalize="off"></textarea></div><div class="CodeMirror-scroll" tabindex="-1"><div style="position: relative"><div style="position: relative"><div class="CodeMirror-gutter"><div class="CodeMirror-gutter-text"></div></div><div class="CodeMirror-lines"><div style="position: relative; z-index: 0"><div style="position: absolute; width: 100%; height: 0; overflow: hidden; visibility: hidden;"></div><pre class="CodeMirror-cursor">&#160;</pre><div style="position: relative; z-index: -1"></div><div></div></div></div></div></div></div>',d.appendChild?d.appendChild(s):d(s);var A=s.firstChild,D=A.firstChild,R=s.lastChild,U=R.firstChild,W=U.firstChild,X=W.firstChild,cb=X.firstChild,db=X.nextSibling.firstChild,kb=db.firstChild,lb=kb.nextSibling,mb=lb.nextSibling,nb=mb.nextSibling;hd(),b&&(D.style.width="0px"),P||(db.draggable=!0),db.style.outline="none",f.tabindex!=null&&(D.tabIndex=f.tabindex),f.autofocus&&Fc(),!f.gutter&&!f.lineNumbers&&(X.style.display="none"),S&&(A.style.height="1px",A.style.position="absolute");try{sd("x")}catch(ob){throw ob.message.match(/runtime/i)&&(ob=new Error("A CodeMirror inside a P-style element does not work in Internet Explorer. (innerHTML bug)")),ob}var pb=new J,qb=new J,rb,sb,tb=new u([new t([new r("")])]),ub,vb;dd();var wb={from:{line:0,ch:0},to:{line:0,ch:0},inverted:!1},xb,yb,zb,Ab=0,Bb,Cb=!1,Db=!1,Eb,Fb,Gb,Hb,Ib,Jb,Kb,Lb,Mb=0,Nb=0,Ob=0,Pb=0,Qb,Rb="",Sb,Tb={};Vd(function(){_b(f.value||""),Eb=!1})();var Ub=new z;I(R,"mousedown",Vd(bc)),I(R,"dblclick",Vd(cc)),I(db,"selectstart",C),L||I(R,"contextmenu",Jd),I(R,"scroll",function(){Ab=R.scrollTop,Kc([]),f.fixedGutter&&(X.style.left=R.scrollLeft+"px"),f.onScroll&&f.onScroll(Yb)}),I(window,"resize",function(){Kc(!0)}),I(D,"keyup",Vd(mc)),I(D,"input",Bc),I(D,"keydown",Vd(kc)),I(D,"keypress",Vd(lc)),I(D,"focus",nc),I(D,"blur",oc);if(f.dragDrop){I(db,"dragstart",ec);function Vb(a){if(f.onDragEvent&&f.onDragEvent(Yb,B(a)))return;E(a)}I(R,"dragenter",Vb),I(R,"dragover",Vb),I(R,"drop",Vd(dc))}I(R,"paste",function(){Fc(),Bc()}),I(D,"paste",Bc),I(D,"cut",Vd(function(){f.readOnly||vc("")})),S&&I(U,"mouseup",function(){document.activeElement==D&&D.blur(),Fc()});var Wb;try{Wb=document.activeElement==D}catch(ob){}Wb||f.autofocus?setTimeout(nc,20):oc();var Yb=s.CodeMirror={getValue:ac,setValue:Vd(_b),getSelection:yc,replaceSelection:Vd(vc),focus:function(){window.focus(),Fc(),nc(),Bc()},setOption:function(a,b){var c=f[a];f[a]=b,a=="mode"||a=="indentUnit"?dd():a=="readOnly"&&b=="nocursor"?(oc(),D.blur()):a=="readOnly"&&!b?Ec(!0):a=="theme"?hd():a=="lineWrapping"&&c!=b?Vd(fd)():a=="tabSize"&&Kc(!0);if(a=="lineNumbers"||a=="gutter"||a=="firstLineNumber"||a=="theme")ed(),Kc(!0)},getOption:function(a){return f[a]},undo:Vd(rc),redo:Vd(sc),indentLine:Vd(function(a,b){typeof b!="string"&&(b==null?b=f.smartIndent?"smart":"prev":b=b?"add":"subtract"),Xb(a)&&cd(a,b)}),indentSelection:Vd(bd),historySize:function(){return{undo:Ub.done.length,redo:Ub.undone.length}},clearHistory:function(){Ub=new z},matchBrackets:Vd(function(){Md(!0)}),getTokenAt:Vd(function(a){return a=Vc(a),Zb(a.line).getTokenAt(sb,Od(a.line),a.ch)}),getStateAfter:function(a){return a=Uc(a==null?tb.size-1:a),Od(a+1)},cursorCoords:function(a,b){return a==null&&(a=wb.inverted),this.charCoords(a?wb.from:wb.to,b)},charCoords:function(a,b){return a=Vc(a),b=="local"?wd(a,!1):b=="div"?wd(a,!0):yd(a)},coordsChar:function(a){var b=Y(db);return xd(a.x-b.left,a.y-b.top)},markText:Vd(jd),setBookmark:kd,findMarksAt:ld,setMarker:Vd(md),clearMarker:Vd(nd),setLineClass:Vd(pd),hideLine:Vd(function(a){return qd(a,!0)}),showLine:Vd(function(a){return qd(a,!1)}),onDeleteLine:function(a,b){if(typeof a=="number"){if(!Xb(a))return null;a=Zb(a)}return(a.handlers||(a.handlers=[])).push(b),a},lineInfo:rd,addWidget:function(a,b,c,d,e){a=wd(Vc(a));var f=a.yBot,g=a.x;b.style.position="absolute",U.appendChild(b);if(d=="over")f=a.y;else if(d=="near"){var h=Math.max(R.offsetHeight,tb.height*Cd()),i=Math.max(U.clientWidth,db.clientWidth)-Hd();a.yBot+b.offsetHeight>h&&a.y>b.offsetHeight&&(f=a.y-b.offsetHeight),g+b.offsetWidth>i&&(g=i-b.offsetWidth)}b.style.top=f+Gd()+"px",b.style.left=b.style.right="",e=="right"?(g=U.clientWidth-b.offsetWidth,b.style.right="0px"):(e=="left"?g=0:e=="middle"&&(g=(U.clientWidth-b.offsetWidth)/2),b.style.left=g+Hd()+"px"),c&&Ic(g,f,g+b.offsetWidth,f+b.offsetHeight)},lineCount:function(){return tb.size},clipPos:Vc,getCursor:function(a){return a==null&&(a=wb.inverted),bb(a?wb.from:wb.to)},somethingSelected:function(){return!_(wb.from,wb.to)},setCursor:Vd(function(a,b,c){b==null&&typeof a.line=="number"?Tc(a.line,a.ch,c):Tc(a,b,c)}),setSelection:Vd(function(a,b,c){(c?Qc:Rc)(Vc(a),Vc(b||a))}),getLine:function(a){if(Xb(a))return Zb(a).text},getLineHandle:function(a){if(Xb(a))return Zb(a)},setLine:Vd(function(a,b){Xb(a)&&uc(b,{line:a,ch:0},{line:a,ch:Zb(a).text.length})}),removeLine:Vd(function(a){Xb(a)&&uc("",{line:a,ch:0},Vc({line:a+1,ch:0}))}),replaceRange:Vd(uc),getRange:function(a,b){return xc(Vc(a),Vc(b))},triggerOnKeyDown:Vd(kc),execCommand:function(a){return h[a](Yb)},moveH:Vd(Xc),deleteH:Vd(Yc),moveV:Vd($c),toggleOverwrite:function(){Cb?(Cb=!1,lb.className=lb.className.replace(" CodeMirror-overwrite","")):(Cb=!0,lb.className+=" CodeMirror-overwrite")},posFromIndex:function(a){var b=0,c;return tb.iter(0,tb.size,function(d){var e=d.text.length+1;if(e>a)return c=a,!0;a-=e,++b}),Vc({line:b,ch:c})},indexFromPos:function(a){if(a.line<0||a.ch<0)return 0;var b=a.ch;return tb.iter(0,a.line,function(a){b+=a.text.length+1}),b},scrollTo:function(a,b){a!=null&&(R.scrollLeft=a),b!=null&&(R.scrollTop=b),Kc([])},operation:function(a){return Vd(a)()},compoundChange:function(a){return Wd(a)},refresh:function(){Kc(!0),R.scrollHeight>Ab&&(R.scrollTop=Ab)},getInputField:function(){return D},getWrapperElement:function(){return s},getScrollerElement:function(){return R},getGutterElement:function(){return X}},ic=null,jc,zc=!1,Cc="",Zc=null;id.prototype.clear=Vd(function(){var a=Infinity,b=-Infinity;for(var c=0,d=this.set.length;c<d;++c){var e=this.set[c],f=e.marked;if(!f||!e.parent)continue;var g=w(e);a=Math.min(a,g),b=Math.max(b,g);for(var h=0;h<f.length;++h)f[h].marker==this&&f.splice(h--,1)}a!=Infinity&&Gb.push({from:a,to:b+1})}),id.prototype.find=function(){var a,b;for(var c=0,d=this.set.length;c<d;++c){var e=this.set[c],f=e.marked;for(var g=0;g<f.length;++g){var h=f[g];if(h.marker==this)if(h.from!=null||h.to!=null){var i=w(e);i!=null&&(h.from!=null&&(a={line:i,ch:h.from}),h.to!=null&&(b={line:i,ch:h.to}))}}}return{from:a,to:b}};var ud="CodeMirror-temp-"+Math.floor(Math.random()*16777215).toString(16),zd,Ad,Bd,Dd,Ed=0,Ld={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},Ud=0;for(var Xd in g)g.propertyIsEnumerable(Xd)&&!Yb.propertyIsEnumerable(Xd)&&(Yb[Xd]=g[Xd]);return Yb}function j(a){return typeof a=="string"?i[a]:a}function k(a,b,c,d,e){function f(b){b=j(b);var c=b[a];if(c!=null&&d(c))return!0;if(b.nofallthrough)return e&&e(),!0;var g=b.fallthrough;if(g==null)return!1;if(Object.prototype.toString.call(g)!="[object Array]")return f(g);for(var h=0,i=g.length;h<i;++h)if(f(g[h]))return!0;return!1}return b&&f(b)?!0:f(c)}function l(a){var b=jb[H(a,"keyCode")];return b=="Ctrl"||b=="Alt"||b=="Shift"||b=="Mod"}function m(a,b){if(b===!0)return b;if(a.copyState)return a.copyState(b);var c={};for(var d in b){var e=b[d];e instanceof Array&&(e=e.concat([])),c[d]=e}return c}function n(a,b,c){return a.startState?a.startState(b,c):!0}function o(a,b){this.pos=this.start=0,this.string=a,this.tabSize=b||8}function p(a,b,c,d){this.from=a,this.to=b,this.style=c,this.marker=d}function q(a){this.from=a,this.to=a,this.line=null}function r(a,b){this.styles=b||[a,null],this.text=a,this.height=1,this.marked=this.gutterMarker=this.className=this.bgClassName=this.handlers=null,this.stateAfter=this.parent=this.hidden=null}function s(a,b,c,d){for(var e=0,f=0,g=0;f<b;e+=2){var h=c[e],i=f+h.length;g==0?(i>a&&d.push(h.slice(a-f,Math.min(h.length,b-f)),c[e+1]),i>=a&&(g=1)):g==1&&(i>b?d.push(h.slice(0,b-f),c[e+1]):d.push(h,c[e+1])),f=i}}function t(a){this.lines=a,this.parent=null;for(var b=0,c=a.length,d=0;b<c;++b)a[b].parent=this,d+=a[b].height;this.height=d}function u(a){this.children=a;var b=0,c=0;for(var d=0,e=a.length;d<e;++d){var f=a[d];b+=f.chunkSize(),c+=f.height,f.parent=this}this.size=b,this.height=c,this.parent=null}function v(a,b){while(!a.lines)for(var c=0;;++c){var d=a.children[c],e=d.chunkSize();if(b<e){a=d;break}b-=e}return a.lines[b]}function w(a){if(a.parent==null)return null;var b=a.parent,c=fb(b.lines,a);for(var d=b.parent;d;b=d,d=d.parent)for(var e=0,f=d.children.length;;++e){if(d.children[e]==b)break;c+=d.children[e].chunkSize()}return c}function x(a,b){var c=0;a:do{for(var d=0,e=a.children.length;d<e;++d){var f=a.children[d],g=f.height;if(b<g){a=f;continue a}b-=g,c+=f.chunkSize()}return c}while(!a.lines);for(var d=0,e=a.lines.length;d<e;++d){var h=a.lines[d],i=h.height;if(b<i)break;b-=i}return c+d}function y(a,b){var c=0;a:do{for(var d=0,e=a.children.length;d<e;++d){var f=a.children[d],g=f.chunkSize();if(b<g){a=f;continue a}b-=g,c+=f.height}return c}while(!a.lines);for(var d=0;d<b;++d)c+=a.lines[d].height;return c}function z(){this.time=0,this.done=[],this.undone=[],this.compound=0,this.closed=!1}function A(){E(this)}function B(a){return a.stop||(a.stop=A),a}function C(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function D(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}function E(a){C(a),D(a)}function F(a){return a.target||a.srcElement}function G(a){if(a.which)return a.which;if(a.button&1)return 1;if(a.button&2)return 3;if(a.button&4)return 2}function H(a,b){var c=a.override&&a.override.hasOwnProperty(b);return c?a.override[b]:a[b]}function I(a,b,c,d){if(typeof a.addEventListener=="function"){a.addEventListener(b,c,!1);if(d)return function(){a.removeEventListener(b,c,!1)}}else{var e=function(a){c(a||window.event)};a.attachEvent("on"+b,e);if(d)return function(){a.detachEvent("on"+b,e)}}}function J(){this.id=null}function W(a,b,c){b==null&&(b=a.search(/[^\s\u00a0]/),b==-1&&(b=a.length));for(var d=0,e=0;d<b;++d)a.charAt(d)=="	"?e+=c-e%c:++e;return e}function X(a){return a.currentStyle?a.currentStyle:window.getComputedStyle(a,null)}function Y(a,b){var c=a.ownerDocument.body,d=0,e=0,f=!1;for(var g=a;g;g=g.offsetParent){var h=g.offsetLeft,i=g.offsetTop;g==c?(d+=Math.abs(h),e+=Math.abs(i)):(d+=h,e+=i),b&&X(g).position=="fixed"&&(f=!0)}var j=b&&!f?null:c;for(var g=a.parentNode;g!=j;g=g.parentNode)g.scrollLeft!=null&&(d-=g.scrollLeft,e-=g.scrollTop);return{left:d,top:e}}function Z(a){return a.textContent||a.innerText||a.nodeValue||""}function $(a){b?(a.selectionStart=0,a.selectionEnd=a.value.length):a.select()}function _(a,b){return a.line==b.line&&a.ch==b.ch}function ab(a,b){return a.line<b.line||a.line==b.line&&a.ch<b.ch}function bb(a){return{line:a.line,ch:a.ch}}function db(a){return cb.textContent=a,cb.innerHTML}function eb(a,b){if(!b)return 0;if(!a)return b.length;for(var c=a.length,d=b.length;c>=0&&d>=0;--c,--d)if(a.charAt(c)!=b.charAt(d))break;return d+1}function fb(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;c<d;++c)if(a[c]==b)return c;return-1}function gb(a){return/\w/.test(a)||a.toUpperCase()!=a.toLowerCase()}a.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:!1,smartIndent:!0,tabSize:4,keyMap:"default",extraKeys:null,electricChars:!0,autoClearEmptyLines:!1,onKeyEvent:null,onDragEvent:null,lineWrapping:!1,lineNumbers:!1,gutter:!1,fixedGutter:!1,firstLineNumber:1,readOnly:!1,dragDrop:!0,onChange:null,onCursorActivity:null,onGutterClick:null,onHighlightComplete:null,onUpdate:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:!1,workTime:100,workDelay:200,pollInterval:100,undoDepth:40,tabindex:null,autofocus:null};var b=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),c=b||/Mac/.test(navigator.platform),d=/Win/.test(navigator.platform),e=a.modes={},f=a.mimeModes={};a.defineMode=function(b,c){!a.defaults.mode&&b!="null"&&(a.defaults.mode=b);if(arguments.length>2){c.dependencies=[];for(var d=2;d<arguments.length;++d)c.dependencies.push(arguments[d])}e[b]=c},a.defineMIME=function(a,b){f[a]=b},a.resolveMode=function(b){if(typeof b=="string"&&f.hasOwnProperty(b))b=f[b];else if(typeof b=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(b))return a.resolveMode("application/xml");return typeof b=="string"?{name:b}:b||{name:"null"}},a.getMode=function(b,c){var c=a.resolveMode(c),d=e[c.name];return d?d(b,c):a.getMode(b,"text/plain")},a.listModes=function(){var a=[];for(var b in e)e.propertyIsEnumerable(b)&&a.push(b);return a},a.listMIMEs=function(){var a=[];for(var b in f)f.propertyIsEnumerable(b)&&a.push({mime:b,mode:f[b]});return a};var g=a.extensions={};a.defineExtension=function(a,b){g[a]=b};var h=a.commands={selectAll:function(a){a.setSelection({line:0,ch:0},{line:a.lineCount()-1})},killLine:function(a){var b=a.getCursor(!0),c=a.getCursor(!1),d=!_(b,c);!d&&a.getLine(b.line).length==b.ch?a.replaceRange("",b,{line:b.line+1,ch:0}):a.replaceRange("",b,d?c:{line:b.line})},deleteLine:function(a){var b=a.getCursor().line;a.replaceRange("",{line:b,ch:0},{line:b})},undo:function(a){a.undo()},redo:function(a){a.redo()},goDocStart:function(a){a.setCursor(0,0,!0)},goDocEnd:function(a){a.setSelection({line:a.lineCount()-1},null,!0)},goLineStart:function(a){a.setCursor(a.getCursor().line,0,!0)},goLineStartSmart:function(a){var b=a.getCursor(),c=a.getLine(b.line),d=Math.max(0,c.search(/\S/));a.setCursor(b.line,b.ch<=d&&b.ch?0:d,!0)},goLineEnd:function(a){a.setSelection({line:a.getCursor().line},null,!0)},goLineUp:function(a){a.moveV(-1,"line")},goLineDown:function(a){a.moveV(1,"line")},goPageUp:function(a){a.moveV(-1,"page")},goPageDown:function(a){a.moveV(1,"page")},goCharLeft:function(a){a.moveH(-1,"char")},goCharRight:function(a){a.moveH(1,"char")},goColumnLeft:function(a){a.moveH(-1,"column")},goColumnRight:function(a){a.moveH(1,"column")},goWordLeft:function(a){a.moveH(-1,"word")},goWordRight:function(a){a.moveH(1,"word")},delCharLeft:function(a){a.deleteH(-1,"char")},delCharRight:function(a){a.deleteH(1,"char")},delWordLeft:function(a){a.deleteH(-1,"word")},delWordRight:function(a){a.deleteH(1,"word")},indentAuto:function(a){a.indentSelection("smart")},indentMore:function(a){a.indentSelection("add")},indentLess:function(a){a.indentSelection("subtract")},insertTab:function(a){a.replaceSelection("	","end")},transposeChars:function(a){var b=a.getCursor(),c=a.getLine(b.line);b.ch>0&&b.ch<c.length-1&&a.replaceRange(c.charAt(b.ch)+c.charAt(b.ch-1),{line:b.line,ch:b.ch-1},{line:b.line,ch:b.ch+1})},newlineAndIndent:function(a){a.replaceSelection("\n","end"),a.indentLine(a.getCursor().line)},toggleOverwrite:function(a){a.toggleOverwrite()}},i=a.keyMap={};i.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharRight",Backspace:"delCharLeft",Tab:"insertTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},i.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordLeft","Ctrl-Delete":"delWordRight","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},i.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordLeft","Ctrl-Alt-Backspace":"delWordRight","Alt-Delete":"delWordRight","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},i["default"]=c?i.macDefault:i.pcDefault,i.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageUp","Shift-Ctrl-V":"goPageDown","Ctrl-D":"delCharRight","Ctrl-H":"delCharLeft","Alt-D":"delWordRight","Alt-Backspace":"delWordLeft","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},a.fromTextArea=function(b,c){function d(){b.value=h.getValue()}c||(c={}),c.value=b.value,!c.tabindex&&b.tabindex&&(c.tabindex=b.tabindex),c.autofocus==null&&b.getAttribute("autofocus")!=null&&(c.autofocus=!0);if(b.form){var e=I(b.form,"submit",d,!0);if(typeof b.form.submit=="function"){var f=b.form.submit;function g(){d(),b.form.submit=f,b.form.submit(),b.form.submit=g}b.form.submit=g}}b.style.display="none";var h=a(function(a){b.parentNode.insertBefore(a,b.nextSibling)},c);return h.save=d,h.getTextArea=function(){return b},h.toTextArea=function(){d(),b.parentNode.removeChild(h.getWrapperElement()),b.style.display="",b.form&&(e(),typeof b.form.submit=="function"&&(b.form.submit=f))},h},a.copyState=m,a.startState=n,o.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(a){var b=this.string.charAt(this.pos);if(typeof a=="string")var c=b==a;else var c=b&&(a.test?a.test(b):a(b));if(c)return++this.pos,b},eatWhile:function(a){var b=this.pos;while(this.eat(a));return this.pos>b},eatSpace:function(){var a=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>a},skipToEnd:function(){this.pos=this.string.length},skipTo:function(a){var b=this.string.indexOf(a,this.pos);if(b>-1)return this.pos=b,!0},backUp:function(a){this.pos-=a},column:function(){return W(this.string,this.start,this.tabSize)},indentation:function(){return W(this.string,null,this.tabSize)},match:function(a,b,c){if(typeof a!="string"){var e=this.string.slice(this.pos).match(a);return e&&b!==!1&&(this.pos+=e[0].length),e}function d(a){return c?a.toLowerCase():a}if(d(this.string).indexOf(d(a),this.pos)==this.pos)return b!==!1&&(this.pos+=a.length),!0},current:function(){return this.string.slice(this.start,this.pos)}},a.StringStream=o,p.prototype={attach:function(a){this.marker.set.push(a)},detach:function(a){var b=fb(this.marker.set,a);b>-1&&this.marker.set.splice(b,1)},split:function(a,b){if(this.to<=a&&this.to!=null)return null;var c=this.from<a||this.from==null?null:this.from-a+b,d=this.to==null?null:this.to-a+b;return new p(c,d,this.style,this.marker)},dup:function(){return new p(null,null,this.style,this.marker)},clipTo:function(a,b,c,d,e){a&&d>this.from&&(d<this.to||this.to==null)?this.from=null:this.from!=null&&this.from>=b&&(this.from=Math.max(d,this.from)+e),c&&(b<this.to||this.to==null)&&(b>this.from||this.from==null)?this.to=null:this.to!=null&&this.to>b&&(this.to=d<this.to?this.to+e:b)},isDead:function(){return this.from!=null&&this.to!=null&&this.from>=this.to},sameSet:function(a){return this.marker==a.marker}},q.prototype={attach:function(a){this.line=a},detach:function(a){this.line==a&&(this.line=null)},split:function(a,b){if(a<this.from)return this.from=this.to=this.from-a+b,this},isDead:function(){return this.from>this.to},clipTo:function(a,b,c,d,e){(a||b<this.from)&&(c||d>this.to)?(this.from=0,this.to=-1):this.from>b&&(this.from=this.to=Math.max(d,this.from)+e)},sameSet:function(a){return!1},find:function(){return!this.line||!this.line.parent?null:{line:w(this.line),ch:this.from}},clear:function(){if(this.line){var a=fb(this.line.marked,this);a!=-1&&this.line.marked.splice(a,1),this.line=null}}},r.inheritMarks=function(a,b){var c=new r(a),d=b&&b.marked;if(d)for(var e=0;e<d.length;++e)if(d[e].to==null&&d[e].style){var f=c.marked||(c.marked=[]),g=d[e],h=g.dup();f.push(h),h.attach(c)}return c},r.prototype={replace:function(a,b,c){var d=[],e=this.marked,f=b==null?this.text.length:b;s(0,a,this.styles,d),c&&d.push(c,null),s(f,this.text.length,this.styles,d),this.styles=d,this.text=this.text.slice(0,a)+c+this.text.slice(f),this.stateAfter=null;if(e){var g=c.length-(f-a);for(var h=0;h<e.length;++h){var i=e[h];i.clipTo(a==null,a||0,b==null,f,g),i.isDead()&&(i.detach(this),e.splice(h--,1))}}},split:function(a,b){var c=[b,null],d=this.marked;s(a,this.text.length,this.styles,c);var e=new r(b+this.text.slice(a),c);if(d)for(var f=0;f<d.length;++f){var g=d[f],h=g.split(a,b.length);h&&(e.marked||(e.marked=[]),e.marked.push(h),h.attach(e),h==g&&d.splice(f--,1))}return e},append:function(a){var b=this.text.length,c=a.marked,d=this.marked;this.text+=a.text,s(0,a.text.length,a.styles,this.styles);if(d)for(var e=0;e<d.length;++e)d[e].to==null&&(d[e].to=b);if(c&&c.length){d||(this.marked=d=[]);a:for(var e=0;e<c.length;++e){var f=c[e];if(!f.from)for(var g=0;g<d.length;++g){var h=d[g];if(h.to==b&&h.sameSet(f)){h.to=f.to==null?null:f.to+b,h.isDead()&&(h.detach(this),c.splice(e--,1));continue a}}d.push(f),f.attach(this),f.from+=b,f.to!=null&&(f.to+=b)}}},fixMarkEnds:function(a){var b=this.marked,c=a.marked;if(!b)return;for(var d=0;d<b.length;++d){var e=b[d],f=e.to==null;if(f&&c)for(var g=0;g<c.length;++g)if(c[g].sameSet(e)){f=!1;break}f&&(e.to=this.text.length)}},fixMarkStarts:function(){var a=this.marked;if(!a)return;for(var b=0;b<a.length;++b)a[b].from==null&&(a[b].from=0)},addMark:function(a){a.attach(this),this.marked==null&&(this.marked=[]),this.marked.push(a),this.marked.sort(function(a,b){return(a.from||0)-(b.from||0)})},highlight:function(a,b,c){var d=new o(this.text,c),e=this.styles,f=0,g=!1,h=e[0],i;this.text==""&&a.blankLine&&a.blankLine(b);while(!d.eol()){var j=a.token(d,b),k=this.text.slice(d.start,d.pos);d.start=d.pos,f&&e[f-1]==j?e[f-2]+=k:k&&(!g&&(e[f+1]!=j||f&&e[f-2]!=i)&&(g=!0),e[f++]=k,e[f++]=j,i=h,h=e[f]);if(d.pos>5e3){e[f++]=this.text.slice(d.pos),e[f++]=null;break}}return e.length!=f&&(e.length=f,g=!0),f&&e[f-2]!=i&&(g=!0),g||(e.length<5&&this.text.length<10?null:!1)},getTokenAt:function(a,b,c){var d=this.text,e=new o(d);while(e.pos<c&&!e.eol()){e.start=e.pos;var f=a.token(e,b)}return{start:e.start,end:e.pos,string:e.current(),className:f||null,state:b}},indentation:function(a){return W(this.text,null,a)},getHTML:function(a,b,c,d){function h(b,c){if(!b)return;f&&M&&b.charAt(0)==" "&&(b=" "+b.slice(1)),f=!1;if(b.indexOf("	")==-1){g+=b.length;var d=db(b)}else{var d="";for(var h=0;;){var i=b.indexOf("	",h);if(i==-1){d+=db(b.slice(h)),g+=b.length-h;break}g+=i-h;var j=a(g);d+=db(b.slice(h,i))+j.html,g+=j.width,h=i+1}}c?e.push('<span class="',c,'">',d,"</span>"):e.push(d)}function p(a){return a?"cm-"+a.replace(/ +/g," cm-"):null}var e=[],f=!0,g=0,i=h;if(b!=null){var j=0,k='<span id="'+c+'">';i=function(a,c){var f=a.length;b>=j&&b<j+f?(b>j&&(h(a.slice(0,b-j),c),d&&e.push("<wbr>")),e.push(k),h(a.slice(b-j),c),e.push("</span>"),b--,j+=f):(j+=f,h(a,c),j==b&&j==o?e.push(k+"</span>"):j>b+10&&/\s/.test(a)&&(i=function(){}))}}var l=this.styles,m=this.text,n=this.marked,o=m.length;if(!m&&b==null)i(" ");else if(!n||!n.length)for(var q=0,r=0;r<o;q+=2){var s=l[q],t=l[q+1],u=s.length;r+u>o&&(s=s.slice(0,o-r)),r+=u,i(s,p(t))}else{var v=0,q=0,w="",t,x=0,y=n[0].from||0,z=[],A=0;function B(){var a;while(A<n.length&&((a=n[A]).from==v||a.from==null))a.style!=null&&z.push(a),++A;y=A<n.length?n[A].from:Infinity;for(var b=0;b<z.length;++b){var c=z[b].to||Infinity;c==v?z.splice(b--,1):y=Math.min(c,y)}}var C=0;while(v<o){y==v&&B();var D=Math.min(o,y);for(;;){if(w){var E=v+w.length,F=t;for(var G=0;G<z.length;++G)F=(F?F+" ":"")+z[G].style;i(E>D?w.slice(0,D-v):w,F);if(E>=D){w=w.slice(D-v),v=D;break}v=E}w=l[q++],t=p(l[q++])}}}return e.join("")},cleanUp:function(){this.parent=null;if(this.marked)for(var a=0,b=this.marked.length;a<b;++a)this.marked[a].detach(this)}},t.prototype={chunkSize:function(){return this.lines.length},remove:function(a,b,c){for(var d=a,e=a+b;d<e;++d){var f=this.lines[d];this.height-=f.height,f.cleanUp();if(f.handlers)for(var g=0;g<f.handlers.length;++g)c.push(f.handlers[g])}this.lines.splice(a,b)},collapse:function(a){a.splice.apply(a,[a.length,0].concat(this.lines))},insertHeight:function(a,b,c){this.height+=c,M?this.lines=this.lines.slice(0,a).concat(b).concat(this.lines.slice(a)):this.lines.splice.apply(this.lines,[a,0].concat(b));for(var d=0,e=b.length;d<e;++d)b[d].parent=this},iterN:function(a,b,c){for(var d=a+b;a<d;++a)if(c(this.lines[a]))return!0}},u.prototype={chunkSize:function(){return this.size},remove:function(a,b,c){this.size-=b;for(var d=0;d<this.children.length;++d){var e=this.children[d],f=e.chunkSize();if(a<f){var g=Math.min(b,f-a),h=e.height;e.remove(a,g,c),this.height-=h-e.height,f==g&&(this.children.splice(d--,1),e.parent=null);if((b-=g)==0)break;a=0}else a-=f}if(this.size-b<25){var i=[];this.collapse(i),this.children=[new t(i)],this.children[0].parent=this}},collapse:function(a){for(var b=0,c=this.children.length;b<c;++b)this.children[b].collapse(a)},insert:function(a,b){var c=0;for(var d=0,e=b.length;d<e;++d)c+=b[d].height;this.insertHeight(a,b,c)},insertHeight:function(a,b,c){this.size+=b.length,this.height+=c;for(var d=0,e=this.children.length;d<e;++d){var f=this.children[d],g=f.chunkSize();if(a<=g){f.insertHeight(a,b,c);if(f.lines&&f.lines.length>50){while(f.lines.length>50){var h=f.lines.splice(f.lines.length-25,25),i=new t(h);f.height-=i.height,this.children.splice(d+1,0,i),i.parent=this}this.maybeSpill()}break}a-=g}},maybeSpill:function(){if(this.children.length<=10)return;var a=this;do{var b=a.children.splice(a.children.length-5,5),c=new u(b);if(!a.parent){var d=new u(a.children);d.parent=a,a.children=[d,c],a=d}else{a.size-=c.size,a.height-=c.height;var e=fb(a.parent.children,a);a.parent.children.splice(e+1,0,c)}c.parent=a.parent}while(a.children.length>10);a.parent.maybeSpill()},iter:function(a,b,c){this.iterN(a,b-a,c)},iterN:function(a,b,c){for(var d=0,e=this.children.length;d<e;++d){var f=this.children[d],g=f.chunkSize();if(a<g){var h=Math.min(b,g-a);if(f.iterN(a,h,c))return!0;if((b-=h)==0)break;a=0}else a-=g}}},z.prototype={addChange:function(a,b,c){this.undone.length=0;var d=+(new Date),e=this.done[this.done.length-1],f=e&&e[e.length-1],g=d-this.time;if(this.compound&&e&&!this.closed)e.push({start:a,added:b,old:c});else if(g>400||!f||this.closed||f.start>a+c.length||f.start+f.added<a)this.done.push([{start:a,added:b,old:c}]),this.closed=!1;else{var h=Math.max(0,f.start-a),i=Math.max(0,a+c.length-(f.start+f.added));for(var j=h;j>0;--j)f.old.unshift(c[j-1]);for(var j=i;j>0;--j)f.old.push(c[c.length-j]);h&&(f.start=a),f.added+=b-(c.length-h-i)}this.time=d},startCompound:function(){this.compound++||(this.closed=!0)},endCompound:function(){--this.compound||(this.closed=!0)}},a.e_stop=E,a.e_preventDefault=C,a.e_stopPropagation=D,a.connect=I,J.prototype={set:function(a,b){clearTimeout(this.id),this.id=setTimeout(b,a)}};var K=a.Pass={toString:function(){return"CodeMirror.Pass"}},L=/gecko\/\d{7}/i.test(navigator.userAgent),M=/MSIE \d/.test(navigator.userAgent),N=/MSIE [1-8]\b/.test(navigator.userAgent),O=M&&document.documentMode==5,P=/WebKit\//.test(navigator.userAgent),Q=/Chrome\//.test(navigator.userAgent),R=/Apple Computer/.test(navigator.vendor),S=/KHTML\//.test(navigator.userAgent),T=function(){if(N)return!1;var a=document.createElement("div");return"draggable"in a||"dragDrop"in a}(),U=function(){var a=document.createElement("textarea");return a.value="foo\nbar",a.value.indexOf("\r")>-1?"\r\n":"\n"}(),V=/^$/;L?V=/$'/:R?V=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:Q&&(V=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/),document.documentElement.getBoundingClientRect!=null&&(Y=function(a,b){try{var c=a.getBoundingClientRect();c={top:c.top,left:c.left}}catch(d){c={top:0,left:0}}if(!b)if(window.pageYOffset==null){var e=document.documentElement||document.body.parentNode;e.scrollTop==null&&(e=document.body),c.top+=e.scrollTop,c.left+=e.scrollLeft}else c.top+=window.pageYOffset,c.left+=window.pageXOffset;return c});var cb=document.createElement("pre");db("a")=="\na"?db=function(a){return cb.textContent=a,cb.innerHTML.slice(1)}:db("	")!="	"&&(db=function(a){return cb.innerHTML="",cb.appendChild(document.createTextNode(a)),cb.innerHTML}),a.htmlEscape=db;var hb="\n\nb".split(/\n/).length!=3?function(a){var b=0,c,d=[];while((c=a.indexOf("\n",b))>-1)d.push(a.slice(b,a.charAt(c-1)=="\r"?c-1:c)),b=c+1;return d.push(a.slice(b)),d}:function(a){return a.split(/\r?\n/)};a.splitLines=hb;var ib=window.getSelection?function(a){try{return a.selectionStart!=a.selectionEnd}catch(b){return!1}}:function(a){try{var b=a.ownerDocument.selection.createRange()}catch(c){}return!b||b.parentElement()!=a?!1:b.compareEndPoints("StartToEnd",b)!=0};a.defineMode("null",function(){return{token:function(a){a.skipToEnd()}}}),a.defineMIME("text/plain","null");var jb={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};return a.keyNames=jb,function(){for(var a=0;a<10;a++)jb[a+48]=String(a);for(var a=65;a<=90;a++)jb[a]=String.fromCharCode(a);for(var a=1;a<=12;a++)jb[a+111]=jb[a+63235]="F"+a}(),a}();
var qq=qq||{};qq.extend=function(a,b){for(var c in b)a[c]=b[c]},qq.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);c=c||0;var d=a.length;c<0&&(c+=d);for(;c<d;c++)if(c in a&&a[c]===b)return c;return-1},qq.getUniqueId=function(){var a=0;return function(){return a++}}(),qq.attach=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},qq.detach=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c)},qq.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1},qq.insertBefore=function(a,b){b.parentNode.insertBefore(a,b)},qq.remove=function(a){a.parentNode.removeChild(a)},qq.contains=function(a,b){return a==b?!0:a.contains?a.contains(b):!!(b.compareDocumentPosition(a)&8)},qq.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;var c=a.firstChild;return a.removeChild(c),c}}(),qq.css=function(a,b){b.opacity!=null&&typeof a.style.opacity!="string"&&typeof a.filters!="undefined"&&(b.filter="alpha(opacity="+Math.round(100*b.opacity)+")"),qq.extend(a.style,b)},qq.hasClass=function(a,b){var c=new RegExp("(^| )"+b+"( |$)");return c.test(a.className)},qq.addClass=function(a,b){qq.hasClass(a,b)||(a.className+=" "+b)},qq.removeClass=function(a,b){var c=new RegExp("(^| )"+b+"( |$)");a.className=a.className.replace(c," ").replace(/^\s+|\s+$/g,"")},qq.setText=function(a,b){a.innerText=b,a.textContent=b},qq.children=function(a){var b=[],c=a.firstChild;while(c)c.nodeType==1&&b.push(c),c=c.nextSibling;return b},qq.getByClass=function(a,b){if(a.querySelectorAll)return a.querySelectorAll("."+b);var c=[],d=a.getElementsByTagName("*"),e=d.length;for(var f=0;f<e;f++)qq.hasClass(d[f],b)&&c.push(d[f]);return c},qq.obj2url=function(a,b,c){var d=[],e="&",f=function(a,c){var e=b?/\[\]$/.test(b)?b:b+"["+c+"]":c;e!="undefined"&&c!="undefined"&&d.push(typeof a=="object"?qq.obj2url(a,e,!0):Object.prototype.toString.call(a)==="[object Function]"?encodeURIComponent(e)+"="+encodeURIComponent(a()):encodeURIComponent(e)+"="+encodeURIComponent(a))};if(!c&&b)e=/\?/.test(b)?/\?$/.test(b)?"":"&":"?",d.push(b),d.push(qq.obj2url(a));else if(Object.prototype.toString.call(a)==="[object Array]"&&typeof a!="undefined")for(var g=0,h=a.length;g<h;++g)f(a[g],g);else if(typeof a!="undefined"&&a!==null&&typeof a=="object")for(var g in a)f(a[g],g);else d.push(encodeURIComponent(b)+"="+encodeURIComponent(a));return d.join(e).replace(/^&/,"").replace(/%20/g,"+")};var qq=qq||{};qq.FileUploaderBasic=function(a){this._options={debug:!1,action:"/server/upload",params:{},button:null,multiple:!0,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(a,b){},onProgress:function(a,b,c,d){},onComplete:function(a,b,c){},onCancel:function(a,b){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.",emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(a){alert(a)}},qq.extend(this._options,a),this._filesInProgress=0,this._handler=this._createUploadHandler(),this._options.button&&(this._button=this._createUploadButton(this._options.button)),this._preventLeaveInProgress()},qq.FileUploaderBasic.prototype={setParams:function(a){this._options.params=a},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(a){var b=this;return new qq.UploadButton({element:a,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(a){b._onInputChange(a)}})},_createUploadHandler:function(){var a=this,b;qq.UploadHandlerXhr.isSupported()?b="UploadHandlerXhr":b="UploadHandlerForm";var c=new qq[b]({debug:this._options.debug,action:this._options.action,maxConnections:this._options.maxConnections,onProgress:function(b,c,d,e){a._onProgress(b,c,d,e),a._options.onProgress(b,c,d,e)},onComplete:function(b,c,d){a._onComplete(b,c,d),a._options.onComplete(b,c,d)},onCancel:function(b,c){a._onCancel(b,c),a._options.onCancel(b,c)}});return c},_preventLeaveInProgress:function(){var a=this;qq.attach(window,"beforeunload",function(b){if(!a._filesInProgress)return;var b=b||window.event;return b.returnValue=a._options.messages.onLeave,a._options.messages.onLeave})},_onSubmit:function(a,b){this._filesInProgress++},_onProgress:function(a,b,c,d){},_onComplete:function(a,b,c){this._filesInProgress--,c.error&&this._options.showMessage(c.error)},_onCancel:function(a,b){this._filesInProgress--},_onInputChange:function(a){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(a.files):this._validateFile(a)&&this._uploadFile(a),this._button.reset()},_uploadFileList:function(a){for(var b=0;b<a.length;b++)if(!this._validateFile(a[b]))return;for(var b=0;b<a.length;b++)this._uploadFile(a[b])},_uploadFile:function(a){var b=this._handler.add(a),c=this._handler.getName(b);this._options.onSubmit(b,c)!==!1&&(this._onSubmit(b,c),this._handler.upload(b,this._options.params))},_validateFile:function(a){var b,c;return a.value?b=a.value.replace(/.*(\/|\\)/,""):(b=a.fileName!=null?a.fileName:a.name,c=a.fileSize!=null?a.fileSize:a.size),this._isAllowedExtension(b)?c===0?(this._error("emptyError",b),!1):c&&this._options.sizeLimit&&c>this._options.sizeLimit?(this._error("sizeError",b),!1):c&&c<this._options.minSizeLimit?(this._error("minSizeError",b),!1):!0:(this._error("typeError",b),!1)},_error:function(a,b){function d(a,b){c=c.replace(a,b)}var c=this._options.messages[a];d("{file}",this._formatFileName(b)),d("{extensions}",this._options.allowedExtensions.join(", ")),d("{sizeLimit}",this._formatSize(this._options.sizeLimit)),d("{minSizeLimit}",this._formatSize(this._options.minSizeLimit)),this._options.showMessage(c)},_formatFileName:function(a){return a.length>33&&(a=a.slice(0,19)+"..."+a.slice(-13)),a},_isAllowedExtension:function(a){var b=-1!==a.indexOf(".")?a.replace(/.*[.]/,"").toLowerCase():"",c=this._options.allowedExtensions;if(!c.length)return!0;for(var d=0;d<c.length;d++)if(c[d].toLowerCase()==b)return!0;return!1},_formatSize:function(a){var b=-1;do a/=1024,b++;while(a>99);return Math.max(a,.1).toFixed(1)+["kB","MB","GB","TB","PB","EB"][b]}},qq.FileUploader=function(a){qq.FileUploaderBasic.apply(this,arguments),qq.extend(this._options,{element:null,listElement:null,template:'<div class="qq-uploader"><div class="qq-upload-drop-area"><span>Drop files here to upload</span></div><div class="qq-upload-button">Upload a file</div><ul class="qq-upload-list"></ul></div>',fileTemplate:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">Cancel</a><span class="qq-upload-failed-text">Failed</span></li>',classes:{button:"qq-upload-button",drop:"qq-upload-drop-area",dropActive:"qq-upload-drop-area-active",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}}),qq.extend(this._options,a),this._element=this._options.element,this._element.innerHTML=this._options.template,this._listElement=this._options.listElement||this._find(this._element,"list"),this._classes=this._options.classes,this._button=this._createUploadButton(this._find(this._element,"button")),this._bindCancelEvent(),this._setupDragDrop()},qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype),qq.extend(qq.FileUploader.prototype,{_find:function(a,b){var c=qq.getByClass(a,this._options.classes[b])[0];if(!c)throw new Error("element not found "+b);return c},_setupDragDrop:function(){var a=this,b=this._find(this._element,"drop"),c=new qq.UploadDropZone({element:b,onEnter:function(c){qq.addClass(b,a._classes.dropActive),c.stopPropagation()},onLeave:function(a){a.stopPropagation()},onLeaveNotDescendants:function(c){qq.removeClass(b,a._classes.dropActive)},onDrop:function(c){b.style.display="none",qq.removeClass(b,a._classes.dropActive),a._uploadFileList(c.dataTransfer.files)}});b.style.display="none",qq.attach(document,"dragenter",function(a){if(!c._isValidFileDrag(a))return;b.style.display="block"}),qq.attach(document,"dragleave",function(a){if(!c._isValidFileDrag(a))return;var d=document.elementFromPoint(a.clientX,a.clientY);if(!d||d.nodeName=="HTML")b.style.display="none"})},_onSubmit:function(a,b){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments),this._addToList(a,b)},_onProgress:function(a,b,c,d){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var e=this._getItemByFileId(a),f=this._find(e,"size");f.style.display="inline";var g;c!=d?g=Math.round(c/d*100)+"% from "+this._formatSize(d):g=this._formatSize(d),qq.setText(f,g)},_onComplete:function(a,b,c){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var d=this._getItemByFileId(a);qq.remove(this._find(d,"cancel")),qq.remove(this._find(d,"spinner")),c.success?qq.addClass(d,this._classes.success):qq.addClass(d,this._classes.fail)},_addToList:function(a,b){var c=qq.toElement(this._options.fileTemplate);c.qqFileId=a;var d=this._find(c,"file");qq.setText(d,this._formatFileName(b)),this._find(c,"size").style.display="none",this._listElement.appendChild(c)},_getItemByFileId:function(a){var b=this._listElement.firstChild;while(b){if(b.qqFileId==a)return b;b=b.nextSibling}},_bindCancelEvent:function(){var a=this,b=this._listElement;qq.attach(b,"click",function(b){b=b||window.event;var c=b.target||b.srcElement;if(qq.hasClass(c,a._classes.cancel)){qq.preventDefault(b);var d=c.parentNode;a._handler.cancel(d.qqFileId),qq.remove(d)}})}}),qq.UploadDropZone=function(a){this._options={element:null,onEnter:function(a){},onLeave:function(a){},onLeaveNotDescendants:function(a){},onDrop:function(a){}},qq.extend(this._options,a),this._element=this._options.element,this._disableDropOutside(),this._attachEvents()},qq.UploadDropZone.prototype={_disableDropOutside:function(a){qq.UploadDropZone.dropOutsideDisabled||(qq.attach(document,"dragover",function(a){a.dataTransfer&&(a.dataTransfer.dropEffect="none",a.preventDefault())}),qq.UploadDropZone.dropOutsideDisabled=!0)},_attachEvents:function(){var a=this;qq.attach(a._element,"dragover",function(b){if(!a._isValidFileDrag(b))return;var c=b.dataTransfer.effectAllowed;c=="move"||c=="linkMove"?b.dataTransfer.dropEffect="move":b.dataTransfer.dropEffect="copy",b.stopPropagation(),b.preventDefault()}),qq.attach(a._element,"dragenter",function(b){if(!a._isValidFileDrag(b))return;a._options.onEnter(b)}),qq.attach(a._element,"dragleave",function(b){if(!a._isValidFileDrag(b))return;a._options.onLeave(b);var c=document.elementFromPoint(b.clientX,b.clientY);if(qq.contains(this,c))return;a._options.onLeaveNotDescendants(b)}),qq.attach(a._element,"drop",function(b){if(!a._isValidFileDrag(b))return;b.preventDefault(),a._options.onDrop(b)})},_isValidFileDrag:function(a){var b=a.dataTransfer,c=navigator.userAgent.indexOf("AppleWebKit")>-1;return b&&b.effectAllowed!="none"&&(b.files||!c&&b.types.contains&&b.types.contains("Files"))}},qq.UploadButton=function(a){this._options={element:null,multiple:!1,name:"file",onChange:function(a){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"},qq.extend(this._options,a),this._element=this._options.element,qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"}),this._input=this._createInput()},qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq.remove(this._input),qq.removeClass(this._element,this._options.focusClass),this._input=this._createInput()},_createInput:function(){var a=document.createElement("input");this._options.multiple&&a.setAttribute("multiple","multiple"),a.setAttribute("type","file"),a.setAttribute("name",this._options.name),qq.css(a,{position:"absolute",right:0,top:0,fontFamily:"Arial",fontSize:"118px",margin:0,padding:0,cursor:"pointer",opacity:0}),this._element.appendChild(a);var b=this;return qq.attach(a,"change",function(){b._options.onChange(a)}),qq.attach(a,"mouseover",function(){qq.addClass(b._element,b._options.hoverClass)}),qq.attach(a,"mouseout",function(){qq.removeClass(b._element,b._options.hoverClass)}),qq.attach(a,"focus",function(){qq.addClass(b._element,b._options.focusClass)}),qq.attach(a,"blur",function(){qq.removeClass(b._element,b._options.focusClass)}),window.attachEvent&&a.setAttribute("tabIndex","-1"),a}},qq.UploadHandlerAbstract=function(a){this._options={debug:!1,action:"/upload.php",maxConnections:999,onProgress:function(a,b,c,d){},onComplete:function(a,b,c){},onCancel:function(a,b){}},qq.extend(this._options,a),this._queue=[],this._params=[]},qq.UploadHandlerAbstract.prototype={log:function(a){this._options.debug&&window.console&&console.log("[uploader] "+a)},add:function(a){},upload:function(a,b){var c=this._queue.push(a),d={};qq.extend(d,b),this._params[a]=d,c<=this._options.maxConnections&&this._upload(a,this._params[a])},cancel:function(a){this._cancel(a),this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++)this._cancel(this._queue[a]);this._queue=[]},getName:function(a){},getSize:function(a){},getQueue:function(){return this._queue},_upload:function(a){},_cancel:function(a){},_dequeue:function(a){var b=qq.indexOf(this._queue,a);this._queue.splice(b,1);var c=this._options.maxConnections;if(this._queue.length>=c&&b<c){var d=this._queue[c-1];this._upload(d,this._params[d])}}},qq.UploadHandlerForm=function(a){qq.UploadHandlerAbstract.apply(this,arguments),this._inputs={}},qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name","qqfile");var b="qq-upload-handler-iframe"+qq.getUniqueId();return this._inputs[b]=a,a.parentNode&&qq.remove(a),b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},_cancel:function(a){this._options.onCancel(a,this.getName(a)),delete this._inputs[a];var b=document.getElementById(a);b&&(b.setAttribute("src","javascript:false;"),qq.remove(b))},_upload:function(a,b){var c=this._inputs[a];if(!c)throw new Error("file with passed id was not added, or already uploaded or cancelled");var d=this.getName(a),e=this._createIframe(a),f=this._createForm(e,b);f.appendChild(c);var g=this;return this._attachLoadEvent(e,function(){g.log("iframe loaded");var b=g._getIframeContentJSON(e);g._options.onComplete(a,d,b),g._dequeue(a),delete g._inputs[a],setTimeout(function(){qq.remove(e)},1)}),f.submit(),qq.remove(f),a},_attachLoadEvent:function(a,b){qq.attach(a,"load",function(){if(!a.parentNode)return;if(a.contentDocument&&a.contentDocument.body&&a.contentDocument.body.innerHTML=="false")return;b()})},_getIframeContentJSON:function(iframe){var doc=iframe.contentDocument?iframe.contentDocument:iframe.contentWindow.document,response;this.log("converting iframe's innerHTML to JSON"),this.log("innerHTML = "+doc.body.innerHTML);try{response=eval("("+doc.body.innerHTML+")")}catch(err){response={}}return response},_createIframe:function(a){var b=qq.toElement('<iframe src="javascript:false;" name="'+a+'" />');return b.setAttribute("id",a),b.style.display="none",document.body.appendChild(b),b},_createForm:function(a,b){var c=qq.toElement('<form method="post" enctype="multipart/form-data"></form>'),d=qq.obj2url(b,this._options.action);return c.setAttribute("action",d),c.setAttribute("target",a.name),c.style.display="none",document.body.appendChild(c),c}}),qq.UploadHandlerXhr=function(a){qq.UploadHandlerAbstract.apply(this,arguments),this._files=[],this._xhrs=[],this._loaded=[]},qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");return a.type="file","multiple"in a&&typeof File!="undefined"&&typeof (new XMLHttpRequest).upload!="undefined"},qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype),qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(a instanceof File)return this._files.push(a)-1;throw new Error("Passed obj in not a File (in qq.UploadHandlerXhr)")},getName:function(a){var b=this._files[a];return b.fileName!=null?b.fileName:b.name},getSize:function(a){var b=this._files[a];return b.fileSize!=null?b.fileSize:b.size},getLoaded:function(a){return this._loaded[a]||0},_upload:function(a,b){var c=this._files[a],d=this.getName(a),e=this.getSize(a);this._loaded[a]=0;var f=this._xhrs[a]=new XMLHttpRequest,g=this;f.upload.onprogress=function(b){b.lengthComputable&&(g._loaded[a]=b.loaded,g._options.onProgress(a,d,b.loaded,b.total))},f.onreadystatechange=function(){f.readyState==4&&g._onComplete(a,f)},b=b||{},b.qqfile=d;var h=qq.obj2url(b,this._options.action);f.open("POST",h,!0),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.setRequestHeader("X-File-Name",encodeURIComponent(d)),f.setRequestHeader("Content-Type","application/octet-stream"),f.send(c)},_onComplete:function(id,xhr){if(!this._files[id])return;var name=this.getName(id),size=this.getSize(id);this._options.onProgress(id,name,size,size);if(xhr.status==200){this.log("xhr - server response received"),this.log("responseText = "+xhr.responseText);var response;try{response=eval("("+xhr.responseText+")")}catch(err){response={}}this._options.onComplete(id,name,response)}else this._options.onComplete(id,name,{});this._files[id]=null,this._xhrs[id]=null,this._dequeue(id)},_cancel:function(a){this._options.onCancel(a,this.getName(a)),this._files[a]=null,this._xhrs[a]&&(this._xhrs[a].abort(),this._xhrs[a]=null)}});
(function(a){function b(a){var b=["transform","WebkitTransform","MozTransform","msTransform","OTransform"],c;while(c=b.shift())if(typeof a.style[c]!="undefined")return c;return"transform"}var c=a.fn.css;a.fn.css=function(d,e){typeof a.props["transform"]=="undefined"&&(d=="transform"||typeof d=="object"&&typeof d["transform"]!="undefined")&&(a.props.transform=b(this.get(0)));if(a.props["transform"]!="transform")if(d=="transform"){d=a.props.transform;if(typeof e=="undefined"&&jQuery.style)return jQuery.style(this.get(0),d)}else typeof d=="object"&&typeof d["transform"]!="undefined"&&(d[a.props.transform]=d.transform,delete d.transform);return c.apply(this,arguments)}})(jQuery);
(function(a){var b="deg";a.fn.rotate=function(c){var d=a(this).css("transform")||"none";if(typeof c=="undefined"){if(d){var e=d.match(/rotate\(([^)]+)\)/);if(e&&e[1])return e[1]}return 0}var e=c.toString().match(/^(-?\d+(\.\d+)?)(.+)?$/);return e&&(e[3]&&(b=e[3]),a(this).css("transform",d.replace(/none|rotate\([^)]*\)/,"")+"rotate("+e[1]+b+")")),this},a.fn.scale=function(b,c,d){var e=a(this).css("transform");if(typeof b=="undefined"){if(e){var f=e.match(/scale\(([^)]+)\)/);if(f&&f[1])return f[1]}return 1}return a(this).css("transform",e.replace(/none|scale\([^)]*\)/,"")+"scale("+b+")"),this};var c=a.fx.prototype.cur;a.fx.prototype.cur=function(){return this.prop=="rotate"?parseFloat(a(this.elem).rotate()):this.prop=="scale"?parseFloat(a(this.elem).scale()):c.apply(this,arguments)},a.fx.step.rotate=function(c){a(c.elem).rotate(c.now+b)},a.fx.step.scale=function(b){a(b.elem).scale(b.now)};var d=a.fn.animate;a.fn.animate=function(a){if(typeof a["rotate"]!="undefined"){var c=a.rotate.toString().match(/^(([+-]=)?(-?\d+(\.\d+)?))(.+)?$/);c&&c[5]&&(b=c[5]),a.rotate=c[1]}return d.apply(this,arguments)}})(jQuery);
Ext.define("Ext.ux.statusbar.StatusBar",{extend:"Ext.toolbar.Toolbar",alternateClassName:"Ext.ux.StatusBar",alias:"widget.statusbar",requires:["Ext.toolbar.TextItem"],cls:"x-statusbar",busyIconCls:"x-status-busy",busyText:"Loading...",autoClear:5e3,emptyText:"&nbsp;",activeThreadId:0,initComponent:function(){this.statusAlign==="right"&&(this.cls+=" x-status-right"),this.callParent(arguments)},afterRender:function(){this.callParent(arguments);var a=this.statusAlign==="right";this.currIconCls=this.iconCls||this.defaultIconCls,this.statusEl=Ext.create("Ext.toolbar.TextItem",{cls:"x-status-text "+(this.currIconCls||""),text:this.text||this.defaultText||""}),a?(this.add("->"),this.add(this.statusEl)):(this.insert(0,this.statusEl),this.insert(1,"->")),this.height=27,this.doLayout()},setStatus:function(a){a=a||{},Ext.isString(a)&&(a={text:a}),a.text!==undefined&&this.setText(a.text),a.iconCls!==undefined&&this.setIcon(a.iconCls);if(a.clear){var b=a.clear,c=this.autoClear,d={useDefaults:!0,anim:!0};Ext.isObject(b)?(b=Ext.applyIf(b,d),b.wait&&(c=b.wait)):Ext.isNumber(b)?(c=b,b=d):Ext.isBoolean(b)&&(b=d),b.threadId=this.activeThreadId,Ext.defer(this.clearStatus,c,this,[b])}return this.doLayout(),this},clearStatus:function(a){a=a||{};if(a.threadId&&a.threadId!==this.activeThreadId)return this;var b=a.useDefaults?this.defaultText:this.emptyText,c=a.useDefaults?this.defaultIconCls?this.defaultIconCls:"":"";return a.anim?this.statusEl.el.puff({remove:!1,useDisplay:!0,scope:this,callback:function(){this.setStatus({text:b,iconCls:c}),this.statusEl.el.show()}}):(this.statusEl.hide(),this.setStatus({text:b,iconCls:c}),this.statusEl.show()),this.doLayout(),this},setText:function(a){return this.activeThreadId++,this.text=a||"",this.rendered&&this.statusEl.setText(this.text),this},getText:function(){return this.text},setIcon:function(a){return this.activeThreadId++,a=a||"",this.rendered?(this.currIconCls&&(this.statusEl.removeCls(this.currIconCls),this.currIconCls=null),a.length>0&&(this.statusEl.addCls(a),this.currIconCls=a)):this.currIconCls=a,this},showBusy:function(a){return Ext.isString(a)&&(a={text:a}),a=Ext.applyIf(a||{},{text:this.busyText,iconCls:this.busyIconCls}),this.setStatus(a)}});
Array.prototype.map||(Array.prototype.map=function(a,b){var c=this.length,d=new Array(c);for(var e=0;e<c;e++)e in this&&(d[e]=a.call(b,this[e],e,this));return d}),Array.prototype.filter||(Array.prototype.filter=function(a,b){var c=this.length,d=new Array;for(var e=0;e<c;e++)if(e in this){var f=this[e];a.call(b,f,e,this)&&d.push(f)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c=this.length>>>0;for(var d=0;d<c;d++)d in this&&a.call(b,this[d],d,this)}),Array.prototype.reduce||(Array.prototype.reduce=function(a,b){var c=this.length;if(!c&&arguments.length==1)throw new Error("reduce: empty array, no initial value");var d=0;if(arguments.length<2)for(;;){if(d in this){b=this[d++];break}if(++d>=c)throw new Error("reduce: no values, no initial value")}for(;d<c;d++)d in this&&(b=a(b,this[d],d,this));return b});var pv={};pv.version={major:3,minor:2},pv.identity=function(a){return a},pv.index=function(){return this.index},pv.child=function(){return this.childIndex},pv.parent=function(){return this.parent.index},pv.extend=function(a){function b(){}return b.prototype=a.prototype||a,new b};try{eval("pv.parse = function(x) x;")}catch(e){pv.parse=function(a){var b=new RegExp("function\\s*(\\b\\w+)?\\s*\\([^)]*\\)\\s*","mg"),c,d,e=0,f="";while(c=b.exec(a)){var g=c.index+c[0].length;if(a.charAt(g)!="{"){f+=a.substring(e,g)+"{return ",e=g;for(var h=0;h>=0&&g<a.length;g++){var i=a.charAt(g);switch(i){case'"':case"'":while(++g<a.length&&(d=a.charAt(g))!=i)d=="\\"&&g++;break;case"[":case"(":h++;break;case"]":case")":h--;break;case";":case",":h==0&&h--}}f+=pv.parse(a.substring(e,--g))+";}",e=g}b.lastIndex=g}return f+=a.substring(e),f}}pv.css=function(a,b){return window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue(b):a.currentStyle[b]},pv.error=function(a){typeof console=="undefined"?alert(a):console.error(a)},pv.listen=function(a,b,c){return c=pv.listener(c),a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},pv.listener=function(a){return a.$listener||(a.$listener=function(b){try{return pv.event=b,a.call(this,b)}finally{delete pv.event}})},pv.ancestor=function(a,b){while(b){if(b==a)return!0;b=b.parentNode}return!1},pv.id=function(){var a=1;return function(){return a++}}(),pv.functor=function(a){return typeof a=="function"?a:function(){return a}},pv.listen(window,"load",function(){pv.$={i:0,x:document.getElementsByTagName("script")};for(;pv.$.i<pv.$.x.length;pv.$.i++){pv.$.s=pv.$.x[pv.$.i];if(pv.$.s.type=="text/javascript+protovis")try{window.eval(pv.parse(pv.$.s.text))}catch(a){pv.error(a)}}delete pv.$}),pv.Format={},pv.Format.re=function(a){return a.replace(/[\\\^\$\*\+\?\[\]\(\)\.\{\}]/g,"\\$&")},pv.Format.pad=function(a,b,c){var d=b-String(c).length;return d<1?c:(new Array(d+1)).join(a)+c},pv.Format.date=function(a){function c(c){return a.replace(/%[a-zA-Z0-9]/g,function(a){switch(a){case"%a":return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][c.getDay()];case"%A":return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][c.getDay()];case"%h":case"%b":return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][c.getMonth()];case"%B":return["January","February","March","April","May","June","July","August","September","October","November","December"][c.getMonth()];case"%c":return c.toLocaleString();case"%C":return b("0",2,Math.floor(c.getFullYear()/100)%100);case"%d":return b("0",2,c.getDate());case"%x":case"%D":return b("0",2,c.getMonth()+1)+"/"+b("0",2,c.getDate())+"/"+b("0",2,c.getFullYear()%100);case"%e":return b(" ",2,c.getDate());case"%H":return b("0",2,c.getHours());case"%I":var e=c.getHours()%12;return e?b("0",2,e):12;case"%m":return b("0",2,c.getMonth()+1);case"%M":return b("0",2,c.getMinutes());case"%n":return"\n";case"%p":return c.getHours()<12?"AM":"PM";case"%T":case"%X":case"%r":var e=c.getHours()%12;return(e?b("0",2,e):12)+":"+b("0",2,c.getMinutes())+":"+b("0",2,c.getSeconds())+" "+(c.getHours()<12?"AM":"PM");case"%R":return b("0",2,c.getHours())+":"+b("0",2,c.getMinutes());case"%S":return b("0",2,c.getSeconds());case"%Q":return b("0",3,c.getMilliseconds());case"%t":return"	";case"%u":var f=c.getDay();return f?f:1;case"%w":return c.getDay();case"%y":return b("0",2,c.getFullYear()%100);case"%Y":return c.getFullYear();case"%%":return"%"}return a})}var b=pv.Format.pad;return c.format=c,c.parse=function(b){var c=1970,d=0,e=1,f=0,g=0,h=0,i=[function(){}],j=pv.Format.re(a).replace(/%[a-zA-Z0-9]/g,function(a){switch(a){case"%b":return i.push(function(a){d={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[a]}),"([A-Za-z]+)";case"%h":case"%B":return i.push(function(a){d={January:0,February:1,March:2,April:3,May:4,June:5,July:6,August:7,September:8,October:9,November:10,December:11}[a]}),"([A-Za-z]+)";case"%e":case"%d":return i.push(function(a){e=a}),"([0-9]+)";case"%I":case"%H":return i.push(function(a){f=a}),"([0-9]+)";case"%m":return i.push(function(a){d=a-1}),"([0-9]+)";case"%M":return i.push(function(a){g=a}),"([0-9]+)";case"%p":return i.push(function(a){f==12?a=="am"&&(f=0):a=="pm"&&(f=Number(f)+12)}),"(am|pm)";case"%S":return i.push(function(a){h=a}),"([0-9]+)";case"%y":return i.push(function(a){a=Number(a),c=a+(0<=a&&a<69?2e3:a>=69&&a<100?1900:0)}),"([0-9]+)";case"%Y":return i.push(function(a){c=a}),"([0-9]+)";case"%%":return i.push(function(){}),"%"}return a}),k=b.match(j);return k&&k.forEach(function(a,b){i[b](a)}),new Date(c,d,e,f,g,h)},c},pv.Format.time=function(a){function c(c){c=Number(c);switch(a){case"short":if(c>=31536e6)return(c/31536e6).toFixed(1)+" years";if(c>=6048e5)return(c/6048e5).toFixed(1)+" weeks";if(c>=864e5)return(c/864e5).toFixed(1)+" days";if(c>=36e5)return(c/36e5).toFixed(1)+" hours";if(c>=6e4)return(c/6e4).toFixed(1)+" minutes";return(c/1e3).toFixed(1)+" seconds";case"long":var d=[],e=c%6e4/1e3>>0,f=c%36e5/6e4>>0;d.push(b("0",2,e));if(c>=36e5){var g=c%864e5/36e5>>0;d.push(b("0",2,f)),c>=864e5?(d.push(b("0",2,g)),d.push(Math.floor(c/864e5).toFixed())):d.push(g.toFixed())}else d.push(f.toFixed());return d.reverse().join(":")}}var b=pv.Format.pad;return c.format=c,c.parse=function(b){switch(a){case"short":var c=/([0-9,.]+)\s*([a-z]+)/g,d,e=0;while(d=c.exec(b)){var f=parseFloat(d[0].replace(",","")),g=0;switch(d[2].toLowerCase()){case"year":case"years":g=31536e6;break;case"week":case"weeks":g=6048e5;break;case"day":case"days":g=864e5;break;case"hour":case"hours":g=36e5;break;case"minute":case"minutes":g=6e4;break;case"second":case"seconds":g=1e3}e+=f*g}return e;case"long":var d=b.replace(",","").split(":").reverse(),e=0;return d.length&&(e+=parseFloat(d[0])*1e3),d.length>1&&(e+=parseFloat(d[1])*6e4),d.length>2&&(e+=parseFloat(d[2])*36e5),d.length>3&&(e+=parseFloat(d[3])*864e5),e}},c},pv.Format.number=function(){function l(l){Infinity>e&&(l=Math.round(l*f)/f);var m=String(Math.abs(l)).split("."),n=m[0],o=l<0?"-":"";n.length>b&&(n=n.substring(n.length-b)),i&&n.length<a&&(n=o+(new Array(a-n.length+1)).join(g)+n),n.length>3&&(n=n.replace(/\B(?=(?:\d{3})+(?!\d))/g,k)),!i&&n.length<c&&(n=(new Array(c-n.length+1)).join(g)+o+n),m[0]=n;var p=m[1]||"";return p.length<d&&(m[1]=p+(new Array(d-p.length+1)).join(h)),m.join(j)}var a=0,b=Infinity,c=0,d=0,e=0,f=1,g="0",h="0",i=!0,j=".",k=",";return l.format=l,l.parse=function(a){var c=pv.Format.re,d=String(a).replace(new RegExp("^("+c(g)+")*"),"").replace(new RegExp("("+c(h)+")*$"),"").split(j),i=d[0].replace(new RegExp(c(k),"g"),"");i.length>b&&(i=i.substring(i.length-b));var l=d[1]?Number("0."+d[1]):0;return Infinity>e&&(l=Math.round(l*f)/f),Math.round(i)+l},l.integerDigits=function(d,e){return arguments.length?(a=Number(d),b=arguments.length>1?Number(e):a,c=a+Math.floor(a/3)*k.length,this):[a,b]},l.fractionDigits=function(a,b){return arguments.length?(d=Number(a),e=arguments.length>1?Number(b):d,f=Math.pow(10,e),this):[d,e]},l.integerPad=function(a){return arguments.length?(g=String(a),i=/\d/.test(g),this):g},l.fractionPad=function(a){return arguments.length?(h=String(a),this):h},l.decimal=function(a){return arguments.length?(j=String(a),this):j},l.group=function(b){return arguments.length?(k=b?String(b):"",c=a+Math.floor(a/3)*k.length,this):k},l},pv.map=function(a,b){var c={};return b?a.map(function(a,d){return c.index=d,b.call(c,a)}):a.slice()},pv.repeat=function(a,b){return arguments.length==1&&(b=2),pv.blend(pv.range(b).map(function(){return a}))},pv.cross=function(a,b){var c=[];for(var d=0,e=a.length,f=b.length;d<e;d++)for(var g=0,h=a[d];g<f;g++)c.push([h,b[g]]);return c},pv.blend=function(a){return Array.prototype.concat.apply([],a)},pv.transpose=function(a){var b=a.length,c=pv.max(a,function(a){return a.length});if(c>b){a.length=c;for(var d=b;d<c;d++)a[d]=new Array(b);for(var d=0;d<b;d++)for(var e=d+1;e<c;e++){var f=a[d][e];a[d][e]=a[e][d],a[e][d]=f}}else{for(var d=0;d<c;d++)a[d].length=b;for(var d=0;d<b;d++)for(var e=0;e<d;e++){var f=a[d][e];a[d][e]=a[e][d],a[e][d]=f}}a.length=c;for(var d=0;d<c;d++)a[d].length=b;return a},pv.normalize=function(a,b){var c=pv.map(a,b),d=pv.sum(c);for(var e=0;e<c.length;e++)c[e]/=d;return c},pv.permute=function(a,b,c){c||(c=pv.identity);var d=new Array(b.length),e={};return b.forEach(function(b,g){e.index=b,d[g]=c.call(e,a[b])}),d},pv.numerate=function(a,b){b||(b=pv.identity);var c={},d={};return a.forEach(function(a,e){d.index=e,c[b.call(d,a)]=e}),c},pv.uniq=function(a,b){b||(b=pv.identity);var c={},d=[],e={},f;return a.forEach(function(a,g){e.index=g,f=b.call(e,a),f in c||(c[f]=d.push(f))}),d},pv.naturalOrder=function(a,b){return a<b?-1:a>b?1:0},pv.reverseOrder=function(a,b){return b<a?-1:b>a?1:0},pv.search=function(a,b,c){c||(c=pv.identity);var d=0,e=a.length-1;while(d<=e){var f=d+e>>1,g=c(a[f]);if(g<b)d=f+1;else{if(!(g>b))return f;e=f-1}}return-d-1},pv.search.index=function(a,b,c){var d=pv.search(a,b,c);return d<0?-d-1:d},pv.range=function(a,b,c){arguments.length==1&&(b=a,a=0),c==undefined&&(c=1);if((b-a)/c==Infinity)throw new Error("range must be finite");var d=[],e=0,f;if(c<0)while((f=a+c*e++)>b)d.push(f);else while((f=a+c*e++)<b)d.push(f);return d},pv.random=function(a,b,c){return arguments.length==1&&(b=a,a=0),c==undefined&&(c=1),c?Math.floor(Math.random()*(b-a)/c)*c+a:Math.random()*(b-a)+a},pv.sum=function(a,b){var c={};return a.reduce(b?function(a,d,e){return c.index=e,a+b.call(c,d)}:function(a,b){return a+b},0)},pv.max=function(a,b){return b==pv.index?a.length-1:Math.max.apply(null,b?pv.map(a,b):a)},pv.max.index=function(a,b){if(!a.length)return-1;if(b==pv.index)return a.length-1;b||(b=pv.identity);var c=0,d=-Infinity,e={};for(var f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f]);g>d&&(d=g,c=f)}return c},pv.min=function(a,b){return b==pv.index?0:Math.min.apply(null,b?pv.map(a,b):a)},pv.min.index=function(a,b){if(!a.length)return-1;if(b==pv.index)return 0;b||(b=pv.identity);var c=0,d=Infinity,e={};for(var f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f]);g<d&&(d=g,c=f)}return c},pv.mean=function(a,b){return pv.sum(a,b)/a.length},pv.median=function(a,b){if(b==pv.index)return(a.length-1)/2;a=pv.map(a,b).sort(pv.naturalOrder);if(a.length%2)return a[Math.floor(a.length/2)];var c=a.length/2;return(a[c-1]+a[c])/2},pv.variance=function(a,b){if(a.length<1)return NaN;if(a.length==1)return 0;var c=pv.mean(a,b),d=0,e={};b||(b=pv.identity);for(var f=0;f<a.length;f++){e.index=f;var g=b.call(e,a[f])-c;d+=g*g}return d},pv.deviation=function(a,b){return Math.sqrt(pv.variance(a,b)/(a.length-1))},pv.log=function(a,b){return Math.log(a)/Math.log(b)},pv.logSymmetric=function(a,b){return a==0?0:a<0?-pv.log(-a,b):pv.log(a,b)},pv.logAdjusted=function(a,b){if(!isFinite(a))return a;var c=a<0;return a<b&&(a+=(b-a)/b),c?-pv.log(a,b):pv.log(a,b)},pv.logFloor=function(a,b){return a>0?Math.pow(b,Math.floor(pv.log(a,b))):-Math.pow(b,-Math.floor(-pv.log(-a,b)))},pv.logCeil=function(a,b){return a>0?Math.pow(b,Math.ceil(pv.log(a,b))):-Math.pow(b,-Math.ceil(-pv.log(-a,b)))},function(){var a=Math.PI/180,b=180/Math.PI;pv.radians=function(b){return a*b},pv.degrees=function(a){return b*a}}(),pv.keys=function(a){var b=[];for(var c in a)b.push(c);return b},pv.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},pv.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},pv.dict=function(a,b){var c={},d={};for(var e=0;e<a.length;e++)if(e in a){var f=a[e];d.index=e,c[f]=b.call(d,f)}return c},pv.dom=function(a){return new pv.Dom(a)},pv.Dom=function(a){this.$map=a},pv.Dom.prototype.$leaf=function(a){return typeof a!="object"},pv.Dom.prototype.leaf=function(a){return arguments.length?(this.$leaf=a,this):this.$leaf},pv.Dom.prototype.root=function(a){function d(a){var c=new pv.Dom.Node;for(var e in a){var f=a[e];c.appendChild(b(f)?new pv.Dom.Node(f):d(f)).nodeName=e}return c}var b=this.$leaf,c=d(this.$map);return c.nodeName=a,c},pv.Dom.prototype.nodes=function(){return this.root().nodes()},pv.Dom.Node=function(a){this.nodeValue=a,this.childNodes=[]},pv.Dom.Node.prototype.parentNode=null,pv.Dom.Node.prototype.firstChild=null,pv.Dom.Node.prototype.lastChild=null,pv.Dom.Node.prototype.previousSibling=null,pv.Dom.Node.prototype.nextSibling=null,pv.Dom.Node.prototype.removeChild=function(a){var b=this.childNodes.indexOf(a);if(b==-1)throw new Error("child not found");return this.childNodes.splice(b,1),a.previousSibling?a.previousSibling.nextSibling=a.nextSibling:this.firstChild=a.nextSibling,a.nextSibling?a.nextSibling.previousSibling=a.previousSibling:this.lastChild=a.previousSibling,delete a.nextSibling,delete a.previousSibling,delete a.parentNode,a},pv.Dom.Node.prototype.appendChild=function(a){return a.parentNode&&a.parentNode.removeChild(a),a.parentNode=this,a.previousSibling=this.lastChild,this.lastChild?this.lastChild.nextSibling=a:this.firstChild=a,this.lastChild=a,this.childNodes.push(a),a},pv.Dom.Node.prototype.insertBefore=function(a,b){if(!b)return this.appendChild(a);var c=this.childNodes.indexOf(b);if(c==-1)throw new Error("child not found");return a.parentNode&&a.parentNode.removeChild(a),a.parentNode=this,a.nextSibling=b,a.previousSibling=b.previousSibling,b.previousSibling?b.previousSibling.nextSibling=a:(b==this.lastChild&&(this.lastChild=a),this.firstChild=a),this.childNodes.splice(c,0,a),a},pv.Dom.Node.prototype.replaceChild=function(a,b){var c=this.childNodes.indexOf(b);if(c==-1)throw new Error("child not found");return a.parentNode&&a.parentNode.removeChild(a),a.parentNode=this,a.nextSibling=b.nextSibling,a.previousSibling=b.previousSibling,b.previousSibling?b.previousSibling.nextSibling=a:this.firstChild=a,b.nextSibling?b.nextSibling.previousSibling=a:this.lastChild=a,this.childNodes[c]=a,b},pv.Dom.Node.prototype.visitBefore=function(a){function b(c,d){a(c,d);for(var e=c.firstChild;e;e=e.nextSibling)b(e,d+1)}b(this,0)},pv.Dom.Node.prototype.visitAfter=function(a){function b(c,d){for(var e=c.firstChild;e;e=e.nextSibling)b(e,d+1);a(c,d)}b(this,0)},pv.Dom.Node.prototype.sort=function(a){if(this.firstChild){this.childNodes.sort(a);var b=this.firstChild=this.childNodes[0],c;delete b.previousSibling;for(var d=1;d<this.childNodes.length;d++)b.sort(a),c=this.childNodes[d],c.previousSibling=b,b=b.nextSibling=c;this.lastChild=b,delete b.nextSibling,b.sort(a)}return this},pv.Dom.Node.prototype.reverse=function(){var a=[];return this.visitAfter(function(b){while(b.lastChild)a.push(b.removeChild(b.lastChild));for(var c;c=a.pop();)b.insertBefore(c,b.firstChild)}),this},pv.Dom.Node.prototype.nodes=function(){function b(c){a.push(c),c.childNodes.forEach(b)}var a=[];return b(this,a),a},pv.Dom.Node.prototype.toggle=function(a){if(a)return this.toggled?this.visitBefore(function(a){a.toggled&&a.toggle()}):this.visitAfter(function(a){a.toggled||a.toggle()});var b=this;if(b.toggled){for(var c;c=b.toggled.pop();)b.appendChild(c);delete b.toggled}else if(b.lastChild){b.toggled=[];while(b.lastChild)b.toggled.push(b.removeChild(b.lastChild))}},pv.nodes=function(a){var b=new pv.Dom.Node;for(var c=0;c<a.length;c++)b.appendChild(new pv.Dom.Node(a[c]));return b.nodes()},pv.tree=function(a){return new pv.Tree(a)},pv.Tree=function(a){this.array=a},pv.Tree.prototype.keys=function(a){return this.k=a,this},pv.Tree.prototype.value=function(a){return this.v=a,this},pv.Tree.prototype.map=function(){var a={},b={};for(var c=0;c<this.array.length;c++){b.index=c;var d=this.array[c],e=this.k.call(b,d),f=a;for(var g=0;g<e.length-1;g++)f=f[e[g]]||(f[e[g]]={});f[e[g]]=this.v?this.v.call(b,d):d}return a},pv.nest=function(a){return new pv.Nest(a)},pv.Nest=function(a){this.array=a,this.keys=[]},pv.Nest.prototype.key=function(a){return this.keys.push(a),this},pv.Nest.prototype.sortKeys=function(a){return this.keys[this.keys.length-1].order=a||pv.naturalOrder,this},pv.Nest.prototype.sortValues=function(a){return this.order=a||pv.naturalOrder,this},pv.Nest.prototype.map=function(){var a={},b=[];for(var c,d=0;d<this.array.length;d++){var e=this.array[d],f=a;for(c=0;c<this.keys.length-1;c++){var g=this.keys[c](e);f[g]||(f[g]={}),f=f[g]}g=this.keys[c](e);if(!f[g]){var h=[];b.push(h),f[g]=h}f[g].push(e)}if(this.order)for(var c=0;c<b.length;c++)b[c].sort(this.order);return a},pv.Nest.prototype.entries=function(){function a(b){var c=[];for(var d in b){var e=b[d];c.push({key:d,values:e instanceof Array?e:a(e)})}return c}function b(a,c){var d=this.keys[c].order;d&&a.sort(function(a,b){return d(a.key,b.key)});if(++c<this.keys.length)for(var e=0;e<a.length;e++)b.call(this,a[e].values,c);return a}return b.call(this,a(this.map()),0)},pv.Nest.prototype.rollup=function(a){function b(c){for(var d in c){var e=c[d];e instanceof Array?c[d]=a(e):b(e)}return c}return b(this.map())},pv.flatten=function(a){return new pv.Flatten(a)},pv.Flatten=function(a){this.map=a,this.keys=[]},pv.Flatten.prototype.key=function(a,b){return this.keys.push({name:a,value:b}),delete this.$leaf,this},pv.Flatten.prototype.leaf=function(a){return this.keys.length=0,this.$leaf=a,this},pv.Flatten.prototype.array=function(){function f(d,e){if(e<c.length-1)for(var g in d)b.push(g),f(d[g],e+1),b.pop();else a.push(b.concat(d))}var a=[],b=[],c=this.keys,d=this.$leaf;if(d){function e(c,f){if(d(c))a.push({keys:b.slice(),value:c});else for(var g in c)b.push(g),e(c[g],f+1),b.pop()}return e(this.map,0),a}return f(this.map,0),a.map(function(a){var b={};for(var d=0;d<c.length;d++){var e=c[d],f=a[d];b[e.name]=e.value?e.value.call(null,f):f}return b})},pv.vector=function(a,b){return new pv.Vector(a,b)},pv.Vector=function(a,b){this.x=a,this.y=b},pv.Vector.prototype.perp=function(){return new pv.Vector(-this.y,this.x)},pv.Vector.prototype.norm=function(){var a=this.length();return this.times(a?1/a:1)},pv.Vector.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},pv.Vector.prototype.times=function(a){return new pv.Vector(this.x*a,this.y*a)},pv.Vector.prototype.plus=function(a,b){return arguments.length==1?new pv.Vector(this.x+a.x,this.y+a.y):new pv.Vector(this.x+a,this.y+b)},pv.Vector.prototype.minus=function(a,b){return arguments.length==1?new pv.Vector(this.x-a.x,this.y-a.y):new pv.Vector(this.x-a,this.y-b)},pv.Vector.prototype.dot=function(a,b){return arguments.length==1?this.x*a.x+this.y*a.y:this.x*a+this.y*b},pv.Transform=function(){},pv.Transform.prototype={k:1,x:0,y:0},pv.Transform.identity=new pv.Transform,pv.Transform.prototype.translate=function(a,b){var c=new pv.Transform;return c.k=this.k,c.x=this.k*a+this.x,c.y=this.k*b+this.y,c},pv.Transform.prototype.scale=function(a){var b=new pv.Transform;return b.k=this.k*a,b.x=this.x,b.y=this.y,b},pv.Transform.prototype.invert=function(){var a=new pv.Transform,b=1/this.k;return a.k=b,a.x=-this.x*b,a.y=-this.y*b,a},pv.Transform.prototype.times=function(a){var b=new pv.Transform;return b.k=this.k*a.k,b.x=this.k*a.x+this.x,b.y=this.k*a.y+this.y,b},pv.Scale=function(){},pv.Scale.interpolator=function(a,b){return typeof a=="number"?function(c){return c*(b-a)+a}:(a=pv.color(a).rgb(),b=pv.color(b).rgb(),function(c){var d=a.a*(1-c)+b.a*c;return d<1e-5&&(d=0),a.a==0?pv.rgb(b.r,b.g,b.b,d):b.a==0?pv.rgb(a.r,a.g,a.b,d):pv.rgb(Math.round(a.r*(1-c)+b.r*c),Math.round(a.g*(1-c)+b.g*c),Math.round(a.b*(1-c)+b.b*c),d)})},pv.Scale.quantitative=function(){function j(a){return new Date(a)}function k(c){var e=pv.search(a,c);return e<0&&(e=-e-2),e=Math.max(0,Math.min(d.length-1,e)),d[e]((g(c)-b[e])/(b[e+1]-b[e]))}var a=[0,1],b=[0,1],c=[0,1],d=[pv.identity],e=Number,f=!1,g=pv.identity,h=pv.identity,i=String;return k.transform=function(c,d){return g=function(a){return f?-c(-a):c(a)},h=function(a){return f?-d(-a):d(a)},b=a.map(g),this},k.domain=function(c,d,h){if(arguments.length){var i;return c instanceof Array?(arguments.length<2&&(d=pv.identity),arguments.length<3&&(h=d),i=c.length&&d(c[0]),a=c.length?[pv.min(c,d),pv.max(c,h)]:[]):(i=c,a=Array.prototype.slice.call(arguments).map(Number)),a.length?a.length==1&&(a=[a[0],a[0]]):a=[-Infinity,Infinity],f=(a[0]||a[a.length-1])<0,b=a.map(g),e=i instanceof Date?j:Number,this}return a.map(e)},k.range=function(){if(arguments.length){c=Array.prototype.slice.call(arguments),c.length?c.length==1&&(c=[c[0],c[0]]):c=[-Infinity,Infinity],d=[];for(var a=0;a<c.length-1;a++)d.push(pv.Scale.interpolator(c[a],c[a+1]));return this}return c},k.invert=function(a){var f=pv.search(c,a);return f<0&&(f=-f-2),f=Math.max(0,Math.min(d.length-1,f)),e(h(b[f]+(a-c[f])/(c[f+1]-c[f])*(b[f+1]-b[f])))},k.ticks=function(b){var c=a[0],d=a[a.length-1],f=d<c,g=f?d:c,h=f?c:d,k=h-g;if(!k||!isFinite(k))return e==j&&(i=pv.Format.date("%x")),[e(g)];if(e==j){function l(a,b){switch(b){case 31536e6:a.setMonth(0);case 2592e6:a.setDate(1);case 6048e5:b==6048e5&&a.setDate(a.getDate()-a.getDay());case 864e5:a.setHours(0);case 36e5:a.setMinutes(0);case 6e4:a.setSeconds(0);case 1e3:a.setMilliseconds(0)}}var m,n,o,p=1;k>=94608e6?(m=31536e6,n="%Y",o=function(a){a.setFullYear(a.getFullYear()+p)}):k>=7776e6?(m=2592e6,n="%m/%Y",o=function(a){a.setMonth(a.getMonth()+p)}):k>=18144e5?(m=6048e5,n="%m/%d",o=function(a){a.setDate(a.getDate()+7*p)}):k>=2592e5?(m=864e5,n="%m/%d",o=function(a){a.setDate(a.getDate()+p)}):k>=108e5?(m=36e5,n="%I:%M %p",o=function(a){a.setHours(a.getHours()+p)}):k>=18e4?(m=6e4,n="%I:%M %p",o=function(a){a.setMinutes(a.getMinutes()+p)}):k>=3e3?(m=1e3,n="%I:%M:%S",o=function(a){a.setSeconds(a.getSeconds()+p)}):(m=1,n="%S.%Qs",o=function(a){a.setTime(a.getTime()+p)}),i=pv.Format.date(n);var q=new Date(g),r=[];l(q,m);var s=k/m;if(s>10)switch(m){case 36e5:p=s>20?6:3,q.setHours(Math.floor(q.getHours()/p)*p);break;case 2592e6:p=3,q.setMonth(Math.floor(q.getMonth()/p)*p);break;case 6e4:p=s>30?15:s>15?10:5,q.setMinutes(Math.floor(q.getMinutes()/p)*p);break;case 1e3:p=s>90?15:s>60?10:5,q.setSeconds(Math.floor(q.getSeconds()/p)*p);break;case 1:p=s>1e3?250:s>200?100:s>100?50:s>50?25:5,q.setMilliseconds(Math.floor(q.getMilliseconds()/p)*p);break;default:p=pv.logCeil(s/15,10),s/p<2?p/=5:s/p<5&&(p/=2),q.setFullYear(Math.floor(q.getFullYear()/p)*p)}for(;;){o(q);if(q>h)break;r.push(new Date(q))}return f?r.reverse():r}arguments.length||(b=10);var p=pv.logFloor(k/b,10),t=b/(k/p);t<=.15?p*=10:t<=.35?p*=5:t<=.75&&(p*=2);var c=Math.ceil(g/p)*p,d=Math.floor(h/p)*p;i=pv.Format.number().fractionDigits(Math.max(0,-Math.floor(pv.log(p,10)+.01)));var u=pv.range(c,d+p,p);return f?u.reverse():u},k.tickFormat=function(a){return i(a)},k.nice=function(){if(a.length!=2)return this;var c=a[0],d=a[a.length-1],e=d<c,f=e?d:c,h=e?c:d,i=h-f;if(!i||!isFinite(i))return this;var j=Math.pow(10,Math.round(Math.log(i)/Math.log(10))-1);return a=[Math.floor(f/j)*j,Math.ceil(h/j)*j],e&&a.reverse(),b=a.map(g),this},k.by=function(a){function b(){return k(a.apply(this,arguments))}for(var c in k)b[c]=k[c];return b},k.domain.apply(k,arguments),k},pv.Scale.linear=function(){var a=pv.Scale.quantitative();return a.domain.apply(a,arguments),a},pv.Scale.log=function(){var a=pv.Scale.quantitative(1,10),b,c,d=function(a){return Math.log(a)/c},e=function(a){return Math.pow(b,a)};return a.ticks=function(){var c=a.domain(),f=c[0]<0,g=Math.floor(f?-d(-c[0]):d(c[0])),h=Math.ceil(f?-d(-c[1]):d(c[1])),i=[];if(f){i.push(-e(-g));for(;g++<h;)for(var j=b-1;j>0;j--)i.push(-e(-g)*j)}else{for(;g<h;g++)for(var j=1;j<b;j++)i.push(e(g)*j);i.push(e(g))}for(g=0;i[g]<c[0];g++);for(h=i.length;i[h-1]>c[1];h--);return i.slice(g,h)},a.tickFormat=function(a){return a.toPrecision(1)},a.nice=function(){var c=a.domain();return a.domain(pv.logFloor(c[0],b),pv.logCeil(c[1],b))},a.base=function(f){return arguments.length?(b=Number(f),c=Math.log(b),a.transform(d,e),this):b},a.domain.apply(a,arguments),a.base(10)},pv.Scale.root=function(){var a=pv.Scale.quantitative();return a.power=function(b){if(arguments.length){var c=Number(b),d=1/c;return a.transform(function(a){return Math.pow(a,d)},function(a){return Math.pow(a,c)}),this}return c},a.domain.apply(a,arguments),a.power(2)},pv.Scale.ordinal=function(){function e(d){return d in b||(b[d]=a.push(d)-1),c[b[d]%c.length]}var a=[],b={},c=[],d=0;return e.domain=function(c,d){if(arguments.length){c=c instanceof Array?arguments.length>1?pv.map(c,d):c:Array.prototype.slice.call(arguments),a=[];var e={};for(var f=0;f<c.length;f++){var g=c[f];g in e||(e[g]=!0,a.push(g))}return b=pv.numerate(a),this}return a},e.range=function(a,b){return arguments.length?(c=a instanceof Array?arguments.length>1?pv.map(a,b):a:Array.prototype.slice.call(arguments),typeof c[0]=="string"&&(c=c.map(pv.color)),this):c},e.split=function(a,b){var d=(b-a)/this.domain().length;return c=pv.range(a+d/2,b,d),this},e.splitFlush=function(a,b){var d=this.domain().length,e=(b-a)/(d-1);return c=d==1?[(a+b)/2]:pv.range(a,b+e/2,e),this},e.splitBanded=function(a,b,d){arguments.length<3&&(d=1);if(d<0){var e=this.domain().length,f=-d*e,g=b-a-f,h=g/(e+1);c=pv.range(a+h,b,h-d),c.band=-d}else{var i=(b-a)/(this.domain().length+(1-d));c=pv.range(a+i*(1-d),b,i),c.band=i*d}return this},e.by=function(a){function b(){return e(a.apply(this,arguments))}for(var c in e)b[c]=e[c];return b},e.domain.apply(e,arguments),e},pv.Scale.quantile=function(){function f(a){return e(Math.max(0,Math.min(b,pv.search.index(c,a)-1))/b)}var a=-1,b=-1,c=[],d=[],e=pv.Scale.linear();return f.quantiles=function(e){if(arguments.length){a=Number(e);if(a<0)c=[d[0]].concat(d),b=d.length-1;else{c=[],c[0]=d[0];for(var f=1;f<=a;f++)c[f]=d[~~(f*(d.length-1)/a)];b=a-1}return this}return c},f.domain=function(b,c){return arguments.length?(d=b instanceof Array?pv.map(b,c):Array.prototype.slice.call(arguments),d.sort(pv.naturalOrder),f.quantiles(a),this):d},f.range=function(){return arguments.length?(e.range.apply(e,arguments),this):e.range()},f.by=function(a){function b(){return f(a.apply(this,arguments))}for(var c in f)b[c]=f[c];return b},f.domain.apply(f,arguments),f},pv.histogram=function(a,b){var c=!0;return{bins:function(d){var e=pv.map(a,b),g=[];arguments.length||(d=pv.Scale.linear(e).ticks());for(var h=0;h<d.length-1;h++){var i=g[h]=[];i.x=d[h],i.dx=d[h+1]-d[h],i.y=0}for(var h=0;h<e.length;h++){var j=pv.search.index(d,e[h])-1,i=g[Math.max(0,Math.min(g.length-1,j))];i.y++,i.push(a[h])}if(!c)for(var h=0;h<g.length;h++)g[h].y/=e.length;return g},frequency:function(a){return arguments.length?(c=Boolean(a),this):c}}},pv.color=function(a){if(a.rgb)return a.rgb();var b=/([a-z]+)\((.*)\)/i.exec(a);if(b){var c=b[2].split(","),d=1;switch(b[1]){case"hsla":case"rgba":d=parseFloat(c[3]);if(!d)return pv.Color.transparent}switch(b[1]){case"hsla":case"hsl":var e=parseFloat(c[0]),f=parseFloat(c[1])/100,g=parseFloat(c[2])/100;return(new pv.Color.Hsl(e,f,g,d)).rgb();case"rgba":case"rgb":function h(a){var b=parseFloat(a);return a[a.length-1]=="%"?Math.round(b*2.55):b}var i=h(c[0]),j=h(c[1]),k=h(c[2]);return pv.rgb(i,j,k,d)}}var l=pv.Color.names[a];if(l)return l;if(a.charAt(0)=="#"){var i,j,k;return a.length==4?(i=a.charAt(1),i+=i,j=a.charAt(2),j+=j,k=a.charAt(3),k+=k):a.length==7&&(i=a.substring(1,3),j=a.substring(3,5),k=a.substring(5,7)),pv.rgb(parseInt(i,16),parseInt(j,16),parseInt(k,16),1)}return new pv.Color(a,1)},pv.Color=function(a,b){this.color=a,this.opacity=b},pv.Color.prototype.brighter=function(a){return this.rgb().brighter(a)},pv.Color.prototype.darker=function(a){return this.rgb().darker(a)},pv.rgb=function(a,b,c,d){return new pv.Color.Rgb(a,b,c,arguments.length==4?d:1)},pv.Color.Rgb=function(a,b,c,d){pv.Color.call(this,d?"rgb("+a+","+b+","+c+")":"none",d),this.r=a,this.g=b,this.b=c,this.a=d},pv.Color.Rgb.prototype=pv.extend(pv.Color),pv.Color.Rgb.prototype.red=function(a){return pv.rgb(a,this.g,this.b,this.a)},pv.Color.Rgb.prototype.green=function(a){return pv.rgb(this.r,a,this.b,this.a)},pv.Color.Rgb.prototype.blue=function(a){return pv.rgb(this.r,this.g,a,this.a)},pv.Color.Rgb.prototype.alpha=function(a){return pv.rgb(this.r,this.g,this.b,a)},pv.Color.Rgb.prototype.rgb=function(){return this},pv.Color.Rgb.prototype.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return!b&&!c&&!d?pv.rgb(e,e,e,this.a):(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),pv.rgb(Math.min(255,Math.floor(b/a)),Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a)),this.a))},pv.Color.Rgb.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),pv.rgb(Math.max(0,Math.floor(a*this.r)),Math.max(0,Math.floor(a*this.g)),Math.max(0,Math.floor(a*this.b)),this.a)},pv.hsl=function(a,b,c,d){return new pv.Color.Hsl(a,b,c,arguments.length==4?d:1)},pv.Color.Hsl=function(a,b,c,d){pv.Color.call(this,"hsl("+a+","+b*100+"%,"+c*100+"%)",d),this.h=a,this.s=b,this.l=c,this.a=d},pv.Color.Hsl.prototype=pv.extend(pv.Color),pv.Color.Hsl.prototype.hue=function(a){return pv.hsl(a,this.s,this.l,this.a)},pv.Color.Hsl.prototype.saturation=function(a){return pv.hsl(this.h,a,this.l,this.a)},pv.Color.Hsl.prototype.lightness=function(a){return pv.hsl(this.h,this.s,a,this.a)},pv.Color.Hsl.prototype.alpha=function(a){return pv.hsl(this.h,this.s,this.l,a)},pv.Color.Hsl.prototype.rgb=function(){function f(a){return a>360?a-=360:a<0&&(a+=360),a<60?e+(d-e)*a/60:a<180?d:a<240?e+(d-e)*(240-a)/60:e}function g(a){return Math.round(f(a)*255)}var a=this.h,b=this.s,c=this.l;a%=360,a<0&&(a+=360),b=Math.max(0,Math.min(b,1)),c=Math.max(0,Math.min(c,1));var d=c<=.5?c*(1+b):c+b-c*b,e=2*c-d;return pv.rgb(g(a+120),g(a),g(a-120),this.a)},pv.Color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32",transparent:pv.Color.transparent=pv.rgb(0,0,0,0)},function(){var a=pv.Color.names;for(var b in a)a[b]=pv.color(a[b])}(),pv.colors=function(){var a=pv.Scale.ordinal();return a.range.apply(a,arguments),a},pv.Colors={},pv.Colors.category10=function(){var a=pv.colors("#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf");return a.domain.apply(a,arguments),a},pv.Colors.category20=function(){var a=pv.colors("#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5");return a.domain.apply(a,arguments),a},pv.Colors.category19=function(){var a=pv.colors("#9c9ede","#7375b5","#4a5584","#cedb9c","#b5cf6b","#8ca252","#637939","#e7cb94","#e7ba52","#bd9e39","#8c6d31","#e7969c","#d6616b","#ad494a","#843c39","#de9ed6","#ce6dbd","#a55194","#7b4173");return a.domain.apply(a,arguments),a},pv.ramp=function(a,b){var c=pv.Scale.linear();return c.range.apply(c,arguments),c},pv.Scene=pv.SvgScene={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml",scale:1,events:["DOMMouseScroll","mousewheel","mousedown","mouseup","mouseover","mouseout","mousemove","click","dblclick"],implicit:{svg:{"shape-rendering":"auto","pointer-events":"painted",x:0,y:0,dy:0,"text-anchor":"start",transform:"translate(0,0)",fill:"none","fill-opacity":1,stroke:"none","stroke-opacity":1,"stroke-width":1.5,"stroke-linejoin":"miter"},css:{font:"10px sans-serif"}}},pv.SvgScene.updateAll=function(a){if(a.length&&a[0].reverse&&a.type!="line"&&a.type!="area"){var b=pv.extend(a);for(var c=0,d=a.length-1;d>=0;c++,d--)b[c]=a[d];a=b}this.removeSiblings(this[a.type](a))},pv.SvgScene.create=function(a){return document.createElementNS(this.svg,a)},pv.SvgScene.expect=function(a,b,c,d){if(a){a.tagName=="a"&&(a=a.firstChild);if(a.tagName!=b){var e=this.create(b);a.parentNode.replaceChild(e,a),a=e}}else a=this.create(b);for(var f in c){var g=c[f];g==this.implicit.svg[f]&&(g=null),g==null?a.removeAttribute(f):a.setAttribute(f,g)}for(var f in d){var g=d[f];g==this.implicit.css[f]&&(g=null),g==null?a.style.removeProperty(f):a.style[f]=g}return a},pv.SvgScene.append=function(a,b,c){return a.$scene={scenes:b,index:c},a=this.title(a,b[c]),a.parentNode||b.$g.appendChild(a),a.nextSibling},pv.SvgScene.title=function(a,b){var c=a.parentNode;return c&&c.tagName!="a"&&(c=null),b.title?(c||(c=this.create("a"),a.parentNode&&a.parentNode.replaceChild(c,a),c.appendChild(a)),c.setAttributeNS(this.xlink,"title",b.title),c):(c&&c.parentNode.replaceChild(a,c),a)},pv.SvgScene.dispatch=pv.listener(function(a){var b=a.target.$scene;if(b){var c=a.type;switch(c){case"DOMMouseScroll":c="mousewheel",a.wheel=-480*a.detail;break;case"mousewheel":a.wheel=(window.opera?12:1)*a.wheelDelta}pv.Mark.dispatch(c,b.scenes,b.index)&&a.preventDefault()}}),pv.SvgScene.removeSiblings=function(a){while(a){var b=a.nextSibling;a.parentNode.removeChild(a),a=b}},pv.SvgScene.undefined=function(){},pv.SvgScene.pathBasis=function(){function b(a,b,c,d,e){return{x:a[0]*b.left+a[1]*c.left+a[2]*d.left+a[3]*e.left,y:a[0]*b.top+a[1]*c.top+a[2]*d.top+a[3]*e.top}}var a=[[1/6,2/3,1/6,0],[0,2/3,1/3,0],[0,1/3,2/3,0],[0,1/6,2/3,1/6]],c=function(c,d,e,f){var g=b(a[1],c,d,e,f),h=b(a[2],c,d,e,f),i=b(a[3],c,d,e,f);return"C"+g.x+","+g.y+","+h.x+","+h.y+","+i.x+","+i.y};return c.segment=function(c,d,e,f){var g=b(a[0],c,d,e,f),h=b(a[1],c,d,e,f),i=b(a[2],c,d,e,f),j=b(a[3],c,d,e,f);return"M"+g.x+","+g.y+"C"+h.x+","+h.y+","+i.x+","+i.y+","+j.x+","+j.y},c}(),pv.SvgScene.curveBasis=function(a){if(a.length<=2)return"";var b="",c=a[0],d=c,e=c,f=a[1];b+=this.pathBasis(c,d,e,f);for(var g=2;g<a.length;g++)c=d,d=e,e=f,f=a[g],b+=this.pathBasis(c,d,e,f);return b+=this.pathBasis(d,e,f,f),b+=this.pathBasis(e,f,f,f),b},pv.SvgScene.curveBasisSegments=function(a){if(a.length<=2)return"";var b=[],c=a[0],d=c,e=c,f=a[1],g=this.pathBasis.segment(c,d,e,f);c=d,d=e,e=f,f=a[2],b.push(g+this.pathBasis(c,d,e,f));for(var h=3;h<a.length;h++)c=d,d=e,e=f,f=a[h],b.push(this.pathBasis.segment(c,d,e,f));return b.push(this.pathBasis.segment(d,e,f,f)+this.pathBasis(e,f,f,f)),b},pv.SvgScene.curveHermite=function(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return"";var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;c&&(d+="Q"+(f.left-g.x*2/3)+","+(f.top-g.y*2/3)+","+f.left+","+f.top,e=a[1],i=2);if(b.length>1){h=b[1],f=a[i],i++,d+="C"+(e.left+g.x)+","+(e.top+g.y)+","+(f.left-h.x)+","+(f.top-h.y)+","+f.left+","+f.top;for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f.left-h.x)+","+(f.top-h.y)+","+f.left+","+f.top}if(c){var k=a[i];d+="Q"+(f.left+h.x*2/3)+","+(f.top+h.y*2/3)+","+k.left+","+k.top}return d},pv.SvgScene.curveHermiteSegments=function(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return[];var c=a.length!=b.length,d=[],e=a[0],f=e,g=b[0],h=g,i=1;c&&(f=a[1],d.push("M"+e.left+","+e.top+"Q"+(f.left-h.x*2/3)+","+(f.top-h.y*2/3)+","+f.left+","+f.top),i=2);for(var j=1;j<b.length;j++,i++)e=f,g=h,f=a[i],h=b[j],d.push("M"+e.left+","+e.top+"C"+(e.left+g.x)+","+(e.top+g.y)+","+(f.left-h.x)+","+(f.top-h.y)+","+f.left+","+f.top);if(c){var k=a[i];d.push("M"+f.left+","+f.top+"Q"+(f.left+h.x*2/3)+","+(f.top+h.y*2/3)+","+k.left+","+k.top)}return d},pv.SvgScene.cardinalTangents=function(a,b){var c=[],d=(1-b)/2,e=a[0],f=a[1],g=a[2];for(var h=3;h<a.length;h++)c.push({x:d*(g.left-e.left),y:d*(g.top-e.top)}),e=f,f=g,g=a[h];return c.push({x:d*(g.left-e.left),y:d*(g.top-e.top)}),c},pv.SvgScene.curveCardinal=function(a,b){return a.length<=2?"":this.curveHermite(a,this.cardinalTangents(a,b))},pv.SvgScene.curveCardinalSegments=function(a,b){return a.length<=2?"":this.curveHermiteSegments(a,this.cardinalTangents(a,b))},pv.SvgScene.monotoneTangents=function(a){var b=[],c=[],d=[],e=[],f=0;for(f=0;f<a.length-1;f++)c[f]=(a[f+1].top-a[f].top)/(a[f+1].left-a[f].left);d[0]=c[0],e[0]=a[1].left-a[0].left;for(f=1;f<a.length-1;f++)d[f]=(c[f-1]+c[f])/2,e[f]=(a[f+1].left-a[f-1].left)/2;d[f]=c[f-1],e[f]=a[f].left-a[f-1].left;for(f=0;f<a.length-1;f++)c[f]==0&&(d[f]=0,d[f+1]=0);for(f=0;f<a.length-1;f++){if(Math.abs(d[f])<1e-5||Math.abs(d[f+1])<1e-5)continue;var g=d[f]/c[f],h=d[f+1]/c[f],i=g*g+h*h;if(i>9){var j=3/Math.sqrt(i);d[f]=j*g*c[f],d[f+1]=j*h*c[f]}}var k;for(var l=0;l<a.length;l++)k=1+d[l]*d[l],b.push({x:e[l]/3/k,y:d[l]*e[l]/3/k});return b},pv.SvgScene.curveMonotone=function(a){return a.length<=2?"":this.curveHermite(a,this.monotoneTangents(a))},pv.SvgScene.curveMonotoneSegments=function(a){return a.length<=2?"":this.curveHermiteSegments(a,this.monotoneTangents(a))},pv.SvgScene.area=function(a){function f(b,d){var e=[],f=[];for(var g=d;b<=g;b++,d--){var h=a[b],i=a[d],j=h.left+","+h.top,k=i.left+i.width+","+(i.top+i.height);if(b<g){var l=a[b+1],m=a[d-1];switch(c.interpolate){case"step-before":j+="V"+l.top,k+="H"+(m.left+m.width);break;case"step-after":j+="H"+l.left,k+="V"+(m.top+m.height)}}e.push(j),f.push(k)}return e.concat(f).join("L")}function g(b,d){var e=[],f=[],g,h;for(var i=d;b<=i;b++,d--){var j=a[d];e.push(a[b]),f.push({left:j.left+j.width,top:j.top+j.height})}return c.interpolate=="basis"?(g=pv.SvgScene.curveBasis(e),h=pv.SvgScene.curveBasis(f)):c.interpolate=="cardinal"?(g=pv.SvgScene.curveCardinal(e,c.tension),h=pv.SvgScene.curveCardinal(f,c.tension)):(g=pv.SvgScene.curveMonotone(e),h=pv.SvgScene.curveMonotone(f)),e[0].left+","+e[0].top+g+"L"+f[0].left+","+f[0].top+h}var b=a.$g.firstChild;if(!a.length)return b;var c=a[0];if(c.segmented)return this.areaSegment(a);if(!c.visible)return b;var d=c.fillStyle,e=c.strokeStyle;if(!d.opacity&&!e.opacity)return b;var h=[],i,j;for(var k=0;k<a.length;k++){i=a[k];if(!i.width&&!i.height)continue;for(var l=k+1;l<a.length;l++){j=a[l];if(!j.width&&!j.height)break}k&&c.interpolate!="step-after"&&k--,l<a.length&&c.interpolate!="step-before"&&l++,h.push((l-k>2&&(c.interpolate=="basis"||c.interpolate=="cardinal"||c.interpolate=="monotone")?g:f)(k,l-1)),k=l-1}return h.length?(b=this.expect(b,"path",{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,d:"M"+h.join("ZM")+"Z",fill:d.color,"fill-opacity":d.opacity||null,stroke:e.color,"stroke-opacity":e.opacity||null,"stroke-width":e.opacity?c.lineWidth/this.scale:null}),this.append(b,a,0)):b},pv.SvgScene.areaSegment=function(a){var b=a.$g.firstChild,c=a[0],d,e;if(c.interpolate=="basis"||c.interpolate=="cardinal"||c.interpolate=="monotone"){var f=[],g=[];for(var h=0,i=a.length;h<i;h++){var j=a[i-h-1];f.push(a[h]),g.push({left:j.left+j.width,top:j.top+j.height})}c.interpolate=="basis"?(d=this.curveBasisSegments(f),e=this.curveBasisSegments(g)):c.interpolate=="cardinal"?(d=this.curveCardinalSegments(f,c.tension),e=this.curveCardinalSegments(g,c.tension)):(d=this.curveMonotoneSegments(f),e=this.curveMonotoneSegments(g))}for(var h=0,i=a.length-1;h<i;h++){var k=a[h],l=a[h+1];if(!k.visible||!l.visible)continue;var m=k.fillStyle,n=k.strokeStyle;if(!m.opacity&&!n.opacity)continue;var o;if(d){var p=d[h],q="L"+e[i-h-1].substr(1);o=p+q+"Z"}else{var r=k,j=l;switch(k.interpolate){case"step-before":r=l;break;case"step-after":j=k}o="M"+k.left+","+r.top+"L"+l.left+","+j.top+"L"+(l.left+l.width)+","+(j.top+j.height)+"L"+(k.left+k.width)+","+(r.top+r.height)+"Z"}b=this.expect(b,"path",{"shape-rendering":k.antialias?null:"crispEdges","pointer-events":k.events,cursor:k.cursor,d:o,fill:m.color,"fill-opacity":m.opacity||null,stroke:n.color,"stroke-opacity":n.opacity||null,"stroke-width":n.opacity?k.lineWidth/this.scale:null}),b=this.append(b,a,h)}return b},pv.SvgScene.bar=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)continue;b=this.expect(b,"rect",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1e-10,d.width),height:Math.max(1e-10,d.height),fill:e.color,"fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?d.lineWidth/this.scale:null}),b=this.append(b,a,c)}return b},pv.SvgScene.dot=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)continue;var g=d.radius,h=null;switch(d.shape){case"cross":h="M"+ -g+","+ -g+"L"+g+","+g+"M"+g+","+ -g+"L"+ -g+","+g;break;case"triangle":var i=g,j=g*1.1547;h="M0,"+i+"L"+j+","+ -i+" "+ -j+","+ -i+"Z";break;case"diamond":g*=Math.SQRT2,h="M0,"+ -g+"L"+g+",0"+" 0,"+g+" "+ -g+",0"+"Z";break;case"square":h="M"+ -g+","+ -g+"L"+g+","+ -g+" "+g+","+g+" "+ -g+","+g+"Z";break;case"tick":h="M0,0L0,"+ -d.size;break;case"bar":h="M0,"+d.size/2+"L0,"+ -(d.size/2)}var k={"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,fill:e.color,"fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?d.lineWidth/this.scale:null};h?(k.transform="translate("+d.left+","+d.top+")",d.angle&&(k.transform+=" rotate("+180*d.angle/Math.PI+")"),k.d=h,b=this.expect(b,"path",k)):(k.cx=d.left,k.cy=d.top,k.r=g,b=this.expect(b,"circle",k)),b=this.append(b,a,c)}return b},pv.SvgScene.image=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;b=this.fill(b,a,c);if(d.image){b=this.expect(b,"foreignObject",{cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height});var e=b.firstChild||b.appendChild(document.createElementNS(this.xhtml,"canvas"));e.$scene={scenes:a,index:c},e.style.width=d.width,e.style.height=d.height,e.width=d.imageWidth,e.height=d.imageHeight,e.getContext("2d").putImageData(d.image,0,0)}else b=this.expect(b,"image",{preserveAspectRatio:"none",cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height}),b.setAttributeNS(this.xlink,"href",d.url);b=this.append(b,a,c),b=this.stroke(b,a,c)}return b},pv.SvgScene.label=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.textStyle;if(!e.opacity||!d.text)continue;var f=0,g=0,h=0,i="start";switch(d.textBaseline){case"middle":h=".35em";break;case"top":h=".71em",g=d.textMargin;break;case"bottom":g="-"+d.textMargin}switch(d.textAlign){case"right":i="end",f="-"+d.textMargin;break;case"center":i="middle";break;case"left":f=d.textMargin}b=this.expect(b,"text",{"pointer-events":d.events,cursor:d.cursor,x:f,y:g,dy:h,transform:"translate("+d.left+","+d.top+")"+(d.textAngle?" rotate("+180*d.textAngle/Math.PI+")":"")+(this.scale!=1?" scale("+1/this.scale+")":""),fill:e.color,"fill-opacity":e.opacity||null,"text-anchor":i},{font:d.font,"text-shadow":d.textShadow,"text-decoration":d.textDecoration}),b.firstChild?b.firstChild.nodeValue=d.text:b.appendChild(document.createTextNode(d.text)),b=this.append(b,a,c)}return b},pv.SvgScene.line=function(a){var b=a.$g.firstChild;if(a.length<2)return b;var c=a[0];if(c.segmented)return this.lineSegment(a);if(!c.visible)return b;var d=c.fillStyle,e=c.strokeStyle;if(!d.opacity&&!e.opacity)return b;var f="M"+c.left+","+c.top;if(a.length>2&&(c.interpolate=="basis"||c.interpolate=="cardinal"||c.interpolate=="monotone"))switch(c.interpolate){case"basis":f+=this.curveBasis(a);break;case"cardinal":f+=this.curveCardinal(a,c.tension);break;case"monotone":f+=this.curveMonotone(a)}else for(var g=1;g<a.length;g++)f+=this.pathSegment(a[g-1],a[g]);return b=this.expect(b,"path",{"shape-rendering":c.antialias?null:"crispEdges","pointer-events":c.events,cursor:c.cursor,d:f,fill:d.color,"fill-opacity":d.opacity||null,stroke:e.color,"stroke-opacity":e.opacity||null,"stroke-width":e.opacity?c.lineWidth/this.scale:null,"stroke-linejoin":c.lineJoin}),this.append(b,a,0)},pv.SvgScene.lineSegment=function(a){var b=a.$g.firstChild,c=a[0],d;switch(c.interpolate){case"basis":d=this.curveBasisSegments(a);break;case"cardinal":d=this.curveCardinalSegments(a,c.tension);break;case"monotone":d=this.curveMonotoneSegments(a)}for(var e=0,f=a.length-1;e<f;e++){var g=a[e],h=a[e+1];if(!g.visible||!h.visible)continue;var i=g.strokeStyle,j=pv.Color.transparent;if(!i.opacity)continue;var k;g.interpolate=="linear"&&g.lineJoin=="miter"?(j=i,i=pv.Color.transparent,k=this.pathJoin(a[e-1],g,h,a[e+2])):d?k=d[e]:k="M"+g.left+","+g.top+this.pathSegment(g,h),b=this.expect(b,"path",{"shape-rendering":g.antialias?null:"crispEdges","pointer-events":g.events,cursor:g.cursor,d:k,fill:j.color,"fill-opacity":j.opacity||null,stroke:i.color,"stroke-opacity":i.opacity||null,"stroke-width":i.opacity?g.lineWidth/this.scale:null,"stroke-linejoin":g.lineJoin}),b=this.append(b,a,e)}return b},pv.SvgScene.pathSegment=function(a,b){var c=1;switch(a.interpolate){case"polar-reverse":c=0;case"polar":var d=b.left-a.left,e=b.top-a.top,f=1-a.eccentricity,g=Math.sqrt(d*d+e*e)/(2*f);if(f<=0||f>1)break;return"A"+g+","+g+" 0 0,"+c+" "+b.left+","+b.top;case"step-before":return"V"+b.top+"H"+b.left;case"step-after":return"H"+b.left+"V"+b.top}return"L"+b.left+","+b.top},pv.SvgScene.lineIntersect=function(a,b,c,d){return a.plus(b.times(c.minus(a).dot(d.perp())/b.dot(d.perp())))},pv.SvgScene.pathJoin=function(a,b,c,d){var e=pv.vector(b.left,b.top),f=pv.vector(c.left,c.top),g=f.minus(e),h=g.perp().norm(),i=h.times(b.lineWidth/(2*this.scale)),j=e.plus(i),k=f.plus(i),l=f.minus(i),m=e.minus(i);if(a&&a.visible){var n=e.minus(a.left,a.top).perp().norm().plus(h);m=this.lineIntersect(e,n,m,g),j=this.lineIntersect(e,n,j,g)}if(d&&d.visible){var o=pv.vector(d.left,d.top).minus(f).perp().norm().plus(h);l=this.lineIntersect(f,o,l,g),k=this.lineIntersect(f,o,k,g)}return"M"+j.x+","+j.y+"L"+k.x+","+k.y+" "+l.x+","+l.y+" "+m.x+","+m.y},pv.SvgScene.panel=function(a){var b=a.$g,c=b&&b.firstChild;for(var d=0;d<a.length;d++){var e=a[d];if(!e.visible)continue;if(!a.parent){e.canvas.style.display="inline-block",b&&b.parentNode!=e.canvas&&(b=e.canvas.firstChild,c=b&&b.firstChild);if(!b){b=e.canvas.appendChild(this.create("svg")),b.setAttribute("font-size","10px"),b.setAttribute("font-family","sans-serif"),b.setAttribute("fill","none"),b.setAttribute("stroke","none"),b.setAttribute("stroke-width",1.5);for(var f=0;f<this.events.length;f++)b.addEventListener(this.events[f],this.dispatch,!1);c=b.firstChild}a.$g=b,b.setAttribute("width",e.width+e.left+e.right),b.setAttribute("height",e.height+e.top+e.bottom)}if(e.overflow=="hidden"){var g=pv.id().toString(36),h=this.expect(c,"g",{"clip-path":"url(#"+g+")"});h.parentNode||b.appendChild(h),a.$g=b=h,c=h.firstChild,c=this.expect(c,"clipPath",{id:g});var i=c.firstChild||c.appendChild(this.create("rect"));i.setAttribute("x",e.left),i.setAttribute("y",e.top),i.setAttribute("width",e.width),i.setAttribute("height",e.height),c.parentNode||b.appendChild(c),c=c.nextSibling}c=this.fill(c,a,d);var j=this.scale,k=e.transform,l=e.left+k.x,m=e.top+k.y;this.scale*=k.k;for(var f=0;f<e.children.length;f++)e.children[f].$g=c=this.expect(c,"g",{transform:"translate("+l+","+m+")"+(k.k!=1?" scale("+k.k+")":"")}),this.updateAll(e.children[f]),c.parentNode||b.appendChild(c),c=c.nextSibling;this.scale=j,c=this.stroke(c,a,d),e.overflow=="hidden"&&(a.$g=b=h.parentNode,c=h.nextSibling)}return c},pv.SvgScene.fill=function(a,b,c){var d=b[c],e=d.fillStyle;if(e.opacity||d.events=="all")a=this.expect(a,"rect",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x:d.left,y:d.top,width:d.width,height:d.height,fill:e.color,"fill-opacity":e.opacity,stroke:null}),a=this.append(a,b,c);return a},pv.SvgScene.stroke=function(a,b,c){var d=b[c],e=d.strokeStyle;if(e.opacity||d.events=="all")a=this.expect(a,"rect",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events=="all"?"stroke":d.events,cursor:d.cursor,x:d.left,y:d.top,width:Math.max(1e-10,d.width),height:Math.max(1e-10,d.height),fill:null,stroke:e.color,"stroke-opacity":e.opacity,"stroke-width":d.lineWidth/this.scale}),a=this.append(a,b,c);return a},pv.SvgScene.rule=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.strokeStyle;if(!e.opacity)continue;b=this.expect(b,"line",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,x1:d.left,y1:d.top,x2:d.left+d.width,y2:d.top+d.height,stroke:e.color,"stroke-opacity":e.opacity,"stroke-width":d.lineWidth/this.scale}),b=this.append(b,a,c)}return b},pv.SvgScene.wedge=function(a){var b=a.$g.firstChild;for(var c=0;c<a.length;c++){var d=a[c];if(!d.visible)continue;var e=d.fillStyle,f=d.strokeStyle;if(!e.opacity&&!f.opacity)continue;var g=d.innerRadius,h=d.outerRadius,i=Math.abs(d.angle),j;if(i>=2*Math.PI)g?j="M0,"+h+"A"+h+","+h+" 0 1,1 0,"+ -h+"A"+h+","+h+" 0 1,1 0,"+h+"M0,"+g+"A"+g+","+g+" 0 1,1 0,"+ -g+"A"+g+","+g+" 0 1,1 0,"+g+"Z":j="M0,"+h+"A"+h+","+h+" 0 1,1 0,"+ -h+"A"+h+","+h+" 0 1,1 0,"+h+"Z";else{var k=Math.min(d.startAngle,d.endAngle),l=Math.max(d.startAngle,d.endAngle),m=Math.cos(k),n=Math.cos(l),o=Math.sin(k),p=Math.sin(l);g?j="M"+h*m+","+h*o+"A"+h+","+h+" 0 "+(i<Math.PI?"0":"1")+",1 "+h*n+","+h*p+"L"+g*n+","+g*p+"A"+g+","+g+" 0 "+(i<Math.PI?"0":"1")+",0 "+g*m+","+g*o+"Z":j="M"+h*m+","+h*o+"A"+h+","+h+" 0 "+(i<Math.PI?"0":"1")+",1 "+h*n+","+h*p+"L0,0Z"}b=this.expect(b,"path",{"shape-rendering":d.antialias?null:"crispEdges","pointer-events":d.events,cursor:d.cursor,transform:"translate("+d.left+","+d.top+")",d:j,fill:e.color,"fill-rule":"evenodd","fill-opacity":e.opacity||null,stroke:f.color,"stroke-opacity":f.opacity||null,"stroke-width":f.opacity?d.lineWidth/this.scale:null}),b=this.append(b,a,c)}return b},pv.Mark=function(){this.$properties=[],this.$handlers={}},pv.Mark.prototype.properties={},pv.Mark.cast={},pv.Mark.prototype.property=function(a,b){return this.hasOwnProperty("properties")||(this.properties=pv.extend(this.properties)),this.properties[a]=!0,pv.Mark.prototype.propertyMethod(a,!1,pv.Mark.cast[a]=b),this},pv.Mark.prototype.propertyMethod=function(a,b,c){c||(c=pv.Mark.cast[a]),this[a]=function(d){if(b&&this.scene){var e=this.scene.defs;return arguments.length?(e[a]={id:d==null?0:pv.id(),value:d!=null&&c?c(d):d},this):e[a]?e[a].value:null}if(arguments.length){var f=!b<<1|typeof d=="function";return this.propertyValue(a,f&1&&c?function(){var a=d.apply(this,arguments);return a!=null?c(a):null}:d!=null&&c?c(d):d).type=f,this}return this.instance()[a]}},pv.Mark.prototype.propertyValue=function(a,b){var c=this.$properties,d={name:a,id:pv.id(),value:b};for(var e=0;e<c.length;e++)if(c[e].name==a){c.splice(e,1);break}return c.push(d),d},pv.Mark.prototype.property("data").property("visible",Boolean).property("left",Number).property("right",Number).property("top",Number).property("bottom",Number).property("cursor",String).property("title",String).property("reverse",Boolean).property("antialias",Boolean).property("events",String),pv.Mark.prototype.childIndex=-1,pv.Mark.prototype.index=-1,pv.Mark.prototype.scale=1,pv.Mark.prototype.defaults=(new pv.Mark).data(function(a){return[a]}).visible(!0).antialias(!0).events("painted"),pv.Mark.prototype.extend=function(a){return this.proto=a,this},pv.Mark.prototype.add=function(a){return this.parent.add(a).extend(this)},pv.Mark.prototype.def=function(a,b){return this.propertyMethod(a,!0),this[a](arguments.length>1?b:null)},pv.Mark.prototype.anchor=function(a){function d(a){var d=b,e=[];while(!(c=d.scene))a=a.parent,e.push({index:a.index,childIndex:d.childIndex}),d=d.parent;while(e.length){var f=e.pop();c=c[f.index].children[f.childIndex]}if(b.hasOwnProperty("index")){var g=pv.extend(c[b.index]);return g.right=g.top=g.left=g.bottom=0,[g]}return c}var b=this,c;return a||(a="center"),(new pv.Anchor(this)).name(a).def("$mark.anchor",function(){c=this.scene.target=d(this)}).data(function(){return c.map(function(a){return a.data})}).visible(function(){return c[this.index].visible}).left(function(){var a=c[this.index],b=a.width||0;switch(this.name()){case"bottom":case"top":case"center":return a.left+b/2;case"left":return null}return a.left+b}).top(function(){var a=c[this.index],b=a.height||0;switch(this.name()){case"left":case"right":case"center":return a.top+b/2;case"top":return null}return a.top+b}).right(function(){var a=c[this.index];return this.name()=="left"?a.right+(a.width||0):null}).bottom(function(){var a=c[this.index];return this.name()=="top"?a.bottom+(a.height||0):null}).textAlign(function(){switch(this.name()){case"bottom":case"top":case"center":return"center";case"right":return"right"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"top"}return"bottom"})},pv.Mark.prototype.anchorTarget=function(){return this.proto.anchorTarget()},pv.Mark.prototype.margin=function(a){return this.left(a).right(a).top(a).bottom(a)},pv.Mark.prototype.instance=function(a){var b=this.scene||this.parent.instance(-1).children[this.childIndex],c=!arguments.length||this.hasOwnProperty("index")?this.index:a;return b[c<0?b.length-1:c]},pv.Mark.prototype.first=function(){return this.scene[0]},pv.Mark.prototype.last=function(){return this.scene[this.scene.length-1]},pv.Mark.prototype.sibling=function(){return this.index==0?null:this.scene[this.index-1]},pv.Mark.prototype.cousin=function(){var a=this.parent,b=a&&a.sibling();return b&&b.children?b.children[this.childIndex][this.index]:null},pv.Mark.prototype.render=function(){function e(a,d,e){a.scale=e;if(d<c.length){b.unshift(null);if(a.hasOwnProperty("index"))f(a,d,e);else{for(var g=0,h=a.scene.length;g<h;g++)a.index=g,f(a,d,e);delete a.index}b.shift()}else a.build(),pv.Scene.scale=e,pv.Scene.updateAll(a.scene);delete a.scale}function f(a,d,f){var g=a.scene[a.index],h;if(g.visible){var i=c[d],j=a.children[i];for(h=0;h<i;h++)a.children[h].scene=g.children[h];b[0]=g.data,j.scene?e(j,d+1,f*g.transform.k):(j.scene=g.children[i],e(j,d+1,f*g.transform.k),delete j.scene);for(h=0;h<i;h++)delete a.children[h].scene}}var a=this.parent,b=pv.Mark.stack;if(a&&!this.root.scene){this.root.render();return}var c=[];for(var d=this;d.parent;d=d.parent)c.unshift(d.childIndex);this.bind();while(a&&!a.hasOwnProperty("index"))a=a.parent;this.context(a?a.scene:undefined,a?a.index:-1,function(){e(this.root,0,1)})},pv.Mark.stack=[],pv.Mark.prototype.bind=function(){function e(e){do{var f=e.$properties;for(var g=f.length-1;g>=0;g--){var h=f[g];if(!(h.name in a)){a[h.name]=h;switch(h.name){case"data":c=h;break;case"visible":d=h;break;default:b[h.type].push(h)}}}}while(e=e.proto)}var a={},b=[[],[],[],[]],c,d;e(this),e(this.defaults),b[1].reverse(),b[3].reverse();var f=this;do for(var g in f.properties)g in a||b[2].push(a[g]={name:g,type:2,value:null});while(f=f.proto);var h=b[0].concat(b[1]);for(var i=0;i<h.length;i++)this.propertyMethod(h[i].name,!0);this.binds={properties:a,data:c,defs:h,required:[d],optional:pv.blend(b)}},pv.Mark.prototype.build=function(){var a=this.scene,b=pv.Mark.stack;a||(a=this.scene=[],a.mark=this,a.type=this.type,a.childIndex=this.childIndex,this.parent&&(a.parent=this.parent.scene,a.parentIndex=this.parent.index));if(this.binds.defs.length){var c=a.defs;c||(a.defs=c={});for(var d=0;d<this.binds.defs.length;d++){var e=this.binds.defs[d],f=c[e.name];if(!f||e.id>f.id)c[e.name]={id:0,value:e.type&1?e.value.apply(this,b):e.value}}}var g=this.binds.data;g=g.type&1?g.value.apply(this,b):g.value,b.unshift(null),a.length=g.length;for(var d=0;d<g.length;d++){pv.Mark.prototype.index=this.index=d;var h=a[d];h||(a[d]=h={}),h.data=b[0]=g[d],this.buildInstance(h)}return pv.Mark.prototype.index=-1,delete this.index,b.shift(),this},pv.Mark.prototype.buildProperties=function(a,b){for(var c=0,d=b.length;c<d;c++){var e=b[c],f=e.value;switch(e.type){case 0:case 1:f=this.scene.defs[e.name].value;break;case 3:f=f.apply(this,pv.Mark.stack)}a[e.name]=f}},pv.Mark.prototype.buildInstance=function(a){this.buildProperties(a,this.binds.required),a.visible&&(this.buildProperties(a,this.binds.optional),this.buildImplied(a))},pv.Mark.prototype.buildImplied=function(a){var b=a.left,c=a.right,d=a.top,e=a.bottom,f=this.properties,g=f.width?a.width:0,h=f.height?a.height:0,i=this.parent?this.parent.width():g+b+c;g==null?g=i-(c=c||0)-(b=b||0):c==null?c=i-g-(b=b||0):b==null&&(b=i-g-(c=c||0));var j=this.parent?this.parent.height():h+d+e;h==null?h=j-(d=d||0)-(e=e||0):e==null?e=j-h-(d=d||0):d==null&&(d=j-h-(e=e||0)),a.left=b,a.right=c,a.top=d,a.bottom=e,f.width&&(a.width=g),f.height&&(a.height=h),f.textStyle&&!a.textStyle&&(a.textStyle=pv.Color.transparent),f.fillStyle&&!a.fillStyle&&(a.fillStyle=pv.Color.transparent),f.strokeStyle&&!a.strokeStyle&&(a.strokeStyle=pv.Color.transparent)},pv.Mark.prototype.mouse=function(){var a=pv.event.pageX||0,b=pv.event.pageY||0,c=this.root.canvas();do a-=c.offsetLeft,b-=c.offsetTop;while(c=c.offsetParent);var d=pv.Transform.identity,e=this.properties.transform?this:this.parent,f=[];do f.push(e);while(e=e.parent);while(e=f.pop())d=d.translate(e.left(),e.top()).times(e.transform());return d=d.invert(),pv.vector(a*d.k+d.x,b*d.k+d.y)},pv.Mark.prototype.event=function(a,b){return this.$handlers[a]=pv.functor(b),this},pv.Mark.prototype.context=function(a,b,c){function h(a,b){pv.Mark.scene=a,d.index=b;if(!a)return;var c=a.mark,f=c,g=[];do g.push(f),e.push(a[b].data),f.index=b,f.scene=a,b=a.parentIndex,a=a.parent;while(f=f.parent);for(var h=g.length-1,i=1;h>0;h--)f=g[h],f.scale=i,i*=f.scene[f.index].transform.k;if(c.children)for(var h=0,j=c.children.length;h<j;h++)f=c.children[h],f.scene=c.scene[c.index].children[h],f.scale=i}function i(a,b){if(!a)return;var c=a.mark,d;if(c.children)for(var f=0,g=c.children.length;f<g;f++)d=c.children[f],delete d.scene,delete d.scale;d=c;do e.pop(),d.parent&&(delete d.scene,delete d.scale),delete d.index;while(d=d.parent)}var d=pv.Mark.prototype,e=pv.Mark.stack,f=pv.Mark.scene,g=d.index;i(f,g),h(a,b);try{c.apply(this,e)}finally{i(a,b),h(f,g)}},pv.Mark.dispatch=function(a,b,c){var d=b.mark,e=b.parent,f=d.$handlers[a];return f?(d.context(b,c,function(){d=f.apply(d,pv.Mark.stack),d&&d.render&&d.render()}),!0):e&&pv.Mark.dispatch(a,e,b.parentIndex)},pv.Anchor=function(a){pv.Mark.call(this),this.target=a,this.parent=a.parent},pv.Anchor.prototype=pv.extend(pv.Mark).property("name",String),pv.Anchor.prototype.anchorTarget=function(){return this.target},pv.Area=function(){pv.Mark.call(this)},pv.Area.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.color).property("fillStyle",pv.color).property("segmented",Boolean).property("interpolate",String).property("tension",Number),pv.Area.prototype.type="area",pv.Area.prototype.defaults=(new pv.Area).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)).interpolate("linear").tension(.7),pv.Area.prototype.buildImplied=function(a){a.height==null&&(a.height=0),a.width==null&&(a.width=0),pv.Mark.prototype.buildImplied.call(this,a)},pv.Area.fixed={lineWidth:1,lineJoin:1,strokeStyle:1,fillStyle:1,segmented:1,interpolate:1,tension:1},pv.Area.prototype.bind=function(){pv.Mark.prototype.bind.call(this);var a=this.binds,b=a.required,c=a.optional;for(var d=0,e=c.length;d<e;d++){var f=c[d];f.fixed=f.name in pv.Area.fixed,f.name=="segmented"&&(b.push(f),c.splice(d,1),d--,e--)}this.binds.$required=b,this.binds.$optional=c},pv.Area.prototype.buildInstance=function(a){var b=this.binds;if(this.index){var c=b.fixed;if(!c){c=b.fixed=[];function d(a){return!a.fixed||(c.push(a),!1)}b.required=b.required.filter(d),this.scene[0].segmented||(b.optional=b.optional.filter(d))}for(var e=0,f=c.length;e<f;e++){var g=c[e].name;a[g]=this.scene[0][g]}}else b.required=b.$required,b.optional=b.$optional,b.fixed=null;pv.Mark.prototype.buildInstance.call(this,a)},pv.Area.prototype.anchor=function(a){var b;return pv.Mark.prototype.anchor.call(this,a).def("$area.anchor",function(){b=this.scene.target}).interpolate(function(){return b[this.index].interpolate}).eccentricity(function(){return b[this.index].eccentricity}).tension(function(){return b[this.index].tension})},pv.Bar=function(){pv.Mark.call(this)},pv.Bar.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.color).property("fillStyle",pv.color),pv.Bar.prototype.type="bar",pv.Bar.prototype.defaults=(new pv.Bar).extend(pv.Mark.prototype.defaults).lineWidth(1.5).fillStyle(pv.Colors.category20().by(pv.parent)),pv.Dot=function(){pv.Mark.call(this)},pv.Dot.prototype=pv.extend(pv.Mark).property("size",Number).property("radius",Number).property("shape",String).property("angle",Number).property("lineWidth",Number).property("strokeStyle",pv.color).property("fillStyle",pv.color),pv.Dot.prototype.type="dot",pv.Dot.prototype.defaults=(new pv.Dot).extend(pv.Mark.prototype.defaults).size(20).shape("circle").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)),pv.Dot.prototype.anchor=function(a){var b;return pv.Mark.prototype.anchor.call(this,a).def("$wedge.anchor",function(){b=this.scene.target}).left(function(){var a=b[this.index];switch(this.name()){case"bottom":case"top":case"center":return a.left;case"left":return null}return a.left+a.radius}).right(function(){var a=b[this.index];return this.name()=="left"?a.right+a.radius:null}).top(function(){var a=b[this.index];switch(this.name()){case"left":case"right":case"center":return a.top;case"top":return null}return a.top+a.radius}).bottom(function(){var a=b[this.index];return this.name()=="top"?a.bottom+a.radius:null}).textAlign(function(){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center"}return"left"}).textBaseline(function(){switch(this.name()){case"right":case"left":case"center":return"middle";case"bottom":return"top"}return"bottom"})},pv.Dot.prototype.buildImplied=function(a){a.radius==null?a.radius=Math.sqrt(a.size):a.size==null&&(a.size=a.radius*a.radius),pv.Mark.prototype.buildImplied.call(this,a)},pv.Label=function(){pv.Mark.call(this)},pv.Label.prototype=pv.extend(pv.Mark).property("text",String).property("font",String).property("textAngle",Number).property("textStyle",pv.color).property("textAlign",String).property("textBaseline",String).property("textMargin",Number).property("textDecoration",String).property("textShadow",String),pv.Label.prototype.type="label",pv.Label.prototype.defaults=(new pv.Label).extend(pv.Mark.prototype.defaults).events("none").text(pv.identity).font("10px sans-serif").textAngle(0).textStyle("black").textAlign("left").textBaseline("bottom").textMargin(3),pv.Line=function(){pv.Mark.call(this)},pv.Line.prototype=pv.extend(pv.Mark).property("lineWidth",Number).property("lineJoin",String).property("strokeStyle",pv.color).property("fillStyle",pv.color).property("segmented",Boolean).property("interpolate",String).property("eccentricity",Number).property("tension",Number),pv.Line.prototype.type="line",pv.Line.prototype.defaults=(new pv.Line).extend(pv.Mark.prototype.defaults).lineJoin("miter").lineWidth(1.5).strokeStyle(pv.Colors.category10().by(pv.parent)).interpolate("linear").eccentricity(0).tension(.7),pv.Line.prototype.bind=pv.Area.prototype.bind,pv.Line.prototype.buildInstance=pv.Area.prototype.buildInstance,pv.Line.prototype.anchor=function(a){return pv.Area.prototype.anchor.call(this,a).textAlign(function(a){switch(this.name()){case"left":return"right";case"bottom":case"top":case"center":return"center";case"right":return"left"}}).textBaseline(function(a){switch(this.name()){case"right":case"left":case"center":return"middle";case"top":return"bottom";case"bottom":return"top"}})},pv.Rule=function(){pv.Mark.call(this)},pv.Rule.prototype=pv.extend(pv.Mark).property("width",Number).property("height",Number).property("lineWidth",Number).property("strokeStyle",pv.color),pv.Rule.prototype.type="rule",pv.Rule.prototype.defaults=(new pv.Rule).extend(pv.Mark.prototype.defaults).lineWidth(1).strokeStyle("black").antialias(!1),pv.Rule.prototype.anchor=pv.Line.prototype.anchor,pv.Rule.prototype.buildImplied=function(a){var b=a.left,c=a.right,d=a.top,e=a.bottom;a.width!=null||b==null&&c==null||c!=null&&b!=null?a.height=0:a.width=0,pv.Mark.prototype.buildImplied.call(this,a)},pv.Panel=function(){pv.Bar.call(this),this.children=[],this.root=this,this.$dom=pv.$&&pv.$.s},pv.Panel.prototype=pv.extend(pv.Bar).property("transform").property("overflow",String).property("canvas",function(a){return typeof a=="string"?document.getElementById(a):a}),pv.Panel.prototype.type="panel",pv.Panel.prototype.defaults=(new pv.Panel).extend(pv.Bar.prototype.defaults).fillStyle(null).overflow("visible"),pv.Panel.prototype.anchor=function(a){var b=pv.Bar.prototype.anchor.call(this,a);return b.parent=this,b},pv.Panel.prototype.add=function(a){var b=new a;return b.parent=this,b.root=this.root,b.childIndex=this.children.length,this.children.push(b),b},pv.Panel.prototype.bind=function(){pv.Mark.prototype.bind.call(this);for(var a=0;a<this.children.length;a++)this.children[a].bind()},pv.Panel.prototype.buildInstance=function(a){pv.Bar.prototype.buildInstance.call(this,a);if(!a.visible)return;a.children||(a.children=[]);var b=this.scale*a.transform.k,c,d=this.children.length;pv.Mark.prototype.index=-1;for(var e=0;e<d;e++)c=this.children[e],c.scene=a.children[e],c.scale=b,c.build();for(var e=0;e<d;e++)c=this.children[e],a.children[e]=c.scene,delete c.scene,delete c.scale;a.children.length=d},pv.Panel.prototype.buildImplied=function(a){if(!this.parent){var b=a.canvas;if(b){if(b.$panel!=this){b.$panel=this;while(b.lastChild)b.removeChild(b.lastChild)}var c,d;a.width==null&&(c=parseFloat(pv.css(b,"width")),a.width=c-a.left-a.right),a.height==null&&(d=parseFloat(pv.css(b,"height")),a.height=d-a.top-a.bottom)}else{var e=this.$canvas||(this.$canvas=[]);if(!(b=e[this.index])){b=e[this.index]=document.createElement("span");if(this.$dom)this.$dom.parentNode.insertBefore(b,this.$dom);else{var f=document.body;while(f.lastChild&&f.lastChild.tagName)f=f.lastChild;f!=document.body&&(f=f.parentNode),f.appendChild(b)}}}a.canvas=b}a.transform||(a.transform=pv.Transform.identity),pv.Mark.prototype.buildImplied.call(this,a)},pv.Image=function(){pv.Bar.call(this)},pv.Image.prototype=pv.extend(pv.Bar).property("url",String).property("imageWidth",Number).property("imageHeight",Number),pv.Image.prototype.type="image",pv.Image.prototype.defaults=(new pv.Image).extend(pv.Bar.prototype.defaults).fillStyle(null),pv.Image.prototype.image=function(a){return this.$image=function(){var b=a.apply(this,arguments);return b==null?pv.Color.transparent:typeof b=="string"?pv.color(b):b},this},pv.Image.prototype.bind=function(){pv.Bar.prototype.bind.call(this);var a=this.binds,b=this;do a.image=b.$image;while(!a.image&&(b=b.proto))},pv.Image.prototype.buildImplied=function(a){pv.Bar.prototype.buildImplied.call(this,a);if(!a.visible)return;a.imageWidth==null&&(a.imageWidth=a.width),a.imageHeight==null&&(a.imageHeight=a.height);if(a.url==null&&this.binds.image){var b=this.$canvas||(this.$canvas=document.createElement("canvas")),c=b.getContext("2d"),d=a.imageWidth,e=a.imageHeight,f=pv.Mark.stack,g;b.width=d,b.height=e,g=(a.image=c.createImageData(d,e)).data,f.unshift(null,null);for(var h=0,i=0;h<e;h++){f[1]=h;for(var j=0;j<d;j++){f[0]=j;var k=this.binds.image.apply(this,f);g[i++]=k.r,g[i++]=k.g,g[i++]=k.b,g[i++]=255*k.a}}f.splice(0,2)}},pv.Wedge=function(){pv.Mark.call(this)},pv.Wedge.prototype=pv.extend(pv.Mark).property("startAngle",Number).property("endAngle",Number).property("angle",Number).property("innerRadius",Number).property("outerRadius",Number).property("lineWidth",Number).property("strokeStyle",pv.color).property("fillStyle",pv.color),pv.Wedge.prototype.type="wedge",pv.Wedge.prototype.defaults=(new pv.Wedge).extend(pv.Mark.prototype.defaults).startAngle(function(){var a=this.sibling();return a?a.endAngle:-Math.PI/2}).innerRadius(0).lineWidth(1.5).strokeStyle(null).fillStyle(pv.Colors.category20().by(pv.index)),pv.Wedge.prototype.midRadius=function(){return(this.innerRadius()+this.outerRadius())/2},pv.Wedge.prototype.midAngle=function(){return(this.startAngle()+this.endAngle())/2},pv.Wedge.prototype.anchor=function(a){function b(a){return a.innerRadius||a.angle<2*Math.PI}function c(a){return(a.innerRadius+a.outerRadius)/2}function d(a){return(a.startAngle+a.endAngle)/2}var e;return pv.Mark.prototype.anchor.call(this,a).def("$wedge.anchor",function(){e=this.scene.target}).left(function(){var a=e[this.index];if(b(a))switch(this.name()){case"outer":return a.left+a.outerRadius*Math.cos(d(a));case"inner":return a.left+a.innerRadius*Math.cos(d(a));case"start":return a.left+c(a)*Math.cos(a.startAngle);case"center":return a.left+c(a)*Math.cos(d(a));case"end":return a.left+c(a)*Math.cos(a.endAngle)}return a.left}).top(function(){var a=e[this.index];if(b(a))switch(this.name()){case"outer":return a.top+a.outerRadius*Math.sin(d(a));case"inner":return a.top+a.innerRadius*Math.sin(d(a));case"start":return a.top+c(a)*Math.sin(a.startAngle);case"center":return a.top+c(a)*Math.sin(d(a));case"end":return a.top+c(a)*Math.sin(a.endAngle)}return a.top}).textAlign(function(){var a=e[this.index];if(b(a))switch(this.name()){case"outer":return pv.Wedge.upright(d(a))?"right":"left";case"inner":return pv.Wedge.upright(d(a))?"left":"right"}return"center"}).textBaseline(function(){var a=e[this.index];if(b(a))switch(this.name()){case"start":return pv.Wedge.upright(a.startAngle)?"top":"bottom";case"end":return pv.Wedge.upright(a.endAngle)?"bottom":"top"}return"middle"}).textAngle(function(){var a=e[this.index],c=0;if(b(a))switch(this.name()){case"center":case"inner":case"outer":c=d(a);break;case"start":c=a.startAngle;break;case"end":c=a.endAngle}return pv.Wedge.upright(c)?c:c+Math.PI})},pv.Wedge.upright=function(a){return a%=2*Math.PI,a=a<0?2*Math.PI+a:a,a<Math.PI/2||a>=3*Math.PI/2},pv.Wedge.prototype.buildImplied=function(a){a.angle==null?a.angle=a.endAngle-a.startAngle:a.endAngle==null&&(a.endAngle=a.startAngle+a.angle),pv.Mark.prototype.buildImplied.call(this,a)},pv.simulation=function(a){return new pv.Simulation(a)},pv.Simulation=function(a){for(var b=0;b<a.length;b++)this.particle(a[b])},pv.Simulation.prototype.particle=function(a){return a.next=this.particles,isNaN(a.px)&&(a.px=a.x),isNaN(a.py)&&(a.py=a.y),isNaN(a.fx)&&(a.fx=0),isNaN(a.fy)&&(a.fy=0),this.particles=a,this},pv.Simulation.prototype.force=function(a){return a.next=this.forces,this.forces=a,this},pv.Simulation.prototype.constraint=function(a){return a.next=this.constraints,this.constraints=a,this},pv.Simulation.prototype.stabilize=function(a){var b;arguments.length||(a=3);for(var c=0;c<a;c++){var d=new pv.Quadtree(this.particles);for(b=this.constraints;b;b=b.next)b.apply(this.particles,d)}for(var e=this.particles;e;e=e.next)e.px=e.x,e.py=e.y;return this},pv.Simulation.prototype.step=function(){var a,b,c;for(a=this.particles;a;a=a.next){var d=a.px,e=a.py;a.px=a.x,a.py=a.y,a.x+=a.vx=a.x-d+a.fx,a.y+=a.vy=a.y-e+a.fy}var f=new pv.Quadtree(this.particles);for(c=this.constraints;c;c=c.next)c.apply(this.particles,f);for(a=this.particles;a;a=a.next)a.fx=a.fy=0;for(b=this.forces;b;b=b.next)b.apply(this.particles,f)},pv.Quadtree=function(a){function i(a,b,c,d,e,f){if(isNaN(b.x)||isNaN(b.y))return;if(a.leaf)if(a.p)if(Math.abs(a.p.x-b.x)+Math.abs(a.p.y-b.y)<.01)j(a,b,c,d,e,f);else{var g=a.p;a.p=null,j(a,g,c,d,e,f),j(a,b,c,d,e,f)}else a.p=b;else j(a,b,c,d,e,f)}function j(a,b,c,d,e,f){var g=(c+e)*.5,h=(d+f)*.5,j=b.x>=g,k=b.y>=h;a.leaf=!1;switch((k<<1)+j){case 0:a=a.c1||(a.c1=new pv.Quadtree.Node);break;case 1:a=a.c2||(a.c2=new pv.Quadtree.Node);break;case 2:a=a.c3||(a.c3=new pv.Quadtree.Node);break;case 3:a=a.c4||(a.c4=new pv.Quadtree.Node)}j?c=g:e=g,k?d=h:f=h,i(a,b,c,d,e,f)}var b,c=Number.POSITIVE_INFINITY,d=c,e=Number.NEGATIVE_INFINITY,f=e;for(b=a;b;b=b.next)b.x<c&&(c=b.x),b.y<d&&(d=b.y),b.x>e&&(e=b.x),b.y>f&&(f=b.y);var g=e-c,h=f-d;g>h?f=d+g:e=c+h,this.xMin=c,this.yMin=d,this.xMax=e,this.yMax=f,this.root=new pv.Quadtree.Node;for(b=a;b;b=b.next)i(this.root,b,c,d,e,f)},pv.Quadtree.Node=function(){this.leaf=!0,this.c1=null,this.c2=null,this.c3=null,this.c4=null,this.p=null},pv.Force={},pv.Force.charge=function(a){function h(b){function e(a){h(a),b.cn+=a.cn,c+=a.cn*a.cx,d+=a.cn*a.cy}var c=0,d=0;b.cn=0,b.leaf||(b.c1&&e(b.c1),b.c2&&e(b.c2),b.c3&&e(b.c3),b.c4&&e(b.c4)),b.p&&(b.cn+=a,c+=a*b.p.x,d+=a*b.p.y),b.cx=c/b.cn,b.cy=d/b.cn}function i(b,d,g,h,j,l){var m=b.cx-d.x,n=b.cy-d.y,o=1/Math.sqrt(m*m+n*n);if(b.leaf&&b.p!=d||(j-g)*o<f){if(o<e)return;o>c&&(o=c);var p=b.cn*o*o*o,q=m*p,r=n*p;d.fx+=q,d.fy+=r}else if(!b.leaf){var s=(g+j)*.5,t=(h+l)*.5;b.c1&&i(b.c1,d,g,h,s,t),b.c2&&i(b.c2,d,s,h,j,t),b.c3&&i(b.c3,d,g,t,s,l),b.c4&&i(b.c4,d,s,t,j,l);if(o<e)return;o>c&&(o=c);if(b.p&&b.p!=d){var p=a*o*o*o,q=m*p,r=n*p;d.fx+=q,d.fy+=r}}}var b=2,c=1/b,d=500,e=1/d,f=.9,g={};return arguments.length||(a=-40),g.constant=function(b){return arguments.length?(a=Number(b),g):a},g.domain=function(a,f){return arguments.length?(b=Number(a),c=1/b,d=Number(f),e=1/d,g):[b,d]},g.theta=function(a){return arguments.length?(f=Number(a),g):f},g.apply=function(a,b){h(b.root);for(var c=a;c;c=c.next)i(b.root,c,b.xMin,b.yMin,b.xMax,b.yMax)},g},pv.Force.drag=function(a){var b={};return arguments.length||(a=.1),b.constant=function(c){return arguments.length?(a=c,b):a},b.apply=function(b){if(a)for(var c=b;c;c=c.next)c.fx-=a*c.vx,c.fy-=a*c.vy},b},pv.Force.spring=function(a){var b=.1,c=20,d,e,f={};return arguments.length||(a=.1),f.links=function(a){return arguments.length?(d=a,e=a.map(function(a){return 1/Math.sqrt(Math.max(a.sourceNode.linkDegree,a.targetNode.linkDegree))}),f):d},f.constant=function(b){return arguments.length?(a=Number(b),f):a},f.damping=function(a){return arguments.length?(b=Number(a),f):b},f.length=function(a){return arguments.length?(c=Number(a),f):c},f.apply=function(f){for(var g=0;g<d.length;g++){var h=d[g].sourceNode,i=d[g].targetNode,j=h.x-i.x,m=h.y-i.y,n=Math.sqrt(j*j+m*m),o=n?1/n:1,p=a*e[g],q=b*e[g],r=(p*(n-c)+q*(j*(h.vx-i.vx)+m*(h.vy-i.vy))*o)*o,s=-r*(n?j:.01*(.5-Math.random())),t=-r*(n?m:.01*(.5-Math.random()));h.fx+=s,h.fy+=t,i.fx-=s,i.fy-=t}},f},pv.Constraint={},pv.Constraint.collision=function(a){function i(b,h,j,k,l,m){if(!b.leaf){var n=(j+l)*.5,o=(k+m)*.5,p=o>e,q=o<g,r=n>d,s=n<f;p&&(b.c1&&r&&i(b.c1,h,j,k,n,o),b.c2&&s&&i(b.c2,h,n,k,l,o)),q&&(b.c3&&r&&i(b.c3,h,j,o,n,m),b.c4&&s&&i(b.c4,h,n,o,l,m))}if(b.p&&b.p!=h){var t=h.x-b.p.x,u=h.y-b.p.y,v=Math.sqrt(t*t+u*u),w=c+a(b.p);if(v<w){var x=(v-w)/v*.5;t*=x,u*=x,h.x-=t,h.y-=u,b.p.x+=t,b.p.y+=u}}}var b=1,c,d,e,f,g,h={};return arguments.length||(c=10),h.repeat=function(a){return arguments.length?(b=Number(a),h):b},h.apply=function(h,j){var k,l,m=-Infinity;for(k=h;k;k=k.next)l=a(k),l>m&&(m=l);for(var o=0;o<b;o++)for(k=h;k;k=k.next)l=(c=a(k))+m,d=k.x-l,f=k.x+l,e=k.y-l,g=k.y+l,i(j.root,k,j.xMin,j.yMin,j.xMax,j.yMax)},h},pv.Constraint.position=function(a){var b=1,c={};return arguments.length||(a=function(a){return a.fix}),c.alpha=function(a){return arguments.length?(b=Number(a),c):b},c.apply=function(c){for(var d=c;d;d=d.next){var e=a(d);e&&(d.x+=(e.x-d.x)*b,d.y+=(e.y-d.y)*b,d.fx=d.fy=d.vx=d.vy=0)}},c},pv.Constraint.bound=function(){var a={},b,c;return a.x=function(a,c){return arguments.length?(b={min:Math.min(a,c),max:Math.max(a,c)},this):b},a.y=function(a,b){return arguments.length?(c={min:Math.min(a,b),max:Math.max(a,b)},this):c},a.apply=function(a){if(b)for(var d=a;d;d=d.next)d.x=d.x<b.min?b.min:d.x>b.max?b.max:d.x;if(c)for(var d=a;d;d=d.next)d.y=d.y<c.min?c.min:d.y>c.max?c.max:d.y},a},pv.Layout=function(){pv.Panel.call(this)},pv.Layout.prototype=pv.extend(pv.Panel),pv.Layout.prototype.property=function(a,b){return this.hasOwnProperty("properties")||(this.properties=pv.extend(this.properties)),this.properties[a]=!0,this.propertyMethod(a,!1,pv.Mark.cast[a]=b),this},pv.Layout.Network=function(){pv.Layout.call(this);var a=this;this.$id=pv.id(),(this.node=(new pv.Mark).data(function(){return a.nodes()}).strokeStyle("#1f77b4").fillStyle("#fff").left(function(a){return a.x}).top(function(a){return a.y})).parent=this,this.link=(new pv.Mark).extend(this.node).data(function(a){return[a.sourceNode,a.targetNode]}).fillStyle(null).lineWidth(function(a,b){return b.linkValue*1.5}).strokeStyle("rgba(0,0,0,.2)"),this.link.add=function(b){return a.add(pv.Panel).data(function(){return a.links()}).add(b).extend(this)},(this.label=(new pv.Mark).extend(this.node).textMargin(7).textBaseline("middle").text(function(a){return a.nodeName||a.nodeValue}).textAngle(function(a){var b=a.midAngle;return pv.Wedge.upright(b)?b:b+Math.PI}).textAlign(function(a){return pv.Wedge.upright(a.midAngle)?"left":"right"})).parent=this},pv.Layout.Network.prototype=pv.extend(pv.Layout).property("nodes",function(a){return a.map(function(a,b){return typeof a!="object"&&(a={nodeValue:a}),a.index=b,a.linkDegree=0,a})}).property("links",function(a){return a.map(function(a){return isNaN(a.linkValue)&&(a.linkValue=isNaN(a.value)?1:a.value),a})}),pv.Layout.Network.prototype.reset=function(){return this.$id=pv.id(),this},pv.Layout.Network.prototype.buildProperties=function(a,b){(a.$id||0)<this.$id&&pv.Layout.prototype.buildProperties.call(this,a,b)},pv.Layout.Network.prototype.buildImplied=function(a){pv.Layout.prototype.buildImplied.call(this,a);if(a.$id>=this.$id)return!0;a.$id=this.$id,a.links.forEach(function(b){var c=b.linkValue;(b.sourceNode||(b.sourceNode=a.nodes[b.source])).linkDegree+=c,(b.targetNode||(b.targetNode=a.nodes[b.target])).linkDegree+=c})},pv.Layout.Hierarchy=function(){pv.Layout.Network.call(this),this.link.strokeStyle("#ccc")},pv.Layout.Hierarchy.prototype=pv.extend(pv.Layout.Network),pv.Layout.Hierarchy.prototype.buildImplied=function(a){a.links||(a.links=pv.Layout.Hierarchy.links.call(this)),pv.Layout.Network.prototype.buildImplied.call(this,a)},pv.Layout.Hierarchy.links=function(){return this.nodes().filter(function(a){return a.parentNode}).map(function(a){return{sourceNode:a,targetNode:a.parentNode,linkValue:1}})},pv.Layout.Hierarchy.NodeLink={buildImplied:function(a){function i(a){return a.parentNode?a.depth*(h-g)+g:0}function j(a){return a.parentNode?(a.breadth-.25)*2*Math.PI:0}function k(a){switch(c){case"left":return a.depth*e;case"right":return e-a.depth*e;case"top":return a.breadth*e;case"bottom":return e-a.breadth*e;case"radial":return e/2+i(a)*Math.cos(a.midAngle)}}function l(a){switch(c){case"left":return a.breadth*f;case"right":return f-a.breadth*f;case"top":return a.depth*f;case"bottom":return f-a.depth*f;case"radial":return f/2+i(a)*Math.sin(a.midAngle)}}var b=a.nodes,c=a.orient,d=/^(top|bottom)$/.test(c),e=a.width,f=a.height;if(c=="radial"){var g=a.innerRadius,h=a.outerRadius;g==null&&(g=0),h==null&&(h=Math.min(e,f)/2)}for(var m=0;m<b.length;m++){var n=b[m];n.midAngle=c=="radial"?j(n):d?Math.PI/2:0,n.x=k(n),n.y=l(n),n.firstChild&&(n.midAngle+=Math.PI)}}},pv.Layout.Hierarchy.Fill={constructor:function(){this.node.strokeStyle("#fff").fillStyle("#ccc").width(function(a){return a.dx}).height(function(a){return a.dy}).innerRadius(function(a){return a.innerRadius}).outerRadius(function(a){return a.outerRadius}).startAngle(function(a){return a.startAngle}).angle(function(a){return a.angle}),this.label.textAlign("center").left(function(a){return a.x+a.dx/2}).top(function(a){return a.y+a.dy/2}),delete this.link},buildImplied:function(a){function j(a,b){return(a+b)/(1+b)}function k(a){switch(c){case"left":return j(a.minDepth,g)*e;case"right":return(1-j(a.maxDepth,g))*e;case"top":return a.minBreadth*e;case"bottom":return(1-a.maxBreadth)*e;case"radial":return e/2}}function l(a){switch(c){case"left":return a.minBreadth*f;case"right":return(1-a.maxBreadth)*f;case"top":return j(a.minDepth,g)*f;case"bottom":return(1-j(a.maxDepth,g))*f;case"radial":return f/2}}function m(a){switch(c){case"left":case"right":return(a.maxDepth-a.minDepth)/(1+g)*e;case"top":case"bottom":return(a.maxBreadth-a.minBreadth)*e;case"radial":return a.parentNode?(a.innerRadius+a.outerRadius)*Math.cos(a.midAngle):0}}function n(a){switch(c){case"left":case"right":return(a.maxBreadth-a.minBreadth)*f;case"top":case"bottom":return(a.maxDepth-a.minDepth)/(1+g)*f;case"radial":return a.parentNode?(a.innerRadius+a.outerRadius)*Math.sin(a.midAngle):0}}function o(a){return Math.max(0,j(a.minDepth,g/2))*(i-h)+h}function p(a){return j(a.maxDepth,g/2)*(i-h)+h}function q(a){return(a.parentNode?a.minBreadth-.25:0)*2*Math.PI}function r(a){return(a.parentNode?a.maxBreadth-a.minBreadth:1)*2*Math.PI}var b=a.nodes,c=a.orient,d=/^(top|bottom)$/.test(c),e=a.width,f=a.height,g=-b[0].minDepth;if(c=="radial"){var h=a.innerRadius,i=a.outerRadius;h==null&&(h=0),h&&(g*=2),i==null&&(i=Math.min(e,f)/2)}for(var s=0;s<b.length;s++){var t=b[s];t.x=k(t),t.y=l(t),c=="radial"?(t.innerRadius=o(t),t.outerRadius=p(t),t.startAngle=q(t),t.angle=r(t),t.midAngle=t.startAngle+t.angle/2):t.midAngle=d?-Math.PI/2:0,t.dx=m(t),t.dy=n(t)}}},pv.Layout.Grid=function(){pv.Layout.call(this);var a=this;(this.cell=(new pv.Mark).data(function(){return a.scene[a.index].$grid}).width(function(){return a.width()/a.cols()}).height(function(){return a.height()/a.rows()}).left(function(){return this.width()*(this.index%a.cols())}).top(function(){return this.height()*Math.floor(this.index/a.cols())})).parent=this},pv.Layout.Grid.prototype=pv.extend(pv.Layout).property("rows").property("cols"),pv.Layout.Grid.prototype.defaults=(new pv.Layout.Grid).extend(pv.Layout.prototype.defaults).rows(1).cols(1),pv.Layout.Grid.prototype.buildImplied=function(a){pv.Layout.prototype.buildImplied.call(this,a);var b=a.rows,c=a.cols;typeof c=="object"&&(b=pv.transpose(c)),typeof b=="object"?(a.$grid=pv.blend(b),a.rows=b.length,a.cols=b[0]?b[0].length:0):a.$grid=pv.repeat([a.data],b*c)},pv.Layout.Stack=function(){function f(a){return function(){return c[a](this.parent.index,this.index)}}pv.Layout.call(this);var a=this,b=function(){return null},c={t:b,l:b,r:b,b:b,w:b,h:b},d,e=a.buildImplied;this.buildImplied=function(a){e.call(this,a);var f=a.layers,g=f.length,h,i=a.orient,j=/^(top|bottom)\b/.test(i),k=this.parent[j?"height":"width"](),l=[],m=[],n=[],o=pv.Mark.stack,p={parent:{parent:this}};o.unshift(null),d=[];for(var q=0;q<g;q++){n[q]=[],m[q]=[],p.parent.index=q,o[0]=f[q],d[q]=this.$values.apply(p.parent,o),q||(h=d[q].length),o.unshift(null);for(var r=0;r<h;r++)o[0]=d[q][r],p.index=r,q||(l[r]=this.$x.apply(p,o)),n[q][r]=this.$y.apply(p,o);o.shift()}o.shift();var s;switch(a.order){case"inside-out":var t=n.map(function(a){return pv.max.index(a)}),u=pv.range(g).sort(function(a,b){return t[a]-t[b]}),v=n.map(function(a){return pv.sum(a)}),w=0,x=0,y=[],z=[];for(var q=0;q<g;q++){var r=u[q];w<x?(w+=v[r],y.push(r)):(x+=v[r],z.push(r))}s=z.reverse().concat(y);break;case"reverse":s=pv.range(g-1,-1,-1);break;default:s=pv.range(g)}switch(a.offset){case"silohouette":for(var r=0;r<h;r++){var p=0;for(var q=0;q<g;q++)p+=n[q][r];m[s[0]][r]=(k-p)/2}break;case"wiggle":var p=0;for(var q=0;q<g;q++)p+=n[q][0];m[s[0]][0]=p=(k-p)/2;for(var r=1;r<h;r++){var A=0,B=0,C=l[r]-l[r-1];for(var q=0;q<g;q++)A+=n[q][r];for(var q=0;q<g;q++){var D=(n[s[q]][r]-n[s[q]][r-1])/(2*C);for(var E=0;E<q;E++)D+=(n[s[E]][r]-n[s[E]][r-1])/C;B+=D*n[s[q]][r]}m[s[0]][r]=p-=A?B/A*C:0}break;case"expand":for(var r=0;r<h;r++){m[s[0]][r]=0;var E=0;for(var q=0;q<g;q++)E+=n[q][r];if(E){E=k/E;for(var q=0;q<g;q++)n[q][r]*=E}else{E=k/g;for(var q=0;q<g;q++)n[q][r]=E}}break;default:for(var r=0;r<h;r++)m[s[0]][r]=0}for(var r=0;r<h;r++){var p=m[s[0]][r];for(var q=1;q<g;q++)p+=n[s[q-1]][r],m[s[q]][r]=p}var q=i.indexOf("-"),F=j?"h":"w",G=q<0?j?"l":"b":i.charAt(q+1),H=i.charAt(0);for(var I in c)c[I]=b;c[G]=function(a,b){return l[b]},c[H]=function(a,b){return m[a][b]},c[F]=function(a,b){return n[a][b]}},this.layer=(new pv.Mark).data(function(){return d[this.parent.index]}).top(f("t")).left(f("l")).right(f("r")).bottom(f("b")).width(f("w")).height(f("h")),this.layer.add=function(b){return a.add(pv.Panel).data(function(){return a.layers()}).add(b).extend(this)}},pv.Layout.Stack.prototype=pv.extend(pv.Layout).property("orient",String).property("offset",String).property("order",String).property("layers"),pv.Layout.Stack.prototype.defaults=(new pv.Layout.Stack).extend(pv.Layout.prototype.defaults).orient("bottom-left").offset("zero").layers([[]]),pv.Layout.Stack.prototype.$x=pv.Layout.Stack.prototype.$y=function(){return 0},pv.Layout.Stack.prototype.x=function(a){return this.$x=pv.functor(a),this},pv.Layout.Stack.prototype.y=function(a){return this.$y=pv.functor(a),this},pv.Layout.Stack.prototype.$values=pv.identity,pv.Layout.Stack.prototype.values=function(a){return this.$values=pv.functor(a),this},pv.Layout.Treemap=function(){pv.Layout.Hierarchy.call(this),this.node.strokeStyle("#fff").fillStyle("rgba(31, 119, 180, .25)").width(function(a){return a.dx}).height(function(a){return a.dy}),this.label.visible(function(a){return!a.firstChild}).left(function(a){return a.x+a.dx/2}).top(function(a){return a.y+a.dy/2}).textAlign("center").textAngle(function(a){return a.dx>a.dy?0:-Math.PI/2}),(this.leaf=(new pv.Mark).extend(this.node).fillStyle(null).strokeStyle(null).visible(function(a){return!a.firstChild})).parent=this,delete this.link},pv.Layout.Treemap.prototype=pv.extend(pv.Layout.Hierarchy).property("round",Boolean).property("paddingLeft",Number).property("paddingRight",Number).property("paddingTop",Number).property("paddingBottom",Number).property("mode",String).property("order",String),pv.Layout.Treemap.prototype.defaults=(new pv.Layout.Treemap).extend(pv.Layout.Hierarchy.prototype.defaults).mode("squarify").order("ascending"),pv.Layout.Treemap.prototype.padding=function(a){return this.paddingLeft(a).paddingRight(a).paddingTop(a).paddingBottom(a)},pv.Layout.Treemap.prototype.$size=function(a){return Number(a.nodeValue)},pv.Layout.Treemap.prototype.size=function(a){return this.$size=pv.functor(a),this},pv.Layout.Treemap.prototype.buildImplied=function(a){function m(a,b,c,d,e,f,g){for(var h=0,i=0;h<a.length;h++){var j=a[h];c?(j.x=d+i,j.y=e,i+=j.dx=k(f*j.size/b),j.dy=g):(j.x=d,j.y=e+i,j.dx=f,i+=j.dy=k(g*j.size/b))}j&&(c?j.dx+=f-i:j.dy+=g-i)}function n(a,b){var c=-Infinity,d=Infinity,e=0;for(var f=0;f<a.length;f++){var g=a[f].size;g<d&&(d=g),g>c&&(c=g),e+=g}return e*=e,b*=b,Math.max(b*c/e,e/(b*d))}function o(a,b){function t(a){var b=e==r,f=pv.sum(a,j),g=r?k(f/r):0;return m(a,f,b,c,d,b?e:g,b?g:o),b?(d+=g,o-=g):(c+=g,e-=g),r=Math.min(e,o),b}var c=a.x+f,d=a.y+h,e=a.dx-f-g,o=a.dy-h-i;if(l!="squarify"){m(a.childNodes,a.size,l=="slice"?!0:l=="dice"?!1:b&1,c,d,e,o);return}var p=[],q=Infinity,r=Math.min(e,o),s=e*o/a.size;if(a.size<=0)return;a.visitBefore(function(a){a.size*=s});var u=a.childNodes.slice();while(u.length){var v=u[u.length-1];if(!v.size){u.pop();continue}p.push(v);var s=n(p,r);s<=q?(u.pop(),q=s):(p.pop(),t(p),p.length=0,q=Infinity)}if(t(p))for(var b=0;b<p.length;b++)p[b].dy+=o;else for(var b=0;b<p.length;b++)p[b].dx+=e}if(pv.Layout.Hierarchy.prototype.buildImplied.call(this,a))return;var b=this,c=a.nodes,d=c[0],e=pv.Mark.stack,f=a.paddingLeft,g=a.paddingRight,h=a.paddingTop,i=a.paddingBottom,j=function(a){return a.size},k=a.round?Math.round:Number,l=a.mode;e.unshift(null),d.visitAfter(function(a,c){a.depth=c,a.x=a.y=a.dx=a.dy=0,a.size=a.firstChild?pv.sum(a.childNodes,function(a){return a.size}):b.$size.apply(b,(e[0]=a,e))}),e.shift();switch(a.order){case"ascending":d.sort(function(a,b){return a.size-b.size});break;case"descending":d.sort(function(a,b){return b.size-a.size});break;case"reverse":d.reverse()}d.x=0,d.y=0,d.dx=a.width,d.dy=a.height,d.visitBefore(o)},pv.Layout.Tree=function(){pv.Layout.Hierarchy.call(this)},pv.Layout.Tree.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("breadth",Number).property("depth",Number).property("orient",String),pv.Layout.Tree.prototype.defaults=(new pv.Layout.Tree).extend(pv.Layout.Hierarchy.prototype.defaults).group(1).breadth(15).depth(60).orient("top"),pv.Layout.Tree.prototype.buildImplied=function(a){function i(a){var b,c,d;if(!a.firstChild){if(b=a.previousSibling)a.prelim=b.prelim+q(a.depth,!0)}else{b=a.firstChild,c=a.lastChild,d=b;for(var e=b;e;e=e.nextSibling)i(e),d=k(e,d);o(a);var f=.5*(b.prelim+c.prelim);(b=a.previousSibling)?(a.prelim=b.prelim+q(a.depth,!0),a.mod=a.prelim-f):a.prelim=f}}function j(a,b,c){a.breadth=a.prelim+b,b+=a.mod;for(var d=a.firstChild;d;d=d.nextSibling)j(d,b,c)}function k(a,b){var c=a.previousSibling;if(c){var d=a,e=a,f=c,g=a.parentNode.firstChild,h=d.mod,i=e.mod,j=f.mod,k=g.mod,o=m(f),r=l(d);while(o&&r){f=o,d=r,g=l(g),e=m(e),e.ancestor=a;var s=f.prelim+j-(d.prelim+h)+q(f.depth,!1);s>0&&(n(p(f,a,b),a,s),h+=s,i+=s),j+=f.mod,h+=d.mod,k+=g.mod,i+=e.mod,o=m(f),r=l(d)}o&&!m(e)&&(e.thread=o,e.mod+=j-i),r&&!l(g)&&(g.thread=r,g.mod+=h-k,b=a)}return b}function l(a){return a.firstChild||a.thread}function m(a){return a.lastChild||a.thread}function n(a,b,c){var d=b.number-a.number;b.change-=c/d,b.shift+=c,a.change+=c/d,b.prelim+=c,b.mod+=c}function o(a){var b=0,c=0;for(var d=a.lastChild;d;d=d.previousSibling)d.prelim+=b,d.mod+=b,c+=d.change,b+=d.shift+c}function p(a,b,c){return a.ancestor.parentNode==b.parentNode?a.ancestor:c}function q(a,b){return(b?1:f+1)/(c=="radial"?a:1)}function s(a){return c=="radial"?a.breadth/d:0}function t(a){switch(c){case"left":return a.depth;case"right":return g-a.depth;case"top":case"bottom":return a.breadth+g/2;case"radial":return g/2+a.depth*Math.cos(s(a))}}function u(a){switch(c){case"left":case"right":return a.breadth+h/2;case"top":return a.depth;case"bottom":return h-a.depth;case"radial":return h/2+a.depth*Math.sin(s(a))}}if(pv.Layout.Hierarchy.prototype.buildImplied.call(this,a))return;var b=a.nodes,c=a.orient,d=a.depth,e=a.breadth,f=a.group,g=a.width,h=a.height,r=b[0];r.visitAfter(function(a,b){a.ancestor=a,a.prelim=0,a.mod=0,a.change=0,a.shift=0,a.number=a.previousSibling?a.previousSibling.number+1:0,a.depth=b}),i(r),j(r,-r.prelim,0),r.visitAfter(function(a){a.breadth*=e,a.depth*=d,a.midAngle=s(a),a.x=t(a),a.y=u(a),a.firstChild&&(a.midAngle+=Math.PI),delete a.breadth,delete a.depth,delete a.ancestor,delete a.prelim,delete a.mod,delete a.change,delete a.shift,delete a.number,delete a.thread})},pv.Layout.Indent=function(){pv.Layout.Hierarchy.call(this),this.link.interpolate("step-after")},pv.Layout.Indent.prototype=pv.extend(pv.Layout.Hierarchy).property("depth",Number).property("breadth",Number),pv.Layout.Indent.prototype.defaults=(new pv.Layout.Indent).extend(pv.Layout.Hierarchy.prototype.defaults).depth(15).breadth(15),pv.Layout.Indent.prototype.buildImplied=function(a){function g(a,b,h){a.x=e+h++*d,a.y=f+b++*c,a.midAngle=0;for(var i=a.firstChild;i;i=i.nextSibling)b=g(i,b,h);return b}if(pv.Layout.Hierarchy.prototype.buildImplied.call(this,a))return;var b=a.nodes,c=a.breadth,d=a.depth,e=0,f=0;g(b[0],1,1)},pv.Layout.Pack=function(){pv.Layout.Hierarchy.call(this),this.node.radius(function(a){return a.radius}).strokeStyle("rgb(31, 119, 180)").fillStyle("rgba(31, 119, 180, .25)"),this.label.textAlign("center"),delete this.link},pv.Layout.Pack.prototype=pv.extend(pv.Layout.Hierarchy).property("spacing",Number).property("order",String),pv.Layout.Pack.prototype.defaults=(new pv.Layout.Pack).extend(pv.Layout.Hierarchy.prototype.defaults).spacing(1).order("ascending"),pv.Layout.Pack.prototype.$radius=function(){return 1},pv.Layout.Pack.prototype.size=function(a){return this.$radius=typeof a=="function"?function(){return Math.sqrt(a.apply(this,arguments))}:(a=Math.sqrt(a),function(){return a}),this},pv.Layout.Pack.prototype.buildImplied=function(a){function e(a){var c=pv.Mark.stack;c.unshift(null);for(var d=0,e=a.length;d<e;d++){var f=a[d];f.firstChild||(f.radius=b.$radius.apply(b,(c[0]=f,c)))}c.shift()}function f(b){var c=[];for(var d=b.firstChild;d;d=d.nextSibling)d.firstChild&&(d.radius=f(d)),d.n=d.p=d,c.push(d);switch(a.order){case"ascending":c.sort(function(a,b){return a.radius-b.radius});break;case"descending":c.sort(function(a,b){return b.radius-a.radius});break;case"reverse":c.reverse()}return g(c)}function g(b){function m(a){c=Math.min(a.x-a.radius,c),d=Math.max(a.x+a.radius,d),e=Math.min(a.y-a.radius,e),f=Math.max(a.y+a.radius,f)}function n(a,b){var c=a.n;a.n=b,b.p=a,b.n=c,c.p=b}function o(a,b){a.n=b,b.p=a}function p(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.radius+b.radius;return e*e-c*c-d*d>.001}var c=Infinity,d=-Infinity,e=Infinity,f=-Infinity,g,i,j,k,l;g=b[0],g.x=-g.radius,g.y=0,m(g);if(b.length>1){i=b[1],i.x=i.radius,i.y=0,m(i);if(b.length>2){j=b[2],h(g,i,j),m(j),n(g,j),g.p=j,n(j,i),i=g.n;for(var q=3;q<b.length;q++){h(g,i,j=b[q]);var r=0,t=1,u=1;for(k=i.n;k!=i;k=k.n,t++)if(p(k,j)){r=1;break}if(r==1)for(l=g.p;l!=k.p;l=l.p,u++)if(p(l,j)){u<t&&(r=-1,k=l);break}r==0?(n(g,j),i=j,m(j)):r>0?(o(g,k),i=k,q--):r<0&&(o(k,i),g=k,q--)}}}var v=(c+d)/2,w=(e+f)/2,x=0;for(var q=0;q<b.length;q++){var y=b[q];y.x-=v,y.y-=w,x=Math.max(x,y.radius+Math.sqrt(y.x*y.x+y.y*y.y))}return x+a.spacing}function h(a,b,c){var d=b.radius+c.radius,e=a.radius+c.radius,f=b.x-a.x,g=b.y-a.y,h=Math.sqrt(f*f+g*g),i=(e*e+h*h-d*d)/(2*e*h),j=Math.acos(i),k=i*e,l=Math.sin(j)*e;f/=h,g/=h,c.x=a.x+k*f+l*g,c.y=a.y+k*g-l*f}function i(a,b,c,d){for(var e=a.firstChild;e;e=e.nextSibling)e.x+=a.x,e.y+=a.y,i(e,b,c,d);a.x=b+d*a.x,a.y=c+d*a.y,a.radius*=d}if(pv.Layout.Hierarchy.prototype.buildImplied.call(this,a))return;var b=this,c=a.nodes,d=c[0];e(c),d.x=0,d.y=0,d.radius=f(d);var j=this.width(),k=this.height(),l=1/Math.max(2*d.radius/j,2*d.radius/k);i(d,j/2,k/2,l)},pv.Layout.Force=function(){pv.Layout.Network.call(this),this.link.lineWidth(function(a,b){return Math.sqrt(b.linkValue)*1.5}),this.label.textAlign("center")},pv.Layout.Force.prototype=pv.extend(pv.Layout.Network).property("bound",Boolean).property("iterations",Number).property("dragConstant",Number).property("chargeConstant",Number).property("chargeMinDistance",Number).property("chargeMaxDistance",Number).property("chargeTheta",Number).property("springConstant",Number).property("springDamping",Number).property("springLength",Number),pv.Layout.Force.prototype.defaults=(new pv.Layout.Force).extend(pv.Layout.Network.prototype.defaults).dragConstant(.1).chargeConstant(-40).chargeMinDistance(2).chargeMaxDistance(500).chargeTheta(.9).springConstant(.1).springDamping(.3).springLength(20),pv.Layout.Force.prototype.buildImplied=function(a){function l(a){return a.fix?1:a.vx*a.vx+a.vy*a.vy}if(pv.Layout.Network.prototype.buildImplied.call(this,a)){var b=a.$force;b&&(b.next=this.binds.$force,this.binds.$force=b);return}var c=this,d=a.nodes,e=a.links,f=a.iterations,g=a.width,h=a.height;for(var i=0,j;i<d.length;i++)j=d[i],isNaN(j.x)&&(j.x=g/2+40*Math.random()-20),isNaN(j.y)&&(j.y=h/2+40*Math.random()-20);var k=pv.simulation(d);k.force(pv.Force.drag(a.dragConstant)),k.force(pv.Force.charge(a.chargeConstant).domain(a.chargeMinDistance,a.chargeMaxDistance).theta(a.chargeTheta)),k.force(pv.Force.spring(a.springConstant).damping(a.springDamping).length(a.springLength).links(e)),k.constraint(pv.Constraint.position()),a.bound&&k.constraint(pv.Constraint.bound().x(6,g-6).y(6,h-6));if(f==null){k.step(),k.step();var m=a.$force=this.binds.$force={next:this.binds.$force,nodes:d,min:1e-4*(e.length+1),sim:k};this.$timer||(this.$timer=setInterval(function(){var a=!1;for(var b=c.binds.$force;b;b=b.next)pv.max(b.nodes,l)>b.min&&(b.sim.step(),a=!0);a&&c.render()},42))}else for(var i=0;i<f;i++)k.step()},pv.Layout.Cluster=function(){pv.Layout.Hierarchy.call(this);var a,b=this.buildImplied;this.buildImplied=function(c){b.call(this,c),a=/^(top|bottom)$/.test(c.orient)?"step-before":/^(left|right)$/.test(c.orient)?"step-after":"linear"},this.link.interpolate(function(){return a})},pv.Layout.Cluster.prototype=pv.extend(pv.Layout.Hierarchy).property("group",Number).property("orient",String).property("innerRadius",Number).property("outerRadius",Number),pv.Layout.Cluster.prototype.defaults=(new pv.Layout.Cluster).extend(pv.Layout.Hierarchy.prototype.defaults).group(0).orient("top"),pv.Layout.Cluster.prototype.buildImplied=function(a){if(pv.Layout.Hierarchy.prototype.buildImplied.call(this,a))return;var b=a.nodes[0],c=a.group,d,e,f=0,g=.5-c/2,h=undefined;b.visitAfter(function(a){a.firstChild?a.depth=1+pv.max(a.childNodes,function(a){return a.depth}):(c&&h!=a.parentNode&&(h=a.parentNode,f+=c),f++,a.depth=0)}),d=1/f,e=1/b.depth;var h=undefined;b.visitAfter(function(a){a.firstChild?a.breadth=pv.mean(a.childNodes,function(a){return a.breadth}):(c&&h!=a.parentNode&&(h=a.parentNode,g+=c),a.breadth=d*g++),a.depth=1-a.depth*e}),b.visitAfter(function(a){a.minBreadth=a.firstChild?a.firstChild.minBreadth:a.breadth-d/2,a.maxBreadth=a.firstChild?a.lastChild.maxBreadth:a.breadth+d/2}),b.visitBefore(function(a){a.minDepth=a.parentNode?a.parentNode.maxDepth:0,a.maxDepth=a.parentNode?a.depth+b.depth:a.minDepth+2*b.depth}),b.minDepth=-e,pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,a)},pv.Layout.Cluster.Fill=function(){pv.Layout.Cluster.call(this),pv.Layout.Hierarchy.Fill.constructor.call(this)},pv.Layout.Cluster.Fill.prototype=pv.extend(pv.Layout.Cluster),pv.Layout.Cluster.Fill.prototype.buildImplied=function(a){if(pv.Layout.Cluster.prototype.buildImplied.call(this,a))return;pv.Layout.Hierarchy.Fill.buildImplied.call(this,a)},pv.Layout.Partition=function(){pv.Layout.Hierarchy.call(this)},pv.Layout.Partition.prototype=pv.extend(pv.Layout.Hierarchy).property("order",String).property("orient",String).property("innerRadius",Number).property("outerRadius",Number),pv.Layout.Partition.prototype.defaults=(new pv.Layout.Partition).extend(pv.Layout.Hierarchy.prototype.defaults).orient("top"),pv.Layout.Partition.prototype.$size=function(){return 1},pv.Layout.Partition.prototype.size=function(a){return this.$size=a,this},pv.Layout.Partition.prototype.buildImplied=function(a){if(pv.Layout.Hierarchy.prototype.buildImplied.call(this,a))return;var b=this,c=a.nodes[0],d=pv.Mark.stack,e=0;d.unshift(null),c.visitAfter(function(a,c){c>e&&(e=c),a.size=a.firstChild?pv.sum(a.childNodes,function(a){return a.size}):b.$size.apply(b,(d[0]=a,d))}),d.shift();switch(a.order){case"ascending":c.sort(function(a,b){return a.size-b.size});break;case"descending":c.sort(function(a,b){return b.size-a.size})}var f=1/e;c.minBreadth=0,c.breadth=.5,c.maxBreadth=1,c.visitBefore(function(a){var b=a.minBreadth,c=a.maxBreadth-b;for(var d=a.firstChild;d;d=d.nextSibling)d.minBreadth=b,d.maxBreadth=b+=d.size/a.size*c,d.breadth=(b+d.minBreadth)/2}),c.visitAfter(function(a,b){a.minDepth=(b-1)*f,a.maxDepth=a.depth=b*f}),pv.Layout.Hierarchy.NodeLink.buildImplied.call(this,a)},pv.Layout.Partition.Fill=function(){pv.Layout.Partition.call(this),pv.Layout.Hierarchy.Fill.constructor.call(this)},pv.Layout.Partition.Fill.prototype=pv.extend(pv.Layout.Partition),pv.Layout.Partition.Fill.prototype.buildImplied=function(a){if(pv.Layout.Partition.prototype.buildImplied.call(this,a))return;pv.Layout.Hierarchy.Fill.buildImplied.call(this,a)},pv.Layout.Arc=function(){pv.Layout.Network.call(this);var a,b,c,d=this.buildImplied;this.buildImplied=function(e){d.call(this,e),b=e.directed,a=e.orient=="radial"?"linear":"polar",c=e.orient=="right"||e.orient=="top"},this.link.data(function(a){var d=a.sourceNode,e=a.targetNode;return c!=(b||d.breadth<e.breadth)?[d,e]:[e,d]}).interpolate(function(){return a})},pv.Layout.Arc.prototype=pv.extend(pv.Layout.Network).property("orient",String).property("directed",Boolean),pv.Layout.Arc.prototype.defaults=(new pv.Layout.Arc).extend(pv.Layout.Network.prototype.defaults).orient("bottom"),pv.Layout.Arc.prototype.sort=function(a){return this.$sort=a,this},pv.Layout.Arc.prototype.buildImplied=function(a){function i(a){switch(c){case"top":return-Math.PI/2;case"bottom":return Math.PI/2;case"left":return Math.PI;case"right":return 0;case"radial":return(a-.25)*2*Math.PI}}function j(a){switch(c){case"top":case"bottom":return a*f;case"left":return 0;case"right":return f;case"radial":return f/2+h*Math.cos(i(a))}}function k(a){switch(c){case"top":return 0;case"bottom":return g;case"left":case"right":return a*g;case"radial":return g/2+h*Math.sin(i(a))}}if(pv.Layout.Network.prototype.buildImplied.call(this,a))return;var b=a.nodes,c=a.orient,d=this.$sort,e=pv.range(b.length),f=a.width,g=a.height,h=Math.min(f,g)/2;d&&e.sort(function(a,c){return d(b[a],b[c])});for(var l=0;l<b.length;l++){var m=b[e[l]],n=m.breadth=(l+.5)/b.length;m.x=j(n),m.y=k(n),m.midAngle=i(n)}},pv.Layout.Horizon=function(){pv.Layout.call(this);var a=this,b,c,d,e,f,g,h=this.buildImplied;this.buildImplied=function(a){h.call(this,a),b=a.bands,c=a.mode,d=Math.round((c=="color"?.5:1)*a.height),e=a.backgroundStyle,f=pv.ramp(e,a.negativeStyle).domain(0,b),g=pv.ramp(e,a.positiveStyle).domain(0,b)};var b=(new pv.Panel).data(function(){return pv.range(b*2)}).overflow("hidden").height(function(){return d}).top(function(a){return c=="color"?(a&1)*d:0}).fillStyle(function(a){return a?null:e});this.band=(new pv.Mark).top(function(a,b){return c=="mirror"&&b&1?(b+1>>1)*d:null}).bottom(function(a,b){return c=="mirror"?b&1?null:(b+1>>1)*-d:(b&1||-1)*(b+1>>1)*d}).fillStyle(function(a,b){return(b&1?f:g)((b>>1)+1)}),this.band.add=function(c){return a.add(pv.Panel).extend(b).add(c).extend(this)}},pv.Layout.Horizon.prototype=pv.extend(pv.Layout).property("bands",Number).property("mode",String).property("backgroundStyle",pv.color).property("positiveStyle",pv.color).property("negativeStyle",pv.color),pv.Layout.Horizon.prototype.defaults=(new pv.Layout.Horizon).extend(pv.Layout.prototype.defaults).bands(2).mode("offset").backgroundStyle("white").positiveStyle("#1f77b4").negativeStyle("#d62728"),pv.Layout.Rollup=function(){pv.Layout.Network.call(this);var a=this,b,c,d=a.buildImplied;this.buildImplied=function(a){d.call(this,a),b=a.$rollup.nodes,c=a.$rollup.links},this.node.data(function(){return b}).size(function(a){return a.nodes.length*20}),this.link.interpolate("polar").eccentricity(.8),this.link.add=function(b){return a.add(pv.Panel).data(function(){return c}).add(b).extend(this)}},pv.Layout.Rollup.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean),pv.Layout.Rollup.prototype.x=function(a){return this.$x=pv.functor(a),this},pv.Layout.Rollup.prototype.y=function(a){return this.$y=pv.functor(a),this},pv.Layout.Rollup.prototype.buildImplied=function(a){function k(a){return f[a]+","+g[a]}if(pv.Layout.Network.prototype.buildImplied.call(this,a))return;var b=a.nodes,c=a.links,d=a.directed,e=b.length,f=[],g=[],h=0,i={},j={},l=pv.Mark.stack,m={parent:this};l.unshift(null);for(var n=0;n<e;n++)m.index=n,l[0]=b[n],f[n]=this.$x.apply(m,l),g[n]=this.$y.apply(m,l);l.shift();for(var n=0;n<b.length;n++){var o=k(n),p=i[o];p||(p=i[o]=pv.extend(b[n]),p.index=h++,p.x=f[n],p.y=g[n],p.nodes=[]),p.nodes.push(b[n])}for(var n=0;n<c.length;n++){var q=c[n].sourceNode,r=c[n].targetNode,s=i[k(q.index)],t=i[k(r.index)],u=!d&&s.index>t.index,v=u?t.index+","+s.index:s.index+","+t.index,w=j[v];w||(w=j[v]={sourceNode:s,targetNode:t,linkValue:0,links:[]}),w.links.push(c[n]),w.linkValue+=c[n].linkValue}a.$rollup={nodes:pv.values(i),links:pv.values(j)}},pv.Layout.Matrix=function(){pv.Layout.Network.call(this);var a=this,b,c,d,e,f,g=a.buildImplied;this.buildImplied=function(a){g.call(this,a),b=a.nodes.length,c=a.width/b,d=a.height/b,e=a.$matrix.labels,f=a.$matrix.pairs},this.link.data(function(){return f}).left(function(){return c*(this.index%b)}).top(function(){return d*Math.floor(this.index/b)}).width(function(){return c}).height(function(){return d}).lineWidth(1.5).strokeStyle("#fff").fillStyle(function(a){return a.linkValue?"#555":"#eee"}).parent=this,delete this.link.add,this.label.data(function(){return e}).left(function(){return this.index&1?c*((this.index>>1)+.5):null}).top(function(){return this.index&1?null:d*((this.index>>1)+.5)}).textMargin(4).textAlign(function(){return this.index&1?"left":"right"}).textAngle(function(){return this.index&1?-Math.PI/2:0}),delete this.node},pv.Layout.Matrix.prototype=pv.extend(pv.Layout.Network).property("directed",Boolean),pv.Layout.Matrix.prototype.sort=function(a){return this.$sort=a,this},pv.Layout.Matrix.prototype.buildImplied=function(a){if(pv.Layout.Network.prototype.buildImplied.call(this,a))return;var b=a.nodes,c=a.links,d=this.$sort,e=b.length,f=pv.range(e),g=[],h=[],i={};a.$matrix={labels:g,pairs:h},d&&f.sort(function(a,c){return d(b[a],b[c])});for(var j=0;j<e;j++)for(var k=0;k<e;k++){var l=f[j],m=f[k],n={row:j,col:k,sourceNode:b[l],targetNode:b[m],linkValue:0};h.push(i[l+"."+m]=n)}for(var j=0;j<e;j++){var l=f[j];g.push(b[l],b[l])}for(var j=0;j<c.length;j++){var o=c[j],p=o.sourceNode.index,q=o.targetNode.index,r=o.linkValue;i[p+"."+q].linkValue+=r,a.directed||(i[q+"."+p].linkValue+=r)}},pv.Layout.Bullet=function(){pv.Layout.call(this);var a=this,b=a.buildImplied,c=a.x=pv.Scale.linear(),d,e,f,g,h;this.buildImplied=function(a){b.call(this,h=a),d=a.orient,e=/^left|right$/.test(d),f=pv.ramp("#bbb","#eee").domain(0,Math.max(1,h.ranges.length-1)),g=pv.ramp("steelblue","lightsteelblue").domain(0,Math.max(1,h.measures.length-1))},(this.range=new pv.Mark).data(function(){return h.ranges}).reverse(!0).left(function(){return d=="left"?0:null}).top(function(){return d=="top"?0:null}).right(function(){return d=="right"?0:null}).bottom(function(){return d=="bottom"?0:null}).width(function(a){return e?c(a):null}).height(function(a){return e?null:c(a)}).fillStyle(function(){return f(this.index)}).antialias(!1).parent=a,(this.measure=new pv.Mark).extend(this.range).data(function(){return h.measures}).left(function(){return d=="left"?0:e?null:this.parent.width()/3.25}).top(function(){return d=="top"?0:e?this.parent.height()/3.25:null}).right(function(){return d=="right"?0:e?null:this.parent.width()/3.25}).bottom(function(){return d=="bottom"?0:e?this.parent.height()/3.25:null}).fillStyle(function(){return g(this.index)}).parent=a,(this.marker=new pv.Mark).data(function(){return h.markers}).left(function(a){return d=="left"?c(a):e?null:this.parent.width()/2}).top(function(a){return d=="top"?c(a):e?this.parent.height()/2:null}).right(function(a){return d=="right"?c(a):null}).bottom(function(a){return d=="bottom"?c(a):null}).strokeStyle("black").shape("bar").angle(function(){return e?0:Math.PI/2}).parent=a,(this.tick=new pv.Mark).data(function(){return c.ticks(7)}).left(function(a){return d=="left"?c(a):null}).top(function(a){return d=="top"?c(a):null}).right(function(a){return d=="right"?c(a):e?null:-6}).bottom(function(a){return d=="bottom"?c(a):e?-8:null}).height(function(){return e?6:null}).width(function(){return e?null:6}).parent=a},pv.Layout.Bullet.prototype=pv.extend(pv.Layout).property("orient",String).property("ranges").property("markers").property("measures").property("maximum",Number),pv.Layout.Bullet.prototype.defaults=(new pv.Layout.Bullet).extend(pv.Layout.prototype.defaults).orient("left").ranges([]).markers([]).measures([]),pv.Layout.Bullet.prototype.buildImplied=function(a){pv.Layout.prototype.buildImplied.call(this,a);var b=this.parent[/^left|right$/.test(a.orient)?"width":"height"]();a.maximum=a.maximum||pv.max([].concat(a.ranges,a.markers,a.measures)),this.x.domain(0,a.maximum).range(0,b)},pv.Behavior={},pv.Behavior.drag=function(){function f(f){b=this.index,a=this.scene;var g=this.mouse();d=((c=f).fix=pv.vector(f.x,f.y)).minus(g),e={x:this.parent.width()-(f.dx||0),y:this.parent.height()-(f.dy||0)},a.mark.context(a,b,function(){this.render()}),pv.Mark.dispatch("dragstart",a,b)}function g(){if(!a)return;a.mark.context(a,b,function(){var a=this.mouse();c.x=c.fix.x=Math.max(0,Math.min(d.x+a.x,e.x)),c.y=c.fix.y=Math.max(0,Math.min(d.y+a.y,e.y)),this.render()}),pv.Mark.dispatch("drag",a,b)}function h(){if(!a)return;c.fix=null,a.mark.context(a,b,function(){this.render()}),pv.Mark.dispatch("dragend",a,b),a=null}var a,b,c,d,e;return pv.listen(window,"mousemove",g),pv.listen(window,"mouseup",h),f},pv.Behavior.point=function(a){function g(a,b){var c=a[b],f={cost:Infinity};for(var h=0,i=c.visible&&c.children.length;h<i;h++){var j=c.children[h],k=j.mark,l;if(k.type=="panel"){k.scene=j;for(var m=0,n=j.length;m<n;m++)k.index=m,l=g(j,m),l.cost<f.cost&&(f=l);delete k.scene,delete k.index}else if(k.$handlers.point){var o=k.mouse();for(var m=0,n=j.length;m<n;m++){var p=j[m],q=o.x-p.left-(p.width||0)/2,r=o.y-p.top-(p.height||0)/2,s=d*q*q+e*r*r;s<f.cost&&(f.distance=q*q+r*r,f.cost=s,f.scene=j,f.index=m)}}}return f}function h(){var a=g(this.scene,this.index);if(a.cost==Infinity||a.distance>f)a=null;if(b){if(a&&b.scene==a.scene&&b.index==a.index)return;pv.Mark.dispatch("unpoint",b.scene,b.index)}if(b=a)pv.Mark.dispatch("point",a.scene,a.index),pv.listen(this.root.canvas(),"mouseout",i)}function i(a){b&&!pv.ancestor(this,a.relatedTarget)&&(pv.Mark.dispatch("unpoint",b.scene,b.index),b=null)}var b,c=null,d=1,e=1,f=arguments.length?a*a:900;return h.collapse=function(a){if(arguments.length){c=String(a);switch(c){case"y":d=1,e=0;break;case"x":d=0,e=1;break;default:d=1,e=1}return h}return c},h},pv.Behavior.select=function(){function e(e){b=this.index,a=this.scene,d=this.mouse(),c=e,c.x=d.x,c.y=d.y,c.dx=c.dy=0,pv.Mark.dispatch("selectstart",a,b)}function f(){if(!a)return;a.mark.context(a,b,function(){var a=this.mouse();c.x=Math.max(0,Math.min(d.x,a.x)),c.y=Math.max(0,Math.min(d.y,a.y)),c.dx=Math.min(this.width(),Math.max(a.x,d.x))-c.x,c.dy=Math.min(this.height(),Math.max(a.y,d.y))-c.y,this.render()}),pv.Mark.dispatch("select",a,b)}function g(){if(!a)return;pv.Mark.dispatch("selectend",a,b),a=null}var a,b,c,d;return pv.listen(window,"mousemove",f),pv.listen(window,"mouseup",g),e},pv.Behavior.resize=function(a){function f(f){c=this.index,b=this.scene,e=this.mouse(),d=f;switch(a){case"left":e.x=d.x+d.dx;break;case"right":e.x=d.x;break;case"top":e.y=d.y+d.dy;break;case"bottom":e.y=d.y}pv.Mark.dispatch("resizestart",b,c)}function g(){if(!b)return;b.mark.context(b,c,function(){var a=this.mouse();d.x=Math.max(0,Math.min(e.x,a.x)),d.y=Math.max(0,Math.min(e.y,a.y)),d.dx=Math.min(this.parent.width(),Math.max(a.x,e.x))-d.x,d.dy=Math.min(this.parent.height(),Math.max(a.y,e.y))-d.y,this.render()}),pv.Mark.dispatch("resize",b,c)}function h(){if(!b)return;pv.Mark.dispatch("resizeend",b,c),b=null}var b,c,d,e;return pv.listen(window,"mousemove",g),pv.listen(window,"mouseup",h),f},pv.Behavior.pan=function(){function g(){b=this.index,a=this.scene,d=pv.vector(pv.event.pageX,pv.event.pageY),c=this.transform(),e=1/(c.k*this.scale),f&&(f={x:(1-c.k)*this.width(),y:(1-c.k)*this.height()})}function h(){if(!a)return;a.mark.context(a,b,function(){var a=(pv.event.pageX-d.x)*e,b=(pv.event.pageY-d.y)*e,g=c.translate(a,b);f&&(g.x=Math.max(f.x,Math.min(0,g.x)),g.y=Math.max(f.y,Math.min(0,g.y))),this.transform(g).render()}),pv.Mark.dispatch("pan",a,b)}function i(){a=null}var a,b,c,d,e,f;return g.bound=function(a){return arguments.length?(f=Boolean(a),this):Boolean(f)},pv.listen(window,"mousemove",h),pv.listen(window,"mouseup",i),g},pv.Behavior.zoom=function(a){function c(){var c=this.mouse(),d=pv.event.wheel*a,e=this.transform().translate(c.x,c.y).scale(d<0?1e3/(1e3-d):(1e3+d)/1e3).translate(-c.x,-c.y);b&&(e.k=Math.max(1,e.k),e.x=Math.max((1-e.k)*this.width(),Math.min(0,e.x)),e.y=Math.max((1-e.k)*this.height(),Math.min(0,e.y))),this.transform(e).render(),pv.Mark.dispatch("zoom",this.scene,this.index)}var b;return arguments.length||(a=1/48),c.bound=function(a){return arguments.length?(b=Boolean(a),this):Boolean(b)},c},pv.Geo=function(){},pv.Geo.projections={mercator:{project:function(a){return{x:a.lng/180,y:a.lat>85?1:a.lat<-85?-1:Math.log(Math.tan(Math.PI/4+pv.radians(a.lat)/2))/Math.PI}},invert:function(a){return{lng:a.x*180,lat:pv.degrees(2*Math.atan(Math.exp(a.y*Math.PI))-Math.PI/2)}}},"gall-peters":{project:function(a){return{x:a.lng/180,y:Math.sin(pv.radians(a.lat))}},invert:function(a){return{lng:a.x*180,lat:pv.degrees(Math.asin(a.y))}}},sinusoidal:{project:function(a){return{x:pv.radians(a.lng)*Math.cos(pv.radians(a.lat))/Math.PI,y:a.lat/90}},invert:function(a){return{lng:pv.degrees(a.x*Math.PI/Math.cos(a.y*Math.PI/2)),lat:a.y*90}}},aitoff:{project:function(a){var b=pv.radians(a.lng),c=pv.radians(a.lat),d=Math.acos(Math.cos(c)*Math.cos(b/2));return{x:2*(d?Math.cos(c)*Math.sin(b/2)*d/Math.sin(d):0)/Math.PI,y:2*(d?Math.sin(c)*d/Math.sin(d):0)/Math.PI}},invert:function(a){var b=a.x*Math.PI/2,c=a.y*Math.PI/2;return{lng:pv.degrees(b/Math.cos(c)),lat:pv.degrees(c)}}},hammer:{project:function(a){var b=pv.radians(a.lng),c=pv.radians(a.lat),d=Math.sqrt(1+Math.cos(c)*Math.cos(b/2));return{x:2*Math.SQRT2*Math.cos(c)*Math.sin(b/2)/d/3,y:Math.SQRT2*Math.sin(c)/d/1.5}},invert:function(a){var b=a.x*3,c=a.y*1.5,d=Math.sqrt(1-b*b/16-c*c/4);return{lng:pv.degrees(2*Math.atan2(d*b,2*(2*d*d-1))),lat:pv.degrees(Math.asin(d*c))}}},identity:{project:function(a){return{x:a.lng/180,y:a.lat/90}},invert:function(a){return{lng:a.x*180,lat:a.y*90}}}},pv.Geo.scale=function(a){function k(a){if(!i||a.lng!=i.lng||a.lat!=i.lat){i=a;var b=l(a);j={x:f(b.x),y:g(b.y)}}return j}function l(a){var b={lng:a.lng-h.lng,lat:a.lat};return e.project(b)}function m(a){var b=e.invert(a);return b.lng+=h.lng,b}var b={x:0,y:0},c={x:1,y:1},d=[],e=pv.Geo.projections.identity,f=pv.Scale.linear(-1,1).range(0,1),g=pv.Scale.linear(-1,1).range(1,0),h={lng:0,lat:0},i,j;return k.x=function(a){return k(a).x},k.y=function(a){return k(a).y},k.ticks={lng:function(a){var b,c;if(d.length>1){var e=pv.Scale.linear();a==undefined&&(a=10),b=e.domain(d,function(a){return a.lat}).ticks(a),c=e.domain(d,function(a){return a.lng}).ticks(a)}else b=pv.range(-80,81,10),c=pv.range(-180,181,10);return c.map(function(a){return b.map(function(b){return{lat:b,lng:a}})})},lat:function(a){return pv.transpose(k.ticks.lng(a))}},k.invert=function(a){return m({x:f.invert(a.x),y:g.invert(a.y)})},k.domain=function(a,b){if(arguments.length){d=a instanceof Array?arguments.length>1?pv.map(a,b):a:Array.prototype.slice.call(arguments);if(d.length>1){var c=d.map(function(a){return a.lng}),e=d.map(function(a){return a.lat});h={lng:(pv.max(c)+pv.min(c))/2,lat:(pv.max(e)+pv.min(e))/2};var j=d.map(l);f.domain(j,function(a){return a.x}),g.domain(j,function(a){return a.y})}else h={lng:0,lat:0},f.domain(-1,1),g.domain(-1,1);return i=null,this}return d},k.range=function(a,d){return arguments.length?(typeof a=="object"?(b={x:Number(a.x),y:Number(a.y)},c={x:Number(d.x),y:Number(d.y)}):(b={x:0,y:0},c={x:Number(a),y:Number(d)}),f.range(b.x,c.x),g.range(c.y,b.y),i=null,this):[b,c]},k.projection=function(a){return arguments.length?(e=typeof a=="string"?pv.Geo.projections[a]||pv.Geo.projections.identity:a,this.domain(d)):a},k.by=function(a){function b(){return k(a.apply(this,arguments))}for(var c in k)b[c]=k[c];return b},arguments.length&&k.projection(a),k};
(function(){function e(a,b){try{for(var c in b)Object.defineProperty(a.prototype,c,{value:b[c],enumerable:!1})}catch(d){a.prototype=b}}function g(a){var b=-1,c=a.length,d=[];while(++b<c)d.push(a[b]);return d}function h(a){return Array.prototype.slice.call(a)}function k(){}function n(a){return a}function o(){return this}function p(){return!0}function q(a){return typeof a=="function"?a:function(){return a}}function r(a,b,c){return function(){var d=c.apply(b,arguments);return arguments.length?a:d}}function s(a){return a!=null&&!isNaN(a)}function t(a){return a.length}function v(a){return a==null}function w(a){return a.replace(/(^\s+)|(\s+$)/g,"").replace(/\s+/g," ")}function x(a){var b=1;while(a*b%1)b*=10;return b}function A(){}function B(a){function d(){var c=b,d=-1,e=c.length,f;while(++d<e)(f=c[d].on)&&f.apply(this,arguments);return a}var b=[],c=new k;return d.on=function(d,e){var f=c.get(d),g;return arguments.length<2?f&&f.on:(f&&(f.on=null,b=b.slice(0,g=b.indexOf(f)).concat(b.slice(g+1)),c.remove(d)),e&&b.push(c.set(d,{on:e})),a)},d}function E(a,b){return b-(a?1+Math.floor(Math.log(a+Math.pow(10,1+Math.floor(Math.log(a)/Math.LN10)-b))/Math.LN10):1)}function F(a){return a+""}function G(a){var b=a.lastIndexOf("."),c=b>=0?a.substring(b):(b=a.length,""),d=[];while(b>0)d.push(a.substring(b-=3,b+3));return d.reverse().join(",")+c}function I(a,b){return{scale:Math.pow(10,(8-b)*3),symbol:a}}function O(a){return function(b){return b<=0?0:b>=1?1:a(b)}}function P(a){return function(b){return 1-a(1-b)}}function Q(a){return function(b){return.5*(b<.5?a(2*b):2-a(2-2*b))}}function R(a){return a}function S(a){return function(b){return Math.pow(b,a)}}function T(a){return 1-Math.cos(a*Math.PI/2)}function U(a){return Math.pow(2,10*(a-1))}function V(a){return 1-Math.sqrt(1-a*a)}function W(a,b){var c;return arguments.length<2&&(b=.45),arguments.length<1?(a=1,c=b/4):c=b/(2*Math.PI)*Math.asin(1/a),function(d){return 1+a*Math.pow(2,10*-d)*Math.sin((d-c)*2*Math.PI/b)}}function X(a){return a||(a=1.70158),function(b){return b*b*((a+1)*b-a)}}function Y(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375}function Z(){d3.event.stopPropagation(),d3.event.preventDefault()}function $(){var a=d3.event,b;while(b=a.sourceEvent)a=b;return a}function _(a){var b=new A,c=0,d=arguments.length;while(++c<d)b[arguments[c]]=B(b);return b.of=function(c,d){return function(e){try{var f=e.sourceEvent=d3.event;e.target=a,d3.event=e,b[e.type].apply(c,d)}finally{d3.event=f}}},b}function bb(a){return a=="transform"?d3.interpolateTransform:d3.interpolate}function cb(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return(c-a)*b}}function db(a,b){return b=b-(a=+a)?1/(b-a):0,function(c){return Math.max(0,Math.min(1,(c-a)*b))}}function eb(a,b,c){return new fb(a,b,c)}function fb(a,b,c){this.r=a,this.g=b,this.b=c}function gb(a){return a<16?"0"+Math.max(0,a).toString(16):Math.min(255,a).toString(16)}function hb(a,b,c){var d=0,e=0,f=0,g,h,i;g=/([a-z]+)\((.*)\)/i.exec(a);if(g){h=g[2].split(",");switch(g[1]){case"hsl":return c(parseFloat(h[0]),parseFloat(h[1])/100,parseFloat(h[2])/100);case"rgb":return b(jb(h[0]),jb(h[1]),jb(h[2]))}}return(i=kb.get(a))?b(i.r,i.g,i.b):(a!=null&&a.charAt(0)==="#"&&(a.length===4?(d=a.charAt(1),d+=d,e=a.charAt(2),e+=e,f=a.charAt(3),f+=f):a.length===7&&(d=a.substring(1,3),e=a.substring(3,5),f=a.substring(5,7)),d=parseInt(d,16),e=parseInt(e,16),f=parseInt(f,16)),b(d,e,f))}function ib(a,b,c){var d=Math.min(a/=255,b/=255,c/=255),e=Math.max(a,b,c),f=e-d,g,h,i=(e+d)/2;return f?(h=i<.5?f/(e+d):f/(2-e-d),a==e?g=(b-c)/f+(b<c?6:0):b==e?g=(c-a)/f+2:g=(a-b)/f+4,g*=60):h=g=0,lb(g,h,i)}function jb(a){var b=parseFloat(a);return a.charAt(a.length-1)==="%"?Math.round(b*2.55):b}function lb(a,b,c){return new mb(a,b,c)}function mb(a,b,c){this.h=a,this.s=b,this.l=c}function nb(a,b,c){function f(a){return a>360?a-=360:a<0&&(a+=360),a<60?d+(e-d)*a/60:a<180?e:a<240?d+(e-d)*(240-a)/60:d}function g(a){return Math.round(f(a)*255)}var d,e;return a%=360,a<0&&(a+=360),b=b<0?0:b>1?1:b,c=c<0?0:c>1?1:c,e=c<=.5?c*(1+b):c+b-c*b,d=2*c-e,eb(g(a+120),g(a),g(a-120))}function ob(a){return j(a,ub),a}function vb(a){return function(){return pb(a,this)}}function wb(a){return function(){return qb(a,this)}}function yb(a,b){function f(){if(b=this.classList)return b.add(a);var b=this.className,d=b.baseVal!=null,e=d?b.baseVal:b;c.lastIndex=0,c.test(e)||(e=w(e+" "+a),d?b.baseVal=e:this.className=e)}function g(){if(b=this.classList)return b.remove(a);var b=this.className,d=b.baseVal!=null,e=d?b.baseVal:b;e=w(e.replace(c," ")),d?b.baseVal=e:this.className=e}function h(){(b.apply(this,arguments)?f:g).call(this)}var c=new RegExp("(^|\\s+)"+d3.requote(a)+"(\\s+|$)","g");if(arguments.length<2){var d=this.node();if(e=d.classList)return e.contains(a);var e=d.className;return c.lastIndex=0,c.test(e.baseVal!=null?e.baseVal:e)}return this.each(typeof b=="function"?h:b?f:g)}function zb(a){return{__data__:a}}function Ab(a){return function(){return tb(this,a)}}function Bb(a){return arguments.length||(a=d3.ascending),function(b,c){return a(b&&b.__data__,c&&c.__data__)}}function Db(a){return j(a,Eb),a}function Fb(a,b,c){j(a,Jb);var d=new k,e=d3.dispatch("start","end"),f=Rb;return a.id=b,a.time=c,a.tween=function(b,c){return arguments.length<2?d.get(b):(c==null?d.remove(b):d.set(b,c),a)},a.ease=function(b){return arguments.length?(f=typeof b=="function"?b:d3.ease.apply(d3,arguments),a):f},a.each=function(b,c){return arguments.length<2?Sb.call(a,b):(e.on(b,c),a)},d3.timer(function(g){return a.each(function(h,i,j){function p(a){return o.active>b?r():(o.active=b,d.forEach(function(a,b){(b=b.call(l,h,i))&&k.push(b)}),e.start.call(l,h,i),q(a)||d3.timer(q,0,c),1)}function q(a){if(o.active!==b)return r();var c=(a-m)/n,d=f(c),g=k.length;while(g>0)k[--g].call(l,d);if(c>=1)return r(),Lb=b,e.end.call(l,h,i),Lb=0,1}function r(){return--o.count||delete l.__transition__,1}var k=[],l=this,m=a[j][i].delay,n=a[j][i].duration,o=l.__transition__||(l.__transition__={active:0,count:0});++o.count,m<=g?p(g):d3.timer(p,m,c)}),1},0,c),a}function Hb(a,b,c){return c!=""&&Gb}function Ib(a,b){function d(a,d,e){var f=b.call(this,a,d);return f==null?e!=""&&Gb:e!=f&&c(e,f)}function e(a,d,e){return e!=b&&c(e,b)}var c=bb(a);return typeof b=="function"?d:b==null?Hb:(b+="",e)}function Sb(a){var b=Lb,c=Rb,d=Pb,e=Qb;Lb=this.id,Rb=this.ease();for(var f=0,g=this.length;f<g;f++)for(var h=this[f],i=0,j=h.length;i<j;i++){var k=h[i];k&&(Pb=this[f][i].delay,Qb=this[f][i].duration,a.call(k=k.node,k.__data__,i,f))}return Lb=b,Rb=c,Pb=d,Qb=e,this}function Wb(){var a,b=Date.now(),c=Tb;while(c)a=b-c.then,a>=c.delay&&(c.flush=c.callback(a)),c=c.next;var d=Xb()-b;d>24?(isFinite(d)&&(clearTimeout(Vb),Vb=setTimeout(Wb,d)),Ub=0):(Ub=1,Yb(Wb))}function Xb(){var a=null,b=Tb,c=Infinity;while(b)b.flush?b=a?a.next=b.next:Tb=b.next:(c=Math.min(c,b.then+b.delay),b=(a=b).next);return c}function Zb(a){var b=[a.a,a.b],c=[a.c,a.d],d=_b(b),e=$b(b,c),f=_b(ac(c,b,-e))||0;b[0]*c[1]<c[0]*b[1]&&(b[0]*=-1,b[1]*=-1,d*=-1,e*=-1),this.rotate=(d?Math.atan2(b[1],b[0]):Math.atan2(-c[0],c[1]))*bc,this.translate=[a.e,a.f],this.scale=[d,f],this.skew=f?Math.atan2(e,f)*bc:0}function $b(a,b){return a[0]*b[0]+a[1]*b[1]}function _b(a){var b=Math.sqrt($b(a,a));return b&&(a[0]/=b,a[1]/=b),b}function ac(a,b,c){return a[0]+=c*b[0],a[1]+=c*b[1],a}function dc(a,b){var c=a.ownerSVGElement||a;if(c.createSVGPoint){var d=c.createSVGPoint();if(cc<0&&(window.scrollX||window.scrollY)){c=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var e=c[0][0].getScreenCTM();cc=!e.f&&!e.e,c.remove()}return cc?(d.x=b.pageX,d.y=b.pageY):(d.x=b.clientX,d.y=b.clientY),d=d.matrixTransform(a.getScreenCTM().inverse()),[d.x,d.y]}var f=a.getBoundingClientRect();return[b.clientX-f.left-a.clientLeft,b.clientY-f.top-a.clientTop]}function ec(){}function fc(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function gc(a){return a.rangeExtent?a.rangeExtent():fc(a.range())}function hc(a,b){var c=0,d=a.length-1,e=a[c],f=a[d],g;f<e&&(g=c,c=d,d=g,g=e,e=f,f=g);if(g=f-e)b=b(g),a[c]=b.floor(e),a[d]=b.ceil(f);return a}function ic(){return Math}function jc(a,b,c,d){function g(){var g=Math.min(a.length,b.length)>2?qc:pc,i=d?db:cb;return e=g(a,b,i,c),f=g(b,a,i,d3.interpolate),h}function h(a){return e(a)}var e,f;return h.invert=function(a){return f(a)},h.domain=function(b){return arguments.length?(a=b.map(Number),g()):a},h.range=function(a){return arguments.length?(b=a,g()):b},h.rangeRound=function(a){return h.range(a).interpolate(d3.interpolateRound)},h.clamp=function(a){return arguments.length?(d=a,g()):d},h.interpolate=function(a){return arguments.length?(c=a,g()):c},h.ticks=function(b){return nc(a,b)},h.tickFormat=function(b){return oc(a,b)},h.nice=function(){return hc(a,lc),g()},h.copy=function(){return jc(a,b,c,d)},g()}function kc(a,b){return d3.rebind(a,b,"range","rangeRound","interpolate","clamp")}function lc(a){return a=Math.pow(10,Math.round(Math.log(a)/Math.LN10)-1),{floor:function(b){return Math.floor(b/a)*a},ceil:function(b){return Math.ceil(b/a)*a}}}function mc(a,b){var c=fc(a),d=c[1]-c[0],e=Math.pow(10,Math.floor(Math.log(d/b)/Math.LN10)),f=b/d*e;return f<=.15?e*=10:f<=.35?e*=5:f<=.75&&(e*=2),c[0]=Math.ceil(c[0]/e)*e,c[1]=Math.floor(c[1]/e)*e+e*.5,c[2]=e,c}function nc(a,b){return d3.range.apply(d3,mc(a,b))}function oc(a,b){return d3.format(",."+Math.max(0,-Math.floor(Math.log(mc(a,b)[2])/Math.LN10+.01))+"f")}function pc(a,b,c,d){var e=c(a[0],a[1]),f=d(b[0],b[1]);return function(a){return f(e(a))}}function qc(a,b,c,d){var e=[],f=[],g=0,h=Math.min(a.length,b.length)-1;a[h]<a[0]&&(a=a.slice().reverse(),b=b.slice().reverse());while(++g<=h)e.push(c(a[g-1],a[g])),f.push(d(b[g-1],b[g]));return function(b){var c=d3.bisect(a,b,1,h)-1;return f[c](e[c](b))}}function rc(a,b){function d(c){return a(b(c))}var c=b.pow;return d.invert=function(b){return c(a.invert(b))},d.domain=function(e){return arguments.length?(b=e[0]<0?uc:tc,c=b.pow,a.domain(e.map(b)),d):a.domain().map(c)},d.nice=function(){return a.domain(hc(a.domain(),ic)),d},d.ticks=function(){var d=fc(a.domain()),e=[];if(d.every(isFinite)){var f=Math.floor(d[0]),g=Math.ceil(d[1]),h=c(d[0]),i=c(d[1]);if(b===uc){e.push(c(f));for(;f++<g;)for(var j=9;j>0;j--)e.push(c(f)*j)}else{for(;f<g;f++)for(var j=1;j<10;j++)e.push(c(f)*j);e.push(c(f))}for(f=0;e[f]<h;f++);for(g=e.length;e[g-1]>i;g--);e=e.slice(f,g)}return e},d.tickFormat=function(a,e){arguments.length<2&&(e=sc);if(arguments.length<1)return e;var f=a/d.ticks().length,g=b===uc?(h=-1e-12,Math.floor):(h=1e-12,Math.ceil),h;return function(a){return a/c(g(b(a)+h))<f?e(a):""}},d.copy=function(){return rc(a.copy(),b)},kc(d,a)}function tc(a){return Math.log(a<0?0:a)/Math.LN10}function uc(a){return-Math.log(a>0?0:-a)/Math.LN10}function vc(a,b){function e(b){return a(c(b))}var c=wc(b),d=wc(1/b);return e.invert=function(b){return d(a.invert(b))},e.domain=function(b){return arguments.length?(a.domain(b.map(c)),e):a.domain().map(d)},e.ticks=function(a){return nc(e.domain(),a)},e.tickFormat=function(a){return oc(e.domain(),a)},e.nice=function(){return e.domain(hc(e.domain(),lc))},e.exponent=function(a){if(!arguments.length)return b;var f=e.domain();return c=wc(b=a),d=wc(1/b),e.domain(f)},e.copy=function(){return vc(a.copy(),b)},kc(e,a)}function wc(a){return function(b){return b<0?-Math.pow(-b,a):Math.pow(b,a)}}function xc(a,b){function f(b){return d[((c.get(b)||c.set(b,a.push(b)))-1)%d.length]}function g(b,c){return d3.range(a.length).map(function(a){return b+c*a})}var c,d,e;return f.domain=function(d){if(!arguments.length)return a;a=[],c=new k;var e=-1,g=d.length,h;while(++e<g)c.has(h=d[e])||c.set(h,a.push(h));return f[b.t](b.x,b.p)},f.range=function(a){return arguments.length?(d=a,e=0,b={t:"range",x:a},f):d},f.rangePoints=function(c,h){arguments.length<2&&(h=0);var i=c[0],j=c[1],k=(j-i)/(a.length-1+h);return d=g(a.length<2?(i+j)/2:i+k*h/2,k),e=0,b={t:"rangePoints",x:c,p:h},f},f.rangeBands=function(c,h){arguments.length<2&&(h=0);var i=c[1]<c[0],j=c[i-0],k=c[1-i],l=(k-j)/(a.length+h);return d=g(j+l*h,l),i&&d.reverse(),e=l*(1-h),b={t:"rangeBands",x:c,p:h},f},f.rangeRoundBands=function(c,h){arguments.length<2&&(h=0);var i=c[1]<c[0],j=c[i-0],k=c[1-i],l=Math.floor((k-j)/(a.length+h)),m=k-j-(a.length-h)*l;return d=g(j+Math.round(m/2),l),i&&d.reverse(),e=Math.round(l*(1-h)),b={t:"rangeRoundBands",x:c,p:h},f},f.rangeBand=function(){return e},f.rangeExtent=function(){return fc(b.x)},f.copy=function(){return xc(a,b)},f.domain(a)}function Cc(a,b){function d(){var d=0,f=a.length,g=b.length;c=[];while(++d<g)c[d-1]=d3.quantile(a,d/g);return e}function e(a){return isNaN(a=+a)?NaN:b[d3.bisect(c,a)]}var c;return e.domain=function(b){return arguments.length?(a=b.filter(function(a){return!isNaN(a)}).sort(d3.ascending),d()):a},e.range=function(a){return arguments.length?(b=a,d()):b},e.quantiles=function(){return c},e.copy=function(){return Cc(a,b)},d()}function Dc(a,b,c){function f(b){return c[Math.max(0,Math.min(e,Math.floor(d*(b-a))))]}function g(){return d=c.length/(b-a),e=c.length-1,f}var d,e;return f.domain=function(c){return arguments.length?(a=+c[0],b=+c[c.length-1],g()):[a,b]},f.range=function(a){return arguments.length?(c=a,g()):c},f.copy=function(){return Dc(a,b,c)},g()}function Ec(a){function b(a){return+a}return b.invert=b,b.domain=b.range=function(c){return arguments.length?(a=c.map(b),b):a},b.ticks=function(b){return nc(a,b)},b.tickFormat=function(b){return oc(a,b)},b.copy=function(){return Ec(a)},b}function Hc(a){return a.innerRadius}function Ic(a){return a.outerRadius}function Jc(a){return a.startAngle}function Kc(a){return a.endAngle}function Lc(a){function h(e){function o(){h.push("M",f(a(i),g))}var h=[],i=[],j=-1,k=e.length,l,m=q(b),n=q(c);while(++j<k)d.call(this,l=e[j],j)?i.push([+m.call(this,l,j),+n.call(this,l,j)]):i.length&&(o(),i=[]);return i.length&&o(),h.length?h.join(""):null}var b=Mc,c=Nc,d=p,e=Oc,f=Qc,g=.7;return h.x=function(a){return arguments.length?(b=a,h):b},h.y=function(a){return arguments.length?(c=a,h):c},h.defined=function(a){return arguments.length?(d=a,h):d},h.interpolate=function(a){return arguments.length?(Pc.has(a+="")||(a=Oc),f=Pc.get(e=a),h):e},h.tension=function(a){return arguments.length?(g=a,h):g},h}function Mc(a){return a[0]}function Nc(a){return a[1]}function Qc(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("L",(d=a[b])[0],",",d[1]);return e.join("")}function Rc(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("V",(d=a[b])[1],"H",d[0]);return e.join("")}function Sc(a){var b=0,c=a.length,d=a[0],e=[d[0],",",d[1]];while(++b<c)e.push("H",(d=a[b])[0],"V",d[1]);return e.join("")}function Tc(a,b){return a.length<4?Qc(a):a[1]+Wc(a.slice(1,a.length-1),Xc(a,b))}function Uc(a,b){return a.length<3?Qc(a):a[0]+Wc((a.push(a[0]),a),Xc([a[a.length-2]].concat(a,[a[1]]),b))}function Vc(a,b,c){return a.length<3?Qc(a):a[0]+Wc(a,Xc(a,b))}function Wc(a,b){if(b.length<1||a.length!=b.length&&a.length!=b.length+2)return Qc(a);var c=a.length!=b.length,d="",e=a[0],f=a[1],g=b[0],h=g,i=1;c&&(d+="Q"+(f[0]-g[0]*2/3)+","+(f[1]-g[1]*2/3)+","+f[0]+","+f[1],e=a[1],i=2);if(b.length>1){h=b[1],f=a[i],i++,d+="C"+(e[0]+g[0])+","+(e[1]+g[1])+","+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1];for(var j=2;j<b.length;j++,i++)f=a[i],h=b[j],d+="S"+(f[0]-h[0])+","+(f[1]-h[1])+","+f[0]+","+f[1]}if(c){var k=a[i];d+="Q"+(f[0]+h[0]*2/3)+","+(f[1]+h[1]*2/3)+","+k[0]+","+k[1]}return d}function Xc(a,b){var c=[],d=(1-b)/2,e,f=a[0],g=a[1],h=1,i=a.length;while(++h<i)e=f,f=g,g=a[h],c.push([d*(g[0]-e[0]),d*(g[1]-e[1])]);return c}function Yc(a){if(a.length<3)return Qc(a);var b=1,c=a.length,d=a[0],e=d[0],f=d[1],g=[e,e,e,(d=a[1])[0]],h=[f,f,f,d[1]],i=[e,",",f];ed(i,g,h);while(++b<c)d=a[b],g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),ed(i,g,h);b=-1;while(++b<2)g.shift(),g.push(d[0]),h.shift(),h.push(d[1]),ed(i,g,h);return i.join("")}function Zc(a){if(a.length<4)return Qc(a);var b=[],c=-1,d=a.length,e,f=[0],g=[0];while(++c<3)e=a[c],f.push(e[0]),g.push(e[1]);b.push(ad(dd,f)+","+ad(dd,g)),--c;while(++c<d)e=a[c],f.shift(),f.push(e[0]),g.shift(),g.push(e[1]),ed(b,f,g);return b.join("")}function $c(a){var b,c=-1,d=a.length,e=d+4,f,g=[],h=[];while(++c<4)f=a[c%d],g.push(f[0]),h.push(f[1]);b=[ad(dd,g),",",ad(dd,h)],--c;while(++c<e)f=a[c%d],g.shift(),g.push(f[0]),h.shift(),h.push(f[1]),ed(b,g,h);return b.join("")}function _c(a,b){var c=a.length-1,d=a[0][0],e=a[0][1],f=a[c][0]-d,g=a[c][1]-e,h=-1,i,j;while(++h<=c)i=a[h],j=h/c,i[0]=b*i[0]+(1-b)*(d+j*f),i[1]=b*i[1]+(1-b)*(e+j*g);return Yc(a)}function ad(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function ed(a,b,c){a.push("C",ad(bd,b),",",ad(bd,c),",",ad(cd,b),",",ad(cd,c),",",ad(dd,b),",",ad(dd,c))}function fd(a,b){return(b[1]-a[1])/(b[0]-a[0])}function gd(a){var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=fd(e,f);while(++b<c)d[b]=g+(g=fd(e=f,f=a[b+1]));return d[b]=g,d}function hd(a){var b=[],c,d,e,f,g=gd(a),h=-1,i=a.length-1;while(++h<i)c=fd(a[h],a[h+1]),Math.abs(c)<1e-6?g[h]=g[h+1]=0:(d=g[h]/c,e=g[h+1]/c,f=d*d+e*e,f>9&&(f=c*3/Math.sqrt(f),g[h]=f*d,g[h+1]=f*e));h=-1;while(++h<=i)f=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),b.push([f||0,g[h]*f||0]);return b}function id(a){return a.length<3?Qc(a):a[0]+Wc(a,hd(a))}function jd(a){var b,c=-1,d=a.length,e,f;while(++c<d)b=a[c],e=b[0],f=b[1]+Fc,b[0]=e*Math.cos(f),b[1]=e*Math.sin(f);return a}function kd(a){function l(g){function y(){l.push("M",h(a(n),k),j,i(a(m.reverse()),k),"Z")}var l=[],m=[],n=[],o=-1,p=g.length,r,s=q(b),t=q(d),u=b===c?function(){return w}:q(c),v=d===e?function(){return x}:q(e),w,x;while(++o<p)f.call(this,r=g[o],o)?(m.push([w=+s.call(this,r,o),x=+t.call(this,r,o)]),n.push([+u.call(this,r,o),+v.call(this,r,o)])):m.length&&(y(),m=[],n=[]);return m.length&&y(),l.length?l.join(""):null}var b=Mc,c=Mc,d=0,e=Nc,f=p,g=Oc,h=Qc,i=Qc,j="L",k=.7;return l.x=function(a){return arguments.length?(b=c=a,l):c},l.x0=function(a){return arguments.length?(b=a,l):b},l.x1=function(a){return arguments.length?(c=a,l):c},l.y=function(a){return arguments.length?(d=e=a,l):e},l.y0=function(a){return arguments.length?(d=a,l):d},l.y1=function(a){return arguments.length?(e=a,l):e},l.defined=function(a){return arguments.length?(f=a,l):f},l.interpolate=function(a){return arguments.length?(Pc.has(a+="")||(a=Oc),h=Pc.get(g=a),i=h.reverse||h,j=/-closed$/.test(a)?"M":"L",l):g},l.tension=function(a){return arguments.length?(k=a,l):k},l}function ld(a){return a.source}function md(a){return a.target}function nd(a){return a.radius}function od(a){return a.startAngle}function pd(a){return a.endAngle}function qd(a){return[a.x,a.y]}function rd(a){return function(){var b=a.apply(this,arguments),c=b[0],d=b[1]+Fc;return[c*Math.cos(d),c*Math.sin(d)]}}function sd(){return 64}function td(){return"circle"}function ud(a){var b=Math.sqrt(a/Math.PI);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+ -b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function yd(a,b){a.attr("transform",function(a){return"translate("+b(a)+",0)"})}function zd(a,b){a.attr("transform",function(a){return"translate(0,"+b(a)+")"})}function Ad(a,b,c){e=[];if(c&&b.length>1){var d=fc(a.domain()),e,f=-1,g=b.length,h=(b[1]-b[0])/++c,i,j;while(++f<g)for(i=c;--i>0;)(j=+b[f]-i*h)>=d[0]&&e.push(j);for(--f,i=0;++i<c&&(j=+b[f]+i*h)<d[1];)e.push(j)}return e}function Fd(){Dd||(Dd=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var a=d3.event,b;try{Dd.scrollTop=1e3,Dd.dispatchEvent(a),b=1e3-Dd.scrollTop}catch(c){b=a.wheelDelta||-a.detail*5}return b}function Gd(a){var b=a.source,c=a.target,d=Id(b,c),e=[b];while(b!==d)b=b.parent,e.push(b);var f=e.length;while(c!==d)e.splice(f,0,c),c=c.parent;return e}function Hd(a){var b=[],c=a.parent;while(c!=null)b.push(a),a=c,c=c.parent;return b.push(a),b}function Id(a,b){if(a===b)return a;var c=Hd(a),d=Hd(b),e=c.pop(),f=d.pop(),g=null;while(e===f)g=e,e=c.pop(),f=d.pop();return g}function Ld(a){a.fixed|=2}function Md(a){a!==Kd&&(a.fixed&=1)}function Nd(){Kd.fixed&=1,Jd=Kd=null}function Od(){Kd.px=d3.event.x,Kd.py=d3.event.y,Jd.resume()}function Pd(a,b,c){var d=0,e=0;a.charge=0;if(!a.leaf){var f=a.nodes,g=f.length,h=-1,i;while(++h<g){i=f[h];if(i==null)continue;Pd(i,b,c),a.charge+=i.charge,d+=i.charge*i.cx,e+=i.charge*i.cy}}if(a.point){a.leaf||(a.point.x+=Math.random()-.5,a.point.y+=Math.random()-.5);var j=b*c[a.point.index];a.charge+=a.pointCharge=j,d+=j*a.point.x,e+=j*a.point.y}a.cx=d/a.charge,a.cy=e/a.charge}function Qd(a){return 20}function Rd(a){return 1}function Td(a){return a.x}function Ud(a){return a.y}function Vd(a,b,c){a.y0=b,a.y=c}function Yd(a){return d3.range(a.length)}function Zd(a){var b=-1,c=a[0].length,d=[];while(++b<c)d[b]=0;return d}function $d(a){var b=1,c=0,d=a[0][1],e,f=a.length;for(;b<f;++b)(e=a[b][1])>d&&(c=b,d=e);return c}function _d(a){return a.reduce(ae,0)}function ae(a,b){return a+b[1]}function be(a,b){return ce(a,Math.ceil(Math.log(b.length)/Math.LN2+1))}function ce(a,b){var c=-1,d=+a[0],e=(a[1]-d)/b,f=[];while(++c<=b)f[c]=e*c+d;return f}function de(a){return[d3.min(a),d3.max(a)]}function ee(a,b){return d3.rebind(a,b,"sort","children","value"),a.links=ie,a.nodes=function(b){return je=!0,(a.nodes=a)(b)},a}function fe(a){return a.children}function ge(a){return a.value}function he(a,b){return b.value-a.value}function ie(a){return d3.merge(a.map(function(a){return(a.children||[]).map(function(b){return{source:a,target:b}})}))}function ke(a,b){return a.value-b.value}function le(a,b){var c=a._pack_next;a._pack_next=b,b._pack_prev=a,b._pack_next=c,c._pack_prev=b}function me(a,b){a._pack_next=b,b._pack_prev=a}function ne(a,b){var c=b.x-a.x,d=b.y-a.y,e=a.r+b.r;return e*e-c*c-d*d>.001}function oe(a){function l(a){b=Math.min(a.x-a.r,b),c=Math.max(a.x+a.r,c),d=Math.min(a.y-a.r,d),e=Math.max(a.y+a.r,e)}var b=Infinity,c=-Infinity,d=Infinity,e=-Infinity,f=a.length,g,h,i,j,k;a.forEach(pe),g=a[0],g.x=-g.r,g.y=0,l(g);if(f>1){h=a[1],h.x=h.r,h.y=0,l(h);if(f>2){i=a[2],te(g,h,i),l(i),le(g,i),g._pack_prev=i,le(i,h),h=g._pack_next;for(var m=3;m<f;m++){te(g,h,i=a[m]);var n=0,o=1,p=1;for(j=h._pack_next;j!==h;j=j._pack_next,o++)if(ne(j,i)){n=1;break}if(n==1)for(k=g._pack_prev;k!==j._pack_prev;k=k._pack_prev,p++)if(ne(k,i))break;n?(o<p||o==p&&h.r<g.r?me(g,h=j):me(g=k,h),m--):(le(g,i),h=i,l(i))}}}var q=(b+c)/2,r=(d+e)/2,s=0;for(var m=0;m<f;m++){var t=a[m];t.x-=q,t.y-=r,s=Math.max(s,t.r+Math.sqrt(t.x*t.x+t.y*t.y))}return a.forEach(qe),s}function pe(a){a._pack_next=a._pack_prev=a}function qe(a){delete a._pack_next,delete a._pack_prev}function re(a){var b=a.children;b&&b.length?(b.forEach(re),a.r=oe(b)):a.r=Math.sqrt(a.value)}function se(a,b,c,d){var e=a.children;a.x=b+=d*a.x,a.y=c+=d*a.y,a.r*=d;if(e){var f=-1,g=e.length;while(++f<g)se(e[f],b,c,d)}}function te(a,b,c){var d=a.r+c.r,e=b.x-a.x,f=b.y-a.y;if(d&&(e||f)){var g=b.r+c.r,h=Math.sqrt(e*e+f*f),i=Math.max(-1,Math.min(1,(d*d+h*h-g*g)/(2*d*h))),j=Math.acos(i),k=i*(d/=h),l=Math.sin(j)*d;c.x=a.x+k*e+l*f,c.y=a.y+k*f-l*e}else c.x=a.x+d,c.y=a.y}function ue(a){return 1+d3.max(a,function(a){return a.y})}function ve(a){return a.reduce(function(a,b){return a+b.x},0)/a.length}function we(a){var b=a.children;return b&&b.length?we(b[0]):a}function xe(a){var b=a.children,c;return b&&(c=b.length)?xe(b[c-1]):a}function ye(a,b){return a.parent==b.parent?1:2}function ze(a){var b=a.children;return b&&b.length?b[0]:a._tree.thread}function Ae(a){var b=a.children,c;return b&&(c=b.length)?b[c-1]:a._tree.thread}function Be(a,b){var c=a.children;if(c&&(e=c.length)){var d,e,f=-1;while(++f<e)b(d=Be(c[f],b),a)>0&&(a=d)}return a}function Ce(a,b){return a.x-b.x}function De(a,b){return b.x-a.x}function Ee(a,b){return a.depth-b.depth}function Fe(a,b){function c(a,d){var e=a.children;if(e&&(i=e.length)){var f,g=null,h=-1,i;while(++h<i)f=e[h],c(f,g),g=f}b(a,d)}c(a,null)}function Ge(a){var b=0,c=0,d=a.children,e=d.length,f;while(--e>=0)f=d[e]._tree,f.prelim+=b,f.mod+=b,b+=f.shift+(c+=f.change)}function He(a,b,c){a=a._tree,b=b._tree;var d=c/(b.number-a.number);a.change+=d,b.change-=d,b.shift+=c,b.prelim+=c,b.mod+=c}function Ie(a,b,c){return a._tree.ancestor.parent==b.parent?a._tree.ancestor:c}function Je(a){return{x:a.x,y:a.y,dx:a.dx,dy:a.dy}}function Ke(a,b){var c=a.x+b[3],d=a.y+b[0],e=a.dx-b[1]-b[3],f=a.dy-b[0]-b[2];return e<0&&(c+=e/2,e=0),f<0&&(d+=f/2,f=0),{x:c,y:d,dx:e,dy:f}}function Le(a){return a.map(Me).join(",")}function Me(a){return/[",\n]/.test(a)?'"'+a.replace(/\"/g,'""')+'"':a}function Oe(a,b){return function(c){return c&&a.hasOwnProperty(c.type)?a[c.type](c):b}}function Pe(a){return"m0,"+a+"a"+a+","+a+" 0 1,1 0,"+ -2*a+"a"+a+","+a+" 0 1,1 0,"+2*a+"z"}function Qe(a,b){Re.hasOwnProperty(a.type)&&Re[a.type](a,b)}function Se(a,b){Qe(a.geometry,b)}function Te(a,b){for(var c=a.features,d=0,e=c.length;d<e;d++)Qe(c[d].geometry,b)}function Ue(a,b){for(var c=a.geometries,d=0,e=c.length;d<e;d++)Qe(c[d],b)}function Ve(a,b){for(var c=a.coordinates,d=0,e=c.length;d<e;d++)b.apply(null,c[d])}function We(a,b){for(var c=a.coordinates,d=0,e=c.length;d<e;d++)for(var f=c[d],g=0,h=f.length;g<h;g++)b.apply(null,f[g])}function Xe(a,b){for(var c=a.coordinates,d=0,e=c.length;d<e;d++)for(var f=c[d][0],g=0,h=f.length;g<h;g++)b.apply(null,f[g])}function Ye(a,b){b.apply(null,a.coordinates)}function Ze(a,b){for(var c=a.coordinates[0],d=0,e=c.length;d<e;d++)b.apply(null,c[d])}function $e(a){return a.source}function _e(a){return a.target}function af(a,b){function q(a){var b=Math.sin(o-(a*=o))/p,c=Math.sin(a)/p,f=b*g*d+c*m*j,i=b*g*e+c*m*k,l=b*h+c*n;return[Math.atan2(i,f)/Ne,Math.atan2(l,Math.sqrt(f*f+i*i))/Ne]}var c=a[0]*Ne,d=Math.cos(c),e=Math.sin(c),f=a[1]*Ne,g=Math.cos(f),h=Math.sin(f),i=b[0]*Ne,j=Math.cos(i),k=Math.sin(i),l=b[1]*Ne,m=Math.cos(l),n=Math.sin(l),o=q.d=Math.acos(Math.max(-1,Math.min(1,h*n+g*m*Math.cos(i-c)))),p=Math.sin(o);return q}function df(a){var b=0,c=0;for(;;){if(a(b,c))return[b,c];b===0?(b=c+1,c=0):(b-=1,c+=1)}}function ef(a,b,c,d){var e,f,g,h,i,j,k;return e=d[a],f=e[0],g=e[1],e=d[b],h=e[0],i=e[1],e=d[c],j=e[0],k=e[1],(k-g)*(h-f)-(i-g)*(j-f)>0}function ff(a,b,c){return(c[0]-b[0])*(a[1]-b[1])<(c[1]-b[1])*(a[0]-b[0])}function gf(a,b,c,d){var e=a[0],f=b[0],g=c[0],h=d[0],i=a[1],j=b[1],k=c[1],l=d[1],m=e-g,n=f-e,o=h-g,p=i-k,q=j-i,r=l-k,s=(o*p-r*m)/(r*n-o*q);return[e+s*n,i+s*q]}function jf(a,b){var c={list:a.map(function(a,b){return{index:b,x:a[0],y:a[1]}}).sort(function(a,b){return a.y<b.y?-1:a.y>b.y?1:a.x<b.x?-1:a.x>b.x?1:0}),bottomSite:null},d={list:[],leftEnd:null,rightEnd:null,init:function(){d.leftEnd=d.createHalfEdge(null,"l"),d.rightEnd=d.createHalfEdge(null,"l"),d.leftEnd.r=d.rightEnd,d.rightEnd.l=d.leftEnd,d.list.unshift(d.leftEnd,d.rightEnd)},createHalfEdge:function(a,b){return{edge:a,side:b,vertex:null,l:null,r:null}},insert:function(a,b){b.l=a,b.r=a.r,a.r.l=b,a.r=b},leftBound:function(a){var b=d.leftEnd;do b=b.r;while(b!=d.rightEnd&&e.rightOf(b,a));return b=b.l,b},del:function(a){a.l.r=a.r,a.r.l=a.l,a.edge=null},right:function(a){return a.r},left:function(a){return a.l},leftRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[a.side]},rightRegion:function(a){return a.edge==null?c.bottomSite:a.edge.region[hf[a.side]]}},e={bisect:function(a,b){var c={region:{l:a,r:b},ep:{l:null,r:null}},d=b.x-a.x,e=b.y-a.y,f=d>0?d:-d,g=e>0?e:-e;return c.c=a.x*d+a.y*e+(d*d+e*e)*.5,f>g?(c.a=1,c.b=e/d,c.c/=d):(c.b=1,c.a=d/e,c.c/=e),c},intersect:function(a,b){var c=a.edge,d=b.edge;if(!c||!d||c.region.r==d.region.r)return null;var e=c.a*d.b-c.b*d.a;if(Math.abs(e)<1e-10)return null;var f=(c.c*d.b-d.c*c.b)/e,g=(d.c*c.a-c.c*d.a)/e,h=c.region.r,i=d.region.r,j,k;h.y<i.y||h.y==i.y&&h.x<i.x?(j=a,k=c):(j=b,k=d);var l=f>=k.region.r.x;return l&&j.side==="l"||!l&&j.side==="r"?null:{x:f,y:g}},rightOf:function(a,b){var c=a.edge,d=c.region.r,e=b.x>d.x;if(e&&a.side==="l")return 1;if(!e&&a.side==="r")return 0;if(c.a===1){var f=b.y-d.y,g=b.x-d.x,h=0,i=0;!e&&c.b<0||e&&c.b>=0?i=h=f>=c.b*g:(i=b.x+b.y*c.b>c.c,c.b<0&&(i=!i),i||(h=1));if(!h){var j=d.x-c.region.l.x;i=c.b*(g*g-f*f)<j*f*(1+2*g/j+c.b*c.b),c.b<0&&(i=!i)}}else{var k=c.c-c.a*b.x,l=b.y-k,m=b.x-d.x,n=k-d.y;i=l*l>m*m+n*n}return a.side==="l"?i:!i},endPoint:function(a,c,d){a.ep[c]=d;if(!a.ep[hf[c]])return;b(a)},distance:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}},f={list:[],insert:function(a,b,c){a.vertex=b,a.ystar=b.y+c;for(var d=0,e=f.list,g=e.length;d<g;d++){var h=e[d];if(a.ystar>h.ystar||a.ystar==h.ystar&&b.x>h.vertex.x)continue;break}e.splice(d,0,a)},del:function(a){for(var b=0,c=f.list,d=c.length;b<d&&c[b]!=a;++b);c.splice(b,1)},empty:function(){return f.list.length===0},nextEvent:function(a){for(var b=0,c=f.list,d=c.length;b<d;++b)if(c[b]==a)return c[b+1];return null},min:function(){var a=f.list[0];return{x:a.vertex.x,y:a.ystar}},extractMin:function(){return f.list.shift()}};d.init(),c.bottomSite=c.list.shift();var g=c.list.shift(),h,i,j,k,l,m,n,o,p,q,r,s,t;for(;;){f.empty()||(h=f.min());if(g&&(f.empty()||g.y<h.y||g.y==h.y&&g.x<h.x))i=d.leftBound(g),j=d.right(i),n=d.rightRegion(i),s=e.bisect(n,g),m=d.createHalfEdge(s,"l"),d.insert(i,m),q=e.intersect(i,m),q&&(f.del(i),f.insert(i,q,e.distance(q,g))),i=m,m=d.createHalfEdge(s,"r"),d.insert(i,m),q=e.intersect(m,j),q&&f.insert(m,q,e.distance(q,g)),g=c.list.shift();else{if(!!f.empty())break;i=f.extractMin(),k=d.left(i),j=d.right(i),l=d.right(j),n=d.leftRegion(i),o=d.rightRegion(j),r=i.vertex,e.endPoint(i.edge,i.side,r),e.endPoint(j.edge,j.side,r),d.del(i),f.del(j),d.del(j),t="l",n.y>o.y&&(p=n,n=o,o=p,t="r"),s=e.bisect(n,o),m=d.createHalfEdge(s,t),d.insert(k,m),e.endPoint(s,hf[t],r),q=e.intersect(k,m),q&&(f.del(k),f.insert(k,q,e.distance(q,n))),q=e.intersect(m,l),q&&f.insert(m,q,e.distance(q,n))}}for(i=d.right(d.leftEnd);i!=d.rightEnd;i=d.right(i))b(i.edge)}function kf(){return{leaf:!0,nodes:[],point:null}}function lf(a,b,c,d,e,f){if(!a(b,c,d,e,f)){var g=(c+e)*.5,h=(d+f)*.5,i=b.nodes;i[0]&&lf(a,i[0],c,d,g,h),i[1]&&lf(a,i[1],g,d,e,h),i[2]&&lf(a,i[2],c,h,g,f),i[3]&&lf(a,i[3],g,h,e,f)}}function mf(a){return{x:a[0],y:a[1]}}function of(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function qf(a,b,c,d){var e,f,g=0,h=b.length,i=c.length;while(g<h){if(d>=i)return-1;e=b.charCodeAt(g++);if(e==37){f=wf[b.charAt(g++)];if(!f||(d=f(a,c,d))<0)return-1}else if(e!=c.charCodeAt(d++))return-1}return d}function xf(a,b,c){return zf.test(b.substring(c,c+=3))?c:-1}function yf(a,b,c){Af.lastIndex=0;var d=Af.exec(b.substring(c,c+10));return d?c+=d[0].length:-1}function Cf(a,b,c){var d=Df.get(b.substring(c,c+=3).toLowerCase());return d==null?-1:(a.m=d,c)}function Ef(a,b,c){Ff.lastIndex=0;var d=Ff.exec(b.substring(c,c+12));return d?(a.m=Gf.get(d[0].toLowerCase()),c+=d[0].length):-1}function If(a,b,c){return qf(a,vf.c.toString(),b,c)}function Jf(a,b,c){return qf(a,vf.x.toString(),b,c)}function Kf(a,b,c){return qf(a,vf.X.toString(),b,c)}function Lf(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+4));return d?(a.y=+d[0],c+=d[0].length):-1}function Mf(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+2));return d?(a.y=Nf()+ +d[0],c+=d[0].length):-1}function Nf(){return~~((new Date).getFullYear()/1e3)*1e3}function Of(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+2));return d?(a.m=d[0]-1,c+=d[0].length):-1}function Pf(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+2));return d?(a.d=+d[0],c+=d[0].length):-1}function Qf(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+2));return d?(a.H=+d[0],c+=d[0].length):-1}function Rf(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+2));return d?(a.M=+d[0],c+=d[0].length):-1}function Sf(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+2));return d?(a.S=+d[0],c+=d[0].length):-1}function Tf(a,b,c){Uf.lastIndex=0;var d=Uf.exec(b.substring(c,c+3));return d?(a.L=+d[0],c+=d[0].length):-1}function Vf(a,b,c){var d=Wf.get(b.substring(c,c+=2).toLowerCase());return d==null?-1:(a.p=d,c)}function Xf(a){var b=a.getTimezoneOffset(),c=b>0?"-":"+",d=~~(Math.abs(b)/60),e=Math.abs(b)%60;return c+rf(d)+rf(e)}function Zf(a){return a.toISOString()}function $f(a,b,c){function d(b){var c=a(b),d=f(c,1);return b-c<d-b?c:d}function e(c){return b(c=a(new nf(c-1)),1),c}function f(a,c){return b(a=new nf(+a),c),a}function g(a,d,f){var g=e(a),h=[];if(f>1)while(g<d)c(g)%f||h.push(new Date(+g)),b(g,1);else while(g<d)h.push(new Date(+g)),b(g,1);return h}function h(a,b,c){try{nf=of;var d=new of;return d._=a,g(d,b,c)}finally{nf=Date}}a.floor=a,a.round=d,a.ceil=e,a.offset=f,a.range=g;var i=a.utc=_f(a);return i.floor=i,i.round=_f(d),i.ceil=_f(e),i.offset=_f(f),i.range=h,a}function _f(a){return function(b,c){try{nf=of;var d=new of;return d._=b,a(d,c)._}finally{nf=Date}}}function ag(a,b,c){function d(b){return a(b)}return d.invert=function(b){return cg(a.invert(b))},d.domain=function(b){return arguments.length?(a.domain(b),d):a.domain().map(cg)},d.nice=function(a){var b=bg(d.domain());return d.domain([a.floor(b[0]),a.ceil(b[1])])},d.ticks=function(c,e){var f=bg(d.domain());if(typeof c!="function"){var g=f[1]-f[0],h=g/c,i=d3.bisect(gg,h);if(i==gg.length)return b.year(f,c);if(!i)return a.ticks(c).map(cg);Math.log(h/gg[i-1])<Math.log(gg[i]/h)&&--i,c=b[i],e=c[1],c=c[0].range}return c(f[0],new Date(+f[1]+1),e)},d.tickFormat=function(){return c},d.copy=function(){return ag(a.copy(),b,c)},d3.rebind(d,a,"range","rangeRound","interpolate","clamp")}function bg(a){var b=a[0],c=a[a.length-1];return b<c?[b,c]:[c,b]}function cg(a){return new Date(a)}function dg(a){return function(b){var c=a.length-1,d=a[c];while(!d[1](b))d=a[--c];return d[0](b)}}function eg(a){var b=new Date(a,0,1);return b.setFullYear(a),b}function fg(a){var b=a.getFullYear(),c=eg(b),d=eg(b+1);return b+(a-c)/(d-c)}function og(a){var b=new Date(Date.UTC(a,0,1));return b.setUTCFullYear(a),b}function pg(a){var b=a.getUTCFullYear(),c=og(b),d=og(b+1);return b+(a-c)/(d-c)}Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(a){var b=CSSStyleDeclaration.prototype,c=b.setProperty;b.setProperty=function(a,b,d){c.call(this,a,b+"",d)}}d3={version:"2.9.1"};var f=h;try{f(document.documentElement.childNodes)[0].nodeType}catch(i){f=g}var j=[].__proto__?function(a,b){a.__proto__=b}:function(a,b){for(var c in b)a[c]=b[c]};d3.map=function(a){var b=new k;for(var c in a)b.set(c,a[c]);return b},e(k,{has:function(a){return l+a in this},get:function(a){return this[l+a]},set:function(a,b){return this[l+a]=b},remove:function(a){return a=l+a,a in this&&delete this[a]},keys:function(){var a=[];return this.forEach(function(b){a.push(b)}),a},values:function(){var a=[];return this.forEach(function(b,c){a.push(c)}),a},entries:function(){var a=[];return this.forEach(function(b,c){a.push({key:b,value:c})}),a},forEach:function(a){for(var b in this)b.charCodeAt(0)===m&&a.call(this,b.substring(1),this[b])}});var l="\0",m=l.charCodeAt(0);d3.functor=q,d3.rebind=function(a,b){var c=1,d=arguments.length,e;while(++c<d)a[e=arguments[c]]=r(a,b,b[e]);return a},d3.ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},d3.mean=function(a,b){var c=a.length,d,e=0,f=-1,g=0;if(arguments.length===1)while(++f<c)s(d=a[f])&&(e+=(d-e)/++g);else while(++f<c)s(d=b.call(a,a[f],f))&&(e+=(d-e)/++g);return g?e:undefined},d3.median=function(a,b){return arguments.length>1&&(a=a.map(b)),a=a.filter(s),a.length?d3.quantile(a.sort(d3.ascending),.5):undefined},d3.min=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&e>f&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&e>f&&(e=f)}return e},d3.max=function(a,b){var c=-1,d=a.length,e,f;if(arguments.length===1){while(++c<d&&((e=a[c])==null||e!=e))e=undefined;while(++c<d)(f=a[c])!=null&&f>e&&(e=f)}else{while(++c<d&&((e=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&f>e&&(e=f)}return e},d3.extent=function(a,b){var c=-1,d=a.length,e,f,g;if(arguments.length===1){while(++c<d&&((e=g=a[c])==null||e!=e))e=g=undefined;while(++c<d)(f=a[c])!=null&&(e>f&&(e=f),g<f&&(g=f))}else{while(++c<d&&((e=g=b.call(a,a[c],c))==null||e!=e))e=undefined;while(++c<d)(f=b.call(a,a[c],c))!=null&&(e>f&&(e=f),g<f&&(g=f))}return[e,g]},d3.random={normal:function(a,b){return arguments.length<2&&(b=1),arguments.length<1&&(a=0),function(){var c,d,e;do c=Math.random()*2-1,d=Math.random()*2-1,e=c*c+d*d;while(!e||e>1);return a+b*c*Math.sqrt(-2*Math.log(e)/e)}}},d3.sum=function(a,b){var c=0,d=a.length,e,f=-1;if(arguments.length===1)while(++f<d)isNaN(e=+a[f])||(c+=e);else while(++f<d)isNaN(e=+b.call(a,a[f],f))||(c+=e);return c},d3.quantile=function(a,b){var c=(a.length-1)*b+1,d=Math.floor(c),e=a[d-1],f=c-d;return f?e+f*(a[d]-e):e},d3.transpose=function(a){return d3.zip.apply(d3,a)},d3.zip=function(){if(!(e=arguments.length))return[];for(var a=-1,b=d3.min(arguments,t),c=new Array(b);++a<b;)for(var d=-1,e,f=c[a]=new Array(e);++d<e;)f[d]=arguments[d][a];return c},d3.bisector=function(a){return{left:function(b,c,d,e){arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);while(d<e){var f=d+e>>1;a.call(b,b[f],f)<c?d=f+1:e=f}return d},right:function(b,c,d,e){arguments.length<3&&(d=0),arguments.length<4&&(e=b.length);while(d<e){var f=d+e>>1;c<a.call(b,b[f],f)?e=f:d=f+1}return d}}};var u=d3.bisector(function(a){return a});d3.bisectLeft=u.left,d3.bisect=d3.bisectRight=u.right,d3.first=function(a,b){var c=0,d=a.length,e=a[0],f;arguments.length===1&&(b=d3.ascending);while(++c<d)b.call(a,e,f=a[c])>0&&(e=f);return e},d3.last=function(a,b){var c=0,d=a.length,e=a[0],f;arguments.length===1&&(b=d3.ascending);while(++c<d)b.call(a,e,f=a[c])<=0&&(e=f);return e},d3.nest=function(){function f(c,g){if(g>=b.length)return e?e.call(a,c):d?c.sort(d):c;var h=-1,i=c.length,j=b[g++],l,m,n=new k,o,p={};while(++h<i)(o=n.get(l=j(m=c[h])))?o.push(m):n.set(l,[m]);return n.forEach(function(a){p[a]=f(n.get(a),g)}),p}function g(a,d){if(d>=b.length)return a;var e=[],f=c[d++],h;for(h in a)e.push({key:h,values:g(a[h],d)});return f&&e.sort(function(a,b){return f(a.key,b.key)}),e}var a={},b=[],c=[],d,e;return a.map=function(a){return f(a,0)},a.entries=function(a){return g(f(a,0),0)},a.key=function(c){return b.push(c),a},a.sortKeys=function(d){return c[b.length-1]=d,a},a.sortValues=function(b){return d=b,a},a.rollup=function(b){return e=b,a},a},d3.keys=function(a){var b=[];for(var c in a)b.push(c);return b},d3.values=function(a){var b=[];for(var c in a)b.push(a[c]);return b},d3.entries=function(a){var b=[];for(var c in a)b.push({key:c,value:a[c]});return b},d3.permute=function(a,b){var c=[],d=-1,e=b.length;while(++d<e)c[d]=a[b[d]];return c},d3.merge=function(a){return Array.prototype.concat.apply([],a)},d3.split=function(a,b){var c=[],d=[],e,f=-1,g=a.length;arguments.length<2&&(b=v);while(++f<g)b.call(d,e=a[f],f)?d=[]:(d.length||c.push(d),d.push(e));return c},d3.range=function(a,b,c){arguments.length<3&&(c=1,arguments.length<2&&(b=a,a=0));if((b-a)/c===Infinity)throw new Error("infinite range");var d=[],e=x(Math.abs(c)),f=-1,g;a*=e,b*=e,c*=e;if(c<0)while((g=a+c*++f)>b)d.push(g/e);else while((g=a+c*++f)<b)d.push(g/e);return d},d3.requote=function(a){return a.replace(y,"\\$&")};var y=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(a,b){return b?Math.round(a*(b=Math.pow(10,b)))/b:Math.round(a)},d3.xhr=function(a,b,c){var d=new XMLHttpRequest;arguments.length<3?(c=b,b=null):b&&d.overrideMimeType&&d.overrideMimeType(b),d.open("GET",a,!0),b&&d.setRequestHeader("Accept",b),d.onreadystatechange=function(){if(d.readyState===4){var a=d.status;c(a>=200&&a<300||a===304?d:null)}},d.send(null)},d3.text=function(a,b,c){function d(a){c(a&&a.responseText)}arguments.length<3&&(c=b,b=null),d3.xhr(a,b,d)},d3.json=function(a,b){d3.text(a,"application/json",function(a){b(a?JSON.parse(a):null)})},d3.html=function(a,b){d3.text(a,"text/html",function(a){if(a!=null){var c=document.createRange();c.selectNode(document.body),a=c.createContextualFragment(a)}b(a)})},d3.xml=function(a,b,c){function d(a){c(a&&a.responseXML)}arguments.length<3&&(c=b,b=null),d3.xhr(a,b,d)};var z={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:z,qualify:function(a){var b=a.indexOf(":"),c=a;return b>=0&&(c=a.substring(0,b),a=a.substring(b+1)),z.hasOwnProperty(c)?{space:z[c],local:a}:a}},d3.dispatch=function(){var a=new A,b=-1,c=arguments.length;while(++b<c)a[arguments[b]]=B(a);return a},A.prototype.on=function(a,b){var c=a.indexOf("."),d="";return c>0&&(d=a.substring(c+1),a=a.substring(0,c)),arguments.length<2?this[a].on(d):this[a].on(d,b)},d3.format=function(a){var b=C.exec(a),c=b[1]||" ",d=b[3]||"",e=b[5],f=+b[6],g=b[7],h=b[8],i=b[9],j=1,k="",l=!1;h&&(h=+h.substring(1)),e&&(c="0",g&&(f-=Math.floor((f-1)/4)));switch(i){case"n":g=!0,i="g";break;case"%":j=100,k="%",i="f";break;case"p":j=100,k="%",i="r";break;case"d":l=!0,h=0;break;case"s":j=-1,i="r"}return i=="r"&&!h&&(i="g"),i=D.get(i)||F,function(a){if(l&&a%1)return"";var b=a<0&&(a=-a)?"−":d;if(j<0){var m=d3.formatPrefix(a,h);a*=m.scale,k=m.symbol}else a*=j;a=i(a,h);if(e){var n=a.length+b.length;n<f&&(a=(new Array(f-n+1)).join(c)+a),g&&(a=G(a)),a=b+a}else{g&&(a=G(a)),a=b+a;var n=a.length;n<f&&(a=(new Array(f-n+1)).join(c)+a)}return a+k}};var C=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,D=d3.map({g:function(a,b){return a.toPrecision(b)},e:function(a,b){return a.toExponential(b)},f:function(a,b){return a.toFixed(b)},r:function(a,b){return d3.round(a,b=E(a,b)).toFixed(Math.max(0,Math.min(20,b)))}}),H=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(I);d3.formatPrefix=function(a,b){var c=0;return a&&(a<0&&(a*=-1),b&&(a=d3.round(a,E(a,b))),c=1+Math.floor(1e-12+Math.log(a)/Math.LN10),c=Math.max(-24,Math.min(24,Math.floor((c<=0?c+1:c-1)/3)*3))),H[8+c/3]};var J=S(2),K=S(3),L=function(){return R},M=d3.map({linear:L,poly:S,quad:function(){return J},cubic:function(){return K},sin:function(){return T},exp:function(){return U},circle:function(){return V},elastic:W,back:X,bounce:function(){return Y}}),N=d3.map({"in":R,out:P,"in-out":Q,"out-in":function(a){return Q(P(a))}});d3.ease=function(a){var b=a.indexOf("-"),c=b>=0?a.substring(0,b):a,d=b>=0?a.substring(b+1):"in";return c=M.get(c)||L,d=N.get(d)||R,O(d(c.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.interpolate=function(a,b){var c=d3.interpolators.length,d;while(--c>=0&&!(d=d3.interpolators[c](a,b)));return d},d3.interpolateNumber=function(a,b){return b-=a,function(c){return a+b*c}},d3.interpolateRound=function(a,b){return b-=a,function(c){return Math.round(a+b*c)}},d3.interpolateString=function(a,b){var c,d,e,f=0,g=0,h=[],i=[],j,k;ab.lastIndex=0;for(d=0;c=ab.exec(b);++d)c.index&&h.push(b.substring(f,g=c.index)),i.push({i:h.length,x:c[0]}),h.push(null),f=ab.lastIndex;f<b.length&&h.push(b.substring(f));for(d=0,j=i.length;(c=ab.exec(a))&&d<j;++d){k=i[d];if(k.x==c[0]){if(k.i)if(h[k.i+1]==null){h[k.i-1]+=k.x,h.splice(k.i,1);for(e=d+1;e<j;++e)i[e].i--}else{h[k.i-1]+=k.x+h[k.i+1],h.splice(k.i,2);for(e=d+1;e<j;++e)i[e].i-=2}else if(h[k.i+1]==null)h[k.i]=k.x;else{h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1);for(e=d+1;e<j;++e)i[e].i--}i.splice(d,1),j--,d--}else k.x=d3.interpolateNumber(parseFloat(c[0]),parseFloat(k.x))}while(d<j)k=i.pop(),h[k.i+1]==null?h[k.i]=k.x:(h[k.i]=k.x+h[k.i+1],h.splice(k.i+1,1)),j--;return h.length===1?h[0]==null?i[0].x:function(){return b}:function(a){for(d=0;d<j;++d)h[(k=i[d]).i]=k.x(a);return h.join("")}},d3.interpolateTransform=function(a,b){var c=[],d=[],e,f=d3.transform(a),g=d3.transform(b),h=f.translate,i=g.translate,j=f.rotate,k=g.rotate,l=f.skew,m=g.skew,n=f.scale,o=g.scale;return h[0]!=i[0]||h[1]!=i[1]?(c.push("translate(",null,",",null,")"),d.push({i:1,x:d3.interpolateNumber(h[0],i[0])},{i:3,x:d3.interpolateNumber(h[1],i[1])})):i[0]||i[1]?c.push("translate("+i+")"):c.push(""),j!=k?d.push({i:c.push(c.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(j,k)}):k&&c.push(c.pop()+"rotate("+k+")"),l!=m?d.push({i:c.push(c.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(l,m)}):m&&c.push(c.pop()+"skewX("+m+")"),n[0]!=o[0]||n[1]!=o[1]?(e=c.push(c.pop()+"scale(",null,",",null,")"),d.push({i:e-4,x:d3.interpolateNumber(n[0],o[0])},{i:e-2,x:d3.interpolateNumber(n[1],o[1])})):(o[0]!=1||o[1]!=1)&&c.push(c.pop()+"scale("+o+")"),e=d.length,function(a){var b=-1,f;while(++b<e)c[(f=d[b]).i]=f.x(a);return c.join("")}},d3.interpolateRgb=function(a,b){a=d3.rgb(a),b=d3.rgb(b);var c=a.r,d=a.g,e=a.b,f=b.r-c,g=b.g-d,h=b.b-e;return function(a){return"#"+gb(Math.round(c+f*a))+gb(Math.round(d+g*a))+gb(Math.round(e+h*a))}},d3.interpolateHsl=function(a,b){a=d3.hsl(a),b=d3.hsl(b);var c=a.h,d=a.s,e=a.l,f=b.h-c,g=b.s-d,h=b.l-e;return function(a){return nb(c+f*a,d+g*a,e+h*a).toString()}},d3.interpolateArray=function(a,b){var c=[],d=[],e=a.length,f=b.length,g=Math.min(a.length,b.length),h;for(h=0;h<g;++h)c.push(d3.interpolate(a[h],b[h]));for(;h<e;++h)d[h]=a[h];for(;h<f;++h)d[h]=b[h];return function(a){for(h=0;h<g;++h)d[h]=c[h](a);return d}},d3.interpolateObject=function(a,b){var c={},d={},e;for(e in a)e in b?c[e]=bb(e)(a[e],b[e]):d[e]=a[e];for(e in b)e in a||(d[e]=b[e]);return function(a){for(e in c)d[e]=c[e](a);return d}};var ab=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(a,b){return b instanceof Array&&d3.interpolateArray(a,b)},function(a,b){return(typeof a=="string"||typeof b=="string")&&d3.interpolateString(a+"",b+"")},function(a,b){return(typeof b=="string"?kb.has(b)||/^(#|rgb\(|hsl\()/.test(b):b instanceof fb||b instanceof mb)&&d3.interpolateRgb(a,b)},function(a,b){return!isNaN(a=+a)&&!isNaN(b=+b)&&d3.interpolateNumber(a,b)}],d3.rgb=function(a,b,c){return arguments.length===1?a instanceof fb?eb(a.r,a.g,a.b):hb(""+a,eb,nb):eb(~~a,~~b,~~c)},fb.prototype.brighter=function(a){a=Math.pow(.7,arguments.length?a:1);var b=this.r,c=this.g,d=this.b,e=30;return!b&&!c&&!d?eb(e,e,e):(b&&b<e&&(b=e),c&&c<e&&(c=e),d&&d<e&&(d=e),eb(Math.min(255,Math.floor(b/a)),Math.min(255,Math.floor(c/a)),Math.min(255,Math.floor(d/a))))},fb.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),eb(Math.floor(a*this.r),Math.floor(a*this.g),Math.floor(a*this.b))},fb.prototype.hsl=function(){return ib(this.r,this.g,this.b)},fb.prototype.toString=function(){return"#"+gb(this.r)+gb(this.g)+gb(this.b)};var kb=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});kb.forEach(function(a,b){kb.set(a,hb(b,eb,nb))}),d3.hsl=function(a,b,c){return arguments.length===1?a instanceof mb?lb(a.h,a.s,a.l):hb(""+a,ib,lb):lb(+a,+b,+c)},mb.prototype.brighter=function(a){return a=Math.pow(.7,arguments.length?a:1),lb(this.h,this.s,this.l/a)},mb.prototype.darker=function(a){return a=Math.pow(.7,arguments.length?a:1),lb(this.h,this.s,a*this.l)},mb.prototype.rgb=function(){return nb(this.h,this.s,this.l)},mb.prototype.toString=function(){return this.rgb().toString()};var pb=function(a,b){return b.querySelector(a)},qb=function(a,b){return b.querySelectorAll(a)},rb=document.documentElement,sb=rb.matchesSelector||rb.webkitMatchesSelector||rb.mozMatchesSelector||rb.msMatchesSelector||rb.oMatchesSelector,tb=function(a,b){return sb.call(a,b)};typeof Sizzle=="function"&&(pb=function(a,b){return Sizzle(a,b)[0]},qb=function(a,b){return Sizzle.uniqueSort(Sizzle(a,b))},tb=Sizzle.matchesSelector);var ub=[];d3.selection=function(){return Cb},d3.selection.prototype=ub,ub.select=function(a){var b=[],c,d,e,f;typeof a!="function"&&(a=vb(a));for(var g=-1,h=this.length;++g<h;){b.push(c=[]),c.parentNode=(e=this[g]).parentNode;for(var i=-1,j=e.length;++i<j;)(f=e[i])?(c.push(d=a.call(f,f.__data__,i)),d&&"__data__"in f&&(d.__data__=f.__data__)):c.push(null)}return ob(b)},ub.selectAll=function(a){var b=[],c,d;typeof a!="function"&&(a=wb(a));for(var e=-1,g=this.length;++e<g;)for(var h=this[e],i=-1,j=h.length;++i<j;)if(d=h[i])b.push(c=f(a.call(d,d.__data__,i))),c.parentNode=d;return ob(b)},ub.attr=function(a,b){function d(){this.removeAttribute(a)}function e(){this.removeAttributeNS(a.space,a.local)}function f(){this.setAttribute(a,b)}function g(){this.setAttributeNS(a.space,a.local,b)}function h(){var c=b.apply(this,arguments);c==null?this.removeAttribute(a):this.setAttribute(a,c)}function i(){var c=b.apply(this,arguments);c==null?this.removeAttributeNS(a.space,a.local):this.setAttributeNS(a.space,a.local,c)}a=d3.ns.qualify(a);if(arguments.length<2){var c=this.node();return a.local?c.getAttributeNS(a.space,a.local):c.getAttribute(a)}return this.each(b==null?a.local?e:d:typeof b=="function"?a.local?i:h:a.local?g:f)},ub.classed=function(a,b){var c=a.split(xb),d=c.length,e=-1;if(arguments.length>1){while(++e<d)yb.call(this,c[e],b);return this}while(++e<d)if(!yb.call(this,c[e]))return!1;return!0};var xb=/\s+/g;ub.style=function(a,b,c){function d(){this.style.removeProperty(a)}function e(){this.style.setProperty(a,b,c)}function f(){var d=b.apply(this,arguments);d==null?this.style.removeProperty(a):this.style.setProperty(a,d,c)}return arguments.length<3&&(c=""),arguments.length<2?window.getComputedStyle(this.node(),null).getPropertyValue(a):this.each(b==null?d:typeof b=="function"?f:e)},ub.property=function(a,b){function c(){delete this[a]}function d(){this[a]=b}function e(){var c=b.apply(this,arguments);c==null?delete this[a]:this[a]=c}return arguments.length<2?this.node()[a]:this.each(b==null?c:typeof b=="function"?e:d)},ub.text=function(a){return arguments.length<1?this.node().textContent:this.each(typeof a=="function"?function(){var b=a.apply(this,arguments);this.textContent=b==null?"":b}:a==null?function(){this.textContent=""}:function(){this.textContent=a})},ub.html=function(a){return arguments.length<1?this.node().innerHTML:this.each(typeof a=="function"?function(){var b=a.apply(this,arguments);this.innerHTML=b==null?"":b}:a==null?function(){this.innerHTML=""}:function(){this.innerHTML=a})},ub.append=function(a){function b(){return this.appendChild(document.createElementNS(this.namespaceURI,a))}function c(){return this.appendChild(document.createElementNS(a.space,a.local))}return a=d3.ns.qualify(a),this.select(a.local?c:b)},ub.insert=function(a,b){function c(){return this.insertBefore(document.createElementNS(this.namespaceURI,a),pb(b,this))}function d(){return this.insertBefore(document.createElementNS(a.space,a.local),pb(b,this))}return a=d3.ns.qualify(a),this.select(a.local?d:c)},ub.remove=function(){return this.each(function(){var a=this.parentNode;a&&a.removeChild(this)})},ub.data=function(a,b){function g(a,c){var d,e=a.length,f=c.length,g=Math.min(e,f),l=Math.max(e,f),m=[],n=[],o=[],p,q;if(b){var r=new k,s=[],t,u=c.length;for(d=-1;++d<e;)t=b.call(p=a[d],p.__data__,d),r.has(t)?o[u++]=p:r.set(t,p),s.push(t);for(d=-1;++d<f;)t=b.call(c,q=c[d],d),r.has(t)?(m[d]=p=r.get(t),p.__data__=q,n[d]=o[d]=null):(n[d]=zb(q),m[d]=o[d]=null),r.remove(t);for(d=-1;++d<e;)r.has(s[d])&&(o[d]=a[d])}else{for(d=-1;++d<g;)p=a[d],q=c[d],p?(p.__data__=q,m[d]=p,n[d]=o[d]=null):(n[d]=zb(q),m[d]=o[d]=null);for(;d<f;++d)n[d]=zb(c[d]),m[d]=o[d]=null;for(;d<l;++d)o[d]=a[d],n[d]=m[d]=null}n.update=m,n.parentNode=m.parentNode=o.parentNode=a.parentNode,h.push(n),i.push(m),j.push(o)}var c=-1,d=this.length,e,f;if(!arguments.length){a=new Array(d=(e=this[0]).length);while(++c<d)if(f=e[c])a[c]=f.__data__;return a}var h=Db([]),i=ob([]),j=ob([]);if(typeof a=="function")while(++c<d)g(e=this[c],a.call(e,e.parentNode.__data__,c));else while(++c<d)g(e=this[c],a);return i.enter=function(){return h},i.exit=function(){return j},i},ub.datum=ub.map=function(a){return arguments.length<1?this.property("__data__"):this.property("__data__",a)},ub.filter=function(a){var b=[],c,d,e;typeof a!="function"&&(a=Ab(a));for(var f=0,g=this.length;f<g;f++){b.push(c=[]),c.parentNode=(d=this[f]).parentNode;for(var h=0,i=d.length;h<i;h++)(e=d[h])&&a.call(e,e.__data__,h)&&c.push(e)}return ob(b)},ub.order=function(){for(var a=-1,b=this.length;++a<b;)for(var c=this[a],d=c.length-1,e=c[d],f;--d>=0;)if(f=c[d])e&&e!==f.nextSibling&&e.parentNode.insertBefore(f,e),e=f;return this},ub.sort=function(a){a=Bb.apply(this,arguments);for(var b=-1,c=this.length;++b<c;)this[b].sort(a);return this.order()},ub.on=function(a,b,c){arguments.length<3&&(c=!1);var d="__on"+a,e=a.indexOf(".");return e>0&&(a=a.substring(0,e)),arguments.length<2?(e=this.node()[d])&&e._:this.each(function(e,f){function i(a){var c=d3.event;d3.event=a;try{b.call(g,g.__data__,f)}finally{d3.event=c}}var g=this,h=g[d];h&&(g.removeEventListener(a,h,h.$),delete g[d]),b&&(g.addEventListener(a,g[d]=i,i.$=c),i._=b)})},ub.each=function(a){for(var b=-1,c=this.length;++b<c;)for(var d=this[b],e=-1,f=d.length;++e<f;){var g=d[e];g&&a.call(g,g.__data__,e,b)}return this},ub.call=function(a){return a.apply(this,(arguments[0]=this,arguments)),this},ub.empty=function(){return!this.node()},ub.node=function(a){for(var b=0,c=this.length;b<c;b++)for(var d=this[b],e=0,f=d.length;e<f;e++){var g=d[e];if(g)return g}return null},ub.transition=function(){var a=[],b,c;for(var d=-1,e=this.length;++d<e;){a.push(b=[]);for(var f=this[d],g=-1,h=f.length;++g<h;)b.push((c=f[g])?{node:c,delay:Pb,duration:Qb}:null)}return Fb(a,Lb||++Kb,Date.now())};var Cb=ob([[document]]);Cb[0].parentNode=rb,d3.select=function(a){return typeof a=="string"?Cb.select(a):ob([[a]])},d3.selectAll=function(a){return typeof a=="string"?Cb.selectAll(a):ob([f(a)])};var Eb=[];d3.selection.enter=Db,d3.selection.enter.prototype=Eb,Eb.append=ub.append,Eb.insert=ub.insert,Eb.empty=ub.empty,Eb.node=ub.node,Eb.select=function(a){var b=[],c,d,e,f,g;for(var h=-1,i=this.length;++h<i;){e=(f=this[h]).update,b.push(c=[]),c.parentNode=f.parentNode;for(var j=-1,k=f.length;++j<k;)(g=f[j])?(c.push(e[j]=d=a.call(f.parentNode,g.__data__,j)),d.__data__=g.__data__):c.push(null)}return ob(b)};var Gb={},Jb=[],Kb=0,Lb=0,Mb=0,Nb=250,Ob=d3.ease("cubic-in-out"),Pb=Mb,Qb=Nb,Rb=Ob;Jb.call=ub.call,d3.transition=function(a){return arguments.length?Lb?a.transition():a:Cb.transition()},d3.transition.prototype=Jb,Jb.select=function(a){var b=[],c,d,e;typeof a!="function"&&(a=vb(a));for(var f=-1,g=this.length;++f<g;){b.push(c=[]);for(var h=this[f],i=-1,j=h.length;++i<j;)(e=h[i])&&(d=a.call(e.node,e.node.__data__,i))?("__data__"in e.node&&(d.__data__=e.node.__data__),c.push({node:d,delay:e.delay,duration:e.duration})):c.push(null)}return Fb(b,this.id,this.time).ease(this.ease())},Jb.selectAll=function(a){var b=[],c,d,e;typeof a!="function"&&(a=wb(a));for(var f=-1,g=this.length;++f<g;)for(var h=this[f],i=-1,j=h.length;++i<j;)if(e=h[i]){d=a.call(e.node,e.node.__data__,i),b.push(c=[]);for(var k=-1,l=d.length;++k<l;)c.push({node:d[k],delay:e.delay,duration:e.duration})}return Fb(b,this.id,this.time).ease(this.ease())},Jb.attr=function(a,b){return this.attrTween(a,Ib(a,b))},Jb.attrTween=function(a,b){function d(a,d){var e=b.call(this,a,d,this.getAttribute(c));return e===Gb?(this.removeAttribute(c),null):e&&function(a){this.setAttribute(c,e(a))}}function e(a,d){var e=b.call(this,a,d,this.getAttributeNS(c.space,c.local));return e===Gb?(this.removeAttributeNS(c.space,c.local),null):e&&function(a){this.setAttributeNS(c.space,c.local,e(a))}}var c=d3.ns.qualify(a);return this.tween("attr."+a,c.local?e:d)},Jb.style=function(a,b,c){return arguments.length<3&&(c=""),this.styleTween(a,Ib(a,b),c)},Jb.styleTween=function(a,b,c){return arguments.length<3&&(c=""),this.tween("style."+a,function(d,e){var f=b.call(this,d,e,window.getComputedStyle(this,null).getPropertyValue(a));return f===Gb?(this.style.removeProperty(a),null):f&&function(b){this.style.setProperty(a,f(b),c)}})},Jb.text=function(a){return this.tween("text",function(b,c){this.textContent=typeof a=="function"?a.call(this,b,c):a})},Jb.remove=function(){return this.each("end.transition",function(){var a;!this.__transition__&&(a=this.parentNode)&&a.removeChild(this)})},Jb.delay=function(a){var b=this;return b.each(typeof a=="function"?function(c,d,e){b[e][d].delay=a.apply(this,arguments)|0}:(a|=0,function(c,d,e){b[e][d].delay=a}))},Jb.duration=function(a){var b=this;return b.each(typeof a=="function"?function(c,d,e){b[e][d].duration=Math.max(1,a.apply(this,arguments)|0)}:(a=Math.max(1,a|0),function(c,d,e){b[e][d].duration=a}))},Jb.transition=function(){return this.select(o)};var Tb=null,Ub,Vb;d3.timer=function(a,b,c){var d=!1,e,f=Tb;if(arguments.length<3){if(arguments.length<2)b=0;else if(!isFinite(b))return;c=Date.now()}while(f){if(f.callback===a){f.then=c,f.delay=b,d=!0;break}e=f,f=f.next}d||(Tb={callback:a,then:c,delay:b,next:Tb}),Ub||(Vb=clearTimeout(Vb),Ub=1,Yb(Wb))},d3.timer.flush=function(){var a,b=Date.now(),c=Tb;while(c)a=b-c.then,c.delay||(c.flush=c.callback(a)),c=c.next;Xb()};var Yb=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,17)};d3.transform=function(a){var b=document.createElementNS(d3.ns.prefix.svg,"g"),c={a:1,b:0,c:0,d:1,e:0,f:0};return(d3.transform=function(a){b.setAttribute("transform",a);var d=b.transform.baseVal.consolidate();return new Zb(d?d.matrix:c)})(a)},Zb.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var bc=180/Math.PI;d3.mouse=function(a){return dc(a,$())};var cc=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(a,b){return arguments.length<2&&(b=$().touches),b?f(b).map(function(b){var c=dc(a,b);return c.identifier=b.identifier,c}):[]},d3.scale={},d3.scale.linear=function(){return jc([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return rc(d3.scale.linear(),tc)};var sc=d3.format(".0e");tc.pow=function(a){return Math.pow(10,a)},uc.pow=function(a){return-Math.pow(10,-a)},d3.scale.pow=function(){return vc(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return xc([],{t:"range",x:[]})},d3.scale.category10=function(){return d3.scale.ordinal().range(yc)},d3.scale.category20=function(){return d3.scale.ordinal().range(zc)},d3.scale.category20b=function(){return d3.scale.ordinal().range(Ac)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Bc)};var yc=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],zc=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Ac=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Bc=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return Cc([],[])},d3.scale.quantize=function(){return Dc(0,1,[0,1])},d3.scale.identity=function(){return Ec([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=a.apply(this,arguments),f=b.apply(this,arguments),g=c.apply(this,arguments)+Fc,h=d.apply(this,arguments)+Fc,i=(h<g&&(i=g,g=h,h=i),h-g),j=i<Math.PI?"0":"1",k=Math.cos(g),l=Math.sin(g),m=Math.cos(h),n=Math.sin(h);return i>=Gc?e?"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+ -f+"A"+f+","+f+" 0 1,1 0,"+f+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+f+"A"+f+","+f+" 0 1,1 0,"+ -f+"A"+f+","+f+" 0 1,1 0,"+f+"Z":e?"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L"+e*m+","+e*n+"A"+e+","+e+" 0 "+j+",0 "+e*k+","+e*l+"Z":"M"+f*k+","+f*l+"A"+f+","+f+" 0 "+j+",1 "+f*m+","+f*n+"L0,0"+"Z"}var a=Hc,b=Ic,c=Jc,d=Kc;return e.innerRadius=function(b){return arguments.length?(a=q(b),e):a},e.outerRadius=function(a){return arguments.length?(b=q(a),e):b},e.startAngle=function(a){return arguments.length?(c=q(a),e):c},e.endAngle=function(a){return arguments.length?(d=q(a),e):d},e.centroid=function(){var e=(a.apply(this,arguments)+b.apply(this,arguments))/2,f=(c.apply(this,arguments)+d.apply(this,arguments))/2+Fc;return[Math.cos(f)*e,Math.sin(f)*e]},e};var Fc=-Math.PI/2,Gc=2*Math.PI-1e-6;d3.svg.line=function(){return Lc(n)};var Oc="linear",Pc=d3.map({linear:Qc,"step-before":Rc,"step-after":Sc,basis:Yc,"basis-open":Zc,"basis-closed":$c,bundle:_c,cardinal:Vc,"cardinal-open":Tc,"cardinal-closed":Uc,monotone:id}),bd=[0,2/3,1/3,0],cd=[0,1/3,2/3,0],dd=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var a=Lc(jd);return a.radius=a.x,delete a.x,a.angle=a.y,delete a.y,a},Rc.reverse=Sc,Sc.reverse=Rc,d3.svg.area=function(){return kd(Object)},d3.svg.area.radial=function(){var a=kd(jd);return a.radius=a.x,delete a.x,a.innerRadius=a.x0,delete a.x0,a.outerRadius=a.x1,delete a.x1,a.angle=a.y,delete a.y,a.startAngle=a.y0,delete a.y0,a.endAngle=a.y1,delete a.y1,a},d3.svg.chord=function(){function f(c,d){var e=g(this,a,c,d),f=g(this,b,c,d);return"M"+e.p0+i(e.r,e.p1,e.a1-e.a0)+(h(e,f)?j(e.r,e.p1,e.r,e.p0):j(e.r,e.p1,f.r,f.p0)+i(f.r,f.p1,f.a1-f.a0)+j(f.r,f.p1,e.r,e.p0))+"Z"}function g(a,b,f,g){var h=b.call(a,f,g),i=c.call(a,h,g),j=d.call(a,h,g)+Fc,k=e.call(a,h,g)+Fc;return{r:i,a0:j,a1:k,p0:[i*Math.cos(j),i*Math.sin(j)],p1:[i*Math.cos(k),i*Math.sin(k)]}}function h(a,b){return a.a0==b.a0&&a.a1==b.a1}function i(a,b,c){return"A"+a+","+a+" 0 "+ +(c>Math.PI)+",1 "+b}function j(a,b,c,d){return"Q 0,0 "+d}var a=ld,b=md,c=nd,d=Jc,e=Kc;return f.radius=function(a){return arguments.length?(c=q(a),f):c},f.source=function(b){return arguments.length?(a=q(b),f):a},f.target=function(a){return arguments.length?(b=q(a),f):b},f.startAngle=function(a){return arguments.length?(d=q(a),f):d},f.endAngle=function(a){return arguments.length?(e=q(a),f):e},f},d3.svg.diagonal=function(){function d(d,e){var f=a.call(this,d,e),g=b.call(this,d,e),h=(f.y+g.y)/2,i=[f,{x:f.x,y:h},{x:g.x,y:h},g];return i=i.map(c),"M"+i[0]+"C"+i[1]+" "+i[2]+" "+i[3]}var a=ld,b=md,c=qd;return d.source=function(b){return arguments.length?(a=q(b),d):a},d.target=function(a){return arguments.length?(b=q(a),d):b},d.projection=function(a){return arguments.length?(c=a,d):c},d},d3.svg.diagonal.radial=function(){var a=d3.svg.diagonal(),b=qd,c=a.projection;return a.projection=function(a){return arguments.length?c(rd(b=a)):b},a},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function c(c,d){return(vd.get(a.call(this,c,d))||ud)(b.call(this,c,d))}var a=td,b=sd;return c.type=function(b){return arguments.length?(a=q(b),c):a},c.size=function(a){return arguments.length?(b=q(a),c):b},c};var vd=d3.map({circle:ud,cross:function(a){var b=Math.sqrt(a/5)/2;return"M"+ -3*b+","+ -b+"H"+ -b+"V"+ -3*b+"H"+b+"V"+ -b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+ -b+"V"+b+"H"+ -3*b+"Z"},diamond:function(a){var b=Math.sqrt(a/(2*xd)),c=b*xd;return"M0,"+ -b+"L"+c+",0"+" 0,"+b+" "+ -c+",0"+"Z"},square:function(a){var b=Math.sqrt(a)/2;return"M"+ -b+","+ -b+"L"+b+","+ -b+" "+b+","+b+" "+ -b+","+b+"Z"},"triangle-down":function(a){var b=Math.sqrt(a/wd),c=b*wd/2;return"M0,"+c+"L"+b+","+ -c+" "+ -b+","+ -c+"Z"},"triangle-up":function(a){var b=Math.sqrt(a/wd),c=b*wd/2;return"M0,"+ -c+"L"+b+","+c+" "+ -b+","+c+"Z"}});d3.svg.symbolTypes=vd.keys();var wd=Math.sqrt(3),xd=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function k(k){k.each(function(){var k=d3.select(this),l=h==null?a.ticks?a.ticks.apply(a,g):a.domain():h,m=i==null?a.tickFormat?a.tickFormat.apply(a,g):String:i,n=Ad(a,l,j),o=k.selectAll(".minor").data(n,String),p=o.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),q=d3.transition(o.exit()).style("opacity",1e-6).remove(),r=d3.transition(o).style("opacity",1),s=k.selectAll("g").data(l,String),t=s.enter().insert("g","path").style("opacity",1e-6),u=d3.transition(s.exit()).style("opacity",1e-6).remove(),v=d3.transition(s).style("opacity",1),w,x=gc(a),y=k.selectAll(".domain").data([0]),z=y.enter().append("path").attr("class","domain"),A=d3.transition(y),B=a.copy(),C=this.__chart__||B;this.__chart__=B,t.append("line").attr("class","tick"),t.append("text"),v.select("text").text(m);switch(b){case"bottom":w=yd,p.attr("y2",d),r.attr("x2",0).attr("y2",d),t.select("line").attr("y2",c),t.select("text").attr("y",Math.max(c,0)+f),v.select("line").attr("x2",0).attr("y2",c),v.select("text").attr("x",0).attr("y",Math.max(c,0)+f).attr("dy",".71em").attr("text-anchor","middle"),A.attr("d","M"+x[0]+","+e+"V0H"+x[1]+"V"+e);break;case"top":w=yd,p.attr("y2",-d),r.attr("x2",0).attr("y2",-d),t.select("line").attr("y2",-c),t.select("text").attr("y",-(Math.max(c,0)+f)),v.select("line").attr("x2",0).attr("y2",-c),v.select("text").attr("x",0).attr("y",-(Math.max(c,0)+f)).attr("dy","0em").attr("text-anchor","middle"),A.attr("d","M"+x[0]+","+ -e+"V0H"+x[1]+"V"+ -e);break;case"left":w=zd,p.attr("x2",-d),r.attr("x2",-d).attr("y2",0),t.select("line").attr("x2",-c),t.select("text").attr("x",-(Math.max(c,0)+f)),v.select("line").attr("x2",-c).attr("y2",0),v.select("text").attr("x",-(Math.max(c,0)+f)).attr("y",0).attr("dy",".32em").attr("text-anchor","end"),A.attr("d","M"+ -e+","+x[0]+"H0V"+x[1]+"H"+ -e);break;case"right":w=zd,p.attr("x2",d),r.attr("x2",d).attr("y2",0),t.select("line").attr("x2",c),t.select("text").attr("x",Math.max(c,0)+f),v.select("line").attr("x2",c).attr("y2",0),v.select("text").attr("x",Math.max(c,0)+f).attr("y",0).attr("dy",".32em").attr("text-anchor","start"),A.attr("d","M"+e+","+x[0]+"H0V"+x[1]+"H"+e)}if(a.ticks)t.call(w,C),v.call(w,B),u.call(w,B),p.call(w,C),r.call(w,B),q.call(w,B);else{var D=B.rangeBand()/2,E=function(a){return B(a)+D};t.call(w,E),v.call(w,E)}})}var a=d3.scale.linear(),b="bottom",c=6,d=6,e=6,f=3,g=[10],h=null,i,j=0;return k.scale=function(b){return arguments.length?(a=b,k):a},k.orient=function(a){return arguments.length?(b=a,k):b},k.ticks=function(){return arguments.length?(g=arguments,k):g},k.tickValues=function(a){return arguments.length?(h=a,k):h},k.tickFormat=function(a){return arguments.length?(i=a,k):i},k.tickSize=function(a,b,f){if(!arguments.length)return c;var g=arguments.length-1;return c=+a,d=g>1?+b:c,e=g>0?+arguments[g]:c,k},k.tickPadding=function(a){return arguments.length?(f=+a,k):f},k.tickSubdivide=function(a){return arguments.length?(j=+a,k):j},k},d3.svg.brush=function(){function g(a){a.each(function(){var a=d3.select(this),e=a.selectAll(".background").data([0]),f=a.selectAll(".extent").data([0]),l=a.selectAll(".resize").data(d,String),m;a.style("pointer-events","all").on("mousedown.brush",k).on("touchstart.brush",k),e.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),f.enter().append("rect").attr("class","extent").style("cursor","move"),l.enter().append("g").attr("class",function(a){return"resize "+a}).style("cursor",function(a){return Bd[a]}).append("rect").attr("x",function(a){return/[ew]$/.test(a)?-3:null}).attr("y",function(a){return/^[ns]/.test(a)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),l.style("display",g.empty()?"none":null),l.exit().remove(),b&&(m=gc(b),e.attr("x",m[0]).attr("width",m[1]-m[0]),i(a)),c&&(m=gc(c),e.attr("y",m[0]).attr("height",m[1]-m[0]),j(a)),h(a)})}function h(a){a.selectAll(".resize").attr("transform",function(a){return"translate("+e[+/e$/.test(a)][0]+","+e[+/^s/.test(a)][1]+")"})}function i(a){a.select(".extent").attr("x",e[0][0]),a.selectAll(".extent,.n>rect,.s>rect").attr("width",e[1][0]-e[0][0])}function j(a){a.select(".extent").attr("y",e[0][1]),a.selectAll(".extent,.e>rect,.w>rect").attr("height",e[1][1]-e[0][1])}function k(){function x(){var a=d3.event.changedTouches;return a?d3.touches(d,a)[0]:d3.mouse(d)}function y(){d3.event.keyCode==32&&(q||(r=null,s[0]-=e[1][0],s[1]-=e[1][1],q=2),Z())}function z(){d3.event.keyCode==32&&q==2&&(s[0]+=e[1][0],s[1]+=e[1][1],q=0,Z())}function A(){var a=x(),d=!1;t&&(a[0]+=t[0],a[1]+=t[1]),q||(d3.event.altKey?(r||(r=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]),s[0]=e[+(a[0]<r[0])][0],s[1]=e[+(a[1]<r[1])][1]):r=null),o&&B(a,b,0)&&(i(m),d=!0),p&&B(a,c,1)&&(j(m),d=!0),d&&(h(m),l({type:"brush",mode:q?"move":"resize"}))}function B(a,b,c){var d=gc(b),g=d[0],h=d[1],i=s[c],j=e[1][c]-e[0][c],k,l;q&&(g-=i,h-=j+i),k=Math.max(g,Math.min(h,a[c])),q?l=(k+=i)+j:(r&&(i=Math.max(g,Math.min(h,2*r[c]-k))),i<k?(l=k,k=i):l=i);if(e[0][c]!==k||e[1][c]!==l)return f=null,e[0][c]=k,e[1][c]=l,!0}function C(){A(),m.style("pointer-events","all").selectAll(".resize").style("display",g.empty()?"none":null),d3.select("body").style("cursor",null),u.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),l({type:"brushend"}),Z()}var d=this,k=d3.select(d3.event.target),l=a.of(d,arguments),m=d3.select(d),n=k.datum(),o=!/^(n|s)$/.test(n)&&b,p=!/^(e|w)$/.test(n)&&c,q=k.classed("extent"),r,s=x(),t,u=d3.select(window).on("mousemove.brush",A).on("mouseup.brush",C).on("touchmove.brush",A).on("touchend.brush",C).on("keydown.brush",y).on("keyup.brush",z);if(q)s[0]=e[0][0]-s[0],s[1]=e[0][1]-s[1];else if(n){var v=+/w$/.test(n),w=+/^n/.test(n);t=[e[1-v][0]-s[0],e[1-w][1]-s[1]],s[0]=e[v][0],s[1]=e[w][1]}else d3.event.altKey&&(r=s.slice());m.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",k.style("cursor")),l({type:"brushstart"}),A(),Z()}var a=_(g,"brushstart","brush","brushend"),b=null,c=null,d=Cd[0],e=[[0,0],[0,0]],f;return g.x=function(a){return arguments.length?(b=a,d=Cd[!b<<1|!c],g):b},g.y=function(a){return arguments.length?(c=a,d=Cd[!b<<1|!c],g):c},g.extent=function(a){var d,h,i,j,k;return arguments.length?(f=[[0,0],[0,0]],b&&(d=a[0],h=a[1],c&&(d=d[0],h=h[0]),f[0][0]=d,f[1][0]=h,b.invert&&(d=b(d),h=b(h)),h<d&&(k=d,d=h,h=k),e[0][0]=d|0,e[1][0]=h|0),c&&(i=a[0],j=a[1],b&&(i=i[1],j=j[1]),f[0][1]=i,f[1][1]=j,c.invert&&(i=c(i),j=c(j)),j<i&&(k=i,i=j,j=k),e[0][1]=i|0,e[1][1]=j|0),g):(a=f||e,b&&(d=a[0][0],h=a[1][0],f||(d=e[0][0],h=e[1][0],b.invert&&(d=b.invert(d),h=b.invert(h)),h<d&&(k=d,d=h,h=k))),c&&(i=a[0][1],j=a[1][1],f||(i=e[0][1],j=e[1][1],c.invert&&(i=c.invert(i),j=c.invert(j)),j<i&&(k=i,i=j,j=k))),b&&c?[[d,i],[h,j]]:b?[d,h]:c&&[i,j])},g.clear=function(){return f=null,e[0][0]=e[0][1]=e[1][0]=e[1][1]=0,g},g.empty=function(){return b&&e[0][0]===e[1][0]||c&&e[0][1]===e[1][1]},d3.rebind(g,a,"on")};var Bd={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Cd=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function c(){this.on("mousedown.drag",d).on("touchstart.drag",d)}function d(){function j(){var a=c.parentNode,b=d3.event.changedTouches;return b?d3.touches(a,b)[0]:d3.mouse(a)}function k(){if(!c.parentNode)return l();var a=j(),b=a[0]-g[0],e=a[1]-g[1];h|=b|e,g=a,Z(),d({type:"drag",x:a[0]+f[0],y:a[1]+f[1],dx:b,dy:e})}function l(){d({type:"dragend"}),h&&(Z(),d3.event.target===e&&i.on("click.drag",m,!0)),i.on("mousemove.drag",null).on("touchmove.drag",null).on("mouseup.drag",null).on("touchend.drag",null)}function m(){Z(),i.on("click.drag",null)}var c=this,d=a.of(c,arguments),e=d3.event.target,f,g=j(),h=0,i=d3.select(window).on("mousemove.drag",k).on("touchmove.drag",k).on("mouseup.drag",l,!0).on("touchend.drag",l,!0);b?(f=b.apply(c,arguments),f=[f.x-g[0],f.y-g[1]]):f=[0,0],Z(),d({type:"dragstart"})}var a=_(c,"drag","dragstart","dragend"),b=null;return c.origin=function(a){return arguments.length?(b=a,c):b},d3.rebind(c,a,"on")},d3.behavior.zoom=function(){function l(){this.on("mousedown.zoom",r).on("mousewheel.zoom",s).on("mousemove.zoom",t).on("DOMMouseScroll.zoom",s).on("dblclick.zoom",u).on("touchstart.zoom",v).on("touchmove.zoom",w).on("touchend.zoom",v)}function m(b){return[(b[0]-a[0])/c,(b[1]-a[1])/c]}function n(b){return[b[0]*c+a[0],b[1]*c+a[1]]}function o(a){c=Math.max(e[0],Math.min(e[1],a))}function p(b,c){c=n(c),a[0]+=b[0]-c[0],a[1]+=b[1]-c[1]}function q(b){h&&h.domain(g.range().map(function(b){return(b-a[0])/c}).map(g.invert)),j&&j.domain(i.range().map(function(b){return(b-a[1])/c}).map(i.invert)),d3.event.preventDefault(),b({type:"zoom",scale:c,translate:a})}function r(){function h(){d=1,p(d3.mouse(a),g),q(b)}function i(){d&&Z(),e.on("mousemove.zoom",null).on("mouseup.zoom",null),d&&d3.event.target===c&&e.on("click.zoom",j,!0)}function j(){Z(),e.on("click.zoom",null)}var a=this,b=f.of(a,arguments),c=d3.event.target,d=0,e=d3.select(window).on("mousemove.zoom",h).on("mouseup.zoom",i),g=m(d3.mouse(a));window.focus(),Z()}function s(){b||(b=m(d3.mouse(this))),o(Math.pow(2,Fd()*.002)*c),p(d3.mouse(this),b),q(f.of(this,arguments))}function t(){b=null}function u(){var a=d3.mouse(this),b=m(a);o(d3.event.shiftKey?c/2:c*2),p(a,b),q(f.of(this,arguments))}function v(){var a=d3.touches(this),e=Date.now();d=c,b={},a.forEach(function(a){b[a.identifier]=m(a)}),Z();if(a.length===1&&e-k<500){var g=a[0],h=m(a[0]);o(c*2),p(g,h),q(f.of(this,arguments))}k=e}function w(){var a=d3.touches(this),c=a[0],e=b[c.identifier];if(g=a[1]){var g,h=b[g.identifier];c=[(c[0]+g[0])/2,(c[1]+g[1])/2],e=[(e[0]+h[0])/2,(e[1]+h[1])/2],o(d3.event.scale*d)}p(c,e),q(f.of(this,arguments))}var a=[0,0],b,c=1,d,e=Ed,f=_(l,"zoom"),g,h,i,j,k;return l.translate=function(b){return arguments.length?(a=b.map(Number),l):a},l.scale=function(a){return arguments.length?(c=+a,l):c},l.scaleExtent=function(a){return arguments.length?(e=a==null?Ed:a.map(Number),l):e},l.x=function(a){return arguments.length?(h=a,g=a.copy(),l):h},l.y=function(a){return arguments.length?(j=a,i=a.copy(),l):j},d3.rebind(l,f,"on")};var Dd,Ed=[0,Infinity];d3.layout={},d3.layout.bundle=function(){return function(a){var b=[],c=-1,d=a.length;while(++c<d)b.push(Gd(a[c]));return b}},d3.layout.chord=function(){function j(){var a={},j=[],l=d3.range(e),m=[],n,o,p,q,r;b=[],c=[],n=0,q=-1;while(++q<e){o=0,r=-1;while(++r<e)o+=d[q][r];j.push(o),m.push(d3.range(e)),n+=o}g&&l.sort(function(a,b){return g(j[a],j[b])}),h&&m.forEach(function(a,b){a.sort(function(a,c){return h(d[b][a],d[b][c])})}),n=(2*Math.PI-f*e)/n,o=0,q=-1;while(++q<e){p=o,r=-1;while(++r<e){var s=l[q],t=m[s][r],u=d[s][t],v=o,w=o+=u*n;a[s+"-"+t]={index:s,subindex:t,startAngle:v,endAngle:w,value:u}}c[s]={index:s,startAngle:p,endAngle:o,value:(o-p)/n},o+=f}q=-1;while(++q<e){r=q-1;while(++r<e){var x=a[q+"-"+r],y=a[r+"-"+q];(x.value||y.value)&&b.push(x.value<y.value?{source:y,target:x}:{source:x,target:y})}}i&&k()}function k(){b.sort(function(a,b){return i((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var a={},b,c,d,e,f=0,g,h,i;return a.matrix=function(f){return arguments.length?(e=(d=f)&&d.length,b=c=null,a):d},a.padding=function(d){return arguments.length?(f=d,b=c=null,a):f},a.sortGroups=function(d){return arguments.length?(g=d,b=c=null,a):g},a.sortSubgroups=function(c){return arguments.length?(h=c,b=null,a):h},a.sortChords=function(c){return arguments.length?(i=c,b&&k(),a):i},a.chords=function(){return b||j(),b},a.groups=function(){return c||j(),c},a},d3.layout.force=function(){function t(a){return function(b,c,d,e,f){if(b.point!==a){var g=b.cx-a.x,h=b.cy-a.y,i=1/Math.sqrt(g*g+h*h);if((e-c)*i<k){var j=b.charge*i*i;return a.px-=g*j,a.py-=h*j,!0}if(b.point&&isFinite(i)){var j=b.pointCharge*i*i;a.px-=g*j,a.py-=h*j}}return!b.charge}}function u(b){Ld(Kd=b),Jd=a}var a={},b=d3.dispatch("start","tick","end"),c=[1,1],d,e,f=.9,g=Qd,h=Rd,i=-30,j=.1,k=.8,l,m=[],o=[],p,r,s;return a.tick=function(){if((e*=.99)<.005)return b.end({type:"end",alpha:e=0}),!0;var a=m.length,d=o.length,g,h,k,l,n,q,u,v,w;for(h=0;h<d;++h){k=o[h],l=k.source,n=k.target,v=n.x-l.x,w=n.y-l.y;if(q=v*v+w*w)q=e*r[h]*((q=Math.sqrt(q))-p[h])/q,v*=q,w*=q,n.x-=v*(u=l.weight/(n.weight+l.weight)),n.y-=w*u,l.x+=v*(u=1-u),l.y+=w*u}if(u=e*j){v=c[0]/2,w=c[1]/2,h=-1;if(u)while(++h<a)k=m[h],k.x+=(v-k.x)*u,k.y+=(w-k.y)*u}if(i){Pd(g=d3.geom.quadtree(m),e,s),h=-1;while(++h<a)(k=m[h]).fixed||g.visit(t(k))}h=-1;while(++h<a)k=m[h],k.fixed?(k.x=k.px,k.y=k.py):(k.x-=(k.px-(k.px=k.x))*f,k.y-=(k.py-(k.py=k.y))*f);b.tick({type:"tick",alpha:e})},a.nodes=function(b){return arguments.length?(m=b,a):m},a.links=function(b){return arguments.length?(o=b,a):o},a.size=function(b){return arguments.length?(c=b,a):c},a.linkDistance=function(b){return arguments.length?(g=q(b),a):g},a.distance=a.linkDistance,a.linkStrength=function(b){return arguments.length?(h=q(b),a):h},a.friction=function(b){return arguments.length?(f=b,a):f},a.charge=function(b){return arguments.length?(i=typeof b=="function"?b:+b,a):i},a.gravity=function(b){return arguments.length?(j=b,a):j},a.theta=function(b){return arguments.length?(k=b,a):k},a.alpha=function(c){return arguments.length?(e?c>0?e=c:e=0:c>0&&(b.start({type:"start",alpha:e=c}),d3.timer(a.tick)),a):e},a.start=function(){function q(a,c){var d=t(b),e=-1,f=d.length,g;while(++e<f)if(!isNaN(g=d[e][a]))return g;return Math.random()*c}function t(){if(!l){l=[];for(d=0;d<e;++d)l[d]=[];for(d=0;d<f;++d){var a=o[d];l[a.source.index].push(a.target),l[a.target.index].push(a.source)}}return l[b]}var b,d,e=m.length,f=o.length,j=c[0],k=c[1],l,n;for(b=0;b<e;++b)(n=m[b]).index=b,n.weight=0;p=[],r=[];for(b=0;b<f;++b)n=o[b],typeof n.source=="number"&&(n.source=m[n.source]),typeof n.target=="number"&&(n.target=m[n.target]),p[b]=g.call(this,n,b),r[b]=h.call(this,n,b),++n.source.weight,++n.target.weight;for(b=0;b<e;++b)n=m[b],isNaN(n.x)&&(n.x=q("x",j)),isNaN(n.y)&&(n.y=q("y",k)),isNaN(n.px)&&(n.px=n.x),isNaN(n.py)&&(n.py=n.y);s=[];if(typeof i=="function")for(b=0;b<e;++b)s[b]=+i.call(this,m[b],b);else for(b=0;b<e;++b)s[b]=i;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){d||(d=d3.behavior.drag().origin(n).on("dragstart",u).on("drag",Od).on("dragend",Nd)),this.on("mouseover.force",Ld).on("mouseout.force",Md).call(d)},d3.rebind(a,b,"on")};var Jd,Kd;d3.layout.partition=function(){function c(a,b,d,e){var f=a.children;a.x=b,a.y=a.depth*e,a.dx=d,a.dy=e;if(f&&(h=f.length)){var g=-1,h,i,j;d=a.value?d/a.value:0;while(++g<h)c(i=f[g],b,j=i.value*d,e),b+=j}}function d(a){var b=a.children,c=0;if(b&&(f=b.length)){var e=-1,f;while(++e<f)c=Math.max(c,d(b[e]))}return 1+c}function e(e,f){var g=a.call(this,e,f);return c(g[0],0,b[0],b[1]/d(g[0])),g}var a=d3.layout.hierarchy(),b=[1,1];return e.size=function(a){return arguments.length?(b=a,e):b},ee(e,a)},d3.layout.pie=function(){function f(g,h){var i=g.map(function(b,c){return+a.call(f,b,c)}),j=+(typeof c=="function"?c.apply(this,arguments):c),k=((typeof e=="function"?e.apply(this,arguments):e)-c)/d3.sum(i),l=d3.range(g.length);b!=null&&l.sort(b===Sd?function(a,b){return i[b]-i[a]}:function(a,c){return b(g[a],g[c])});var m=[];return l.forEach(function(a){m[a]={data:g[a],value:d=i[a],startAngle:j,endAngle:j+=d*k}}),m}var a=Number,b=Sd,c=0,e=2*Math.PI;return f.value=function(b){return arguments.length?(a=b,f):a},f.sort=function(a){return arguments.length?(b=a,f):b},f.startAngle=function(a){return arguments.length?(c=a,f):c},f.endAngle=function(a){return arguments.length?(e=a,f):e},f};var Sd={};d3.layout.stack=function(){function g(h,i){var j=h.map(function(b,c){return a.call(g,b,c)}),k=j.map(function(a,b){return a.map(function(a,b){return[e.call(g,a,b),f.call(g,a,b)]})}),l=b.call(g,k,i);j=d3.permute(j,l),k=d3.permute(k,l);var m=c.call(g,k,i),n=j.length,o=j[0].length,p,q,r;for(q=0;q<o;++q){d.call(g,j[0][q],r=m[q],k[0][q][1]);for(p=1;p<n;++p)d.call(g,j[p][q],r+=k[p-1][q][1],k[p][q][1])}return h}var a=n,b=Yd,c=Zd,d=Vd,e=Td,f=Ud;return g.values=function(b){return arguments.length?(a=b,g):a},g.order=function(a){return arguments.length?(b=typeof a=="function"?a:Wd.get(a)||Yd,g):b},g.offset=function(a){return arguments.length?(c=typeof a=="function"?a:Xd.get(a)||Zd,g):c},g.x=function(a){return arguments.length?(e=a,g):e},g.y=function(a){return arguments.length?(f=a,g):f},g.out=function(a){return arguments.length?(d=a,g):d},g};var Wd=d3.map({"inside-out":function(a){var b=a.length,c,d,e=a.map($d),f=a.map(_d),g=d3.range(b).sort(function(a,b){return e[a]-e[b]}),h=0,i=0,j=[],k=[];for(c=0;c<b;++c)d=g[c],h<i?(h+=f[d],j.push(d)):(i+=f[d],k.push(d));return k.reverse().concat(j)},reverse:function(a){return d3.range(a.length).reverse()},"default":Yd}),Xd=d3.map({silhouette:function(a){var b=a.length,c=a[0].length,d=[],e=0,f,g,h,i=[];for(g=0;g<c;++g){for(f=0,h=0;f<b;f++)h+=a[f][g][1];h>e&&(e=h),d.push(h)}for(g=0;g<c;++g)i[g]=(e-d[g])/2;return i},wiggle:function(a){var b=a.length,c=a[0],d=c.length,e=0,f,g,h,i,j,k,l,m,n,o=[];o[0]=m=n=0;for(g=1;g<d;++g){for(f=0,i=0;f<b;++f)i+=a[f][g][1];for(f=0,j=0,l=c[g][0]-c[g-1][0];f<b;++f){for(h=0,k=(a[f][g][1]-a[f][g-1][1])/(2*l);h<f;++h)k+=(a[h][g][1]-a[h][g-1][1])/l;j+=k*a[f][g][1]}o[g]=m-=i?j/i*l:0,m<n&&(n=m)}for(g=0;g<d;++g)o[g]-=n;return o},expand:function(a){var b=a.length,c=a[0].length,d=1/b,e,f,g,h=[];for(f=0;f<c;++f){for(e=0,g=0;e<b;e++)g+=a[e][f][1];if(g)for(e=0;e<b;e++)a[e][f][1]/=g;else for(e=0;e<b;e++)a[e][f][1]=d}for(f=0;f<c;++f)h[f]=0;return h},zero:Zd});d3.layout.histogram=function(){function e(e,f){var g=[],h=e.map(b,this),i=c.call(this,h,f),j=d.call(this,i,h,f),k,f=-1,l=h.length,m=j.length-1,n=a?1:1/l,o;while(++f<m)k=g[f]=[],k.dx=j[f+1]-(k.x=j[f]),k.y=0;if(m>0){f=-1;while(++f<l)o=h[f],o>=i[0]&&o<=i[1]&&(k=g[d3.bisect(j,o,1,m)-1],k.y+=n,k.push(e[f]))}return g}var a=!0,b=Number,c=de,d=be;return e.value=function(a){return arguments.length?(b=a,e):b},e.range=function(a){return arguments.length?(c=q(a),e):c},e.bins=function(a){return arguments.length?(d=typeof a=="number"?function(b){return ce(b,a)}:q(a),e):d},e.frequency=function(b){return arguments.length?(a=!!b,e):a},e},d3.layout.hierarchy=function(){function e(f,h,i){var j=b.call(g,f,h),k=je?f:{data:f};k.depth=h,i.push(k);if(j&&(m=j.length)){var l=-1,m,n=k.children=[],o=0,p=h+1;while(++l<m)d=e(j[l],p,i),d.parent=k,n.push(d),o+=d.value;a&&n.sort(a),c&&(k.value=o)}else c&&(k.value=+c.call(g,f,h)||0);return k}function f(a,b){var d=a.children,e=0;if(d&&(i=d.length)){var h=-1,i,j=b+1;while(++h<i)e+=f(d[h],j)}else c&&(e=+c.call(g,je?a:a.data,b)||0);return c&&(a.value=e),e}function g(a){var b=[];return e(a,0,b),b}var a=he,b=fe,c=ge;return g.sort=function(b){return arguments.length?(a=b,g):a},g.children=function(a){return arguments.length?(b=a,g):b},g.value=function(a){return arguments.length?(c=a,g):c},g.revalue=function(a){return f(a,0),a},g};var je=!1;d3.layout.pack=function(){function c(c,d){var e=a.call(this,c,d),f=e[0];f.x=0,f.y=0,re(f);var g=b[0],h=b[1],i=1/Math.max(2*f.r/g,2*f.r/h);return se(f,g/2,h/2,i),e}var a=d3.layout.hierarchy().sort(ke),b=[1,1];return c.size=function(a){return arguments.length?(b=a,c):b},ee(c,a)},d3.layout.cluster=function(){function d(d,e){var f=a.call(this,d,e),g=f[0],h,i=0,j,k;Fe(g,function(a){var c=a.children;c&&c.length?(a.x=ve(c),a.y=ue(c)):(a.x=h?i+=b(a,h):0,a.y=0,h=a)});var l=we(g),m=xe(g),n=l.x-b(l,m)/2,o=m.x+b(m,l)/2;return Fe(g,function(a){a.x=(a.x-n)/(o-n)*c[0],a.y=(1-(g.y?a.y/g.y:1))*c[1]}),f}var a=d3.layout.hierarchy().sort(null).value(null),b=ye,c=[1,1];return d.separation=function(a){return arguments.length?(b=a,d):b},d.size=function(a){return arguments.length?(c=a,d):c},ee(d,a)},d3.layout.tree=function(){function d(d,e){function h(a,c){var d=a.children,e=a._tree;if(d&&(f=d.length)){var f,g=d[0],i,k=g,l,m=-1;while(++m<f)l=d[m],h(l,i),k=j(l,i,k),i=l;Ge(a);var n=.5*(g._tree.prelim+l._tree.prelim);c?(e.prelim=c._tree.prelim+b(a,c),e.mod=e.prelim-n):e.prelim=n}else c&&(e.prelim=c._tree.prelim+b(a,c))}function i(a,b){a.x=a._tree.prelim+b;var c=a.children;if(c&&(e=c.length)){var d=-1,e;b+=a._tree.mod;while(++d<e)i(c[d],b)}}function j(a,c,d){if(c){var e=a,f=a,g=c,h=a.parent.children[0],i=e._tree.mod,j=f._tree.mod,k=g._tree.mod,l=h._tree.mod,m;while(g=Ae(g),e=ze(e),g&&e)h=ze(h),f=Ae(f),f._tree.ancestor=a,m=g._tree.prelim+k-e._tree.prelim-i+b(g,e),m>0&&(He(Ie(g,a,d),a,m),i+=m,j+=m),k+=g._tree.mod,i+=e._tree.mod,l+=h._tree.mod,j+=f._tree.mod;g&&!Ae(f)&&(f._tree.thread=g,f._tree.mod+=k-j),e&&!ze(h)&&(h._tree.thread=e,h._tree.mod+=i-l,d=a)}return d}var f=a.call(this,d,e),g=f[0];Fe(g,function(a,b){a._tree={ancestor:a,prelim:0,mod:0,change:0,shift:0,number:b?b._tree.number+1:0}}),h(g),i(g,-g._tree.prelim);var k=Be(g,De),l=Be(g,Ce),m=Be(g,Ee),n=k.x-b(k,l)/2,o=l.x+b(l,k)/2,p=m.depth||1;return Fe(g,function(a){a.x=(a.x-n)/(o-n)*c[0],a.y=a.depth/p*c[1],delete a._tree}),f}var a=d3.layout.hierarchy().sort(null).value(null),b=ye,c=[1,1];return d.separation=function(a){return arguments.length?(b=a,d):b},d.size=function(a){return arguments.length?(c=a,d):c},ee(d,a)},d3.layout.treemap=function(){function i(a,b){var c=-1,d=a.length,e,f;while(++c<d)f=(e=a[c]).value*(b<0?0:b),e.area=isNaN(f)||f<=0?0:f}function j(a){var b=a.children;if(b&&b.length){var c=e(a),d=[],f=b.slice(),g,h=Infinity,k,n=Math.min(c.dx,c.dy),o;i(f,c.dx*c.dy/a.value),d.area=0;while((o=f.length)>0)d.push(g=f[o-1]),d.area+=g.area,(k=l(d,n))<=h?(f.pop(),h=k):(d.area-=d.pop().area,m(d,n,c,!1),n=Math.min(c.dx,c.dy),d.length=d.area=0,h=Infinity);d.length&&(m(d,n,c,!0),d.length=d.area=0),b.forEach(j)}}function k(a){var b=a.children;if(b&&b.length){var c=e(a),d=b.slice(),f,g=[];i(d,c.dx*c.dy/a.value),g.area=0;while(f=d.pop())g.push(f),g.area+=f.area,f.z!=null&&(m(g,f.z?c.dx:c.dy,c,!d.length),g.length=g.area=0);b.forEach(k)}}function l(a,b){var c=a.area,d,e=0,f=Infinity,g=-1,i=a.length;while(++g<i){if(!(d=a[g].area))continue;d<f&&(f=d),d>e&&(e=d)}return c*=c,b*=b,c?Math.max(b*e*h/c,c/(b*f*h)):Infinity}function m(a,c,d,e){var f=-1,g=a.length,h=d.x,i=d.y,j=c?b(a.area/c):0,k;if(c==d.dx){if(e||j>d.dy)j=d.dy;while(++f<g)k=a[f],k.x=h,k.y=i,k.dy=j,h+=k.dx=Math.min(d.x+d.dx-h,j?b(k.area/j):0);k.z=!0,k.dx+=d.x+d.dx-h,d.y+=j,d.dy-=j}else{if(e||j>d.dx)j=d.dx;while(++f<g)k=a[f],k.x=h,k.y=i,k.dx=j,i+=k.dy=Math.min(d.y+d.dy-i,j?b(k.area/j):0);k.z=!1,k.dy+=d.y+d.dy-i,d.x+=j,d.dx-=j}}function n(b){var d=g||a(b),e=d[0];return e.x=0,e.y=0,e.dx=c[0],e.dy=c[1],g&&a.revalue(e),i([e],e.dx*e.dy/e.value),(g?k:j)(e),f&&(g=d),d}var a=d3.layout.hierarchy(),b=Math.round,c=[1,1],d=null,e=Je,f=!1,g,h=.5*(1+Math.sqrt(5));return n.size=function(a){return arguments.length?(c=a,n):c},n.padding=function(a){function b(b){var c=a.call(n,b,b.depth);return c==null?Je(b):Ke(b,typeof c=="number"?[c,c,c,c]:c)}function c(b){return Ke(b,a)}if(!arguments.length)return d;var f;return e=(d=a)==null?Je:(f=typeof a)==="function"?b:f==="number"?(a=[a,a,a,a],c):c,n},n.round=function(a){return arguments.length?(b=a?Math.round:Number,n):b!=Number},n.sticky=function(a){return arguments.length?(f=a,g=null,n):f},n.ratio=function(a){return arguments.length?(h=a,n):h},ee(n,a)},d3.csv=function(a,b){d3.text(a,"text/csv",function(a){b(a&&d3.csv.parse(a))})},d3.csv.parse=function(a){var b;return d3.csv.parseRows(a,function(a,c){if(c){var d={},e=-1,f=b.length;while(++e<f)d[b[e]]=a[e];return d}return b=a,null})},d3.csv.parseRows=function(a,b){function j(){if(f.lastIndex>=a.length)return d;if(i)return i=!1,c;var b=f.lastIndex;if(a.charCodeAt(b)===34){var e=b;while(e++<a.length)if(a.charCodeAt(e)===34){if(a.charCodeAt(e+1)!==34)break;e++}f.lastIndex=e+2;var g=a.charCodeAt(e+1);return g===13?(i=!0,a.charCodeAt(e+2)===10&&f.lastIndex++):g===10&&(i=!0),a.substring(b+1,e).replace(/""/g,'"')}var h=f.exec(a);return h?(i=h[0].charCodeAt(0)!==44,a.substring(b,h.index)):(f.lastIndex=a.length,a.substring(b))}var c={},d={},e=[],f=/\r\n|[,\r\n]/g,g=0,h,i;f.lastIndex=0;while((h=j())!==d){var k=[];while(h!==c&&h!==d)k.push(h),h=j();if(b&&!(k=b(k,g++)))continue;e.push(k)}return e},d3.csv.format=function(a){return a.map(Le).join("\n")},d3.geo={};var Ne=Math.PI/180;d3.geo.azimuthal=function(){function i(b){var f=b[0]*Ne-e,i=b[1]*Ne,j=Math.cos(f),k=Math.sin(f),l=Math.cos(i),m=Math.sin(i),n=a!=="orthographic"?h*m+g*l*j:null,o,p=a==="stereographic"?1/(1+n):a==="gnomonic"?1/n:a==="equidistant"?(o=Math.acos(n),o?o/Math.sin(o):0):a==="equalarea"?Math.sqrt(2/(1+n)):1,q=p*l*k,r=p*(h*l*j-g*m);return[c*q+d[0],c*r+d[1]]}var a="orthographic",b,c=200,d=[480,250],e,f,g,h;return i.invert=function(b){var f=(b[0]-d[0])/c,i=(b[1]-d[1])/c,j=Math.sqrt(f*f+i*i),k=a==="stereographic"?2*Math.atan(j):a==="gnomonic"?Math.atan(j):a==="equidistant"?j:a==="equalarea"?2*Math.asin(.5*j):Math.asin(j),l=Math.sin(k),m=Math.cos(k);return[(e+Math.atan2(f*l,j*g*m+i*h*l))/Ne,Math.asin(m*h-(j?i*l*g/j:0))/Ne]},i.mode=function(b){return arguments.length?(a=b+"",i):a},i.origin=function(a){return arguments.length?(b=a,e=b[0]*Ne,f=b[1]*Ne,g=Math.cos(f),h=Math.sin(f),i):b},i.scale=function(a){return arguments.length?(c=+a,i):c},i.translate=function(a){return arguments.length?(d=[+a[0],+a[1]],i):d},i.origin([0,0])},d3.geo.albers=function(){function i(a){var b=f*(Ne*a[0]-e),i=Math.sqrt(g-2*f*Math.sin(Ne*a[1]))/f;return[c*i*Math.sin(b)+d[0],c*(i*Math.cos(b)-h)+d[1]]}function j(){var c=Ne*b[0],d=Ne*b[1],j=Ne*a[1],k=Math.sin(c),l=Math.cos(c);return e=Ne*a[0],f=.5*(k+Math.sin(d)),g=l*l+2*f*k,h=Math.sqrt(g-2*f*Math.sin(j))/f,i}var a=[-98,38],b=[29.5,45.5],c=1e3,d=[480,250],e,f,g,h;return i.invert=function(a){var b=(a[0]-d[0])/c,i=(a[1]-d[1])/c,j=h+i,k=Math.atan2(b,j),l=Math.sqrt(b*b+j*j);return[(e+k/f)/Ne,Math.asin((g-l*l*f*f)/(2*f))/Ne]},i.origin=function(b){return arguments.length?(a=[+b[0],+b[1]],j()):a},i.parallels=function(a){return arguments.length?(b=[+a[0],+a[1]],j()):b},i.scale=function(a){return arguments.length?(c=+a,i):c},i.translate=function(a){return arguments.length?(d=[+a[0],+a[1]],i):d},j()},d3.geo.albersUsa=function(){function e(e){var f=e[0],g=e[1];return(g>50?b:f<-140?c:g<21?d:a)(e)}var a=d3.geo.albers(),b=d3.geo.albers().origin([-160,60]).parallels([55,65]),c=d3.geo.albers().origin([-160,20]).parallels([8,18]),d=d3.geo.albers().origin([-60,10]).parallels([8,18]);return e.scale=function(f){return arguments.length?(a.scale(f),b.scale(f*.6),c.scale(f),d.scale(f*1.5),e.translate(a.translate())):a.scale()},e.translate=function(f){if(!arguments.length)return a.translate();var g=a.scale()/1e3,h=f[0],i=f[1];return a.translate(f),b.translate([h-400*g,i+170*g]),c.translate([h-190*g,i+200*g]),d.translate([h+580*g,i+430*g]),e},e.scale(a.scale())},d3.geo.bonne=function(){function g(g){var h=g[0]*Ne-c,i=g[1]*Ne-d;if(e){var j=f+e-i,k=h*Math.cos(i)/j;h=j*Math.sin(k),i=j*Math.cos(k)-f}else h*=Math.cos(i),i*=-1;return[a*h+b[0],a*i+b[1]]}var a=200,b=[480,250],c,d,e,f;return g.invert=function(d){var g=(d[0]-b[0])/a,h=(d[1]-b[1])/a;if(e){var i=f+h,j=Math.sqrt(g*g+i*i);h=f+e-j,g=c+j*Math.atan2(g,i)/Math.cos(h)}else h*=-1,g/=Math.cos(h);return[g/Ne,h/Ne]},g.parallel=function(a){return arguments.length?(f=1/Math.tan(e=a*Ne),g):e/Ne},g.origin=function(a){return arguments.length?(c=a[0]*Ne,d=a[1]*Ne,g):[c/Ne,d/Ne]},g.scale=function(b){return arguments.length?(a=+b,g):a},g.translate=function(a){return arguments.length?(b=[+a[0],+a[1]],g):b},g.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function c(c){var d=c[0]/360,e=-c[1]/360;return[a*d+b[0],a*e+b[1]]}var a=500,b=[480,250];return c.invert=function(c){var d=(c[0]-b[0])/a,e=(c[1]-b[1])/a;return[360*d,-360*e]},c.scale=function(b){return arguments.length?(a=+b,c):a},c.translate=function(a){return arguments.length?(b=[+a[0],+a[1]],c):b},c},d3.geo.mercator=function(){function c(c){var d=c[0]/360,e=-(Math.log(Math.tan(Math.PI/4+c[1]*Ne/2))/Ne)/360;return[a*d+b[0],a*Math.max(-0.5,Math.min(.5,e))+b[1]]}var a=500,b=[480,250];return c.invert=function(c){var d=(c[0]-b[0])/a,e=(c[1]-b[1])/a;return[360*d,2*Math.atan(Math.exp(-360*e*Ne))/Ne-90]},c.scale=function(b){return arguments.length?(a=+b,c):a},c.translate=function(a){return arguments.length?(b=[+a[0],+a[1]],c):b},c},d3.geo.path=function(){function d(c,d){return typeof a=="function"&&(b=Pe(a.apply(this,arguments))),f(c)||null}function e(a){return c(a).join(",")}function h(a){var b=k(a[0]),c=0,d=a.length;while(++c<d)b-=k(a[c]);return b}function i(a){var b=d3.geom.polygon(a[0].map(c)),d=b.area(),e=b.centroid(d<0?(d*=-1,1):-1),f=e[0],g=e[1],h=d,i=0,j=a.length;while(++i<j)b=d3.geom.polygon(a[i].map(c)),d=b.area(),e=b.centroid(d<0?(d*=-1,1):-1),f-=e[0],g-=e[1],h-=d;return[f,g,6*h]}function k(a){return Math.abs(d3.geom.polygon(a.map(c)).area())}var a=4.5,b=Pe(a),c=d3.geo.albersUsa(),f=Oe({FeatureCollection:function(a){var b=[],c=a.features,d=-1,e=c.length;while(++d<e)b.push(f(c[d].geometry));return b.join("")},Feature:function(a){return f(a.geometry)},Point:function(a){return"M"+e(a.coordinates)+b},MultiPoint:function(a){var c=[],d=a.coordinates,f=-1,g=d.length;while(++f<g)c.push("M",e(d[f]),b);return c.join("")},LineString:function(a){var b=["M"],c=a.coordinates,d=-1,f=c.length;while(++d<f)b.push(e(c[d]),"L");return b.pop(),b.join("")},MultiLineString:function(a){var b=[],c=a.coordinates,d=-1,f=c.length,g,h,i;while(++d<f){g=c[d],h=-1,i=g.length,b.push("M");while(++h<i)b.push(e(g[h]),"L");b.pop()}return b.join("")},Polygon:function(a){var b=[],c=a.coordinates,d=-1,f=c.length,g,h,i;while(++d<f){g=c[d],h=-1;if((i=g.length-1)>0){b.push("M");while(++h<i)b.push(e(g[h]),"L");b[b.length-1]="Z"}}return b.join("")},MultiPolygon:function(a){var b=[],c=a.coordinates,d=-1,f=c.length,g,h,i,j,k,l;while(++d<f){g=c[d],h=-1,i=g.length;while(++h<i){j=g[h],k=-1;if((l=j.length-1)>0){b.push("M");while(++k<l)b.push(e(j[k]),"L");b[b.length-1]="Z"}}}return b.join("")},GeometryCollection:function(a){var b=[],c=a.geometries,d=-1,e=c.length;while(++d<e)b.push(f(c[d]));return b.join("")}}),g=d.area=Oe({FeatureCollection:function(a){var b=0,c=a.features,d=-1,e=c.length;while(++d<e)b+=g(c[d]);return b},Feature:function(a){return g(a.geometry)},Polygon:function(a){return h(a.coordinates)},MultiPolygon:function(a){var b=0,c=a.coordinates,d=-1,e=c.length;while(++d<e)b+=h(c[d]);return b},GeometryCollection:function(a){var b=0,c=a.geometries,d=-1,e=c.length;while(++d<e)b+=g(c[d]);return b}},0),j=d.centroid=Oe({Feature:function(a){return j(a.geometry)},Polygon:function(a){var b=i(a.coordinates);return[b[0]/b[2],b[1]/b[2]]},MultiPolygon:function(a){var b=0,c=a.coordinates,d,e=0,f=0,g=0,h=-1,j=c.length;while(++h<j)d=i(c[h]),e+=d[0],f+=d[1],g+=d[2];return[e/g,f/g]}});return d.projection=function(a){return c=a,d},d.pointRadius=function(c){return typeof c=="function"?a=c:(a=+c,b=Pe(a)),d},d},d3.geo.bounds=function(a){var b=Infinity,c=Infinity,d=-Infinity,e=-Infinity;return Qe(a,function(a,f){a<b&&(b=a),a>d&&(d=a),f<c&&(c=f),f>e&&(e=f)}),[[b,c],[d,e]]};var Re={Feature:Se,FeatureCollection:Te,GeometryCollection:Ue,LineString:Ve,MultiLineString:We,MultiPoint:Ve,MultiPolygon:Xe,Point:Ye,Polygon:Ze};d3.geo.circle=function(){function e(){}function f(a){return d.distance(a)<c}function h(a){var b=-1,e=a.length,f=[],g,h,j,k,l;while(++b<e)l=d.distance(j=a[b]),l<c?(h&&f.push(af(h,j)((k-c)/(k-l))),f.push(j),g=h=null):(h=j,!g&&f.length&&(f.push(af(f[f.length-1],h)((c-k)/(l-k))),g=h)),k=l;return h&&f.length&&(l=d.distance(j=f[0]),f.push(af(h,j)((k-c)/(k-l)))),i(f)}function i(a){var b=0,c=a.length,e,f,g=c?[a[0]]:a,h,i=d.source();while(++b<c){h=d.source(a[b-1])(a[b]).coordinates;for(e=0,f=h.length;++e<f;)g.push(h[e])}return d.source(i),g}var a=[0,0],b=89.99,c=b*Ne,d=d3.geo.greatArc().target(n);e.clip=function(b){return d.source(typeof a=="function"?a.apply(this,arguments):a),g(b)};var g=Oe({FeatureCollection:function(a){var b=a.features.map(g).filter(n);return b&&(a=Object.create(a),a.features=b,a)},Feature:function(a){var b=g(a.geometry);return b&&(a=Object.create(a),a.geometry=b,a)},Point:function(a){return f(a.coordinates)&&a},MultiPoint:function(a){var b=a.coordinates.filter(f);return b.length&&{type:a.type,coordinates:b}},LineString:function(a){var b=h(a.coordinates);return b.length&&(a=Object.create(a),a.coordinates=b,a)},MultiLineString:function(a){var b=a.coordinates.map(h).filter(function(a){return a.length});return b.length&&(a=Object.create(a),a.coordinates=b,a)},Polygon:function(a){var b=a.coordinates.map(h);return b[0].length&&(a=Object.create(a),a.coordinates=b,a)},MultiPolygon:function(a){var b=a.coordinates.map(function(a){return a.map(h)}).filter(function(a){return a[0].length});return b.length&&(a=Object.create(a),a.coordinates=b,a)},GeometryCollection:function(a){var b=a.geometries.map(g).filter(n);return b.length&&(a=Object.create(a),a.geometries=b,a)}});return e.origin=function(b){return arguments.length?(a=b,e):a},e.angle=function(a){return arguments.length?(c=(b=+a)*Ne,e):b},e.precision=function(a){return arguments.length?(d.precision(a),e):d.precision()},e},d3.geo.greatArc=function(){function d(){var d=typeof a=="function"?a.apply(this,arguments):a,e=typeof b=="function"?b.apply(this,arguments):b,f=af(d,e),g=c/f.d,h=0,i=[d];while((h+=g)<1)i.push(f(h));return i.push(e),{type:"LineString",coordinates:i}}var a=$e,b=_e,c=6*Ne;return d.distance=function(){var c=typeof a=="function"?a.apply(this,arguments):a,d=typeof b=="function"?b.apply(this,arguments):b;return af(c,d).d},d.source=function(b){return arguments.length?(a=b,d):a},d.target=function(a){return arguments.length?(b=a,d):b},d.precision=function(a){return arguments.length?(c=a*Ne,d):c/Ne},d},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(a,b){var c=b||df(a),d=[],e=c[0],f=c[1],g=0,h=0,i=NaN,j=NaN,k=0;do k=0,a(e-1,f-1)&&(k+=1),a(e,f-1)&&(k+=2),a(e-1,f)&&(k+=4),a(e,f)&&(k+=8),k===6?(g=j===-1?-1:1,h=0):k===9?(g=0,h=i===1?-1:1):(g=bf[k],h=cf[k]),g!=i&&h!=j&&(d.push([e,f]),i=g,j=h),e+=g,f+=h;while(c[0]!=e||c[1]!=f);return d};var bf=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],cf=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(a){if(a.length<3)return[];var b=a.length,c=b-1,d=[],e=[],f,g,h=0,i,j,k,l,m,n,o,p;for(f=1;f<b;++f)a[f][1]<a[h][1]?h=f:a[f][1]==a[h][1]&&(h=a[f][0]<a[h][0]?f:h);for(f=0;f<b;++f){if(f===h)continue;j=a[f][1]-a[h][1],i=a[f][0]-a[h][0],d.push({angle:Math.atan2(j,i),index:f})}d.sort(function(a,b){return a.angle-b.angle}),o=d[0].angle,n=d[0].index,m=0;for(f=1;f<c;++f)g=d[f].index,o==d[f].angle?(i=a[n][0]-a[h][0],j=a[n][1]-a[h][1],k=a[g][0]-a[h][0],l=a[g][1]-a[h][1],i*i+j*j>=k*k+l*l?d[f].index=-1:(d[m].index=-1,o=d[f].angle,m=f,n=g)):(o=d[f].angle,m=f,n=g);e.push(h);for(f=0,g=0;f<2;++g)d[g].index!==-1&&(e.push(d[g].index),f++);p=e.length;for(;g<c;++g){if(d[g].index===-1)continue;while(!ef(e[p-2],e[p-1],d[g].index,a))--p;e[p++]=d[g].index}var q=[];for(f=0;f<p;++f)q.push(a[e[f]]);return q},d3.geom.polygon=function(a){return a.area=function(){var b=0,c=a.length,d=a[c-1][0]*a[0][1],e=a[c-1][1]*a[0][0];while(++b<c)d+=a[b-1][0]*a[b][1],e+=a[b-1][1]*a[b][0];return(e-d)*.5},a.centroid=function(b){var c=-1,d=a.length,e=0,f=0,g,h=a[d-1],i;arguments.length||(b=-1/(6*a.area()));while(++c<d)g=h,h=a[c],i=g[0]*h[1]-h[0]*g[1],e+=(g[0]+h[0])*i,f+=(g[1]+h[1])*i;return[e*b,f*b]},a.clip=function(b){var c,d=-1,e=a.length,f,g,h=a[e-1],i,j,k;while(++d<e){c=b.slice(),b.length=0,i=a[d],j=c[(g=c.length)-1],f=-1;while(++f<g)k=c[f],ff(k,h,i)?(ff(j,h,i)||b.push(gf(j,k,h,i)),b.push(k)):ff(j,h,i)&&b.push(gf(j,k,h,i)),j=k;h=i}return b},a},d3.geom.voronoi=function(a){var b=a.map(function(){return[]});return jf(a,function(a){var c,d,e,f,g,h;a.a===1&&a.b>=0?(c=a.ep.r,d=a.ep.l):(c=a.ep.l,d=a.ep.r),a.a===1?(g=c?c.y:-1e6,e=a.c-a.b*g,h=d?d.y:1e6,f=a.c-a.b*h):(e=c?c.x:-1e6,g=a.c-a.a*e,f=d?d.x:1e6,h=a.c-a.a*f);var i=[e,g],j=[f,h];b[a.region.l.index].push(i,j),b[a.region.r.index].push(i,j)}),b.map(function(b,c){var d=a[c][0],e=a[c][1];return b.forEach(function(a){a.angle=Math.atan2(a[0]-d,a[1]-e)}),b.sort(function(a,b){return a.angle-b.angle}).filter(function(a,c){return!c||a.angle-b[c-1].angle>1e-10})})};var hf={l:"r",r:"l"};d3.geom.delaunay=function(a){var b=a.map(function(){return[]}),c=[];return jf(a,function(c){b[c.region.l.index].push(a[c.region.r.index])}),b.forEach(function(b,d){var e=a[d],f=e[0],g=e[1];b.forEach(function(a){a.angle=Math.atan2(a[0]-f,a[1]-g)}),b.sort(function(a,b){return a.angle-b.angle});for(var h=0,i=b.length-1;h<i;h++)c.push([e,b[h],b[h+1]])}),c},d3.geom.quadtree=function(a,b,c,d,e){function k(a,b,c,d,e,f){if(isNaN(b.x)||isNaN(b.y))return;if(a.leaf){var g=a.point;g?Math.abs(g.x-b.x)+Math.abs(g.y-b.y)<.01?l(a,b,c,d,e,f):(a.point=null,l(a,g,c,d,e,f),l(a,b,c,d,e,f)):a.point=b}else l(a,b,c,d,e,f)}function l(a,b,c,d,e,f){var g=(c+e)*.5,h=(d+f)*.5,i=b.x>=g,j=b.y>=h,l=(j<<1)+i;a.leaf=!1,a=a.nodes[l]||(a.nodes[l]=kf()),i?c=g:e=g,j?d=h:f=h,k(a,b,c,d,e,f)}var f,g=-1,h=a.length;h&&isNaN(a[0].x)&&(a=a.map(mf));if(arguments.length<5)if(arguments.length===3)e=d=c,c=b;else{b=c=Infinity,d=e=-Infinity;while(++g<h)f=a[g],f.x<b&&(b=f.x),f.y<c&&(c=f.y),f.x>d&&(d=f.x),f.y>e&&(e=f.y);var i=d-b,j=e-c;i>j?e=c+i:d=b+j}var m=kf();return m.add=function(a){k(m,a,b,c,d,e)},m.visit=function(a){lf(a,m,b,c,d,e)},a.forEach(m.add),m},d3.time={};var nf=Date;of.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){pf.setUTCDate.apply(this._,arguments)},setDay:function(){pf.setUTCDay.apply(this._,arguments)},setFullYear:function(){pf.setUTCFullYear.apply(this._,arguments)},setHours:function(){pf.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){pf.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){pf.setUTCMinutes.apply(this._,arguments)},setMonth:function(){pf.setUTCMonth.apply(this._,arguments)},setSeconds:function(){pf.setUTCSeconds.apply(this._,arguments)},setTime:function(){pf.setTime.apply(this._,arguments)}};var pf=Date.prototype;d3.time.format=function(a){function c(c){var d=[],e=-1,f=0,g,h;while(++e<b)a.charCodeAt(e)==37&&(d.push(a.substring(f,e),(h=vf[g=a.charAt(++e)])?h(c):g),f=e+1);return d.push(a.substring(f,e)),d.join("")}var b=a.length;return c.parse=function(b){var c={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},d=qf(c,a,b,0);if(d!=b.length)return null;"p"in c&&(c.H=c.H%12+c.p*12);var e=new nf;return e.setFullYear(c.y,c.m,c.d),e.setHours(c.H,c.M,c.S,c.L),e},c.toString=function(){return a},c};var rf=d3.format("02d"),sf=d3.format("03d"),tf=d3.format("04d"),uf=d3.format("2d"),vf={a:function(a){return Bf[a.getDay()].substring(0,3)},A:function(a){return Bf[a.getDay()]},b:function(a){return Hf[a.getMonth()].substring(0,3)},B:function(a){return Hf[a.getMonth()]},c:d3.time.format("%a %b %e %H:%M:%S %Y"),d:function(a){return rf(a.getDate())},e:function(a){return uf(a.getDate())},H:function(a){return rf(a.getHours())},I:function(a){return rf(a.getHours()%12||12)},j:function(a){return sf(1+d3.time.dayOfYear(a))},L:function(a){return sf(a.getMilliseconds())},m:function(a){return rf(a.getMonth()+1)},M:function(a){return rf(a.getMinutes())},p:function(a){return a.getHours()>=12?"PM":"AM"},S:function(a){return rf(a.getSeconds())},U:function(a){return rf(d3.time.sundayOfYear(a))},w:function(a){return a.getDay()},W:function(a){return rf(d3.time.mondayOfYear(a))},x:d3.time.format("%m/%d/%y"),X:d3.time.format("%H:%M:%S"),y:function(a){return rf(a.getFullYear()%100)},Y:function(a){return tf(a.getFullYear()%1e4)},Z:Xf,"%":function(a){return"%"}},wf={a:xf,A:yf,b:Cf,B:Ef,c:If,d:Pf,e:Pf,H:Qf,I:Qf,L:Tf,m:Of,M:Rf,p:Vf,S:Sf,x:Jf,X:Kf,y:Mf,Y:Lf},zf=/^(?:sun|mon|tue|wed|thu|fri|sat)/i,Af=/^(?:Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday)/i,Bf=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Df=d3.map({jan:0,feb:1,mar:2,apr:3,may:4,jun:5,jul:6,aug:7,sep:8,oct:9,nov:10,dec:11}),Ff=/^(?:January|February|March|April|May|June|July|August|September|October|November|December)/ig,Gf=d3.map({january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11}),Hf=["January","February","March","April","May","June","July","August","September","October","November","December"],Uf=/\s*\d+/,Wf=d3.map({am:0,pm:1});d3.time.format.utc=function(a){function c(a){try{nf=of;var c=new nf;return c._=a,b(c)}finally{nf=Date}}var b=d3.time.format(a);return c.parse=function(a){try{nf=of;var c=b.parse(a);return c&&c._}finally{nf=Date}},c.toString=b.toString,c};var Yf=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?Zf:Yf,Zf.parse=function(a){return new Date(a)},Zf.toString=Yf.toString,d3.time.second=$f(function(a){return new nf(Math.floor(a/1e3)*1e3)},function(a,b){a.setTime(a.getTime()+Math.floor(b)*1e3)},function(a){return a.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=$f(function(a){return new nf(Math.floor(a/6e4)*6e4)},function(a,b){a.setTime(a.getTime()+Math.floor(b)*6e4)},function(a){return a.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=$f(function(a){var b=a.getTimezoneOffset()/60;return new nf((Math.floor(a/36e5-b)+b)*36e5)},function(a,b){a.setTime(a.getTime()+Math.floor(b)*36e5)},function(a){return a.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=$f(function(a){return new nf(a.getFullYear(),a.getMonth(),a.getDate())},function(a,b){a.setDate(a.getDate()+b)},function(a){return a.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(a){var b=d3.time.year(a);return Math.floor((a-b)/864e5-(a.getTimezoneOffset()-b.getTimezoneOffset())/1440)},Bf.forEach(function(a,b){a=a.toLowerCase(),b=7-b;var c=d3.time[a]=$f(function(a){return(a=d3.time.day(a)).setDate(a.getDate()-(a.getDay()+b)%7),a},function(a,b){a.setDate(a.getDate()+Math.floor(b)*7)},function(a){var c=d3.time.year(a).getDay();return Math.floor((d3.time.dayOfYear(a)+(c+b)%7)/7)-(c!==b)});d3.time[a+"s"]=c.range,d3.time[a+"s"].utc=c.utc.range,d3.time[a+"OfYear"]=function(a){var c=d3.time.year(a).getDay();return Math.floor((d3.time.dayOfYear(a)+(c+b)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=$f(function(a){return new nf(a.getFullYear(),a.getMonth(),1)},function(a,b){a.setMonth(a.getMonth()+b)},function(a){return a.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=$f(function(a){return new nf(a.getFullYear(),0,1)},function(a,b){a.setFullYear(a.getFullYear()+b)},function(a){return a.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var gg=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],hg=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],ig=[[d3.time.format("%Y"),function(a){return!0}],[d3.time.format("%B"),function(a){return a.getMonth()}],[d3.time.format("%b %d"),function(a){return a.getDate()!=1}],[d3.time.format("%a %d"),function(a){return a.getDay()&&a.getDate()!=1}],[d3.time.format("%I %p"),function(a){return a.getHours()}],[d3.time.format("%I:%M"),function(a){return a.getMinutes()}],[d3.time.format(":%S"),function(a){return a.getSeconds()}],[d3.time.format(".%L"),function(a){return a.getMilliseconds()}]],jg=d3.scale.linear(),kg=dg(ig);hg.year=function(a,b){return jg.domain(a.map(fg)).ticks(b).map(eg)},d3.time.scale=function(){return ag(d3.scale.linear(),hg,kg)};var lg=hg.map(function(a){return[a[0].utc,a[1]]}),mg=[[d3.time.format.utc("%Y"),function(a){return!0}],[d3.time.format.utc("%B"),function(a){return a.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(a){return a.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(a){return a.getUTCDay()&&a.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(a){return a.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(a){return a.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(a){return a.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(a){return a.getUTCMilliseconds()}]],ng=dg(mg);lg.year=function(a,b){return jg.domain(a.map(pg)).ticks(b).map(og)},d3.time.scale.utc=function(){return ag(d3.scale.linear(),lg,ng)}})();
var colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};
(function(){function c(a){var b={};return a.forEach(function(a,c){b[a]=c}),b}function d(a,b){Object.keys(a).forEach(function(c){b[c]=a[c]})}function e(a){return Math.min.apply(null,a)}function f(a){return Math.max.apply(null,a)}function g(a){return Array.prototype.concat.apply([],a)}function i(a){return Object.keys(a).map(function(b){return a[b]})}function j(a){var b={};for(var c=0;c<a.length;++c){var d=a[c];for(var e=0;e<d.length;++e){var f=d[e];b[f]=f}}var g=[];for(var h in b)g.push(b[h]);return g}function p(a,b,c,d){return function(e){return arguments.length?(b[c]=e,d&&d(e),a):b[c]}}function q(){function c(b){var d=a,f=2*b,g=f+1,h=b;f<d.length&&(h=d[f].pri<d[h].pri?f:h,g<d.length&&(h=d[g].pri<d[h].pri?g:h),h!==b&&(e(b,h),c(h)))}function d(b){var c=a,d=c[b].pri,f;while(b>0){f=b>>1;if(c[f].pri<d)break;e(b,f),b=f}}function e(c,d){var e=a,f=b,g=e[c];e[c]=e[d],e[d]=g,f[e[c].key]=c,f[e[d].key]=d}function f(){return a.length}function g(){return Object.keys(b)}function h(a){return a in b}function i(c){var d=b[c];if(d!==undefined)return a[d].pri}function j(c,e){if(c in b)return!1;var f={key:c,pri:e},g=a.length;return b[c]=g,a.push(f),d(g),!0}function k(){if(f()>0)return a[0].key}function l(){e(0,a.length-1);var d=a.pop();return delete b[d.key],c(0),d.key}function m(c,e){var f=b[c];if(e>a[f].pri)throw new Error("New priority is greater than current priority. Key: "+c+" Old: "+a[f].pri+" New: "+e);a[f].pri=e,d(f)}var a=[],b={};return{size:f,keys:g,has:h,priority:i,add:j,min:k,removeMin:l,decrease:m}}dagre={},dagre.version="0.0.6",dagre.graph={},dagre.graph=function(){function k(a,b,c){var d=a[b];d||(d=a[b]={count:0,edges:{}}),d.count++,d.edges[c]=!0}function l(a,b,c){var d=a[b];--d.count==0?delete a[b]:delete d.edges[c]}function m(b){var c=a[b];if(b in a)return c;throw new Error("Node '"+b+"' is not in graph:\n"+e.toString())}function n(a){var b=d[a];if(!b)throw new Error("Edge '"+a+"' is not in graph:\n"+e.toString());return b}var a={},b={},c={},d={},e={},f=0;return e.addNode=function(d,f){if(e.hasNode(d))throw new Error("Graph already has node '"+d+"':\n"+e.toString());a[d]={id:d,value:f},b[d]={},c[d]={}},e.delNode=function(d){m(d),e.edges(d).forEach(function(a){e.delEdge(a)}),delete b[d],delete c[d],delete a[d]},e.node=function(a){return m(a).value},e.hasNode=function(b){return b in a},e.addEdge=function(a,g,h,i){m(g),m(h);if(a===null)a="_ANON-"+ ++f;else if(e.hasEdge(a))throw new Error("Graph already has edge '"+a+"':\n"+e.toString());d[a]={id:a,source:g,target:h,value:i},k(b[h],g,a),k(c[g],h,a)},e.delEdge=function(a){var e=n(a);l(b[e.target],e.source,a),l(c[e.source],e.target,a),delete d[a]},e.edge=function(a){return n(a).value},e.source=function(a){return n(a).source},e.target=function(a){return n(a).target},e.hasEdge=function(a){return a in d},e.successors=function(b){return m(b),h(c[b]).map(function(b){return a[b].id})},e.predecessors=function(c){return m(c),h(b[c]).map(function(b){return a[b].id})},e.neighbors=function(d){m(d);var e={};return h(c[d]).map(function(a){e[a]=!0}),h(b[d]).map(function(a){e[a]=!0}),h(e).map(function(b){return a[b].id})},e.nodes=function(){var a=[];return e.eachNode(function(b,c){a.push(b)}),a},e.eachNode=function(b){for(var c in a){var d=a[c];b(d.id,d.value)}},e.edges=function(a,b){var f,g;if(!arguments.length)return f=[],e.eachEdge(function(a){f.push(a)}),f;if(arguments.length===1)return j([e.inEdges(a),e.outEdges(a)]);if(arguments.length===2)return m(a),m(b),g=c[a],f=b in g?h(g[b].edges):[],f.map(function(a){return d[a].id})},e.eachEdge=function(a){for(var b in d){var c=d[b];a(c.id,c.source,c.target,c.value)}},e.inEdges=function(a){return m(a),g(i(b[a]).map(function(a){return h(a.edges)}))},e.outEdges=function(a){return m(a),g(i(c[a]).map(function(a){return h(a.edges)}))},e.subgraph=function(a){var b=dagre.graph();return a.forEach(function(a){b.addNode(a,e.node(a))}),i(d).forEach(function(a){b.hasNode(a.source)&&b.hasNode(a.target)&&b.addEdge(a.id,a.source,a.target,e.edge(a.id))}),b},e.toString=function(){var b="GRAPH:\n";return b+="    Nodes:\n",h(a).forEach(function(c){b+="        "+c+": "+JSON.stringify(a[c].value)+"\n"}),b+="    Edges:\n",h(d).forEach(function(a){var c=d[a];b+="        "+a+" ("+c.source+" -> "+c.target+"): "+JSON.stringify(d[a].value)+"\n"}),b},e},dagre.layout=function(){function h(){var b=dagre.graph(),c=0;return a.nodes.forEach(function(a){var d="id"in a?a.id:"_N"+c++;a.dagre={id:d,width:a.width,height:a.height},b.addNode(d,a.dagre)}),a.edges.forEach(function(a){var d=a.source.dagre.id;if(!b.hasNode(d))throw new Error("Source node for '"+a+"' not in node list");var e=a.target.dagre.id;if(!b.hasNode(e))throw new Error("Target node for '"+a+"' not in node list");a.dagre={points:[]};if(d!==e){var f="id"in a?a.id:"_E"+c++;a.dagre.id=f,a.dagre.minLen=a.minLen||1,a.dagre.width=a.width||0,a.dagre.height=a.height||0,b.addEdge(f,d,e,a.dagre)}}),b}function i(){var b=g.rankSep();try{if(!a.nodes.length)return;var i=h();i.eachEdge(function(a,b,c,d){d.minLen*=2}),g.rankSep(b/2),c.run(i),d.run(i),j(i),e.run(i),f.run(i),k(i),l(i),c.undo(i)}finally{g.rankSep(b)}return g}function j(a){var b=0;a.eachEdge(function(c,d,e,f){var g=a.node(d).rank,h=a.node(e).rank;if(g+1<h){for(var i=d,j=g+1,k=0;j<h;++j,++k){var l="_D"+ ++b,m={width:f.width,height:f.height,edge:{id:c,source:d,target:e,attrs:f},rank:j,dummy:!0};k===0?m.index=0:j+1===h&&(m.index=1),a.addNode(l,m),a.addEdge(null,i,l,{}),i=l}a.addEdge(null,i,e,{}),a.delEdge(c)}})}function k(a){var b={};a.eachNode(function(b,c){if(c.dummy&&"index"in c){var d=c.edge;a.hasEdge(d.id)||a.addEdge(d.id,d.source,d.target,d.attrs);var e=a.edge(d.id).points;e[c.index]={x:c.x,y:c.y},a.delNode(b)}})}function l(a){a.eachEdge(function(a,b,c,d){d.reversed&&d.points.reverse()})}function m(a){return function(){return arguments.length?(a.apply(null,arguments),g):a()}}var a={nodes:[],edges:[],debugLevel:0},b=o(),c=dagre.layout.acyclic(),d=dagre.layout.rank(),e=dagre.layout.order(),f=dagre.layout.position(),g={};return g.nodes=p(g,a,"nodes"),g.edges=p(g,a,"edges"),g.orderIters=m(e.iterations),g.nodeSep=m(f.nodeSep),g.edgeSep=m(f.edgeSep),g.rankSep=m(f.rankSep),g.rankDir=m(f.rankDir),g.debugAlignment=m(f.debugAlignment),g.debugLevel=p(g,a,"debugLevel",function(a){b.enabled(a),c.debugLevel(a),d.debugLevel(a),e.debugLevel(a),f.debugLevel(a)}),g.run=b.wrap("Total layout",i),g},dagre.layout.acyclic=function(){function d(b){function f(a){if(a in d)return;d[a]=c[a]=!0,b.outEdges(a).forEach(function(d){var g=b.target(d),h;g in c?(h=b.edge(d),b.delEdge(d),h.reversed=!0,++e,b.addEdge(d,g,a,h)):f(g)}),delete c[a]}var c={},d={},e=0;b.eachNode(function(a){f(a)}),a.debugLevel>=2&&console.log("Acyclic Phase: reversed "+e+" edge(s)")}var a={debugLevel:0},b=o(),c={};return c.debugLevel=p(c,a,"debugLevel",function(a){b.enabled(a)}),c.run=b.wrap("Acyclic Phase",d),c.undo=function(a){a.eachEdge(function(b,c,d,e){e.reversed&&(delete e.reversed,a.delEdge(b),a.addEdge(b,d,c,e))})},c},dagre.layout.rank=function(){function d(a){f(a),k(a).forEach(function(b){var c=a.subgraph(b);g(c),h(c)})}function f(a){var b={},c=q();a.eachNode(function(d){c.add(d,a.inEdges(d).length),b[d]=0});while(c.size()>0){var d=c.min();if(c.priority(d)>0)throw new Error("Input graph is not acyclic: "+a.toString());c.removeMin();var e=b[d];a.node(d).rank=e,a.outEdges(d).forEach(function(d){var f=a.target(d);b[f]=Math.max(b[f],e+(a.edge(d).minLen||1)),c.decrease(f,c.priority(f)-1)})}}function g(a){function e(f,g){d[f]=!0,a.node(f).rank=g,c[f].forEach(function(c){if(!(c in d)){var h=b[i(f,c)];e(c,g+(a.edges(f,c).length?h:-h))}})}var b={};a.eachEdge(function(a,c,d,e){var f=i(c,d);b[f]=Math.max(b[f]||1,e.minLen||1)});var c=dagre.util.prim(a,function(c,d){return Math.abs(a.node(c).rank-a.node(d).rank)-b[i(c,d)]}),d={};return e(a.nodes()[0],0),c}function h(a){var b=e(a.nodes().map(function(b){return a.node(b).rank}));a.eachNode(function(a,c){c.rank-=b})}function i(a,b){return a<b?a.length+":"+a+"-"+b:b.length+":"+b+"-"+a}var a={debugLevel:0},b=o(),c={};return c.debugLevel=p(c,a,"debugLevel",function(a){b.enabled(a)}),c.run=b.wrap("Rank Phase",d),c},dagre.layout.order=function(){function f(c){var d=g(c),e=m(d),f=a(c,d);b.debugLevel>=2&&console.log("Order phase start cross count: "+f);var h,i,k;for(i=0,k=0;k<4&&i<b.iterations;++i,++k)h=j(c,i,d),h<f&&(e=m(d),f=h,k=0),b.debugLevel>=3&&console.log("Order phase iter "+i+" cross count: "+f);return e.forEach(function(a){a.forEach(function(a,b){c.node(a).order=b})}),b.debugLevel>=2&&(console.log("Order iterations: "+i),console.log("Order phase best cross count: "+f)),e}function g(a){var b=[];return a.eachNode(function(a,c){var d=b[c.rank]||(b[c.rank]=[]);d.push(a)}),b}function h(a){return function(b){var c=[];return a.inEdges(b).forEach(function(b){c.push(a.source(b))}),c}}function i(a){return function(b){var c=[];return a.outEdges(b).forEach(function(b){c.push(a.target(b))}),c}}function j(b,c,d){if(c%2===0)for(var e=1;e<d.length;++e)k(d[e-1],d[e],h(b));else for(var e=d.length-2;e>=0;--e)k(d[e+1],d[e],i(b));return a(b,d)}function k(a,b,d){var e=c(b),f=l(a,b,d),g=b.slice(0).sort(function(a,b){return f[a]-f[b]||e[a]-e[b]});for(var h=b.length-1;h>=0;--h)f[b[h]]!==-1&&(b[h]=g.pop())}function l(a,b,d){var e=c(a),f={};return b.forEach(function(a){var b=-1,c=d(a);c.length>0&&(b=0,c.forEach(function(a){b+=e[a]}),b/=c.length),f[a]=b}),f}function m(a){return a.map(function(a){return a.slice(0)})}var b={iterations:24,debugLevel:0},d=o(),e={};return e.iterations=p(e,b,"iterations"),e.debugLevel=p(e,b,"debugLevel",function(a){d.enabled(a)}),e.run=d.wrap("Order Phase",f),e};var a=dagre.layout.order.crossCount=function(a,c){var d=0,e;return c.forEach(function(c){e&&(d+=b(a,e,c)),e=c}),d},b=dagre.layout.order.bilayerCrossCount=function(a,b,d){var e=c(d),f=[];b.forEach(function(b){var c=[];a.outEdges(b).forEach(function(b){c.push(e[a.target(b)])}),c.sort(function(a,b){return a-b}),f=f.concat(c)});var g=1;while(g<d.length)g<<=1;var h=2*g-1;g-=1;var i=[];for(var j=0;j<h;++j)i[j]=0;var k=0;return f.forEach(function(a){var b=a+g;++i[b];var c=0;while(b>0)b%2&&(k+=i[b+1]),b=b-1>>1,++i[b]}),k};dagre.layout.position=function(){function d(b){var c=[];b.eachNode(function(a,b){var d=c[b.rank]||(c[b.rank]=[]);d[b.order]=a});var d=h(b,c),g={};["up","down"].forEach(function(e){e==="down"&&c.reverse(),["left","right"].forEach(function(f){f==="right"&&s(c);var h=e+"-"+f;if(!a.debugAlignment||a.debugAlignment===h){var i=j(b,c,d,e==="up"?"predecessors":"successors");g[h]=l(b,c,i.pos,i.root,i.align),f==="right"&&r(c,g[h])}f==="right"&&s(c)}),e==="down"&&c.reverse()}),a.debugAlignment?b.eachNode(function(c,d){v(b,c,g[a.debugAlignment][c])}):q(b,c,g);var i=e(b.nodes().map(function(a){return v(b,a)-t(b,a)/2}));b.eachNode(function(a){v(b,a,v(b,a)-i)});var k=0;c.forEach(function(c){var d=f(c.map(function(a){return u(b,a)}));k+=d/2,c.forEach(function(a){w(b,a,k)}),k+=d/2+a.rankSep})}function g(a,b){return a<b?a.toString().length+":"+a+"-"+b:b.toString().length+":"+b+"-"+a}function h(a,b){var c={},d={};if(b.length<=2)return c;b[1].forEach(function(a,b){d[a]=b});for(var e=1;e<b.length-1;++e){prevLayer=b[e],currLayer=b[e+1];var f=0,h=0;for(var i=0;i<currLayer.length;++i){var j=currLayer[i];d[j]=i;var k=undefined;if(a.node(j).dummy){var l=a.predecessors(j)[0];a.node(l).dummy&&(k=d[l])}k===undefined&&i===currLayer.length-1&&(k=prevLayer.length-1);if(k!==undefined){for(;h<=i;++h)a.predecessors(currLayer[h]).forEach(function(a){var b=d[a];if(b<f||b>k)c[g(currLayer[h],a)]=!0});f=k}}}return c}function j(a,b,c,d){var e={},f={},h={};return b.forEach(function(a){a.forEach(function(a,b){f[a]=a,h[a]=a,e[a]=b})}),b.forEach(function(b){var i=-1;b.forEach(function(b){var j=a[d](b),k;j.length>0&&(j.sort(function(a,b){return e[a]-e[b]}),mid=(j.length-1)/2,j.slice(Math.floor(mid),Math.ceil(mid)+1).forEach(function(a){h[b]===b&&!c[g(a,b)]&&i<e[a]&&(h[a]=b,h[b]=f[b]=f[a],i=e[a])}))})}),{pos:e,root:f,align:h}}function k(b,c){var d=b.node(c).dummy?a.edgeSep:a.nodeSep;return t(b,c)/2+d/2}function l(a,b,c,d,e){function l(b){if(!(b in j)){j[b]=0;var i=b;do{if(c[i]>0){var m=d[h[i]];l(m),f[b]===b&&(f[b]=f[m]);var n=k(a,h[i])+k(a,i);f[b]!==f[m]?g[f[m]]=Math.min(g[f[m]]||Number.POSITIVE_INFINITY,j[b]-j[m]-n):j[b]=Math.max(j[b],j[m]+n)}i=e[i]}while(i!==b)}}var f={},g={},h={},j={};return b.forEach(function(a){a.forEach(function(b,c){f[b]=b,c>0&&(h[b]=a[c-1])})}),i(d).forEach(function(a){l(a)}),b.forEach(function(a){a.forEach(function(a){j[a]=j[d[a]];var b=g[f[a]];d[a]===a&&b<Number.POSITIVE_INFINITY&&(j[a]+=b)})}),j}function m(a,b,c){return e(b.map(function(b){var d=b[0];return c[d]-t(a,d)/2}))}function n(a,b,c){return f(b.map(function(b){var d=b[b.length-1];return c[d]-t(a,d)/2}))}function q(a,b,c){var d={},e={},f,g={},h=Number.POSITIVE_INFINITY;for(var i in c){var j=c[i];d[i]=m(a,b,j),e[i]=n(a,b,j);var k=e[i]-d[i];k<h&&(h=k,f=i)}["up","down"].forEach(function(a){["left","right"].forEach(function(b){var c=a+"-"+b;g[c]=b==="left"?d[f]-d[c]:e[f]-e[c]})}),a.eachNode(function(b){var d=[];for(i in c)d.push(c[i][b]+g[i]);d.sort(function(a,b){return a-b}),v(a,b,(d[1]+d[2])/2)})}function r(a,b){var c=f(i(b));Object.keys(b).forEach(function(a){b[a]=c-b[a]})}function s(a){a.forEach(function(a){a.reverse()})}function t(b,c){switch(a.rankDir){case"LR":return b.node(c).height;default:return b.node(c).width}}function u(b,c){switch(a.rankDir){case"LR":return b.node(c).width;default:return b.node(c).height}}function v(b,c,d){switch(a.rankDir){case"LR":if(arguments.length<3)return b.node(c).y;b.node(c).y=d;break;default:if(arguments.length<3)return b.node(c).x;b.node(c).x=d}}function w(b,c,d){switch(a.rankDir){case"LR":if(arguments.length<3)return b.node(c).x;b.node(c).x=d;break;default:if(arguments.length<3)return b.node(c).y;b.node(c).y=d}}var a={nodeSep:50,edgeSep:10,rankSep:30,rankDir:"TB",debugAlignment:null,debugLevel:0},b=o(),c={};return c.nodeSep=p(c,a,"nodeSep"),c.edgeSep=p(c,a,"edgeSep"),c.rankSep=p(c,a,"rankSep"),c.rankDir=p(c,a,"rankDir"),c.debugAlignment=p(c,a,"debugAlignment"),c.debugLevel=p(c,a,"debugLevel",function(a){b.enabled(a)}),c.run=b.wrap("Position Phase",d),c},dagre.util={};var h=dagre.util.keys=Object.keys,k=dagre.util.components=function(a){function d(b,e){b in c||(c[b]=!0,e.push(b),a.neighbors(b).forEach(function(a){d(a,e)}))}var b=[],c={};return a.eachNode(function(a){var c=[];d(a,c),c.length>0&&b.push(c)}),b},l=dagre.util.prim=function(a,b){var c={},d={},e=q();if(a.nodes().length===0)return c;a.eachNode(function(a){e.add(a,Number.POSITIVE_INFINITY),c[a]=[]}),e.decrease(a.nodes()[0],0);var f,g=!1;while(e.size()>0){f=e.removeMin();if(f in d)c[f].push(d[f]),c[d[f]].push(f);else{if(g)throw new Error("Input graph is not connected:\n"+a.toString());g=!0}a.neighbors(f).forEach(function(a){var c=e.priority(a);if(c!==undefined){var g=b(f,a);g<c&&(d[a]=f,e.decrease(a,g))}})}return c},m=dagre.util.intersectRect=function(a,b){var c=a.x,d=a.y,e=b.x-c,f=b.y-d,g=a.width/2,h=a.height/2,i,j;return Math.abs(f)*g>Math.abs(e)*h?(f<0&&(h=-h),i=f===0?0:h*e/f,j=h):(e<0&&(g=-g),i=g,j=e===0?0:g*f/e),{x:c+i,y:d+j}},n=dagre.util.pointStr=function(a){return a.x+","+a.y},o=function(){var a={},b=!1;return a.enabled=function(c){return arguments.length?(b=c,a):b},a.wrap=function(a,c){return function(){var d=b?(new Date).getTime():null;try{return c.apply(null,arguments)}finally{d&&console.log(a+" time: "+((new Date).getTime()-d)+"ms")}}},a};dagre.dot={},dagre.dot.toGraph=function(a){function f(a,b){c.hasNode(a)||c.addNode(a,{id:a,label:a}),b&&d(b,c.node(a))}function h(a,b,e){var f=a+"-"+b,h=g[f];h||(h=g[f]=0),g[f]++;var i=e.id||f+"-"+h,j={};d(e,j),d({id:i},j),c.addEdge(i,a,b,j)}function i(a){switch(a.type){case"node":f(a.id,a.attrs);break;case"edge":var b;a.elems.forEach(function(c){i(c);switch(c.type){case"node":var d=c.id;b&&(h(b,d,a.attrs),e&&h(d,b,a.attrs)),b=d;break;default:throw new Error("Unsupported type incident on edge: "+c.type)}});break;case"attr":break;default:throw new Error("Unsupported statement type: "+a.type)}}var b=dot_parser.parse(a),c=dagre.graph(),e=b.type==="graph",g={};return b.stmts&&b.stmts.forEach(function(a){i(a)}),c},dagre.dot.toObjects=function(a){var b=dagre.dot.toGraph(a),c=b.nodes().map(function(a){return b.node(a)}),d=b.edges().map(function(a){var c=b.edge(a);return c.source=b.node(b.source(a)),c.target=b.node(b.target(a)),c});return{nodes:c,edges:d}},dot_parser=function(){function a(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var b={parse:function(b,c){function i(a,b,c){var d=a,e=c-a.length;for(var f=0;f<e;f++)d=b+d;return d}function j(a){var b=a.charCodeAt(0),c,d;return b<=255?(c="x",d=2):(c="u",d=4),"\\"+c+i(b.toString(16).toUpperCase(),"0",d)}function k(a){if(e<g)return;e>g&&(g=e,h=[]),h.push(a)}function l(){var a,c,d,g,h,i,j,l,n,o,p,q,r,s,t,u;s=e,t=e,a=[],c=M();while(c!==null)a.push(c),c=M();if(a!==null){u=e,c=I(),c!==null?(d=M(),d!==null?c=[c,d]:(c=null,e=u)):(c=null,e=u),c=c!==null?c:"";if(c!==null){d=J();if(d!==null){g=[],h=M();while(h!==null)g.push(h),h=M();if(g!==null){h=C(),h=h!==null?h:"";if(h!==null){i=[],j=M();while(j!==null)i.push(j),j=M();if(i!==null){b.charCodeAt(e)===123?(j="{",e++):(j=null,f===0&&k('"{"'));if(j!==null){l=[],n=M();while(n!==null)l.push(n),n=M();if(l!==null){n=m(),n=n!==null?n:"";if(n!==null){o=[],p=M();while(p!==null)o.push(p),p=M();if(o!==null){b.charCodeAt(e)===125?(p="}",e++):(p=null,f===0&&k('"}"'));if(p!==null){q=[],r=M();while(r!==null)q.push(r),r=M();q!==null?a=[a,c,d,g,h,i,j,l,n,o,p,q]:(a=null,e=t)}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t}else a=null,e=t;return a!==null&&(a=function(a,b,c,d){return{type:b,id:c,stmts:d}}(s,a[2],a[4],a[8])),a===null&&(e=s),a}function m(){var a,c,d,g,h,i,j,l,m,o,p;m=e,o=e,a=n();if(a!==null){c=[],d=M();while(d!==null)c.push(d),d=M();if(c!==null){b.charCodeAt(e)===59?(d=";",e++):(d=null,f===0&&k('";"')),d=d!==null?d:"";if(d!==null){g=[],p=e,h=[],i=M();while(i!==null)h.push(i),i=M();if(h!==null){i=n();if(i!==null){j=[],l=M();while(l!==null)j.push(l),l=M();j!==null?(b.charCodeAt(e)===59?(l=";",e++):(l=null,f===0&&k('";"')),l=l!==null?l:"",l!==null?h=[h,i,j,l]:(h=null,e=p)):(h=null,e=p)}else h=null,e=p}else h=null,e=p;while(h!==null){g.push(h),p=e,h=[],i=M();while(i!==null)h.push(i),i=M();if(h!==null){i=n();if(i!==null){j=[],l=M();while(l!==null)j.push(l),l=M();j!==null?(b.charCodeAt(e)===59?(l=";",e++):(l=null,f===0&&k('";"')),l=l!==null?l:"",l!==null?h=[h,i,j,l]:(h=null,e=p)):(h=null,e=p)}else h=null,e=p}else h=null,e=p}g!==null?a=[a,c,d,g]:(a=null,e=o)}else a=null,e=o}else a=null,e=o}else a=null,e=o;return a!==null&&(a=function(a,b,c){var d=[b];for(var e=0;e<c.length;++e)d.push(c[e][1]);return d}(m,a[0],a[3])),a===null&&(e=m),a}function n(){var a;return a=o(),a===null&&(a=s(),a===null&&(a=p(),a===null&&(a=r(),a===null&&(a=q())))),a}function o(){var a,b,c,d,f;d=e,f=e,a=F(),a===null&&(a=D(),a===null&&(a=E()));if(a!==null){b=[],c=M();while(c!==null)b.push(c),c=M();b!==null?(c=t(),c!==null?a=[a,b,c]:(a=null,e=f)):(a=null,e=f)}else a=null,e=f;return a!==null&&(a=function(a,b,c){return{type:"attr",attrType:b,attrs:c||{}}}(d,a[0],a[2])),a===null&&(e=d),a}function p(){var a,c,d,g,h,i,j;i=e,j=e,a=C();if(a!==null){c=[],d=M();while(d!==null)c.push(d),d=M();if(c!==null){b.charCodeAt(e)===61?(d="=",e++):(d=null,f===0&&k('"="'));if(d!==null){g=[],h=M();while(h!==null)g.push(h),h=M();g!==null?(h=C(),h!==null?a=[a,c,d,g,h]:(a=null,e=j)):(a=null,e=j)}else a=null,e=j}else a=null,e=j}else a=null,e=j;return a!==null&&(a=function(a,b,c){var d={};return d[b]=c,{type:"inlineAttr",attrs:d}}(i,a[0],a[4])),a===null&&(e=i),a}function q(){var a,b,c,d,f;d=e,f=e,a=z();if(a!==null){b=[],c=M();while(c!==null)b.push(c),c=M();b!==null?(c=t(),c=c!==null?c:"",c!==null?a=[a,b,c]:(a=null,e=f)):(a=null,e=f)}else a=null,e=f;return a!==null&&(a=function(a,b,c){return{type:"node",id:b,attrs:c||{}}}(d,a[0],a[2])),a===null&&(e=d),a}function r(){var a,b,c,d,f,g,h;g=e,h=e,a=y();if(a!==null){b=[],c=M();while(c!==null)b.push(c),c=M();if(b!==null){c=w();if(c!==null){d=[],f=M();while(f!==null)d.push(f),f=M();d!==null?(f=t(),f=f!==null?f:"",f!==null?a=[a,b,c,d,f]:(a=null,e=h)):(a=null,e=h)}else a=null,e=h}else a=null,e=h}else a=null,e=h;return a!==null&&(a=function(a,b,c,d){var e=[b];for(var f=0;f<c.length;++f)e.push(c[f]);return{type:"edge",elems:e,attrs:d||{}}}(g,a[0],a[2],a[4])),a===null&&(e=g),a}function s(){var a,c,d,g,h,i,j,l,n,o;j=e,l=e,n=e,a=H();if(a!==null){c=[],d=M();while(d!==null)c.push(d),d=M();if(c!==null){o=e,d=C();if(d!==null){g=[],h=M();while(h!==null)g.push(h),h=M();g!==null?d=[d,g]:(d=null,e=o)}else d=null,e=o;d=d!==null?d:"",d!==null?a=[a,c,d]:(a=null,e=n)}else a=null,e=n}else a=null,e=n;a=a!==null?a:"";if(a!==null){b.charCodeAt(e)===123?(c="{",e++):(c=null,f===0&&k('"{"'));if(c!==null){d=[],g=M();while(g!==null)d.push(g),g=M();if(d!==null){g=m();if(g!==null){h=[],i=M();while(i!==null)h.push(i),i=M();h!==null?(b.charCodeAt(e)===125?(i="}",e++):(i=null,f===0&&k('"}"')),i!==null?a=[a,c,d,g,h,i]:(a=null,e=l)):(a=null,e=l)}else a=null,e=l}else a=null,e=l}else a=null,e=l}else a=null,e=l;return a!==null&&(a=function(a,b,c){return b=b[2]||[],{type:"subgraph",id:b[0],stmts:c}}(j,a[0],a[3])),a===null&&(e=j),a}function t(){var a,b,c,d,f,g,h;f=e,g=e,a=u();if(a!==null){b=[],h=e,c=[],d=M();while(d!==null)c.push(d),d=M();c!==null?(d=u(),d!==null?c=[c,d]:(c=null,e=h)):(c=null,e=h);while(c!==null){b.push(c),h=e,c=[],d=M();while(d!==null)c.push(d),d=M();c!==null?(d=u(),d!==null?c=[c,d]:(c=null,e=h)):(c=null,e=h)}b!==null?a=[a,b]:(a=null,e=g)}else a=null,e=g;return a!==null&&(a=function(a,b,c){var d=b;for(var e=0;e<c.length;++e)d=Q(d,c[e][1]);return d}(f,a[0],a[1])),a===null&&(e=f),a}function u(){var a,c,d,g,h,i,j;i=e,j=e,b.charCodeAt(e)===91?(a="[",e++):(a=null,f===0&&k('"["'));if(a!==null){c=[],d=M();while(d!==null)c.push(d),d=M();if(c!==null){d=v(),d=d!==null?d:"";if(d!==null){g=[],h=M();while(h!==null)g.push(h),h=M();g!==null?(b.charCodeAt(e)===93?(h="]",e++):(h=null,f===0&&k('"]"')),h!==null?a=[a,c,d,g,h]:(a=null,e=j)):(a=null,e=j)}else a=null,e=j}else a=null,e=j}else a=null,e=j;return a!==null&&(a=function(a,b){return b}(i,a[2])),a===null&&(e=i),a}function v(){var a,c,d,g,h,i,j,l,m;j=e,l=e,a=x();if(a!==null){c=[],m=e,d=[],g=M();while(g!==null)d.push(g),g=M();if(d!==null){b.charCodeAt(e)===44?(g=",",e++):(g=null,f===0&&k('","')),g=g!==null?g:"";if(g!==null){h=[],i=M();while(i!==null)h.push(i),i=M();h!==null?(i=x(),i!==null?d=[d,g,h,i]:(d=null,e=m)):(d=null,e=m)}else d=null,e=m}else d=null,e=m;while(d!==null){c.push(d),m=e,d=[],g=M();while(g!==null)d.push(g),g=M();if(d!==null){b.charCodeAt(e)===44?(g=",",e++):(g=null,f===0&&k('","')),g=g!==null?g:"";if(g!==null){h=[],i=M();while(i!==null)h.push(i),i=M();h!==null?(i=x(),i!==null?d=[d,g,h,i]:(d=null,e=m)):(d=null,e=m)}else d=null,e=m}else d=null,e=m}c!==null?a=[a,c]:(a=null,e=l)}else a=null,e=l;return a!==null&&(a=function(a,b,c){var d=b;for(var e=0;e<c.length;++e)d=Q(d,c[e][3]);return d}(j,a[0],a[1])),a===null&&(e=j),a}function w(){var a,c,d,g,h,i,j,l;i=e,j=e,l=e,b.substr(e,2)==="--"?(a="--",e+=2):(a=null,f===0&&k('"--"')),a!==null?(c=function(a){return P}(e)?null:"",c!==null?a=[a,c]:(a=null,e=l)):(a=null,e=l),a===null&&(l=e,b.substr(e,2)==="->"?(a="->",e+=2):(a=null,f===0&&k('"->"')),a!==null?(c=function(a){return P}(e)?"":null,c!==null?a=[a,c]:(a=null,e=l)):(a=null,e=l));if(a!==null){c=[],d=M();while(d!==null)c.push(d),d=M();if(c!==null){d=y();if(d!==null){g=[],h=M();while(h!==null)g.push(h),h=M();g!==null?(h=w(),h=h!==null?h:"",h!==null?a=[a,c,d,g,h]:(a=null,e=j)):(a=null,e=j)}else a=null,e=j}else a=null,e=j}else a=null,e=j;return a!==null&&(a=function(a,b,c){var d=[b];for(var e=0;e<c.length;++e)d.push(c[e]);return d}(i,a[2],a[4])),a===null&&(e=i),a}function x(){var a,c,d,g,h,i,j,l;i=e,j=e,a=C();if(a!==null){l=e,c=[],d=M();while(d!==null)c.push(d),d=M();if(c!==null){b.charCodeAt(e)===61?(d="=",e++):(d=null,f===0&&k('"="'));if(d!==null){g=[],h=M();while(h!==null)g.push(h),h=M();g!==null?(h=C(),h!==null?c=[c,d,g,h]:(c=null,e=l)):(c=null,e=l)}else c=null,e=l}else c=null,e=l;c=c!==null?c:"",c!==null?a=[a,c]:(a=null,e=j)}else a=null,e=j;return a!==null&&(a=function(a,b,c){var d={};return d[b]=c[3],d}(i,a[0],a[1])),a===null&&(e=i),a}function y(){var a,b;return a=s(),a===null&&(b=e,a=z(),a!==null&&(a=function(a,b){return{type:"node",id:b,attrs:{}}}(b,a)),a===null&&(e=b)),a}function z(){var a,b,c,d,f;d=e,f=e,a=C();if(a!==null){b=[],c=M();while(c!==null)b.push(c),c=M();b!==null?(c=A(),c=c!==null?c:"",c!==null?a=[a,b,c]:(a=null,e=f)):(a=null,e=f)}else a=null,e=f;return a!==null&&(a=function(a,b){return b}(d,a[0])),a===null&&(e=d),a}function A(){var a,c,d,g,h,i,j,l,m;l=e,b.charCodeAt(e)===58?(a=":",e++):(a=null,f===0&&k('":"'));if(a!==null){c=[],d=M();while(d!==null)c.push(d),d=M();if(c!==null){d=C();if(d!==null){g=[],h=M();while(h!==null)g.push(h),h=M();if(g!==null){m=e,b.charCodeAt(e)===58?(h=":",e++):(h=null,f===0&&k('":"'));if(h!==null){i=[],j=M();while(j!==null)i.push(j),j=M();i!==null?(j=B(),j!==null?h=[h,i,j]:(h=null,e=m)):(h=null,e=m)}else h=null,e=m;h=h!==null?h:"",h!==null?a=[a,c,d,g,h]:(a=null,e=l)}else a=null,e=l}else a=null,e=l}else a=null,e=l}else a=null,e=l;return a}function B(){var a;return b.charCodeAt(e)===110?(a="n",e++):(a=null,f===0&&k('"n"')),a===null&&(b.substr(e,2)==="ne"?(a="ne",e+=2):(a=null,f===0&&k('"ne"')),a===null&&(b.charCodeAt(e)===101?(a="e",e++):(a=null,f===0&&k('"e"')),a===null&&(b.substr(e,2)==="se"?(a="se",e+=2):(a=null,f===0&&k('"se"')),a===null&&(b.charCodeAt(e)===115?(a="s",e++):(a=null,f===0&&k('"s"')),a===null&&(b.substr(e,2)==="sw"?(a="sw",e+=2):(a=null,f===0&&k('"sw"')),a===null&&(b.charCodeAt(e)===119?(a="w",e++):(a=null,f===0&&k('"w"')),a===null&&(b.substr(e,2)==="nw"?(a="nw",e+=2):(a=null,f===0&&k('"nw"')),a===null&&(b.charCodeAt(e)===99?(a="c",e++):(a=null,f===0&&k('"c"')),a===null&&(b.charCodeAt(e)===95?(a="_",e++):(a=null,f===0&&k('"_"'))))))))))),a}function C(){var a,c,d,g,h,i,j,l,m;f++,i=e,j=e,/^[a-zA-Z\u0200-\u0377_]/.test(b.charAt(e))?(a=b.charAt(e),e++):(a=null,f===0&&k("[a-zA-Z\\u0200-\\u0377_]"));if(a!==null){c=[],/^[a-zA-Z\u0200-\u0377_0-9]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k("[a-zA-Z\\u0200-\\u0377_0-9]"));while(d!==null)c.push(d),/^[a-zA-Z\u0200-\u0377_0-9]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k("[a-zA-Z\\u0200-\\u0377_0-9]"));c!==null?a=[a,c]:(a=null,e=j)}else a=null,e=j;a!==null&&(a=function(a,b,c){return b+c.join("")}(i,a[0],a[1])),a===null&&(e=i);if(a===null){i=e,j=e,b.charCodeAt(e)===45?(a="-",e++):(a=null,f===0&&k('"-"')),a=a!==null?a:"";if(a!==null){b.charCodeAt(e)===46?(c=".",e++):(c=null,f===0&&k('"."'));if(c!==null){/^[0-9]/.test(b.charAt(e))?(g=b.charAt(e),e++):(g=null,f===0&&k("[0-9]"));if(g!==null){d=[];while(g!==null)d.push(g),/^[0-9]/.test(b.charAt(e))?(g=b.charAt(e),e++):(g=null,f===0&&k("[0-9]"))}else d=null;d!==null?a=[a,c,d]:(a=null,e=j)}else a=null,e=j}else a=null,e=j;a!==null&&(a=function(a,b,c,d){return b+c+d.join("")}(i,a[0],a[1],a[2])),a===null&&(e=i);if(a===null){i=e,j=e,b.charCodeAt(e)===45?(a="-",e++):(a=null,f===0&&k('"-"')),a=a!==null?a:"";if(a!==null){/^[0-9]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k("[0-9]"));if(d!==null){c=[];while(d!==null)c.push(d),/^[0-9]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k("[0-9]"))}else c=null;if(c!==null){l=e,b.charCodeAt(e)===46?(d=".",e++):(d=null,f===0&&k('"."'));if(d!==null){g=[],/^[0-9]/.test(b.charAt(e))?(h=b.charAt(e),e++):(h=null,f===0&&k("[0-9]"));while(h!==null)g.push(h),/^[0-9]/.test(b.charAt(e))?(h=b.charAt(e),e++):(h=null,f===0&&k("[0-9]"));g!==null?d=[d,g]:(d=null,e=l)}else d=null,e=l;d=d!==null?d:"",d!==null?a=[a,c,d]:(a=null,e=j)}else a=null,e=j}else a=null,e=j;a!==null&&(a=function(a,b,c,d){return b+c.join("")+(d[0]||"")+(d[1]||[]).join("")}(i,a[0],a[1],a[2])),a===null&&(e=i);if(a===null){i=e,j=e,b.charCodeAt(e)===34?(a='"',e++):(a=null,f===0&&k('"\\""'));if(a!==null){l=e,b.substr(e,2)==='\\"'?(d='\\"',e+=2):(d=null,f===0&&k('"\\\\\\""')),d!==null&&(d=function(a){return'"'}(l)),d===null&&(e=l),d===null&&(l=e,m=e,b.charCodeAt(e)===92?(d="\\",e++):(d=null,f===0&&k('"\\\\"')),d!==null?(/^[^"]/.test(b.charAt(e))?(g=b.charAt(e),e++):(g=null,f===0&&k('[^"]')),g!==null?d=[d,g]:(d=null,e=m)):(d=null,e=m),d!==null&&(d=function(a,b){return"\\"+b}(l,d[1])),d===null&&(e=l),d===null&&(/^[^"]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k('[^"]'))));if(d!==null){c=[];while(d!==null)c.push(d),l=e,b.substr(e,2)==='\\"'?(d='\\"',e+=2):(d=null,f===0&&k('"\\\\\\""')),d!==null&&(d=function(a){return'"'}(l)),d===null&&(e=l),d===null&&(l=e,m=e,b.charCodeAt(e)===92?(d="\\",e++):(d=null,f===0&&k('"\\\\"')),d!==null?(/^[^"]/.test(b.charAt(e))?(g=b.charAt(e),e++):(g=null,f===0&&k('[^"]')),g!==null?d=[d,g]:(d=null,e=m)):(d=null,e=m),d!==null&&(d=function(a,b){return"\\"+b}(l,d[1])),d===null&&(e=l),d===null&&(/^[^"]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k('[^"]'))))}else c=null;c!==null?(b.charCodeAt(e)===34?(d='"',e++):(d=null,f===0&&k('"\\""')),d!==null?a=[a,c,d]:(a=null,e=j)):(a=null,e=j)}else a=null,e=j;a!==null&&(a=function(a,b){return b.join("")}(i,a[1])),a===null&&(e=i)}}}return f--,f===0&&a===null&&k("identifier"),a}function D(){var a,c;return c=e,b.substr(e,4).toLowerCase()==="node"?(a=b.substr(e,4),e+=4):(a=null,f===0&&k('"node"')),a!==null&&(a=function(a,b){return b.toLowerCase()}(c,a)),a===null&&(e=c),a}function E(){var a,c;return c=e,b.substr(e,4).toLowerCase()==="edge"?(a=b.substr(e,4),e+=4):(a=null,f===0&&k('"edge"')),a!==null&&(a=function(a,b){return b.toLowerCase()}(c,a)),a===null&&(e=c),a}function F(){var a,c;return c=e,b.substr(e,5).toLowerCase()==="graph"?(a=b.substr(e,5),e+=5):(a=null,f===0&&k('"graph"')),a!==null&&(a=function(a,b){return b.toLowerCase()}(c,a)),a===null&&(e=c),a}function G(){var a,c;return c=e,b.substr(e,7).toLowerCase()==="digraph"?(a=b.substr(e,7),e+=7):(a=null,f===0&&k('"digraph"')),a!==null&&(a=function(a,b){return b.toLowerCase()}(c,a)),a===null&&(e=c),a}function H(){var a,c;return c=e,b.substr(e,8).toLowerCase()==="subgraph"?(a=b.substr(e,8),e+=8):(a=null,f===0&&k('"subgraph"')),a!==null&&(a=function(a,b){return b.toLowerCase()}(c,a)),a===null&&(e=c),a}function I(){var a,c;return c=e,b.substr(e,6).toLowerCase()==="strict"?(a=b.substr(e,6),e+=6):(a=null,f===0&&k('"strict"')),a!==null&&(a=function(a,b){return b.toLowerCase()}(c,a)),a===null&&(e=c),a}function J(){var a,b;return a=F(),a===null&&(b=e,a=G(),a!==null&&(a=function(a,b){return P=b==="digraph",b}(b,a)),a===null&&(e=b)),a}function K(){var a,c;f++,/^[ \t\r\n]/.test(b.charAt(e))?(c=b.charAt(e),e++):(c=null,f===0&&k("[ \\t\\r\\n]"));if(c!==null){a=[];while(c!==null)a.push(c),/^[ \t\r\n]/.test(b.charAt(e))?(c=b.charAt(e),e++):(c=null,f===0&&k("[ \\t\\r\\n]"))}else a=null;return f--,f===0&&a===null&&k("whitespace"),a}function L(){var a,c,d,g,h,i,j;f++,h=e,b.substr(e,2)==="//"?(a="//",e+=2):(a=null,f===0&&k('"//"'));if(a!==null){c=[],/^[^\n]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k("[^\\n]"));while(d!==null)c.push(d),/^[^\n]/.test(b.charAt(e))?(d=b.charAt(e),e++):(d=null,f===0&&k("[^\\n]"));c!==null?a=[a,c]:(a=null,e=h)}else a=null,e=h;if(a===null){h=e,b.substr(e,2)==="/*"?(a="/*",e+=2):(a=null,f===0&&k('"/*"'));if(a!==null){c=[],i=e,j=e,f++,b.substr(e,2)==="*/"?(d="*/",e+=2):(d=null,f===0&&k('"*/"')),f--,d===null?d="":(d=null,e=j),d!==null?(b.length>e?(g=b.charAt(e),e++):(g=null,f===0&&k("any character")),g!==null?d=[d,g]:(d=null,e=i)):(d=null,e=i);while(d!==null)c.push(d),i=e,j=e,f++,b.substr(e,2)==="*/"?(d="*/",e+=2):(d=null,f===0&&k('"*/"')),f--,d===null?d="":(d=null,e=j),d!==null?(b.length>e?(g=b.charAt(e),e++):(g=null,f===0&&k("any character")),g!==null?d=[d,g]:(d=null,e=i)):(d=null,e=i);c!==null?(b.substr(e,2)==="*/"?(d="*/",e+=2):(d=null,f===0&&k('"*/"')),d!==null?a=[a,c,d]:(a=null,e=h)):(a=null,e=h)}else a=null,e=h}return f--,f===0&&a===null&&k("comment"),a}function M(){var a;return a=K(),a===null&&(a=L()),a}function N(a){a.sort();var b=null,c=[];for(var d=0;d<a.length;d++)a[d]!==b&&(c.push(a[d]),b=a[d]);return c}function O(){var a=1,c=1,d=!1;for(var f=0;f<Math.max(e,g);f++){var h=b.charAt(f);h==="\n"?(d||a++,c=1,d=!1):h==="\r"||h==="\u2028"||h==="\u2029"?(a++,c=1,d=!0):(c++,d=!1)}return{line:a,column:c}}function Q(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}var d={start:l,stmtList:m,stmt:n,attrStmt:o,inlineAttrStmt:p,nodeStmt:q,edgeStmt:r,subgraphStmt:s,attrList:t,attrListBlock:u,aList:v,edgeRHS:w,idDef:x,nodeIdOrSubgraph:y,nodeId:z,port:A,compassPt:B,id:C,node:D,edge:E,graph:F,digraph:G,subgraph:H,strict:I,graphType:J,whitespace:K,comment:L,_:M};if(c!==undefined){if(d[c]===undefined)throw new Error("Invalid rule name: "+a(c)+".")}else c="start";var e=0,f=0,g=0,h=[],P,R=d[c]();if(R===null||e!==b.length){var S=Math.max(e,g),T=S<b.length?b.charAt(S):null,U=O();throw new this.SyntaxError(N(h),T,S,U.line,U.column)}return R},toSource:function(){return this._source}};return b.SyntaxError=function(b,c,d,e,f){function g(b,c){var d,e;switch(b.length){case 0:d="end of input";break;case 1:d=b[0];break;default:d=b.slice(0,b.length-1).join(", ")+" or "+b[b.length-1]}return e=c?a(c):"end of input","Expected "+d+" but "+e+" found."}this.name="SyntaxError",this.expected=b,this.found=c,this.message=g(b,c),this.offset=d,this.line=e,this.column=f},b.SyntaxError.prototype=Error.prototype,b}()})();
Ext.define("Ext.ux.form.field.BoxSelect",{extend:"Ext.form.field.ComboBox",alias:["widget.comboboxselect","widget.boxselect"],multiSelect:!0,forceSelection:!0,selectOnFocus:!0,createNewOnEnter:!1,stacked:!1,pinList:!0,fieldSubTpl:['<div class="x-boxselect">','<ul class="x-boxselect-list {fieldCls} {typeCls}">','<li class="x-boxselect-input">','<input id="{id}" type="{type}" ','<tpl if="name">name="{name}" </tpl>','<tpl if="size">size="{size}" </tpl>','<tpl if="tabIdx">tabIndex="{tabIdx}" </tpl>','class="x-boxselect-input-field" autocomplete="off" />',"</li>","</ul>",'<div class="{triggerWrapCls}" role="presentation">',"{triggerEl}",'<div class="{clearCls}" role="presentation"></div>',"</div>","</div>",{compiled:!0,disableFormats:!0}],renderSelectors:{itemList:"ul.x-boxselect-list",inputEl:"input.x-boxselect-input-field",inputElCt:"li.x-boxselect-input"},componentLayout:"boxselectfield",initComponent:function(){var a=this,b=a.typeAhead;b&&!a.editable&&Ext.Error.raise("If typeAhead is enabled the combo must be editable: true -- please change one of those settings."),Ext.apply(a,{typeAhead:!1}),a.callParent(arguments),a.typeAhead=b,a.selectionModel=new Ext.selection.Model({store:a.valueStore,mode:"MULTI",onSelectChange:function(a,b,c,d){d()}}),!Ext.isEmpty(a.delimiter)&&a.multiSelect&&(a.delimiterEndingRegexp=new RegExp(String(a.delimiter).replace(/[$%()*+.?\[\\\]{|}]/g,"\\$&")+"$"))},initEvents:function(){var a=this;a.callParent(arguments),a.enableKeyEvents||a.mon(a.inputEl,"keydown",a.onKeyDown,a),a.mon(a.itemList,"click",a.onItemListClick,a),a.mon(a.selectionModel,"selectionchange",a.applyMultiselectItemMarkup,a)},bindStore:function(a,b){var c=this,d=c.store;d&&c.mun(d,"beforeload",c.onBeforeLoad,c),c.valueStore&&(c.mun(c.valueStore,"datachanged",c.applyMultiselectItemMarkup,c),c.valueStore=null),c.callParent(arguments),c.store&&(c.valueStore=new Ext.data.Store({model:c.store.model,proxy:{type:"memory"}}),c.mon(c.valueStore,"datachanged",c.applyMultiselectItemMarkup,c),c.mon(c.store,"beforeload",c.onBeforeLoad,c))},createPicker:function(){var a=this,b=a.callParent(arguments);return a.mon(b,"beforerefresh",a.onBeforeListRefresh,a),b},onDestroy:function(){var a=this;Ext.destroyMembers(a,"selectionModel","valueStore"),a.callParent(arguments)},afterRender:function(){var a=this;Ext.supports.Placeholder&&a.inputEl&&a.emptyText&&delete a.inputEl.dom.placeholder,a.callParent(arguments),a.stacked===!0&&a.itemList.addCls("x-boxselect-stacked"),a.applyMultiselectItemMarkup()},findRecord:function(a,b){var c=this.store,d=!1,e;return c.snapshot?(e=c.snapshot.findIndexBy(function(c){return c.get(a)===b}),d=e!==-1?c.snapshot.getAt(e):!1):(e=c.findExact(a,b),d=e!==-1?c.getAt(e):!1),d},onBeforeLoad:function(){this.ignoreSelection++},onLoad:function(){var a=this,b=a.valueField,c=a.valueStore,d=!1;c.suspendEvents(),c.each(function(e){var f=a.findRecord(b,e.get(b)),g=f?c.indexOf(e):-1;g>=0&&(c.removeAt(g),c.insert(g,f),d=!0)}),c.resumeEvents(),d&&c.fireEvent("datachanged",c),a.callParent(arguments),a.ignoreSelection--},isFilteredRecord:function(a){var b=this,c=b.store,d=b.valueField,e,f=!1;return e=c.findExact(d,a.get(d)),f=e===-1&&(!c.snapshot||b.findRecord(d,a.get(d))!==!1),f=f||!f&&e===-1&&b.forceSelection!==!0&&b.valueStore.findExact(d,a.get(d))>=0,f},doRawQuery:function(){var a=this,b=a.inputEl.dom.value;a.multiSelect&&(b=b.split(a.delimiter).pop()),this.doQuery(b)},onBeforeListRefresh:function(){this.ignoreSelection++},onListRefresh:function(){this.callParent(arguments),this.ignoreSelection--},onListSelectionChange:function(a,b){var c=this,d=c.valueStore,e=[],f;if(!c.ignoreSelection&&c.isExpanded){d.each(function(a){(Ext.Array.contains(b,a)||c.isFilteredRecord(a))&&e.push(a)}),e=Ext.Array.merge(e,b),f=Ext.Array.intersect(e,d.getRange()).length;if(f!=e.length||f!=c.valueStore.getCount())c.setValue(e,!1),(!c.multiSelect||!c.pinList)&&Ext.defer(c.collapse,1,c),d.getCount()>0&&c.fireEvent("select",c,d.getRange()),c.inputEl.focus();c.alignPicker()}},syncSelection:function(){var a=this,b=a.picker,c=a.valueField,d,e,f;b&&(d=b.store,e=[],a.valueStore.each(function(a){var b=d.findExact(c,a.get(c));b>=0&&e.push(d.getAt(b))}),a.ignoreSelection++,f=b.getSelectionModel(),f.deselectAll(),e.length>0&&f.select(e),a.ignoreSelection--)},alignPicker:function(){var a=this,b,c,d="-above",e=a.itemList.getBox(!1,!0);if(this.isExpanded){b=a.getPicker();var f=b.getTargetEl().dom.scrollTop;a.matchFieldWidth&&b.setSize(e.width,b.store&&b.store.getCount()?null:0),b.isFloating()&&(b.alignTo(a.itemList,a.pickerAlign,a.pickerOffset),c=b.el.getY()<a.inputEl.getY(),a.bodyEl[c?"addCls":"removeCls"](a.openCls+d),b.el[c?"addCls":"removeCls"](b.baseCls+d)),b.getSelectedNodes().length>0&&b.getTargetEl().scrollTo("top",f)}},getCursorPosition:function(){var a;return Ext.isIE?(a=document.selection.createRange(),a.collapse(!0),a.moveStart("character",-this.inputEl.dom.value.length),a=a.text.length):a=this.inputEl.dom.selectionStart,a},hasSelectedText:function(){var a,b;return Ext.isIE?(a=document.selection,b=a.createRange(),b.parentElement()==this.inputEl.dom):this.inputEl.dom.selectionStart!=this.inputEl.dom.selectionEnd},onKeyDown:function(a,b){var c=this,d=a.getKey(),e=c.inputEl.dom.value,f=c.valueStore,g=c.selectionModel,h=!1,i,j;!c.readOnly&&!c.disabled&&f.getCount()>0&&(e==""||c.getCursorPosition()===0&&!c.hasSelectedText())&&(d==a.BACKSPACE||d==a.DELETE?(g.getCount()>0?c.valueStore.remove(g.getSelection()):c.valueStore.remove(c.valueStore.last()),c.setValue(c.valueStore.getRange()),g.deselectAll(),h=!0):d==a.RIGHT||d==a.LEFT?g.getCount()===0&&d==a.LEFT?(g.select(f.last()),h=!0):g.getCount()>0&&(i=g.getLastFocused()||g.getLastSelected(),i&&(j=f.indexOf(i),d==a.RIGHT?j<f.getCount()-1?(g.select(j+1,a.shiftKey),h=!0):a.shiftKey||(g.deselect(i),h=!0):d==a.LEFT&&j>0&&(g.select(j-1,a.shiftKey),h=!0))):d==a.A&&a.ctrlKey&&(g.selectAll(),h=a.A),c.inputEl.focus());if(h){c.preventKeyUpEvent=h,a.stopEvent();return}c.enableKeyEvents&&c.callParent(arguments),!a.isSpecialKey()&&!a.hasModifier()&&(c.selectionModel.deselectAll(),c.inputEl.focus())},onKeyUp:function(a,b){var c=this,d=c.inputEl.dom.value,e;if(c.preventKeyUpEvent){a.stopEvent(),c.selectText(0,0),(c.preventKeyUpEvent===!0||a.getKey()===c.preventKeyUpEvent)&&delete c.preventKeyUpEvent;return}if(c.multiSelect&&c.delimiterEndingRegexp&&c.delimiterEndingRegexp.test(d)||c.createNewOnEnter===!0&&a.getKey()==a.ENTER)d=d.replace(c.delimiterEndingRegexp,""),Ext.isEmpty(d)||(e=c.valueStore.findExact(c.valueField,d),e>=0?e=c.valueStore.getAt(e):(e=c.store.findExact(c.valueField,d),e>=0?e=c.store.getAt(e):e=!1),!e&&!c.forceSelection&&(e={},e[c.valueField]=d,e[c.displayField]=d,e=new c.valueStore.model(e)),e&&(c.setValue(c.valueStore.getRange().concat(e)),c.inputEl.dom.value="",c.inputEl.focus()));c.callParent([a,b]),Ext.Function.defer(c.alignPicker,10,c)},onTypeAhead:function(){var a=this,b=a.displayField,c=a.inputEl.dom,d=a.store.findRecord(b,c.value),e=a.getPicker(),f,g,h;d&&(f=d.get(b),g=f.length,h=c.value.length,e.highlightItem(e.getNode(d)),h!==0&&h!==g&&(c.value=f,a.selectText(h,f.length)))},onItemListClick:function(a,b,c){var d=this,e=a.getTarget(".x-boxselect-item"),f=e?a.getTarget(".x-boxselect-item-close"):!1;e?(f?d.removeByListItemNode(e):d.toggleSelectionByListItemNode(e,a.shiftKey),d.inputEl.focus()):d.onTriggerClick()},getMultiSelectItemMarkup:function(){var a=this;return a.multiSelectItemTpl||(a.multiSelectItemTpl=['<tpl for=".">','<li class="x-boxselect-item ','<tpl if="this.isSelected(values.'+a.valueField+')">'," selected","</tpl>",'" qtip="{[typeof values === "string" ? values : values.'+a.displayField+']}">','<div class="x-boxselect-item-text">{[typeof values === "string" ? values : values.'+a.displayField+"]}</div>",'<div class="x-tab-close-btn x-boxselect-item-close"></div>',"</li>","</tpl>",{compile:!0,disableFormats:!0,isSelected:function(b){var c=a.valueStore.findExact(a.valueField,b);if(c>=0)return a.selectionModel.isSelected(a.valueStore.getAt(c))}}]),this.getTpl("multiSelectItemTpl").apply(Ext.Array.pluck(this.valueStore.getRange(),"data"))},applyMultiselectItemMarkup:function(){var a=this;a.itemList&&(a.el.appendChild(a.inputElCt),a.itemList.update(a.getMultiSelectItemMarkup()),a.itemList.appendChild(a.inputElCt),a.autoSize(),a.alignPicker())},getRecordByListItemNode:function(a){var b=this,c=0,d=b.itemList.dom.firstChild;while(d&&d.nextSibling){if(d==a)break;c++,d=d.nextSibling}return c=d==a?c:!1,c===!1?!1:b.valueStore.getAt(c)},toggleSelectionByListItemNode:function(a,b){var c=this,d=c.getRecordByListItemNode(a);d&&(c.selectionModel.isSelected(d)?c.selectionModel.deselect(d):c.selectionModel.select(d,b))},removeByListItemNode:function(a){var b=this,c=b.getRecordByListItemNode(a);c&&(b.valueStore.remove(c),b.setValue(b.valueStore.getRange()))},getRawValue:function(){var a=this,b=a.inputEl,c;return a.inputEl=!1,c=a.callParent(arguments),a.inputEl=b,c},setRawValue:function(a){var b=this,c=b.inputEl,d;return b.inputEl=!1,d=b.callParent([a]),b.inputEl=c,d},setValue:function(a,b,c){var d=this,e=d.valueStore,f=d.valueField,g,h,i,j,k,l=[];Ext.isString(a)&&d.multiSelect&&(a=a.split(d.delimiter)),a=Ext.Array.from(a);for(i=0,h=a.length;i<h;i++){g=a[i];if(!g||!g.isModel)j=e.findExact(f,g),j>=0?a[i]=e.getAt(j):(j=d.findRecord(f,g),j?a[i]=j:d.forceSelection&&l.push(g))}if(c!==!0&&l.length>0&&d.queryMode==="remote"){var m={};return m[d.valueField]=l.join(d.delimiter),d.store.load({params:m,callback:function(){d.itemList.unmask(),d.setValue(a,b,!0)}}),!1}!d.multiSelect&&a.length>0&&(a=a[a.length-1]),d.callParent([a,b]),d.updateValueStore()},getValueRecords:function(){return this.valueStore.getRange()},assertValue:function(){var a=this,b=a.inputEl.dom.value,c=b?a.findRecordByDisplay(b):!1;c&&!Ext.Array.contains(a.value,c.get(a.valueField))&&a.setValue(a.value.concat(c.get(a.valueField))),a.inputEl.dom.value="",a.collapse()},updateValueStore:function(){var a=this,b=a.valueStore;b.suspendEvents(),b.removeAll(),Ext.isArray(a.valueModels)&&b.add(a.valueModels),b.resumeEvents(),b.fireEvent("datachanged",b)},applyEmptyText:function(){var a=this,b=a.emptyText,c;a.rendered&&b&&(c=a.value.length<1&&!a.hasFocus,c&&(a.setRawValue(b),a.inputEl.addCls(a.emptyCls)),a.autoSize())},onFocus:function(){var a=this,b=a.focusCls,c=a.itemList;b&&c&&c.addCls(b),a.callParent(arguments)},onBlur:function(){var a=this,b=a.focusCls,c=a.itemList;b&&c&&c.removeCls(b),a.callParent(arguments)},renderActiveError:function(){var a=this,b=a.invalidCls,c=a.itemList,d=a.hasActiveError();b&&c&&c[d?"addCls":"removeCls"](a.invalidCls+"-field"),a.callParent(arguments)},autoSize:function(){if(!this.rendered)return this;var a=this,b=a.inputElCt,c=b.dom.previousSibling,d=a.itemList,e=d.getBox(!0,!0),f=e.width,g=f-10,h;c&&(g-=c.offsetLeft+Ext.fly(c).getWidth()),g<35&&(g=f-10),b.setWidth(g+"px"),a.callParent(arguments),h=d.getHeight(),a.lastHeight?a.lastHeight!=h&&(a.fireEvent("autosize",h),a.lastHeight=h,a.alignPicker()):a.lastHeight=h}}),Ext.define("Ext.ux.layout.component.field.BoxSelectField",{alias:["layout.boxselectfield"],extend:"Ext.layout.component.field.Field",type:"boxselectfield",sizeBodyContents:function(a,b){var c=this,d=c.owner,e=d.itemList,f=d.triggerWrap,g=d.getTriggerWidth();if(d.hideTrigger||d.readOnly||g>0)c.setElementSize(e,Ext.isNumber(a)?a-g:a),f.setWidth(g),d.autoSize()}});
Ext.define("Components.ObjectBrowser",{extend:"Ext.tree.Panel",alias:"widget.objectbrowser",objId:1,getNewId:function(){return this.objId++,this.objId},initComponent:function(){return Ext.apply(this,{forceFit:!0,useArrows:!0,rootVisible:!1,multiSelect:!0,columns:[{xtype:"treecolumn",text:this.keyTitle||"Key",sortable:!0,dataIndex:"key",flex:2},{text:this.valueTitle||"Value",sortable:!0,dataIndex:"value"}]}),typeof this.nullValue=="undefined"&&(this.nullValue="null"),this.store=this.createStore(this.data),this.callParent(arguments)},createStore:function(a){var b=this.id+"-Objects";return Ext.define(b,{extend:"Ext.data.Model",fields:[{name:"key",type:"string"},{name:"value",type:"string"},{name:"id",type:"string"}],idProperty:"id"}),Ext.create("Ext.data.TreeStore",{folderSort:!0,model:b,proxy:{type:"memory",data:{text:"root",children:this.parseObject(a)}}})},getNodeId:function(a){return this.getId()+"-node-"+a},parseObject:function(a){function d(a,b){if(typeof b=="object"&&b!==null)return{key:a,value:'<a href="'+c.getNodeId(b)+'">'+c.getTypeName(b)+"</a>",iconCls:"tree-node-"+c.findType(b),children:c.parseObject(b)};var d=b===null?c.nullValue:b;return{key:a,value:d,leaf:!0,iconCls:"tree-node-"+c.findType(d)}}var b=[],c=this;if(!a._objTreeId){a._objTreeId=this.getNewId();if(a.hasOwnProperty("length")&&typeof a=="object"){var e=a.length;while(e--)b.push(d("["+e+"]",a[e]))}else if(!a.hasOwnProperty("length")&&typeof a=="object")for(var f in a)a.hasOwnProperty(f)&&f!="_objTreeId"&&b.push(d(f,a[f]))}return b},getTypeName:function(a){return typeof a!="undefined"?a.constructor.name:"undefined"},findType:function(a){return typeof a=="object"?a.hasOwnProperty("length")?"array":"object":typeof a}});
function naturalSort(a,b){var c=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,d=/(^[ ]*|[ ]*$)/g,e=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,f=/^0x[0-9a-f]+$/i,g=/^0/,h=function(a){return naturalSort.insensitive&&(""+a).toLowerCase()||""+a},i=h(a).replace(d,"")||"",j=h(b).replace(d,"")||"",k=i.replace(c,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),l=j.replace(c,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(i.match(f))||k.length!=1&&i.match(e)&&Date.parse(i),n=parseInt(j.match(f))||m&&j.match(e)&&Date.parse(j)||null,o,p;if(n){if(m<n)return-1;if(m>n)return 1}for(var q=0,r=Math.max(k.length,l.length);q<r;q++){o=!(k[q]||"").match(g)&&parseFloat(k[q])||k[q]||0,p=!(l[q]||"").match(g)&&parseFloat(l[q])||l[q]||0;if(isNaN(o)!==isNaN(p))return isNaN(o)?1:-1;typeof o!=typeof p&&(o+="",p+="");if(o<p)return-1;if(o>p)return 1}return 0};
Ext.define("Ext.ux.RowExpander",{extend:"Ext.AbstractPlugin",alias:"plugin.rowexpander",rowBodyTpl:null,expandOnEnter:!0,expandOnDblClick:!0,selectRowOnExpand:!1,rowBodyTrSelector:".x-grid-rowbody-tr",rowBodyHiddenCls:"x-grid-row-body-hidden",rowCollapsedCls:"x-grid-row-collapsed",renderer:function(a,b,c,d,e){return e===0&&(b.tdCls="x-grid-td-expander"),'<div class="x-grid-row-expander">&#160;</div>'},constructor:function(){this.callParent(arguments);var a=this.getCmp();this.recordsExpanded={},this.rowBodyTpl||Ext.Error.raise("The 'rowBodyTpl' config is required and is not defined.");var b=Ext.create("Ext.XTemplate",this.rowBodyTpl),c=[{ftype:"rowbody",columnId:this.getHeaderId(),recordsExpanded:this.recordsExpanded,rowBodyHiddenCls:this.rowBodyHiddenCls,rowCollapsedCls:this.rowCollapsedCls,getAdditionalData:this.getRowBodyFeatureData,getRowBodyContents:function(a){return b.applyTemplate(a)}},{ftype:"rowwrap"}];a.features?a.features=c.concat(a.features):a.features=c,a.columns.unshift(this.getHeaderConfig()),a.on("afterlayout",this.onGridAfterLayout,this,{single:!0})},getHeaderId:function(){return this.headerId||(this.headerId=Ext.id()),this.headerId},getRowBodyFeatureData:function(a,b,c,d){var e=Ext.grid.feature.RowBody.prototype.getAdditionalData.apply(this,arguments),f=this.columnId;return e.rowBodyColspan=e.rowBodyColspan-1,e.rowBody=this.getRowBodyContents(a),e.rowCls=this.recordsExpanded[c.internalId]?"":this.rowCollapsedCls,e.rowBodyCls=this.recordsExpanded[c.internalId]?"":this.rowBodyHiddenCls,e[f+"-tdAttr"]=' valign="top" rowspan="2" ',d[f+"-tdAttr"]&&(e[f+"-tdAttr"]+=d[f+"-tdAttr"]),e},onGridAfterLayout:function(){var a=this.getCmp(),b,c;a.hasView?(b=a.down("gridview"),c=b.getEl(),this.expandOnEnter&&(this.keyNav=Ext.create("Ext.KeyNav",c,{enter:this.onEnter,scope:this})),this.expandOnDblClick&&b.on("itemdblclick",this.onDblClick,this),this.view=b):this.getCmp().on("afterlayout",this.onGridAfterLayout,this,{single:!0})},onEnter:function(a){var b=this.view,c=b.store,d=b.getSelectionModel(),e=d.getSelection(),f=e.length,g=0,h;for(;g<f;g++)h=c.indexOf(e[g]),this.toggleRow(h)},toggleRow:function(a){var b=this.view.getNode(a),c=Ext.get(b),d=Ext.get(c).down(this.rowBodyTrSelector),e=this.view.getRecord(b);c.hasCls(this.rowCollapsedCls)?(c.removeCls(this.rowCollapsedCls),d.removeCls(this.rowBodyHiddenCls),this.recordsExpanded[e.internalId]=!0,this.view.fireEvent("expandbody",b,e,d.dom)):(c.addCls(this.rowCollapsedCls),d.addCls(this.rowBodyHiddenCls),this.recordsExpanded[e.internalId]=!1,this.view.fireEvent("collapsebody",b,e,d.dom)),this.view.up("gridpanel").invalidateScroller()},onDblClick:function(a,b,c,d,e){this.toggleRow(c)},getHeaderConfig:function(){var a=this,b=Ext.Function.bind(a.toggleRow,a),c=a.selectRowOnExpand;return{id:this.getHeaderId(),width:24,sortable:!1,fixed:!0,draggable:!1,hideable:!1,menuDisabled:!0,cls:Ext.baseCSSPrefix+"grid-header-special",renderer:function(a,b){return b.tdCls=Ext.baseCSSPrefix+"grid-cell-special",'<div class="'+Ext.baseCSSPrefix+'grid-row-expander">&#160;</div>'},processEvent:function(a,d,e,f,g,h){if(a=="mousedown"&&h.getTarget(".x-grid-row-expander")){var i=h.getTarget(".x-grid-row");return b(i),c}}}}});
Ext.define("Ext.ux.CheckColumn",{extend:"Ext.grid.column.Column",alias:"widget.checkcolumn",constructor:function(){this.addEvents("checkchange"),this.callParent(arguments)},processEvent:function(a,b,c,d,e,f){if(a=="mousedown"||a=="keydown"&&(f.getKey()==f.ENTER||f.getKey()==f.SPACE)){var g=b.panel.store.getAt(d),h=this.dataIndex,i=!g.get(h);return g.set(h,i),this.fireEvent("checkchange",this,d,i),!1}return this.callParent(arguments)},renderer:function(a){var b=Ext.baseCSSPrefix,c=[b+"grid-checkheader"];return a&&c.push(b+"grid-checkheader-checked"),'<div class="'+c.join(" ")+'">&#160;</div>'}});
CodeMirror.defineMode("javascript",function(a,b){function g(a,b,c){return b.tokenize=c,c(a,b)}function h(a,b){var c=!1,d;while((d=a.next())!=null){if(d==b&&!c)return!1;c=!c&&d=="\\"}return c}function k(a,b,c){return i=a,j=c,b}function l(a,b){var c=a.next();if(c=='"'||c=="'")return g(a,b,m(c));if(/[\[\]{}\(\),;\:\.]/.test(c))return k(c);if(c=="0"&&a.eat(/x/i))return a.eatWhile(/[\da-f]/i),k("number","number");if(/\d/.test(c))return a.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),k("number","number");if(c=="/")return a.eat("*")?g(a,b,n):a.eat("/")?(a.skipToEnd(),k("comment","comment")):b.reAllowed?(h(a,"/"),a.eatWhile(/[gimy]/),k("regexp","string-2")):(a.eatWhile(f),k("operator",null,a.current()));if(c=="#")return a.skipToEnd(),k("error","error");if(f.test(c))return a.eatWhile(f),k("operator",null,a.current());a.eatWhile(/[\w\$_]/);var d=a.current(),i=e.propertyIsEnumerable(d)&&e[d];return i&&b.kwAllowed?k(i.type,i.style,d):k("variable","variable",d)}function m(a){return function(b,c){return h(b,a)||(c.tokenize=l),k("string","string")}}function n(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=l;break}c=d=="*"}return k("comment","comment")}function p(a,b,c,d,e,f){this.indented=a,this.column=b,this.type=c,this.prev=e,this.info=f,d!=null&&(this.align=d)}function q(a,b){for(var c=a.localVars;c;c=c.next)if(c.name==b)return!0}function r(a,b,c,e,f){var g=a.cc;s.state=a,s.stream=f,s.marked=null,s.cc=g,a.lexical.hasOwnProperty("align")||(a.lexical.align=!0);for(;;){var h=g.length?g.pop():d?D:C;if(h(c,e)){while(g.length&&g[g.length-1].lex)g.pop()();return s.marked?s.marked:c=="variable"&&q(a,e)?"variable-2":b}}}function t(){for(var a=arguments.length-1;a>=0;a--)s.cc.push(arguments[a])}function u(){return t.apply(null,arguments),!0}function v(a){var b=s.state;if(b.context){s.marked="def";for(var c=b.localVars;c;c=c.next)if(c.name==a)return;b.localVars={name:a,next:b.localVars}}}function x(){s.state.context||(s.state.localVars=w),s.state.context={prev:s.state.context,vars:s.state.localVars}}function y(){s.state.localVars=s.state.context.vars,s.state.context=s.state.context.prev}function z(a,b){var c=function(){var c=s.state;c.lexical=new p(c.indented,s.stream.column(),a,null,c.lexical,b)};return c.lex=!0,c}function A(){var a=s.state;a.lexical.prev&&(a.lexical.type==")"&&(a.indented=a.lexical.indented),a.lexical=a.lexical.prev)}function B(a){return function(c){return c==a?u():a==";"?t():u(arguments.callee)}}function C(a){return a=="var"?u(z("vardef"),L,B(";"),A):a=="keyword a"?u(z("form"),D,C,A):a=="keyword b"?u(z("form"),C,A):a=="{"?u(z("}"),K,A):a==";"?u():a=="function"?u(R):a=="for"?u(z("form"),B("("),z(")"),N,B(")"),A,C,A):a=="variable"?u(z("stat"),G):a=="switch"?u(z("form"),D,z("}","switch"),B("{"),K,A,A):a=="case"?u(D,B(":")):a=="default"?u(B(":")):a=="catch"?u(z("form"),x,B("("),S,B(")"),C,A,y):t(z("stat"),D,B(";"),A)}function D(a){return o.hasOwnProperty(a)?u(F):a=="function"?u(R):a=="keyword c"?u(E):a=="("?u(z(")"),E,B(")"),A,F):a=="operator"?u(D):a=="["?u(z("]"),J(D,"]"),A,F):a=="{"?u(z("}"),J(I,"}"),A,F):u()}function E(a){return a.match(/[;\}\)\],]/)?t():t(D)}function F(a,b){if(a=="operator"&&/\+\+|--/.test(b))return u(F);if(a=="operator"||a==":")return u(D);if(a==";")return;if(a=="(")return u(z(")"),J(D,")"),A,F);if(a==".")return u(H,F);if(a=="[")return u(z("]"),D,B("]"),A,F)}function G(a){return a==":"?u(A,C):t(F,B(";"),A)}function H(a){if(a=="variable")return s.marked="property",u()}function I(a){a=="variable"&&(s.marked="property");if(o.hasOwnProperty(a))return u(B(":"),D)}function J(a,b){function c(d){return d==","?u(a,c):d==b?u():u(B(b))}return function(e){return e==b?u():t(a,c)}}function K(a){return a=="}"?u():t(C,K)}function L(a,b){return a=="variable"?(v(b),u(M)):u()}function M(a,b){if(b=="=")return u(D,M);if(a==",")return u(L)}function N(a){return a=="var"?u(L,P):a==";"?t(P):a=="variable"?u(O):t(P)}function O(a,b){return b=="in"?u(D):u(F,P)}function P(a,b){return a==";"?u(Q):b=="in"?u(D):u(D,B(";"),Q)}function Q(a){a!=")"&&u(D)}function R(a,b){if(a=="variable")return v(b),u(R);if(a=="(")return u(z(")"),x,J(S,")"),A,C,y)}function S(a,b){if(a=="variable")return v(b),u()}var c=a.indentUnit,d=b.json,e=function(){function a(a){return{type:a,style:"keyword"}}var b=a("keyword a"),c=a("keyword b"),d=a("keyword c"),e=a("operator"),f={type:"atom",style:"atom"};return{"if":b,"while":b,"with":b,"else":c,"do":c,"try":c,"finally":c,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"var":a("var"),"const":a("var"),let:a("var"),"function":a("function"),"catch":a("catch"),"for":a("for"),"switch":a("switch"),"case":a("case"),"default":a("default"),"in":e,"typeof":e,"instanceof":e,"true":f,"false":f,"null":f,"undefined":f,NaN:f,Infinity:f}}(),f=/[+\-*&%=<>!?|]/,i,j,o={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},s={state:null,column:null,marked:null,cc:null},w={name:"this",next:{name:"arguments"}};return A.lex=!0,{startState:function(a){return{tokenize:l,reAllowed:!0,kwAllowed:!0,cc:[],lexical:new p((a||0)-c,0,"block",!1),localVars:b.localVars,context:b.localVars&&{vars:b.localVars},indented:0}},token:function(a,b){a.sol()&&(b.lexical.hasOwnProperty("align")||(b.lexical.align=!1),b.indented=a.indentation());if(a.eatSpace())return null;var c=b.tokenize(a,b);return i=="comment"?c:(b.reAllowed=i=="operator"||i=="keyword c"||!!i.match(/^[\[{}\(,;:]$/),b.kwAllowed=i!=".",r(b,c,i,j,a))},indent:function(a,b){if(a.tokenize!=l)return 0;var d=b&&b.charAt(0),e=a.lexical;e.type=="stat"&&d=="}"&&(e=e.prev);var f=e.type,g=d==f;return f=="vardef"?e.indented+4:f=="form"&&d=="{"?e.indented:f=="stat"||f=="form"?e.indented+c:e.info=="switch"&&!g?e.indented+(/^(?:case|default)\b/.test(b)?c:2*c):e.align?e.column+(g?0:1):e.indented+(g?0:c)},electricChars:":{}"}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0});
CodeMirror.defineMode("stex",function(a,b){function c(a,b){a.cmdState.push(b)}function d(a){return a.cmdState.length>0?a.cmdState[a.cmdState.length-1]:null}function e(a){if(a.cmdState.length>0){var b=a.cmdState.pop();b.closeBracket()}}function f(a){var b=a.cmdState;for(var c=b.length-1;c>=0;c--){var d=b[c];if(d.name=="DEFAULT")continue;return d.styleIdentifier()}return null}function g(a,b,c,d){return function(){this.name=a,this.bracketNo=0,this.style=b,this.styles=d,this.brackets=c,this.styleIdentifier=function(a){return this.bracketNo<=this.styles.length?this.styles[this.bracketNo-1]:null},this.openBracket=function(a){return this.bracketNo++,"bracket"},this.closeBracket=function(a){}}}function i(a,b){a.f=b}function j(a,b){if(a.match(/^\\[a-zA-Z@]+/)){var e=a.current();e=e.substr(1,e.length-1);var g=h[e];return typeof g=="undefined"&&(g=h.DEFAULT),g=new g,c(b,g),i(b,l),g.style}if(a.match(/^\\[$&%#{}_]/))return"tag";if(a.match(/^\\[,;!\/]/))return"tag";var j=a.next();if(j=="%")return a.eol()||i(b,k),"comment";if(j=="}"||j=="]")return g=d(b),g?(g.closeBracket(j),i(b,l),"bracket"):"error";return j=="{"||j=="["?(g=h.DEFAULT,g=new g,c(b,g),"bracket"):/\d/.test(j)?(a.eatWhile(/[\w.%]/),"atom"):(a.eatWhile(/[\w-_]/),f(b))}function k(a,b){return a.skipToEnd(),i(b,j),"comment"}function l(a,b){var c=a.peek();if(c=="{"||c=="["){var f=d(b),g=f.openBracket(c);return a.eat(c),i(b,j),"bracket"}return/[ \t\r]/.test(c)?(a.eat(c),null):(i(b,j),f=d(b),f&&e(b),j(a,b))}var h=new Array;return h.importmodule=g("importmodule","tag","{[",["string","builtin"]),h.documentclass=g("documentclass","tag","{[",["","atom"]),h.usepackage=g("documentclass","tag","[",["atom"]),h.begin=g("documentclass","tag","[",["atom"]),h.end=g("documentclass","tag","[",["atom"]),h.DEFAULT=function(){this.name="DEFAULT",this.style="tag",this.styleIdentifier=function(a){},this.openBracket=function(a){},this.closeBracket=function(a){}},{startState:function(){return{f:j,cmdState:[]}},copyState:function(a){return{f:a.f,cmdState:a.cmdState.slice(0,a.cmdState.length)}},token:function(a,b){var c=b.f(a,b),d=a.current();return c}}}),CodeMirror.defineMIME("text/x-stex","stex");
CodeMirror.defineMode("gfm",function(a,b){function f(a,b){return a.sol()&&a.match(/^```([\w+#]*)/)?(b.localMode=e(RegExp.$1),b.localMode&&(b.localState=b.localMode.startState()),b.token=g,"code"):c.token(a,b.mdState)}function g(a,b){return a.sol()&&a.match(/^```/)?(b.localMode=b.localState=null,b.token=f,"code"):b.localMode?b.localMode.token(a,b.localState):(a.skipToEnd(),"code")}function h(a,b){var d;if(a.match(/^\w+:\/\/\S+/))return"linkhref";if(a.match(/^[^\[*\\<>` _][^\[*\\<>` ]*[^\[*\\<>` _]/))return c.getType(b);if(d=a.match(/^[^\[*\\<>` ]+/)){var e=d[0];return e[0]==="_"&&e[e.length-1]==="_"?(a.backUp(e.length),undefined):c.getType(b)}if(a.eatSpace())return null}var c=CodeMirror.getMode(a,"markdown"),d={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp"},e=function(){var b,c={},e={},f,g=CodeMirror.listModes();for(b=0;b<g.length;b++)c[g[b]]=g[b];var h=CodeMirror.listMIMEs();for(b=0;b<h.length;b++)f=h[b].mime,e[f]=h[b].mime;for(var i in d)if(d[i]in c||d[i]in e)c[i]=d[i];return function(b){return c[b]?CodeMirror.getMode(a,c[b]):null}}();return{startState:function(){var a=c.startState();return a.text=h,{token:f,mode:"markdown",mdState:a,localMode:null,localState:null}},copyState:function(a){return{token:a.token,mode:a.mode,mdState:CodeMirror.copyState(c,a.mdState),localMode:a.localMode,localState:a.localMode?CodeMirror.copyState(a.localMode,a.localState):null}},token:function(a,b){return b.token(a,b)}}},"markdown");
CodeMirror.defineMode("rst",function(a,b){function c(a,b,c){a.fn=b,d(a,c)}function d(a,b){a.ctx=b||{}}function e(a,b){if(b&&typeof b!="string"){var d=b.current();b=d[d.length-1]}c(a,x,{back:b})}function f(a){if(a){var b=CodeMirror.listModes();for(var c in b)if(b[c]==a)return!0}return!1}function g(b){return f(b)?CodeMirror.getMode(a,b):null}function x(a,b){function l(a){return f||!b.ctx.back||a.test(b.ctx.back)}function m(b){return a.eol()||a.match(b,!1)}function n(b){return a.match(b)&&l(/\W/)&&m(/\W/)}var d,f,g;if(a.eat(/\\/))return d=a.next(),e(b,d),null;f=a.sol();if(f&&(d=a.eat(j))){for(g=0;a.eat(d);g++);if(g>=3&&a.match(/^\s*$/))return e(b,null),"header";a.backUp(g+1)}if(f&&a.match(q))return a.eol()||c(b,z),"meta";if(a.match(r)){if(!h)c(b,C);else{var k=h;c(b,C,{mode:k,local:k.startState()})}return"meta"}if(f&&a.match(w,!1)){if(!i)return c(b,C),"meta";var k=i;return c(b,C,{mode:k,local:k.startState()}),null}if(n(o))return e(b,a),"footnote";if(n(p))return e(b,a),"citation";d=a.next();if(l(s)){if(!(d!==":"&&d!=="|"||!a.eat(/\S/))){var t;return d===":"?t="builtin":t="atom",c(b,y,{ch:d,wide:!1,prev:null,token:t}),t}if(d==="*"||d==="`"){var u=d,v=!1;d=a.next(),d==u&&(v=!0,d=a.next());if(d&&!/\s/.test(d)){var t;return u==="*"?t=v?"strong":"em":t=v?"string":"string-2",c(b,y,{ch:u,wide:v,prev:null,token:t}),t}}}return e(b,d),null}function y(a,b){function g(a){return b.ctx.prev=a,f}var d=a.next(),f=b.ctx.token;if(d!=b.ctx.ch)return g(d);if(/\s/.test(b.ctx.prev))return g(d);if(b.ctx.wide){d=a.next();if(d!=b.ctx.ch)return g(d)}return!a.eol()&&!t.test(a.peek())?(b.ctx.wide&&a.backUp(1),g(d)):(c(b,x),e(b,d),f)}function z(a,b){var d=null;if(a.match(k))d="attribute";else if(a.match(l))d="link";else if(a.match(m))d="quote";else{if(!a.match(n))return a.eatSpace(),a.eol()?(e(b,a),null):(a.skipToEnd(),c(b,B),"comment");d="quote"}return c(b,A,{start:!0}),d}function A(a,b){var c="body";return!b.ctx.start||a.sol()?D(a,b,c):(a.skipToEnd(),d(b),c)}function B(a,b){return D(a,b,"comment")}function C(a,b){return h?a.sol()?(a.eatSpace()||e(b,a),null):h.token(a,b.ctx.local):D(a,b,"meta")}function D(a,b,c){return a.eol()||a.eatSpace()?(a.skipToEnd(),c):(e(b,a),null)}var h=g(b.verbatim),i=g("python"),j=/^[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/,k=/^\s*\w([-:.\w]*\w)?::(\s|$)/,l=/^\s*_[\w-]+:(\s|$)/,m=/^\s*\[(\d+|#)\](\s|$)/,n=/^\s*\[[A-Za-z][\w-]*\](\s|$)/,o=/^\[(\d+|#)\]_/,p=/^\[[A-Za-z][\w-]*\]_/,q=/^\.\.(\s|$)/,r=/^::\s*$/,s=/^[-\s"([{</:]/,t=/^[-\s`'")\]}>/:.,;!?\\_]/,u=/^\s*((\d+|[A-Za-z#])[.)]|\((\d+|[A-Z-a-z#])\))\s/,v=/^\s*[-\+\*]\s/,w=/^\s+(>>>|In \[\d+\]:)\s/;return{startState:function(){return{fn:x,ctx:{}}},copyState:function(a){return{fn:a.fn,ctx:a.ctx}},token:function(a,b){var c=b.fn(a,b);return c}}},"python"),CodeMirror.defineMIME("text/x-rst","rst");
CodeMirror.defineMode("xml",function(a,b){function h(a,b){function c(c){return b.tokenize=c,c(a,b)}var d=a.next();if(d=="<"){if(a.eat("!"))return a.eat("[")?a.match("CDATA[")?c(k("atom","]]>")):null:a.match("--")?c(k("comment","-->")):a.match("DOCTYPE",!0,!0)?(a.eatWhile(/[\w\._\-]/),c(l(1))):null;if(a.eat("?"))return a.eatWhile(/[\w\._\-]/),b.tokenize=k("meta","?>"),"meta";g=a.eat("/")?"closeTag":"openTag",a.eatSpace(),f="";var e;while(e=a.eat(/[^\s\u00a0=<>\"\'\/?]/))f+=e;return b.tokenize=i,"tag"}if(d=="&"){var h;return a.eat("#")?a.eat("x")?h=a.eatWhile(/[a-fA-F\d]/)&&a.eat(";"):h=a.eatWhile(/[\d]/)&&a.eat(";"):h=a.eatWhile(/[\w\.\-:]/)&&a.eat(";"),h?"atom":"error"}return a.eatWhile(/[^&<]/),null}function i(a,b){var c=a.next();return c==">"||c=="/"&&a.eat(">")?(b.tokenize=h,g=c==">"?"endTag":"selfcloseTag","tag"):c=="="?(g="equals",null):/[\'\"]/.test(c)?(b.tokenize=j(c),b.tokenize(a,b)):(a.eatWhile(/[^\s\u00a0=<>\"\'\/?]/),"word")}function j(a){return function(b,c){while(!b.eol())if(b.next()==a){c.tokenize=i;break}return"string"}}function k(a,b){return function(c,d){while(!c.eol()){if(c.match(b)){d.tokenize=h;break}c.next()}return a}}function l(a){return function(b,c){var d;while((d=b.next())!=null){if(d=="<")return c.tokenize=l(a+1),c.tokenize(b,c);if(d==">"){if(a==1){c.tokenize=h;break}return c.tokenize=l(a-1),c.tokenize(b,c)}}return"meta"}}function o(){for(var a=arguments.length-1;a>=0;a--)m.cc.push(arguments[a])}function p(){return o.apply(null,arguments),!0}function q(a,b){var c=d.doNotIndent.hasOwnProperty(a)||m.context&&m.context.noIndent;m.context={prev:m.context,tagName:a,indent:m.indented,startOfLine:b,noIndent:c}}function r(){m.context&&(m.context=m.context.prev)}function s(a){if(a=="openTag")return m.tagName=f,p(w,t(m.startOfLine));if(a=="closeTag"){var b=!1;return m.context?m.context.tagName!=f&&(d.implicitlyClosed.hasOwnProperty(m.context.tagName.toLowerCase())&&r(),b=!m.context||m.context.tagName!=f):b=!0,b&&(n="error"),p(u(b))}return p()}function t(a){return function(b){return b=="selfcloseTag"||b=="endTag"&&d.autoSelfClosers.hasOwnProperty(m.tagName.toLowerCase())?(v(m.tagName.toLowerCase()),p()):b=="endTag"?(v(m.tagName.toLowerCase()),q(m.tagName,a),p()):p()}}function u(a){return function(b){return a&&(n="error"),b=="endTag"?(r(),p()):(n="error",p(arguments.callee))}}function v(a){var b;for(;;){if(!m.context)return;b=m.context.tagName.toLowerCase();if(!d.contextGrabbers.hasOwnProperty(b)||!d.contextGrabbers[b].hasOwnProperty(a))return;r()}}function w(a){return a=="word"?(n="attribute",p(x,w)):a=="endTag"||a=="selfcloseTag"?o():(n="error",p(w))}function x(a){return a=="equals"?p(y,w):(d.allowMissing||(n="error"),a=="endTag"||a=="selfcloseTag"?o():p())}function y(a){return a=="string"?p(z):a=="word"&&d.allowUnquoted?(n="string",p()):(n="error",a=="endTag"||a=="selfCloseTag"?o():p())}function z(a){return a=="string"?p(z):o()}var c=a.indentUnit,d=b.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!1}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1},e=b.alignCDATA,f,g,m,n;return{startState:function(){return{tokenize:h,cc:[],indented:0,startOfLine:!0,tagName:null,context:null}},token:function(a,b){a.sol()&&(b.startOfLine=!0,b.indented=a.indentation());if(a.eatSpace())return null;n=g=f=null;var c=b.tokenize(a,b);b.type=g;if((c||g)&&c!="comment"){m=b;for(;;){var d=b.cc.pop()||s;if(d(g||c))break}}return b.startOfLine=!1,n||c},indent:function(a,b,d){var f=a.context;if(a.tokenize!=i&&a.tokenize!=h||f&&f.noIndent)return d?d.match(/^(\s*)/)[0].length:0;if(e&&/<!\[CDATA\[/.test(b))return 0;f&&/^<\//.test(b)&&(f=f.prev);while(f&&!f.startOfLine)f=f.prev;return f?f.indent+c:0},compareStates:function(a,b){if(a.indented!=b.indented||a.tokenize!=b.tokenize)return!1;for(var c=a.context,d=b.context;;c=c.prev,d=d.prev){if(!c||!d)return c==d;if(c.tagName!=d.tagName)return!1}},electricChars:"/"}}),CodeMirror.defineMIME("application/xml","xml"),CodeMirror.mimeModes.hasOwnProperty("text/html")||CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0});
CodeMirror.defineMode("diff",function(){return{token:function(a){var b=a.next();a.skipToEnd();if(b=="+")return"plus";if(b=="-")return"minus";if(b=="@")return"rangeinfo"}}}),CodeMirror.defineMIME("text/x-diff","diff");
CodeMirror.defineMode("htmlmixed",function(a,b){function f(a,b){var f=c.token(a,b.htmlState);return f=="tag"&&a.current()==">"&&b.htmlState.context&&(/^script$/i.test(b.htmlState.context.tagName)?(b.token=h,b.localState=d.startState(c.indent(b.htmlState,"")),b.mode="javascript"):/^style$/i.test(b.htmlState.context.tagName)&&(b.token=i,b.localState=e.startState(c.indent(b.htmlState,"")),b.mode="css")),f}function g(a,b,c){var d=a.current(),e=d.search(b);return e>-1&&a.backUp(d.length-e),c}function h(a,b){return a.match(/^<\/\s*script\s*>/i,!1)?(b.token=f,b.localState=null,b.mode="html",f(a,b)):g(a,/<\/\s*script\s*>/,d.token(a,b.localState))}function i(a,b){return a.match(/^<\/\s*style\s*>/i,!1)?(b.token=f,b.localState=null,b.mode="html",f(a,b)):g(a,/<\/\s*style\s*>/,e.token(a,b.localState))}var c=CodeMirror.getMode(a,{name:"xml",htmlMode:!0}),d=CodeMirror.getMode(a,"javascript"),e=CodeMirror.getMode(a,"css");return{startState:function(){var a=c.startState();return{token:f,localState:null,mode:"html",htmlState:a}},copyState:function(a){if(a.localState)var b=CodeMirror.copyState(a.token==i?e:d,a.localState);return{token:a.token,localState:b,mode:a.mode,htmlState:CodeMirror.copyState(c,a.htmlState)}},token:function(a,b){return b.token(a,b)},indent:function(a,b){return a.token==f||/^\s*<\//.test(b)?c.indent(a.htmlState,b):a.token==h?d.indent(a.localState,b):e.indent(a.localState,b)},compareStates:function(a,b){return a.mode!=b.mode?!1:a.localState?CodeMirror.Pass:c.compareStates(a.htmlState,b.htmlState)},electricChars:"/{}:"}},"xml","javascript","css"),CodeMirror.defineMIME("text/html","htmlmixed");
CodeMirror.defineMode("css",function(a){function d(a,b){return c=b,a}function e(a,b){var c=a.next();if(c=="@")return a.eatWhile(/[\w\\\-]/),d("meta",a.current());if(c=="/"&&a.eat("*"))return b.tokenize=f,f(a,b);if(c=="<"&&a.eat("!"))return b.tokenize=g,g(a,b);if(c!="=")return c!="~"&&c!="|"||!a.eat("=")?c=='"'||c=="'"?(b.tokenize=h(c),b.tokenize(a,b)):c=="#"?(a.eatWhile(/[\w\\\-]/),d("atom","hash")):c=="!"?(a.match(/^\s*\w*/),d("keyword","important")):/\d/.test(c)?(a.eatWhile(/[\w.%]/),d("number","unit")):/[,.+>*\/]/.test(c)?d(null,"select-op"):/[;{}:\[\]]/.test(c)?d(null,c):(a.eatWhile(/[\w\\\-]/),d("variable","variable")):d(null,"compare");d(null,"compare")}function f(a,b){var c=!1,f;while((f=a.next())!=null){if(c&&f=="/"){b.tokenize=e;break}c=f=="*"}return d("comment","comment")}function g(a,b){var c=0,f;while((f=a.next())!=null){if(c>=2&&f==">"){b.tokenize=e;break}c=f=="-"?c+1:0}return d("comment","comment")}function h(a){return function(b,c){var f=!1,g;while((g=b.next())!=null){if(g==a&&!f)break;f=!f&&g=="\\"}return f||(c.tokenize=e),d("string","string")}}var b=a.indentUnit,c;return{startState:function(a){return{tokenize:e,baseIndent:a||0,stack:[]}},token:function(a,b){if(a.eatSpace())return null;var d=b.tokenize(a,b),e=b.stack[b.stack.length-1];if(c=="hash"&&e!="rule")d="string-2";else if(d=="variable")if(e=="rule")d="number";else if(!e||e=="@media{")d="tag";return e=="rule"&&/^[\{\};]$/.test(c)&&b.stack.pop(),c=="{"?e=="@media"?b.stack[b.stack.length-1]="@media{":b.stack.push("{"):c=="}"?b.stack.pop():c=="@media"?b.stack.push("@media"):e=="{"&&c!="comment"&&b.stack.push("rule"),d},indent:function(a,c){var d=a.stack.length;return/^\}/.test(c)&&(d-=a.stack[a.stack.length-1]=="rule"?2:1),a.baseIndent+d*b},electricChars:"}"}}),CodeMirror.defineMIME("text/css","css");
CodeMirror.defineMode("clike",function(a,b){function k(a,b){var c=a.next();if(g[c]){var h=g[c](a,b);if(h!==!1)return h}if(c=='"'||c=="'")return b.tokenize=l(c),b.tokenize(a,b);if(/[\[\]{}\(\),;\:\.]/.test(c))return j=c,null;if(/\d/.test(c))return a.eatWhile(/[\w\.]/),"number";if(c=="/"){if(a.eat("*"))return b.tokenize=m,m(a,b);if(a.eat("/"))return a.skipToEnd(),"comment"}if(i.test(c))return a.eatWhile(i),"operator";a.eatWhile(/[\w\$_]/);var k=a.current();return d.propertyIsEnumerable(k)?(e.propertyIsEnumerable(k)&&(j="newstatement"),"keyword"):f.propertyIsEnumerable(k)?"atom":"word"}function l(a){return function(b,c){var d=!1,e,f=!1;while((e=b.next())!=null){if(e==a&&!d){f=!0;break}d=!d&&e=="\\"}if(f||!d&&!h)c.tokenize=null;return"string"}}function m(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=null;break}c=d=="*"}return"comment"}function n(a,b,c,d,e){this.indented=a,this.column=b,this.type=c,this.align=d,this.prev=e}function o(a,b,c){return a.context=new n(a.indented,b,c,null,a.context)}function p(a){var b=a.context.type;if(b==")"||b=="]"||b=="}")a.indented=a.context.indented;return a.context=a.context.prev}var c=a.indentUnit,d=b.keywords||{},e=b.blockKeywords||{},f=b.atoms||{},g=b.hooks||{},h=b.multiLineStrings,i=/[+\-*&%=<>!?|\/]/,j;return{startState:function(a){return{tokenize:null,context:new n((a||0)-c,0,"top",!1),indented:0,startOfLine:!0}},token:function(a,b){var c=b.context;a.sol()&&(c.align==null&&(c.align=!1),b.indented=a.indentation(),b.startOfLine=!0);if(a.eatSpace())return null;j=null;var d=(b.tokenize||k)(a,b);if(d=="comment"||d=="meta")return d;c.align==null&&(c.align=!0);if(j!=";"&&j!=":"||c.type!="statement")if(j=="{")o(b,a.column(),"}");else if(j=="[")o(b,a.column(),"]");else if(j=="(")o(b,a.column(),")");else if(j=="}"){while(c.type=="statement")c=p(b);c.type=="}"&&(c=p(b));while(c.type=="statement")c=p(b)}else j==c.type?p(b):(c.type=="}"||c.type=="top"||c.type=="statement"&&j=="newstatement")&&o(b,a.column(),"statement");else p(b);return b.startOfLine=!1,d},indent:function(a,b){if(a.tokenize!=k&&a.tokenize!=null)return 0;var d=a.context,e=b&&b.charAt(0);d.type=="statement"&&e=="}"&&(d=d.prev);var f=e==d.type;return d.type=="statement"?d.indented+(e=="{"?0:c):d.align?d.column+(f?0:1):d.indented+(f?0:c)},electricChars:"{}"}}),function(){function a(a){var b={},c=a.split(" ");for(var d=0;d<c.length;++d)b[c[d]]=!0;return b}function c(a,b){return b.startOfLine?(a.skipToEnd(),"meta"):!1}function d(a,b){var c;while((c=a.next())!=null)if(c=='"'&&!a.eat('"')){b.tokenize=null;break}return"string"}var b="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";CodeMirror.defineMIME("text/x-csrc",{name:"clike",keywords:a(b),blockKeywords:a("case do else for if switch while struct"),atoms:a("null"),hooks:{"#":c}}),CodeMirror.defineMIME("text/x-c++src",{name:"clike",keywords:a(b+" asm dynamic_cast namespace reinterpret_cast try bool explicit new "+"static_cast typeid catch operator template typename class friend private "+"this using const_cast inline public throw virtual delete mutable protected "+"wchar_t"),blockKeywords:a("catch class do else finally for if struct switch try while"),atoms:a("true false null"),hooks:{"#":c}}),CodeMirror.defineMIME("text/x-java",{name:"clike",keywords:a("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:a("catch class do else finally for if switch try while"),atoms:a("true false null"),hooks:{"@":function(a,b){return a.eatWhile(/[\w\$_]/),"meta"}}}),CodeMirror.defineMIME("text/x-csharp",{name:"clike",keywords:a("abstract as base bool break byte case catch char checked class const continue decimal default delegate do double else enum event explicit extern finally fixed float for foreach goto if implicit in int interface internal is lock long namespace new object operator out override params private protected public readonly ref return sbyte sealed short sizeof stackalloc static string struct switch this throw try typeof uint ulong unchecked unsafe ushort using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),blockKeywords:a("catch class do else finally for foreach if struct switch try while"),atoms:a("true false null"),hooks:{"@":function(a,b){return a.eat('"')?(b.tokenize=d,d(a,b)):(a.eatWhile(/[\w\$_]/),"meta")}}})}();
CodeMirror.defineMode("python",function(a,b){function d(a){return new RegExp("^(("+a.join(")|(")+"))\\b")}function t(a,b){if(a.sol()){var d=b.scopes[0].offset;if(a.eatSpace()){var l=a.indentation();return l>d?s="indent":l<d&&(s="dedent"),null}d>0&&w(a,b)}if(a.eatSpace())return null;var m=a.peek();if(m==="#")return a.skipToEnd(),"comment";if(a.match(/^[0-9\.]/,!1)){var n=!1;a.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(n=!0),a.match(/^\d+\.\d*/)&&(n=!0),a.match(/^\.\d+/)&&(n=!0);if(n)return a.eat(/J/i),"number";var o=!1;a.match(/^0x[0-9a-f]+/i)&&(o=!0),a.match(/^0b[01]+/i)&&(o=!0),a.match(/^0o[0-7]+/i)&&(o=!0),a.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(a.eat(/J/i),o=!0),a.match(/^0(?![\dx])/i)&&(o=!0);if(o)return a.eat(/L/i),"number"}return a.match(p)?(b.tokenize=u(a.current()),b.tokenize(a,b)):a.match(i)||a.match(h)?null:a.match(g)||a.match(e)||a.match(k)?"operator":a.match(f)?null:a.match(q)?"keyword":a.match(r)?"builtin":a.match(j)?"variable":(a.next(),c)}function u(a){while("rub".indexOf(a.charAt(0).toLowerCase())>=0)a=a.substr(1);var d=a.length==1,e="string";return function(g,h){while(!g.eol()){g.eatWhile(/[^'"\\]/);if(g.eat("\\")){g.next();if(d&&g.eol())return e}else{if(g.match(a))return h.tokenize=t,e;g.eat(/['"]/)}}if(d){if(b.singleLineStringErrors)return c;h.tokenize=t}return e}}function v(b,c,d){d=d||"py";var e=0;if(d==="py"){if(c.scopes[0].type!=="py"){c.scopes[0].offset=b.indentation();return}for(var f=0;f<c.scopes.length;++f)if(c.scopes[f].type==="py"){e=c.scopes[f].offset+a.indentUnit;break}}else e=b.column()+b.current().length;c.scopes.unshift({offset:e,type:d})}function w(a,b,c){c=c||"py";if(b.scopes.length==1)return;if(b.scopes[0].type==="py"){var d=a.indentation(),e=-1;for(var f=0;f<b.scopes.length;++f)if(d===b.scopes[f].offset){e=f;break}if(e===-1)return!0;while(b.scopes[0].offset!==d)b.scopes.shift();return!1}return c==="py"?(b.scopes[0].offset=a.indentation(),!1):b.scopes[0].type!=c?!0:(b.scopes.shift(),!1)}function x(a,b){s=null;var d=b.tokenize(a,b),e=a.current();if(e===".")return d=b.tokenize(a,b),e=a.current(),d==="variable"||d==="builtin"?"variable":c;if(e==="@")return d=b.tokenize(a,b),e=a.current(),d==="variable"||e==="@staticmethod"||e==="@classmethod"?"meta":c;if(e==="pass"||e==="return")b.dedent+=1;e==="lambda"&&(b.lambda=!0),(e===":"&&!b.lambda&&b.scopes[0].type=="py"||s==="indent")&&v(a,b);var f="[({".indexOf(e);return f!==-1&&v(a,b,"])}".slice(f,f+1)),s==="dedent"&&w(a,b)?c:(f="])}".indexOf(e),f!==-1&&w(a,b,e)?c:(b.dedent>0&&a.eol()&&b.scopes[0].type=="py"&&(b.scopes.length>1&&b.scopes.shift(),b.dedent-=1),d))}var c="error",e=new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"),f=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),g=new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),h=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),i=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))"),j=new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),k=d(["and","or","not","is","in"]),l=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield"],m=["abs","all","any","bin","bool","bytearray","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip","__import__","NotImplemented","Ellipsis","__debug__"],n={builtins:["apply","basestring","buffer","cmp","coerce","execfile","file","intern","long","raw_input","reduce","reload","unichr","unicode","xrange","False","True","None"],keywords:["exec","print"]},o={builtins:["ascii","bytes","exec","print"],keywords:["nonlocal","False","True","None"]};if(!b.version||parseInt(b.version,10)!==3){l=l.concat(n.keywords),m=m.concat(n.builtins);var p=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}else{l=l.concat(o.keywords),m=m.concat(o.builtins);var p=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}var q=d(l),r=d(m),s=null,y={startState:function(a){return{tokenize:t,scopes:[{offset:a||0,type:"py"}],lastToken:null,lambda:!1,dedent:0}},token:function(a,b){var c=x(a,b);return b.lastToken={style:c,content:a.current()},a.eol()&&a.lambda&&(b.lambda=!1),c},indent:function(a,b){return a.tokenize!=t?0:a.scopes[0].offset}};return y}),CodeMirror.defineMIME("text/x-python","python");
CodeMirror.defineMode("ruby",function(a,b){function c(a){var b={};for(var c=0,d=a.length;c<d;++c)b[a[c]]=!0;return b}function i(a,b,c){return c.tokenize.push(a),a(b,c)}function j(a,b){h=null;if(a.sol()&&a.match("=begin")&&a.eol())return b.tokenize.push(n),"comment";if(a.eatSpace())return null;var c=a.next();if(c=="`"||c=="'"||c=='"'||c=="/"&&!a.eol()&&a.peek()!=" ")return i(l(c,"string",c=='"'||c=="`"),a,b);if(c=="%"){var d,e=!1;a.eat("s")?d="atom":a.eat(/[WQ]/)?(d="string",e=!0):a.eat(/[wxqr]/)&&(d="string");var f=a.eat(/[^\w\s]/);return f?(g.propertyIsEnumerable(f)&&(f=g[f]),i(l(f,d,e,!0),a,b)):"operator"}if(c=="#")return a.skipToEnd(),"comment";if(c=="<"&&a.eat("<")){a.eat("-"),a.eat(/[\'\"\`]/);var j=a.match(/^\w+/);return a.eat(/[\'\"\`]/),j?i(m(j[0]),a,b):null}if(c=="0")return a.eat("x")?a.eatWhile(/[\da-fA-F]/):a.eat("b")?a.eatWhile(/[01]/):a.eatWhile(/[0-7]/),"number";if(/\d/.test(c))return a.match(/^[\d_]*(?:\.[\d_]+)?(?:[eE][+\-]?[\d_]+)?/),"number";if(c=="?"){while(a.match(/^\\[CM]-/));return a.eat("\\")?a.eatWhile(/\w/):a.next(),"string"}return c==":"?a.eat("'")?i(l("'","atom",!1),a,b):a.eat('"')?i(l('"',"atom",!0),a,b):(a.eatWhile(/[\w\?]/),"atom"):c=="@"?(a.eat("@"),a.eatWhile(/[\w\?]/),"variable-2"):c=="$"?(a.next(),a.eatWhile(/[\w\?]/),"variable-3"):/\w/.test(c)?(a.eatWhile(/[\w\?]/),a.eat(":")?"atom":"ident"):c!="|"||!b.varList&&b.lastTok!="{"&&b.lastTok!="do"?/[\(\)\[\]{}\\;]/.test(c)?(h=c,null):c=="-"&&a.eat(">")?"arrow":/[=+\-\/*:\.^%<>~|]/.test(c)?(a.eatWhile(/[=+\-\/*:\.^%<>~|]/),"operator"):null:(h="|",null)}function k(){var a=1;return function(b,c){if(b.peek()=="}"){a--;if(a==0)return c.tokenize.pop(),c.tokenize[c.tokenize.length-1](b,c)}else b.peek()=="{"&&a++;return j(b,c)}}function l(a,b,c,d){return function(e,f){var g=!1,h;while((h=e.next())!=null){if(h==a&&(d||!g)){f.tokenize.pop();break}if(c&&h=="#"&&!g&&e.eat("{")){f.tokenize.push(k(arguments.callee));break}g=!g&&h=="\\"}return b}}function m(a){return function(b,c){return b.match(a)?c.tokenize.pop():b.skipToEnd(),"string"}}function n(a,b){return a.sol()&&a.match("=end")&&a.eol()&&b.tokenize.pop(),a.skipToEnd(),"comment"}var d=c(["alias","and","BEGIN","begin","break","case","class","def","defined?","do","else","elsif","END","end","ensure","false","for","if","in","module","next","not","or","redo","rescue","retry","return","self","super","then","true","undef","unless","until","when","while","yield","nil","raise","throw","catch","fail","loop","callcc","caller","lambda","proc","public","protected","private","require","load","require_relative","extend","autoload"]),e=c(["def","class","case","for","while","do","module","then","catch","loop","proc","begin"]),f=c(["end","until"]),g={"[":"]","{":"}","(":")"},h;return{startState:function(){return{tokenize:[j],indented:0,context:{type:"top",indented:-a.indentUnit},continuedLine:!1,lastTok:null,varList:!1}},token:function(a,b){a.sol()&&(b.indented=a.indentation());var c=b.tokenize[b.tokenize.length-1](a,b),g;if(c=="ident"){var i=a.current();c=d.propertyIsEnumerable(a.current())?"keyword":/^[A-Z]/.test(i)?"tag":b.lastTok=="def"||b.lastTok=="class"||b.varList?"def":"variable",e.propertyIsEnumerable(i)?g="indent":f.propertyIsEnumerable(i)?g="dedent":(i=="if"||i=="unless")&&a.column()==a.indentation()&&(g="indent")}if(h||c&&c!="comment")b.lastTok=i||h||c;return h=="|"&&(b.varList=!b.varList),g=="indent"||/[\(\[\{]/.test(h)?b.context={prev:b.context,type:h||c,indented:b.indented}:(g=="dedent"||/[\)\]\}]/.test(h))&&b.context.prev&&(b.context=b.context.prev),a.eol()&&(b.continuedLine=h=="\\"||c=="operator"),c},indent:function(b,c){if(b.tokenize[b.tokenize.length-1]!=j)return 0;var d=c&&c.charAt(0),e=b.context,f=e.type==g[d]||e.type=="keyword"&&/^(?:end|until|else|elsif|when|rescue)\b/.test(c);return e.indented+(f?0:a.indentUnit)+(b.continuedLine?a.indentUnit:0)},electricChars:"}de"}}),CodeMirror.defineMIME("text/x-ruby","ruby");
CodeMirror.defineMode("coffeescript",function(a){function c(a){return new RegExp("^(("+a.join(")|(")+"))\\b")}function r(a,c){if(a.sol()){var k=c.scopes[0].offset;if(a.eatSpace()){var l=a.indentation();return l>k?"indent":l<k?"dedent":null}k>0&&v(a,c)}if(a.eatSpace())return null;var p=a.peek();if(a.match("###"))return c.tokenize=t,c.tokenize(a,c);if(p==="#")return a.skipToEnd(),"comment";if(a.match(/^-?[0-9\.]/,!1)){var r=!1;a.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(r=!0),a.match(/^-?\d+\.\d*/)&&(r=!0),a.match(/^-?\.\d+/)&&(r=!0);if(r)return a.peek()=="."&&a.backUp(1),"number";var u=!1;a.match(/^-?0x[0-9a-f]+/i)&&(u=!0),a.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(u=!0),a.match(/^-?0(?![\dx])/i)&&(u=!0);if(u)return"number"}if(a.match(n))return c.tokenize=s(a.current(),"string"),c.tokenize(a,c);if(a.match(o)){if(a.current()!="/"||a.match(/^.*\//,!1))return c.tokenize=s(a.current(),"string-2"),c.tokenize(a,c);a.backUp(1)}return a.match(h)||a.match(g)?"punctuation":a.match(f)||a.match(d)||a.match(j)?"operator":a.match(e)?"punctuation":a.match(q)?"atom":a.match(m)?"keyword":a.match(i)?"variable":(a.next(),b)}function s(c,d){var e=c.length==1;return function(g,h){while(!g.eol()){g.eatWhile(/[^'"\/\\]/);if(g.eat("\\")){g.next();if(e&&g.eol())return d}else{if(g.match(c))return h.tokenize=r,d;g.eat(/['"\/]/)}}return e&&(a.mode.singleLineStringErrors?d=b:h.tokenize=r),d}}function t(a,b){while(!a.eol()){a.eatWhile(/[^#]/);if(a.match("###")){b.tokenize=r;break}a.eatWhile("#")}return"comment"}function u(b,c,d){d=d||"coffee";var e=0;if(d==="coffee"){for(var f=0;f<c.scopes.length;f++)if(c.scopes[f].type==="coffee"){e=c.scopes[f].offset+a.indentUnit;break}}else e=b.column()+b.current().length;c.scopes.unshift({offset:e,type:d})}function v(a,b){if(b.scopes.length==1)return;if(b.scopes[0].type==="coffee"){var c=a.indentation(),d=-1;for(var e=0;e<b.scopes.length;++e)if(c===b.scopes[e].offset){d=e;break}if(d===-1)return!0;while(b.scopes[0].offset!==c)b.scopes.shift();return!1}return b.scopes.shift(),!1}function w(a,c){var d=c.tokenize(a,c),e=a.current();if(e===".")return d=c.tokenize(a,c),e=a.current(),d==="variable"?"variable":b;if(e==="@")return a.eat("@"),"keyword";e==="return"&&(c.dedent+=1),((e==="->"||e==="=>")&&!c.lambda&&c.scopes[0].type=="coffee"&&a.peek()===""||d==="indent")&&u(a,c);var f="[({".indexOf(e);return f!==-1&&u(a,c,"])}".slice(f,f+1)),k.exec(e)&&u(a,c),e=="then"&&v(a,c),d==="dedent"&&v(a,c)?b:(f="])}".indexOf(e),f!==-1&&v(a,c)?b:(c.dedent>0&&a.eol()&&c.scopes[0].type=="coffee"&&(c.scopes.length>1&&c.scopes.shift(),c.dedent-=1),d))}var b="error",d=new RegExp("^[\\+\\-\\*/%&|\\^~<>!?]"),e=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),f=new RegExp("^((->)|(=>)|(\\+\\+)|(\\+\\=)|(\\-\\-)|(\\-\\=)|(\\*\\*)|(\\*\\=)|(\\/\\/)|(\\/\\=)|(==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//))"),g=new RegExp("^((\\.\\.)|(\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),h=new RegExp("^((\\.\\.\\.)|(//=)|(>>=)|(<<=)|(\\*\\*=))"),i=new RegExp("^[_A-Za-z$][_A-Za-z$0-9]*"),j=c(["and","or","not","is","isnt","in","instanceof","typeof"]),k=["for","while","loop","if","unless","else","switch","try","catch","finally","class"],l=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","throw","when","until"],m=c(k.concat(l));k=c(k);var n=new RegExp("^('{3}|\"{3}|['\"])"),o=new RegExp("^(/{3}|/)"),p=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"],q=c(p),x={startState:function(a){return{tokenize:r,scopes:[{offset:a||0,type:"coffee"}],lastToken:null,lambda:!1,dedent:0}},token:function(a,b){var c=w(a,b);return b.lastToken={style:c,content:a.current()},a.eol()&&a.lambda&&(b.lambda=!1),c},indent:function(a,b){return a.tokenize!=r?0:a.scopes[0].offset}};return x}),CodeMirror.defineMIME("text/x-coffeescript","coffeescript");
CodeMirror.runMode=function(a,b,c,d){var e=CodeMirror.getMode(CodeMirror.defaults,b),f=c.nodeType==1,g=d&&d.tabSize||CodeMirror.defaults.tabSize;if(f){var h=c,i=[],j=0;c=function(a,b){if(a=="\n"){i.push("<br>"),j=0;return}var c="";for(var d=0;;){var e=a.indexOf("	",d);if(e==-1){c+=CodeMirror.htmlEscape(a.slice(d)),j+=a.length-d;break}j+=e-d,c+=CodeMirror.htmlEscape(a.slice(d,e));var f=g-j%g;j+=f;for(var h=0;h<f;++h)c+=" ";d=e+1}b?i.push('<span class="cm-'+CodeMirror.htmlEscape(b)+'">'+c+"</span>"):i.push(c)}}var k=CodeMirror.splitLines(a),l=CodeMirror.startState(e);for(var m=0,n=k.length;m<n;++m){m&&c("\n");var o=new CodeMirror.StringStream(k[m]);while(!o.eol()){var p=e.token(o,l);c(o.current(),p,m,o.start),o.start=o.pos}}f&&(h.innerHTML=i.join(""))};
CodeMirror.tagRangeFinder=function(a,b,c){var d="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",e=d+"-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",f=new RegExp("^["+d+"]["+e+"]*"),g=a.getLine(b),h=!1,i=null,j=0;while(!h){j=g.indexOf("<",j);if(-1==j)return;if(j+1<g.length&&g[j+1]=="/"){j++;continue}if(!g.substr(j+1).match(f)){j++;continue}var k=g.indexOf(">",j+1);if(-1==k){var l=b+1,m=!1,n=a.lineCount();while(l<n&&!m){var o=a.getLine(l),p=o.indexOf(">");if(-1!=p){m=!0;var q=o.lastIndexOf("/",p);if(-1!=q&&q<p){var r=g.substr(q,p-q+1);if(!r.match(/\/\s*\>/))return c===!0&&l++,l}}l++}h=!0}else{var s=g.lastIndexOf("/",k);if(-1==s)h=!0;else{var r=g.substr(s,k-s+1);r.match(/\/\s*\>/)||(h=!0)}}if(h){var t=g.substr(j+1);i=t.match(f),i?(i=i[0],-1!=g.indexOf("</"+i+">",j)&&(h=!1)):h=!1}h||j++}if(h){var u="(\\<\\/"+i+"\\>)|(\\<"+i+"\\>)|(\\<"+i+"\\s)|(\\<"+i+"$)",v=new RegExp(u,"g"),w="</"+i+">",x=1,l=b+1,n=a.lineCount();while(l<n){g=a.getLine(l);var y=g.match(v);if(y)for(var z=0;z<y.length;z++){y[z]==w?x--:x++;if(!x)return c===!0&&l++,l}l++}return}},CodeMirror.braceRangeFinder=function(a,b,c){var d=a.getLine(b),e=d.lastIndexOf("{");if(e<0||d.lastIndexOf("}")>e)return;var f=a.getTokenAt({line:b,ch:e}).className,g=1,h=a.lineCount(),i;a:for(var j=b+1;j<h;++j){var k=a.getLine(j),l=0;for(;;){var m=k.indexOf("{",l),n=k.indexOf("}",l);m<0&&(m=k.length),n<0&&(n=k.length),l=Math.min(m,n);if(l==k.length)break;if(a.getTokenAt({line:j,ch:l+1}).className==f)if(l==m)++g;else if(!--g){i=j;break a}++l}}if(i==null||i==b+1)return;return c===!0&&i++,i},CodeMirror.indentRangeFinder=function(a,b){var c=a.getOption("tabSize"),d=a.getLineHandle(b).indentation(c),e;for(var f=b+1,g=a.lineCount();f<g;++f){var h=a.getLineHandle(f);if(!/^\s*$/.test(h.text)){if(h.indentation(c)<=d)break;e=f}}return e?e+1:null},CodeMirror.newFoldFunction=function(a,b,c){function e(a,b){for(var c=0;c<d.length;++c){var e=a.lineInfo(d[c].start);if(!e)d.splice(c--,1);else if(e.line==b)return{pos:c,region:d[c]}}}function f(a,b){a.clearMarker(b.start);for(var c=0;c<b.hidden.length;++c)a.showLine(b.hidden[c])}var d=[];return b==null&&(b='<div style="position: absolute; left: 2px; color:#600">&#x25bc;</div>%N%'),function(g,h){g.operation(function(){var i=e(g,h);if(i)d.splice(i.pos,1),f(g,i.region);else{var j=a(g,h,c);if(j==null)return;var k=[];for(var l=h+1;l<j;++l){var m=g.hideLine(l);m&&k.push(m)}var n=g.setMarker(h,b),o={start:n,hidden:k};g.onDeleteLine(n,function(){f(g,o)}),d.push(o)}})}};
(function(){function a(a,b){var c=a.getWrapperElement(),d=c.insertBefore(document.createElement("div"),c.firstChild);return d.className="CodeMirror-dialog",d.innerHTML="<div>"+b+"</div>",d}CodeMirror.defineExtension("openDialog",function(b,c){function g(){if(e)return;e=!0,d.parentNode.removeChild(d)}var d=a(this,b),e=!1,f=this,h=d.getElementsByTagName("input")[0];return h&&(CodeMirror.connect(h,"keydown",function(a){if(a.keyCode==13||a.keyCode==27)CodeMirror.e_stop(a),g(),f.focus(),a.keyCode==13&&c(h.value)}),h.focus(),CodeMirror.connect(h,"blur",g)),g}),CodeMirror.defineExtension("openConfirm",function(b,c){function i(){if(f)return;f=!0,d.parentNode.removeChild(d),g.focus()}var d=a(this,b),e=d.getElementsByTagName("button"),f=!1,g=this,h=1;e[0].focus();for(var j=0;j<e.length;++j){var k=e[j];(function(a){CodeMirror.connect(k,"click",function(b){CodeMirror.e_preventDefault(b),i(),a&&a(g)})})(c[j]),CodeMirror.connect(k,"blur",function(){--h,setTimeout(function(){h<=0&&i()},200)}),CodeMirror.connect(k,"focus",function(){++h})}})})();
(function(){function a(a,b,c,d){this.atOccurrence=!1,this.cm=a,d==null&&(d=typeof b=="string"&&b==b.toLowerCase()),c=c?a.clipPos(c):{line:0,ch:0},this.pos={from:c,to:c};if(typeof b!="string")this.matches=function(c,d){if(c){var e=a.getLine(d.line).slice(0,d.ch),f=e.match(b),g=0;while(f){var h=e.indexOf(f[0]);g+=h,e=e.slice(h+1);var i=e.match(b);if(!i)break;f=i,g++}}else var e=a.getLine(d.line).slice(d.ch),f=e.match(b),g=f&&d.ch+e.indexOf(f[0]);if(f)return{from:{line:d.line,ch:g},to:{line:d.line,ch:g+f[0].length},match:f}};else{d&&(b=b.toLowerCase());var e=d?function(a){return a.toLowerCase()}:function(a){return a},f=b.split("\n");f.length==1?this.matches=function(c,d){var f=e(a.getLine(d.line)),g=b.length,h;if(c?d.ch>=g&&(h=f.lastIndexOf(b,d.ch-g))!=-1:(h=f.indexOf(b,d.ch))!=-1)return{from:{line:d.line,ch:h},to:{line:d.line,ch:h+g}}}:this.matches=function(b,c){var d=c.line,g=b?f.length-1:0,h=f[g],i=e(a.getLine(d)),j=b?i.indexOf(h)+h.length:i.lastIndexOf(h);if(b?j>=c.ch||j!=h.length:j<=c.ch||j!=i.length-h.length)return;for(;;){if(b?!d:d==a.lineCount()-1)return;i=e(a.getLine(d+=b?-1:1)),h=f[b?--g:++g];if(g>0&&g<f.length-1){if(i!=h)return;continue}var k=b?i.lastIndexOf(h):i.indexOf(h)+h.length;if(b?k!=i.length-h.length:k!=h.length)return;var l={line:c.line,ch:j},m={line:d,ch:k};return{from:b?m:l,to:b?l:m}}}}}a.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(a){function d(a){var c={line:a,ch:0};return b.pos={from:c,to:c},b.atOccurrence=!1,!1}var b=this,c=this.cm.clipPos(a?this.pos.from:this.pos.to);for(;;){if(this.pos=this.matches(a,c))return this.atOccurrence=!0,this.pos.match||!0;if(a){if(!c.line)return d(0);c={line:c.line-1,ch:this.cm.getLine(c.line-1).length}}else{var e=this.cm.lineCount();if(c.line==e-1)return d(e);c={line:c.line+1,ch:0}}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(a){var b=this;this.atOccurrence&&(b.pos.to=this.cm.replaceRange(a,b.pos.from,b.pos.to))}},CodeMirror.defineExtension("getSearchCursor",function(b,c,d){return new a(this,b,c,d)})})();
(function(){function b(){this.marked=[]}function c(a){return a._matchHighlightState||(a._matchHighlightState=new b)}function d(a){var b=c(a);for(var d=0;d<b.marked.length;++d)b.marked[d].clear();b.marked=[]}function e(b,e,f){d(b),f=typeof f!="undefined"?f:a;if(b.somethingSelected()&&b.getSelection().length>=f){var g=c(b),h=b.getSelection();b.operation(function(){if(b.lineCount()<2e3)for(var a=b.getSearchCursor(h);a.findNext();)(a.from().line!==b.getCursor(!0).line||a.from().ch!==b.getCursor(!0).ch)&&g.marked.push(b.markText(a.from(),a.to(),e))})}}var a=2;CodeMirror.defineExtension("matchHighlight",function(a,b){e(this,a,b)})})();
(function(){function g(){}function h(){}function i(a,b,c){this.init(a,[b],[c||(a&&a.length>1?a.slice(1):a)])}function j(){}function k(b,c,d){if(!arguments.length)return;var e=this;e.parent=b,e.prev=c||0,e.next=d||0,e.jQinit(e.fold(a(),function(a,b){return b.jQ.add(a)}))}function l(c,e,f,g){function n(){m=b;var a=i.selection?"$"+i.selection.latex()+"$":"";l.val(a);if(a)if(l[0].select)l[0].select();else if(document.selection){var c=l[0].createTextRange();c.expand("textedit"),c.select()}}function q(b){return i.seek(a(b.target),b.pageX,b.pageY),(i.prev!==o.prev||i.parent!==o.parent)&&i.selectFrom(o),!1}function r(a){return delete a.target,q(a)}function s(d){o=b,i.blink=p,i.selection||(g?i.show():j.detach()),c.unbind("mousemove",q),a(document).unbind("mousemove",r).unbind("mouseup",s)}function u(){l.focus()}function v(){var a=l.val();a.slice(0,1)==="$"&&a.slice(-1)==="$"?a=a.slice(1,-1):a="\\text{"+a+"}",i.writeLatex(a).show(),l.val("")}function y(){if(x)return;var a=l.val();if(a){l.val("");for(var c=0;c<a.length;c+=1)i.parent.textInput(a.charAt(c))}else(i.selection||m!==b)&&n()}var h=c.contents().detach();f||c.addClass("mathquill-rendered-math"),e.jQ=c.data(d,{block:e,revert:function(){c.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(h)}});var i=e.cursor=new Y(e);e.renderLatex(h.text());var j=e.textarea=a('<span class="textarea"><textarea></textarea></span>'),l=j.children(),m;e.selectionChanged=function(){m===b&&(m=setTimeout(n))},c.bind("selectstart.mathquill",function(a){a.target!==l[0]&&a.preventDefault(),a.stopPropagation()});var o,p=i.blink;c.bind("mousedown.mathquill",function(b){i.blink=a.noop,i.seek(a(b.target),b.pageX,b.pageY),o=new k(i.parent,i.prev,i.next),g||c.prepend(j),c.mousemove(q),a(document).mousemove(r).mouseup(s),b.stopPropagation()});if(!g){c.bind("cut paste",!1).bind("copy",n).prepend('<span class="selectable">$'+e.latex()+"$</span>"),l.blur(function(){i.clearSelection(),setTimeout(t)});function t(){j.detach()}return}c.prepend(j),c.addClass("mathquill-editable"),f&&c.addClass("mathquill-textbox"),l.focus(function(a){i.parent||i.appendTo(e),i.parent.jQ.addClass("hasCursor"),i.selection?(i.selection.jQ.removeClass("blur"),setTimeout(e.selectionChanged)):i.show(),a.stopPropagation()}).blur(function(a){i.hide().parent.blur(),i.selection&&i.selection.jQ.addClass("blur"),a.stopPropagation()}),c.bind("focus.mathquill blur.mathquill",function(a){l.trigger(a)}).bind("mousedown.mathquill",function(){setTimeout(u)}).bind("click.mathquill",u).blur(),c.bind("cut",function(a){n(),i.selection&&setTimeout(function(){i.deleteSelection(),i.redraw()}),a.stopPropagation()}).bind("copy",function(a){n(),x=!0,a.stopPropagation()}).bind("paste",function(a){x=!0,setTimeout(v),a.stopPropagation()});var w={},x=!1;c.bind("keydown.mathquill",function(a){w.evt=a,w.happened=!0,i.parent.keydown(a)===!1&&a.preventDefault()}).bind("keypress.mathquill",function(a){w.happened?w.happened=!1:i.parent.keydown(w.evt),m!==b&&clearTimeout(m),(i.selection||m!==b)&&l.val(""),x=!1,setTimeout(y)})}function m(){}function n(a){this.init("$"),this.firstChild.cursor=a,this.firstChild.textInput=function(b){if(this.skipTextInput)return;b!=="$"||a.parent!==this?a.write(b):this.isEmpty()?a.insertAfter(this.parent).backspace().insertNew(new S("\\$","$")).show():a.next?a.prev?a.write(b):a.insertBefore(this.parent):a.insertAfter(this.parent)}}function o(){}function x(a,b){return b.prototype=a.prototype,b}function y(a){var b=Array.prototype.slice.call(arguments,1);return x(a,function(){a.apply(this,Array.prototype.concat.apply(b,arguments))})}function z(a,c,d){this.init(a,[c],b,d)}function A(a,b,c,d){this.init(a,[b],[c],d)}function B(a){this.init("\\frac",b,b,a),this.jQ.append('<span style="display:inline-block;width:0">&nbsp;</span>')}function C(){B.apply(this,arguments)}function D(a){this.init("\\sqrt",b,b,a)}function E(a){D.call(this,a),this.jQ=this.firstChild.jQ.detach().add(this.jQ)}function F(a,b,c,d,e){this.init("\\left"+c,['<span class="block"><span class="paren">'+a+'</span><span class="block"></span><span class="paren">'+b+"</span></span>"],[a,b],e),this.end="\\right"+d}function G(a,b,c,d,e){F.apply(this,arguments)}function H(a,b,c){F.call(this,a,b,a,b,c)}function I(a,b,c){G.call(this,a,b,a,b,c)}function J(a){H.call(this,"|","|",a)}function K(a){a instanceof k?this.replacedText=a.remove().jQ.text():typeof a=="string"&&(this.replacedText=a),this.init()}function L(){}function M(a,b){function d(){K.apply(this,arguments)}return c=d.prototype=new K,c.cmd=a,c.html_template=[b],d}function N(a){this.init("\\"),a&&(this.replacedFragment=a.detach(),this.isEmpty=function(){return!1})}function O(c){this.init("\\binom",b,b,c),this.jQ.wrapInner('<span class="array"></span>'),this.blockjQ=this.jQ.children(),this.bracketjQs=a('<span class="paren">(</span>').prependTo(this.jQ).add(a('<span class="paren">)</span>').appendTo(this.jQ))}function P(){O.apply(this,arguments)}function Q(a){this.init("\\vector",b,b,a)}function R(a,b){i.call(this,a,"<var>"+(b||a)+"</var>")}function S(a,b){i.call(this,a,"<span>"+(b||a)+"</span>")}function T(a,b){i.call(this,a,'<span class="nonSymbola">'+(b||a)+"</span>")}function U(a,b,c){i.call(this,a,'<span class="binary-operator">'+b+"</span>",c)}function V(a,b){S.apply(this,arguments)}function W(a,b){i.call(this,a,"<big>"+b+"</big>")}function X(a,b){i.call(this,"\\"+b+" ","<span>"+b+"</span>")}function Y(b){this.parent=this.root=b;var c=this.jQ=this._jQ=a('<span class="cursor"></span>');this.blink=function(){c.toggleClass("blink")}}function Z(a,b,c){k.apply(this,arguments)}var a=jQuery,b,c,d="[[mathquill internal data]]",e=Math.min,f=Math.max;c=g.prototype,c.prev=0,c.next=0,c.parent=0,c.firstChild=0,c.lastChild=0,c.eachChild=function(a){for(var b=this.firstChild;b;b=b.next)if(a.call(this,b)===!1)break;return this},c.foldChildren=function(a,b){return this.eachChild(function(c){a=b.call(this,a,c)}),a},c.keydown=function(a){return this.parent.keydown(a)},c.textInput=function(a){return this.parent.textInput(a)},c=h.prototype=new g,c.init=function(b,c,e,f){var g=this;b&&(g.cmd=b),c&&(g.html_template=c),e&&(g.text_template=e),g.jQ=a(g.html_template[0]).data(d,{cmd:g}),g.initBlocks(f)},c.initBlocks=function(b){var c=this;if(c.html_template.length===1){c.firstChild=c.lastChild=c.jQ.data(d).block=b&&b.blockify()||new j,c.firstChild.parent=c,c.firstChild.jQ=c.jQ.append(c.firstChild.jQ);return}var e,f,g=c.html_template.length;this.firstChild=e=f=b&&b.blockify()||new j,e.parent=c,e.jQ=a(c.html_template[1]).data(d,{block:e}).append(e.jQ).appendTo(c.jQ),e.blur();for(var h=2;h<g;h+=1)e=new j,e.parent=c,e.prev=f,f.next=e,f=e,e.jQ=a(c.html_template[h]).data(d,{block:e}).appendTo(c.jQ),e.blur();c.lastChild=e},c.latex=function(){return this.foldChildren(this.cmd,function(a,b){return a+"{"+(b.latex()||" ")+"}"})},c.text_template=[""],c.text=function(){var a=0;return this.foldChildren(this.text_template[a],function(b,c){a+=1;var d=c.text();return b&&this.text_template[a]==="("&&d[0]==="("&&d.slice(-1)===")"?b+d.slice(1,-1)+this.text_template[a]:b+c.text()+(this.text_template[a]||"")})},c.insertAt=function(a){var b=this;b.parent=a.parent,b.next=a.next,b.prev=a.prev,a.prev?a.prev.next=b:a.parent.firstChild=b,a.next?a.next.prev=b:a.parent.lastChild=b,a.prev=b,b.jQ.insertBefore(a.jQ),b.respace(),b.next&&b.next.respace(),b.prev&&b.prev.respace(),b.placeCursor(a),a.redraw()},c.respace=a.noop,c.placeCursor=function(a){a.appendTo(this.foldChildren(this.firstChild,function(a,b){return a.isEmpty()?a:b}))},c.isEmpty=function(){return this.foldChildren(!0,function(a,b){return a&&b.isEmpty()})},c.remove=function(){var a=this,b=a.prev,c=a.next,d=a.parent;return b?b.next=c:d.firstChild=c,c?c.prev=b:d.lastChild=b,a.jQ.remove(),a},c=i.prototype=new h,c.initBlocks=a.noop,c.latex=function(){return this.cmd},c.text=function(){return this.text_template},c.placeCursor=a.noop,c.isEmpty=function(){return!0},c=j.prototype=new g,c.latex=function(){return this.foldChildren("",function(a,b){return a+b.latex()})},c.text=function(){return this.firstChild===this.lastChild?this.firstChild.text():this.foldChildren("(",function(a,b){return a+b.text()})+")"},c.isEmpty=function(){return this.firstChild===0&&this.lastChild===0},c.focus=function(){return this.jQ.addClass("hasCursor"),this.isEmpty()&&this.jQ.removeClass("empty"),this},c.blur=function(){return this.jQ.removeClass("hasCursor"),this.isEmpty()&&this.jQ.addClass("empty"),this},c=k.prototype,c.remove=h.prototype.remove,c.jQinit=function(a){this.jQ=a},c.each=function(a){for(var b=this.prev.next||this.parent.firstChild;b!==this.next;b=b.next)if(a.call(this,b)===!1)break;return this},c.fold=function(a,b){return this.each(function(c){a=b.call(this,a,c)}),a},c.latex=function(){return this.fold("",function(a,b){return a+b.latex()})},c.blockify=function(){var a=this,b=a.prev,c=a.next,d=a.parent,e=new j,f=e.firstChild=b.next||d.firstChild,g=e.lastChild=c.prev||d.lastChild;return b?b.next=c:d.firstChild=c,c?c.prev=b:d.lastChild=b,f.prev=a.prev=0,g.next=a.next=0,a.parent=e,a.each(function(a){a.parent=e}),e.jQ=a.jQ,e},c=m.prototype=new j,c.latex=function(){return j.prototype.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/ig,"$1")},c.text=function(){return this.foldChildren("",function(a,b){return a+b.text()})},c.renderLatex=function(a){this.jQ.children().slice(1).remove(),this.firstChild=this.lastChild=0,this.cursor.appendTo(this).writeLatex(a),this.blur()},c.keydown=function(a){a.ctrlKey=a.ctrlKey||a.metaKey;switch(a.originalEvent&&a.originalEvent.keyIdentifier||a.which){case 8:case"Backspace":case"U+0008":if(a.ctrlKey)while(this.cursor.prev||this.cursor.selection)this.cursor.backspace();else this.cursor.backspace();break;case 27:case"Esc":case"U+001B":case 9:case"Tab":case"U+0009":if(a.ctrlKey)break;var b=this.cursor.parent;if(a.shiftKey){if(b===this.cursor.root)return this.skipTextInput=!0;b.prev?this.cursor.appendTo(b.prev):this.cursor.insertBefore(b.parent)}else{if(b===this.cursor.root)return this.skipTextInput=!0;b.next?this.cursor.prependTo(b.next):this.cursor.insertAfter(b.parent)}this.cursor.clearSelection();break;case 13:case"Enter":break;case 35:case"End":if(a.shiftKey)while(this.cursor.next||a.ctrlKey&&this.cursor.parent!==this)this.cursor.selectRight();else this.cursor.clearSelection().appendTo(a.ctrlKey?this:this.cursor.parent);break;case 36:case"Home":if(a.shiftKey)while(this.cursor.prev||a.ctrlKey&&this.cursor.parent!==this)this.cursor.selectLeft();else this.cursor.clearSelection().prependTo(a.ctrlKey?this:this.cursor.parent);break;case 37:case"Left":if(a.ctrlKey)break;a.shiftKey?this.cursor.selectLeft():this.cursor.moveLeft();break;case 38:case"Up":if(a.ctrlKey)break;if(a.shiftKey)if(this.cursor.prev)while(this.cursor.prev)this.cursor.selectLeft();else this.cursor.selectLeft();else this.cursor.parent.prev?this.cursor.clearSelection().appendTo(this.cursor.parent.prev):this.cursor.prev?this.cursor.clearSelection().prependTo(this.cursor.parent):this.cursor.parent!==this&&this.cursor.clearSelection().insertBefore(this.cursor.parent.parent);break;case 39:case"Right":if(a.ctrlKey)break;a.shiftKey?this.cursor.selectRight():this.cursor.moveRight();break;case 40:case"Down":if(a.ctrlKey)break;if(a.shiftKey)if(this.cursor.next)while(this.cursor.next)this.cursor.selectRight();else this.cursor.selectRight();else this.cursor.parent.next?this.cursor.clearSelection().prependTo(this.cursor.parent.next):this.cursor.next?this.cursor.clearSelection().appendTo(this.cursor.parent):this.cursor.parent!==this&&this.cursor.clearSelection().insertAfter(this.cursor.parent.parent);break;case 46:case"Del":case"U+007F":if(a.ctrlKey)while(this.cursor.next||this.cursor.selection)this.cursor.deleteForward();else this.cursor.deleteForward();break;case 65:case"A":case"U+0041":if(a.ctrlKey&&!a.shiftKey&&!a.altKey){if(this!==this.cursor.root)return this.parent.keydown(a);this.cursor.clearSelection().appendTo(this);while(this.cursor.prev)this.cursor.selectLeft();break};default:return this.skipTextInput=!1,!0}return this.skipTextInput=!0,!1},c.textInput=function(a){this.skipTextInput||this.cursor.write(a)},c=n.prototype=new h,c.html_template=['<span class="mathquill-rendered-math"></span>'],c.initBlocks=function(){this.firstChild=this.lastChild=this.jQ.data(d).block=new m,this.firstChild.parent=this,this.firstChild.jQ=this.jQ},c.latex=function(){return"$"+this.firstChild.latex()+"$"},c=o.prototype=new j,c.renderLatex=function(a){var b=this,c=b.cursor;b.jQ.children().slice(1).remove(),b.firstChild=b.lastChild=0,c.show().appendTo(b),a=a.match(/(?:\\\$|[^$])+|\$(?:\\\$|[^$])*\$|\$(?:\\\$|[^$])*$/g)||"";for(var d=0;d<a.length;d+=1){var e=a[d];if(e[0]==="$"){e[-1+e.length]==="$"&&e[-2+e.length]!=="\\"?e=e.slice(1,-1):e=e.slice(1);var f=new n(c);c.insertNew(f),f.firstChild.renderLatex(e),c.show().insertAfter(f)}else for(var g=0;g<e.length;g+=1)this.cursor.insertNew(new S(e[g]))}},c.keydown=m.prototype.keydown,c.textInput=function(a){if(this.skipTextInput)return;this.cursor.deleteSelection(),a==="$"?this.cursor.insertNew(new n(this.cursor)):this.cursor.insertNew(new S(a))};var p={},q={},r,s=document.createElement("div"),t=s.style,u={transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1},v;for(var w in u)if(w in t){v=w;break}v?r=function(a,b,c){a.css(v,"scale("+b+","+c+")")}:"filter"in t?r=function(a,b,c){a.css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+b+",M22="+c+",SizingMethod='auto expand')")}:r=function(a,b,c){a.css("fontSize",c+"em")},x(h,z),q.mathrm=y(z,"\\mathrm",'<span class="roman font"></span>'),q.mathit=y(z,"\\mathit",'<i class="font"></i>'),q.mathbf=y(z,"\\mathbf",'<b class="font"></b>'),q.mathsf=y(z,"\\mathsf",'<span class="sans-serif font"></span>'),q.mathtt=y(z,"\\mathtt",'<span class="monospace font"></span>'),q.underline=y(z,"\\underline",'<span class="underline"></span>'),q.overline=q.bar=y(z,"\\overline",'<span class="overline"></span>'),c=A.prototype=new h,c.latex=function(){var a=this.firstChild.latex();return a.length===1?this.cmd+a:this.cmd+"{"+(a||" ")+"}"},c.redraw=function(){this.respace(),this.next&&this.next.respace(),this.prev&&this.prev.respace()},c.respace=function(){this.prev.cmd==="\\int "||this.prev instanceof A&&this.prev.cmd!=this.cmd&&this.prev.prev&&this.prev.prev.cmd==="\\int "?this.limit||(this.limit=!0,this.jQ.addClass("limit")):this.limit&&(this.limit=!1,this.jQ.removeClass("limit"));if(this.respaced=this.prev instanceof A&&this.prev.cmd!=this.cmd&&!this.prev.respaced){var a=+this.jQ.css("fontSize").slice(0,-2),b=this.prev.jQ.outerWidth();thisWidth=this.jQ.outerWidth(),this.jQ.css({left:(this.limit&&this.cmd==="_"?-0.25:0)-b/a+"em",marginRight:.1-e(thisWidth,b)/a+"em"})}else this.limit&&this.cmd==="_"?this.jQ.css({left:"-.25em",marginRight:""}):this.jQ.css({left:"",marginRight:""});return this},q.subscript=q._=x(A,function(a){A.call(this,"_","<sub></sub>","_",a)}),q.superscript=q.supscript=q["^"]=x(A,function(a){A.call(this,"^","<sup></sup>","**",a)}),c=B.prototype=new h,c.html_template=['<span class="fraction"></span>','<span class="numerator"></span>','<span class="denominator"></span>'],c.text_template=["(","/",")"],q.frac=q.dfrac=q.cfrac=q.fraction=B,c=C.prototype=new B,c.placeCursor=function(a){if(this.firstChild.isEmpty()){var b=this.prev;while(b&&!(b instanceof U||b instanceof K||b instanceof W))b=b.prev;b instanceof W&&b.next instanceof A&&(b=b.next,b.next instanceof A&&b.next.cmd!=b.cmd&&(b=b.next));if(b!==this.prev){var c=(new k(this.parent,b,this)).blockify();c.jQ=this.firstChild.jQ.empty().removeClass("empty").append(c.jQ).data(d,{block:c}),c.next=this.lastChild,c.parent=this,this.firstChild=this.lastChild.prev=c}}a.appendTo(this.lastChild)},q.over=p["/"]=C,c=D.prototype=new h,c.html_template=['<span class="block"><span class="sqrt-prefix">&radic;</span></span>','<span class="sqrt-stem"></span>'],c.text_template=["sqrt(",")"],c.redraw=function(){var a=this.lastChild.jQ;r(a.prev(),1,a.innerHeight()/+a.css("fontSize").slice(0,-2)-.1)},q.sqrt=q["√"]=D,c=E.prototype=new D,c.html_template=['<span class="block"><span class="sqrt-prefix">&radic;</span></span>','<sup class="nthroot"></sup>','<span class="sqrt-stem"></span>'],c.text_template=["sqrt[","](",")"],c.latex=function(){return"\\sqrt["+this.firstChild.latex()+"]{"+this.lastChild.latex()+"}"},q.nthroot=E,c=F.prototype=new h,c.initBlocks=function(a){this.firstChild=this.lastChild=a&&a.blockify()||new j,this.firstChild.parent=this,this.firstChild.jQ=this.jQ.children(":eq(1)").data(d,{block:this.firstChild}).append(this.firstChild.jQ);var b=this.blockjQ=this.firstChild.jQ;this.bracketjQs=b.prev().add(b.next())},c.latex=function(){return this.cmd+this.firstChild.latex()+this.end},c.redraw=function(){var a=this.blockjQ.outerHeight()/+this.blockjQ.css("fontSize").slice(0,-2);r(this.bracketjQs,e(1+.2*(a-1),1.2),1.05*a)},q.lbrace=p["{"]=x(F,function(a){F.call(this,"{","}","\\{","\\}",a)}),q.langle=q.lang=x(F,function(a){F.call(this,"&lang;","&rang;","\\langle ","\\rangle ",a)}),c=G.prototype=new F,c.placeCursor=function(a){!this.next&&this.parent.parent&&this.parent.parent.end===this.end&&this.firstChild.isEmpty()?a.backspace().insertAfter(this.parent.parent):this.firstChild.blur()},q.rbrace=p["}"]=x(G,function(a){G.call(this,"{","}","\\{","\\}",a)}),q.rangle=q.rang=x(G,function(a){G.call(this,"&lang;","&rang;","\\langle ","\\rangle ",a)}),H.prototype=F.prototype,q.lparen=p["("]=x(H,function(a){H.call(this,"(",")",a)}),q.lbrack=q.lbracket=p["["]=x(H,function(a){H.call(this,"[","]",a)}),I.prototype=G.prototype,q.rparen=p[")"]=x(I,function(a){I.call(this,"(",")",a)}),q.rbrack=q.rbracket=p["]"]=x(I,function(a){I.call(this,"[","]",a)}),c=J.prototype=new H,c.placeCursor=function(a){!this.next&&this.parent.parent&&this.parent.parent.end===this.end&&this.firstChild.isEmpty()?a.backspace().insertAfter(this.parent.parent):a.appendTo(this.firstChild)},q.lpipe=q.rpipe=p["|"]=J,c=K.prototype=new h,c.cmd="\\text",c.html_template=['<span class="text"></span>'],c.text_template=['"','"'],c.initBlocks=function(){this.firstChild=this.lastChild=this.jQ.data(d).block=new L,this.firstChild.parent=this,this.firstChild.jQ=this.jQ.append(this.firstChild.jQ)},c.placeCursor=function(a){(this.cursor=a).appendTo(this.firstChild);if(this.replacedText)for(var b=0;b<this.replacedText.length;b+=1)this.write(this.replacedText.charAt(b))},c.write=function(a){this.cursor.insertNew(new S(a))},c.keydown=function(a){return!this.cursor.selection&&(a.which===8&&!this.cursor.prev||a.which===46&&!this.cursor.next)?(this.isEmpty()&&this.cursor.insertAfter(this),!1):this.parent.keydown(a)},c.textInput=function(a){this.cursor.deleteSelection();if(a!=="$")this.write(a);else if(this.isEmpty())this.cursor.insertAfter(this).backspace().insertNew(new S("\\$","$"));else if(!this.cursor.next)this.cursor.insertAfter(this);else if(!this.cursor.prev)this.cursor.insertBefore(this);else{var b=new K(new k(this.firstChild,this.cursor.prev));b.placeCursor=function(a){this.prev=0,delete this.placeCursor,this.placeCursor(a)},b.firstChild.focus=function(){return this},this.cursor.insertAfter(this).insertNew(b),b.prev=this,this.cursor.insertBefore(b),delete b.firstChild.focus}},c=L.prototype=new j,c.blur=function(){this.jQ.removeClass("hasCursor");if(this.isEmpty()){var a=this.parent,b=a.cursor;b.parent===this?this.jQ.addClass("empty"):(b.hide(),a.remove(),b.next===a?b.next=a.next:b.prev===a&&(b.prev=a.prev),b.show().redraw())}return this},c.focus=function(){j.prototype.focus.call(this);var a=this.parent;if(a.next.cmd===a.cmd){var b=this,c=a.cursor,d=a.next.firstChild;d.eachChild(function(a){a.parent=b,a.jQ.appendTo(b.jQ)}),this.lastChild?this.lastChild.next=d.firstChild:this.firstChild=d.firstChild,d.firstChild.prev=this.lastChild,this.lastChild=d.lastChild,d.parent.remove(),c.prev?c.insertAfter(c.prev):c.prependTo(this),c.redraw()}else if(a.prev.cmd===a.cmd){var c=a.cursor;c.prev?a.prev.firstChild.focus():c.appendTo(a.prev.firstChild)}return this},p.$=q.text=q.textnormal=q.textrm=q.textup=q.textmd=K,q.em=q.italic=q.italics=q.emph=q.textit=q.textsl=M("\\textit",'<i class="text"></i>'),q.strong=q.bold=q.textbf=M("\\textbf",'<b class="text"></b>'),q.sf=q.textsf=M("\\textsf",'<span class="sans-serif text"></span>'),q.tt=q.texttt=M("\\texttt",'<span class="monospace text"></span>'),q.textsc=M("\\textsc",'<span style="font-variant:small-caps" class="text"></span>'),q.uppercase=M("\\uppercase",'<span style="text-transform:uppercase" class="text"></span>'),q.lowercase=M("\\lowercase",'<span style="text-transform:lowercase" class="text"></span>'),c=N.prototype=new h,c.html_template=['<span class="latex-command-input">\\</span>'],c.text_template=["\\"],c.placeCursor=function(b){this.cursor=b.appendTo(this.firstChild),this.replacedFragment&&(this.jQ=this.jQ.add(this.replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(b){return a(b.target=this.nextSibling).trigger(b),!1}).insertBefore(this.jQ)))},c.latex=function(){return"\\"+this.firstChild.latex()+" "},c.keydown=function(a){return a.which===9||a.which===13?(this.renderCommand(),!1):this.parent.keydown(a)},c.textInput=function(a){if(a.match(/[a-z]/i)){this.cursor.deleteSelection(),this.cursor.insertNew(new S(a));return}this.renderCommand();if(a===" "||a==="\\"&&this.firstChild.isEmpty())return;this.cursor.parent.textInput(a)},c.renderCommand=function(){this.jQ=this.jQ.last(),this.remove(),this.next?this.cursor.insertBefore(this.next):this.cursor.appendTo(this.parent);var a=this.firstChild.latex(),b;if(a){if(!(b=q[a])){b=new K(a),b.firstChild.focus=function(){return delete this.focus,this},this.cursor.insertNew(b).insertAfter(b),this.replacedFragment&&this.replacedFragment.remove();return}b=new b(this.replacedFragment,a)}else b=new S("\\backslash ","\\");this.cursor.insertNew(b),b instanceof i&&this.replacedFragment&&this.replacedFragment.remove()},p["\\"]=N,c=O.prototype=new h,c.html_template=['<span class="block"></span>',"<span></span>","<span></span>"],c.text_template=["choose(",",",")"],c.redraw=F.prototype.redraw,q.binom=q.binomial=O,c=P.prototype=new O,c.placeCursor=C.prototype.placeCursor,q.choose=P,c=Q.prototype=new h,c.html_template=['<span class="array"></span>',"<span></span>"],c.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(a,b){return a.push(b.latex()),a}).join("\\\\")+"\\end{matrix}"},c.text=function(){return"["+this.foldChildren([],function(a,b){return a.push(b.text()),a}).join()+"]"},c.placeCursor=function(a){this.cursor=a.appendTo(this.firstChild)},c.keydown=function(b){var c=this.cursor.parent;if(c.parent===this){if(b.which===13){var e=new j;return e.parent=this,e.jQ=a("<span></span>").data(d,{block:e}).insertAfter(c.jQ),c.next?c.next.prev=e:this.lastChild=e,e.next=c.next,c.next=e,e.prev=c,this.cursor.appendTo(e).redraw(),!1}if(b.which===9&&!b.shiftKey&&!c.next){if(c.isEmpty())return c.prev?(this.cursor.insertAfter(this),delete c.prev.next,this.lastChild=c.prev,c.jQ.remove(),this.cursor.redraw(),!1):this.parent.keydown(b);var e=new j;return e.parent=this,e.jQ=a("<span></span>").data(d,{block:e}).appendTo(this.jQ),this.lastChild=e,c.next=e,e.prev=c,this.cursor.appendTo(e).redraw(),!1}if(b.which===8){if(c.isEmpty())return c.prev?(this.cursor.appendTo(c.prev),c.prev.next=c.next):(this.cursor.insertBefore(this),this.firstChild=c.next),c.next?c.next.prev=c.prev:this.lastChild=c.prev,c.jQ.remove(),this.isEmpty()?this.cursor.deleteForward():this.cursor.redraw(),!1;if(!this.cursor.prev)return!1}}return this.parent.keydown(b)},q.vector=Q,q.editable=x(n,function(){this.init("\\editable"),l(this.jQ,this.firstChild,!1,!0);var a;this.placeCursor=function(b){a=b.appendTo(this.firstChild)},this.firstChild.blur=function(){if(a.prev!==this.parent)return;delete this.blur,this.cursor.appendTo(this),j.prototype.blur.call(this)},this.latex=function(){return this.firstChild.latex()},this.text=function(){return this.firstChild.text()}}),q.f=y(i,"f",'<var class="florin">&fnof;</var>'),c=R.prototype=new i,c.text=function(){var a=this.cmd;return this.prev&&!(this.prev instanceof R)&&!(this.prev instanceof U)&&(a="*"+a),this.next&&!(this.next instanceof U)&&this.next.cmd!=="^"&&(a+="*"),a},S.prototype=i.prototype,p[" "]=y(S,"\\:"," "),q.prime=p["'"]=y(S,"'","&prime;"),T.prototype=i.prototype,q["@"]=T,q["&"]=y(T,"\\&","&"),q["%"]=y(T,"\\%","%"),q.alpha=q.beta=q.gamma=q.delta=q.zeta=q.eta=q.theta=q.iota=q.kappa=q.mu=q.nu=q.xi=q.rho=q.sigma=q.tau=q.chi=q.psi=q.omega=x(i,function(a,b){R.call(this,"\\"+b+" ","&"+b+";")}),q.phi=y(R,"\\phi ","&#981;"),q.phiv=q.varphi=y(R,"\\varphi ","&phi;"),q.epsilon=y(R,"\\epsilon ","&#1013;"),q.epsiv=q.varepsilon=y(R,"\\varepsilon ","&epsilon;"),q.piv=q.varpi=y(R,"\\varpi ","&piv;"),q.sigmaf=q.sigmav=q.varsigma=y(R,"\\varsigma ","&sigmaf;"),q.thetav=q.vartheta=q.thetasym=y(R,"\\vartheta ","&thetasym;"),q.upsilon=q.upsi=y(R,"\\upsilon ","&upsilon;"),q.gammad=q.Gammad=q.digamma=y(R,"\\digamma ","&#989;"),q.kappav=q.varkappa=y(R,"\\varkappa ","&#1008;"),q.rhov=q.varrho=y(R,"\\varrho ","&#1009;"),q.pi=q["π"]=y(T,"\\pi ","&pi;"),q.lambda=y(T,"\\lambda ","&lambda;"),q.Upsilon=q.Upsi=q.upsih=q.Upsih=y(i,"\\Upsilon ",'<var style="font-family: serif">&upsih;</var>'),q.Gamma=q.Delta=q.Theta=q.Lambda=q.Xi=q.Pi=q.Sigma=q.Phi=q.Psi=q.Omega=q.forall=x(i,function(a,b){S.call(this,"\\"+b+" ","&"+b+";")}),U.prototype=new i,c=V.prototype=new U,c.respace=function(){return this.prev?this.prev instanceof U&&this.next&&!(this.next instanceof U)?this.jQ[0].className="unary-operator":this.jQ[0].className="binary-operator":this.jQ[0].className="",this},q["+"]=y(V,"+"),q["-"]=y(V,"-","&minus;"),q.pm=q.plusmn=q.plusminus=y(V,"\\pm ","&plusmn;"),q.mp=q.mnplus=q.minusplus=y(V,"\\mp ","&#8723;"),p["*"]=q.sdot=q.cdot=y(U,"\\cdot ","&middot;"),q["="]=y(U,"=","="),q["<"]=y(U,"<","&lt;"),q[">"]=y(U,">","&gt;"),q.notin=q.sim=q.cong=q.equiv=q.oplus=q.otimes=x(U,function(a,b){U.call(this,"\\"+b+" ","&"+b+";")}),q.times=x(U,function(a,b){U.call(this,"\\times ","&times;","[x]")}),q.div=q.divide=q.divides=y(U,"\\div ","&divide;","[/]"),q.ne=q.neq=y(U,"\\ne ","&ne;"),q.ast=q.star=q.loast=q.lowast=y(U,"\\ast ","&lowast;"),q.therefor=q.therefore=y(U,"\\therefore ","&there4;"),q.cuz=q.because=y(U,"\\because ","&#8757;"),q.prop=q.propto=y(U,"\\propto ","&prop;"),q.asymp=q.approx=y(U,"\\approx ","&asymp;"),q.lt=y(U,"<","&lt;"),q.gt=y(U,">","&gt;"),q.le=q.leq=y(U,"\\le ","&le;"),q.ge=q.geq=y(U,"\\ge ","&ge;"),q.isin=q["in"]=y(U,"\\in ","&isin;"),q.ni=q.contains=y(U,"\\ni ","&ni;"),q.notni=q.niton=q.notcontains=q.doesnotcontain=y(U,"\\not\\ni ","&#8716;"),q.sub=q.subset=y(U,"\\subset ","&sub;"),q.sup=q.supset=q.superset=y(U,"\\supset ","&sup;"),q.nsub=q.notsub=q.nsubset=q.notsubset=y(U,"\\not\\subset ","&#8836;"),q.nsup=q.notsup=q.nsupset=q.notsupset=q.nsuperset=q.notsuperset=y(U,"\\not\\supset ","&#8837;"),q.sube=q.subeq=q.subsete=q.subseteq=y(U,"\\subseteq ","&sube;"),q.supe=q.supeq=q.supsete=q.supseteq=q.supersete=q.superseteq=y(U,"\\supseteq ","&supe;"),q.nsube=q.nsubeq=q.notsube=q.notsubeq=q.nsubsete=q.nsubseteq=q.notsubsete=q.notsubseteq=y(U,"\\not\\subseteq ","&#8840;"),q.nsupe=q.nsupeq=q.notsupe=q.notsupeq=q.nsupsete=q.nsupseteq=q.notsupsete=q.notsupseteq=q.nsupersete=q.nsuperseteq=q.notsupersete=q.notsuperseteq=y(U,"\\not\\supseteq ","&#8841;"),W.prototype=new i,q.sum=q.summation=y(W,"\\sum ","&sum;"),q.prod=q.product=y(W,"\\prod ","&prod;"),q.coprod=q.coproduct=y(W,"\\coprod ","&#8720;"),q.int=q.integral=q["∫"]=y(W,"\\int ","&int;"),q.N=q.naturals=q.Naturals=y(S,"\\mathbb{N}","&#8469;"),q.P=q.primes=q.Primes=q.projective=q.Projective=q.probability=q.Probability=y(S,"\\mathbb{P}","&#8473;"),q.Z=q.integers=q.Integers=y(S,"\\mathbb{Z}","&#8484;"),q.Q=q.rationals=q.Rationals=y(S,"\\mathbb{Q}","&#8474;"),q.R=q.reals=q.Reals=y(S,"\\mathbb{R}","&#8477;"),q.C=q.complex=q.Complex=q.complexes=q.Complexes=q.complexplane=q.Complexplane=q.ComplexPlane=y(S,"\\mathbb{C}","&#8450;"),q.H=q.Hamiltonian=q.quaternions=q.Quaternions=y(S,"\\mathbb{H}","&#8461;"),q.quad=q.emsp=y(S,"\\quad ","    "),q.qquad=y(S,"\\qquad ","        "),q.diamond=y(S,"\\diamond ","&#9671;"),q.bigtriangleup=y(S,"\\bigtriangleup ","&#9651;"),q.ominus=y(S,"\\ominus ","&#8854;"),q.uplus=y(S,"\\uplus ","&#8846;"),q.bigtriangledown=y(S,"\\bigtriangledown ","&#9661;"),q.sqcap=y(S,"\\sqcap ","&#8851;"),q.triangleleft=y(S,"\\triangleleft ","&#8882;"),q.sqcup=y(S,"\\sqcup ","&#8852;"),q.triangleright=y(S,"\\triangleright ","&#8883;"),q.odot=y(S,"\\odot ","&#8857;"),q.bigcirc=y(S,"\\bigcirc ","&#9711;"),q.dagger=y(S,"\\dagger ","&#0134;"),q.ddagger=y(S,"\\ddagger ","&#135;"),q.wr=y(S,"\\wr ","&#8768;"),q.amalg=y(S,"\\amalg ","&#8720;"),q.models=y(S,"\\models ","&#8872;"),q.prec=y(S,"\\prec ","&#8826;"),q.succ=y(S,"\\succ ","&#8827;"),q.preceq=y(S,"\\preceq ","&#8828;"),q.succeq=y(S,"\\succeq ","&#8829;"),q.simeq=y(S,"\\simeq ","&#8771;"),q.mid=y(S,"\\mid ","&#8739;"),q.ll=y(S,"\\ll ","&#8810;"),q.gg=y(S,"\\gg ","&#8811;"),q.parallel=y(S,"\\parallel ","&#8741;"),q.bowtie=y(S,"\\bowtie ","&#8904;"),q.sqsubset=y(S,"\\sqsubset ","&#8847;"),q.sqsupset=y(S,"\\sqsupset ","&#8848;"),q.smile=y(S,"\\smile ","&#8995;"),q.sqsubseteq=y(S,"\\sqsubseteq ","&#8849;"),q.sqsupseteq=y(S,"\\sqsupseteq ","&#8850;"),q.doteq=y(S,"\\doteq ","&#8784;"),q.frown=y(S,"\\frown ","&#8994;"),q.vdash=y(S,"\\vdash ","&#8870;"),q.dashv=y(S,"\\dashv ","&#8867;"),q.longleftarrow=y(S,"\\longleftarrow ","&#8592;"),q.longrightarrow=y(S,"\\longrightarrow ","&#8594;"),q.Longleftarrow=y(S,"\\Longleftarrow ","&#8656;"),q.Longrightarrow=y(S,"\\Longrightarrow ","&#8658;"),q.longleftrightarrow=y(S,"\\longleftrightarrow ","&#8596;"),q.updownarrow=y(S,"\\updownarrow ","&#8597;"),q.Longleftrightarrow=y(S,"\\Longleftrightarrow ","&#8660;"),q.Updownarrow=y(S,"\\Updownarrow ","&#8661;"),q.mapsto=y(S,"\\mapsto ","&#8614;"),q.nearrow=y(S,"\\nearrow ","&#8599;"),q.hookleftarrow=y(S,"\\hookleftarrow ","&#8617;"),q.hookrightarrow=y(S,"\\hookrightarrow ","&#8618;"),q.searrow=y(S,"\\searrow ","&#8600;"),q.leftharpoonup=y(S,"\\leftharpoonup ","&#8636;"),q.rightharpoonup=y(S,"\\rightharpoonup ","&#8640;"),q.swarrow=y(S,"\\swarrow ","&#8601;"),q.leftharpoondown=y(S,"\\leftharpoondown ","&#8637;"),q.rightharpoondown=y(S,"\\rightharpoondown ","&#8641;"),q.nwarrow=y(S,"\\nwarrow ","&#8598;"),q.ldots=y(S,"\\ldots ","&#8230;"),q.cdots=y(S,"\\cdots ","&#8943;"),q.vdots=y(S,"\\vdots ","&#8942;"),q.ddots=y(S,"\\ddots ","&#8944;"),q.surd=y(S,"\\surd ","&#8730;"),q.triangle=y(S,"\\triangle ","&#9653;"),q.ell=y(S,"\\ell ","&#8467;"),q.top=y(S,"\\top ","&#8868;"),q.flat=y(S,"\\flat ","&#9837;"),q.natural=y(S,"\\natural ","&#9838;"),q.sharp=y(S,"\\sharp ","&#9839;"),q.wp=y(S,"\\wp ","&#8472;"),q.bot=y(S,"\\bot ","&#8869;"),q.clubsuit=y(S,"\\clubsuit ","&#9827;"),q.diamondsuit=y(S,"\\diamondsuit ","&#9826;"),q.heartsuit=y(S,"\\heartsuit ","&#9825;"),q.spadesuit=y(S,"\\spadesuit ","&#9824;"),q.oint=y(S,"\\oint ","&#8750;"),q.bigcap=y(S,"\\bigcap ","&#8745;"),q.bigcup=y(S,"\\bigcup ","&#8746;"),q.bigsqcup=y(S,"\\bigsqcup ","&#8852;"),q.bigvee=y(S,"\\bigvee ","&#8744;"),q.bigwedge=y(S,"\\bigwedge ","&#8743;"),q.bigodot=y(S,"\\bigodot ","&#8857;"),q.bigotimes=y(S,"\\bigotimes ","&#8855;"),q.bigoplus=y(S,"\\bigoplus ","&#8853;"),q.biguplus=y(S,"\\biguplus ","&#8846;"),q.lfloor=y(S,"\\lfloor ","&#8970;"),q.rfloor=y(S,"\\rfloor ","&#8971;"),q.lceil=y(S,"\\lceil ","&#8968;"),q.rceil=y(S,"\\rceil ","&#8969;"),q.slash=y(S,"\\slash ","&#47;"),q.opencurlybrace=y(S,"\\opencurlybrace ","&#123;"),q.closecurlybrace=y(S,"\\closecurlybrace ","&#125;"),q.caret=y(S,"\\caret ","^"),q.underscore=y(S,"\\underscore ","_"),q.backslash=y(S,"\\backslash ","\\"),q.vert=y(S,"|"),q.perp=q.perpendicular=y(S,"\\perp ","&perp;"),q.nabla=q.del=y(S,"\\nabla ","&nabla;"),q.hbar=y(S,"\\hbar ","&#8463;"),q.AA=q.Angstrom=q.angstrom=y(S,"\\text\\AA ","&#8491;"),q.ring=q.circ=q.circle=y(S,"\\circ ","&#8728;"),q.bull=q.bullet=y(S,"\\bullet ","&bull;"),q.setminus=q.smallsetminus=y(S,"\\setminus ","&#8726;"),q.not=q.neg=y(S,"\\neg ","&not;"),q.dots=q.ellip=q.hellip=q.ellipsis=q.hellipsis=y(S,"\\dots ","&hellip;"),q.converges=q.darr=q.dnarr=q.dnarrow=q.downarrow=y(S,"\\downarrow ","&darr;"),q.dArr=q.dnArr=q.dnArrow=q.Downarrow=y(S,"\\Downarrow ","&dArr;"),q.diverges=q.uarr=q.uparrow=y(S,"\\uparrow ","&uarr;"),q.uArr=q.Uparrow=y(S,"\\Uparrow ","&uArr;"),q.to=y(U,"\\to ","&rarr;"),q.rarr=q.rightarrow=y(S,"\\rightarrow ","&rarr;"),q.implies=y(U,"\\Rightarrow ","&rArr;"),q.rArr=q.Rightarrow=y(S,"\\Rightarrow ","&rArr;"),q.gets=y(U,"\\gets ","&larr;"),q.larr=q.leftarrow=y(S,"\\leftarrow ","&larr;"),q.impliedby=y(U,"\\Leftarrow ","&lArr;"),q.lArr=q.Leftarrow=y(S,"\\Leftarrow ","&lArr;"),q.harr=q.lrarr=q.leftrightarrow=y(S,"\\leftrightarrow ","&harr;"),q.iff=y(U,"\\Leftrightarrow ","&hArr;"),q.hArr=q.lrArr=q.Leftrightarrow=y(S,"\\Leftrightarrow ","&hArr;"),q.Re=q.Real=q.real=y(S,"\\Re ","&real;"),q.Im=q.imag=q.image=q.imagin=q.imaginary=q.Imaginary=y(S,"\\Im ","&image;"),q.part=q.partial=y(S,"\\partial ","&part;"),q.inf=q.infin=q.infty=q.infinity=y(S,"\\infty ","&infin;"),q.alef=q.alefsym=q.aleph=q.alephsym=y(S,"\\aleph ","&alefsym;"),q.xist=q.xists=q.exist=q.exists=y(S,"\\exists ","&exist;"),q.and=q.land=q.wedge=y(S,"\\wedge ","&and;"),q.or=q.lor=q.vee=y(S,"\\vee ","&or;"),q.o=q.O=q.empty=q.emptyset=q.oslash=q.Oslash=q.nothing=q.varnothing=y(U,"\\varnothing ","&empty;"),q.cup=q.union=y(S,"\\cup ","&cup;"),q.cap=q.intersect=q.intersection=y(S,"\\cap ","&cap;"),q.deg=q.degree=y(S,"^\\circ ","&deg;"),q.ang=q.angle=y(S,"\\angle ","&ang;"),c=X.prototype=new i,c.respace=function(){this.jQ[0].className=this.next instanceof A||this.next instanceof F?"":"non-italicized-function"},q.ln=q.lg=q.log=q.span=q.proj=q.det=q.dim=q.min=q.max=q.mod=q.lcm=q.gcd=q.gcf=q.hcf=q.lim=X,function(){var a=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(var b in a)q[a[b]]=q[a[b]+"h"]=q["a"+a[b]]=q["arc"+a[b]]=q["a"+a[b]+"h"]=q["arc"+a[b]+"h"]=X}(),c=Y.prototype,c.prev=0,c.next=0,c.parent=0,c.show=function(){return this.jQ=this._jQ.removeClass("blink"),"intervalId"in this?clearInterval(this.intervalId):(this.next?this.selection&&this.selection.prev===this.prev?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this.next.jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this},c.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=a(),this},c.redraw=function(){for(var a=this.parent;a;a=a.parent)a.redraw&&a.redraw()},c.insertAt=function(a,b,c){var d=this.parent;this.parent=a,this.prev=b,this.next=c,d.blur()},c.insertBefore=function(a){return this.insertAt(a.parent,a.prev,a),this.parent.jQ.addClass("hasCursor"),this.jQ.insertBefore(a.jQ.first()),this},c.insertAfter=function(a){return this.insertAt(a.parent,a,a.next),this.parent.jQ.addClass("hasCursor"),this.jQ.insertAfter(a.jQ.last()),this},c.prependTo=function(a){return this.insertAt(a,0,a.firstChild),a.textarea?this.jQ.insertAfter(a.textarea):this.jQ.prependTo(a.jQ),a.focus(),this},c.appendTo=function(a){return this.insertAt(a,a.lastChild,0),this.jQ.appendTo(a.jQ),a.focus(),this},c.hopLeft=function(){return this.jQ.insertBefore(this.prev.jQ.first()),this.next=this.prev,this.prev=this.prev.prev,this},c.hopRight=function(){return this.jQ.insertAfter(this.next.jQ.last()),this.prev=this.next,this.next=this.next.next,this},c.moveLeft=function(){return this.selection?this.insertBefore(this.selection.prev.next||this.parent.firstChild).clearSelection():this.prev?this.prev.lastChild?this.appendTo(this.prev.lastChild):this.hopLeft():this.parent.prev?this.appendTo(this.parent.prev):this.parent!==this.root&&this.insertBefore(this.parent.parent),this.show()},c.moveRight=function(){return this.selection?this.insertAfter(this.selection.next.prev||this.parent.lastChild).clearSelection():this.next?this.next.firstChild?this.prependTo(this.next.firstChild):this.hopRight():this.parent.next?this.prependTo(this.parent.next):this.parent!==this.root&&this.insertAfter(this.parent.parent),this.show()},c.seek=function(a,b,c){var e=this.clearSelection();if(a.hasClass("empty"))return e.prependTo(a.data(d).block),e;var f=a.data(d);if(f){if(f.cmd&&!f.block)return a.outerWidth()>2*(b-a.offset().left)?e.insertBefore(f.cmd):e.insertAfter(f.cmd),e}else a=a.parent(),f=a.data(d),f||(f={block:e.root});f.cmd?e.insertAfter(f.cmd):e.appendTo(f.block);var g=e.jQ.offset().left-b,h;do e.moveLeft(),h=g,g=e.jQ.offset().left-b;while(g>0&&(e.prev||e.parent!==e.root));return-g>h&&e.moveRight(),e},c.writeLatex=function(a){return this.deleteSelection(),a=a&&a.match(/\\text\{([^}]|\\\})*\}|\\[a-z]*|[^\s]/ig)||0,function c(d){while(a.length){var e=a.shift();if(!e||e==="}")return;var f;if(e.slice(0,6)==="\\text{"){f=new K(e.slice(6,-1)),d.insertNew(f).insertAfter(f);continue}if(e==="\\left"||e==="\\right"){e=a.shift(),e==="\\"&&(e=a.shift()),d.insertCh(e),f=d.prev||d.parent.parent;if(d.prev)return;a.unshift("{")}else if(/^\\[a-z]+$/i.test(e)){e=e.slice(1);var f=q[e];if(!f){f=new K(e),d.insertNew(f).insertAfter(f);continue}d.insertNew(f=new f(b,e))}else e.match(/[a-eg-zA-Z]/)?f=new R(e):(f=q[e])?f=new f:f=new S(e),d.insertNew(f);f.eachChild(function(b){d.appendTo(b);var e=a.shift();if(!e)return!1;e==="{"?c(d):d.insertCh(e)}),d.insertAfter(f)}}(this),this.hide()},c.write=function(a){return this.show().insertCh(a)},c.insertCh=function(a){this.selection&&(this.prev=this.selection.prev,this.next=this.selection.next);var b;return a.match(/^[a-eg-zA-Z]$/)?b=new R(a):(b=p[a]||q[a])?b=new b(this.selection,a):b=new S(a),this.selection&&(b instanceof i&&this.selection.remove(),delete this.selection),this.insertNew(b)},c.insertNew=function(a){return a.insertAt(this),this},c.unwrapGramp=function(){var a=this.parent.parent,b=a.parent,c=a.prev,d=this;a.eachChild(function(d){if(d.isEmpty())return;d.eachChild(function(c){c.parent=b,c.jQ.insertBefore(a.jQ.first())}),d.firstChild.prev=c,c?c.next=d.firstChild:b.firstChild=d.firstChild,c=d.lastChild}),c.next=a.next,a.next?a.next.prev=c:b.lastChild=c;if(!this.next)if(this.prev)this.next=this.prev.next;else while(!this.next){this.parent=this.parent.next;if(!this.parent){this.next=a.next,this.parent=b;break}this.next=this.parent.firstChild}this.next?this.insertBefore(this.next):this.appendTo(b),a.jQ.remove(),a.prev&&a.prev.respace(),a.next&&a.next.respace()},c.backspace=function(){if(!this.deleteSelection())if(this.prev)this.prev.isEmpty()?this.prev=this.prev.remove().prev:this.selectLeft();else if(this.parent!==this.root){if(this.parent.parent.isEmpty())return this.insertAfter(this.parent.parent).backspace();this.unwrapGramp()}return this.prev&&this.prev.respace(),this.next&&this.next.respace(),this.redraw(),this},c.deleteForward=function(){if(!this.deleteSelection())if(this.next)this.next.isEmpty()?this.next=this.next.remove().next:this.selectRight();else if(this.parent!==this.root){if(this.parent.parent.isEmpty())return this.insertBefore(this.parent.parent).deleteForward();this.unwrapGramp()}return this.prev&&this.prev.respace(),this.next&&this.next.respace(),this.redraw(),this},c.selectFrom=function(a){var b=this,c=a;a:for(;;){for(var d=this;d!==b.parent.parent;d=d.parent.parent)if(d.parent===c.parent){f=d,g=c;break a}for(var e=a;e!==c.parent.parent;e=e.parent.parent)if(b.parent===e.parent){f=b,g=e;break a}b.parent.parent&&(b=b.parent.parent),c.parent.parent&&(c=c.parent.parent)}var f,g,h;if(f.next!==g){for(var i=f;i;i=i.next)if(i===g.prev){h=!0;break}h||(h=g,g=f,f=h)}this.hide().selection=new Z(f.parent,f.prev,g.next),this.insertAfter(g.next.prev||g.parent.lastChild),this.root.selectionChanged()},c.selectLeft=function(){if(this.selection)if(this.selection.prev===this.prev)this.prev?(this.hopLeft().next.jQ.prependTo(this.selection.jQ),this.selection.prev=this.prev):this.parent!==this.root&&this.insertBefore(this.parent.parent).selection.levelUp();else{this.prev.jQ.insertAfter(this.selection.jQ),this.hopLeft().selection.next=this.next;if(this.selection.prev===this.prev){this.deleteSelection();return}}else{if(this.prev)this.hopLeft();else{if(this.parent===this.root)return;this.insertBefore(this.parent.parent)}this.hide().selection=new Z(this.parent,this.prev,this.next.next)}this.root.selectionChanged()},c.selectRight=function(){if(this.selection)if(this.selection.next===this.next)this.next?(this.hopRight().prev.jQ.appendTo(this.selection.jQ),this.selection.next=this.next):this.parent!==this.root&&this.insertAfter(this.parent.parent).selection.levelUp();else{this.next.jQ.insertBefore(this.selection.jQ),this.hopRight().selection.prev=this.prev;if(this.selection.next===this.next){this.deleteSelection();return}}else{if(this.next)this.hopRight();else{if(this.parent===this.root)return;this.insertAfter(this.parent.parent)}this.hide().selection=new Z(this.parent,this.prev.prev,this.next)}this.root.selectionChanged()},c.clearSelection=function(){return this.show().selection&&(this.selection.clear(),delete this.selection,this.root.selectionChanged()),this},c.deleteSelection=function(){return this.show().selection?(this.prev=this.selection.prev,this.next=this.selection.next,this.selection.remove(),delete this.selection,this.root.selectionChanged(),!0):!1},c=Z.prototype=new k,c.jQinit=function(a){this.jQ=a.wrapAll('<span class="selection"></span>').parent()},c.levelUp=function(){return this.clear().jQinit(this.parent.parent.jQ),this.prev=this.parent.parent.prev,this.next=this.parent.parent.next,this.parent=this.parent.parent.parent,this},c.clear=function(){return this.jQ.replaceWith(this.jQ.children()),this},c.blockify=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),k.prototype.blockify.call(this)},c.detach=function(){var a=k.prototype.blockify.call(this);return this.blockify=function(){return this.jQ.replaceWith(a.jQ=this.jQ=this.jQ.children()),a},this},a.fn.mathquill=function(b,c){switch(b){case"redraw":return this.find(":not(:has(:first))").each(function(){var b=a(this).data(d);b&&(b.cmd||b.block)&&Y.prototype.redraw.call(b.cmd||b.block)}),this;case"revert":return this.each(function(){var b=a(this).data(d);b&&b.revert&&b.revert()});case"latex":if(arguments.length>1)return this.each(function(){var b=a(this).data(d);b&&b.block&&b.block.renderLatex&&b.block.renderLatex(c)});var e=this.data(d);return e&&e.block&&e.block.latex();case"text":var e=this.data(d);return e&&e.block&&e.block.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1)return this.each(function(){var b=a(this).data(d),e=b&&b.block,f=e&&e.cursor;f&&(f.writeLatex(c),e.blur())});default:var f=b==="textbox",g=f||b==="editable",h=f?o:m;return this.each(function(){l(a(this),new h,f,g)})}},a(function(){a(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable"),a(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox"),a(".mathquill-embedded-latex").mathquill()})})();
App=new Ext.util.Observable,Ext.apply(App,{name:"DyNAMiC Workbench",nameFormatted:"<b>DyNAMiC</b> Workbench",version:"unknown",isPreRelease:!0,getFullTitle:function(){return App.name+" ("+App.version+")"},getFullTitleFormatted:function(){return'<span class="app-title"><span>'+App.nameFormatted+"</span> ("+App.version+")</span>"},nextId:function(){var a=String((new Date).getTime()).substr(4),b="ABCDEFGHIJKLMNOPQRSTUVWXYZ";for(var c=0;c<4;c++)a+=b.charAt(Math.floor(Math.random()*26));return a},bootstrap:function(){App.fireEvent("load")}}),App.loadData=function(a){App._data=a},App.getLoadedData=function(){return App._data},App.getDefaultWorkspace=function(){return App.defaultWorkspace},App.Endpoints=App.endpoints=function(){var a={};return{getEndpoint:function(b){return App.baseUrl+"/"+a[b]},setEndpoint:function(b,c){a[b]=c}}}(),App.getEndpoint=App.endpoints.getEndpoint,App.setEndpoint=App.endpoints.setEndpoint,App.Ribbon=App.ribbon=function(){var a=!1;return{getRibbonItems:function(){return a},setRibbonItems:function(b){a=b}}}(),App.getRibbonItems=App.ribbon.getRibbonItems,App.setRibbonItems=App.ribbon.setRibbonItems,App.Path=App.path={addExt:function(a,b){return _.last(a.split("."))!=b?a+"."+b:a},removeExt:function(a){return App.path.basename(a).indexOf(".")!=-1?(a=a.split("."),a.pop(),a.join(".")):a},isFolder:function(a){return a&&!!App.Path.extname(a)},join:function(){return arguments.length>1?paths=arguments:paths=arguments[0],_.flatten(_.map(paths,function(a){return a.split("/")})).join("/")},extname:function(a){return _.last(App.Path.basename(a).split("."))},getExt:function(a){return App.Path.extname(a)},basename:function(a){var b=a.split("/");return b.length>0?_.last(b):a},pop:function(a,b){Ext.isDefined(b)||(b=1);var c=a.split("/");return c.length>b?c.slice(0,c.length-1).join("/"):a},sameDirectory:function(a,b){return App.Path.join(App.Path.pop(a),b)},repostfix:function(a,b){return App.path.basename(a).indexOf(".")!=-1?(a=a.split("."),a.pop(),a.concat([b]).join(".")):[a,b].join(".")}},App.User={id:-1,name:!1,email:!1,isLoggedIn:function(){return App.User.id!=-1},isGuest:function(){return!!App.User.name&&App.User.name.match(/guest/g)!=null},setUser:function(a){a.id&&(App.User.id=a.id,App.User.name=a.name,App.User.email=a.email)}},Ext.define("App.Files",{singleton:!0,getType:function(a){return App.fileTypes[a]},getDescription:function(a){return a==""?"":this.getTypeProperty(a,"description")},getDesc:function(a){return this.getDescription(a)},getTypeDescription:function(a){return this.getDescription(a)},getTypeDesc:function(a){return this.getDescription(a)},getName:function(a){return a==""?"Folder":this.getTypeProperty(a,"name")},getTypeName:function(a){return this.getName(a)},getTypeProperty:function(a,b){var c=this.getType(a);if(c)return c[b]}}),Ext.define("App.TaskRunner",{statics:{loadTools:function(a){_.each(a,function(a){var b=_.compact(a.route.split("/")),c=a.iconCls||"app";b[b.length-1]=_.last(b).capitalize(),b=b.join("."),Ext.define("App.TaskRunner."+b,Ext.apply(a,{extend:"App.TaskRunner.Task"},{iconCls:c}))})},run:function(a,b,c,d,e){b||(b={}),e||(e={}),!!c&&!!d&&(c=Ext.bind(c,d));if(Ext.ClassManager.get(["App.TaskRunner",a].join("."))){var f=new Date,g="local",h=Ext.create("App.TaskRunner."+a,{tool:a,startDate:f,target:g});return _.extend(h,e),this.taskStore.add(h),h.start(b,c),h}return!1},get:function(a){return Ext.ClassManager.get(["App.TaskRunner",Ext.String.capitalize(a)].join("."))},getToolProperty:function(a,b){var c=App.TaskRunner.get(a);if(c)return c.prototype[b]},register:function(a,b){this.serverTools[a]=b}}}),App.runTask=function(){return App.TaskRunner.run.apply(App.TaskRunner,arguments)},Ext.define("App.TaskRunner.Task",{extend:"Ext.data.Model",endpoint:"",iconCls:"",timeout:36e7,fields:[{name:"tool",type:"string"},{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"target",type:"string"}],callback:function(a,b,c){return},log:function(a,b){b||(b={}),Ext.apply(b,{group:this.getGroupName(),iconCls:this.iconCls,silent:!0}),App.log(a,b)},start:function(a,b,c){this.arguments=a||{},this.callback=b||this.callback,this.onStart();var d=Ext.Ajax.request({url:this.endpoint,method:"POST",params:a,timeout:this.timeout,success:function(b){this.end(b.responseText,a,!0)},failure:function(b){this.end(b.responseText,a,!1),b.timedout==0?this.log(Ext.String.format('Error running task on tool: "{0}". Timeout at {1} s ({2} ms)',this.name,this.timeout/1e3,this.timeout)):this.log(Ext.String.format('Error running task on tool: "{0}".',this.name))},scope:this});Ext.Ajax.clearTimeout(d)},onStart:function(){this.log(Ext.String.format("Starting task '{0}' at {1} on '{2}'",this.name,this.get("startDate"),this.get("target")),{})},onEnd:function(a,b,c){this.log(a),this.log(Ext.String.format("Completed task '{0}' at {1} on '{2}'",this.name,this.get("endDate"),this.get("target")),{});if(this.arguments&&this.arguments.node){var d=App.Path.pop(this.arguments.node);App.ui.filesTree.refreshDocument(App.DocumentStore.tree.getNodeById(d),function(a,b,c){this.fireEvent("refresh",a,b,c),this.loadOnEnd&&c&&this.loadFiles(this.loadOnEnd,a),this.openOnEnd&&c&&this.openFiles(this.openOnEnd,a)},this)}},loadFiles:function(a,b){var c=a.files||[],d=[];for(var e=0;e<c.length;e++){var f=c[e],g=null;for(var h=0;h<b.length&&!g;h++)if(b[h].get("node")==f){g=b[h];break}d.push(g)}Ext.callback(a.callback,a.scope||this,[d])},openFiles:function(a,b){for(var c=0;c<a.length;c++){var d=a[c],e;for(var f=0;f<b.length&&!e;f++)b[f].get("node")==d&&(e=b[f]);e&&App.ui.filesTree.open(e)}},end:function(a,b,c){this.set("endDate",new Date),this.onEnd(a,b,c),Ext.isFunction(this.callback)&&this.callback(a,this.arguments,c)},getNameTimestamp:function(){return this.get("tool")+": "+this.get("startDate")+""},getGroupName:function(){return this.getNameTimestamp()+" ("+(this.arguments.node?this.arguments.node:"no path")+")"}}),App.TaskRunner.taskStore=Ext.create("Ext.data.Store",{model:"App.TaskRunner.Task",proxy:{type:"memory",reader:"json"},data:[]}),App.Stylesheet={Highlight:{strokeWidth:10,fill:"#FF9",stroke:"#FF9",opacity:.7,padding:0},Draw:{fill:"#fff","fill-opacity":.5,stroke:"#000","stroke-width":"1px","stroke-dasharray":"--"},Proxy:{strokeWidth:.5,stroke:"#99BBE8",fill:"#99BBE8",fillOpacity:.5,opacity:.5}},App.gluer=function(a,b){this.id=App.getId(),this.o1=a,this.o2=b,this.o1.source.on(a.eventName,this.onO1,this),this.o2.source.on(b.eventName,this.onO2,this),this.o1.source.on("destroy",this.destroy,this),this.o2.source.on("destroy",this.destroy,this),this.ignore=!1},Ext.extend(App.gluer,{onO1:function(){this.ignore||(this.ignore=!0,this.o2.handler.apply(this.o2.source,arguments),this.ignore=!1)},onO2:function(){this.ignore||(this.ignore=!0,this.o1.handler.apply(this.o1.source,arguments),this.ignore=!1)},destroy:function(){this.o1.source.un(o1.eventName,this.onO1,this),this.o2.source.un(o2.eventName,this.onO2,this),this.o1.source.un("destroy",this.destroy,this),this.o2.source.un("destroy",this.destroy,this),App.unglue(this.id,!1)}}),App.glue=function(){var a={};return App.unglue=function(b,c){c=c||!1,c&&a[b]&&a[b].destroy(),delete a[b]},function(b,c){var d=new App.gluer(b,c);a[d.id]=d}}(),App.mixin=function(a,b){Ext.override(a,b.prototype)},App.Registry=function(a){this.tname=a;var b={};Ext.apply(this,{register:function(a,c){b[a]=c,c.prototype[this.tname]=a,c[this.tname]=a},getType:function(a){return b[a]},hasType:function(a){return this.getType(a)!=0},create:function(a,b){if(this.hasType(a)){var c=this.getType(a);return new c(b)}}})};
App.scriptsUrl="/scripts",App.setEndpoint("upload","upload"),App.setEndpoint("save","save"),App.setEndpoint("load","load");
Ext.define("App.Document",{extend:"Ext.data.Model",fields:[{name:"text",type:"string"},{name:"type",type:"string"},{name:"trigger",type:"string"},{name:"node",type:"string"},{name:"size",type:"int"},{name:"preventRename",type:"bool",defaultValue:!1}],isLeaf:!0,iconCls:"document-error",getDocumentPath:function(){return this.get("node")},getBasename:function(){return App.Path.basename(this.getDocumentPath())},getExt:function(){return App.Path.extname(this.getDocumentPath())},getFolder:function(){return this.isLeaf()&&!this.isRoot()?this.parentNode:this},getSibling:function(a,b,c){return c=c||!1,this.parentNode?this.parentNode.findChildBy.apply(this.parentNode,arguments):!1},getSiblingByName:function(a){return this.getSibling(function(b){return b.get("text")==a})},createSibling:function(a){var b=this.parentNode?this.parentNode:this;return App.ui.filesTree.newFile(b,a)},download:function(){var a=Ext.urlAppend(App.getEndpoint("load"),Ext.Object.toQueryString({node:this.getDocumentPath(),download:!0}));window.open(a,"_blank")},loadBody:function(a){(function(a,b){Ext.applyIf(a,{success:function(){},failure:function(){},scope:window}),req={url:App.getEndpoint("load"),method:"GET",params:{node:b.getDocumentPath()},success:function(c){Ext.bind(a.success,a.scope)(c.responseText,b,c)},failure:function(c){Ext.bind(a.failure,a.scope)(c.responseText,b,c)}},Ext.Ajax.request(req)})(a,this)},saveBody:function(a,b){(function(a,b,c){Ext.applyIf(b,{success:function(){},failure:function(){},scope:window}),req={url:App.getEndpoint("save"),method:"POST",params:{data:a,node:c.getDocumentPath()},success:function(a){Ext.bind(b.success,b.scope)(a.responseText,c,a)},failure:function(a){Ext.bind(b.failure,b.scope)(a.responseText,c,a)}},Ext.Ajax.request(req)})(a,b,this)},checkout:function(a){this.app=a,this.fireEvent("checkout",this,a)}}),Ext.define("App.DocumentTreeStore",{constructor:function(){Ext.apply(this,{proxy:{batchActions:!1,type:"ajax",api:{create:"/new",read:"/tree",update:"/rename",destroy:"/delete"},reader:{type:"json"},writer:{type:"json",nameProperty:"name"},listeners:{exception:function(a,b,c){_.each(c.getRecords(),function(a){a.set("iconCls","document-error"),a.set("isLeaf","false")})}}}}),this.callParent(arguments)},extend:"Ext.data.TreeStore",model:"App.Document",folderSort:!0,autoSync:!0,batchActions:!1,checkout:function(a,b){},afterEdit:function(a){a.fireEvent("edit",a),this.callParent(arguments)},afterReject:function(a){a.fireEvent("reject",a),this.callParent(arguments)},afterCommit:function(a){a.fireEvent("commit",a),this.callParent(arguments)}});
Ext.require("Ext.grid.property.Store"),Ext.grid.property.Store.override({getProperty:function(a){return Ext.isNumber(a)?this.store.getAt(a):this.store.getById(a)},setValue:function(a,b,c){var d=this.getRec(a);d?(d.set("value",b),this.source[a]=b):c&&(this.source[a]=b,d=new Ext.grid.property.Property({name:a,value:b},a),this.add(d))},remove:function(a){var b=this.getRec(a);b&&(this.remove(b),delete this.source[a])},getRec:function(a){return this.getById(a)}}),Ext.require("Ext.grid.plugin.CellEditing"),Ext.define("Ext.grid.plugin.CellEditing2",{extend:"Ext.grid.plugin.CellEditing",onEditComplete:function(a,b,c){var d=this,e=d.grid,f=e.getSelectionModel(),g=d.getActiveColumn(),h;if(g){h=d.context.record,d.setActiveEditor(null),d.setActiveColumn(null),d.setActiveRecord(null);if(!d.validateEdit())return;h.isEqual(b,c)||h.set(g.dataIndex,b),f.select([f.getLastSelected()]),f.setLastFocused(f.getLastSelected()),e.getView().getEl(g).focus(),d.context.value=b,d.fireEvent("edit",d,d.context)}}});
Ext.define("Machine.core.Serializable",{extend:"Ext.util.Observable",alias:"SerializableObject",constructor:function(){this.callParent(arguments),this._readable={},this._writeable={},this._serializable={},this._userProperties={},this._previous={},this.addEvents("change","destroy","meta")},getId:function(){return this.id?this.id:(this.id=App.nextId(),this.id)},hasWType:function(){return this.isWType.apply(this,arguments)},isWType:function(a,b){if(Ext.isFunction(a))a=a.wtype;else if(Ext.isObject(a))a=a.constructor.wtype;else if(Ext.isArray(a)){var c="/"+this.getWTypes()+"/";return b?_.reduce(a,function(a,b){return a||this.constructor.wtype==b},!1):_.reduce(a,function(a,b){return a||c.indexOf("/"+b+"/")!=-1},!1)}return b?this.constructor.wtype==a:("/"+this.getWTypes()+"/").indexOf("/"+a+"/")!=-1},getWTypes:function(){var a=this.constructor;if(!a.wtypes){var b=[],c=this;while(c&&c.wtype)b.unshift(c.wtype),c=c.superclass;a.wtypeChain=b,a.wtypes=b.join("/")}return a.wtypes},serialize:function(a){a=a||!1;var b={wtype:this.wtype,id:this.getId()};if(!a){var c;for(var d in this._serializable)c=this.get(d),c=Workspace.Components.serialize(c,!0),b[d]=c}else b.isReference=!0;return b},deserialize:function(a){for(var b in a)this.set(b,Workspace.Utils.deserialize(a[b]))},getReadableHash:function(){var a={},b;for(var c in this._readable)b=this.get(c),b&&b.getId&&(b=b.getId()),a[c]=b;return a},exposeAll:function(a){for(var b in a)this.expose(b,!0,!0,!0,!0)},expose:function(a,b,c,d,e){b=b||!1,c=c||!1,d=d!==!1,e=e||!1,b&&(b=Ext.isFunction(b)?b:Ext.isFunction(this[b])?this[b]:b,Ext.isFunction(b)?this._readable[a]=b:this._readable[a]=this._makeGetter(a)),c&&(c=Ext.isFunction(c)?c:Ext.isFunction(this[c])?this[c]:c,Ext.isFunction(c)?this._writeable[a]=c:this._writeable[a]=this._makeSetter(a)),d&&(this._serializable[a]=!0),e&&(this._userProperties[a]=!0),this.fireEvent("meta",a,{readable:b,writeable:c,serializable:d,user:e})},_makeGetter:function(a){return Ext.bind(function(a){return this[a]},this,[a],!0)},_makeSetter:function(a){return Ext.bind(function(a,b){this[b]=a},this,[a],!0)},get:function(a){return this._readable[a]?this._readable[a].apply(this,Array.prototype.slice.call(arguments,1)):!1},has:function(a){return this._readable[a]?!0:!1},set:function(a,b,c){c||(c={}),c.silent||(c.silent=!1);if(b!=this._previous[a]){var d=this.get(a);this._previous[a]=d,this._writeable[a]&&(c.silent=this._writeable[a].apply(this,Array.prototype.slice.call(arguments,1))||c.silent),c.silent||this.change(a,b,d)}},change:function(a,b,c){this.fireEvent("change",a,b,c,this),this.fireEvent("change:"+a,b,c,this)},setMany:function(a,b){_(a).each(function(a,c){this.set(c,a,b)},this)},previous:function(a){return _.clone(this._previous[a])},previousValues:function(){return this._previous},realize:function(){},onChange:function(){this.on.apply(this,["change:"+arguments[0]].concat(Array.prototype.slice.call(arguments,1)))},destroy:function(){this.fireEvent("destroy",this)}}),Ext.override(Ext.util.MixedCollection,{serialize:function(a){a=a||!1;var b=!1;return this.keys.length>0?(b={},this.eachKey(function(c,d){b[c]=Workspace.Components.serialize(d,a)})):(b=[],this.each(function(c){b.push(Workspace.Components.serialize(c,a))})),b}});
Ext.Loader.setPath("Workspace","client/workspace"),Ext.define("Workspace",{wtype:"Workspace",extend:"Machine.core.Serializable",requires:["Ext.core.DomHelper"],uses:["Workspace.actions.CreateObjectAction","Workspace.actions.ChangePropertyAction","Workspace.actions.DuplicateObjectAction","Workspace.actions.DeleteObjectAction","Workspace.actions.FormIdeaAction","Workspace.actions.AdoptObjectAction","Workspace.actions.OrphanObjectAction","Workspace.actions.ExpandAction","Workspace.DDManager","Workspace.Label","Workspace.FileUploader","Workspace.tools.PointerTool","Workspace.tools.RectTool","Workspace.tools.TextTool","Workspace.tools.MathTool","Workspace.tools.PencilTool","Workspace.objects.Object","Workspace.objects.ObjectCollection"],constructor:function(a,b){this.callParent([]),Ext.apply(this,b,{id:App.nextId(),tools:[],scrollParams:{hthresh:50,vthresh:50,frequency:1e3}}),this.containerEl=a,this.element=Ext.get(Ext.core.DomHelper.append(a,{tagName:"div",cls:"workspace"})),this.paper=Raphael(this.element.id),this.ddManager=new Workspace.DDManager({workspace:this}),this.lens=new Workspace.Lens,this._objects=this.objects||{},this.objects=Ext.create("Workspace.objects.ObjectCollection"),this.selection=Ext.create("Workspace.objects.ObjectCollection"),this.activeTool="pointer";var c={},d;if(this.tools.length==0){var e=Workspace.Tools.getAllTools();for(var d in e)c[d]=Workspace.Tools.getNewTool(d,this)}else for(var f=0,g=this.tools.length;f<g;f++)d=this.tools[f],c[d]=Workspace.Tools.getNewTool(d,this);this.tools=c,this.getActiveTool().activate(),this.addEvents("click","dblclick","mousedown","mouseup","mousemove","select","unselect","toolchange"),this.ignore={click:!1,dblclick:!1,mousedown:!1,mouseup:!1,mousemove:!1},this.expose("objects",!0,!0,!1),this.expose("width",!0,!0),this.expose("height",!0,!0),this.on("change:width",this.onResize,this),this.on("change:height",this.onResize,this),Ext.Function.defer(this.initialize,1,this)},register:function(a){if(a.id)this.objects.add(a.id,a);else{var b=App.nextId();a.id=b,this.objects.add(b,a)}return a.id},unregister:function(a){this.objects.removeAtKey(a)},getObjectById:function(a){return this.objects.get(a)},serialize:function(a){if(a)return null;var b=Workspace.superclass.serialize.apply(this,arguments);return b.objects=this.objects.serialize(!1),b},initialize:function(){this.createObjects(this._objects),this.fireEvent("afterload",this),Ext.Function.defer(this.render,1,this)},render:function(){if(!this.width){var a=this.getContainerEl().getWidth(),b=this.getContainerEl().getHeight();this.resize(a,b)}else this.onResize();this.ddManager.render(),this.element.on("click",this.click,this,!1),this.element.on("dblclick",this.dblclick,this,!1),this.element.on("mousedown",this.mousedown,this,!1),this.element.on("mouseup",this.mouseup,this,!1),this.element.on("mousemove",this.mousemove,this,!1)},buildObject:function(){var a,b,c;return arguments.length==1?b=arguments[0]:arguments.length==2&&Ext.isFunction(arguments[0])&&(a=arguments[0],b=arguments[1]),Ext.apply(b,{workspace:this}),a?c=Workspace.Components.create(a,b):c=Workspace.Components.create(b),c},createObjects:function(a){var b=[],c;if(Ext.isArray(a))for(var d=0,e=a.length;d<e;d++){c=this.buildObject(a[d]);if(!c)throw{message:"Couldn't create object",data:a[d]};b.push(c),this.fireEvent("instantiate",c)}else if(Ext.isObject(a))for(var f in this._objects){c=this.buildObject(this._objects[f]);if(!c)throw{message:"Couldn't create object",data:this._objects[f]};b.push(c),this.fireEvent("instantiate",c)}if(b.length>0){for(var d=0,e=b.length;d<e;d++)c=b[d],c.initialize();for(var d=0,e=b.length;d<e;d++)c=b[d],c.render(),c.realize(),this.register(c),this.fireEvent("create",c)}},createObject:function(a,b){var c=this.buildObject.apply(this,arguments);if(!c)throw{message:"Couldn't create object",data:{objectClass:a,config:b}};return this.fireEvent("instantiate",c),c?(c.initialize(),c.render(),c.realize(),this.register(c),this.fireEvent("create",c),c):!1},deleteObjects:function(a){if(Ext.isArray(a))for(var b=0,c=a.length;b<c;b++)this.unselect(a[b]),a[b].destroy(),this.unregister(a[b].getId()),this.fireEvent("destroy",a[b]);else this.unselect(a),a.destroy(),this.unregister(a.getId()),this.fireEvent("destroy",a[b])},edit:function(a){this.editingItem=a,a.setState("editing",!0);if(a.editor&&this.hasTool(a.editor))return this.changeTool(a.editor),this.getActiveTool().attach(a)?!0:(this.editingItem=!1,a.setState("editing",!1),!1)},endEdit:function(){this.editingItem&&(this.getActiveTool().detach(),this.editingItem.setState("editing",!1),this.editingItem=!1),this.changeTool("pointer")},setSelection:function(a){Ext.type(a)=="array"&&(this.unselect(),this.select(a))},select:function(a){if(Ext.type(a)=="array"){var b=this.selection;Ext.each(a,function(a){a&&a.isSelectable&&(a.unselectAncestors(),a.unselectDescendents(),this.selection.add(a.getId(),a),a.setState("selected",!0),a.fireEvent("select",a),this.fireEvent("select",a))},this)}else if(Ext.isFunction(a.getId)){var c=a;c&&c.isSelectable&&(c.unselectAncestors(),c.unselectDescendents(),this.selection.add(c.getId(),c),c.setState("selected",!0),c.fireEvent("select",c),this.fireEvent("select",c))}},unselect:function(a){if(a){if(Ext.type(a)=="array"){var b=this.selection;Ext.each(a,function(a){this.selection.removeAtKey(a.getId()),a.setState("selected",!1),a.fireEvent("unselect",a),this.fireEvent("unselect",a)},this)}else if(Ext.isFunction(a.getId)){var c=a;this.selection.removeAtKey(c.getId()),c.setState("selected",!1),c.fireEvent("unselect",c),this.fireEvent("unselect",c)}}else this.selection.each(function(a){a.setState("selected",!1),a.fireEvent("unselect",a),this.fireEvent("unselect",a)},this),this.selection.clear()},deselect:function(a){this.unselect(a)},hasSelection:function(){var a=this.selection.getCount();return a>0},getSelection:function(){return this.selection.getRange()},getSelectionWType:function(){return this.selection.getCommonWType()},getAllObjects:function(){return this.objects.getRange()},getRootObjects:function(a){return this.filterObjectsBy(function(a){return!a.hasParent()},a)},findObjectBy:function(a,b){switch(b){case"selection":return _.find(this.getSelection(),a);case"all":default:return _.find(this.getAllObjects(),a)}},filterObjectsBy:function(a,b){switch(b){case"selection":return _.filter(this.getSelection(),a);case"all":default:return _.filter(this.getAllObjects(),a)}},getActiveTool:function(){return this.tools[this.activeTool]},setActiveTool:function(a){var b=this.activeTool;this.getActiveTool().deactivate(),this.activeTool=a,this.getActiveTool().activate(),this.fireEvent("toolchange",a,b)},changeTool:function(a){this.setActiveTool(a)},hasTool:function(a){return this.tools[a]!=0},getObjectFromEvent:function(a){return a?a.getId?a:!1:!1},click:function(a,b){b=this.getObjectFromEvent(b),this.getActiveTool().click(a,b)},dblclick:function(a,b){b=this.getObjectFromEvent(b),this.getActiveTool().dblclick(a,b)},mousedown:function(a,b){b=this.getObjectFromEvent(b),this.fireEvent("mousedown",a,b)&&this.getActiveTool().mousedown(a,b)},mouseup:function(a,b){b=this.getObjectFromEvent(b),this.fireEvent("mouseup",a,b)&&this.getActiveTool().mouseup(a,b)},mouseover:function(a,b){b=this.getObjectFromEvent(b),this.getActiveTool().mouseover(a,b)},mouseout:function(a,b){b=this.getObjectFromEvent(b),this.getActiveTool().mouseout(a,b)},mousemove:function(a,b){b=this.getObjectFromEvent(b),!this.fireEvent("mousemove",a,b),this.getActiveTool().mousemove(a,b)},getPath:function(){return this.path},bodyResize:function(a,b,c){this.fireEvent("bodyresize"),this.expandToVisible()},expandToVisible:function(){var a=this.getVisibleSize(),b=this.lens.getZoom();a.width/b>this.get("width")&&this.set("width",a.width/b),a.height/b>this.get("height")&&this.set("height",a.height/b)},getVisibleSize:function(){return{width:this.containerEl.getWidth(),height:this.containerEl.getHeight()}},getVisibleDimensions:function(){return this.getVisibleSize()},resize:function(a,b){this.set("width",a),this.set("height",b)},expand:function(a,b){a=a||100,b=b||100,this.set("width",this.getWidth()+a),this.set("height",this.getHeight()+b)},getWidth:function(){return this.get("width")},getHeight:function(){return this.get("height")},onResize:function(){var a=this.lens.getZoom();a<1&&(a=1),this.getEl().setSize(this.getWidth()*a,this.getHeight()*a),this.getPaper().setSize(this.getWidth()*a,this.getHeight()*a)},addElement:function(a){return Ext.get(Ext.core.DomHelper.append(this.element,a))},getEl:function(){return this.element},refreshEl:function(){this.element=Ext.get(this.element.id)},getPaper:function(){return this.paper},getContainerEl:function(){return this.containerEl},doAction:function(a){a.handler&&(a.attachTo(this),a.handler.apply(a.scope))},destroy:function(){Ext.each(this.scrollers,function(a){a.render()}),this.paper.remove(),this.element.un("click",this.click,this,!1),this.element.un("dblclick",this.dblclick,this,!1),this.element.un("mousedown",this.mousedown,this,!1),this.element.un("mouseup",this.mouseup,this,!1),this.element.un("mousemove",this.mousemove,this,!1)},zoomTo:function(a){this.lens.setZoom(a);var b=$(this.getEl().dom);b.scale(a),this.expandToVisible(),this.onResize()}}),Workspace.Components=function(){var a={},b={},c=new Ext.util.MixedCollection,d=Ext.create("Ext.data.ArrayStore",{fields:[{name:"wtype",type:"string"},{name:"name",type:"string"},{name:"iconCls",type:"string"}],data:[]});return{register:function(b,c){c.prototype.wtype=b,c.wtype=b,a[b]=c;var e={wtype:b};c.prototype&&c.prototype.iconCls&&(e.iconCls=c.prototype.iconCls),d.add(e)},registerAlias:function(a,c){b[a]=c},resolveAlias:function(a){return b[a]||a},getType:function(b){return b=Workspace.Components.resolveAlias(b),a[b]},get:function(a){return c.get(a)},has:function(a){return c.containsKey(a)},create:function(){var b,d;arguments.length==1?(b=arguments[0],b&&b.wtype&&(b.wtype=Workspace.Components.resolveAlias(b.wtype),a[b.wtype]&&(d=Workspace.Components.getType(b.wtype)))):(d=arguments[0],b=arguments[1],b.wtype=Workspace.Components.resolveAlias(b.wtype));if(b&&d&&Ext.isFunction(d)){var e=new d(b);return c.add(e.getId(),e),e}return b.wtype?(b.wtype=Workspace.Components.resolveAlias(b.wtype),Ext.create(b.wtype,b)):!1},realize:function(a){if(a.wtype)return a.getId?a:a.id&&Workspace.Components.has(a.id)?Workspace.Components.get(a.id):Workspace.Components.create(a)},serialize:function(a,b){if(a&&a.serialize&&Ext.isFunction(a.serialize))return a.serialize(b);if(Ext.isArray(a)){var c=[];for(var d=0,e=a.length;d<e;d++)c.push(Workspace.Components.serialize(a[d],!0));return c}if(Ext.isObject(a)){var c={};for(var f in a)c[f]=Workspace.Components.serialize(a[f],!0);return c}return a},deserialize:function(a){return Ext.isObject(a)?a.wtype?Workspace.Components.realize(a):Workspace.Components.deserializeHash(a):Ext.isArray(a)?Workspace.Components.deserializeArray(a):a},deserializeHash:function(a){var b={};for(var c in a)b[c]=Workspace.Components.deserialize(a[c],!0);return b},deserializeArray:function(a){var b=[];for(var c=0,d=a.length;c<d;c++)b.push(Workspace.Components.deserialize(a[c],!0));return b},getTypeStore:function(){return d},defaultType:"Machine.core.Serializable",isWType:function(a,b){if(Ext.isString(a)){if(this.has(a)){if(a==b)return!0;var c=this.getType(a);do{if(!(c&&c.prototype&&c.prototype.superclass))break;c=c.prototype.superclass.constructor}while(c.wtype!=b);return c&&c.wtype&&c.wtype==b}}else if(Ext.isFunction(a.isWType))return a.isWType(b)}}}(),Workspace.reg=Workspace.Components.register,Workspace.regAlias=Workspace.Components.registerAlias,Workspace.Utils={deserialize:Workspace.Components.deserialize,serialize:Workspace.Components.serialize,ideaColor:function(){var a={},b=pv.Colors.category20().range(),c=-1;return function(d){d?(a[d]==undefined&&(a[d]=-1),e=a[d]):e=c;var e=e+1,f=e%b.length,g=Math.floor(e/b.length);return d?a[d]=e:c=e,b[f].darker(g).color}}(),bounds:function(a,b,c){return c=c||!1,b=b||!1,c!==!1&&a>c?c:b!==!1&&a<b?b:a},getBox:function(a){var b;if(a.length>0){b=a[0].getBox();var c=function(a){var c=a.getBox();c.tl.x<b.tl.x&&(b.tl.x=c.tl.x),c.tl.y<b.tl.y&&(b.tl.y=c.tl.y),c.br.x>b.br.x&&(b.br.x=c.br.x),c.br.y>b.br.y&&(b.br.y=c.br.y)};a.each?a.each(c):Ext.each(a,c)}else b={tl:{x:0,y:0},br:{x:0,y:0}};return Workspace.Utils.completeBox(b.tl,b.br)},getBBox:function(a,b,c,d){return{x:a,y:b,width:c,height:d}},completeBox:function(a,b){return{tl:a,tr:{x:b.x,y:a.y},br:b,bl:{x:a.x,y:b.y}}},padBox:function(a,b){var c=b/2;return a.tl.x-=c,a.tl.y-=c,a.br.x+=c,a.br.y+=c,Workspace.Utils.completeBox(a.tl,a.br)},boxUnion:function(a,b){return b.tl.x<a.tl.x&&(a.tl.x=b.tl.x),b.tl.y<a.tl.y&&(a.tl.y=b.tl.y),b.br.x>a.br.x&&(a.br.x=b.br.x),b.br.y>a.br.y&&(a.br.y=b.br.y),a}},Ext.ns("Workspace.tools"),Workspace.Tools=Workspace.tools.ToolManager=function(){var a={};return{register:function(b,c){a[b]=c},getToolClass:function(b){return a[b]},getAllTools:function(){return a},getNewTool:function(a,b,c){var d=Workspace.Tools.getToolClass(a);return new d(b,c)}}}(),Workspace.Layouts=new App.Registry("ltype"),Ext.define("Workspace.Lens",{constructor:function(a){Workspace.Lens.superclass.constructor.apply(this),Ext.apply(this,a,{origin:[0,0],zoom:1})},extend:"Ext.util.Observable",getOrigin:function(){return this.origin},getOriginX:function(){return this.origin[0]},getOriginY:function(){return this.origin[1]},getZoom:function(){return this.zoom},setZoom:function(a){this.zoom=a},getAdjustedXYcoords:function(a,b){return{x:(a-this.getOriginX())/this.getZoom(),y:(b-this.getOriginY())/this.getZoom()}},translateToViewX:function(a){return(a-this.getOriginX())*this.getZoom()},translateToViewY:function(a){return(a-this.getOriginY())*this.getZoom()},translateToViewWidth:function(a){return a*this.getZoom()},translateToViewHeight:function(a){return a*this.getZoom()},getX:function(a){return this.translateToViewX(a.get("x"))},getY:function(a){return this.translateToViewY(a.get("y"))},getWidth:function(a){return this.translateToViewWidth(a.get("width"))},getHeight:function(a){return this.translateToViewHeight(a.get("height"))},translateToRealX:function(a,b){return b/this.getZoom()+this.getOriginX()},translateToRealY:function(a,b){return b/this.getZoom()+this.getOriginY()},translateToRealWidth:function(a,b){return b/this.getZoom()},translateToRealHeight:function(a,b){return b/this.getZoom()},setX:function(a,b){return a.set("x",translateToRealX(b))},setY:function(a,b){return a.set("y",translateToRealY(b))},setWidth:function(a,b){return a.set("width",translateToRealWidth(b))},setHeight:function(a,b){return a.set("height",translateToRealHeight(b))}});
Ext.oldLog=Ext.log,Ext.apply(App,{log:function(a,b){b||(b={}),Ext.applyIf(b,{iconCls:"",silent:!1}),cp&&cp.rendered?(cp.log.call(cp,a,b),!b.silent&&cp.ownerCt.collapsed&&cp.ownerCt.expand()):Ext.oldLog&&Ext.oldLog.apply(Ext,arguments)},logf:function(a,b,c,d){App.log(String.format.apply(String,arguments))},dump:function(a){if(typeof a=="string"||typeof a=="number"||typeof a=="undefined"||Ext.isDate(a))App.log(a);else if(!a)App.log("null");else if(typeof a!="object")App.log("Unknown return type");else if(Ext.isArray(a))App.log("["+a.join(",")+"]");else{var b=["{\n"];for(var c in a){var d=typeof a[c];d!="function"&&d!="object"?b.push(Ext.String.format("  {0}: {1},\n",c,a[c])):(_.isArray(a[c])&&(d="array"),b.push(Ext.String.format("  {0}: {1},\n",c,d)))}var e=b.join("");e.length>3&&(e=e.substr(0,e.length-2)),App.log(e+"\n}")}},_timers:{},time:function(a){a=a||"def",Ext._timers[a]=(new Date).getTime()},timeEnd:function(a,b){var c=(new Date).getTime();a=a||"def";var d=String.format("{0} ms",c-Ext._timers[a]);return Ext._timers[a]=(new Date).getTime(),b!==!1&&App.log("Timer "+(a=="def"?d:a+": "+d)),d}}),Ext.apply(App,function(){function b(a,b){return'<div class="msg"><h3>'+(a||"")+"</h3><p>"+(b||"")+"</p></div>"}var a;return{msg:function(c,d){var e,f;arguments.length==3&&_.isObject(arguments[2])?e=arguments[2]:e={},_.defaults(e,{delay:3e3,scope:window}),a||(a=Ext.core.DomHelper.insertFirst(document.body,{id:"msg-div"},!0));var g;e.params?f=e.params:arguments.length>2&&(f=Array.prototype.slice.call(arguments,1)),f?g=Ext.String.format.apply(String,f):g=d;var h=Ext.core.DomHelper.append(a,b(c,g),!0);e.handler&&(e.handler=="console"?h.on("click",App.ui.Launcher.showConsole,App.ui.Launcher):h.on("click",e.handler,e.scope)),h.hide(),h.slideIn("t").ghost("t",{delay:e.delay,remove:!0}),Ext.callback(e.callback,e.scope,h,g)}}}()),Ext.msg=App.msg,Ext.debug={};
CodeMirror.defineMode("pepper",function(a,b){function j(a,b,c){return b.tokenize=c,c(a,b)}function l(a,b){return k=a,b}function m(a,b){var c=a.next();return c=='"'||c=="'"?j(a,b,n(c)):c=="#"?(a.skipToEnd(),l("comment","comment")):/\d/.test(c)?(a.eatWhile(/[\w\.]/),l("number","number")):c=="/"?a.eat("*")?j(a,b,o):a.eat("/")?(a.skipToEnd(),l("comment","comment")):(a.eatWhile(h),l("operator","operator")):h.test(c)?(a.eatWhile(h),l("operator")):i.test(c)?(a.eatWhile(i),l("word","pepper-dotParen")):g&&c=="$"?(a.eatWhile(/[\w\$_]/),l("word","variable")):(a.eatWhile(/[\w\$_]/),d&&d[a.current()]?l("keyword","keyword"):l("word","word"))}function n(a){return function(b,c){var d=!1,e,g=!1;while((e=b.next())!=null){if(e==a&&!d){g=!0;break}d=!d&&e=="\\"}if(g||!d&&!f)c.tokenize=m;return l("string","string")}}function o(a,b){var c=!1,d;while(d=a.next()){if(d=="/"&&c){b.tokenize=m;break}c=d=="*"}return l("comment","comment")}function p(a,b,c,d,e){this.indented=a,this.column=b,this.type=c,this.align=d,this.prev=e}function q(a,b,c){return a.context=new p(a.indented,b,c,null,a.context)}function r(a){return a.context=a.context.prev}var c=a.indentUnit,d=function(){function a(a){var b={},c=a.split(" ");for(var d=0;d<c.length;++d)b[c[d]]=!0;return b}var b="declare import component system sequence strand structure kinetic equal noninteracting";return a(b)}(),e=b.useCPP,f=b.multiLineStrings,g=b.$vars,h=/[+\-*&%=<>!?|]/,i=/[\.\(\)+]/,k;return{startState:function(a){return{tokenize:m,context:new p((a||0)-c,0,"top",!1),indented:0,startOfLine:!0}},token:function(a,b){var c=b.context;a.sol()&&(c.align==null&&(c.align=!1),b.indented=a.indentation(),b.startOfLine=!0);if(a.eatSpace())return null;var d=b.tokenize(a,b);return k=="comment"?d:(c.align==null&&(c.align=!0),k!=";"&&k!=":"||c.type!="statement"?k=="{"?q(b,a.column(),"}"):k=="["?q(b,a.column(),"]"):k=="("?q(b,a.column(),")"):k=="}"?(c.type=="statement"&&(c=r(b)),c.type=="}"&&(c=r(b)),c.type=="statement"&&(c=r(b))):k==c.type?r(b):c.type=="}"&&q(b,a.column(),"statement"):r(b),b.startOfLine=!1,d)},indent:function(a,b){if(a.tokenize!=m)return 0;var d=b&&b.charAt(0),e=a.context,f=d==e.type;return e.type=="statement"?e.indented+(d=="{"?0:c):e.align?e.column+(f?0:1):e.indented+(f?0:c)},electricChars:"{}[]()"}}),CodeMirror.defineMode("sequence",function(){return{token:function(a){if(a.sol()&&a.match(/^[\w\s\-_]+[:=\t]\s?/))return"sequence-name";var b=a.next();switch(b){case"%":case"#":return a.skipToEnd(),"sequence-comment";case">":return a.skipToEnd(),"sequence-name";case"a":case"A":return"sequence-a";case"u":case"U":return"sequence-u";case"t":case"T":return"sequence-t";case"c":case"C":return"sequence-c";case"g":case"G":return"sequence-g";case"n":case"N":return"sequence-n";case"r":case"R":return"sequence-r";case"y":case"Y":return"sequence-y";case"k":case"K":return"sequence-k";case"m":case"M":return"sequence-m";case"s":case"S":return"sequence-s";case"w":case"W":return"sequence-w";case"b":case"B":return"sequence-b";case"d":case"D":return"sequence-d";case"h":case"H":return"sequence-h";case"v":case"V":return"sequence-v"}if(b.match(/\d/))return"number"}}}),CodeMirror.defineMode("dd-sequence",function(){return{token:function(a){var b=a.next();switch(b){case"%":case"#":return a.skipToEnd(),"sequence-comment";case">":return a.skipToEnd(),"sequence-name";case"a":return"sequence-a";case"A":return"sequence-a-lock";case"u":return"sequence-u";case"U":return"sequence-u-lock";case"t":return"sequence-t";case"T":return"sequence-t-lock";case"c":return"sequence-c";case"C":return"sequence-c-lock";case"g":return"sequence-g";case"G":return"sequence-g-lock";case"n":case"N":return"sequence-n"}if(b.match(/\d/))return"number"}}}),CodeMirror.defineMode("nupack",function(a,b){var c=CodeMirror.getMode(b,"sequence"),d=!!b&&(b.multisubjective||b.ms);return{startState:function(){return{value:""}},token:function(a,b){if(a.eatSpace())return"";if(b.value==""){if(a.match("#`",!0,!0)||a.match("#``",!0,!0))return a.skipToEnd(),"builtin";if(a.match(/^(material|temperature|trials|sodium|magnesium|dangles|prevent)/,!0))return b.value="parameter","keyword";if(a.eat("%")||a.eat("#"))return a.skipToEnd(),"comment";if(a.match("structure",!0,!0))return b.value="structure-definition-left","keyword";if(a.match("sequence",!0,!0)||a.match("domain",!0,!0))return b.value="sequence-definition-left","keyword";if(a.match("strand",!0,!0))return b.value="structure-name","keyword";if(!!d){if(a.match("!hairpin",!0,!0))return b.value="ms-definition-left","keyword";if(a.match("!coop",!0,!0))return b.value="ms-definition-left","keyword";if(a.match("!bridge",!0,!0))return b.value="ms-definition-left","keyword";if(a.match("!static",!0,!0))return b.value="ms-definition-key","keyword";if(a.match("!length",!0,!0))return b.value="sequence-definition-left","keyword";if(a.match("!",!0,!0))return a.skipToEnd(),b.value="","string"}b.value="structure-name"}else switch(b.value){case"parameter":return a.skipToEnd(),b.value="","string";case"ms-definition-left":return a.eatWhile(/\S/),b.value="ms-definition-assign","string";case"ms-definition-assign":a.eatSpace();if(a.match(":",!0,!0))b.value="ms-definition-right";else{if(!a.match("=",!0,!0))return a.skipToEnd(),b.value="","nupack-error";b.value="ms-definition-right"}return"operator";case"ms-definition-right":return b.value="","";case"ms-definition-key":return a.eatWhile(/\S/),b.value="","string";case"structure-definition-left":return a.eatWhile(/\S/),b.value="structure-definition-assign","nupack-structure";case"structure-definition-assign":return a.eatWhile(/[\S=]/),b.value="structure-definition-right","operator";case"structure-definition-right":return a.skipToEnd(),b.value="","nupack-huplus";case"sequence-definition-left":return a.eatWhile(/\S/),b.value="sequence-definition-assign","string";case"sequence-definition-assign":return a.eatWhile(/[\S=]/),b.value="sequence-definition-right","operator";case"sequence-definition-right":var e=c.token(a);return a.eol()&&(b.value=""),e;case"structure-name":return a.eatWhile(/\S/),b.value="structure-assign","variable";case"structure-assign":return a.eat("=")||a.eat(":")?(b.value="structure-thread","operator"):a.eat("<")?(b.value="structure-objection","operator"):(a.skipToEnd(),b.value="","nupack-error");case"structure-thread":return a.skipToEnd(),b.value="","string";case"structure-objection":return a.skipToEnd(),b.value="","qualifier"}}}}),CodeMirror.defineMode("dil-domains",function(a){var b=CodeMirror.getMode(a,"sequence");return{startState:function(){return{expects:""}},token:function(a,b){switch(b.expects){case"":if(a.match(/^[^\[\]]+$/,!1))return b.expects="segment-block","";if(a.eatSpace())return"";if(a.eatWhile(/^\w+/))return b.expects="domain-block-open","variable";return"";case"domain-block-open":if(a.eat("["))return b.expects="domain-block","bracket";return a.skipToEnd(),b.expects="","error";case"domain-block":if(a.eatSpace())return"";if(a.eat("]"))return b.expects="domain-block-specifier","bracket";if(a.match(/^[\w\*']+/))return b.expects="segment-block","variable-2";return a.skipToEnd(),b.expects="","error";case"segment-block":if(a.match(/^\(\d+\)/))return b.expects="segment-block-specifier","number";if(a.eat(":"))return b.expects="segment-block-specifier","operator";return a.eatSpace(),b.expects="domain-block","";case"segment-block-specifier":if(a.match(/^\w+/))return b.expects="domain-block","keyword";return a.eatSpace(),b.expects="domain-block","";case"domain-block-specifier":if(a.match(/^\w+/))return b.expects="domain-block-polarity","keyword";return b.expects="domain-block-polarity","";case"domain-block-polarity":if(a.eat(/[\+-0]/))return b.expects="","atom";return b.expects="",""}}}}),CodeMirror.tokenize=function(a,b,c){var d=CodeMirror.getMode({indentUnit:2},b),e=CodeMirror.splitLines(a),f=CodeMirror.startState(d),g,h=[];for(var i=0,j=e.length;i<j;++i){h[i]=[],g=new CodeMirror.StringStream(e[i]);while(!g.eol()){var k=d.token(g,f);!k||h[i].push([k,g.current()]),g.start=g.pos}}return h},CodeMirror.modeRenderer=function(a,b){return b||(b=""),function(c){var d={innerHTML:"",nodeType:1};return CodeMirror.runMode(c,a,d),b?'<span class="'+b+'">'+d.innerHTML+"</span>":d.innerHTML}},CodeMirror.renderMode=function(a,b){var c={innerHTML:"",nodeType:1};return CodeMirror.runMode(b,a,c),c.innerHTML},CodeMirror.getModeRenderer=function(a,b){function c(a){return a?a.replace(/[<&]/g,function(a){return a=="<"?"&lt;":"&amp;"}):""}var d=CodeMirror.getMode(CodeMirror.defaults,a),e=b&&b.tabSize||CodeMirror.defaults.tabSize,f=b.renderer||function(a,b,c){return b?'<span class="cm-'+b+'">'+a+"</span>":a};return function(a){a=a||"";var b=[],g=0;callback=function(a,d){if(a=="\n"){b.push("<br>"),g=0;return}var h="";for(var i=0;;){var j=a.indexOf("	",i);if(j==-1){h+=c(a.slice(i)),g+=a.length-i;break}g+=j-i,h+=c(a.slice(i,j));var k=e-g%e;g+=k;for(var l=0;l<k;++l)h+=" ";i=j+1}b.push(f(h,c(d),g))};var h=CodeMirror.splitLines(a),i=CodeMirror.startState(d);for(var j=0,k=h.length;j<k;++j){j&&callback("\n");var l=new CodeMirror.StringStream(h[j]);while(!l.eol()){var m=d.token(l,i);callback(l.current(),m,j,l.start),l.start=l.pos}}return b.join("")}};
App.geom=App.Geom=function(){function a(a){this.x=a.x,this.y=a.y}function b(a){this.theta=a}return _.extend(a.prototype,{toArray:function(){return[this.x,this.y]},toPos:function(){return{x:this.x,y:this.y}},add:function(b){var c=a.fromMixed(b);return new a({x:this.x+c.x,y:this.y+c.y})},subtract:function(b){var c=a.fromMixed(b);return new a({x:this.x-c.x,y:this.y-c.y})},distance:function(b){var c=a.fromMixed(b);return Math.sqrt(Math.pow(this.x-c.x,2)+Math.pow(this.y-c.y,2))},angle:function(b){if(b){var c=a.fromMixed(b);return Math.atan2(c.y-this.y,c.x-this.x)}return Math.atan2(this.y,this.x)},addPolar:function(b,c){return new a({x:this.x+Math.cos(b)*c,y:this.y+Math.sin(b)*c})},midpoint:function(b){var c=a.fromMixed(b);return new a({x:this.x+(c.x-this.x)/2,y:this.y+(c.y-this.y)/2})}}),_.extend(a,{fromArray:function(b){return new a({x:b[0],y:b[1]})},fromPos:function(b){return new a(b)},fromMixed:function(b){if(b instanceof a)return b;if(_.isArray(b))return a.fromArray(b);if(_.isObject(b)&&b.x&&b.y)return a.fromPos(b)}}),_.extend(b.prototype,{rad:function(){return this.type=="rad"?this.theta:this.theta*Math.PI/180},deg:function(){return this.type=="deg"?this.theta:this.theta/180*Math.PI}}),_.extend(b,{fromRad:function(a){var c=new b(a);return c.type="rad",c},fromDeg:function(a){var c=new b(a);return c.type="deg",c}}),{Point:a}}();
typeof _=="undefined"&&(_=require("underscore")),typeof module=="undefined"&&(module={}),typeof module.exports=="undefined"&&(module.exports={});var DNA=module.exports.DNA=function(_){function sum(a){return _.reduce(a,function(a,b){return a+b},0)}function deg(a){return(a*180/Math.PI%360).toFixed(2)}function coords(a){return a.x.toFixed(2)+","+a.y.toFixed(2)}function arc2angle(a,b){var c=b*pi2;return a/c*pi2}function Point(a){this.x=a.x,this.y=a.y}function Node(){this.value,this.tracebackI,this.tracebackJ}function scoringMatrix_getScore(a,b){return a=a.toLowerCase(),b=b.toLowerCase(),a==b?this.match:this.mismatch}function ScoringMatrix(){this.mismatch,this.match}function setMismatch(a){this.mismatch=a}function setMatch(a){this.match=a}function Identity(){}function addReturns(a){return a=a.replace(/(.{60})/g,function(a,b,c,d){return b+"\n"}),a}function complement(a){return a=a.replace(/g/g,"1"),a=a.replace(/c/g,"2"),a=a.replace(/1/g,"c"),a=a.replace(/2/g,"g"),a=a.replace(/G/g,"1"),a=a.replace(/C/g,"2"),a=a.replace(/1/g,"C"),a=a.replace(/2/g,"G"),a=a.replace(/a/g,"1"),a=a.replace(/t/g,"2"),a=a.replace(/1/g,"t"),a=a.replace(/2/g,"a"),a=a.replace(/A/g,"1"),a=a.replace(/T/g,"2"),a=a.replace(/1/g,"T"),a=a.replace(/2/g,"A"),a=a.replace(/u/g,"a"),a=a.replace(/U/g,"A"),a=a.replace(/r/g,"1"),a=a.replace(/y/g,"2"),a=a.replace(/1/g,"y"),a=a.replace(/2/g,"r"),a=a.replace(/R/g,"1"),a=a.replace(/Y/g,"2"),a=a.replace(/1/g,"Y"),a=a.replace(/2/g,"R"),a=a.replace(/k/g,"1"),a=a.replace(/m/g,"2"),a=a.replace(/1/g,"m"),a=a.replace(/2/g,"k"),a=a.replace(/K/g,"1"),a=a.replace(/M/g,"2"),a=a.replace(/1/g,"M"),a=a.replace(/2/g,"K"),a=a.replace(/b/g,"1"),a=a.replace(/v/g,"2"),a=a.replace(/1/g,"v"),a=a.replace(/2/g,"b"),a=a.replace(/B/g,"1"),a=a.replace(/V/g,"2"),a=a.replace(/1/g,"V"),a=a.replace(/2/g,"B"),a=a.replace(/d/g,"1"),a=a.replace(/h/g,"2"),a=a.replace(/1/g,"h"),a=a.replace(/2/g,"d"),a=a.replace(/D/g,"1"),a=a.replace(/H/g,"2"),a=a.replace(/1/g,"H"),a=a.replace(/2/g,"D"),a}function reverse(a){var b=new Array;return a.search(/./)!=-1&&(b=a.match(/./g),b=b.reverse(),a=b.join("")),a}function reverseComplement(a){return reverse(complement(a))}function parseComplement(a){a=a.trim();if(a.length>1)if(a[a.length-1]=="*"||a[a.length-1]=="'")return-1*parseInt(a.substr(0,a.length-1));return parseInt(a)}function parseStrandSpec(a,b){b||(b=" ");var c=a.split(b),d=[];for(var e=0;e<c.length;e++){var f=c[e];f.trim(),!f||d.push(DNA.parseIdentifier(c[e]))}return d}function amax(a){return Math.abs(_.max(a,Math.abs))}function mapUnique(a,b){b||(b=0);var c={};return a=_.uniq(a,!0),_.each(a,function(a,d){c[a]=d+b}),c}function absUnique(a){return _.uniq(_.map(a,Math.abs))}function sign(a){return a>0?1:a<0?-1:0}function tablify(a){var b=a.split("\n"),c=[];return _.each(b,function(a){c.push(a.split("	"))}),c}function indexTable(a){var b={};return _.each(a,function(a){a.length>1&&(b[a[0]]||(b[a[0]]={}),b[a[0]][a[1]]=a.length>3?a.slice(2):a[2])}),b}function indexBy(a,b,c){var d={};return _.each(c,function(c){d[c[a]]||(d[c[a]]={}),d[c[a]][c[b]]=c}),d}function getBounds(a){var b=a[0][0],c=a[0][0],d=a[0][1],e=a[0][1];for(var f=0;f<a.length;f++)a[f][0]<b&&(b=a[f][0]),a[f][0]>c&&(c=a[f][0]),a[f][1]<d&&(d=a[f][1]),a[f][1]>e&&(e=a[f][1]);return[[b,c],[d,e]]}function getScale(a,b,c){var d=1,e=1,f=a[0][1]-a[0][0],g=a[1][1]-a[1][0];return c?d=e=Math.min(b[0]/f,b[1]/g):(d=b[0]/f,e=b[1]/g),[d,e]}function getOffset(a,b,c){c||(c=1);var d=(a[0][1]-a[0][0])*c,e=(a[1][1]-a[1][0])*c,f=b[0],g=b[1];return[f/2-d/2,g/2-e/2]}function arrangeLayout(a,b){b||(b={}),_.defaults(b,{center:!0,alignCenter:!0,scale:!1,offsets:!1,maintainAspect:!0});var c=getBounds(a),d,e,f=c[0][1]-c[0][0],g=c[1][1]-c[1][0],h,i=1,j=1;return b.scale&&(h=getScale(c,b.scale,b.maintainAspect),i=h[0],j=h[1]),b.center&&(d=c[0][0],e=c[1][0]),b.alignCenter&&b.scale&&(d+=b.scale[0]/2-f/2,e+=b.scale[1]/2-g/2),b.offsets&&(d-=b.offsets[0],e-=b.offsets[1]),{scale:[i,j],offsets:[d,e],bounds:c,pairs:_.map(a,function(a){return a[0]-=d,a[1]-=e,a[0]*=i,a[1]*=j,a})}}function drawLoop(a,b,c,d,e){e||(e="circular"),debug&&console.group("Loop : "+coords(b)+" "+deg(c)+"° = "+DNA.printDUPlus(a));var f=[];if(e=="circular"){var g=_.map(a,function(a){switch(a[0]){case"H":case"D":return duplexWidth;case".":case"U":return baseLength*a[1];case"+":return breakWidth}}),h=sum(g)+d,i=h/pi2,j=b.addPolar(c,i),k=j.x,l=j.y,m,n;c+=Math.PI,c+=.5*d/h*pi2,m=Math.cos(c)*i+k,n=Math.sin(c)*i+l;for(var o=0;o<a.length;o++){var p=a[o],q=g[o]/h*pi2;switch(p[0]){case"H":case"D":var r=c+q/2,s=j.addPolar(r,i),t=r-q*.5*stemWidth/duplexWidth,u=j.addPolar(t,i),f=f.concat(drawDuplex(p,r,u,"linear"));break;case".":case"U":f=f.concat(drawArc(p[1],Point.create(k,l),c,q,i));break;case"+":}c+=q,m=Math.cos(c)*i+k,n=Math.sin(c)*i+l}}else if(e=="first")if(a.length==2){var v,w,u;switch(a[0][0]+a[1][0]){case".D":case"UD":case".H":case"UH":v=c+phi,w=a[0][1],u=b.addPolar(v+Math.PI,baseLength*w),f=f.concat(drawLine(w,u,v)),f=f.concat(drawDuplex(a[1],c,b,"linear"));break;default:return debug&&console.groupEnd(),drawLoop(a,b,c,d,"circular")}}else{if(a.length!=3)return debug&&console.groupEnd(),drawLoop(a,b,c,d,"circular");switch(a[0][0]+a[1][0]+a[2][0]){case".D.":case"UDU":case".H.":case"UHU":var v=c+phi,w=a[0][1],u=b.addPolar(v+Math.PI,baseLength*w);f=f.concat(drawLine(w,u,v)),f=f.concat(drawDuplex(a[1],c,b,"linear")),v=c-phi+Math.PI,w=a[2][1],u=b.addPolar(c+piHalf,stemWidth).addPolar(v,baseLength),f=f.concat(drawLine(w,u,v));break;default:return debug&&console.groupEnd(),drawLoop(a,b,c,d,"circular")}}else if(e=="linear"){var v,w,u;if(a.length==2)switch(a[0][0]+a[1][0]){case".+":case"U+":v=c-phi,w=a[0][1],u=b.addPolar(c-piHalf,stemWidth/2).addPolar(v,baseLength),f=f.concat(drawLine(w,u,v));break;case"+.":case"+U":v=c+phi,w=a[1][1],u=b.addPolar(c+piHalf,stemWidth/2).addPolar(v,baseLength),f=f.concat(drawLine(w,u,v));break;case"D.":case"DU":case"H.":case"HU":f=f.concat(drawDuplex(a[0],c,b,e)),v=c-phi+Math.PI,w=a[1][1],u=b.addPolar(c+piHalf,stemWidth),f=f.concat(drawLine(w,u,v));break;default:return debug&&console.groupEnd(),drawLoop(a,b,c,d,"circular")}else{if(a.length!=3)return debug&&console.groupEnd(),drawLoop(a,b,c,d,"circular");switch(a[0][0]+a[1][0]+a[2][0]){case".+D":case"U+D":case".+H":case"U+H":v=c-phi,w=a[0][1],u=b.addPolar(c-piHalf,stemWidth/2).addPolar(v,baseLength),f=f.concat(drawLine(w,u,v)),b=b.addPolar(c,breakWidth),f=f.concat(drawDuplex(a[2],c,b,e));break;case"D.+":case"DU+":case"H.+":case"HU+":b=b.addPolar(c,breakWidth).addPolar(c-piHalf,stemWidth/2),f=f.concat(drawDuplex(a[0],c,b,e)),v=c+Math.PI-phi,w=a[1][1],u=b.addPolar(c+piHalf,stemWidth).addPolar(v,baseLength),f=f.concat(drawLine(w,u,v));break;case"+.D":case"+UD":case"+.H":case"+UH":v=c+phi,w=a[0][1],u=b.addPolar(c-piHalf,stemWidth/2).addPolar(v,baseLength),f=f.concat(drawLine(w,u,v)),b=b.addPolar(c,breakWidth),f=f.concat(drawDuplex(a[2],c,b,e));break;case"D+.":case"D+U":case"H+.":case"H+U":b=b.addPolar(c,breakWidth).addPolar(c-piHalf,stemWidth/2),f=f.concat(drawDuplex(a[0],c,b,e)),v=c+piHalf-phi,w=a[2][1],u=b.addPolar(c+piHalf,stemWidth).addPolar(c+Math.PI,breakWidth).addPolar(v,baseLength),f=f.concat(drawLine(w,u,v));break;default:return debug&&console.groupEnd(),drawLoop(a,b,c,d,"circular")}}}return debug&&console.groupEnd(),f}function drawLine(a,b,c){var d=b.x,e=b.y,f=Math.cos(c)*baseLength,g=Math.sin(c)*baseLength,h=c-piHalf,i=[];debug&&console.log("Line : "+coords(b)+" "+deg(c)+"° + len: "+a);for(var j=0;j<a;j++)i.push([d,e,h]),d+=f,e+=g;return i}function drawArc(a,b,c,d,e){var f=d/a,g=b.x,h=b.y,i,j,k=[];debug&&console.log("Arc : "+coords(b)+" "+deg(c)+"° + "+deg(d)+" (dtheta="+f+"°), r: "+e+" len: "+a),c+=f/2;for(var l=0;l<a;l++)i=Math.cos(c)*e+g,j=Math.sin(c)*e+h,k.push([i,j,c]),c+=f;return k}function drawDuplex(a,b,c,d){debug&&console.group("Duplex : "+coords(c)+" "+deg(b)+"° = "+a);var e=a[1],f=x=c.x,g=y=c.y,h,i,j=Math.cos(b)*baseLength,k=Math.sin(b)*baseLength,l=b-Math.PI/2,m;m=[[c.x,c.y,l]];for(var n=1;n<e;n++)x+=j,y+=k,m.push([x,y,l]);h=x,i=y,l=b+Math.PI/2,x=h+Math.cos(l)*(stemWidth/2),y=i+Math.sin(l)*(stemWidth/2),m=m.concat(drawLoop(a[2],Point.create(x,y),b,duplexWidth,d)),x=h+Math.cos(l)*stemWidth,y=i+Math.sin(l)*stemWidth,m.push([x,y,l]);for(var n=1;n<e;n++)x-=j,y-=k,m.push([x,y,l]);return debug&&console.groupEnd(),m}function layoutStructure(a,b){var c=0,d=0,e=0;b&&b.arrangeLayout!==!1&&(b.arrangeLayout=!0);if(a.length==0)return[];var f=b?b.loopMode:null;f&&f=="linear"&&(f="first");var g=drawLoop(a,Point.create(d,e),c,breakWidth,f);return g.length>0&&b&&!b.arrangeLayout?arrangeLayout(g,b).pairs:g}function stripNupackHeaders(a){var b=a.split("\n");while(b[0]&&b[0][0]=="%")b.shift();return b.join("\n")}function nupackBlocks(a){return _.each(a.split("% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %"),function(a){})}function parseNamedSequences(a){var b=a.split("\n"),c,d,e,f={};for(var g=0;g<b.length;g++)/^>[\w\s]+$/.test(b[g])?(c=b[g].match(/^>([\w\s]+)$/)[1],g++,/([acgturykmswbdhvnx]+)/i.test(b[g])?d=b[g].match(/([acgturykmswbdhvnx]+)/i)[1]:d=""):/^(?:domain|sequence|segment)\s*(\w+)\s*[:=]\s*([acgturykmswbdhvnx]+)\s*$/i.test(b[g])?(e=b[g].match(/^(?:domain|sequence|segment)\s*(\w+)\s*[:=]\s*([acgturykmswbdhvnx]+)\s*$/i),c=e[1],d=e[2]):/^(\w+)\s*[:=]\s*([acgturykmswbdhvnx]+)\s*$/i.test(b[g])?(e=b[g].match(/^(\w+)\s*[:=]\s*([acgturykmswbdhvnx]+)\s*$/i),c=e[1],d=e[2]):/^(\w+)\s*[,\t]\s*([acgturykmswbdhvnx]+)\s*$/i.test(b[g])?(e=b[g].match(/^(\w+)\s*[,\t]\s*([acgturykmswbdhvnx]+)\s*$/i),c=e[1],d=e[2]):(c=(g+1).toString(),d=b[g]),f[c]=d;return f}function printSequences(a,b,c){var d="",e,f=0;for(var g in a){e=a[g];switch(b){case"nupack":d+="domain "+g+" = "+e+"\n";break;case"dd":d+=e+" 1 15"+"\n";break;case"colon":case":":d+=g+" : "+e+"\n";break;case"equals":case"=":d+=g+" = "+e+"\n";break;case"fasta":d+=">"+g+"\n"+e+"\n";break;case"tsv":case"	":d+=g+"	"+e+"\n";break;case"csv":case",":d+=g+","+e+"\n";break;default:case"":d+=e+"\n"}f++}switch(b){case"dd":d=f+"\n"+d}switch(b){default:}return d}function namedStrandsToNupack(a){}function matchDegenerate(a,b){return degenerateRegexes[a].test(b)}function populateDegenerate(a,b){var c;return b||(b={}),b.rna?c=degenerateRna:c=degenerateDna,_.map(a.split(""),function(a){return chooseDegenerate(a,c)}).join("")}function chooseDegenerate(a,b){var c=b[a];return c[Math.floor(Math.random()*c.length)]}_.extend(Point.prototype,{toArray:function(){return[this.x,this.y]},toPos:function(){return{x:this.x,y:this.y}},add:function(a){var b=Point.fromMixed(a);return new Point({x:this.x+b.x,y:this.y+b.y})},subtract:function(a){var b=Point.fromMixed(a);return new Point({x:this.x-b.x,y:this.y-b.y})},distance:function(a){var b=Point.fromMixed(a);return Math.sqrt(Math.pow(this.x-b.x,2)+Math.pow(this.y-b.y,2))},angle:function(a){if(a){var b=Point.fromMixed(a);return Math.atan2(b.y-this.y,b.x-this.x)}return Math.atan2(this.y,this.x)},addPolar:function(a,b){return new Point({x:this.x+Math.cos(a)*b,y:this.y+Math.sin(a)*b})},midpoint:function(a){var b=Point.fromMixed(a);return new Point({x:this.x+(b.x-this.x)/2,y:this.y+(b.y-this.y)/2})}}),_.extend(Point,{create:function(a,b){return new Point({x:a,y:b})},fromArray:function(a){return new Point({x:a[0],y:a[1]})},fromPos:function(a){return new Point(a)},fromMixed:function(a){if(a instanceof Point)return a;if(_.isArray(a))return Point.fromArray(a);if(_.isObject(a)&&a.x&&a.y)return Point.fromPos(a)}});var AlignPairLinear=function(){function a(){if(this.M.length==0)for(var a=1;a<=this.N.length;a++)this.alignedM.push("-"),this.alignedN.push(this.N[a-1]),this.score=this.score+this.scoreSet.gap;else if(this.N.length==0)for(var a=1;a<=this.M.length;a++)this.alignedN.push("-"),this.alignedM.push(this.M[a-1]),this.score=this.score+this.scoreSet.gap;else(this.M.length!=0||this.N.length!=0)&&this.path(0,0,this.M.length,this.N.length)}function b(a,b,c,d){if(a+1==c||b==d){var e=new Array,f=new Array;for(var g=a+1;g<=c;g++)e.push(this.M[g-1]);for(var h=b+1;h<=d;h++)f.push(this.N[h-1]);var i=new AlignPairQuad;subScoreSet=new ScoreSet,b==d?b==0?subScoreSet.setScoreSetParam(this.scoreSet.scoringMatrix,this.scoreSet.beginGap,this.scoreSet.beginGap,this.scoreSet.beginGap):b==this.N.length?subScoreSet.setScoreSetParam(this.scoreSet.scoringMatrix,this.scoreSet.endGap,this.scoreSet.endGap,this.scoreSet.endGap):subScoreSet.setScoreSetParam(this.scoreSet.scoringMatrix,this.scoreSet.gap,this.scoreSet.gap,this.scoreSet.gap):(subScoreSet.setScoreSetParam(this.scoreSet.scoringMatrix,this.scoreSet.gap,this.scoreSet.beginGap,this.scoreSet.endGap),subScoreSet.useBeginGapTop=!1,subScoreSet.useBeginGapLeft=!1,subScoreSet.useEndGapBottom=!1,subScoreSet.useEndGapRight=!1,a==0&&(subScoreSet.useBeginGapTop=!0),b==0&&(subScoreSet.useBeginGapLeft=!0),d==this.N.length&&(subScoreSet.useEndGapRight=!0),c==this.M.length&&(subScoreSet.useEndGapBottom=!0)),i.initializeMatrix(e,f,subScoreSet),i.fillMatrix(),i.align(),this.alignedM.push(i.getAlignedM()),this.alignedN.push(i.getAlignedN()),this.score=this.score+i.score}else{var j=Math.floor((a+c)/2);this.Sn[b]=0;if(a==0)for(var h=b+1;h<=d;h++)this.Sn[h]=this.Sn[h-1]-this.scoreSet.beginGap;else for(var h=b+1;h<=d;h++)this.Sn[h]=this.Sn[h-1]-this.scoreSet.gap;var k,l;for(var g=a+1;g<=j;g++){k=this.Sn[b],l,b==0?l=this.Sn[b]-this.scoreSet.beginGap:l=this.Sn[b]-this.scoreSet.gap,this.Sn[b]=l;for(var h=b+1;h<=d;h++)h==this.N.length&&g==this.M.length?l=Math.max(this.Sn[h]-this.scoreSet.endGap,Math.max(l-this.scoreSet.endGap,k+this.scoreSet.getScore(this.M[g-1],this.N[h-1]))):g==this.M.length?l=Math.max(this.Sn[h]-this.scoreSet.gap,Math.max(l-this.scoreSet.endGap,k+this.scoreSet.getScore(this.M[g-1],this.N[h-1]))):h==this.N.length?l=Math.max(this.Sn[h]-this.scoreSet.endGap,Math.max(l-this.scoreSet.gap,k+this.scoreSet.getScore(this.M[g-1],this.N[h-1]))):l=Math.max(this.Sn[h]-this.scoreSet.gap,Math.max(l-this.scoreSet.gap,k+this.scoreSet.getScore(this.M[g-1],this.N[h-1]))),k=this.Sn[h],this.Sn[h]=l}this.Sp[d]=0;if(c==this.M.length)for(var h=d-1;h>=b;h--)this.Sp[h]=this.Sp[h+1]-this.scoreSet.endGap;else for(var h=d-1;h>=b;h--)this.Sp[h]=this.Sp[h+1]-this.scoreSet.gap;var m;for(var g=c-1;g>=j;g--){k=this.Sp[d],d==this.N.length?m=this.Sp[d]-this.scoreSet.endGap:m=this.Sp[d]-this.scoreSet.gap,this.Sp[d]=m;for(var h=d-1;h>=b;h--)h==0&&g==0?m=Math.max(this.Sp[h]-this.scoreSet.beginGap,Math.max(m-this.scoreSet.beginGap,k+this.scoreSet.getScore(this.M[g+1-1],this.N[h+1-1]))):h==0?m=Math.max(this.Sp[h]-this.scoreSet.beginGap,Math.max(m-this.scoreSet.gap,k+this.scoreSet.getScore(this.M[g+1-1],this.N[h+1-1]))):g==0?m=Math.max(this.Sp[h]-this.scoreSet.gap,Math.max(m-this.scoreSet.beginGap,k+this.scoreSet.getScore(this.M[g+1-1],this.N[h+1-1]))):m=Math.max(this.Sp[h]-this.scoreSet.gap,Math.max(m-this.scoreSet.gap,k+this.scoreSet.getScore(this.M[g+1-1],this.N[h+1-1]))),k=this.Sp[h],this.Sp[h]=m}var n=this.Sn[b]+this.Sp[b],o=b;for(var h=b+1;h<=d;h++)this.Sn[h]+this.Sp[h]>=n&&(n=this.Sn[h]+this.Sp[h],o=h);this.path(a,b,j,o),this.path(j,o,c,d)}}function c(){return this.alignedM.join("")}function d(){return this.alignedN.join("")}function e(a,b,c){this.M=a,this.N=b,this.alignedM=new Array,this.alignedN=new Array,this.scoreSet=c,this.Sn=new Array(this.N.length),this.Sp=new Array(this.N.length),this.score=0}function f(){this.M,this.N,this.alignedM,this.alignedN,this.scoreSet,this.Sn,this.Sp,this.score}return new f,f.prototype.align=a,f.prototype.path=b,f.prototype.setAlignParam=e,f.prototype.getAlignedM=c,f.prototype.getAlignedN=d,f}(),AlignPairQuad=function(){function a(a,b,c){this.scoreSet=c,this.M=a,this.N=b,this.score=0,this.nodes=new Array(this.M.length+1);for(var d=0;d<this.nodes.length;d++){this.nodes[d]=new Array(this.N.length+1);for(var e=0;e<this.nodes[d].length;e++)this.nodes[d][e]=new Node}this.nodes[0][0].value=0;for(var d=1;d<this.nodes.length;d++)this.scoreSet.useBeginGapLeft?this.nodes[d][0].value=this.nodes[d-1][0].value-this.scoreSet.beginGap:this.nodes[d][0].value=this.nodes[d-1][0].value-this.scoreSet.gap,this.nodes[d][0].tracebackI=d-1,this.nodes[d][0].tracebackJ=0;for(var e=1;e<this.nodes[0].length;e++)this.scoreSet.useBeginGapTop?this.nodes[0][e].value=this.nodes[0][e-1].value-this.scoreSet.beginGap:this.nodes[0][e].value=this.nodes[0][e-1].value-this.scoreSet.gap,this.nodes[0][e].tracebackI=0,this.nodes[0][e].tracebackJ=e-1}function b(){outputWindow.document.write("Dynamic programming matrix i="+this.nodes.length+" and j="+this.nodes[0].length),outputWindow.document.write("\n");for(var a=0;a<this.nodes.length;a++){for(var b=0;b<this.nodes[a].length;b++){var c=this.nodes[a][b].tracebackI,d=this.nodes[a][b].tracebackJ;c==undefined&&(c="u"),d==undefined&&(d="u");var e="("+a+","+b+")["+c+","+d+"]="+this.nodes[a][b].value;outputWindow.document.write(rightNum(e,"",20," "))}outputWindow.document.write("\n")}outputWindow.document.write("\n")}function c(){for(var a=1;a<this.nodes.length;a++)for(var b=1;b<this.nodes[0].length;b++){var c,d,e;a==this.nodes.length-1&&b==this.nodes[0].length-1?(this.scoreSet.useEndGapRight?c=this.nodes[a-1][b].value-this.scoreSet.endGap:c=this.nodes[a-1][b].value-this.scoreSet.gap,this.scoreSet.useEndGapBottom?d=this.nodes[a][b-1].value-this.scoreSet.endGap:d=this.nodes[a][b-1].value-this.scoreSet.gap):a==this.nodes.length-1?(c=this.nodes[a-1][b].value-this.scoreSet.gap,this.scoreSet.useEndGapBottom?d=this.nodes[a][b-1].value-this.scoreSet.endGap:d=this.nodes[a][b-1].value-this.scoreSet.gap):b==this.nodes[0].length-1?(this.scoreSet.useEndGapRight?c=this.nodes[a-1][b].value-this.scoreSet.endGap:c=this.nodes[a-1][b].value-this.scoreSet.gap,d=this.nodes[a][b-1].value-this.scoreSet.gap):(c=this.nodes[a-1][b].value-this.scoreSet.gap,d=this.nodes[a][b-1].value-this.scoreSet.gap),e=this.nodes[a-1][b-1].value+this.scoreSet.getScore(this.M[a-1],this.N[b-1]),c>=d&&c>=e?(this.nodes[a][b].value=c,this.nodes[a][b].tracebackI=a-1,this.nodes[a][b].tracebackJ=b):d>=e&&d>=c?(this.nodes[a][b].value=d,this.nodes[a][b].tracebackI=a,this.nodes[a][b].tracebackJ=b-1):(this.nodes[a][b].value=e,this.nodes[a][b].tracebackI=a-1,this.nodes[a][b].tracebackJ=b-1)}this.score=this.nodes[this.nodes.length-1][this.nodes[0].length-1].value}function d(){this.alignedM=new Array,this.alignedN=new Array;var a=this.nodes.length-1,b=this.nodes[0].length-1,c=this.nodes[this.nodes.length-1][this.nodes[0].length-1];while(c.tracebackI!=undefined&&c.tracebackJ!=undefined)c.tracebackI==a-1&&c.tracebackJ==b-1?(this.alignedM.push(this.M.pop()),this.alignedN.push(this.N.pop())):c.tracebackJ==b-1?(this.alignedM.push("-"),this.alignedN.push(this.N.pop())):(this.alignedM.push(this.M.pop()),this.alignedN.push("-")),a=c.tracebackI,b=c.tracebackJ,c=this.nodes[c.tracebackI][c.tracebackJ];this.alignedM=this.alignedM.reverse(),this.alignedN=this.alignedN.reverse()}function e(){return this.alignedM.join("")}function f(){return this.alignedN.join("")}function g(){this.M,this.N,this.scoreSet,this.nodes,this.alignedM,this.alignedN,this.score}return new g,g.prototype.initializeMatrix=a,g.prototype.fillMatrix=c,g.prototype.align=d,g.prototype.getAlignedM=e,g.prototype.getAlignedN=f,g.prototype.dumpMatrix=b,g}(),ScoreSet=function(){function a(a,b){return this.scoringMatrix.scoringMatrix_getScore(a,b)}function b(a,b,c,d){this.scoringMatrix=a,this.gap=b,this.beginGap=c,this.endGap=d}function c(){this.scoringMatrix,this.gap,this.beginGap,this.endGap,this.useBeginGapTop=!0,this.useBeginGapLeft=!0,this.useEndGapBottom=!0,this.useEndGapRight=!0}return new c,c.prototype.getScore=a,c.prototype.setScoreSetParam=b,c}();new ScoringMatrix,ScoringMatrix.prototype.scoringMatrix_getScore=scoringMatrix_getScore,Identity.prototype=new ScoringMatrix,Identity.prototype.setMismatch=setMismatch,Identity.prototype.setMatch=setMatch;var debug=!0,baseLength=breakWidth=20,stemWidth=1.5*baseLength,duplexWidth=stemWidth+baseLength,pi2=2*Math.PI,piHalf=Math.PI/2,phi=Math.PI/4,degenerate={A:["A"],C:["C"],G:["G"],T:["T"],U:["U"],R:["A","G"],Y:["C","T","U"],K:["G","T","U"],M:["A","C"],S:["C","G"],W:["A","T","U"],B:["C","G","T","U"],D:["A","G","T","U"],H:["A","C","T","U"],V:["C","G"],N:["A","C","G","T","U"],X:[]},degenerateDna={};for(var b in degenerate)b!="U"&&(degenerateDna[b]=_.filter(degenerate[b],function(a){return a!="U"}));var degenerateRna={};for(var b in degenerate)b!="T"&&(degenerateRna[b]=_.filter(degenerateRna[b],function(a){return a!="T"}));var degenerateRegexes=_.reduce(_.keys(degenerate),function(a,b){return a[b]=new RegExp("/["+degenerate[b].join("")+"]/i"),a},{}),sequenceRegex=new RegExp(_.reduce(_.keys(degenerate),function(a,b){return a+=b+b.toLowerCase(),a},""));return{mapUnique:mapUnique,absUnique:absUnique,amax:amax,parseComplement:function(){console.warn("DNA.parseComplement is deprecated; please use parseIdentifier"),parseComplement.apply(DNA,arguments)},parseStrandSpec:parseStrandSpec,parseNamedSequences:parseNamedSequences,printSequences:printSequences,matchDegenerate:matchDegenerate,populateDegenerate:populateDegenerate,stripNupackHeaders:stripNupackHeaders,indexTable:indexTable,indexBy:indexBy,tablify:tablify,addReturns:addReturns,reverse:reverse,complement:complement,reverseComplement:reverseComplement,pairwiseAlign:function(a,b,c,d,e,f,g){c||(c=2),d||(d=-1),e||(e=-2),f||(f=0),g||(g=0);var h=!0,i=!1,j=new Identity;j.setMatch(c),j.setMismatch(d);var k=new ScoreSet;k.setScoreSetParam(j,e,f,g);var l;if(h)return l=new AlignPairLinear,l.setAlignParam(a,b,k),l.align(),{sequences:[l.getAlignedM(),l.getAlignedN()],score:l.score};if(i)return l=new AlignPairQuad,l.initializeMatrix(a,b,k),l.fillMatrix(),l.align(),{sequences:[l.getAlignedM(),l.getAlignedN()],score:l.score}},sequenceStats:function(sequence){var list={g:["/g/",1,1],a:["/a/",1,1],t:["/t/",1,1],c:["/c/",1,1],n:["/n/",1],u:["/u/",1,1],r:["/r/",1],y:["/y/",1],s:["/s/",1],w:["/w/",1],k:["/k/",1],m:["/m/",1],b:["/b/",1],d:["/d/",1],h:["/h/",1],v:["/v/",1],gg:["/g(?=g)/",2],ga:["/g(?=a)/",2],gt:["/g(?=t)/",2],gc:["/g(?=c)/",2],gn:["/g(?=n)/",2],ag:["/a(?=g)/",2],aa:["/a(?=a)/",2],at:["/a(?=t)/",2],ac:["/a(?=c)/",2],an:["/a(?=n)/",2],tg:["/t(?=g)/",2],ta:["/t(?=a)/",2],tt:["/t(?=t)/",2],tc:["/t(?=c)/",2],tn:["/t(?=n)/",2],cg:["/c(?=g)/",2],ca:["/c(?=a)/",2],ct:["/c(?=t)/",2],cc:["/c(?=c)/",2],cn:["/c(?=n)/",2],ng:["/n(?=g)/",2],na:["/n(?=a)/",2],nt:["/n(?=t)/",2],nc:["/n(?=c)/",2],nn:["/n(?=n)/",2],"g,c":["/g|c/",1],"a,t":["/a|t/",1],"r,y,s,w,k":["/r|y|s|w|k/",1],"b,h,d,v,n":["/b|h|d|v|n/",1],"r,y,s,w,k,m,b,d,h,v,n":["/r|y|s|w|k|m|b|d|h|v|n/",1]},originalLength=sequence.length,full=[],abbr=[];for(var name in list){var tempNumber=0,matchExp=list[name][0];matchExp=eval(matchExp+"gi"),sequence.search(matchExp)!=-1&&(tempNumber=sequence.match(matchExp).length);var percentage=0,atcguPercent=0;originalLength+1-parseFloat(list[name][1])>0&&(percentage=tempNumber/(originalLength+1-list[name][1])),full.push({name:name,count:tempNumber,percent:percentage.toFixed(2)}),"a c g t u".indexOf(name)!=-1&&tempNumber>0&&abbr.push({name:name,count:tempNumber,percent:percentage.toFixed(2)})}return{full:full,abbr:abbr}},levenshtein:function(a,b){if(a==b)return 0;var c=a.length,d=b.length;if(c===0)return d;if(d===0)return c;var e=!1;try{e=!"0"[0]}catch(f){e=!0}e&&(a=a.split(""),b=b.split(""));var g=new Array(c+1),h=new Array(c+1),i=0,j=0,k=0;for(i=0;i<c+1;i++)g[i]=i;var l="",m="";for(j=1;j<=d;j++){h[0]=j,m=b[j-1];for(i=0;i<c;i++){l=a[i],k=l==m?0:1;var n=g[i+1]+1,o=h[i]+1,p=g[i]+k;o<n&&(n=o),p<n&&(n=p),h[i+1]=n}var q=g;g=h,h=q}return g[c]},hamming:function(a,b){return _.reduce(_.map(_.zip(a.split(""),b.split("")),function(a,b){return a!=b}),function(a,b){return a+b})},generateAdjacency:function(a,b,c,d){c=c||!1,d||(d={}),_.defaults(d,{strandValue:9,hybridizationValue:2,persistenceValue:18,radius:300,segments:{},segmentLabels:!1,persistenceLength:2});var e=[],f=[],g=[],h=0,i,j=0,k=0,l=0,m=Math.PI/a.length,n=null;if(d.segmentLabels){var o=_.keys(d.segments),p={};for(var q=0;q<o.length-1;q++)p[Math.round((o[q]+o[q+1])/2)]=d.segments[o[q]]}for(var q=0;q<a.length;q++){if(a[q]=="+")h++,j--,k=0;else{d.segments[q]&&(n=d.segments[q]),i={strand:h,nodeName:b&&b[h]?b[h][k]:!1,base:b&&b[h]?b[h][k]:!1,segment:n};if(a[q]=="(")g.push(j);else if(a[q]==")"){var r={source:g.pop(),target:j,value:d.hybridizationValue,type:"wc"};d.ppairs&&(d.ppairs[r.source+1]&&d.ppairs[r.source+1][r.target+1]?(r.probability=parseFloat(d.ppairs[r.source+1][r.target+1]),i.probability=r.probability,e[r.source]&&(e[r.source].probability=r.probability)):d.ppairs[r.target+1]&&d.ppairs[r.target+1][r.source+1]&&(r.probability=parseFloat(d.ppairs[r.target+1][r.source+1]),i.probability=r.probability,e[r.target]&&(e[r.target].probability=r.probability)),!r.probability),f.push(r)}e.push(i),c&&(j>0&&a[q-1]!="+"&&f.push({source:j,target:j-1,value:d.strandValue,type:"strand"}),!!d.persistenceLength&&j>d.persistenceLength&&a[q-d.persistenceLength]!="+"&&f.push({source:j,target:j-d.persistenceLength,value:d.persistenceValue,type:"persistence"})),l+=m}j++,k++}return{nodes:e,links:f}},generateAdjacency2:function(a,b){b||(b={}),_.defaults(b,{strandValue:9,hybridizationValue:2,radius:300,segments:{},segmentLabels:!1,linkStrands:!1});var c=b.linkStrands,d=[],e=[],f=[],g=0,h,i=0,j=0,k=0,l=null,i=0;for(var g=0;g<a.length;g++){var m=a[g],n=m.strand;if(m.structure)for(var o=0;o<m.structure.length;o++){var p=m.structure[o],q=p.segment,r=p.type,s=q.getSequence();for(var t=0;t<p.length;t++){h={strand:n,segment:q.getIdentifier(),base:s[t],domain:q.getDomain().getName(),role:q.getDomain().role,segment_index:t,segment_length:p.length};if(r=="(")f.push(i);else if(r==")"){var u={source:f.pop(),target:i,value:b.hybridizationValue,type:"wc"};e.push(u)}d.push(h),c&&o+t>0&&e.push({source:i,target:i-1,value:b.strandValue,type:"strand"}),i++}}}return{nodes:d,links:e}},generateAdjacency3:function(a,b,c){c||(c={}),_.defaults(c,{sequences:{},strandValue:9,hybridizationValue:2,persistenceValue:18,radius:300,segments:{},segmentLabels:!1,persistenceLength:2,linkStrands:!0});var d=[],e=[],f=[],g=[],h=[],i=DNA.hashComplements(c.sequences)||{},j=0,k,l=0,m=0;a=_.filter(a.split(""),function(a){return!!a.trim()});var n=0,o=0;for(var p=0;p<b.length;p++){var q=b[p],l=0;for(var r=0;r<q.domains.length;r++){var s=q.domains[r],t=0;for(var u=0;u<s.segments.length;u++){var v=s.segments[u],w=v.getIdentifier?v.getIdentifier():v.identifier?v.identifier:v.name,x=DNA.parseIdentifier(w),y=v.sequence?v.sequence:i[w];for(var z=0;z<y.length;z++){k={strand:q.name,domain:s.name,domain_role:s.role,segment:w,segment_role:v.role,segment_identity:x.identity,segment_polarity:x.polarity,segment_length:y.length,base:y[z],segment_index:z,domain_index:t,strand_index:l};if(a[n]=="(")h.push(o);else if(a[n]==")"){var A={source:h.pop(),target:o,value:c.hybridizationValue,type:"wc"};e.push(A)}d.push(k),c.linkStrands&&(l>0&&f.push({source:o,target:o-1,type:"strand",value:c.strandValue,segment:v?v.name:null,segment_identity:x?x.identity:null,domain:s?s.name:null,domain_role:s?s.role:null}),!!c.persistenceLength&&l>c.persistenceLength&&g.push({source:o,target:o-c.persistenceLength,value:c.persistenceValue,type:"persistence"})),l++,t++,o++}n++}}if(!!a[n]&&a[n]!="+")throw Error("Structure specification does not match strand specification. ");n++}return{nodes:d,links:e.concat(g).concat(f),strands:b}},generateAdjacency4:function(a,b,c){c||(c={}),_.defaults(c,{sequences:{},extraData:{},strandValue:9,hybridizationValue:2,persistenceValue:18,radius:300,persistenceLength:2,linkStrands:!0}),a=DNA.dotParenToBaseMap(a),a=a.map;var d=[],e=[],f=[],g=[],h=[],i=DNA.hashComplements(c.sequences)||{},j=c.extraData,k=0,l,m=0,n=0;h=h.concat(j.links||[]);var o=0,p=0;for(var q=0;q<b.length;q++){var r=b[q],m=0;for(var s=0;s<r.domains.length;s++){var t=r.domains[s],u=0;for(var v=0;v<t.segments.length;v++){var w=t.segments[v],x=w.getIdentifier?w.getIdentifier():w.identifier?w.identifier:w.name,y=DNA.parseIdentifier(x),z=w.sequence?w.sequence:i[x];for(var A=0;A<z.length;A++){l={strand:r.name,domain:t.name,domain_role:t.role,segment:x,segment_role:w.role,segment_identity:y.identity,segment_polarity:y.polarity,segment_length:z.length,base:z[A],segment_index:A,domain_index:u,strand_index:m},j.bases&&j.bases[p]&&_.extend(l,j.bases[p]);if(a[p]&&p>a[p]){var B={source:a[p],target:p,value:c.hybridizationValue,type:"wc"};e.push(B)}d.push(l),c.linkStrands&&(m>0&&f.push({source:p,target:p-1,type:"strand",value:c.strandValue,segment:w?w.name:null,segment_identity:y?y.identity:null,domain:t?t.name:null,domain_role:t?t.role:null}),!!c.persistenceLength&&m>c.persistenceLength&&g.push({source:p,target:p-c.persistenceLength,value:c.persistenceValue,type:"persistence"})),m++,u++,p++}o++}}o++}return{nodes:d,links:e.concat(g).concat(f).concat(h),strands:b}},expandStructure:function(a,b,c,d){d||(d=!1),b=_.map(b,function(a){return _.comprehend(a.domains,function(a){return a.segments})});var a=_.map(a.split("+"),function(a){return _.filter(a.split(""),function(a){return!!a&&a!=" "})}),e=[];if(d){var f={},g=[];for(var h=0;h<a.length;h++){var i=a[h];for(var j=0;j<i.length;j++){i[j]=="("&&g.push([h,j]);if(i[j]==")"){var k=g.pop();f[k[0]]||(f[k[0]]={}),f[k[0]][k[1]]=[h,j],f[h]||(f[h]={}),f[h][j]=k}}}for(var h=0;h<b.length;h++){var l=a[h],m=b[h],n=[];for(var j=0;j<m.length;j++){var o=m[j].identity?m[j].identity:DNA.parseIdentifier(m[j].name).identity,p=c[o],q=f[h]?f[h][j]:null,r,s,t;q&&b[q[0]]&&b[q[0]][q[1]]&&(r=b[q[0]][q[1]],s=r.identity?r.identity:DNA.parseIdentifier(r.name).identity,t=c[s]),u=l[j],t?u=="("&&p.length>t.length?n.push(Array(p.length-t.length+1).join(".")+Array(t.length+1).join(u)):u==")"&&p.length>t.length?n.push(Array(t.length+1).join(u)+Array(p.length-t.length+1).join(".")):n.push(Array(p.length+1).join(u)):n.push(Array(p.length+1).join(u))}e.push(n.join(""))}}else for(var h=0;h<b.length;h++){var l=a[h],m=b[h],n=[];for(var j=0;j<m.length;j++){var o=m[j].identity?m[j].identity:DNA.parseIdentifier(m[j].name).identity,p=c[o],u=l[j];n.push(Array(p.length+1).join(u))}e.push(n.join(""))}return e.join("+")},expandStrands:function(a){return _.map(a,function(a,b){return _.isArray(a)?a={name:"S"+b,domains:a}:a=_.clone(a),a.domains=_.map(a.domains,function(a,b){return _.isArray(a)?a={name:"d"+b,segments:a,role:null}:a=_.clone(a),a.segments=_.map(a.segments,function(a,b){_.isString(a)?a={name:a,role:null}:_.isNumber(a)?a={name:""+a,role:null}:a=_.clone(a);if(a.name&&!a.identity){var c=DNA.parseIdentifier(a.name);a.identity=c.identity,a.polarity=c.polarity}else a.identity&&a.polarity&&!a.name&&(a.name=DNA.makeIdentifier(a.identity,a.polarity));return a}),a}),a})},DUtoDotParen:function(a){function c(a,e){e||(e=[]),a=a.trim();var f=a.match(b);if(!f||f.length!=4)return{rest:"",stack:e};var g=f[1],h=parseInt(f[2]),i=f[3];switch(g){case"D":case"H":i=i.trim();if(i[0]=="("){e.push(h);var j=d(i,e);return j.dp=Array(h+1).join("(")+j.dp+Array(h+1).join(")"),j}var j=c(i,e);return j.dp=Array(h+1).join("(")+j.dp+Array(h+1).join(")"),j;case"U":return{rest:i,dp:Array(h+1).join("."),stack:e};case"+":return{rest:i,dp:"+",stack:e}}}function d(a,b){var d=a,e=[];do{d=d.trim();if(d[0]==")"){var f=b.pop(),d=d.substr(1);return{rest:d,dp:e.join(""),stack:b}}var g=c(d,b);b=g.stack,d=g.rest,e.push(g.dp)}while(d!="");return{rest:d,dp:e.join(""),stack:b}}var b=/([+HhDdUu])(\d*)s?(.*)/,e=d(a,[]);return e.dp},validateDotParen:function(a,b,c){b||(b=!1),c||(c=!1);var d=0,e=0,f="",g=0,h=[];a+="\n";for(var i=0;i<a.length;i++){var j=a[i];if(j===" ")continue;if(c&&!/[\.\(\)\+\s]/.test(j))return b?"Unrecognized character '"+j+"' at position "+i:!1;if(j==f)g++;else{if(g!=0){f=="("&&(d+=g),f==")"&&(e+=g);if(e>d)return b?"Unopened parenthesis: number of closing parentheses exceeds number of open parentheses at position "+i+" by "+(e-d)+".":!1}f=j,g=1}}return b&&d!=e?"Unclosed parenthesis: "+(d-e)+" parentheses left unclosed at end of structure.":d==e},parseDotParen:function(a){function g(a){var b=[];while(a.length>0)b=b.concat(h(a,0));return b}function h(a,b){var c=[],d;do{d=a.shift();while(a.length>0&&d[0]!="("&&d[0]!=")")c.push(d),d=a.shift();if(d)if(d[0]==")"){var e=b,f=d;e>f[1]?(b=e-f[1],c=[["D",f[1],c]]):f[1]>e?(a.unshift([")",f[1]-e]),b=0,c=[["D",e,c]]):(b=0,c=[["D",f[1],c]])}else d[0]=="("?c=c.concat(h(a,d[1])):c=c.concat([d])}while(b>0&&a.length>0);if(b>0&&a.length==0)throw Error();return c}var b=0,c=0,d="",e=0,f=[];_.each(a.split("").concat(null),function(a){if(a===" ")return;a==d?e++:(e!=0&&(f.push([d,e]),d=="("&&(b+=e),d==")"&&(c+=e)),d=a,e=1)});if(b!=c)throw Error("Structure parsing error: In dot-paren structure '"+a+"', unmatched parentheses: "+b+" open, "+c+" close parenthesis");return g(f,[])},dotParenToDU:function(a){var b=DNA.parseDotParen(a);return DNA.printDUPlus(b)},dotParenToBaseMap:function(a){var b={},c={},d=[],e=0,f;for(var g=0;g<a.length;g++)a[g]=="("?(d.push(e),e++):a[g]==")"?(f=d.pop(),b[e]=f,b[f]=e,e++):a[g]=="."?e++:a[g]=="+"&&(c[e]=!0);return{map:b,breaks:c}},printDUPlus:function(a){return _.map(a,function(a){switch(a[0]){case"U":case".":return"U"+a[1];case"+":return"+";case"H":case"D":if(a[2]&&a[2].length>0)return"D"+a[1]+"("+DNA.printDUPlus(a[2])+")"}}).join(" ")},getScale:getScale,getOffset:getOffset,getBounds:getBounds,arrangeLayout:arrangeLayout,layoutStructure:layoutStructure,normalizeSystem:function(a){var b=_.map(a,parseStrandSpec),c=absUnique(_.flatten(b)).sort(function(a,b){return a-b}),d=mapUnique(c,1),e=[];return _.each(b,function(a){var b=[];_.each(a,function(a){b.push(sign(a)*d[Math.abs(a)])}),e.push(b)}),e},encodeStrand:function(a){return _.map(a,function(a){return Math.abs(a)+(sign(a)<0?"*":"")}).join(" ")},threadSegments:function(a,b,c){c=c==undefined?!0:c;var d=_.isArray(b)?_.map(b,function(a){return _.isObject(a)?a:_.isNumber(a)?{identity:Math.abs(a),polarity:sign(a)}:DNA.parseIdentifier(a)}):parseStrandSpec(b," "),e=[],f;if(_.isArray(a))for(var g=0;g<d.length;g++){f=d[g];if(!a[parseInt(f.identity)-1])throw Error("Threading error: Undefined segment "+f);f.polarity>0?e.push(a[parseInt(f.identity)-1]):e.push(reverseComplement(a[parseInt(f.identity)-1]))}else for(var g=0;g<d.length;g++)f=d[g],a[f.identity]&&(f.polarity==1?e.push(a[f.identity]):e.push(reverseComplement(a[f.identity])));return c?e.join(""):e},unthreadSegments:function(a,b){},parseSequences:function(a,b,c){},hashComplements:function(a){a=_.clone(a);for(var b in a)if(_.has(a,b)){var c=DNA.makeIdentifier(b,-1);a[c]||(a[c]=DNA.reverseComplement(a[b]))}return a},structureSpec:function(a){var b={},c={},d={},e={},f=[];return _.each(a,function(a){if(a.length>0)if(a[0][1]=="structure"){var g=a[1][1],h=_.select(a.slice(3),function(a){return a[0]=="nupack-huplus"});h=_.pluck(h,1),h=h.join(""),d[g]=h}else if(a[0][1]=="sequence"||a[0][1]=="domain"||a[0][1]=="segment"){var g=a[1][1],h=_.select(a.slice(3),function(a){return a[0]=="number"||a[0].indexOf("sequence")!=-1});if(h[0][0]=="number"){var i=h[1][1],j=parseInt(h[0][1]),h="";h=Array(j+1).join(i)}else if(h.length>1&&h[1][0]=="number"){var i=h[0][1],j=parseInt(_.pluck(h.slice(1),1).join("")),h="";h=Array(j+1).join(i)}else h=_.pluck(h,1).join("");b[g]=h}else if(a[0][1]=="strand"){var g=a[1][1],h=_.select(a.slice(3),function(a){return a[0]=="string"});h=_.pluck(h,1),h=h.join(" "),c[g]=h}else if(a[0][0]!="variable"||!a[1]||a[1][1]!=":"&&a[1][1]!="=")f.push(a);else{var g=a[0][1],h=_.select(a.slice(2),function(a){return a[0]=="string"});h=_.pluck(h,1),g.indexOf(".seq")!=-1?(g=g.replace(".seq",""),h=_.compact(h),e[g]=h):(h=h.join(" "),c[g]=h)}}),{domains:b,strands:c,structures:d,complexes:e,others:f}},defaultPolaritySpecifier:"*",makeIdentifier:function(a,b){return a+(b==-1?this.defaultPolaritySpecifier:"")},printIdentifier:function(a){return DNA.makeIdentifier(a.identity||a.name,a.polarity)},parsePolarity:function(a){return _.isNumber(a)?this.signum(a):a=="-"?-1:a=="+"?1:0},getPolarity:function(a){return a?a[a.length-1]=="*"||a[a.length-1]=="'"?-1:1:0},parseIdentifier:function(a){return a=a.trim(),{identity:this.normalizeIdentity(a),polarity:this.getPolarity(a)}},normalizeIdentity:function(a){return this.getPolarity(a)==-1?a.substring(0,a.length-1):a},hashBy:function(a,b){return _.reduce(a,function(a,c){a[c[b]]=c},{})},signum:function(a){return sign(a)},sign:sign}}(_);
typeof require=="function"&&(_=require("underscore"),DNA=require("./dna-utils.js").DNA),typeof module=="undefined"&&(module={}),typeof App=="undefined"&&(App={}),App.dynamic=module.exports=function(a,b){function c(b){return a.invoke(b,"getLength")}function d(b){return a.invoke(b,"getName")}function e(b){return a.invoke(b,"getIdentifier")}function f(b){return a.reduce(b,function(a,b){return a+b},0)}function g(a){return a}function h(b){return a.range(0,b)}function i(b,c){var d=a.clone(b);return c==-1&&d.reverse(),d}function j(c){if(!c.library)throw new q({type:"no library",message:"Motif <%= motif.getName() %> instantiated without library reference",motif:this,config:c});if(c.nodes){var d=r.fromMotif(c);try{d=d.compile()}catch(e){throw e.message&&(e.message=["In motif",c.name,":\n",e.message].join(" ")),new q(e)}a.extend(this,d.toMotif()),delete c.nodes,delete c.motifs,delete c.imports,!!this.structure}else delete c.externalMotifs;a.copyTo(this,c),a.defaults(this,{name:"",type:"hairpin",polarity:0,isInitiator:!1}),this.isInitiator=this.isInitiator||this.type=="initiator";var f={};if(this.structure){var g=this.structure;a.isArray(g)||(g=[g]),g=a.map(g,function(a){return o.parseMultiple(a)}),f=a.first(g)}if(this.strands)this.strands=a.map(this.strands,function(a,b){return a.name&&f[a.name]?a.structure=f[a.name]:f[b]&&(a.structure=f[b]),a.library=this.library,new l(a)},this);else if(this.domains){var h=f[0];this.strands=[new l({name:this.name||"s1",library:this.library,domains:this.domains,structure:h})]}a.each(this.getDomains(),function(a){a.polarity||(a.polarity=1)},this),this.polarity=b.parsePolarity(this.polarity),j.types[this.type]&&j.types[this.type](this),this.library.register("motif",this.name,this)}function k(b){if(!b.library)throw new q({type:"no library",message:"node instantiated without library reference; can't decode motif",node:this,config:b});this.library=b.library;if(b.motif){var c=b.library.getMotif(b.motif);a.copyTo(this,c)}a.isString(b.domains)&&(b.domains=s.parseDomainString(b.domains));var d=a.reduce(b.domains||[],function(a,b){return a[b.name]=b,a},{}),e=a.reduce(b.strands||[],function(a,b){return a[b.name]=b,a},{});b.motif&&(delete b.domains,delete b.strands),a.copyTo(this,b),a.defaults({type:"hairpin",polarity:0});if(this.domains&&!this.strands)this.strands=[new l({library:this.library,domains:this.domains,node:this,structure:this.structure})];else{var f=this.structure?o.parseMultiple(this.structure):[];this.strands=a.map(this.strands,function(b,c){return b=a.copyWith(b,e[b.name]||{}),a.isString(b.domains)&&(b.domains=s.parseDomainString(b.domains)),b.domains=a.map(b.domains,function(b){return d[b.name]&&(b=a.copyWith(b,d[b.name])),b},this),!b.structure&&f[c]&&(b.structure=f[c]),b.name||(b.name=this.strands.length>1?"strand"+c:""),b.library=this.library,new l(a.copyWith(b,{node:this}))},this)}this.isInitiator&&!this.polarity&&(this.polarity=-1),k.types[this.type]&&k.types[this.type](this),this.library.register("node",this.name,this)}function l(c){if(!c.library)throw new q({type:"no library",message:"strand instantiated without library reference",strand:this,config:c});a.copyTo(this,c),a.defaults(this,{}),a.isString(this.domains)&&(this.domains=s.parseDomainString(this.domains)),this.domains=a.map(this.domains,function(b){return a.isString(b)&&(b=a.first(s.parseDomainString(b))),new m(a.copyWith(b,{strand:this,library:this.library}))},this),this.structure=new o(this.structure),this.polarity=b.parsePolarity(this.polarity),this.polarity==0&&(this.polarity=1)}function m(c){if(!c.library)throw new q({type:"no library",message:"domain instantiated without library reference",domain:this,config:c});a.copyTo(this,c),a.defaults(this,{segments:[]}),a.isString(this.segments)&&(this.segments=s.parseSegmentString(this.segments)),this.segments=a.map(this.segments,function(b){return new n(a.copyWith(b,{domain:this,library:this.library}))},this),this.polarity=b.parsePolarity(this.polarity)}function n(c){a.copyTo(this,c),a.defaults(this,{role:"",sequence:""}),this.length&&(this.segmentLength=this.length),this.sequence&&(this.segmentLength=this.sequence.length),this.segmentLength||(this.segmentLength=this.getParameter("segmentLength")),this.name&&!this.identity?a.extend(this,b.parseIdentifier(this.name)):this.identity&&this.polarity&&!this.name&&(this.name=b.makeIdentifier(this.identity,this.polarity)),this.id=n.getId(),this.getLibrary().register("segment",this.id,this)}function o(b){var c,d;a.isString(b)&&(c=b,c.match(".")?d="dot-paren":c.match(/[DHU]+/gi)&&(c=c.replace("H","D"),d="DU+"),b={spec:c,type:d}),a.copyTo(this,b),a.defaults(this,{})}function p(a){this.library=a.library;if(!a.library)throw new q({type:"no library",message:"complement instantiated without library reference; can't decode node references",complement:this,complements:[this],config:a});this.sourceNode=this.library.getNode(a.sourceNode),this.targetNode=this.library.getNode(a.node),this.sourcePort=this.sourceNode?this.sourceNode.getDomain(a.source):null,this.targetPort=this.targetNode?this.targetNode.getDomain(a.target):null;if(this.sourceNode==null)throw new q({type:"phantom complement",message:"Complementarity generated with no sourceNode",config:a,sourceNode:a.sourceNode,targetNode:a.node,sourcePort:a.source,targetPort:a.target,nodes:[a.sourceNode,a.targetNode],ports:[a.source,a.target],complements:[this]});if(this.targetNode==null)throw new q({type:"invalid complement",message:"In complement from Node <%= sourceNode %>, target node <%= targetNode %>, was not found.",sourceNode:a.sourceNode,targetNode:a.node,sourcePort:a.source,targetPort:a.target,nodes:[a.sourceNode,a.targetNode],ports:[a.source,a.target],complements:[this]});if(this.sourcePort==null)throw new q({type:"invalid complement",message:"In complement between Node <%= sourceNode %> and Node <%= targetNode %>, source port <%= sourcePort %> not found.",sourceNode:a.sourceNode,targetNode:a.node,sourcePort:a.source,targetPort:a.target,nodes:[a.sourceNode,a.targetNode],ports:[a.source,a.target],complements:[this]});if(this.targetPort==null)throw new q({type:"invalid complement",message:"In complement between Node <%= sourceNode %> and Node <%= targetNode %>, target port <%= targetPort %> not found.",sourceNode:a.sourceNode,targetNode:a.node,sourcePort:a.source,targetPort:a.target,nodes:[a.sourceNode,a.targetNode],ports:[a.source,a.target]})}function q(b){b.message&&(b.message=a.template(b.message,b)),a.copyTo(this,b)}function r(b){a.copyTo(this,b),this.motifs=a.clone(this.motifs),this.nodes=a.clone(this.nodes),this["import"]=a.clone(this["import"]),a.defaults(this,{motifs:[],nodes:[],"import":[],includes:[],objects:{node:{},motif:{},segment:{}},parameters:{}}),a.defaults(this.parameters,{segmentLength:8,toeholdLength:8,clampLength:2})}a.mixin({serialize:function(b,c){c||(c=!1);if(b&&b.serialize&&a.isFunction(b.serialize))return b.serialize(c);if(a.isArray(b)){var d=[];for(var e=0,f=b.length;e<f;e++)d.push(a.serialize(b[e],!0));return d}if(a.isObject(b)){var d={};for(var g in b)a.has(b,g)&&(d[g]=a.serialize(b[g],!0));return d}return b},copy:function(b){return a.copyTo({},b)},copyTo:function(b,c){for(var d in c)a.has(c,d)&&(b[d]=c[d]);return b},copyWith:function(b,c){return a.extend(a.copy(b),c)},deepClone:function(b){var c;return a.isObject(b)?(c={},a.each(b,function(b,d){c[d]=a.deepClone(b)})):a.isArray(b)?c=a.map(b,a.deepClone):c=b,c},comprehend:function(b,c,d,e){return e&&(c=a.bind(c,e)),d||(d=[]),a.reduce(b,function(a,b,d){return a=a.concat(c(b,d)),a},d)},reverse:function(b){var c=a.clone(b);return c.reverse(),c}}),j.prototype={getPolarity:function(){return this.polarity},getStructure:function(){var b=o.join(a.map(this.getStrands(),function(a){return a.getStructure()}));return this.getPolarity()==-1?b.reverse():b},getOrderedStructure:function(){var b=o.join(a.map(this.getStrands(),function(a){var b=a.Structure();return a.getPolarity()==-1?b.reverse():b}));return this.getPolarity()==-1?b.reverse():b},getSegmentwiseStructure:function(){return o.join(a.map(this.getStrands(),function(a){return a.getSegmentwiseStructure()}))},getOrderedSegmentwiseStructure:function(){var b=o.join(a.map(this.getStrands(),function(a){var b=a.getSegmentwiseStructure();return a.getPolarity()==-1?b.reverse():b}));return this.getPolarity()==-1?b.reverse():b},getAnnotatedStructure:function(){var b=a.map(this.getStrands(),function(a){return{strand:a,structure:a.getAnnotatedStructure(),dotParen:a.getStructure().toDotParen()}});return b.dotParen=this.getStructure().toDotParen(),b},instantiate:function(a){return a.motif=this.name,new k(a)},getSegments:function(){return a.flatten(a.map(this.getDomains(),function(a){return a.getSegments()}))},getOrderedSegments:function(){return a.clone(a.comprehend(this.getOrderedStrands(),function(a){return a.getOrderedSegments()}))},getOrderedSegmentLengths:function(){return a.comprehend(this.getOrderedStrands(),function(a){return a.getOrderedSegmentLengths()})},getDomains:function(){return a.flatten(a.map(this.getStrands(),function(a){return a.getDomains()}))},getOrderedDomains:function(){return i(a.comprehend(this.getOrderedStrands(),function(a){return a.getOrderedDomains()}),this.getPolarity())},getStrands:function(){return this.strands},getOrderedStrands:function(){return i(this.getStrands(),this.getPolarity())},getDomain:function(b){return a.find(this.getDomains(),function(a){return a.name==b})},getName:function(){return this.name},serialize:function(){var b=a.copy(this);return b.library&&delete b.library,b.domains&&delete b.domains,a.serialize(b)}},a.extend(j,{types:{hairpin:function(b){a.each(b.getDomains(),function(a){a.role=="output"&&!a.type&&(a.polarity==-1?a.type=="loop":a.polarity==1&&a.type=="tail")})}},nextName:function(){var a=0;return function(){return a++,"m"+a}}(),motifs:{},register:function(a,b){return this.motifs[a]=b,b},get:function(a){return a instanceof j?a:this.motifs[a]}}),a.extend(k.prototype,j.prototype),a.extend(k.prototype,{polarity:0,getConstraintMatrix:function(){var b=this.getSegments();return a.reduce(b,function(c,d){return c[d.getId()]=a.reduce(b,function(a,b){return d.getIdentity()==b.getIdentity()&&d.getId()!=b.getId()&&(a[b.getId()]=b.polarity*d.polarity),a},{}),c},{})},getSegmentIdentityMatrix:function(){function d(a,b){c[a]||(c[a]=[]),c[a].push(b)}var b=this.getSegments(),c={};return a.each(b,function(a){d(a.identity,a)}),c},getSequences:function(){var a=this.getSegments(),c={},d;for(var e=0;e<a.length;e++)d=a[e],c[d.getIdentity()]=d.getPolarity()==-1?b.reverseComplement(d.getSequence()):d.getSequence();return c},serialize:function(){var b=a.copy(this);return b.motif&&!a.isString(b.motif)&&b.motif.getName&&(b.motif=b.motif.getName()),b.domains&&delete b.domains,b.library&&delete b.library,a.serialize(b)}}),a.extend(k,{types:{hairpin:function(b){a.each(b.getDomains(),function(a){a.role=="output"&&!a.type&&(a.polarity==-1?a.type=="loop":a.polarity==1&&a.type=="tail")})}},nodes:{},register:function(a,b){return this.nodes[a]=b,b},get:function(a){return a instanceof k?a:this.nodes[a]}}),l.prototype={getNode:function(){return this.node},getName:function(){return this.name},getQualifiedName:function(){var a=[this.getNode().name];return this.getName()&&a.push(this.getName()),a.join("_")},getAbsolutePolarity:function(){return this.node?this.node.getPolarity()*this.getPolarity():this.getPolarity()},getPolarity:function(){return this.polarity},getSegments:function(){return a.comprehend(this.getDomains(),function(a){return a.getSegments()})},getOrderedSegments:function(){return i(a.comprehend(this.getDomains(),function(a){return a.getSegments()}),this.getAbsolutePolarity())},getDomains:function(){return this.domains},getOrderedDomains:function(){return i(this.getDomains(),this.getPolarity())},getDomain:function(b){return a.find(this.getDomains(),function(a){return a.name==b})},getSegmentLengths:function(){return c(this.getSegments())},getOrderedSegmentLengths:function(){return c(this.getOrderedSegments())},getLength:function(){return f(this.getSegmentLengths())},getSegmentwiseStructure:function(){return this.structure},getAnnotatedStructure:function(){var b=-1,c=this.getSegments();return a.map(this.structure.toDotParen().split(""),function(a){return a!="+"?(b++,{type:a,segment:c[b],length:c[b].getLength()}):{type:a}})},getStructure:function(){try{var a=this.structure,b=a.expand(this.getSegmentLengths());return this.getPolarity()==-1&&(b=b.reverse()),b}catch(c){throw c.message="In strand "+this.getQualifiedName()+", "+c.message,c}},getSequence:function(){var c=a.map(this.getSegments(),function(a){return a.getSequence()}).join("");return this.getAbsolutePolarity()==-1?b.reverse(c):c},printDomains:function(a){return s.printDomainString(this.getDomains(),this.getAbsolutePolarity(),a)},orphan:function(){return this.polarity=this.getAbsolutePolarity(),delete this.node,this},serialize:function(){var b=a.copy(this);return b.node&&delete b.node,b.library&&delete b.library,a.serialize(b)}},m.prototype={role:"structural",getAbsolutePolarity:function(){return this.getPolarity()*this.getStrand().getPolarity()*this.getNode().getPolarity()},getSegments:function(){return this.segments},getStrand:function(){return this.strand},getNode:function(){return this.getStrand().getNode()},getName:function(){return this.name},getPolarity:function(){return this.polarity},serialize:function(){var b=a.copy(this);return b.strand&&delete b.strand,b.node&&delete b.node,b.library&&delete b.library,a.serialize(b)}},m.fromString=function(a,b){var c=s.parseDomainString(a);return c.library=b,new m(c)},n.prototype={getId:function(){return this.id||(this.id=n.getId()),this.id},getName:function(){return this.name},getFullName:function(){var a=this.getDomain(),b=this.getNode();return[b.getName(),a.getName(),this.getName()].join(".")},getQualifiedName:function(){return b.makeIdentifier(b.normalizeIdentity(this.name),this.polarity)},getIdentity:function(){return this.identity},getIdentifier:function(){return this.identity+(this.polarity==-1?b.defaultPolaritySpecifier:"")},getPolarity:function(){return this.polarity},getNode:function(){return this.getDomain().getNode()},getDomain:function(){return this.domain},getAbsolutePolarity:function(){var a=this.getNode().polarity,b=this.getDomain().polarity;return a*b*this.polarity},getSequence:function(){return this.sequence&&this.sequence.length==this.segmentLength?this.sequence:(new Array(this.segmentLength+1)).join("N")},getLength:function(){return this.sequence?this.sequence.length:this.segmentLength},duplicate:function(){return a.copy(this)},serialize:function(){var b=a.copy(this);return b.strand&&delete b.strand,b.domain&&delete b.domain,b.node&&delete b.node,b.library&&delete b.library,a.serialize(b)},getLibrary:function(){return this.library},getParameter:function(a){switch(a){case"segmentLength":if(this.library)return this.library.getParameter("segmentLength",this);return 6;default:return""}}},a.extend(n,{segments:{},register:function(a,b){return this.segments[a]=b,b},get:function(a){return a instanceof n?a:this.segments[a]},getId:function(){var a=0;return function(){return a++,"segment_"+a}}()}),a.extend(o.prototype,{toDotParen:function(){if(this.type=="dot-paren")return this.spec;if(this.type=="DU+")return b.DUtoDotParen(this.spec);throw new q({type:'Conversion from structure type "<%= structure_type %>" to dot-paren is not supported',structure_type:this.type})},toDUPlus:function(){if(this.type=="DU+")return this.spec;if(this.type=="dot-paren")return b.dotParenToDU(this.spec);throw new q({type:'Conversion from structure type "<%= structure_type %>" to DU+ is not supported',structure_type:this.type})},reverse:function(){if(this.type=="dot-paren")return new o(a.chain(this.spec.split("")).reverse().map(function(a){return a=="("?")":a==")"?"(":a}).value().join(""));throw new q({type:"unimplemented"})},expand:function(a){var b=this.spec,c=[],d,e;if(a.length!=b.length)throw new q({type:"structure size mismatch",message:"Structure '<%= structure %>' (length: <%= structureLength %>) is <%= rel %> than segment count (<%= segmentLength %>)",structure:b,structureLength:b.length,rel:b.length>a.length?"longer":"shorter",segmentLength:a.length,lengths:a});for(var f=0;f<a.length;f++)d=a[f],e=b[f],c.push(Array(d+1).join(e));return new o(c.join(""))}}),a.extend(o,{parseMultiple:function(b){if(a.isObject(b)){var c=b.spec||"",d=c.split("+");if(b.order)return d=a.reduce(b.order,function(a,b,c){return a[index]=new o(d[c]),a},{}),d}else d=b.split("+");return a.map(d,function(a){return new o(a)})},parseDUPlus:function(a){},DUtoDotParen:function(a){return b.DUtoDotParen(a)},dotParenToDU:function(a){return b.dotParenToDU(a)},join:function(b){return new o({spec:a.map(b,function(a){return a.toDotParen()}).join("+"),type:"dot-paren"})}}),p.prototype={getSourceDomain:function(){return this.sourcePort},getSourcePort:function(){return this.sourcePort},getTargetDomain:function(){return this.targetPort},getTargetPort:function(){return this.targetPort},getType:function(){if(this.getTargetPort().role=="input"&&this.getSourcePort().role=="output")return"output";if(this.getTargetPort().role==this.getSourcePort().role=="bridge")return"bridge"},serialize:function(){var b=a.copy(this);return b.sourceNode&&!a.isString(b.sourceNode)&&(b.sourceNode=b.sourceNode.getName()),b.targetNode&&!a.isString(b.targetNode)&&(b.targetNode=b.targetNode.getName()),b.sourcePort&&!a.isString(b.sourcePort)&&(b.sourcePort=b.sourcePort.getName()),b.targetPort&&!a.isString(b.targetPort)&&(b.targetPort=b.targetPort.getName()),b.strand&&delete b.strand,b.domain&&delete b.domain,b.node&&delete b.node,b.library&&delete b.library,a.serialize(b)}},q.prototype.serialize=function(){return a.serialize(a.copy(this))},r.prototype={setup:function(b){b||(b=!1);var c=this;c.includes&&(c.includes=a.map(c.includes,function(a){return s.fromDil(a)})),c["import"]&&a.each(c["import"],function(a){if(a.type&&a.name)switch(a.type){case"motif":var b=this.searchIncludes(a.type,a.name);b||(b=s.importObject(a.type,a.name,c.version));if(!b)throw new q({type:"unresolved import",message:'Unable to import <%= importType %> "<%= importName %>"; the object could not be found.',importType:a.type,importName:a.name});c.motifs.unshift(b);break;case"node":var b=this.searchIncludes(a.type,a.name);b||(b=s.importObject(a.type,a.name,c.version));if(!b)throw new q({type:"unresolved import",message:'Unable to import <%= importType %> "<%= importName %>"; the object could not be found.',importType:a.type,importName:a.name});c.nodes.unshift(b);break;default:}},this),c.motifs=a.reduce(c.motifs,function(b,d){return d=a.copyWith(d,{library:c}),b.push(new j(d)),b},[]),c.nodes=a.map(c.nodes,function(a){return b&&(a._motif=a.motif,delete a.motif),a.library=c,new k(a)})},searchIncludes:function(a,b){var c=null;for(var d=0;d<this.includes.length&&!c;d++)c=this.includes[d].get(a,b);return c},updateOutputProperties:function(){var b=this;b.allSegments=[];for(var c=0;c<b.nodes.length;c++){var d=b.nodes[c],e=d.getStrands();for(var f=0;f<e.length;f++){var g=e[f];b.allSegments=b.allSegments.concat(g.getSegments())}}b.segments=a.chain(b.allSegments).uniq(!1,function(a){return a.identity}).map(function(a){var b=a.duplicate();return delete b.name,delete b.node,delete b.polarity,new n(b)}).value(),b.strands=a.chain(b.nodes).map(function(a){return a.getStrands()}).flatten().value()},getParameter:function(a,b){switch(a){case"segmentLength":if(this.parameters){switch(b.role){case"clamp":return!this.parameters.clampLength,this.parameters.clampLength;case"toehold":return!this.parameters.toeholdLength,this.parameters.toeholdLength}return this.parameters.segmentLength}}},getNode:function(a){return a instanceof k?a:this.objects.node[a]},getMotif:function(a){return a instanceof j?a:this.objects.motif[a]},getSegment:function(a){return a instanceof n?a:this.objects.segment[a]},register:function(a,b,c){if(!!this.objects[a][b])throw new q({type:"Duplicate object",message:"Attempt to define <%= kind %> <%= name %> twice in same library",kind:a,name:b,original:this.objects[a][b],second:c});this.objects[a][b]=c},get:function(a,b){return this.objects[a][b]},compile:function(){return s.compileLibrary(this)},printStrands:function(a){return s.printStrands(this,a)},toDilOutput:function(){var a=this.serialize();return a.imports&&delete a.imports,a["import"]&&delete a["import"],JSON.stringify(a,null,"	")},toEnumOutput:function(){function d(a){return a}var b=this,c=[];return c.push(a.map(b.segments,function(a){return["domain",d(a.identity),":",a.getLength()].join(" ")}).join("\n")),c.push(a.map(b.strands,function(b){return["strand",b.getQualifiedName(),"="].concat(a.map(b.getOrderedSegments(),function(a){return d(a.getIdentifier())})).join(" ")}).join("\n")),c.push(a.map(b.nodes,function(b){var c=a.map(b.getStrands(),function(a){var b=a.getSegmentwiseStructure();return a.getAbsolutePolarity()==-1&&(b=b.reverse()),b}),d=a.map(b.getStrands(),function(a){return a.getQualifiedName()}),e=o.join(c);return[["complex",b.getName(),":"].join(" "),d.join(" "),e.toDotParen()].join("\n")}).join("\n\n")),c.join("\n\n")},toNupackOutput:function(b){function e(a){return"d"+a}function f(a){return a+"_structure"}b=b||{multisubjective:!1,forceDU:!0,segmentsInStructure:!1};var c=this,d=[];return d=d.concat(["material = dna","temperature[C] = 23.0","trials = 3","sodium[M] = 1.0","dangles = some"]),b.multisubjective&&(d=d.concat(["!threshold = .6","!toethreshold = .6","!intermolecular = on","!immutable = auto"]),d.push(a.map(c.nodes,function(b){if(b.type=="hairpin")return["!hairpin",f(b.getName()),":",b.getPolarity()<0?"-":"+"].join(" ");if(b.type=="cooperative"||b.type=="coop"){var c=a.max(a.map(b.getStrands(),function(a){return a.getLength()}));return["!coop",f(b.getName()),"=",c].join(" ")}return["!static",f(b.getName())].join(" ")}).join("\n"))),!b.multisubjective||d.push("#`"),d.push(a.map(c.segments,function(a){return["domain",e(a.identity),"=",a.getSequence()].join(" ")}).join("\n")),!b.multisubjective||d.push("#`"),d.push(a.map(c.strands,function(b){var c=b.getOrderedSegments();return["strand",b.getQualifiedName(),"="].concat(a.map(c,function(a){return e(a.getIdentifier())})).join(" ")}).join("\n")),d.push(a.map(c.nodes,function(a){var c=a.getStructure(),d;return!b.multisubjective&&!b.forceDU?d=c.toDotParen():d=c.toDUPlus(),["structure",f(a.getName()),"=",d].join(" ")}).join("\n")),b.multisubjective?d.push(a.map(c.nodes,function(c){var d=a.map(c.getStrands(),function(c){return b.segmentsInStructure?a.map(c.getOrderedSegments(),function(a){return e(a.getIdentifier())}).join(" "):c.getQualifiedName()});return[f(c.getName())+".seq","="].concat(d).join(" ")}).join("\n")):d.push(a.map(c.nodes,function(b){var c=a.map(b.getStrands(),function(a){return a.getQualifiedName()});return[f(b.getName())+".seq","="].concat(c).join(" ")}).join("\n")),d.join("\n\n")},toMSOutput:function(){return this.toNupackOutput({multisubjective:!0})},toPilOutput:function(){function d(a){return"d"+a}var b=this,c=[];return c.push(a.map(b.segments,function(a){return["sequence",d(a.identity),"=",a.getSequence()].join(" ")}).join("\n")),c.push(a.map(b.strands,function(b){return["strand",b.getQualifiedName(),"="].concat(a.map(b.getOrderedSegments(),function(a){return d(a.getIdentifier())})).join(" ")}).join("\n")),c.push(a.map(b.nodes,function(b){var c=a.map(b.getStrands(),function(a){var b=a.getSegmentwiseStructure();return a.getAbsolutePolarity()==-1&&(b=b.reverse()),b}),d=a.map(b.getStrands(),function(a){return a.getQualifiedName()}),e=o.join(c),f=e.toDotParen();return["structure",b.getName()+"_structure","=",d.join(" + "),":",f].join(" ")}).join("\n")),c.join("\n\n")},toDomainsOutput:function(){return s.printStrands(this,{annotations:!1})},toSVGOutput:function(b){String.prototype.format=function(){var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return typeof a[c]!="undefined"?a[c]:b})};var d={out:[],write:function(a){this.out.push(a)},close:function(){return this.out.join("")}},e=this.parameters.segmentLength,h={toehold:"#f00",clamp:"#800"},i=Math.cos,j=Math.sin,k=Math.PI,l=Math.atan2,m=0,n=0,o=300,p=160,q=Math.round(Math.sqrt(this.strands.length)),r=Math.ceil(this.strands.length/q);d.write((b?"":'<?xml version="1.0" standalone="no"?>\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')+'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\nviewBox = "0 0 '+g(o*r)+" "+g(p*q)+'" version = "1.1">\n'+'<defs><path id="svgout-arrow" d="M -7 -7 L 0 0 L -7 7"/>\n<marker id="Triangle" viewBox="0 0 10 10" refX="0" refY="5" markerUnits="strokeWidth" markerWidth="4" markerHeight="3" orient="auto">\n'+'<path d="M 0 0 L 10 5 L 0 10 z" /></marker></defs>\n'+'<style type="text/css">text { font-family: tahoma, helvetica, arial; font-size: 0.8em; text-shadow: 1px -1px 0px white; }</style>');for(var s=0;s<this.nodes.length;s++){var t=this.nodes[s],u=t.getStrands(),v=t.getSegmentwiseStructure().toDotParen();if(v.match(/^\.+$/)){var w=a.first(u);d.write('<g stroke = "rgb(139,98,61)" stroke-width = "2" fill = "none">\n<path d = "M {0} {1} L {2} {3}" />\n'.format(m+o*.15,n+p*.5,m+o*.6,n+p*.5)),w.getPolarity()==-1?d.write('<use x="{0}" y="{1}" xlink:href="#svgout-arrow" transform="rotate(180,{2},{3})"/>\n'.format(m+o*.15,n+p*.5,m+o*.15,n+p*.5)):d.write('<use x="{0}" y="{1}" xlink:href="#svgout-arrow"/>\n'.format(m+o*.6,n+p*.5)),d.write('</g>\n<g stroke="none" fill="black" font-size="16">\n');var x=w.getOrderedSegments();for(var y=0;y<x.length;y++){var z=x[y],A=z.getIdentifier(),B=z.role&&h[z.role]?h[z.role]:"black",C="";z.getLength()!=e&&(C=" ("+z.getLength()+")"),d.write('<text x="{0}" y="{1}" stroke="none" transform="rotate({2} {0} {1})" fill="{5}">{3}<tspan fill="grey" style="font-size: 0.8em">{4}</tspan></text>\n'.format(m+o*.15+o*(y+.5)/x.length*.45,n+p*.5-p*.05,-45,A,C,B))}d.write("</g>\n")}else if(v.match(/^\.+\(+\.*\+\)+$/)){var x=t.getOrderedSegments();t.getPolarity()==-1&&x.reverse();var w=a.first(u),D=v.indexOf("("),E=D;while(v[E]=="(")E++;E--;var F=v.indexOf(")")-1,G=x.length-1,H=a.map(x,function(a){return a.getLength()}),I=f(H.slice(0,D)),J=f(H.slice(D,E+1)),K=f(H.slice(E+1,F)),L=f(H.slice(G+1));d.write('<g stroke = "black" stroke-width = "1" fill = "none">\n');for(var y=0;y<J;y++)d.write('<line x1 = "{0}" y1 = "{1}" x2 = "{2}" y2 = "{3}"/>\n'.format(m+o*.3+o*.3*y/J,n+p*.45,m+o*.3+o*.3*y/J,n+p*.5));d.write("</g>\n"),d.write('<g stroke = "black" stroke-width = "2" fill = "none">\n<path d = "M {0} {1} L {2} {3}" stroke="black"/>\n'.format(m+o*.6,n+p*.5,m+o*.3,n+p*.5)),d.write('<line x1 = "{0}" y1 = "{1}" x2 = "{2}" y2 = "{3}" stroke = "rgb(241,139,17)"/>\n'.format(m+o*.15,n+p*.45,m+o*.75,n+p*.45)),L>0&&d.write('<path d = "M {0} {1} L {2} {3}" stroke = "black"/>\n'.format(m+o*.3,n+p*.5,m+o*.15,n+p*.8)),w.getAbsolutePolarity()==-1?(d.write('<use x="{0}" y="{1}" stroke="rgb(241,139,17)" xlink:href="#svgout-arrow" transform="rotate(180,{0},{1})"/>\n'.format(m+o*.15,n+p*.45)),d.write('<use x="{0}" y="{1}" xlink:href="#svgout-arrow" transform=""/>\n'.format(m+o*.6,n+p*.5))):(d.write('<use x="{0}" y="{1}" stroke="rgb(241,139,17)" xlink:href="#svgout-arrow" transform=""/>\n'.format(m+o*.75,n+p*.45)),d.write('<use x="{0}" y="{1}" xlink:href="#svgout-arrow" transform="rotate(180,{0},{1})"/>\n'.format(m+o*.3,n+p*.5))),d.write('</g>\n<g stroke="none" fill="black" font-size="16">\n'),labelx=[],labely=[],labelr=[];for(var y=0;y<D;y++)labelx.push(o*(.15+.15*(y+.5)/D)),labely.push(p*.4),labelr.push(-45);for(y=0;y<E+1-D;y++)labelx.push(o*(.3+.3*(y+.5)/(E+1-D))),labely.push(p*.4),labelr.push(-45);for(y=0;y<F-(E+1);y++)labelx.push(o*(.6+.15*(y+.5)/(F-(E+1)))),labely.push(p*.4),labelr.push(-45);for(y=0;y<E+1-D;y++)labelx.push(o*(.6-.3*(y+.5)/(E+1-D))),labely.push(p*.6),labelr.push(45);for(y=0;y<G+1-F;y++)labelx.push(o*(.3-.15*(y+.5)/(G+1-F))),labely.push(p*(.6+.3*(y+.5)/(G+1-F))),labelr.push(0);for(var y=0;y<x.length;y++){var z=x[y],A=z.getIdentifier(),B=z.role&&h[z.role]?h[z.role]:"black",C="";z.getLength()!=e&&(C=" ("+z.getLength()+")"),d.write('<text x="{0}" y="{1}" stroke="none" transform="rotate({2} {0} {1})" fill="{5}">{3}<tspan fill="grey" style="font-size: 0.8em">{4}</tspan></text>\n'.format(m+labelx[y],n+labely[y],labelr[y],A,C,B))}d.write("</g>\n")}else if(v.match(/^\.+\(+\.+\)+(\.+)?$/)){var w=a.first(t.getStrands()),x=w.getOrderedSegments(),D=v.indexOf("(");t.getPolarity()==-1&&x.reverse();var E=D;while(v[E]=="(")E++;E--,F=v.indexOf(")");var G=F;while(v[G]==")")G++;G--;var H=c(x),I=f(H.slice(0,D)),J=f(H.slice(D,E+1)),K=f(H.slice(E+1,F)),L=f(H.slice(G+1));d.write('<g stroke = "black" stroke-width = "1" fill = "none">\n');for(var y=0;y<J;y++)d.write('<line x1 = "{0}" y1 = "{1}" x2 = "{2}" y2 = "{3}"/>\n'.format(m+o*.3+o*.3*y/J,n+p*.45,m+o*.3+o*.3*y/J,n+p*.5));d.write("</g>\n"),d.write('<g stroke = "black" stroke-width = "2" fill = "none">\n<path d = "M {0} {1} a {2} {3} 0 1 1 {4} {5} L {6} {7}" stroke="black"/>\n'.format(m+o*.6,n+p*.45,o*.085,p*.25,0,p*.05,m+o*.3,n+p*.5)),d.write('<line x1 = "{0}" y1 = "{1}" x2 = "{2}" y2 = "{3}" stroke = "rgb(241,139,17)"/>\n'.format(m+o*.15,n+p*.45,m+o*.6,n+p*.45)),L>0&&d.write('<path d = "M {0} {1} L {2} {3}" stroke = "black"/>\n'.format(m+o*.3,n+p*.5,m+o*.15,n+p*.8)),w.getAbsolutePolarity()==-1?d.write('<use x="{0}" y="{1}" stroke="rgb(241,139,17)" xlink:href="#svgout-arrow" transform="rotate(180,{2},{3})"/>\n'.format(m+o*.15,n+p*.45,m+o*.15,n+p*.45)):L>0?d.write('<use x="{0}" y="{1}" xlink:href="#svgout-arrow" transform="rotate({2},{3},{4})"/>\n'.format(m+o*.15,n+p*.8,90+180/k*l(p*.3,o*.15),m+o*.15,n+p*.8)):d.write('<use x="{0}" y="{1}" xlink:href="#svgout-arrow" transform="rotate(180,{2},{3})"/>\n'.format(m+o*.3,n+p*.5,m+o*.3,n+p*.5)),d.write('</g>\n<g stroke="none" fill="black" font-size="16">\n'),labelx=[],labely=[],labelr=[];for(var y=0;y<D;y++)labelx.push(o*(.15+.15*(y+.5)/D)),labely.push(p*.4),labelr.push(-45);for(y=0;y<E+1-D;y++)labelx.push(o*(.3+.3*(y+.5)/(E+1-D))),labely.push(p*.4),labelr.push(-45);for(y=0;y<F-(E+1);y++)labelx.push(o*(.67-.15*i(2*k*(y+.5)/(F-(E+1))))),labely.push(p*(.49-.35*j(2*k*(y+.5)/(F-(E+1))))),labelr.push(0);for(y=0;y<E+1-D;y++)labelx.push(o*(.6-.3*(y+.5)/(E+1-D))),labely.push(p*.58),labelr.push(45);for(y=0;y<G+1-F;y++)labelx.push(o*(.3-.15*(y+.5)/(G+1-F))),labely.push(p*(.6+.3*(y+.5)/(G+1-F))),labelr.push(45);for(var y=0;y<x.length;y++){var z=x[y],A=z.getIdentifier(),B=z.role&&h[z.role]?h[z.role]:"black",C="";z.getLength()!=e&&(C=" ("+z.getLength()+")"),d.write('<text x="{0}" y="{1}" stroke="none" transform="rotate({2} {0} {1})" fill="{5}">{3}<tspan fill="grey" style="font-size: 0.8em">{4}</tspan></text>\n'.format(m+labelx[y],n+labely[y],labelr[y],A,C,B))}d.write("</g>\n")}var M=t.getName();u.length>1&&(M+="("+a.map(u,function(a){return a.getName()}).join(" + ")+")"),d.write('<text x="{0}" y="{1}" style="font-size: 18px; font-weight: bold;" stroke="none">{2}</text>\n'.format(m+o*.45,n+p*.9,M)),n+=p,n>=p*q&&(n=0,m+=o)}return d.write("</svg>\n"),d.close()},toMotif:function(){var b=a.map(this.strands,function(b){var c=a.copy(b);return c.domains=a.map(c.domains||[],function(b){var c=a.copy(b);return b.expose?(a.extend(c,b.expose),delete c.expose):b.role="structural",c.orphan&&c.orphan(),c.strand&&delete c.strand,c.node&&delete c.node,b}),c.polarity=b.getAbsolutePolarity(),delete c.node,c});return{strands:b}},serialize:function(){var b=a.copy(this);return b.objects&&delete b.objects,a.serialize(b)},update:function(b){var c=this;if(b.segments){var d={};for(var e=0;e<c.allSegments.length;e++){var f=c.allSegments[e],g=f.getIdentity();d[g]||(d[g]=[]),d[g].push(f)}for(var h in b.segments){var i=b.segments[h];if(d[h]){var j=d[h];for(var e=0;e<d[h].length;e++)a.extend(j[e],i)}else{var k=a.clone(b.segments[h]);k.library=c,c.allSegments.push(new n(k))}}}}},a.extend(r,{dummy:function(){return new App.dynamic.Library({})},fromMotif:function(b){var c=a.copy(b);return delete c.library,new r(c)},fromDil:function(a){var b=new r(a);return b.setup(!0),b.updateOutputProperties(),b}});var s=function(){function d(a){var b=a,c;try{c=JSON.parse(b)}catch(d){throw new q({type:d.type,message:"Parsing error: "+d.message,stack:d.stack})}return c}function e(a){return g(d(a))}function g(d){if(d){d=new r(d),d.setup();var e=0;for(var g=0;g<d.nodes.length;g++)d.nodes[g].isInitiator?e++:delete d.nodes[g].polarity;e==0&&d.nodes.length>0&&(d.nodes[0].polarity=1);var h=a.chain(d.nodes).map(function(b){return b.complementarities=a.map(b.complementarities||[],function(a){return a.sourceNode=b,a.library=d,new p(a)}),b.complementarities}).compact().flatten().value(),i;do i=!1,a.each(h,function(b){if(b.sourceNode.polarity!=0){var c=-1*b.sourcePort.polarity*b.sourcePort.getStrand().getPolarity()*b.sourceNode.polarity*b.targetPort.polarity*b.targetPort.getStrand().getPolarity();if(isNaN(c))throw isNaN(b.sourcePort.polarity)?new q({type:"polarity unspecified",message:"source port polarity is NaN",sourceNode:b.sourceNode,sourcePort:b.sourcePort,complement:b,nodes:[config.sourceNode],ports:[config.sourcePort]}):new q({type:"polarity unspecified",message:"source node polarity is NaN",sourceNode:b.sourceNode,sourcePort:b.sourcePort,complement:b,nodes:[config.sourceNode],ports:[config.sourcePort]});if(b.targetNode.polarity!=0&&b.targetNode.polarity==-c)throw new q({type:"polarity conflict",message:a.template("Complementarity statement in node <%= source %> implies node <%= target %> should have polarity <%= expected %>, but instead it has polarity <%= encountered %>",{source:b.sourceNode.name,target:b.targetNode.name,expected:c,encountered:-c}),nodes:[b.sourceNode,b.targetNode],sourceNode:b.sourceNode,targetNode:b.targetNode,sourcePort:b.getSourcePort(),targetPort:b.getTargetPort(),nodes:[b.sourceNode,b.targetNode],ports:[b.getSourcePort(),b.getTargetPort()]});if(b.targetNode.polarity==c)return;b.targetNode.polarity=c,i=!0}});while(i);a.each(d.nodes,function(a){a.polarity==0&&(a.polarity=1)});var j=a.reduce(d.nodes,function(b,c){return a.extend(b,c.getConstraintMatrix()),b},{});a.each(h,function(b){var d=a.clone(b.getSourceDomain().getSegments()),e=a.clone(b.getTargetDomain().getSegments()),g=b.getType();g=="output"&&b.sourcePort.getStrand().getAbsolutePolarity()==b.targetPort.getStrand().getAbsolutePolarity()&&e.reverse();var h=c(d),i=c(e);if(f(h)!=f(i)||d.length!=e.length)if(d.length!=e.length)if(g=="output"&&d.length-e.length==1&&a.last(d).role=="clamp")d.pop();else{if(g!="output"||e.length-d.length!=1||a.last(e).role!="clamp")throw new q({type:"domain length mismatch",message:a.template("Complementarity statement (<%= sourceNode %>.<%= sourcePort %> * <%= targetNode %>.<%= targetPort %>) in node <%= sourceNode %> implies domain <%= targetNode %>.<%= targetPort %> should have <%= expected %> segments, but instead it has <%= encountered %> segments",{sourceNode:b.sourceNode.getName(),targetNode:b.targetNode.getName(),sourcePort:b.targetPort.getName(),targetPort:b.targetPort.getName(),expected:d.length,encountered:e.length}),nodes:[b.sourceNode,b.targetNode],sourceNode:b.sourceNode,targetNode:b.targetNode,sourcePort:b.getSourcePort(),targetPort:b.getTargetPort(),ports:[b.getSourcePort(),b.getTargetPort()]});e.pop()}else for(var k=0;k<d.length;k++){var l=d[k],m=e[k];if(h[k]!=i[k])throw new q({type:"segment length mismatch",message:a.template("Complementarity statement (<%= sourceNode %>.<%= sourcePort %> * <%= targetNode %>.<%= targetPort %>) in node <%= sourceNode %> implies: segment <%= targetNode %>.<%= targetPort %>.<%= targetSegment %> (#<%= targetSegmentIndex %>/<%= targetSegmentCount %>) should have same length as <%= sourceNode %>.<%= sourcePort %>.<%= sourceSegment %> (#<%= sourceSegmentIndex %>/<%= sourceSegmentCount %>): <%= expected %> nt, but instead it has <%= encountered %> nt.",{sourceNode:b.sourceNode.getName(),sourcePort:b.sourcePort.getName(),sourceSegment:l.getName(),sourceSegmentIndex:k,sourceSegmentCount:d.length,targetNode:b.targetNode.getName(),targetPort:b.targetPort.getName(),targetSegment:m.getName(),targetSegmentIndex:k,targetSegmentCount:e.length,expected:h[k],encountered:i[k]}),nodes:[b.sourceNode,b.targetNode],sourceNode:b.sourceNode,sourcePort:b.getSourcePort(),sourceSegment:l,targetNode:b.targetNode,targetPort:b.getTargetPort(),targetSegment:m,ports:[b.getSourcePort(),b.getTargetPort()]})}for(var k=0;k<d.length;k++)j[d[k].getId()][e[k].getId()]=-1});var k=function(){var b=0;return a.reduce(a.keys(j),function(a,c){return b++,a[c]=-b,a},{})}(),i;do i=!1,a.each(j,function(c,e){a.each(c,function(c,f){if(Math.abs(c)!=1)return;var g=a.sortBy([e,f],function(a){return Math.abs(k[a])}),h=a.last(g),j=a.first(g),l=null;if(c==1){if(k[e]==-k[f]){var m=d.getSegment(e),n=d.getSegment(f);throw new q({type:"equality conflict",message:"Segments <%= left %> and <%= right %> should be equal, but they're already complementary!",left:m.getFullName(),right:n.getFullName(),leftSegment:m,rightSegment:n,nodes:[m.getNode(),n.getNode()]})}k[e]!=k[f]&&(l=k[j])}else if(c==-1){if(k[e]==k[f]){var m=d.getSegment(e),n=d.getSegment(f);throw new q({type:"equality conflict",message:"Segments <%= left %> and <%= right %> should be complementary, but they're already equal!",left:m.getFullName(),right:n.getFullName(),leftSegment:m,rightSegment:n,nodes:[m.getNode(),n.getNode()]})}k[e]!=-k[f]&&(l=-Math.abs(k[j])*b.signum(k[e])*b.signum(k[f]))}if(l!=null){var o=a.filter(a.keys(k),function(a){return Math.abs(k[a])==Math.abs(k[h])}),p=a.clone(k);a.each(o,function(a){var e=d.getSegment(a);e.identity=Math.abs(l),e.polarity=b.signum(l),c==-1?p[a]=b.signum(k[a])*l:p[a]=l,i=!0}),k=p}})});while(i);k=function(c){var d=a.chain(c).values().map(Math.abs).uniq().value(),e=b.mapUnique(d,1);return a.reduce(c,function(a,c,d){return a[d]=e[Math.abs(c)]*b.signum(c),a},{})}(k),a.each(d.nodes,function(c){a.each(c.getStrands(),function(c){a.each(c.getSegments(),function(a){a.identity=Math.abs(k[a.getId()]),a.polarity=b.signum(k[a.getId()])})})}),d.updateOutputProperties()}else d={};return d}function h(b,c){function f(a,b){return a+(b==-1?e:"")}c=c||{},a.defaults(c,{annotations:!0,originalSegmentNames:!1});var d="",e="*";return d+=a.map(b.segments,function(a){return["sequence",a.getIdentifier(),":",a.getSequence()].join(" ")}).join("\n"),d+="\n",d+=a.map(b.strands,function(b){var d=b.getQualifiedName(),e=a.clone(b.getDomains());return b.getAbsolutePolarity()==-1&&(e=e.reverse()),a([c.annotations?"strand":"",d,c.annotations?b.getAbsolutePolarity()==-1?"-":"+":"",":"].concat(a.map(e,function(d){var e=a.clone(d.getSegments());return b.getAbsolutePolarity()==-1&&(e=e.reverse()),[c.annotations?"[":""].concat(a.map(e,function(a){return c.originalSegmentNames?a.getQualifiedName():a.getIdentifier()})).concat([c.annotations?"]"+(d.polarity==-1?"-":"+"):""]).join(" ")},""))).compact().join(" ")}).join("\n"),d}function j(b,c){function f(a,b){return a+(b==-1?e:"")}c=c||{},a.defaults(c,{annotations:!0,originalSegmentNames:!1});var d="",e="*";return d+=a.map(b,function(b){var d=b.getQualifiedName(),e=a.clone(b.getDomains());return b.getAbsolutePolarity()==-1&&(e=e.reverse()),a([c.annotations?"strand":"",d,c.annotations?b.getAbsolutePolarity()==-1?"-":"+":"",":"].concat(a.map(e,function(d){var e=a.clone(d.getSegments());return b.getAbsolutePolarity()==-1&&(e=e.reverse()),[c.annotations?"[":""].concat(a.map(e,function(a){return c.originalSegmentNames?a.getQualifiedName():a.getIdentifier()})).concat([c.annotations?"]"+(d.polarity==-1?"-":"+"):""]).join(" ")},""))).compact().join(" ")}).join("\n"),d}function m(a){return a==-1?"-":a==1?"+":"0"}function n(a,b){return l[a]&&l[a][b]?l[a][b]:b}function o(a,b){return k[a]&&k[a][b]?k[a][b]:b}function t(b,c){c||(c=!1);var d=b.match(/(\w+\[[\w\(\)\*'\s:]+\]\w?[\+-]?)\s?/g);return a.map(d,function(a){var b=a.match(/(\w+)\[([\w\(\)\*'\s:]+)](\w?)([\+-]?)/),d={name:b[1],segments:w(b[2],c)},e=o("domain",b[3]);return!e||(d.role=e),!b[4]||(d.polarity=b[4]),d})}function u(b,c,d){return c||(c=1),d||(d=!1),i(a.map(b,function(a){return[a.getName(),"[",x(i(a.getSegments(),c),d),"]",n("domain",a.role||""),m(a.getPolarity())].join("")}),c).join(" ")}function v(a){return a.getName()+" : "+u(a.getDomains(),a.getPolarity())}function w(c,d){d||(d=!1);var e=c.split(/\s+/g);return a.map(e,function(c){c.trim();var e=c.match(/(\w+\*?)(?:\(([aAtTcCgGuUnN\d]+)\))?:?(\w+)?/),f={};if(e){d?a.extend(f,b.parseIdentifier(e[1])):f.name=e[1];var g=o("segment",e[3]);!g||(f.role=g),!e[2]||(e[2].match(/[aAtTcCgGuUnN]+/)?f.sequence=e[2]:e[2].match(/\d+/)&&(f.length=parseInt(e[2])))}return f})}function x(b,c){return c||(c=!1),a.chain(b).compact().map(function(a){if(c){var b=n("segment",a.role||"");return b?[a.getIdentifier(),":",b].join(""):a.getIdentifier()}return[a.getIdentifier(),"(",a.getLength(),")",n("segment",a.role||"")].join("")}).value().join(" ")}function y(a,b){return/(\w+\[[\w\(\)\*'\s:]+\]\w?[\+-]?)\s?/g.test(a)?t(a,b):/(\w+\*?)(?:\(([aAtTcCgGuUnN\d]+)\))?:?(\w+)?/.test(a)?[{name:"A",segments:w(a,b),role:"",polarity:1}]:[]}function D(a,b,c){switch(a){case"motif":var d=s.standardMotifsVersions[c]||s.standardMotifs;if(d[b])return d[b];if(d["m"+b])return d["m"+b];throw new q({type:"undefined motif",name:b,message:"Couldn't find imported motif '<%= name %>'"})}}function E(a){return a.role&&a.type?C[[a.role,a.type].join(".")]:C[a.role]||"#000"}var k={domain:{i:"input",o:"output",b:"bridge",s:"structural",x:"structural"},segment:{t:"toehold",th:"toehold",c:"clamp",cl:"clamp"}},l={domain:{input:"i",output:"o",bridge:"b",structural:"x"},segment:{toehold:"t",clamp:"c"}},z=[[{name:"m1",type:"initiator",structure:"..",isInitiator:!0,domains:[{name:"A",role:"output",type:"init",polarity:"+",segments:[{name:"a",role:""},{name:"b",role:""}]}]},{name:"m2",type:"initiator",isInitiator:!0,structure:"...",domains:[{name:"A",role:"output",type:"init",polarity:"+",segments:[{name:"a",role:""},{name:"b",role:""},{name:"c",role:""}]}]},{name:"m3",type:"hairpin",structure:".(.)",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"b",role:""}]},{name:"B",role:"output",type:"loop",polarity:"-",segments:[{name:"c"},{name:"b*",role:""}]}]},{name:"m4",type:"hairpin",structure:".((..))..",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"b",role:""},{name:"c",role:""}]},{name:"B",role:"output",type:"loop",polarity:"-",segments:[{name:"d"},{name:"e"},{name:"c*",role:""}]},{name:"C",role:"output",type:"tail",polarity:"+",segments:[{name:"b*",role:"toehold"},{name:"f",role:""},{name:"g",role:""}]}]},{name:"m5",type:"hairpin",structure:".((.))",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"b",role:""},{name:"c",role:""}]},{name:"B",role:"bridge",type:"loop",polarity:"+",segments:[{name:"d"}]},{name:"C",role:"structural",type:"stem",polarity:"+",segments:[{name:"b*",role:""},{name:"c*",role:""}]}]},{name:"m6",type:"hairpin",structure:".((....))..",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"b",role:""},{name:"c",role:""}]},{name:"B",role:"bridge",type:"loop",polarity:"+",segments:[{name:"d"}]},{name:"C",role:"output",type:"loop",polarity:"-",segments:[{name:"e"},{name:"f"},{name:"g"},{name:"c*"}]},{name:"D",role:"output",type:"tail",polarity:"+",segments:[{name:"b*",role:"toehold"},{name:"h",role:""},{name:"i",role:""}]}]},{name:"m7",type:"hairpin",structure:".((..))..",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"b",role:""},{name:"c",role:""}]},{name:"B",role:"output",type:"loop",polarity:"-",segments:[{name:"d"},{name:"e"},{name:"c*",role:""}]},{name:"C",role:"bridge",type:"stem",polarity:"+",segments:[{name:"b*",role:"toehold"},{name:"e",role:""},{name:"f",role:""}]}]},{name:"m8",type:"hairpin",structure:".((.))..",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"b",role:""},{name:"c",role:""}]},{name:"B",role:"bridge",type:"loop",polarity:"+",segments:[{name:"d"},{name:"c*",role:""}]},{name:"C",role:"output",type:"tail",polarity:"+",segments:[{name:"b*",role:""},{name:"e",role:""},{name:"f",role:""}]}]},{name:"m9",type:"hairpin",structure:".((.))",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"b",role:""},{name:"c",role:""}]},{name:"B",role:"bridge",type:"loop",polarity:"+",segments:[{name:"d"},{name:"c*",role:""}]},{name:"C",role:"null",type:"stem",polarity:"+",segments:[{name:"b*",role:""}]}]},{name:"m1c",type:"initiator",isInitiator:!0,structure:"....",domains:[{name:"A",role:"output",type:"init",polarity:"+",segments:[{name:"a",role:""},{name:"w",role:"clamp"},{name:"b",role:""},{name:"x",role:"clamp"}]}]},{name:"m19c",type:"hairpin",structure:".(((..)))",domains:[{name:"A",role:"input",polarity:"+",segments:[{name:"a",role:"toehold"},{name:"w",role:"clamp"},{name:"b"},{name:"x",role:"clamp"}]},{name:"B",role:"output",polarity:"-",segments:[{name:"y",role:"clamp"},{name:"c"},{name:"x*",role:"clamp"},{name:"b*",role:"toehold"},{name:"w*",role:"clamp"}]}]},{name:"m20",type:"hairpin",structure:".(((....)))..",domains:"A[a:t x:c b c]i+ s[s(1)]x B[d e y:c c*:t]o- C[b*:t x*:c f g]o+"},{name:"m21",type:"hairpin",structure:".(((...))).",domains:"A[a:t x:c b c]i+ s[s(1)]x B[d(16) y:c c*:t]o- C[b*:t x*:c e(16)]o+"},{name:"m22",type:"cooperative",structure:".(((((.+)))))",strands:[{name:"S1",domains:"A[a:t x:c b(16)]i+ s[s(1)]x B[c(16) y:c d:t]i-"},{name:"S2",domains:"C[y*:c c*(16) s*(1) b*(16) x*:c]x"}]},{name:"m23",type:"initiator",structure:"....",domains:"A[a x:c b c]o+"},{name:"m24",type:"cooperative",structure:".(((((((((((.+)))))))))))",strands:[{name:"S1",domains:"A[a:t x:c b c]i+ s[s(1)]x B[d y:c e f]i- C[g z:c h i:t]i+"},{name:"S2",domains:"D[h* z*:c g*]x E[f* e* y*:c d*]x F[s*(1) c* b* x*:c]x"}]},{name:"m25",type:"initiator",structure:"........",domains:"A[a x:c b y:c]o+ B[z:c c w:c d]o-"},{name:"m26",type:"cooperative",structure:".(((((((.+)))))))",strands:[{name:"S1",domains:"A[a:t x:c b y:c]i+ s[s(1)]x B[z:c c w:c d]i-"},{name:"S2",domains:"C[w* c* z* s*(1) y* b* x*]x"}]},{name:"m27",type:"hairpin",structure:".(...)",domains:"A[a b]i+ B[c d]o- C[e b*]o-"},{name:"m27c",type:"hairpin",structure:".(((..)))",domains:"A[a:t v:c b w:c]i+ B[x:c c y:c d]o- C[z:c e w*:c b* v*:c]o-"}],[{name:"m0",type:"input",domains:"A[c b x:c a:t]o-",structure:"....",description:"Initiator",isInitiator:!0},{name:"m1",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c c*:t]o- C[b* x*:c]x",structure:".(((...)))",description:"1 input/1 output hairpin"},{name:"m2",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c c*:t]o- C[b*:t x*:c f g]o+",structure:".(((...)))..",description:"1 input/2 output hairpin"},{name:"m3",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d]b C[c* b* x*:c]x",structure:".(((.)))",description:"1 input/1 bridge hairpin"},{name:"m4",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d]b C[e f y c*:t]o- D[b* x*:c]x",structure:".(((....)))",description:"1 input/1 bridge/1 output hairpin"},{name:"m5",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c c*:t]o- C[b*]b D[x*:c]x",structure:".(((...)))",description:"1 input/1 output/1 bridge hairpin"},{name:"m6",type:"cooperative",structure:".(((((((.+)))))))",strands:[{name:"S1",domains:"A[a:t x:c b c]i+ s[s(1)]x B[d e y:c f:t]i-"},{name:"S2",domains:"C[y*:c e* d* s*(1) c* b* x*:c]x"}],description:"2-input cooperative complex"},{name:"m7a",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c]x C[f g z:c h:t]o- D[f*:t y*:c e* d*]i+ E[b* x*:c]x",structure:".((.((((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m7b",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d y:c e]x C[f g z:c h:t]o- D[f* e* y*:c d*:t]i- E[b* x*:c]x",structure:".((.((((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m7c",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c]x C[f:t z:c g h]o+ D[f*:t y*:c e* d*]i+ E[b* x*:c]x",structure:".((.((((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m7d",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d y:c e]x C[f:t z:c g h]o+ D[f* e* y*:c d*:t]i- E[b* x*:c]x",structure:".((.((((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m8a",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d:t y:c e f]i+ C[g h z:c f*:t]o- D[e* y*:c c* b* x*:c]x",structure:".(((.(((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m8b",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c f:t]i- C[g h z:c f*:t]o- D[y*:c e* c* b* x*:c]x",structure:".(((.(((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m8c",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d:t y:c e f]i+ C[g:t z:c h f*]o+ D[e* y*:c c* b* x*:c]x",structure:".(((.(((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m8d",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c f:t]i- C[g:t z:c h f*]o+ D[y*:c e* c* b* x*:c]x",structure:".(((.(((...))))))",description:"2 input/1 output sequential AND gate"},{name:"m9a",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d e y:c d*:t]o- C[c* b* x*:c f:t]i-",structure:".((((..)))).",description:"2 input/1 output OR gate"},{name:"m9b",type:"hairpin",domains:"A[a:t x:c b c]i+ B[d:t y:c e d*]o+ C[c* b* x*:c f:t]i-",structure:".((((..)))).",description:"2 input/1 output OR gate"}]],A=z.length-1,B;z=a.map(z,function(b){return a.reduce(b,function(a,b){return a[b.name]=b,a},{})}),B=z[A];var C={init:"#553300",input:"orange",output:"#33ccff","output.init":"#8C6239","output.loop":"#33ccff","output.tail":"#66ff33",bridge:"#ff1177","bridge.loop":"#ff1177","bridge.stem":"#9900cc"};return{compile:e,compileLibrary:g,parse:d,printStrands:h,printStrandsFromArray:j,importObject:D,standardMotifs:B,standardMotifsVersions:z,standardMotifsCurrentVersion:A,domainColors:C,getColor:E,expandRole:o,parseDomainString:t,parseDomainsString:t,parseSegmentString:w,parseSegmentsString:w,parseDomainOrSegmentString:y,printDomainString:u,printStrandString:v,printSegmentString:x}}();return{Node:k,Motif:j,Strand:l,Domain:m,Segment:n,Library:r,Compiler:s,DynamlError:q,Structure:o}}(_,DNA);
typeof require=="function"&&(_=require("underscore"),printf=require("format").printf);var DD=function(){function f(a){return Math.log(a)/Math.LN2}function g(a,b){var c=a+Math.random()*(b-a);return Math.round(c)}function h(a,b){throw console.error(a),b||(b="Error"),b}function i(a){switch(a){case 1:return"g";case 11:return"G";case 2:return"a";case 12:return"A";case 3:return"t";case 13:return"T";case 4:return"c";case 14:return"C"}}function j(a){switch(a){case 1:case 11:return"G";case 2:case 12:return"A";case 3:case 13:return"T";case 4:case 14:return"C"}}function k(a,b,c,d){var e,f,g,i,j,k,l,m;(k=new Array(b))==null&&h("Insufficient memory for score calculations!\n"),(l=new Array(b))==null&&h("Insufficient memory for score calculations!\n"),(m=new Array(b))==null&&h("Insufficient memory for score calculations!\n");for(g=0;g<b;g++)(k[g]=new Array(d))==null&&h("Insufficient memory for score calculations!\n"),(l[g]=new Array(d))==null&&h("Insufficient memory for score calculations!\n"),(m[g]=new Array(d))==null&&h("Insufficient memory for score calculations!\n");for(g=0;g<b;g++)for(i=0;i<d;i++)(a[g]+c[d-1-i])%10==5&&a[g]*c[d-1-i]%10==4?k[g][i]=pb:(a[g]+c[d-1-i])%10==5&&a[g]*c[d-1-i]%10==6?k[g][i]=qb:(a[g]+c[d-1-i])%10==4&&a[g]*c[d-1-i]%10==3?k[g][i]=rb:k[g][i]=sb;e=0,l[0][0]=k[0][0],l[0][0]<0?(l[0][0]=0,m[0][0]=0):(l[0][0]=l[0][0]+ub,m[0][0]=1),l[0][0]>e&&(e=l[0][0]);for(i=1;i<d;i++)l[0][i]=k[0][i],l[0][i]<0?(l[0][i]=0,m[0][i]=0):(l[0][i]=l[0][i]+ub,m[0][i]=1),l[0][i]>e&&(e=l[0][i]);for(g=1;g<b;g++){l[g][0]=k[g][0],l[g][0]<0?(l[g][0]=0,m[g][0]=0):(l[g][0]=l[g][0]+ub,m[g][0]=1),l[g][0]>e&&(e=l[g][0]);for(i=1;i<d;i++){if(k[g][i]<0)m[g][i]=0,l[g][i]=0,m[g-1][i-1]>0&&l[g-1][i-1]+sb>0&&(l[g][i]=l[g-1][i-1]+sb),m[g-1][i-1]==0&&l[g-1][i-1]+tb>0&&(l[g][i]=l[g-1][i-1]+tb),m[g][i-1]>0&&l[g][i-1]+sb>0&&l[g][i-1]+sb>l[g][i]&&(l[g][i]=l[g][i-1]+sb),m[g][i-1]==0&&l[g][i-1]+tb>0&&l[g][i-1]+tb>l[g][i]&&(l[g][i]=l[g][i-1]+tb),m[g-1][i]>0&&l[g-1][i]+sb>0&&l[g-1][i]+sb>l[g][i]&&(l[g][i]=l[g-1][i]+sb),m[g-1][i]==0&&l[g-1][i]+tb>0&&l[g-1][i]+tb>l[g][i]&&(l[g][i]=l[g-1][i]+tb),l[g][i]<0&&(l[g][i]=0);else{l[g][i]=k[g][i],m[g][i]=1,m[g-1][i-1]>0&&l[g-1][i-1]>0?(l[g][i]=l[g-1][i-1]+k[g][i],m[g][i]=m[g-1][i-1]+1):m[g-1][i-1]==0&&l[g-1][i-1]>0&&(l[g][i]=l[g-1][i-1]+k[g][i],m[g][i]=1),m[g][i-1]>0&&l[g][i-1]>0&&l[g][i-1]+k[g][i]-k[g][i-1]+sb>l[g][i]?(l[g][i]=l[g][i-1]+k[g][i]-k[g][i-1]+sb,m[g][i]=1):m[g][i-1]==0&&l[g][i-1]>0&&l[g][i-1]+k[g][i]>l[g][i]&&(l[g][i]=l[g][i-1]+k[g][i],m[g][i]=1),m[g-1][i]>0&&l[g-1][i]>0&&l[g-1][i]+k[g][i]-k[g-1][i]+sb>l[g][i]?(l[g][i]=l[g-1][i]+k[g][i]-k[g-1][i]+sb,m[g][i]=1):m[g-1][i]==0&&l[g-1][i]>0&&l[g-1][i]+k[g][i]>l[g][i]&&(l[g][i]=l[g-1][i]+k[g][i],m[g][i]=1);if(m[g][i]>wb){f=xb;for(j=wb;j<m[g][i];j++)f*=yb;l[g][i]=l[g][i]+f}}m[g][i]>0&&(g==b-1||i==d-1)&&(l[g][i]=l[g][i]+ub),l[g][i]>e&&(e=l[g][i])}}return e}function l(a,b){var c,d,e,f,g,i,j,k;(i=new Array(b))==null&&h("Insufficient memory for score calculations!\n"),(j=new Array(b))==null&&h("Insufficient memory for score calculations!\n"),(k=new Array(b))==null&&h("Insufficient memory for score calculations!\n");for(e=0;e<b;e++)(i[e]=new Array(b))==null&&h("Insufficient memory for score calculations!\n"),(j[e]=new Array(b))==null&&h("Insufficient memory for score calculations!\n"),(k[e]=new Array(b))==null&&h("Insufficient memory for score calculations!\n");for(e=0;e<b;e++)for(f=0;f<b;f++)(a[e]+(15-a[b-1-f]))%10==5&&a[e]*(15-a[b-1-f])%10==4?i[e][f]=pb:(a[e]+(15-a[b-1-f]))%10==5&&a[e]*(15-a[b-1-f])%10==6?i[e][f]=qb:(a[e]+(15-a[b-1-f]))%10==4&&a[e]*(15-a[b-1-f])%10==3?i[e][f]=rb:i[e][f]=sb;c=0,j[0][0]=0;for(f=1;f<b;f++)j[0][f]=i[0][f],j[0][f]<0?(j[0][f]=0,k[0][f]=0):(j[0][f]=j[0][f]+ub,k[0][f]=1),j[0][f]>c&&(c=j[0][f]);for(e=1;e<b;e++){j[e][0]=i[e][0],j[e][0]<0?(j[e][0]=0,k[e][0]=0):(j[e][0]=j[e][0]+ub,k[e][0]=1),j[e][0]>c&&(c=j[e][0]);for(f=1;f<b;f++){if(e==f)k[e][f]=0,j[e][f]=0;else if(i[e][f]<0)k[e][f]=0,j[e][f]=0,k[e-1][f-1]>0&&j[e-1][f-1]+sb>0&&(j[e][f]=j[e-1][f-1]+sb),k[e-1][f-1]==0&&j[e-1][f-1]+tb>0&&(j[e][f]=j[e-1][f-1]+tb),k[e][f-1]>0&&j[e][f-1]+sb>0&&j[e][f-1]+sb>j[e][f]&&(j[e][f]=j[e][f-1]+sb),k[e][f-1]==0&&j[e][f-1]+tb>0&&j[e][f-1]+tb>j[e][f]&&(j[e][f]=j[e][f-1]+tb),k[e-1][f]>0&&j[e-1][f]+sb>0&&j[e-1][f]+sb>j[e][f]&&(j[e][f]=j[e-1][f]+sb),k[e-1][f]==0&&j[e-1][f]+tb>0&&j[e-1][f]+tb>j[e][f]&&(j[e][f]=j[e-1][f]+tb),j[e][f]<0&&(j[e][f]=0);else{j[e][f]=i[e][f],k[e][f]=1,k[e-1][f-1]>0&&j[e-1][f-1]>0?(j[e][f]=j[e-1][f-1]+i[e][f],k[e][f]=k[e-1][f-1]+1):k[e-1][f-1]==0&&j[e-1][f-1]>0&&(j[e][f]=j[e-1][f-1]+i[e][f],k[e][f]=1),k[e][f-1]>0&&j[e][f-1]>0&&j[e][f-1]+i[e][f]-i[e][f-1]+sb>j[e][f]?(j[e][f]=j[e][f-1]+i[e][f]-i[e][f-1]+sb,k[e][f]=1):k[e][f-1]==0&&j[e][f-1]>0&&j[e][f-1]+i[e][f]>j[e][f]&&(j[e][f]=j[e][f-1]+i[e][f],k[e][f]=1),k[e-1][f]>0&&j[e-1][f]>0&&j[e-1][f]+i[e][f]-i[e-1][f]+sb>j[e][f]?(j[e][f]=j[e-1][f]+i[e][f]-i[e-1][f]+sb,k[e][f]=1):k[e-1][f]==0&&j[e-1][f]>0&&j[e-1][f]+i[e][f]>j[e][f]&&(j[e][f]=j[e-1][f]+i[e][f],k[e][f]=1);if(k[e][f]>wb){d=xb;for(g=wb;g<k[e][f];g++)d*=yb;j[e][f]=j[e][f]+d}}k[e][f]>0&&(e==b-1||f==b-1)&&(j[e][f]=j[e][f]+ub),j[e][f]>c&&(c=j[e][f])}}return c}function Ib(){eb=ob.rule_4g,fb=ob.rule_6at,gb=ob.rule_ccend,hb=ob.rule_ming,ib=ob.rule_init,jb=ob.rule_lockold,kb=ob.rule_targetworst,lb=ob.rule_gatc_avail,mb=ob.rule_targetdomain,nb=ob.rule_shannon}function Jb(){Eb=Hb.MAX_MUTATIONS,pb=Hb.GCstr,qb=Hb.ATstr,rb=Hb.GTstr,sb=Hb.MBstr,tb=Hb.LLstr,ub=Hb.DHstr,vb=Hb.MAX_IMPORTANCE,wb=Hb.LHbases,xb=Hb.LHstart,yb=Hb.LHpower,zb=Hb.INTRA_SCORE,Ab=Hb.CROSSTALK_SCORE,Bb=Hb.CROSSTALK_DIV,Cb=Hb.GGGG_PENALTY,Db=Hb.ATATAT_PENALTY,Fb=Hb.SHANNON_BONUS,Gb=Hb.SHANNON_ADJUST}function Kb(a,b,c,d){d=d||!Z;var e,f;if(!d)e=L+a.length,f=L,Z.length=e,W.length=e,Y.length=e,X.length=e;else{e=a.length,f=0;if((Z=new Array(e))==null)throw console.error("Insufficient memory for declaring domain pointers!\n"),"Error";if((W=new Array(e))==null)throw console.error("Insufficient memory for declaring domain lengths!\n"),"Error";if((Y=new Array(e))==null)throw console.error("Insufficient memory for declaring domain base availability!\n"),"Error";if((X=new Array(e))==null)throw console.error("Insufficient memory for declaring domain importances!\n"),"Error"}L=e;for(n=f;n<L;n++)N=a[n-f].trim(),m=a[n-f].length,W[n]=m,Z[n]=Nb(N),X[n]=_.isArray(b)?b[n-f]:_.isNumber(b)?b:1,Y[n]=_.isArray(c)?c[n-f]:_.isNumber(c)?c:15;Qb()}function Lb(){Z.pop(),W.pop(),Y.pop(),X.pop();var a=t.pop();return L--,Qb(),a}function Mb(a){Z.splice(a,1),W.splice(a,1),Y.splice(a,1),X.splice(a,1);var b=t.splice(a,1);return L--,Qb(),b}function Nb(a){var b=new Array(a.length);for(m=0;m<a.length;m++)if(a[m]=="g")b[m]=1;else if(a[m]=="a")b[m]=2;else if(a[m]=="t")b[m]=3;else if(a[m]=="c")b[m]=4;else if(a[m]=="G")b[m]=11;else if(a[m]=="A")b[m]=12;else if(a[m]=="T")b[m]=13;else if(a[m]=="C")b[m]=14;else if(a[m]=="N"||a[m]=="n")b[m]=Sb();return b}function Ob(a,b){var c=_.compact(a.split("\n"));c[0].trim().match(/^\d+$/g)&&c.shift(),L=c.length,M=b||0;if((Z=new Array(L+M))==null)throw console.error("Insufficient memory for declaring domain pointers!\n"),"Error";if((W=new Array(L+M))==null)throw console.error("Insufficient memory for declaring domain lengths!\n"),"Error";if((Y=new Array(L+M))==null)throw console.error("Insufficient memory for declaring domain base availability!\n"),"Error";if((X=new Array(L+M))==null)throw console.error("Insufficient memory for declaring domain importances!\n"),"Error";for(n=0;n<L;n++){var d=c[n].split(" "),e=c[n];m=0;while(e[m]!=" "){if(e[m]!="G"&&e[m]!="A"&&e[m]!="T"&&e[m]!="C"&&e[m]!="g"&&e[m]!="a"&&e[m]!="t"&&e[m]!="c")throw printf("Input file corrupted.  Sequence for domain %d contains a non-base (%c) at position %d.\n",n+1,e[m],m+1),"Error";m++}W[n]=m,Z[n]=Nb(e.substr(0,m)),m=W[n]+1,X[n]=parseInt(d[1]),Y[n]=parseInt(d[2]);if(isNaN(X[n]))throw printf("Input file corrupted.  Non-numeric parameter for importance of domain %d.\n",n+1),"Error";if(isNaN(Y[n]))throw printf("Input file corrupted.  Non-numeric parameter for base composition of domain %d.\n",n+1),"Error";if(Y[n]>15||Y[n]<1)throw printf("Input file corrupted at domain %d.  Domain base composition must be between 1 and 15.\n",n+1),"Error"}Rb(),Qb()}function Pb(a,b){L=a;if((Z=new Array(L))==null)throw console.error("Insufficient memory for declaring domain pointers!\n"),"Error";if((W=new Array(L))==null)throw console.error("Insufficient memory for declaring domain lengths!\n"),"Error";if((Y=new Array(L))==null)throw console.error("Insufficient memory for declaring domain base availability!\n"),"Error";if((X=new Array(L))==null)throw console.error("Insufficient memory for declaring domain importances!\n"),"Error";if(_.isArray(b))W=b;else{b||(b=7);for(m=0;m<L;m++)W[m]=b}for(m=0;m<L;m++){if((Z[m]=new Array(W[m]))==null)throw console.error("Insufficient memory for declaring domain bases!\n"),"Error";X[m]=1}eb=1,fb=1,gb=1,hb=1,ib=7,kb=1,lb=15,G=0,Rb(),Qb(),Tb()}function Qb(){if((t=new Array(L))==null)throw console.error("Insufficient memory for declaring domain score matrix!\n"),"Error";if((bb=new Array(L))==null)throw console.error("Insufficient memory for declaring domain score matrix!\n"),"Error";if(($=new Array(L))==null)throw console.error("Insufficient memory for declaring crosstalk matrices!\n"),"Error";for(m=0;m<L;m++)if(($[m]=new Array(L))==null)throw console.error("Insufficient memory for declaring crosstalk matrices!\n"),"Error";if((ab=new Array(L))==null)throw console.error("Insufficient memory for declaring interaction matrices!\n"),"Error";for(m=0;m<L;m++)if((ab[m]=new Array(L))==null)throw console.error("Insufficient memory for declaring interaction matrices!\n"),"Error"}function Rb(){cb=0,db=0,z=0,T=0,U=0,V=0}function Sb(){var a=0;while(a==0)o=g(1,4),o==4&&Math.floor(ib/8)==1&&(a=1),o==3&&Math.floor(ib/4)%2==1&&(a=2),o==2&&Math.floor(ib/2)%2==1&&(a=3),o==1&&Math.floor(ib%2)==1&&(a=4);return a}function Tb(){for(m=0;m<L;m++)Ub(m)}function Ub(a){Y[a]=lb;for(n=0;n<W[a];n++)Z[a][n]=Sb();gb==1&&(Math.floor(lb%2)==1?Z[a][0]=14:Math.floor(lb/8)==1?Z[a][0]=11:Math.floor(lb/2)%2==1?Z[a][0]=13:Z[a][0]=12,lb%2==1?Z[a][W[a]-1]=14:Math.floor(lb/8)==1?Z[a][W[a]-1]=11:Math.floor(lb/4)%2==1?Z[a][W[a]-1]=12:Z[a][W[a]-1]=13)}function Vb(a,b){var c=new Array(a);for(m=0;m<a;m++){c[m]=new Array(b);for(n=0;n<b;n++){c[m][n]=0;while(c[m][n]==0)o=g(1,4),o==4&&Math.floor(ib/8)==1&&(c[m][n]=1),o==3&&Math.floor(ib/4)%2==1&&(c[m][n]=2),o==2&&Math.floor(ib/2)%2==1&&(c[m][n]=3),o==1&&Math.floor(ib%2)==1&&(c[m][n]=4)}gb==1&&(Math.floor(lb%2)==1?c[m][0]=14:Math.floor(lb/8)==1?c[m][0]=11:Math.floor(lb/2)%2==1?c[m][0]=13:c[m][0]=12,lb%2==1?c[m][b-1]=14:Math.floor(lb/8)==1?c[m][b-1]=11:Math.floor(lb/4)%2==1?c[m][b-1]=12:c[m][b-1]=13)}return c}function Wb(){for(m=0;m<L;m++){for(n=0;n<W[m];n++)if(Z[m][n]<10){Z[m][n]=0;while(Z[m][n]==0)o=g(1,4),o==4&&ib/8==1&&(Z[m][n]=1),o==3&&ib/4%2==1&&(Z[m][n]=2),o==2&&ib/2%2==1&&(Z[m][n]=3),o==1&&ib%2==1&&(Z[m][n]=4)}gb==1&&(Y[m]%2==1?Z[m][0]=14:Y[m]/8==1?Z[m][0]=11:Y[m]/2%2==1?Z[m][0]=13:Z[m][0]=12,Y[m]%2==1?Z[m][W[m]-1]=14:Y[m]/8==1?Z[m][W[m]-1]=11:Y[m]/4%2==1?Z[m][W[m]-1]=12:Z[m][W[m]-1]=13)}}function Xb(){var a="";a+=L+"\n";for(m=0;m<L;m++){for(n=0;n<W[m];n++)Z[m][n]==1&&(a+="g"),Z[m][n]==11&&(a+="G"),Z[m][n]==2&&(a+="a"),Z[m][n]==12&&(a+="A"),Z[m][n]==3&&(a+="t"),Z[m][n]==13&&(a+="T"),Z[m][n]==4&&(a+="c"),Z[m][n]==14&&(a+="C");a+=" "+X[m]+" "+Y[m]+"\n"}return a}function Yb(){for(m=0;m<L;m++)for(n=0;n<L;n++)if(m==n)ab[m][n]=k(Z[m],W[m],Z[n],W[n])+zb,$[m][n]=l(Z[m],W[m])/Bb+zb;else{ab[m][n]=k(Z[m],W[m],Z[n],W[n]);for(o=0;o<W[n];o++)O[o]=15-Z[n][W[n]-1-o];$[m][n]=k(Z[m],W[m],O,W[n])/Bb}Zb(),$b()}function Zb(){for(m=0;m<L;m++)ac(m)}function $b(){q=0;for(m=0;m<L;m++){t[m]=0;for(n=0;n<L;n++)ab[m][n]+X[m]+X[n]>t[m]&&(t[m]=ab[m][n]+X[m]+X[n]),$[m][n]+X[m]+X[n]+Ab>t[m]&&(t[m]=$[m][n]+X[m]+X[n]+Ab);t[m]=t[m]+bb[m],t[m]>q&&(q=t[m],u=m)}if(mb&&mb.length>0){q=0;for(m=0;m<mb.length;m++)t[mb[m]]>q&&(q=t[mb[m]],u=mb[m])}}function _b(a){r=q,s=bb[a];for(m=0;m<L;m++)if(m==a)ab[m][m]=k(Z[m],W[m],Z[m],W[m])+zb,$[m][m]=l(Z[m],W[m])/Bb+zb;else{ab[m][a]=k(Z[m],W[m],Z[a],W[a]),ab[a][m]=k(Z[a],W[a],Z[m],W[m]);for(o=0;o<W[a];o++)O[o]=15-Z[a][W[a]-1-o];$[m][a]=k(Z[m],W[m],O,W[a])/Bb;for(o=0;o<W[m];o++)O[o]=15-Z[m][W[m]-1-o];$[a][m]=k(Z[a],W[a],O,W[m])/Bb}ac(a),$b()}function ac(a){bb[a]=0,eb==1&&bc(a),fb==1&&cc(a),nb==1&&dc(a)}function bc(a){o=0;for(n=0;n<W[a];n++)Z[a][n]%10==1&&o<100?o++:Z[a][n]%10==1&&(o=1),Z[a][n]%10==4&&o>100?o++:Z[a][n]%10==4&&(o=101),o<100&&o>3?bb[a]=bb[a]+Cb:o>103&&(bb[a]=bb[a]+Cb)}function cc(a){o=0;for(n=0;n<W[a];n++)Z[a][n]%10==2||Z[a][n]%10==3?o++:o=0,o>5&&(bb[a]=bb[a]+Db);o=0;for(n=0;n<W[a];n++)Z[a][n]%10==1||Z[a][n]%10==4?o++:o=0,o>5&&(bb[a]=bb[a]+Db)}function dc(a){if(nb==1){A=0,B=0,C=0,D=0,E=0,F=0;for(n=0;n<W[a];n++)E=Z[a][n]%10,E==1?A++:E==2?B++:E==3?C++:E==4&&D++;A/=W[a],B/=W[a],C/=W[a],D/=W[a],shannon=-(A*(A>0?f(A):0)+B*(B>0?f(B):0)+C*(C>0?f(C):0)+D*(D>0?f(D):0)),F=Y[a],F=(F&1)+((F&2)>>1)+((F&4)>>2)+((F&8)>>3),bb[a]-=(shannon-Gb*f(F))*Fb}}function ec(){if(Z.length==0)return;cb++,z=0;while(z<Eb-1&&g(0,1)==1)z++;z++,kb?g(1,3)==1?v=u?u:g(0,L-1):v=g(0,L-1):mb&&mb.length!=0?v=mb[mb.length==1?0:g(0,mb.length-1)]:v=g(0,L-1);for(o=0;o<z;o++){n=g(0,W[v]-1);if(Z[v][n]>10)w[o]=n,y[o]=Z[v][n],x[o]=y[o];else{w[o]=n,y[o]=Z[v][n];if((Y[v]&1)+(Y[v]&2)/2+(Y[v]&4)/4+(Y[v]&8)/8>1)if(hb){do x[o]=g(1,100),x[o]<5?x[o]=1:x[o]<37?x[o]=2:x[o]<69?x[o]=3:x[o]=4,x[o]==1&&(Y[v]&8)==0&&(x[o]=y[o]),x[o]==2&&(Y[v]&4)==0&&(x[o]=y[o]),x[o]==3&&(Y[v]&2)==0&&(x[o]=y[o]),x[o]==4&&(Y[v]&1)==0&&(x[o]=y[o]);while(x[o]==y[o])}else do x[o]=g(1,100),x[o]<26?x[o]=1:x[o]<51?x[o]=2:x[o]<76?x[o]=3:x[o]=4,x[o]==1&&(Y[v]&8)==0&&(x[o]=y[o]),x[o]==2&&(Y[v]&4)==0&&(x[o]=y[o]),x[o]==3&&(Y[v]&2)==0&&(x[o]=y[o]),x[o]==4&&(Y[v]&1)==0&&(x[o]=y[o]);while(x[o]==y[o])}}for(o=0;o<z;o++)Z[v][w[o]]=x[o];r=q,_b(v),$b();if(q<r||q==r&&g(1,100)<=80)db+=z,q!=r&&(T=0),U=r-q,V=.9*V+2*U;else{T++,q=r;for(o=z-1;o>=0;o--)Z[v][w[o]]=y[o];bb[v]=s;for(m=0;m<L;m++)if(m==v)ab[m][m]=k(Z[m],W[m],Z[m],W[m])+zb,$[m][m]=l(Z[m],W[m])/Bb+zb;else{ab[m][v]=k(Z[m],W[m],Z[v],W[v]),ab[v][m]=k(Z[v],W[v],Z[m],W[m]);for(o=0;o<W[v];o++)O[o]=15-Z[v][W[v]-1-o];$[m][v]=k(Z[m],W[m],O,W[v])/Bb;for(o=0;o<W[m];o++)O[o]=15-Z[m][W[m]-1-o];$[v][m]=k(Z[v],W[v],O,W[m])/Bb}}}var a=90,b=80,c=60,d=1,e=0,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=0,B=0,C=0,D=0,E=0,F=0,G,H,I,J,K,L,M,N="",O=new Array(c),P=new Array(30),Q=new Array(30),R,S;cb=0,db=0,z=0,q=0;var T=0,U=0,V=0,W,X,Y,Z,$,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob={rule_4g:1,rule_6at:1,rule_ccend:1,rule_ming:1,rule_init:7,rule_targetworst:1,rule_gatc_avail:15,rule_lockold:0,rule_targetdomain:[],rule_shannon:1},pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,Ab,Bb,Cb,Db,Eb,Fb,Gb,Hb={MAX_MUTATIONS:10,GCstr:2,ATstr:1,GTstr:0,MBstr:-3,LLstr:-0.5,DHstr:3,MAX_IMPORTANCE:100,LHbases:4,LHstart:2,LHpower:2,INTRA_SCORE:5,CROSSTALK_SCORE:-5,CROSSTALK_DIV:2,GGGG_PENALTY:50,ATATAT_PENALTY:20,SHANNON_BONUS:3,SHANNON_ADJUST:.7};Ib(),Jb();if((w=new Array(Eb))==null)throw console.error("Insufficient memory for declaring mutation memories!\n"),"Error";if((y=new Array(Eb))==null)throw console.error("Insufficient memory for declaring mutation memories!\n"),"Error";if((x=new Array(Eb))==null)throw console.error("Insufficient memory for declaring mutation memories!\n"),"Error";_.extend(this,{version:"0.3.1",loadFile:Ob,saveFile:Xb,newDesign:Pb,randomSequence:Vb,reseed:Tb,reseedDomain:Ub,addDomains:Kb,removeDomain:Mb,mutate:ec,mutateUntil:function(a){do this.mutate();while(!a(this))},mutateWhile:function(a){do this.mutate();while(a(this))},evaluateAllScores:Yb,evaluateScores:_b,evaluateIntrinsicScores:Zb,popDomain:Lb,saveState:function(){return state={},state.domain_length=W,state.domain_importance=X,state.domain_gatc_avail=Y,state.domain=Z,state.num_domain=L,state.num_mut_attempts=cb,db=db,state.score=q,state.domain_score=t,state.worst_domain=u,state.num_mut=z,state.rules=_.clone(ob),state.params=_.clone(Hb),state.verson=this.version,state},loadState:function(a){W=a.domain_length||W,X=a.domain_importance||X,Y=a.domain_gatc_avail||Y,Z=a.domain||Z,cb=a.num_mut_attempts&&_.isNumber(a.num_mut_attempts)?a.num_mut_attempts:0,db=a.total_mutations&&_.isNumber(a.total_mutations)?a.total_mutations:0,L=a.num_domain&&_.isNumber(a.num_domain)?a.num_domain:Z.length,q=a.score||q,t=a.domain_score||t,u=a.worst_domain||u,z=a.num_mut||z,_.extend(ob,a.rules),_.extend(Hb,a.params),Qb()},resetCounters:Rb,serialize:function(){this.saveState.apply(this,arguments)},deserialize:function(){this.loadState.apply(this,arguments)},getRules:function(){return _.clone(ob)},updateRules:function(a){a=_.defaults(a,ob),_.extend(ob,a),Ib()},getParams:function(){return _.clone(Hb)},updateParams:function(a){a=_.defaults(a,Hb),_.extend(Hb,_.reduce(a,function(a,b,c){return a[c]=+b,a},{})),Jb()},updateDomain:function(a,b,c,d){b=b.trim(),Z[a]=Nb(b),W[a]=b.length,c&&c!=0&&(X[a]=c),d&&d!=0&&(Y[a]=d)},targetDomain:function(a){mb.indexOf(a)==-1&&(mb.push(a),ob.rule_targetdomain=mb,ob.rule_targetworst=kb=0)},untargetDomain:function(a){var b=mb.indexOf(a);b!=-1&&(mb.splice(b),ob.rule_targetdomain=mb,mb.length==0&&(ob.rule_targetworst=kb=1))},getMutationAttempts:function(){return cb},getMutationCount:function(){return db},getMutationFlux:function(){return V},getBoredMutations:function(){return T},getMutationDelta:function(){return U},getWorstDomain:function(){return u},getWorstScore:function(){return q},getScore:function(a,b){return(b||!1)&&this.evaluthis.domain_length,t[a]},getScores:function(a){return a=a||!1,a&&$b(),t},getMutatedDomain:function(){return v},getDomainCount:function(){return L||0},getDomains:function(){return Z},printfDomain:function(a){return _.reduce(a,function(a,b){return a+=i(b)},"")},printDomain:function(a){return _.reduce(a,function(a,b){return a+=j(b)},"")},printDomainById:function(a){var b=Z[a];return this.printDomain(b)},printfDomainById:function(a){var b=Z[a];return this.printfDomain(b)},getImportance:function(){return Y},getCompositions:function(){return Y},getImportances:function(){return X},printComposition:function(a){var b="";return(a&8)>>3&&(b+="G"),(a&4)>>2&&(b+="A"),(a&2)>>1&&(b+="T"),a&1&&(b+="C"),b},printCompositionById:function(a){return this.printComposition(Y[a])},printDomains:function(){return _.map(Z,this.printDomain,this)},printfDomains:function(){return _.map(Z,this.printfDomain,this)}})};typeof module!="undefined"&&(module.exports=DD);
Ext.define("App.ui.Launcher",{singleton:!0,triggerDelimiter:":",_triggers:{},_openTabs:{},register:function(a,b,c){c||(c={}),this._triggers[a]={cls:b,config:c}},getActiveApp:function(){return this.tabPanel.getActiveTab()},addTab:function(a){this.tabPanel&&this.tabPanel.add(a)},launchDocument:function(a){return a.app?(this.tabPanel.setActive(a.app),a.app):a.get("trigger")?App.ui.Launcher.launch(a.get("trigger"),a):null},renewAll:function(){},launch:function(a,b){if(!a||a=="false")return;g=this._openTabs[a];if(g)this.tabPanel.setActiveTab(g);else{var c=a.split(this.triggerDelimiter),d=c.shift(),e=this._triggers[d],f,g;if(e){f=this.tabPanel.setLoading("Loading...");try{g=Ext.create(e.cls,Ext.apply({},e.config,{document:b||!1,initialTrigger:a,triggers:c,closable:!0,listeners:{afterrender:{fn:function(){f.hide()},single:!0}}}))}catch(h){App.msg("Application failed to load","An error occurred loading application {0}, see console for details. ",{params:[d]}),App.log("Failed to launch application with trigger "+a+". Error details: "+h,{iconCls:"application",level:"error",silent:!0}),f.hide()}}else f=this.tabPanel.setLoading("Loading..."),g=Ext.createByAlias("app."+d,{document:b||!1,initialTrigger:a,triggers:c,closable:!0,listeners:{afterrender:{fn:function(){f.hide()},single:!0}}});if(g)return this.addTab(g),this.tabPanel.setActiveTab(g),this._openTabs[a]=g,g.on("close",function(a){delete this._openTabs[a.initialTrigger]},this),App.log("Launched application with trigger: "+a,{iconCls:"application",silent:!0}),f.hide(),g}},getLaunchers:function(){return this._triggers},makeLauncher:function(a){return Ext.bind(function(){this.launch(a)},this)},toggleConsole:function(){this.console.toggleCollapse()},showConsole:function(){this.console.expand()},getAppMenu:function(a){return this.appMenu||(this.appMenu=Ext.create("Ext.menu.Menu",{})),this.appMenu.removeAll(),this.appMenu.suspendLayout=!0,_.each(this._openTabs,function(b,c){this.appMenu.add({text:b.title,iconCls:b.iconCls||"application",handler:a?_.bind(a,b,b,c):this.makeLauncher(c)})},this),this.appMenu.suspendLayout=!1,this.appMenu.doLayout(),this.appMenu},updateAppMenu:function(a,b){}},function(){App.ui.Launcher.register("help","App.ui.Help",{}),App.ui.Launcher.register("nodal","App.usr.nodal.Canvas",{title:"Nodal System",editorType:"Nodal",iconCls:"nodal"}),App.ui.Launcher.register("primary","App.usr.canvas.Canvas",{title:"Primary Structure",editorType:"Primary",iconCls:"line",border:!1,ribbonItems:[{xtype:"primary-hometab",title:"Home",border:!1}]}),App.ui.Launcher.register("whiteboard","App.usr.canvas.Canvas",{title:"Whiteboard"}),App.ui.Launcher.register("dashboard","App.ui.Dashboard",{}),App.ui.Launcher.register("nupack/design","App.usr.browser.Browser",{url:"http://www.nupack.org/design",title:"NUPACK Design",iconCls:"nupack-icon"}),App.ui.Launcher.register("nupack/analyze","App.usr.browser.Browser",{url:"http://www.nupack.org/partition",title:"NUPACK Analysis",iconCls:"nupack-icon"}),App.ui.Launcher.register("nupack/utilities","App.usr.browser.Browser",{url:"http://www.nupack.org/utilities",title:"NUPACK Util",iconCls:"nupack-icon"}),App.ui.Launcher.register("nupack","App.usr.browser.Browser",{url:"http://www.nupack.org/",iconCls:"nupack-icon",title:"NUPACK"}),App.ui.Launcher.register("viewer","App.usr.viewer.Viewer",{}),App.ui.Launcher.register("nupackedit","App.usr.nupack.Editor",{}),App.ui.Launcher.register("msedit","App.usr.ms.Editor"),App.ui.Launcher.register("enumedit","App.usr.enum.Editor"),App.ui.Launcher.register("enumview","App.usr.enum.Viewer"),App.ui.Launcher.register("taskmanager","App.ui.TaskManager",{iconCls:"system-monitor",title:"Task Manager"}),App.ui.Launcher.register("js","App.usr.js.Editor",{}),App.ui.Launcher.register("json","App.usr.js.Editor",{json:!0}),App.ui.Launcher.register("txt","App.usr.text.Editor",{iconCls:"txt",editorType:"Text",mode:""}),App.ui.Launcher.register("dynaml","App.usr.dynaml.Editor",{}),App.ui.Launcher.register("html","App.usr.text.Editor",{iconCls:"html",editorType:"HTML",mode:"htmlmixed"}),App.ui.Launcher.register("xml","App.usr.text.Editor",{iconCls:"xml",editorType:"XML",mode:"xml"}),App.ui.Launcher.register("sbml","App.usr.sbml.Editor",{}),App.ui.Launcher.register("tex","App.usr.text.Editor",{iconCls:"tex",editorType:"TeX",mode:"stex"}),App.ui.Launcher.register("md","App.usr.text.Editor",{iconCls:"md",editorType:"Markdown",mode:"gfm"}),App.ui.Launcher.register("rst","App.usr.text.Editor",{iconCls:"rst",editorType:"ReStructuredText",mode:"rst"}),App.ui.Launcher.register("pil","App.usr.text.Editor",{iconCls:"pil",editorType:"PIL",mode:"pepper"}),App.ui.Launcher.register("pepper","App.usr.pepper.Editor",{iconCls:"pepper",editorType:"Pepper",mode:"pepper"}),App.ui.Launcher.register("strandedit","App.usr.dil.DilEditor",{}),App.ui.Launcher.register("dil","App.usr.dil.DilEditor",{}),App.ui.Launcher.register("sequence","App.usr.seq.Editor",{}),App.ui.Launcher.register("nupackresults","App.usr.nupack.Results",{iconCls:"nupack-icon",editorType:"NUPACK Results"}),App.ui.Launcher.register("dd","App.usr.dd.DD",{iconCls:"seq"}),App.ui.active=function(){return App.ui.Launcher.getActiveApp()}});
Ext.define("App.ui.Application",{autoHideLoadingMask:!0,autoHideSavingMask:!0,loadingMsg:"Loading File...",savingMsg:"Saving File...",constructor:function(a){this.bindDocument(a?a.document?a.document:null:null,!0)},requestDocument:function(a,b){this.document?Ext.callback(a,b,[this.document]):Ext.window.MessageBox.prompt("Save document","This action requires you to save your work to a file; please enter a file name.",function(a,b){if(a=="ok"){var c=App.ui.filesTree.newFileUnderSelection(fileName);this.bindDocument(c)}},this)},renew:function(){if(this.doc){var a=this.doc.id,b=App.DocumentStore.getRootNode().findChildBy(function(b){return b.id==a},!0);b&&(this.unbindDocument(),this.bindDocument(b))}},bindDocument:function(a,b){b||(b=!1),this.doc=this.document=a,this.doc&&(this.doc.on("edit",this.updateTitle,this),this.updateTitle(),b||this.fireEvent("binddocument",this,a))},unbindDocument:function(){this.doc.un("edit",this.updateTitle,this),this.doc=this.document=null,this.fireEvent("unbinddocument",this,this.doc)},updateTitle:function(){var a=this.editorType;this.doc&&(a=this.doc.getBasename()+" ("+a+")");try{this.setTitle(a)}catch(b){}},getPath:function(){return this.doc?this.doc.getDocumentPath():!1},getDocumentPath:function(){return this.getPath()},loadFile:function(){this.loadingMask=new Ext.LoadMask(this.body,{msg:this.loadingMsg}),this.doc?this.doc.loadBody({success:this.doLoad,failure:this.doLoadFail,scope:this}):(this.data="",this.onLoad())},doLoad:function(a){this.data=a,this.onLoad(),this.autoHideLoadingMask&&this.loadingMask.hide()},doLoadFail:function(a){this.autoHideLoadingMask&&this.loadingMask.hide(),console.log("File load failed.",a),App.log("File load failed.",{silent:!0,error:!0}),Ext.msg("File","Couldn't load file <strong>{0}</strong>. Message: {1}",this.document.get("text"),a.message||"none")},onLoad:function(){},save:function(){return this.saveFile.apply(this,arguments)},saveFile:function(){this.savingMask||(this.savingMask=new Ext.LoadMask(this.body,{msg:this.savingMsg})),this.savingMask.show();var a=this.getSaveData();this._lastSave=a,Ext.isObject(a)&&(a=Ext.encode(a)),this.doc.saveBody(a,{success:this.doSave,failure:this.doSaveFail,scope:this})},doSave:function(){this.autoHideSavingMask&&this.savingMask.hide(),this.onSave(),App.log("File saved to server.",{silent:!0,iconCls:"save"}),Ext.msg("File","<strong>{0}</strong> saved to server.",this.document.get("text"))},doSaveFail:function(a){this.autoHideSavingMask&&this.savingMask.hide(),App.log("File save failed.",{silent:!0,error:!0}),Ext.msg("File","Couldn't save file <strong>{0}</strong>. Message: {1}",this.document.get("text"),a.message||"none")},onSave:function(){},getSaveData:function(){return""}});
Ext.define("App.ui.TabPanel",{extend:"Ext.tab.Panel",bodyCls:"x-docked-noborder-top",plain:!0,items:[],initComponent:function(){this.mon(this,{scope:this,afterlayout:this.onAfterLayout,single:!0}),this.callParent(arguments)},onAfterLayout:function(){this.mon(this.tabBar.el,{scope:this,contextmenu:this.onContextMenu,delegate:"div.x-tab"})},onContextMenu:function(a,b){App.ui.Launcher.getAppMenu().showAt(a.getXY()),a.preventDefault()}});
Ext.define("App.ui.ButtonPicker",{extend:"Ext.button.Button",initComponent:function(){Ext.apply(this,{}),this.callParent(arguments);if(this.menu){this.menu.on("click",this.update,this);var a=this.menu.query("menuitem");this.iconMap={},this.itemMap={};for(var b=0;b<a.length;b++)this.iconMap[a[b].value]=a[b].iconCls,this.itemMap[a[b].value]=a[b]}this.setValue(this.value)},update:function(a,b,c){b&&this.setValue(b.value)},setValue:function(a){this.value=a,this.setIconCls(this.iconMap[a])},getValue:function(){return this.value}});
Ext.define("App.ui.Attribution",{statics:{getCite:function(a){return _.copy(this.cites[a])},cites:{zhang_2011:{authors:["Zhang, David Y."],title:"Towards Domain-Based Sequence Design for DNA Strand Displacement Reactions",publication:"Lecture Notes in Computer Science",volume:"6518",pages:"162-175",year:2011},zadeh_etal_2011:{authors:["J.N. Zadeh","C.D. Steenberg","J.S. Bois","B.R. Wolfe","M.B. Pierce","A.R. Khan","R.M. Dirks","N.A. Pierce"],title:"NUPACK: analysis and design of nucleic acid systems",publication:"J Comput Chem",volume:32,pages:"170–173",year:2011,url:"http://nupack.org/downloads/serve_public_file/jcc11a.pdf?type=pdf"},markham_zuker_2005:{authors:["Markham, N. R.","Zuker, M."],year:2005,title:"DINAMelt web server for nucleic acid melting prediction",publication:"Nucleic Acids Res.",volume:33,pages:"W577-W581",url:"http://nar.oxfordjournals.org/cgi/content/full/33/suppl_2/W577"},gruber_etal_2008:{authors:["Andreas R. Gruber","Ronny Lorenz","Stephan H. Bernhart","Richard Neuböck","Ivo L. Hofacker"],title:"The Vienna RNA Websuite",year:2008,publication:"Nucleic Acids Res.",volume:36,pages:"W70-W74",url:"http://nar.oxfordjournals.org/content/36/suppl_2/W70.full"},sbml_2003:{authors:["Hucka, M., Finney, A., Sauro, H. M., Bolouri, H., Doyle, J. C., Kitano, H., Arkin, A. P., Bornstein, B. J., Bray, D., Cornish-Bowden, A. , Cuellar, A. A., Dronov, S., Gilles, E. D., Ginkel, M., Gor, V., Goryanin, I. I., Hedley, W. J., Hodgman, T. C., Hofmeyr, J.-H., Hunter, P. J., Juty, N. S., Kasberger, J. L., Kremling, A., Kummer, U., Le Novère, N., Loew, L. M., Lucio, D., Mendes, P., Minch, E., Mjolsness, E. D., Nakayama, Y., Nelson, M. R., Nielsen, P. F., Sakurada, T., Schaff, J. C., Shapiro, B. E., Shimizu, T. S., Spence, H. D., Stelling, J., Takahashi, K., Tomita, M., Wagner, J., Wang, J."],year:2003,title:"The Systems Biology Markup Language (SBML): A medium for representation and exchange of biochemical network models.",publication:"Bioinformatics",volume:19,number:4,pages:"524–531"}},printAllCitations:function(){return this.tpl=new Ext.XTemplate(this.tpl),"<ul>"+_.map(this.cites,function(a,b){return this.tpl.apply(a)},this).join("\n")+"</ul>"},tpl:'<li><b>{[values.authors.join(", ")]}</b>. "{title}". <tpl if="!!publication"><i>{publication}</i> </tpl>{volume}<tpl if="!!volume && !!pages">:</tpl>{pages}<tpl if="!!year"> ({year})</tpl>. <tpl if="!!url"><a href="{url}">URL</a></tpl></li>'},extend:"Ext.window.Window",width:500,height:500,bodyStyle:"padding:10px; background-color: white;",autoScroll:!0,closeAction:"hide",title:"About",initComponent:function(){Ext.apply(this,{autoLoad:{url:"/attribution",callback:this.initAttribution,scope:this}}),this.callParent(arguments)},initAttribution:function(){}});
Ext.define("App.ui.console.LogPanel",{extend:"Ext.panel.Panel",autoScroll:!0,region:"center",border:"0 1 0 0",bodyBorder:!1,padding:"0 0 5 0",cls:"noborder-top",bodyCls:"noborder-top",html:'<div class="logBody"></div>',getLogBody:function(){return this.body.down(".logBody")},initComponent:function(){this.groups={},this.logLevels={info:"console-info",warn:"console-warn",error:"console-error"},this.callParent(arguments)},dump:function(a){if(typeof a=="string"||typeof a=="number"||typeof a=="undefined"||Ext.isDate(a))return a;if(!a)return"null";if(typeof a!="object")return"Unknown return type";if(Ext.isArray(a))return"["+a.join(",")+"]";var b=["{\n"];for(var c in a){var d=typeof a[c];d!="function"&&d!="object"&&b.push(Ext.String.format("  {0}: {1},\n",c,a[c]))}var e=b.join("");return e.length>3&&(e=e.substr(0,e.length-2)),e+"\n}"},log:function(a,b){var c="",d,e=this.body.dom;_.defaults(b,{silent:!1,iconCls:"",level:"info"}),a&&a!=""&&(_.isString(a)||(a=this.dump(a)),c=['<div class="console-message ',b.iconCls," ",this.logLevels[b.level],'">',Ext.util.Format.htmlEncode(a).replace(/\n/g,"<br/>").replace(/\s/g,"&#160;"),"</div>"].join(""));if(b.group){var f=Ext.isObject(b.group)?b.group.name:b.group;if(!this.groups[f]){var g=Ext.isObject(b.group)?b.group:{title:b.group};Ext.apply(g,{renderTo:this.getLogBody(),margin:"5 5 5 20",collapsible:!0,layout:"auto",minHeight:100,height:100,resizable:{handles:"s"},autoScroll:!0}),this.groups[f]=Ext.create("Ext.panel.Panel",g)}d=this.groups[f].body}else d=this.getLogBody();d.insertHtml("beforeend",c),e.scrollTop=e.scrollHeight},getGroupPanel:function(a){return this.groups[a]},clear:function(){_.each(this.groups,function(a,b){a.destroy()}),this.groups={},this.body.update(""),this.body.dom.scrollTop=0}});
Ext.define("App.ui.CitationBar",{alias:"widget.cite",extend:"Ext.panel.Panel",requires:["App.ui.Attribution"],cls:"simple-header citation-bar",dock:"bottom",frame:!0,padding:"5 5 5 5",tpl:'<b>{[values.authors.join(", ")]}</b>. "{title}". <i>{publication}</i> {volume}:{pages} ({year}). <a href="{url}">URL</a>',minHeight:36,initComponent:function(){this.tpl=new Ext.XTemplate(this.tpl),Ext.isString(this.cite)&&(this.cite=App.ui.Attribution.getCite(this.cite)),this.cite||(this.cite={}),Ext.applyIf(this.cite,{authors:[],title:"",publication:"",volume:"",pages:"",year:"",url:""}),Ext.applyIf(this,{html:this.tpl.apply(this.cite)}),this.callParent(arguments)}});
Ext.define("App.ui.sequence.AnalysisWindow",{extend:"Ext.window.Window",width:400,height:480,layout:"border",title:"Sequence Analysis",plain:!0,bodyBorder:!1,border:!1,closeAction:"hide",minimize:function(){this.toggleCollapse()},minimizable:!0,maximizable:!0,submitButtonText:"Analyze",cite:"",maxStrandCount:20,initComponent:function(){Ext.apply(this,{items:[{xtype:"codemirror",height:100,mode:"sequence",title:"Sequences",region:"center"},Ext.apply({region:"south",height:260,split:!0,xtype:"form",frame:!0,defaults:{xtype:"textfield",anchor:"100%"},dockedItems:[{xtype:"cite",cite:this.cite}]},this.getForm())],buttons:[{text:this.submitButtonText,handler:this.doSubmit,scope:this}]}),this.callParent(arguments)},doSubmit:function(){var a=this.down("form").getForm(),b=this.getStrands(),c=b.length,d=0,e;do e=d+Math.min(c,this.maxStrandCount),a.doAction("standardsubmit",{params:this.getParams(d,e),target:"_blank",url:this.url,method:"post",enctype:"multipart/form-data"}),c-=this.maxStrandCount,d+=this.maxStrandCount;while(c>0)},getForm:function(){return{}},getParams:function(){return{}},getValue:function(){var a=this.down("codemirror"),b=a.getValue();return b},setValue:function(a){var b=this.down("codemirror");b.setValue(a)},getStrands:function(){var a=this.getValue(),b=_.compact(a.split("\n"));return b},updateStrands:function(a){var b=this.down("codemirror");b.setValue(a)}});
Ext.define("App.ui.CodeMirror",{alias:"widget.codemirror",extend:"Ext.panel.Panel",value:"",autoScroll:!0,lineNumbers:!0,initComponent:function(){Ext.applyIf(this,{html:'<textarea style="width: 100%;border:none;">'+this.value+"</textarea>",lastPos:null,lastQuery:null,marked:[]}),this.callParent(arguments),this.on("afterrender",this.afterrender,this,{single:!0}),this.addEvents("cursorchange")},mode:"text/plain",showLineNumbers:!0,enableMatchBrackets:!0,enableElectricChars:!1,enableIndentWithTabs:!0,enableSmartIndent:!0,enableLineWrapping:!1,enableLineNumbers:!0,enableGutter:!1,enableFixedGutter:!1,firstLineNumber:1,readOnly:!1,pollInterval:100,indentUnit:4,tabSize:4,theme:"default",matchHighlight:"CodeMirror-matchhighlight",afterrender:function(){var a=this.getEl().down("textarea").dom;if(a){var b=this;this.codemirror=CodeMirror.fromTextArea(a,_.copyTo({matchBrackets:b.enableMatchBrackets,electricChars:b.enableElectricChars,indentUnit:b.indentUnit,smartIndent:b.enableSmartIndent,indentWithTabs:b.enableIndentWithTabs,pollInterval:b.pollInterval,lineNumbers:b.enableLineNumbers,lineWrapping:b.enableLineWrapping,firstLineNumber:b.firstLineNumber,tabSize:b.tabSize,gutter:b.enableGutter,fixedGutter:b.enableFixedGutter,theme:b.theme,onCursorActivity:Ext.bind(this.onCursorActivity,this),onBlur:Ext.bind(this.onBlur,this),onFocus:Ext.bind(this.onFocus,this)},this)),this.codemirror.setValue(this.value||""),b.matchHighlight&&(typeof b.matchHighlight!="string"&&(b.matchHighlight="CodeMirror-matchhighlight"),b.on("cursorchange",function(){b.codemirror.matchHighlight(b.matchHighlight)},null,{buffer:500}))}},onBlur:function(){this.fireEvent("blur",this,this.editor)},onFocus:function(){this.fireEvent("focus",this,this.editor)},onCursorActivity:function(){this.fireEvent("cursorchange",this,this.editor)},getValue:function(){return this.codemirror.getValue()},setValue:function(a){this.rendered?this.codemirror.setValue(a||""):this.value=a||""},getCursor:function(a){return this.codemirror.getCursor(a)},getSelectedRange:function(){return{from:this.getCursor(!0),to:this.getCursor(!1)}},autoFormatSelection:function(){var a=this.getSelectedRange();this.codemirror.autoFormatRange(a.from,a.to)},unmark:function(){for(var a=0;a<this.marked.length;++a)this.marked[a]();this.marked.length=0},search:function(a){var b=this.codemirror;this.unmark();if(!a)return;for(var c=b.getSearchCursor(a);c.findNext();)this.marked.push(b.markText(c.from(),c.to(),"searched"));this.lastQuery!=a&&(this.lastPos=null);var c=b.getSearchCursor(a,this.lastPos||b.getCursor());if(!c.findNext()){c=b.getSearchCursor(a);if(!c.findNext())return}b.setSelection(c.from(),c.to()),this.lastQuery=a,this.lastPos=c.to()},replace:function(a,b){var c=this.codemirror;this.unmark();if(!a)return;for(var d=c.getSearchCursor(a);d.findNext();)c.replaceRange(b,d.from(),d.to())}},function(){});
Ext.define("App.ui.nupack.DesignWindow",{extend:"Ext.window.Window",width:400,height:400,layout:"fit",title:"NUPACK Multiobjective Designer",plain:!0,bodyBorder:!1,border:!1,closeAction:"hide",minimize:function(){this.toggleCollapse()},minimizable:!0,maximizable:!0,initComponent:function(){Ext.apply(this,{layout:"border",items:[{xtype:"codemirror",mode:"nupack",title:"Design",fieldLabel:"Design",labelAlign:"top",region:"center"},{split:!0,region:"south",height:200,xtype:"form",frame:!0,defaults:{xtype:"textfield",anchor:"100%"},items:[{name:"design_job[nucleic_acid_type]",value:"DNA"},{name:"design_job[temperature]",xtype:"numberfield",value:20,fieldLabel:"Temperature (°C)"},{name:"design_job[number_of_trials]",xtype:"numberfield",fieldLabel:"Designs",value:1},{name:"design_job[rna_parameter_file]",xtype:"combobox",fieldLabel:"RNA Parameters:",value:"rna1995",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"Serra and Turner, 1995",value:"rna1995"},{view:"Mathews et al., 1999",value:"rna1999"}]}),queryMode:"local",displayField:"view",valueField:"value"},{name:"design_job[dna_parameter_file]",value:"dna1998",xtype:"hidden"},{name:"design_job[dangle_level]",xtype:"combobox",fieldLabel:"Dangles",value:1,store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"None",value:0},{view:"Some",value:1},{view:"All",value:2}]}),queryMode:"local",displayField:"view",valueField:"value"},{xtype:"fieldcontainer",fieldLabel:"Salts",defaultType:"numberfield",defaults:{flex:1,labelWidth:30},layout:"hbox",items:[{name:"design_job[na_salt]",fieldLabel:"Na<sup>+</sup>",value:1,margins:"0 5 0 0"},{fieldLabel:"Mg<sup>2+</sup>",name:"design_job[mg_salt]",value:0}]},{name:"design_job[dotplot_target]",xtype:"hidden",value:""},{name:"design_job[email_address]",fieldLabel:"Email"},{name:"commit",value:"Design",xtype:"hidden"},{name:"preview_token",value:"",xtype:"hidden"}]}],buttons:[{text:"Design",handler:this.doSubmit,scope:this}]}),this.callParent(arguments)},doSubmit:function(){var a=this.down("codemirror"),b=a.getValue(),c=this.down("form").getForm();c.doAction("standardsubmit",{target:"_blank",url:"http://www.nupack.org/design/new",method:"post",enctype:"multipart/form-data",params:{"design_job[target_structure]":b}})},updateDesign:function(a){var b=this.down("codemirror");b.setValue(a)}});
Ext.define("App.ui.nupack.PartitionWindow",{extend:"App.ui.sequence.AnalysisWindow",title:"NUPACK Partition Calculator",url:"http://www.nupack.org/partition/new",cite:"zadeh_etal_2011",iconCls:"nupack-icon",height:500,getForm:function(){return{items:[{fieldLabel:"Nucleic Acid",name:"partition_job[nucleic_acid_type]",value:"DNA"},{xtype:"fieldcontainer",fieldLabel:"Concentration",defaultType:"numberfield",defaults:{flex:1,labelWidth:30},layout:"hbox",items:[{name:"conc_value",value:.1,margins:"0 5 0 0"},{name:"conc_scale",value:"u",xtype:"combobox",value:"u",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"cM",value:"c"},{view:"mM",value:"m"},{view:"µM",value:"u"},{view:"nM",value:"n"},{view:"pM",value:"n"}]}),forceSelect:!0,queryMode:"local",displayField:"view",valueField:"value"}]},{name:"partition_job[temperature]",xtype:"numberfield",value:20,fieldLabel:"Temperature (°C)"},{name:"partition_job[max_complex_size]",xtype:"numberfield",value:1,fieldLabel:"Max Complex Size"},{name:"partition_job[rna_parameter_file]",xtype:"combobox",fieldLabel:"RNA Parameters",value:"rna1995",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"Serra and Turner, 1995",value:"rna1995"},{view:"Mathews et al., 1999",value:"rna1999"}]}),queryMode:"local",displayField:"view",valueField:"value"},{name:"partition_job[dna_parameter_file]",value:"dna1998",xtype:"hidden"},{name:"partition_job[dangle_level]",xtype:"combobox",fieldLabel:"Dangles",value:1,store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"None",value:0},{view:"Some",value:1},{view:"All",value:2}]}),queryMode:"local",displayField:"view",valueField:"value"},{xtype:"fieldcontainer",fieldLabel:"Salts",defaultType:"numberfield",defaults:{flex:1,labelWidth:30},layout:"hbox",items:[{name:"partition_job[na_salt]",fieldLabel:"Na<sup>+</sup> (M)",value:1,margins:"0 5 0 0"},{fieldLabel:"Mg<sup>2+</sup> (M)",name:"partition_job[mg_salt]",value:0}]},{name:"partition_job[dotplot_target]",xtype:"hidden",value:""},{name:"partition_job[email_address]",fieldLabel:"Email"},{name:"commit",value:"Analyze",xtype:"hidden"},{name:"preview_token",value:"",xtype:"hidden"}]}},getParams:function(a,b){a||(a=0),b||(b=null);var c=this.getStrands(),d={p:-12,n:-9,u:-6,m:-3,c:-2,d:-1},e=this.down("[name=conc_scale]").getValue(),f=this.down("[name=conc_value]").getValue(),g=_.compact(_.map(c,function(a,b){var c;return/^\s*([AaTtCcGgUu]+)\s*$/.test(a)?(a=a.trim(),{name:b,concentration:f,scale:d[e],contents:a}):(c=a.trim().match(/(\w+)?\s?(\[(\d+)([pnumd])M\])?\s?:?\s?([AaTtCcGgUu]+)/),c?{name:c[1]||"strand_"+b,concentration:c[3]||f,scale:c[4]?d[c[4]]:d[e],contents:c[5]}:null)}));return b==null?g=g.slice(a):g=g.slice(a,b),_.reduce(g,function(a,b,c){return a["partition_sequence["+c+"][name]"]=b.name,a["partition_sequence["+c+"][concentration]"]=b.concentration,a["partition_sequence["+c+"][scale]"]=b.scale,a["partition_sequence["+c+"][contents]"]=b.contents,a},{"partition_job[min_melt_temperature]":"","partition_job[is_melt]":0,"partition_job[melt_temperature_increment]":"","partition_job[max_melt_temperature]":"","partition_job[num_sequences]":g.length,"partition_job[pseudoknots]":0,"partition_job[predefined_complexes]":"","partition_job[filter_min_fraction_of_max]":"","partition_job[filter_max_number]":""})}});
Ext.define("App.ui.TipHelper",{init:function(a){a||(a=[]),this.tips||(this.tips=[]),_.each((this.query("*[tooltip]")||[]).concat(a),function(a){a.on("afterrender",this.buildTip,this)},this),this.on("destroy",this.destroyTips,this)},buildTip:function(a){var b=a.tooltip;if(!a.tooltip||a.tip||a.setTooltip)return;_.isString(b)&&(b={text:b}),b.text&&!b.html&&(b.html=b.text),b.target=a.getEl();var c=new Ext.ToolTip(b);this.tips||(this.tips=[]),this.tips.push(c),a.tip=c},destroyTips:function(){_.each(this.tips,function(a){a&&a.destroy&&a.destroy()})}});
Ext.define("App.usr.browser.Browser",{extend:"Ext.panel.Panel",title:"Browser",mixins:{app:"App.ui.Application"},constructor:function(){this.mixins.app.constructor.apply(this,arguments),this.callParent(arguments)},initComponent:function(){Ext.apply(this,{html:'<iframe src="'+this.url+'" style="width:100%;height:100%;border:none;"></iframe>'}),this.callParent(arguments)}});
Ext.define("App.ui.CompareMenu",{extend:"Ext.menu.Menu",invalidText:"Invalid Comparison",defaultText:"Edit distance: ",validateOnChange:!1,minWidth:300,resizeHandles:"s e se",initComponent:function(){Ext.apply(this,{resizable:{transparent:!0},items:[{text:"Compare:",canActivate:!1},{xtype:"textfield",ref:"field1",validate:Ext.bind(this.doValidate,this),scope:this,indent:!0,invalidText:this.invalidText,invalidCls:"x-form-invalid",validateOnChange:this.validateOnChange},{xtype:"textfield",ref:"field2",validate:Ext.bind(this.doValidate,this),scope:this,indent:!0,invalidText:this.invalidText,invalidCls:"x-form-invalid",validateOnChange:this.validateOnChange},"-",{text:this.defaultText,defaultText:this.defaultText,canActivate:!1,disabled:!0,ref:"output"}]}),this.callParent(arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this),this.field1.on("blur",this.onBlur,this),this.field2.on("blue",this.onBlur,this)},validate:function(){return!0},algorithm:function(){return 0},doValidate:function(){var a=this.field1.getValue();return v2=this.field2.getValue(),this.validate(a||"",v2||"")},onBlur:function(){this.validityChange(this.doValidate())},validityChange:function(a){this.output.setDisabled(!a),a?this.output.setText(this.output.defaultText+this.algorithm(this.field1.getValue(),this.field2.getValue())):this.output.setText("N/A")},populate:function(a,b){this.field1.suspendEvents(),this.field2.suspendEvents(),a&&this.field1.setValue(a),b&&this.field2.setValue(b),this.field1.resumeEvents(),this.field2.resumeEvents(),this.validityChange(this.doValidate())}});
Ext.define("App.usr.seq.Stats",{extend:"Ext.menu.Menu",minWidth:300,minHeight:400,initComponent:function(){this.store=new Ext.data.JsonStore({fields:[{name:"name",type:"string"},{name:"count",type:"int"},{name:"percent",type:"float"}],data:[]}),this.chartStore=new Ext.data.JsonStore({fields:[{name:"name",type:"string"},{name:"count",type:"int"},{name:"percent",type:"float"}],data:[]}),this.grid=new Ext.grid.Panel({store:this.store,columns:[{header:"Sequence",dataIndex:"name",flex:2,renderer:function(a){return a.toUpperCase()}},{header:"Count",dataIndex:"count",flex:1},{header:"Percent",dataIndex:"percent",flex:1,renderer:function(a){return a*100+"%"}}]}),this.chart=new Ext.chart.Chart({store:this.chartStore,shadow:!1,legend:!1,height:200,theme:"Base:gradients",series:[{type:"pie",field:"percent",showInLegend:!1,donut:!1,highlight:{segment:{margin:20}},label:{field:"name",display:"middle",contrast:!0,font:"14px helvetica",renderer:function(a){return a.toUpperCase()}}}],destroy:function(){this.surface||(this.surface={destroy:function(){}})}}),Ext.apply(this,{items:[this.chart,this.grid]}),this.callParent(arguments)},loadSequence:function(a){var b=DNA.sequenceStats(a);this.store.loadData(b.full),this.chartStore.loadData(b.abbr)}});
Ext.define("App.ui.FileUploader",{extend:"Ext.util.Observable",constructor:function(a){this.callParent(arguments),Ext.apply(this,a)},inheritableStatics:{handlers:{},handlerOrder:[],addHandler:function(a,b){Ext.isArray(a)?Ext.each(a,function(a){this.handlers[a]=b,this.handlerOrder.unshift(a)},this):(this.handlers[a]=b,this.handlerOrder.unshift(a))},hasHandler:function(a){return this.handlers[a]!=0},getHandler:function(a){return this.handlers[a]},eachHandler:function(a){Ext.each(this.handlerOrder,a)},getExtension:function(a){return a.split(".").pop()}},getConfig:function(){return{onComplete:Ext.bind(this.onComplete,this),onProgress:Ext.bind(this.onProgress,this),onCancel:Ext.bind(this.onCancel,this)}},onComplete:function(a,b,c){var d=c,e,f;c.success&&(f=c.readablePath,e=Ext.getClass(this).getExtension(f),Ext.getClass(this).hasHandler(e)&&Ext.getClass(this).getHandler(e).call(this,f))},onProgress:function(a,b,c,d){},onCancel:function(a,b){}},function(){});
Ext.define("App.ui.StatMenu",{extend:"Ext.menu.Menu",labelText:"Statistic: ",baseText:"Value: ",initComponent:function(){Ext.apply(this,{resizable:{transparent:!0},items:[{text:this.labelText,canActivate:!1},{xtype:"textfield",ref:"field",validate:Ext.bind(this.doValidate,this),scope:this,indent:!0,invalidText:this.invalidText,invalidCls:"x-form-invalid",validateOnChange:this.validateOnChange},"-",{text:this.baseText,defaultText:this.baseText,canActivate:!1,disabled:!0,ref:"output"}]}),this.callParent(arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this),this.field.on("blur",this.onBlur,this)},validate:function(){return!0},algorithm:function(){return 0},doValidate:function(){var a=this.field.getValue();return this.validate(a||"")},onBlur:function(){this.validityChange(this.doValidate())},validityChange:function(a){this.output.setDisabled(!a),a?this.output.setText(this.baseText+this.algorithm(this.field.getValue())):this.output.setText("N/A")},populate:function(a){this.field.suspendEvents(),a&&this.field.setValue(a),this.field.resumeEvents(),this.validityChange(this.doValidate())}});
Ext.define("App.ui.SaveButton",{extend:"Ext.button.Split",text:"Save",iconCls:"save",saveText:"Save",createText:"Create",forceDefaultExtension:!0,initComponent:function(){this.overwrite=Ext.create("Ext.menu.CheckItem",{text:"Overwrite exiting file",checked:!!this.app&&!!this.app.document,tooltip:{title:"Overwrite",text:"Check this to overwrite the selected file with the contents of this document. Uncheck to make a new document with the name you've entered above.",anchorToTarget:!0,anchor:"left"}}),this.saveMenu=Ext.create("App.ui.CreateMenu",{extraMenuItems:[this.overwrite],autoCreateMenu:!1,createText:this.createText,afterLeaveDelay:1e3,onCreateButton:Ext.bind(this.doSave,this)}),this.saveMenu.fileNameField.on("afterrender",this.afterrender,this),Ext.apply(this,{handler:this.click,scope:this,menu:this.saveMenu}),this.callParent(arguments),this.on("menushow",this.menushow,this),this.on("menuhide",this.menuhide,this),this.overwrite.on("checkchange",this.changeOverwrite,this),this.app&&(this.app.on("binddocument",this.updateOverwrite,this),this.app.on("unbinddocument",this.updateOverwrite,this))},doSave:function(a){var b;this.getDefaultExtension()&&this.forceDefaultExtension&&App.Path.extname(a)!=this.getDefaultExtension()&&(a=App.Path.addExt(a,this.getDefaultExtension())),this.overwrite.checked?b=App.ui.filesTree.getSelectionModel().getLastSelected():b=App.ui.filesTree.newFileUnderSelection(a),this.app.bindDocument(b),this.app.saveFile()},getDefaultExtension:function(){return this.defaultExtension?this.defaultExtension:""},selectionChange:function(a,b){b=a.getLastSelected(),b&&(b.isLeaf()?(this.saveMenu.fileNameField.setValue(b.get("text")),this.overwrite.setChecked(!0)):this.saveMenu.fileNameField.setValue(""),this.overwrite.setDisabled(!b.isLeaf()))},updateOverwrite:function(){this.app&&this.app.document?this.overwrite.setChecked(!0):this.overwrite.setChecked(!1)},changeOverwrite:function(a,b){this.saveMenu.fileNameField.setDisabled(b),this.saveMenu.createButton.setText(b?this.saveText:this.createText)},afterrender:function(){this.tip=Ext.create("Ext.tip.ToolTip",{target:this.saveMenu.fileNameField.getEl(),autoHide:!0,anchorToTarget:!0,anchor:"left",title:"Save file",html:"Select a folder in the <b>Files</b> pane to the left, then enter a file name here."})},menushow:function(){this.changeOverwrite(this.overwrite,this.overwrite.checked),App.ui.filesTree.getSelectionModel().on("selectionchange",this.selectionChange,this),this.app&&this.app.document&&(this.saveMenu.fileNameField.setValue(this.app.document.get("text")),App.ui.filesTree.getSelectionModel().select(this.app.document))},menuhide:function(){App.ui.filesTree.getSelectionModel().un("selectionchange",this.selectionChange,this)},click:function(){this.app&&(this.app.document?this.app.saveFile():this.showMenu())}});
Ext.define("App.ui.D3Panel",{alias:"widget.d3panel",extend:"Ext.panel.Panel",pan:!0,zoom:1,bpadding:20,visPadding:10,autoRender:!1,autoSize:!0,initComponent:function(){this.callParent(arguments),this.autoRender&&this.on("afterrender",this.afterrender,this,{single:!0})},afterrender:function(){this.built||(this.buildVis(),this.collapsed||this.renderVis(),this.on("collapse",this.hideVis,this),this.on("expand",this.resizeVis,this),this.on("resize",this.resizeVis,this),this.built=!0)},getBodyWidth:function(){return this.body.getWidth()},getBodyHeight:function(){return this.body.getHeight()},resizeVis:function(a,b,c){this.autoSize&&this.doAutoSize(),this.updateVis()},doAutoSize:function(){this.vis!=this.svg&&this.vis.attr("width",this.getBodyWidth()-this.visPadding).attr("height",this.getBodyHeight()-this.visPadding).style("top",this.visPadding/2).style("left",this.visPadding/2),this.svg.attr("width",this.getBodyWidth()-this.visPadding).attr("height",this.getBodyHeight()-this.visPadding).style("top",this.visPadding/2).style("left",this.visPadding/2),this.rect&&this.rect.attr("width",this.getBodyWidth()-this.visPadding).attr("height",this.getBodyHeight()-this.visPadding)},renderVis:function(){!this.vis},updateVis:function(){},hideVis:function(){this.vis&&this.vis.render()},buildVis:function(){return this.getCanvas()},getCanvas:function(){if(!this.vis){this.vis=this.svg=d3.select(this.body.dom).append("svg").style("position","absolute").attr("pointer-events","all"),this.autoSize&&this.doAutoSize();if(this.pan||this.zoom){var a=this;function b(){a.redraw(d3.event.translate,d3.event.scale)}this.vis=this.vis.append("svg:g").call(d3.behavior.zoom().on("zoom",b)).append("svg:g"),this.rect=this.vis.append("svg:rect").attr("width",this.getWidth()).attr("height",this.getHeight()).attr("fill","white")}}return this.vis},getCanvasMarkup:function(){var a=this.body.getHTML();return a.replace(/<div\s+id="[\w-]+"\s+class="x-clear"\s+role="presentation"><\/div>/g,"")},redraw:function(a,b){this.vis.attr("transform","translate("+a+")"+" scale("+b+")")}});
jQuery.event.props.push("dataTransfer"),Ext.define("App.ui.DragDropManager",{extend:"Ext.util.Observable",allowExtDD:!1,constructor:function(a){this.callParent(arguments),Ext.apply(this,a)},inheritableStatics:{handlers:{},handlerOrder:[],addHandler:function(a,b){Ext.isArray(a)?Ext.each(a,function(a){this.handlers[a]=b,this.handlerOrder.unshift(a)},this):(this.handlers[a]=b,this.handlerOrder.unshift(a))},hasHandler:function(a){return this.handlers[a]!=0},getHandler:function(a){return this.handlers[a]},eachHandler:function(a){Ext.each(this.handlerOrder,function(b){a(b,this.getHandler(b))},this)}},getEl:function(){return this.element},render:function(){var a=$(this.getEl().dom);a.bind("drop",Ext.bind(this.onDrop,this)),a.bind("dragenter",this.onDragEnter,this),a.bind("dragover",this.onDragOver,this),this.allowExtDD&&(this.dropZone=new Ext.dd.DropTarget(this.workspace.getEl(),{notifyDrop:Ext.bind(this.notifyDrop,this)}))},notifyDrop:function(a,b,c){if(c.mimeType&&Ext.getClass(this).hasHandler(c.mimeType)){var d=Ext.getClass(this).getHandler(c.mimeType);return d.call(this,c,b),!0}return!1},onDrop:function(a){var b=this;a.dataTransfer.files&&this.fileHandler&&this.fileHandler(a.dataTransfer.files,a),Ext.getClass(this).eachHandler(function(c,d){if(a.dataTransfer.types.indexOf(c)!=-1)return d.call(b,a.dataTransfer.getData(c),a),!1}),a.preventDefault()},onDragEnter:function(a){a.preventDefault()},onDragOver:function(a){a.preventDefault()},destroy:function(){this.workspace.getEl().un("drop",this.onDrop,this)},getAdjustedXYcoords:function(){return Workspace.tools.BaseTool.prototype.getAdjustedXYcoords.apply(this,arguments)},getAdjustedXY:function(){return Workspace.tools.BaseTool.prototype.getAdjustedXY.apply(this,arguments)},onFileComplete:function(a,b,c){this.fileUploaders[a]&&(this.fileUploaders[a].onComplete(a,b,c),delete this.fileUploaders[a])},onFileProgress:function(a,b,c,d){this.fileUploaders[a]&&this.fileUploaders[a].onProgress(a,b,c,d)},onFileCancel:function(a,b){this.fileUploaders[a]&&(this.fileUploaders[a].onCancel(a,b),delete this.fileUploaders[a])},getUploadHandler:function(){return this.uploadHandler||(this.uploadHandler=new qq.UploadHandlerXhr({action:this.getUploadUrl(),onComplete:Ext.bind(this.onFileComplete,this),onCancel:Ext.bind(this.onFileCancel,this),onProgress:Ext.bind(this.onFileProgress,this)}),this.fileUploaders={}),this.uploadHandler},fileHandler:function(a,b){},getUploadUrl:function(){return App.getEndpoint("upload")}},function(){});
Ext.define("App.ui.StrandPreviewViewMenu",{extend:"Ext.button.Button",text:"View",iconCls:"view",complexViewMode:"segment",segmentIconCls:"domain",domainIconCls:"domain-caps",sequenceIconCls:"sequence",initComponent:function(){Ext.apply(this,{menu:[{text:"Segments",checked:!0,iconCls:this.segmentIconCls,name:"coloringSegments",group:"coloring",xtype:"menucheckitem",handler:function(){this.setComplexViewMode("segment")},scope:this},{text:"Domains",checked:!1,iconCls:this.domainIconCls,name:"coloringDomains",group:"coloring",xtype:"menucheckitem",handler:function(){this.setComplexViewMode("domain")},scope:this},{text:"Base identity",checked:!0,iconCls:this.sequenceIconCls,name:"coloringSequences",group:"coloring",xtype:"menucheckitem",handler:function(){this.setComplexViewMode("identity")},scope:this},"-",{text:"Show bubbles",checked:!0,name:"showBubbles",xtype:"menucheckitem",handler:function(a){this.setComplexViewBubbles(a.checked)},scope:this},{text:"Show base labels",checked:!0,name:"showBases",xtype:"menucheckitem",handler:function(a){this.setComplexViewShow("bases",a.checked)},scope:this},{text:"Show base numbering",checked:!0,name:"showBaseNumbers",xtype:"menucheckitem",handler:function(a){this.setComplexViewShow("indexes",a.checked)},scope:this},{text:"Show segment labels",checked:!0,name:"showSegments",xtype:"menucheckitem",handler:function(a){this.setComplexViewShow("segments",a.checked)},scope:this}]}),this.callParent(arguments),this.setIconCls(this.segmentIconCls),this.showBubbles=this.menu.down("[name=showBubbles]"),this.showBases=this.menu.down("[name=showBases]"),this.coloringSegments=this.menu.down("[name=coloringSegments]"),this.coloringSequences=this.menu.down("[name=coloringSequences]"),this.coloringDomains=this.menu.down("[name=coloringDomains]")},getComplexViewMode:function(){return this.complexViewMode},setComplexViewMode:function(a){this.complexViewMode=a;var b;switch(a){case"segment":this.setIconCls(this.segmentIconCls),this.showBubbles.checked?b={nodeStrokeMode:"segment",nodeFillMode:"segment",lineStrokeMode:"default",textFillMode:"default"}:this.showBases.checked?b={textFillMode:"segment"}:b={lineStrokeMode:"segment"};break;case"domain":this.setIconCls(this.domainIconCls),this.showBubbles.checked?b={lineStrokeMode:"",nodeFillMode:"domain",nodeStrokeMode:"domain",textFillMode:"default"}:this.showBases.checked?b={textFillMode:"domain"}:b={lineStrokeMode:"domain"};break;case"identity":this.setIconCls(this.sequenceIconCls),this.showBubbles.checked?b={lineStrokeMode:"default",nodeStrokeMode:"identity",nodeFillMode:"identity",textFillMode:"default"}:this.showBases.checked?b={textFillMode:"identity"}:b={lineStrokeMode:"identity"}}this.updateView(b)},changeBaseColor:function(a){this.updateView({baseColor:a})},updateView:function(a){Ext.apply(this.view,a),this.view.updateChartProperties()},setComplexViewBubbles:function(a){this.setComplexViewShow("bubbles",a)},setComplexViewShow:function(a,b){switch(a){case"bubbles":this.view.showBubbles=b;break;case"bases":this.view.showBases=b;break;case"indexes":this.view.showIndexes=b;break;case"segments":this.view.showSegments=b}this.setComplexViewMode(this.complexViewMode)}});
Ext.define("App.ui.mfold.QuikFoldWindow",{extend:"App.ui.sequence.AnalysisWindow",title:"QuikFold Secondary Structure Calculator",url:"http://mfold.rna.albany.edu/cgi-bin/DINAMelt/quikfold.cgi",cite:"markham_zuker_2005",iconCls:"mfold",getForm:function(){return{items:[{fieldLabel:"Name",name:"name"},{name:"temp",xtype:"numberfield",value:20,fieldLabel:"Temperature (°C)"},{name:"NA",xtype:"combobox",fieldLabel:"Nucleic Acid",value:"DNA",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"DNA",value:"DNA"},{view:"RNA (2.3)",value:"RNA"},{view:"RNA (3.0)",value:"RNA3"}]}),queryMode:"local",displayField:"view",valueField:"value"},{name:"type",fieldLabel:"Sequence Type",xtype:"combobox",value:"linear",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"Linear",value:"linear"},{view:"Circular",value:"circular"}]}),queryMode:"local",displayField:"view",valueField:"value"},{xtype:"fieldcontainer",fieldLabel:"Salts",defaultType:"numberfield",defaults:{flex:1,labelWidth:30},layout:"hbox",items:[{name:"Sodium",fieldLabel:"Na<sup>+</sup>",value:1,margins:"0 5 0 0"},{fieldLabel:"Mg<sup>2+</sup>",name:"Magnesium",value:0},{labelWidth:0,name:"saltunit",xtype:"combobox",value:"mM",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"M",value:"M"},{view:"mM",value:"mM"}]}),queryMode:"local",displayField:"view",valueField:"value"}]},{name:"polymer",fieldLabel:"Polymer Mode",xtype:"checkbox",value:!1},{name:"p",fieldLabel:"% Suboptimal",value:5},{name:"w",fieldLabel:"Window Size",value:"default"},{name:"max",fieldLabel:"Foldings",xtype:"numberfield",value:50},{name:"maxbp",fieldLabel:"Max distance between paired bases"}]}},getParams:function(){return{seq:this.getValue()}},updateStrands:function(a){var b=this.down("codemirror");b.setValue(a)}});
Ext.define("App.ui.vienna.RNAfoldWindow",{extend:"App.ui.sequence.AnalysisWindow",title:"RNAfold Secondary Structure Calculator",url:"http://rna.tbi.univie.ac.at/cgi-bin/RNAfold.cgi",cite:"gruber_etal_2008",iconCls:"tbi",height:480,getForm:function(){return{height:300,items:[{name:"p",xtype:"combobox",fieldLabel:"Compute",value:"p",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"Partition function + MFE Structure",value:"p"},{view:"MFE Structure only",value:"mfe"}]}),queryMode:"local",displayField:"view",valueField:"value"},{name:"Temp",xtype:"numberfield",value:20,fieldLabel:"Temperature (°C)"},{name:"param",xtype:"combobox",fieldLabel:"Parameter Set",value:"dna",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"DNA (Matthews 2004)",value:"dna"},{view:"RNA (Turner 2004)",value:"rna2004"},{view:"RNA (Turner 1999)",value:"rna1999"},{view:"RNA (Andronescu 2007)",value:"andronescu"}]}),queryMode:"local",displayField:"view",valueField:"value"},{name:"dangles",xtype:"combobox",fieldLabel:"Dangle treatment",value:"d2",store:Ext.create("Ext.data.Store",{fields:["view","value"],data:[{view:"no dangling end energies",value:"d0"},{view:"unpaired bases can participate in at most one dangling end (MFE folding only)",value:"d1"},{view:"dangling energies on both sides of a helix in any case",value:"d2"},{view:"allow coaxial stacking of adjacent helices in multi-loops (MFE folding only)",value:"d3"}]}),queryMode:"local",displayField:"view",valueField:"value"},{name:"circ",boxLabel:"Sequence Type",xtype:"checkbox",value:!1},{name:"nocloseGU",boxLabel:"No GU pairs at the end of helices",xtype:"checkbox",checked:!1},{name:"noLP",boxLabel:"Avoid isolated base pairs",xtype:"checkbox",checked:!1},{name:"SVG",boxLabel:"SVG output",xtype:"checkbox",checked:!0},{name:"mountain",boxLabel:"Mountain Plot",xtype:"checkbox",checked:!0},{name:"reliability",boxLabel:"Confidence Indicators",xtype:"checkbox",checked:!0}]}},getParams:function(){return{SCREEN:this.getValue(),PAGE:2,proceed:"proceed"}}});
Ext.define("App.ui.NupackMenu",{requires:["App.ui.nupack.DesignWindow","App.ui.nupack.PartitionWindow"],extend:"Ext.menu.Menu",initComponent:function(){Ext.apply(this,{items:[{text:"Analyze...",handler:this.openPartitionWindow,iconCls:"nupack-icon"},{text:"Design...",handler:this.openDesignWindow,scope:this,iconCls:"nupack-icon"},{text:"Utilities",handler:App.ui.Launcher.makeLauncher("nupack/utilities"),iconCls:"nupack-icon"}]}),this.callParent(arguments)},openDesignWindow:function(){this.designWindow||(this.designWindow=Ext.create("App.ui.nupack.DesignWindow")),this.designWindow.show(),this.fireEvent("designwindow",this,this.designWindow)},openPartitionWindow:function(){this.partitionWindow||(this.partitionWindow=Ext.create("App.ui.nupack.PartitionWindow")),this.partitionWindow.show(),this.fireEvent("partitionwindow",this,this.partitionWindow)}});
Ext.define("App.ui.Help",{extend:"App.usr.browser.Browser",title:"Help",iconCls:"help",trigger:"index",constructor:function(a){this.url=App.path.join(["help",a.triggers[0]||"index"]),this.callParent(arguments)},statics:{getLink:function(a){return"javascript:App.ui.Launcher.launch('help:"+a+"');"}}}),Ext.define("App.ui.HelpButton",{extend:"Ext.button.Button",iconCls:"help",text:"Help",xtype:"helpbutton",initComponent:function(){Ext.apply(this,{handler:App.ui.Launcher.makeLauncher("help:"+this.topic)}),this.callParent(arguments)}});
Ext.define("App.ui.console.ScriptsPanel",{extend:"Ext.panel.Panel",requires:["App.ui.CodeMirror"],id:"x-debug-scripts",region:"east",minWidth:200,split:!0,width:350,border:!1,layout:"fit",bodyBorder:!1,padding:"0 0 5 0",cls:"noborder-top",initComponent:function(){this.scriptField=Ext.create("App.ui.CodeMirror",{style:"border-width:0;",mode:"javascript",tbar:!1,onKeyEvent:Ext.bind(function(a,b){if(b.keyCode==13&&b.shiftKey&&b.type=="keydown")return b.stop(),this.evalScript(),!1},this)}),this.trapBox=Ext.create("Ext.form.Checkbox",{id:"console-trap",boxLabel:"Trap Errors",checked:!0}),this.toolbar=Ext.create("Ext.Toolbar",{dock:"top",items:[{text:"Run",iconCls:"run",scope:this,handler:this.evalScript},{text:"Clear",iconCls:"cross",scope:this,handler:this.clear},"->",this.trapBox," "," "]}),this.items=[this.scriptField],this.dockedItems=[this.toolbar],this.callParent(arguments)},evalScript:function(){var a=this.scriptField.getValue();this.executeInContext(a,App.ui.active(),this.trapBox.getValue())},executeInContext:function(a,b,c,d){var e=[],f=[];if(c)try{_.each(d,function(a,b){e.push(b),f.push(a)});var g=Function.apply(window,e.concat([a]));g=g.apply(b,f),App.dump(g===undefined?"(no return)":g)}catch(h){App.log(h.message||h.descript,{iconCls:"error"})}else{_.each(d,function(a,b){e.push(b),f.push(a)});var g=Function.apply(window,e.concat([a]));g=g.apply(b,f),App.dump(g===undefined?"(no return)":g)}},clear:function(){this.scriptField.setValue(""),this.scriptField.focus()}});
Ext.define("App.ui.files.FileUploader",{statics:{buildStandardHandlers:function(){var a=["jpg","png","gif","txt","pdf","svg","txt","seq","nupack","nodal","workspace","html","js","xml"];a=_.uniq(a.concat(_.keys(App.triggers))),App.ui.files.FileUploader.addHandler(a,function(a){App.ui.filesTree.refreshDocument(this.record),this.filesTree.loaders--,this.filesTree.setLoading(this.filesTree.loaders>0),Ext.msg("File","{0} uploaded successfully.",a)})}},extend:"App.ui.FileUploader"},function(){App.ui.files.FileUploader.addHandler(["exe","sh","run",""],function(a){Ext.MsgBox.alert("Not Permitted","Uploading this type of file is not allowed for security reasons.")}),App.on("load",App.ui.files.FileUploader.buildStandardHandlers)});
function StrandPreview(){function G(a){return _.range(a[0],a[1]+1)}function H(a){return _.isString(a)?DNA.generateAdjacency(a,["A"],!0,{persistenceLength:!1}):a.strands&&a.structure&&a.sequences?DNA.generateAdjacency3(a.structure,a.strands,{sequences:a.sequences,persistenceLength:!1}):a.dotParen&&a.strands&&a.sequences&&!a.structure?DNA.generateAdjacency4(a.dotParen,a.strands,{extraData:a.extraData||null,sequences:a.sequences,persistenceLength:!1}):a.strands&&a.dotParen&&!a.sequences?DNA.generateAdjacency4(a.dotParen,a.strands,{extraData:a.extraData||null,persistenceLength:!1}):DNA.generateAdjacency2(a,{linkStrands:!0,persistenceLength:!1})}function I(a,b,c){var d=DNA.layoutStructure(a,{loopMode:A,arrangeLayout:!1}),e,f;return d.length==0?{pairs:[],zoom:1,translate:[0,0]}:(e=DNA.arrangeLayout(d,{center:!0,offsets:[b*.05,c*.05],loopMode:A}),f=DNA.getScale(e.bounds,[b*.8,c*.8],!0),{pairs:e.pairs,zoom:f[0]*.9,translate:DNA.getOffset(e.bounds,[b*.8,c*.8],f[0]*.9)})}function J(){f=a/20,g=f,h=1.5*g}function K(d){function A(a){return d.each(a),e}function B(a){for(var b=0;b<a.length;b++)for(var c=0;c<d.length;c++)d[c]==a[b]&&(d[c]=a[b],a[b]=null);for(var b=0;b<a.length;b++)a[b]!=null&&d.push(a[b])}function C(a){a.style("fill",function(a){switch(k){case"identity":return F(a.base);case"segment":return D(a.segment_identity);case"domain":return App.dynamic.Compiler.domainColors[a.domain_role]||null;case"strand":return E(a.strand)}}).style("stroke",function(a){switch(l){case"identity":return d3.rgb(F(a.base)).darker().toString();case"segment":return d3.rgb(D(a.segment_identity)).darker().toString();case"domain":return App.dynamic.Compiler.domainColors[a.domain_role]?d3.rgb(App.dynamic.Compiler.domainColors[a.domain_role]).darker().toString():null;case"strand":return d3.rgb(E(a.strand)).darker().toString()}})}function G(a){a.style("font-size",u+"em").attr("text-anchor","middle").attr("dx",function(a){return Math.cos(a.theta)+"em"}).attr("dy",function(a){return Math.sin(a.theta)+.35+"em"}).text(function(a,b){return b%10==0?b:""})}function J(a){a.style("font-size",t+"em").attr("text-anchor","middle").attr("dy",".35em").text(function(a){return a.base||"N"}).style("fill",function(a){switch(n){case"identity":return F(a.base);case"segment":return D(a.segment_identity);case"domain":return App.dynamic.Compiler.domainColors[a.domain_role]||null;case"strand":return E(a.strand);default:return"#fff"}})}function K(a){a.attr("text-anchor","middle").text(function(a,b){return a.segment_index==0?a.segment:""}).attr("fill",function(a){return D(a.segment_identity)})}function L(){A(function(a){var b=d3.select(this),c=b.selectAll("g.node");o&&C(c.select("circle")),q&&G(c.select("text.node_index")),p&&J(c.select("text.node_base")),r&&K(c.select("text.node_segment"))})}function M(){return A(function(a){d3.select(this).selectAll("g.node").classed("node-faded",!0)})}function N(){return A(function(a){d3.select(this).selectAll("g.node").classed("node-faded",!1)})}function O(a,b){return b||(b="node-highlight"),a?A(function(c){d3.select(this).selectAll("g.node").classed(b,function(b){if(!a)return!0;var c=!0;for(var d in a)c=c&&b[d]==a[d];return c})}):A(function(a){d3.select(this).selectAll("g.node").classed(b,!0)})}function P(a,b){return b||(b="node-highlight"),a?A(function(c){d3.select(this).selectAll("g.node").classed(b,function(b){var c=!0;for(var d in a)c=c&&b[d]==a[d];return!c})}):A(function(a){d3.select(this).selectAll("g.node").classed(b,!1)})}function Q(){A(function(a){a.force.resume()})}function R(){A(function(a){a.force.stop()})}d.each(function(d){function ab(){return d3.event.sourceEvent.stopPropagation(),eb(d3.event.scale,d3.event.translate)}function eb(a,b){Q.attr("transform","translate("+b+")"+" scale("+a+")"),p&&t*a<w&&!bb?(Q.selectAll("text.node_base").style("display","none"),bb=!0):p&&t*a>=w&&bb&&(Q.selectAll("text.node_base").style("display",""),bb=!1),q&&u*a<w&&!cb?(Q.selectAll("text.node_index").style("display","none"),cb=!0):q&&u*a<w&&cb&&(Q.selectAll("text.node_index").style("display",""),cb=!1);if(r&&v&&!db){var c=Q.selectAll("text.node_segment");c.style("font-size",1/a*s+"em").attr("dx",function(b){if(b.segment_length){var c=Math.atan2(x,b.segment_length*j/2),d=Math.sqrt(Math.pow(x,2),Math.pow(b.segment_length*j/2,2));return Math.cos(b.theta+Math.PI/2-c)*d*a*2+"em"}return Math.cos(b.theta+Math.PI/4)*2.5*a*2+"em"}).attr("dy",function(b){if(b.segment_length){var c=Math.atan2(x,b.segment_length*j/2),d=Math.sqrt(Math.pow(x,2),Math.pow(b.segment_length*j/2,2));return Math.sin(b.theta+Math.PI/2-c)*d*a*2+.35+"em"}return Math.sin(b.theta+Math.PI/4)*2.5*a*2+.35+"em"})}else r&&s*a<w&&!db?(Q.selectAll("text.node_base").style("display","none"),db=!0):r&&s*a>=w&&db&&(Q.selectAll("text.node_base").style("display",""),db=!1)}function fb(){function a(){U.attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}),T.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),$&&$.attr("transform",function(a){return"translate("+a.x+","+a.y+") rotate("+a.theta*180/Math.PI+")"})}function b(){Q.style("opacity",1e-6).transition().duration(c).style("opacity",1)}d.force=R,R.start(),a(),R.stop(),b()}var e,k=d;_.isString(d)?e=DNA.parseDotParen(k):(k.strands&&(k.strands=DNA.expandStrands(k.strands)),k.dotParen?e=DNA.parseDotParen(k.dotParen):k.strands&&k.sequences&&(k.dotParen=DNA.expandStructure(k.structure,k.strands,k.sequences,!0),e=DNA.parseDotParen(k.dotParen)));var l,n,A,B;n=H(k),l=I(e,a,b),A=_.map(n.nodes,function(a,b){return a.x=l.pairs[b][0],a.y=l.pairs[b][1],a.theta=l.pairs[b][2],a}),B=n.links;var L=A.length-1,M=A[L-1];if(M)var N=M.theta+Math.PI/2,O={x:M.x+Math.cos(N)*y,y:M.y+Math.sin(N)*y,theta:N},P={source:L,target:L+1,type:"tail"};var Q=d3.select(this).attr("pointer-events","all").append("g").call(d3.behavior.zoom().on("zoom",ab).scale(l.zoom).translate(l.translate)).append("g");Q.attr("transform","translate("+l.translate+")"+" scale("+l.zoom+")");var R=d3.layout.force().size([a,b]).charge(-45).linkDistance(function(a,b){if(a.type=="persistence")return i*1.2*f;if(a.type=="wc")return h;if(a.type=="strand")return g}).linkStrength(function(a,b){if(a.type=="persistence")return 1/i;if(a.type=="wc")return 1;if(a.type=="strand")return.7}).gravity(.005),S=A;O&&(S=_.clone(A),S.push(O),B.push(P)),R.nodes(S).links(B),Q.append("rect").classed("strand-preview-drag",!0).attr("width",a/l.zoom).attr("height",b/l.zoom);var T,U;U=Q.selectAll("line.link").data(B),U.exit().remove();var V=U=U.enter().append("line").attr("class",function(a){var b=["link","link-"+a.type];return b.push("source-"+a.source.name),b.push("target-"+a.target.name),b.join(" ")}).style("stroke",function(a){if(a.type=="strand")switch(m){case"identity":return F(a.base);case"segment":return D(a.segment_identity);case"domain":return App.dynamic.Compiler.domainColors[a.domain_role]||null;case"strand":return E(a.strand);default:return""}return""});T=Q.selectAll("g.node").data(A),T.exit().remove(),T=T.enter().append("g").attr("class",function(a){var b=["node"];return a.immutable&&b.push("immutable"),a.prevented&&b.push("prevented"),a.changed&&b.push("changed"),b.join(" ")}).call(R.drag);if(o){var W=T.append("circle").attr("r",.5*j+"em");C(W)}if(q){var X=T.append("text").attr("class","node_index");G(X)}if(p){var Y=T.append("text").attr("class","node_base");J(Y)}if(r){var Z=T.append("text").attr("class","node_segment");K(Z)}if(O){var $=Q.selectAll("path.tail").data([O]).enter().append("path").attr("class","tail");$.attr("d",Ext.String.format("M-{0},-{0} L0,0 L-{0},{0}",z))}eb(l.zoom,l.translate);var bb=!1,cb=!1,db=!1;fb()});var e={highlight:O,unhighlight:P,fade:M,unfade:N,redrawNodes:L,each:A,expandSelection:B,start:Q,stop:R};return e}var a=400,b=400,c=100,d=1e3,e=2,f,g,h,i=!1,j=1,k="segment",l="segment",m="default",n="default",o=!0,p=!0,q=!0,r=!0,s=1,t=j*.8,u=j*.8,v=!0,w=.25,x=2,y=60,z=20,A="circular",B="#aaa",C={wc:"#ccc",strand:B,persistence:"",undesired:"#a00"},D=d3.scale.category20(),E=d3.scale.category20(),F=d3.scale.ordinal().domain(["A","T","C","G","N"]).range(["blue","red","green","black","orange"]);return K.width=function(b){return arguments.length?(a=b,J(),K):a},K.height=function(a){return arguments.length?(b=a,J(),K):b},K.nodeStrokeMode=function(a){return arguments.length?(l=a,K):l},K.nodeFillMode=function(a){return arguments.length?(k=a,K):k},K.lineStrokeMode=function(a){return arguments.length?(m=a,K):m},K.textFillMode=function(a){return arguments.length?(n=a,K):n},K.showBubbles=function(a){return arguments.length?(o=a,K):o},K.showBases=function(a){return arguments.length?(p=a,K):p},K.showIndexes=function(a){return arguments.length?(q=a,K):q},K.showSegments=function(a){return arguments.length?(r=a,K):r},K.loopMode=function(a){return arguments.length?(A=a,K):A},K.segmentColors=function(a){return arguments.length?(D=a,K):D},K.strandColors=function(a){return arguments.length?(E=a,K):E},J(),K}Ext.define("App.ui.StrandPreview",{extend:"App.ui.D3Panel",alias:"widget.strandpreview",requires:["App.ui.StrandPreviewViewMenu"],autoRender:!0,data:"",fade_in_duration:1e3,bodyStyle:"background-color: white",persistenceLength:1,adjacencyMode:2,nodeFillMode:"segment",nodeStrokeMode:"segment",lineStrokeMode:"default",textFillMode:"default",showBubbles:!0,loopMode:"linear",showBases:!0,showIndexes:!0,showSegments:!0,segmentColors:null,strandColors:null,showToolbar:!0,createTip:!1,tipDelegate:"circle",setValue:function(a,b,c){a&&a.structure&&a.strands?(this.data=a,this.strands=a.strands,this.structure=a.structure,a.strands&&(this.strands=a.strands)):arguments.length==1?this.data=a:(this.data=a,this.data&&(b&&(this.data.strands=b),c&&(this.data.sequences=c)),this.structure=a,this.strands=b,this.sequences=c),this.buildVis()},buildVis:function(){var a=this.getCanvas();a.selectAll("g").remove(),this.chart=StrandPreview(a).width(this.getWidth()).height(this.getHeight()).showBubbles(this.showBubbles).showBases(this.showBases).showIndexes(this.showIndexes).showSegments(this.showSegments).loopMode(this.loopMode).nodeStrokeMode(this.nodeStrokeMode).nodeFillMode(this.nodeFillMode).lineStrokeMode(this.lineStrokeMode).textFillMode(this.textFillMode),!this.segmentColors||this.chart.segmentColors(this.segmentColors),!this.strandColors||this.chart.strandColors(this.strandColors),this.preview=this.chart(a.data([this.data]))},updateChartProperties:function(){this.buildVis()},highlight:function(a){this.preview.highlight(a)},unhighlight:function(a){this.preview.unhighlight(a)},initComponent:function(){this.showToolbar&&(this.bbar=[{iconCls:"dot-paren-icon",handler:this.toDotParen,scope:this,tooltip:"Show structure in dot-parenthesis notation"},{iconCls:"du-plus-icon",handler:this.toDUPlus,scope:this,tooltip:"Show structure in DU-plus (Zadeh) notation"},{iconCls:"svg",handler:this.toSVG,scope:this,tooltip:"Show SVG code for structure"},"->",Ext.create("App.ui.StrandPreviewViewMenu",{view:this})]),this.callParent(arguments),this.on("afterrender",function(){this.createTip&&(this.tip=Ext.create("Ext.tip.ToolTip",{target:this.getEl(),delegate:this.tipDelegate,trackMouse:!0,showDelay:!1,renderTo:Ext.getBody(),listeners:{beforeshow:{fn:this.updateTipBody,scope:this}}}),this.sequenceRenderer=CodeMirror.modeRenderer("sequence"))},this)},updateTipBody:function(a){var b=Ext.get(a.triggerElement).up("g");if(b){b=d3.select(b.dom);var c=b.datum();a.update(this.getTipBody(c))}},getTipBody:function(a){var b="<b>"+this.sequenceRenderer(a.base)+"</b> | <b>"+a.strand+"</b> / <b>"+a.segment+"</b> / "+a.segment_index+"<br />";return a.immutable&&(b+="<b>Immutable</b><br />"),a.prevented&&(b+="<b>Prevented</b> ("+this.sequenceRenderer(a.prevented)+")<br />"),a.changed&&(b+="<b>Changed</b> ("+a.changed.reason+")"),b},toggleForce:function(){this.forceEnabled?(this.forceEnabled=!1,this.preview.stop()):(this.forceEnabled=!0,this.preview.start())},showWindow:function(a,b,c){this.textWindow||(this.textWindowBox=Ext.create("App.ui.CodeMirror",{}),this.textWindow=Ext.create("Ext.window.Window",{layout:"fit",items:[this.textWindowBox],title:a,closeAction:"hide",width:300,height:200,bodyBorder:!1,border:!1,plain:!0,headerPosition:"left"})),this.textWindow.show(),c&&this.textWindow.alignTo(c),this.textWindow.setTitle(a),this.textWindowBox.setValue(b)},getStructure:function(){return _.isString(this.data)?this.data:this.data.dotParen||this.data.structure||null},toDotParen:function(a){var b=this.getStructure();this.showWindow("Dot-Parentheses",b,a)},toDUPlus:function(a){var b=DNA.dotParenToDU(this.getStructure());this.showWindow("DU+",b,a)},toSVG:function(a){this.svgStyles?this.doDisplaySVGWindow():Ext.Ajax.request({url:"styles/strand-preview.css",success:function(a){this.svgStyles=a.responseText,this.doDisplaySVGWindow()},scope:this})},doDisplaySVGWindow:function(){var a='<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+this.getCanvasMarkup();a=a.replace(/<svg(\b[^>]*)>/g,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" $1><style type="text/css"><![CDATA['+this.svgStyles+"]]></style>"),this.svgWindow=Ext.create("App.ui.StrandPreviewTextWindow",{title:"SVG"}),this.svgWindow.show(),this.svgWindow.setValue(a)}}),Ext.define("App.ui.StrandPreviewTextWindow",{extend:"Ext.window.Window",layout:"fit",closeAction:"hide",width:300,height:200,bodyBorder:!1,border:!1,plain:!0,headerPosition:"left",initComponent:function(){this.editor=Ext.create("App.usr.text.Editor"),Ext.apply(this,{items:[this.editor]}),this.callParent(arguments),this.value&&this.setValue(this.value)},setValue:function(){return this.editor.setValue.apply(this.editor,arguments)},getValue:function(){return this.editor.getValue.apply(this.editor,arguments)}});
Ext.define("App.ui.StrandPreviewWindow",{requires:["App.ui.StrandPreview"],extend:"Ext.window.Window",width:400,height:400,layout:"fit",title:"Secondary Structure Preview",plain:!0,bodyBorder:!1,border:!1,closeAction:"hide",initComponent:function(){Ext.apply(this,{layout:"border",items:[{xtype:"codemirror",mode:"nupack",title:"Structure",fieldLabel:"Structure",labelAlign:"top",region:"north",split:!0},Ext.create("App.ui.StrandPreview",{region:"center",height:200,frame:!0,adjacencyMode:1,loopMode:"linear"})],buttons:[{text:"Preview",handler:this.doSubmit,scope:this}]}),this.callParent(arguments)},doSubmit:function(){var a=this.down("codemirror"),b=a.getValue(),c=this.down("strandpreview");c.setValue(b)},updateDesign:function(a){var b=this.down("codemirror");b.setValue(a)}});
Ext.define("App.ui.CreateMenu",{extend:"Ext.menu.Menu",labelText:"File Name:",createText:"Create",createIconCls:"tick",smartCreate:!1,defaultType:"txt",autoCreateMenu:!0,afterLeaveDelay:500,mixins:{tip:"App.ui.TipHelper"},initComponent:function(){this.extraMenuItems||(this.extraMenuItems=[]),Ext.apply(this,{items:[{text:this.labelText,canActivate:!1,iconCls:"rename"},{xtype:"textfield",allowBlank:!1,iconCls:"rename",ref:"fileNameField",indent:!0}].concat(this.extraMenuItems,[{text:this.createText,iconCls:this.createIconCls,ref:"createButton",disabled:!0,menu:Ext.apply(this.getCreateMenu(),{ref:"createMenu"})}])}),this.callParent(arguments),this.mixins.tip.init.apply(this,arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this),this.fileNameField.on("validitychange",function(a,b){this.createButton.setDisabled(!b)},this),this.createButton.on("click",function(){var a=this.fileNameField.getValue();this.onCreateButton(a)},this),this.createMenu&&this.createMenu.on("click",function(a,b,c){if(b){var d=b.type,e=this.fileNameField.getValue(),f=d!="folder"?App.Path.addExt(e,d):e;this.onCreate(d,e,f)}},this)},afterRender:function(){this.callParent(arguments)},onCreateButton:function(a){if(this.smartCreate){var b=this.fileNameField.getValue(),c=this.defaultType,d=c!="folder"?App.Path.addExt(b,c):b;this.onCreate(c,b,d)}},onCreate:function(a,b,c){App.ui.filesTree.newFileUnderSelection(c,function(a){App.ui.filesTree.open(a)})},getCreateMenu:function(){if(!this.autoCreateMenu)return!1;var a=[{text:"Nodal System",iconCls:"nodal",type:"nodal"},{text:"DyNAML File",iconCls:"dynaml",type:"dynaml"},{text:"DyNAMiC Intermediate (DIL)",iconCls:"dil",type:"dil"},"-",{text:"Pepper System",iconCls:"pepper",type:"sys"},{text:"Pepper Component",iconCls:"comp",type:"comp"},{text:"Pepper Intermediate (PIL)",iconCls:"pil",type:"pil"},"-",{text:"NUPACK Multi-objective script",iconCls:"nupack",type:"np"},{text:"Sequence",iconCls:"seq",type:"seq"},{text:"Primary Structure",iconCls:"line",type:"primary"},{text:"Secondary Structure",iconCls:"polyline",type:"secondary"},"-",{text:"Chemical Reaction Network",iconCls:"crn",type:"crn",disabled:!0},{text:"SBML File",iconCls:"document-sbml",type:"sbml"},"-",{text:"Workspace",iconCls:"whiteboard",type:"workspace"},{text:"HTML File",iconCls:"html",type:"html"},{text:"XML File",iconCls:"xml",type:"xml"},{text:"Javascript File",iconCls:"js",type:"js"},{text:"CoffeeScript File",iconCls:"coffee",type:"coffee"},{text:"Text File",iconCls:"txt",type:"txt"},{text:"LaTeX Document",iconCls:"tex",type:"tex"},{text:"Markdown Document",iconCls:"md",type:"md"},"-",{text:"Folder",iconCls:"folder",type:"folder"}];return{items:_.map(a,function(a){return _.isObject(a)&&(a.tooltip={title:App.Files.getTypeName(a.type),text:App.Files.getTypeDescription(a.type)||"&nbsp;",trackMouse:!1,anchor:"right",anchorToTarget:!0}),a})}}});
Ext.define("App.usr.text.Editor",{extend:"Ext.panel.Panel",mixins:{app:"App.ui.Application"},requires:["App.ui.SaveButton","App.ui.CodeMirror"],mode:"",layout:"fit",editorType:"",constructor:function(a){this.callParent(arguments),this.mixins.app.constructor.apply(this,arguments)},initComponent:function(){Ext.applyIf(this,{tbar:["->",Ext.create("App.ui.SaveButton",{app:this})],items:[{xtype:"codemirror",itemId:"editor",border:!1,mode:this.mode}]}),this.callParent(arguments),this.editor=this.down(".codemirror"),this.on("afterrender",this.loadFile,this)},onLoad:function(){this.editor.setValue(this.data)},getSaveData:function(){return this.editor.getValue()},search:function(a){this.editor.search(a)},replace:function(a,b){this.editor.replace(a,b)},setValue:function(){return this.editor.setValue.apply(this.editor,arguments)},getValue:function(){return this.editor.getValue.apply(this.editor,arguments)},getSelection:function(){return this.editor.codemirror.getSelection()},getSelectionOrValue:function(){var a=this.editor.codemirror.getSelection();return a==""&&(a=this.editor.getValue()),a},getCursor:function(a){return this.editor.codemirror.getCursor(a)},getCursorRange:function(){return[this.editor.codemirror.getCursor(!0),this.editor.codemirror.getCursor(!1)]}});
Ext.define("App.usr.seq.Editor",{extend:"App.usr.text.Editor",mode:"sequence",mixins:{tips:"App.ui.TipHelper"},iconCls:"sequence",editorType:"Sequence",title:"Sequences",saveButtonText:"Save",requires:["App.usr.seq.Stats","App.ui.CompareMenu","App.ui.StatMenu","App.ui.SaveButton","App.ui.vienna.RNAfoldWindow","App.ui.mfold.QuikFoldWindow","App.ui.nupack.PartitionWindow"],uses:["App.ui.SequenceThreader"],initComponent:function(){Ext.applyIf(this,{tbar:[{text:"Metrics",iconCls:"ruler",menu:{items:[{disabled:!0,text:"Stats",menu:Ext.create("App.usr.seq.Stats",{ref:"statsPanel"}),tooltip:{anchor:"bottom",title:"Sequence Statistics",text:"Displays various statistics about the base composition of the sequence."},ref:"stats"},{text:"Levenshtein distance",tooltip:{anchor:"bottom",title:"Levenshtein distance",text:'The <a href="http://en.wikipedia.org/wiki/Levenshtein_distance">Levenshtein Distance</a> between two strings measures the minimum number of changes, or "edits" (insertions,  deletions, and substitutions) necessary two make the two strings equal.'},menu:Ext.create("App.ui.CompareMenu",{algorithm:DNA.levenshtein}),ref:"lev"},{text:"Hamming distance",tooltip:{anchor:"bottom",title:"Hamming Distance",text:'The <a href="http://en.wikipedia.org/wiki/Hamming_distance">Hamming Distance</a> between two strings of equal length measures the number of positions at which they are different; (i.e. it considers substitutions, but not insertions, deletions, or truncations.).'},menu:Ext.create("App.ui.CompareMenu",{algorithm:DNA.hamming,validate:function(a,b){return a.length==b.length}}),ref:"hamming"},{text:"Shannon Entropy",tooltip:{anchor:"bottom",title:"Shannon Entropy",text:'The <a href="http://en.wikipedia.org/wiki/Entropy_(information_theory)">Shannon Entropy</a> of a string measures the information complexity of that string. This can be used to approximate the base diversity in a sequence (higher is better).'},menu:Ext.create("App.ui.StatMenu",{labelText:"Calculate Shannon Entropy (∆S°)",baseText:"Shannon: ",algorithm:function(a){var b=0,c=0,d=0,e=0,f=0,g=0;a=a.trim();for(j=0;j<a.length;j++)f=a[j],f=="G"?b++:f=="A"?c++:f=="T"?d++:f=="C"&&e++;return b/=a.length,c/=a.length,d/=a.length,e/=a.length,g=-(b*(b>0?Math.log(b)/Math.LN2:0)+c*(c>0?Math.log(c)/Math.LN2:0)+d*(d>0?Math.log(d)/Math.LN2:0)+e*(e>0?Math.log(e/Math.LN2):0)),g}}),ref:"shannon"}]},scope:this},{text:"Transform",iconCls:"transform",tooltip:"",menu:[{text:"Reverse",iconCls:"seq-reverse",handler:this.reverse,scope:this,tooltip:'Reverse the order of bases in each strand in the selection. If "Replace Selection" is unchecked, the reverse strands will be inserted below the originals.'},{text:"Complement",iconCls:"seq-complement",handler:this.complement,scope:this,tooltip:'Insert the Watson-Crick complement of each base in each strand in the selection.If "Replace Selection" is unchecked, the complement strands will be inserted below the originals. <b>Note:</b> this will not reverse the order of the bases; to present the complement in the 5\'&rarr;3\' direction, use "Reverse Complement."'},{text:"Reverse Complement",iconCls:"seq-reverse-complement",handler:this.reverseComplement,scope:this,tooltip:"Insert the Watson-Crick complement of each base in each strand in the selection, in the 5'&rarr;3' direction. If \"Replace Selection\" is unchecked, the complement strands will be inserted below the originals. "},{text:"Duplicate",handler:this.duplicate,scope:this,tooltip:'Duplicate strands in the selection. If "Replace Selection" is unchecked, each duplicate strand will be inserted below the original. '},{text:"Truncate",iconCls:"cutter",tooltip:"Remove bases from the beginning or end of strands in the selection",menu:[{text:"Bases to truncate: ",tooltip:"Use a positive number for 5' truncations, negative number for 3' truncations.",canActivate:!1},{xtype:"numberfield",ref:"truncationCount",indent:!0},{text:"Truncate",iconCls:"tick",handler:this.truncate,scope:this}]},"-",{text:"To DNA",handler:this.convertToDNA,scope:this,iconCls:"document-d",tooltip:"Convert the selection to DNA"},{text:"To RNA",handler:this.convertToRNA,scope:this,iconCls:"document-r",tooltip:"Convert the selection to RNA"},"-",{text:"Pairwise Align",iconCls:"pairwise-align",ref:"align",handler:this.pairwiseAlign,scope:this},{text:"Replace Selection",checked:!0,ref:"replaceSelection"}]},{text:"Insert",iconCls:"plus-button",tooltip:"Generate and insert sequences",menu:{items:[{text:"Insert Poly-X sequence",iconCls:"",tooltip:"Inserts a sequence containing a single base or degenerate base, repeated several times (e.g. AAAAA, TTTTT, RRRRRR, etc.)",menu:[{text:"Base(s): ",tooltip:"Specify which base(s) (e.g. A, T, C, G, N, ...) you would like inserted",canActivate:!1},{xtype:"textfield",value:"N",ref:"insertionBase",indent:!0},{text:"Count: ",tooltip:"Specify which how many copies of the above you would like inserted",canActivate:!1},{xtype:"numberfield",ref:"insertionCount",indent:!0},{text:"Insert",iconCls:"tick",handler:this.insertNMer,scope:this}]},{text:"Generate Poly-X sequence",iconCls:"",tooltip:"Generates a random sequence according to the base or degenerate base specified (e.g. NNNN -> ATCG; YYYY -> CTCT, etc.)",menu:[{text:"Base(s): ",tooltip:"Specify which base(s) (e.g. A, T, C, G, N, ...) you would like to use; degenerate bases following the IUPAC nucleotide codes are allowed, and will be replaced by randomly selected bases matching the specification (e.g N becomes any base, R becomes A or G, Y becomes C or T, etc.)",canActivate:!1},{xtype:"textfield",value:"N",ref:"generateBase",indent:!0},{text:"Count: ",tooltip:"Specify which how many copies of the above you would like inserted",canActivate:!1},{xtype:"numberfield",ref:"generateCount",indent:!0,minValue:1},{text:"Insert",iconCls:"tick",handler:this.generateNMer,scope:this}]}]}},{text:"Format",iconCls:"pencil",tooltip:"Apply various formatting options to the selection.",menu:{items:[{text:"Strip extra characters",handler:this.stripExtra,scope:this,tooltip:"Removes characters other than A, T, C, G, U, and whitespace from the selection"},{text:"Strip whitespace",handler:this.stripWhitespace,scope:this,tooltip:"Removes whitespace characters (spaces, tabs, line returns) from the selection"},{text:"Strip newlines",handler:this.stripNewlines,scope:this,tooltip:"Removes line return characters from the selection"},{text:"Insert line breaks",handler:this.autoLineBreaks,scope:this,tooltip:"Replaces spaces in the selection with line returns"},{text:"Uppercase",handler:this.uppercase,scope:this,iconCls:"edit-uppercase",tooltip:"Converts the selection to uppercase"},{text:"Lowercase",handler:this.lowercase,scope:this,iconCls:"edit-lowercase",tooltip:"Converts the selection to lowercase"},{text:"Comment/Uncomment",handler:this.toggleComment,scope:this,iconCls:"comment",tooltip:"Adds/removes comment characters (# or %)"}]}},{text:"Export",iconCls:"document-export",tooltip:"Generate various input and output formats, or transform the strands for output",menu:{items:[{iconCls:"seq",text:"Make DD input file",handler:this.insertDD,scope:this,tooltip:"Generates an input file for DD or WebDD which can be used to mutate the selected domains."},{text:"Convert:",canActivate:!1},{text:"To FASTA",iconCls:"fasta",handler:function(){this.convertSelection("fasta")},scope:this},{text:"To NUPACK",iconCls:"nupack",handler:function(){this.convertSelection("nupack")},scope:this},{text:"To Excel/TSV",iconCls:"document-excel",handler:function(){this.convertSelection("tsv")},scope:this},{text:"To CSV",iconCls:"document-csv",handler:function(){this.convertSelection("csv")},scope:this},{text:"To Plain text",iconCls:"txt",handler:function(){this.convertSelection("")},scope:this},"-",{text:"Thread sequences to strand",handler:this.threadStrands,scope:this,tooltip:"Assemble the selected sequences into a set of strands using NUPACK strand-builder notation"},{text:"Name Strands",tooltip:"Automatically prepend a name to each of the strands in the selection",menu:[{text:"Strand name prefix: ",canActivate:!1},{xtype:"textfield",ref:"strandNamePrefix",indent:!0},{text:"Name Strands",iconCls:"tick",handler:this.nameStrands,scope:this}]},{iconCls:"prepend",text:"Prepend strands",tooltip:"Add a string to the beginning of each of the strands in the selection",menu:[{text:"Strand Prefix: ",canActivate:!1},{xtype:"textfield",ref:"strandPrefix",indent:!0},{text:"Prepend",iconCls:"tick",handler:this.prepend,scope:this}]}]}},{text:"Compute",iconCls:"calculator",tooltip:"Perform various thermodynamic calculations on the selection",menu:{items:[{text:"Calculate Partition Function...",handler:this.showPartitionWindow,scope:this,iconCls:"nupack-icon"},{text:"Calculate MFE Structure...",handler:this.showQuikfoldWindow,scope:this,iconCls:"mfold"},{text:"Calculate Partition Function...",handler:this.showViennaPartitionWindow,scope:this,iconCls:"tbi"},"-",{disabled:!0,text:"MFE Complexes",iconCls:"nupack-icon",menu:Ext.create("App.ui.CreateMenu",{ref:"mfeMenu",labelText:"Save results to:",createText:"Run",extraMenuItems:["-",{xtype:"numberfield",minValue:1,allowBlank:!0,emptyText:"Max Complex Size",ref:"mfeMaxComplexSize",indent:!0},"-"],onCreateButton:Ext.bind(this.mfeComplexes,this),autoCreateMenu:!1})},{disabled:!0,text:"Pairwise MFE Complexes",iconCls:"nupack-icon",menu:Ext.create("App.ui.CreateMenu",{ref:"mfeMenu",labelText:"Save results to:",createText:"Run",onCreateButton:Ext.bind(this.pairwiseMfeComplexes,this),autoCreateMenu:!1})},{disabled:!0,text:"Subsets MFE Complexes",iconCls:"nupack-icon",menu:Ext.create("App.ui.CreateMenu",{ref:"subsetsMenu",labelText:"Save results to:",createText:"Run",extraMenuItems:["-",{xtype:"numberfield",minValue:1,allowBlank:!0,emptyText:"Max Complex Size",ref:"subsetsMaxComplexSize",indent:!0},{checked:!0,text:"Compare against WC complements",ref:"subsetsWC"},"-"],onCreateButton:Ext.bind(this.subsetsMfe,this),autoCreateMenu:!1})},"-",{disabled:!0,text:"Brute Force",menu:[{text:"Target length: ",canActivate:!1},{xtype:"numberfield",ref:"brutePermCount",minValue:2,maxValue:6,indent:!0},{text:"Concatenations: ",canActivate:!1},{xtype:"numberfield",ref:"concatCount",minValue:0,indent:!0},{text:"Brute",iconCls:"tick",handler:this.bruteForce,scope:this}]}]}},"->",Ext.create("App.ui.SaveButton",{text:this.saveButtonText,iconCls:"save",app:this})],bbar:Ext.create("Ext.ux.statusbar.StatusBar",{ref:"statusBar",items:[{xtype:"tbtext",baseText:"Strands: ",text:"Strands: ",ref:"strandCount"},{xtype:"tbtext",baseText:"Bases: ",text:"Bases: ",ref:"baseCount"}]})}),this.callParent(arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this),this.mixins.tips.init.apply(this,arguments),this.shannon.on("activate",this.populateShannon,this),this.hamming.on("activate",this.populateHamming,this),this.lev.on("activate",this.populateLev,this),this.stats.on("activate",this.populateStats,this),this.editor.on("cursorchange",this.updateStatusBar,this)},updateStatusBar:function(){var a=this.getSelectionOrValue(),b=_.filter(a.split("\n"),function(a){return!a||!/$>./.test(a)}),c=b.length,d=_.map(b,function(a){return a.replace(/$\w+\s?:\s?/,"")}).join("");baseCount=d.replace(/[^atcgunrykmswbdhv]/gmi,"").length,this.strandCount.setText(this.strandCount.baseText+c),this.baseCount.setText(this.baseCount.baseText+baseCount)},bruteForce:function(){function d(a,b){var c=[];return _.each(a,function(a){_.each(b,function(b){c.push(a+b)})}),c}function e(a,b,c){c||(c=["A","T","C","G"]),b||(b=["A","T","C","G"]);for(var e=1;e<a;e++)b=d(b,c);return b}function f(a,d){var f=e(d),g="",i={};for(var j=0;j<f.length;j++){g=DNA.reverseComplement(f[j]),i[f[j]]=0;for(var k=0;k<a.length;k++)a[k].indexOf(g)!=-1&&i[f[j]]++}var l=1e3,m=_.sortBy(_.map(i,function(a,b){return a<l&&(l=a),{sequence:b,interactions:a}}),function(a){return a.interactions}),n=_.compact(_.map(m,function(a){return a.interactions==l?a.sequence:!1})),o=c!=0?e(c,n,n):m,p=new DD,q;p.addDomains(a),p.evaluateAllScores(),q=_.map(o,function(a){return p.addDomains([a]),p.evaluateScores(p.getDomainCount()-1),{perm:a,score:p.popDomain()}}),q=_.sortBy(q,function(a){return a.score}),console.log(q);var r=Ext.create("Ext.window.Window",{width:650,height:400,maximizable:!0,items:[{xtype:"textareafield",region:"north",height:200,value:_.map(q,function(a){return a.perm+" : "+a.score}).join("\n"),split:!0},Ext.create("App.ui.ProtovisPanel",{length:d,strands:a,autoRender:!0,autoSize:!1,autoScroll:!0,region:"center",buildVis:function(){this.vis=this.getCanvas();var a=this.data;w=600,h=15*a.length,xScale=pv.Scale.linear(0,this.strands.length).nice().range(0,w),yScale=pv.Scale.ordinal(pv.range(0,a.length)).splitBanded(0,15*a.length,.8),this.vis.width(w).height(h).top(10).bottom(20).left(50).right(10);var b=this.vis.add(pv.Bar).data(a).top(function(){return yScale(this.index)}).height(yScale.range().band).left(0).width(function(a){return xScale(a.interactions)});b.anchor("right").add(pv.Label).textStyle("white").text(function(a){return a.interactions}),b.anchor("left").add(pv.Label).textMargin(5).textAlign("right").text(function(a){return a.sequence})},data:m})],layout:"border",title:"Brute force "+b+"-mer search"});r.show(),console.log(m)}var a=this.smartSelect(),b=this.brutePermCount.getValue(),c=this.concatCount.getValue();f(a,b)},threadStrands:function(){var a=Ext.create("App.ui.SequenceThreader",{});a.show(),a.setSequences(this.getSelection())},showPartitionWindow:function(){this.partitionWindow||(this.partitionWindow=Ext.create("App.ui.nupack.PartitionWindow",{renderTo:Ext.getBody()})),this.partitionWindow.updateStrands(this.getSelectionOrValue()),this.partitionWindow.show()},showViennaPartitionWindow:function(){this.rnaFoldWindow||(this.rnaFoldWindow=Ext.create("App.ui.vienna.RNAfoldWindow",{renderTo:Ext.getBody()})),this.rnaFoldWindow.updateStrands(this.getSelectionOrValue()),this.rnaFoldWindow.show()},showQuikfoldWindow:function(){this.quikFoldWindow||(this.quikFoldWindow=Ext.create("App.ui.mfold.QuikFoldWindow",{renderTo:Ext.getBody()})),this.quikFoldWindow.updateStrands(this.getSelectionOrValue()),this.quikFoldWindow.show()},subsetsMfe:function(a){var b=this.smartSelect(),c=b.length;c=this.subsetsMaxComplexSize.getValue(),c=Ext.isNumber(c)?c:2,wc=this.subsetsWC.checked,App.runTask("nupack.Subsets",{node:App.Path.sameDirectory(this.getPath(),a),strands:b,maxComplex:c,wc:wc})},pairwiseMfeComplexes:function(a){var b=this.smartSelect(),c=b.length;App.runTask("nupack.Pairwise",{node:App.Path.sameDirectory(this.getPath(),a),strands:b})},mfeComplexes:function(a){var b=this.smartSelect(),c=this.mfeMaxComplexSize.getValue();c=Ext.isNumber(c)?c:b.length,App.runTask("nupack.Analysis",{node:App.Path.sameDirectory(this.getPath(),a),strands:b,max:c})},populateStats:function(){this.statsPanel.loadSequence(this.getSelectionOrValue().replace(/[^atcgu]/gi,""))},toggleComment:function(){var a=this.smartSelect();a=_.map(a,function(a){return a.trim()[0]=="#"||a.trim()[0]=="%"?a=a.trim().substr(1):a="#"+a,a}),a=a.join("\n"),this.editor.codemirror.replaceSelection(a)},truncate:function(){var a=this.smartSelect(),b=this.truncationCount.getValue();a=_.map(a,function(a){var c=a.split(":"),d=c.pop().trim();return b>0?d=d.substr(b):d=d.substr(0,d.length+b),c.push(d),c.join(": ")}),a=a.join("\n"),this.editor.codemirror.replaceSelection(a)},nameStrands:function(){var a=this.smartSelect(),b=this.strandNamePrefix.getValue(),c=0;!!b||(b=""),a=_.map(a,function(a){return c++,b+c+" : "+a}),a=a.join("\n"),this.editor.codemirror.replaceSelection(a)},prepend:function(){var a=this.smartSelect(),b=this.strandPrefix.getValue(),c=0;!!b||(b=""),a=_.map(a,function(a){return b+a}),a=a.join("\n"),this.editor.codemirror.replaceSelection(a)},nupackToFasta:function(){this.replace(new RegExp("\\t\\n","gm"),"\n>"),this.replace(new RegExp("\\t","g"),"\n")},insertDD:function(){this.replace(Ext.bind(this.makeDD,this))},makeDD:function(a){a=a.replace(/[^atcgu\s]/gi,"");var b=_.map(a.split("\n"),function(a){return a.trim()}),c=b.length.toString()+"\n";return _.each(b,function(a){c+=a+" 1 15\n"}),"# Save the following as an input file for DD:\n"+c},convertSelection:function(a){var b=this;this.replace(function(c){return b.convert(a,c)})},convert:function(a,b){var c=DNA.parseNamedSequences(b);return DNA.printSequences(c,a)},replace:function(a,b){var c=this.editor.codemirror.getSelection(),d;c==""?(c=this.editor.getValue(),a.test?d=c.replace(a,b):Ext.isFunction(a)&&(d=a(c)),this.editor.setValue(d)):(a.test?d=c.replace(a,b):Ext.isFunction(a)&&(d=a(c)),this.editor.codemirror.replaceSelection(d))},uppercase:function(){this.replace(function(a){return a.toUpperCase()})},lowercase:function(){this.replace(function(a){return a.toLowerCase()})},convertToDNA:function(){this.replace(/u/g,"t"),this.replace(/U/g,"T")},convertToRNA:function(){this.replace(/t/g,"u"),this.replace(/T/g,"U")},autoLineBreaks:function(){this.replace(/s/gm,"\n")},stripExtra:function(){this.strip(/[^atcgu\s]/gi)},stripWhitespace:function(){this.strip(/\s/gm)},stripNewlines:function(){this.strip(new RegExp("\\n","gm"))},strip:function(a){this.replace(a,"")},pairwiseAlign:function(){var a=this.smartSelect(),b=DNA.pairwiseAlign(a[0],a[1],2,-1,2,0,0);this.editor.codemirror.replaceSelection(b.sequences.join("\n"))},transformByLine:function(a){var b=this.editor.codemirror.getSelection(),c=this.replaceSelection.checked,d;b=b.split("\n"),d=_.map(b,function(b){return a(b.trim())}),c||(d=_.map(_.zip(b,d),function(a){return a.join("\n")})),this.editor.codemirror.replaceSelection(d.join("\n"))},duplicate:function(){this.transformByLine(function(a){return a+a})},reverse:function(){this.transformByLine(DNA.reverse)},complement:function(){this.transformByLine(DNA.complement)},reverseComplement:function(){this.transformByLine(DNA.reverseComplement)},insertNMer:function(){var a=this.insertionBase.getValue(),b=this.insertionCount.getValue(),c=Array(b+1).join(a);this.editor.codemirror.replaceSelection(c)},generateNMer:function(a,b){var c=this.generateBase.getValue(),b=this.generateCount.getValue(),d=DNA.populateDegenerate(Array(b+1).join(c));this.editor.codemirror.replaceSelection(d)},populateShannon:function(){var a=this.shannon.menu;sel=this.editor.codemirror.getSelection(),sel!=""&&a.populate(sel)},populateHamming:function(){this.populateComparison(this.hamming)},populateLev:function(){this.populateComparison(this.lev)},getSelection:function(){return this.editor.codemirror.getSelection()},smartSelect:function(){return this.smartSplit(this.editor.codemirror.getSelection())},smartSplit:function(a){return a.indexOf("\n")!=-1?(a.replace(/(\r\n)/g,"\n"),a=a.split("\n")):a.indexOf("	")!=-1?a=a.split("	"):a.indexOf(" ")!=-1?a=a.split(" "):a=[a,""],_.map(a,function(a){return a.trim()})},populateComparison:function(a){var b=a.menu,c=this.editor.codemirror.getSelection();c!=""&&(c=this.smartSplit(c),b.populate(c[0],c[1]))}});
Ext.define("App.ui.SequenceThreader",{extend:"Ext.window.Window",title:"Thread Sequences",iconCls:"thread-sequence",requires:["App.usr.seq.Editor","App.ui.CodeMirror"],layout:"fit",minimize:function(){this.toggleCollapse()},minimizable:!0,maximizable:!0,width:400,height:400,border:!1,bodyBorder:!1,layout:"border",initComponent:function(){Ext.apply(this,{tbar:[{text:"Thread",iconCls:"thread-sequence",handler:this.thread,scope:this},{text:"Normalize",iconCls:"normalize",handler:this.normalize,scope:this},{text:"Truncate",iconCls:"cutter",handler:this.truncate,scope:this},"->",{text:"Show Dethreaded",enableToggle:!0,pressed:!1,toggleHandler:this.toggleDethreaded,name:"dethreaded",scope:this}],items:[Ext.create("App.ui.CodeMirror",{region:"west",width:200,split:!0,ref:"sequencesPane",mode:"sequence",title:"Sequence"}),Ext.create("App.ui.CodeMirror",{region:"center",ref:"strandsPane",mode:"nupack",title:"Strands"}),Ext.create("App.usr.seq.Editor",{region:"south",ref:"resultsPane",mode:"sequence",height:200,split:!0,title:"Results"})],buttons:[{text:"Done"}]}),this.callParent(arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this)},smartSelect:function(a){return App.usr.seq.Editor.prototype.smartSplit.call(a,a.getValue())},thread:function(){var a=this.smartSelect(this.sequencesPane),b=this.strandsPane.getValue().split("\n"),c={},d;a=_.reduce(a,function(a,b,c){var d=b.split(":");return d.length!=2||!d[0]?a[c+1]=b:a[d[0].trim()]=d[1].trim(),a},{}),c=_.reduce(b,function(a,b,c){var d=b.split(":");return d.length!=2||!d[0]?a[c+1]=b:a[d[0].trim()]=d[1].trim(),a},{});var e=[],f=[];_.each(c,function(b,c,d){var g=DNA.threadSegments(a,b,!1);e.push(c+" : "+g.join("")),f.push({name:c,seq:g,spec:_.compact(b.split(" "))})}),this.dethreaded=_.map(f,function(a){var b=a.spec,c=a.seq,d=a.name;for(var e=0;e<b.length;e++)b[e].length>c[e].length?c[e]+=Array(b[e].length-c[e].length+1).join(" "):b[e].length<c[e].length&&(b[e]+=Array(c[e].length-b[e].length+1).join(" "));return">"+d+"|"+b.join("|")+"\n  "+Array(d.length+1).join(" ")+c.join("|")}).join("\n"),this.sequences=e.join("\n"),this.resultsPane.setValue(this.sequences)},toggleDethreaded:function(){var a=this.down("[name=dethreaded]");a.pressed?this.resultsPane.setValue(this.dethreaded):this.resultsPane.setValue(this.sequences)},normalize:function(){var a=this.smartSelect(this.strandsPane),b,c,d;b=_.map(a,function(a){return _.map(a.split(":"),function(a){return a.trim()})}),b=_.zip.apply(_,b),c=_.compact(b[0]),d=_.compact(b[1]),d=DNA.normalizeSystem(d),this.strandsPane.setValue(_.map(_.zip(c,d),function(a){return a[0]+" : "+DNA.encodeStrand(a[1])}).join("\n"))},setStrands:function(a){this.strandsPane.setValue(a)},setSequences:function(a){this.sequencesPane.setValue(a)}});
Ext.define("App.ui.files.DragDropManager",{constructor:function(){this.callParent(arguments),this.filesTree&&this.filesTree.getEl()&&(this.element=this.filesTree.getEl())},requires:["App.ui.files.FileUploader"],extend:"App.ui.DragDropManager",fileHandler:function(a,b){var c=Ext.get(b.target).up(".x-grid-row"),d;c&&(d=this.filesTree.getView().getRecord(c),d&&(d=d.getFolder(),uh=this.getUploadHandler(),Ext.each(a,function(a){var b=uh.add(a),c=Ext.create("App.ui.files.FileUploader",{filesTree:this.filesTree,record:d,manager:this,fileId:b});this.fileUploaders[b]=c,uh.upload(b,{userfile:App.Path.join([d.getDocumentPath(),uh.getName(b)])}),this.filesTree.loaders++,this.filesTree.setLoading(this.filesTree.loaders>0)},this)))}},function(){});
Ext.define("App.ui.FilesTree",{extend:"Ext.tree.Panel",requires:["App.ui.files.DragDropManager","App.ui.files.FileUploader","App.ui.CreateMenu","App.ui.Launcher"],title:"Files",newFileNumber:0,loaders:0,useArrows:!0,getState:function(){var a=[],b=this.callParent(),c=function(a,b,c){b=b||a.idProperty,c=c||"/";var d=[a.get(b)],e=a.parentNode;while(e)d.unshift(e.get(b)),e=e.parentNode;return c+d.join(c)};return this.getRootNode().eachChild(function(b){var d=function(a,b){a.isExpanded()&&a.childNodes.length>0&&(b.push(c(a,"text")),a.eachChild(function(a){d(a,b)}))};d(b,a)}),Ext.apply(b,{expandedNodes:a}),b},applyState:function(a){var b=a.expandedNodes||[],c=b.length;this.collapseAll();for(var d=0;d<c;d++)typeof b[d]!="undefined"&&this.expandPath(b[d],"text");this.callParent(arguments)},createContextMenu:!0,allowDrop:!0,initComponent:function(){Ext.apply(this,{stateful:!0,stateId:this.id+"-state",stateEvents:["itemcollapse","itemexpand"]}),Ext.apply(this,{viewConfig:this.allowDrop?{plugins:[{ptype:"treeviewdragdrop"}],listeners:{drop:{fn:function(){},scope:this},render:{fn:function(a){a.tip=Ext.create("Ext.tip.ToolTip",{title:" ",target:a.el,delegate:a.itemSelector,trackMouse:!1,anchor:"right",anchorToTarget:!0,renderTo:Ext.getBody(),listeners:{beforeshow:function(c){var d=a.getRecord(c.triggerElement),e=d.get("type"),f=App.Files.getTypeName(e),g=App.Files.getTypeDesc(e);if(!g&&!f)return!1;c.setTitle(f+"&nbsp;&nbsp;"),c.update(g)}}})},scope:this}}}:{},store:App.DocumentStore,listeners:{beforeitemcontextmenu:this.createContextMenu?{fn:this.showContextMenu,scope:this}:{},itemdblclick:{fn:this.click,scope:this}}}),this.callParent(arguments);if(this.createContextMenu){this.contextMenu=Ext.create("Ext.menu.Menu",{floating:!0,shadow:"sides",items:[{text:"Open",iconCls:"folder-open",handler:function(){this.open(this.currentRecord)},scope:this},{text:"Refresh",iconCls:"refresh",handler:function(){this.refreshDocument(this.currentRecord)},scope:this},{text:"Download",iconCls:"download",handler:function(){this.download(this.currentRecord)},scope:this,enableIf:function(a){return a.isLeaf()}},{text:"Create",iconCls:"plus-button",menu:Ext.create("App.ui.CreateMenu",{})},{text:"Delete",iconCls:"delete-button",handler:function(){Ext.MessageBox.show({title:"Confirm file deletion",msg:"Are you sure you want to delete "+this.currentRecord.get("text")+" ?",buttons:Ext.MessageBox.YES+Ext.MessageBox.NO,closable:!1,fn:function(a){a=="yes"&&this.deleteSelectedDocument()},icon:Ext.MessageBox.WARNING,scope:this})},scope:this},"-",{text:"Rename:",canActivate:!1,iconCls:"rename",enableIf:function(a){return a.get("preventRename")!=1&&!a.isRoot()}},{xtype:"textfield",allowBlank:!1,itemId:"filename",ref:"fileNameField",indent:!0,enableIf:function(a){return a.get("preventRename")!=1&&!a.isRoot()}}],renderTo:Ext.getBody(),setFileName:function(a){var b=this.fileNameField;b.originalValue=a,b.setValue(a)},updateActionItems:function(b){this.actionItems.length>0&&_.each(this.actionItems,function(a){this.remove(a)},this),this.actionItems=this.add(a(b))}}),this.contextMenu.actionItems=[],_.each(this.contextMenu.query("*[ref]"),function(a){this[a.ref]=a},this),this.contextMenu.fileNameField=this.fileNameField,this.fileNameField.on("blur",function(){var a;this.fileNameField.isDirty()&&(a=this.fileNameField.getValue(),this.currentRecord.set("text",a),this.fileNameField.originalValue=a,this.fileNameField.checkDirty())},this),this.on("afterrender",this.afterrender,this),actionItems={},_.each(App.actions,function(a,b){actionItems[b]=_.map(a,function(a){return{text:a.text,iconCls:App.TaskRunner.getToolProperty(a.tool,"iconCls"),handler:function(){},scope:this.contextMenu}})});function a(a){}}},afterrender:function(){this.ddManager=Ext.create("App.ui.files.DragDropManager",{filesTree:this}),this.ddManager.render()},filter:function(a,b){var c=this.getStore();c.suspendEvents(),c.clearFilter(),this.getSelectionModel().clearSelections(),c.resumeEvents(),c.filter({property:"name",anyMatch:!0,value:b})},showContextMenu:function(a,b,c,d,e){this.currentRecord=b;var f=this.contextMenu;return f.setFileName(b.get("text")),_.each(f.query("*[enableIf]"),function(a){_.isFunction(a.enableIf)&&(a.enableIf(b)?a.enable():a.disable())}),f.showAt(e.getXY()),e.stopEvent(),!1},refreshDocument:function(a,b,c){if(a){c=c||window;var d=b?function(){b.apply(c,arguments),this.renewAll()}:this.renewAll;this.store.load({node:a,callback:d,scope:this})}},renewAll:function(){},download:function(a){a&&a.download()},deleteSelectedDocument:function(){var a=this.currentRecord;this.deleteDocument(a)},deleteDocument:function(a){a&&a.remove(!1)},click:function(a,b,c,d,e){this.open(b)},open:function(a){a&&!App.ui.Launcher.launchDocument(a)&&!a.isLeaf()&&this.getView().expand(a)},openSelection:function(){this.open(this.getSelectionModel().getLastSelected())},selectNode:function(a){this.selectPath(a)},newFileUnderSelection:function(a,b,c){var d=this.getSelectionModel().getLastSelected();return this.newFile(d,a,b,c)},newFile:function(a,b,c,d){a||(a=this.getRootNode()),a.isLeaf()&&a.parentNode&&(a=a.parentNode);var e=Ext.create("App.Document",{node:App.Path.join([a.get("node"),b]),text:b,leaf:!App.Path.isFolder(b)});return this.store.on("update",function(a,b,e){Ext.callback(c,d,[b])},null,{single:!0}),a.appendChild(e),a.expand(),e},newFileName:function(){return this.newFileNumber++,"Untitled-"+this.newFileNumber}});
Ext.define("Workspace.DDManager",{extend:"App.ui.DragDropManager",alias:"WorkspaceDDManager",allowExtDD:!0,fileHandler:function(a,b){var c=this.getAdjustedXYcoords(b.pageX,b.pageY),d=this.getUploadHandler();Ext.each(a,function(a){var b=d.add(a),e=new Workspace.FileUploader({workspace:this.workspace,manager:this,fileId:b,position:c});this.fileUploaders[b]=e,d.upload(b,{userfile:App.Path.join([App.Path.pop(this.workspace.getPath(),1),d.getName(b)])}),e.showThrobber()},this)},getEl:function(){return this.workspace.getEl()}},function(){Workspace.DDManager.addHandler("text/plain",function(a,b){var c=this.getAdjustedXYcoords(b.pageX,b.pageY),d=this.workspace.createObject(Workspace.RichTextObject,{text:a,x:c.x,y:c.y});d.sizeToFit()}),Workspace.DDManager.addHandler("text/html",function(a,b){var c=this.getAdjustedXYcoords(b.pageX,b.pageY),d=this.workspace.createObject(Workspace.RichTextObject,{text:a,x:c.x,y:c.y});d.sizeToFit()}),Workspace.DDManager.addHandler("text/uri-list",function(a,b){var c=this.getAdjustedXYcoords(b.pageX,b.pageY),d;a.match(Workspace.EmbedObject.regex)?d=this.workspace.createObject(Workspace.EmbedObject,{url:a,x:c.x,y:c.y}):d=this.workspace.createObject(Workspace.IFrameObject,{url:a,x:c.x,y:c.y})})});
Ext.define("Workspace.objects.ObjectCollection",{extend:"Ext.util.MixedCollection",alias:"Workspace.objects.Collection",getCommonWType:function(){var a=!1,b=!1;return this.each(function(c){if(!a)a=c.wtype,b=Workspace.Components.getType(a);else while(!c.isWType(a)&&b.superclass)a=b.superclass.wtype,b=Workspace.Components.getType(a)}),a}});
Ext.define("Workspace.objects.Object",{constructor:function(a){Workspace.objects.Object.superclass.constructor.apply(this,arguments),Ext.apply(this,a),Ext.applyIf(this,{id:App.nextId(),workspace:App.getDefaultWorkspace()}),this.exposeAll(a),this._children=this.children,this.children=Ext.create("Ext.util.MixedCollection"),this.state={selected:!1,dragging:!1,editing:!1,rendered:!1,destroyed:!1},this.addEvents("move","select","unselect","render","destroy"),this.expose("children",!0,!1,!0,!1),this.expose("x",!0,!0,!0,!1),this.expose("y",!0,!0,!0,!1),this.expose("id","getId",!1,!0,!1),this.expose("parent",!0,!0,!0,!1),this.expose("name",!0,!0,!0,!1),this.expose("iconCls",!0,!0,!0,!1),this.expose("movable",function(){var a=this.isMovable;return this.parent&&(a=a&&this.parent.childCanMove(this)),a},!1,!1,!1)},editable:!0,extend:"Machine.core.Serializable",wtype:"Workspace.objects.Object",x:0,y:0,isSelectable:!0,isEditable:!1,isMovable:!0,parent:!1,selectChildren:!1,editChildren:!1,moveChildren:!0,name:"New Object",initialize:function(){this.parent&&this.set("parent",Workspace.Components.realize(this.parent)),this.buildChildren()},getParent:function(){return this.get("parent")},setParent:function(a){this.set("parent",a)},hasParent:function(){return this.get("parent")!=0},orphan:function(){var a=this.getParent();a&&a.removeChild(this),this.set("parent",!1)},buildChildren:function(){var a=this._children;if(Ext.isArray(a))Ext.each(a,function(a){this.addChild(Workspace.Components.realize(a))},this);else if(Ext.isObject(a)){var b;for(var c in a)b=a[c],this.addChild(Workspace.Components.realize(b))}},addChild:function(a){this.children.add(a),a.setParent(this)},adopt:function(){this.addChild.apply(this,arguments)},removeChild:function(a){this.children.remove(a)},childCanMove:function(a){return!0},select:function(){return this.workspace.select(this),this},unselect:function(){return this.workspace.unselect(this),this},deselect:function(){return this.unselect.apply(this,arguments)},unselectAncestors:function(){var a=this.getParent();return a&&(a.unselectAncestors(),a.unselect()),this},unselectDescendents:function(){return!this.selectChildren&&this.children&&this.children.each&&this.children.each(function(a){a.unselect(),a.unselectDescendents()}),this},invertSelection:function(){this.is("selected")?this.unselect():this.select()},getChildren:function(){var a=this.get("children");if(a)return a.getRange()},getX:function(a){return a?this.get("x")-a.getX():this.get("x")},getY:function(a){return a?this.get("y")-a.getY():this.get("y")},updateX:function(a){this.fireEvent("move",a,this.getY())},updateY:function(a){this.fireEvent("move",a,this.getY())},getPosition:function(){return{x:this.get("x"),y:this.get("y")}},setPosition:function(a,b,c){c=c!==!1;var d=this.getDelta(a,b);this.set("x",a),this.set("y",b),this.ignoreTranslateChildren=!0,c&&this.moveChildren&&this.children&&this.children.each&&this.children.each(function(a){a.translate(d.dx,d.dy)}),this.ignoreTranslateChildren=!1,this.fireEvent("move",this,a,b)},getAbsolutePosition:function(){var a=this.getPosition();return a.x+=this.workspace.element.getX(),a.y+=this.workspace.element.getY(),a},moveTo:function(a,b){this.setPosition(a,b)},translate:function(a,b,c){c=c!==!1;var d=this.getX()+a,e=this.getY()+b;this.set("x",d),this.set("y",e),this.ignoreTranslateChildren=!0,c&&this.moveChildren&&this.children&&this.children.each&&this.children.each(function(c){c.translate(a,b)}),this.ignoreTranslateChildren=!1,this.fireEvent("move",this,this.getX(),this.getY())},move:function(a,b){this.translate(a,b)},getDelta:function(a,b){return{dx:a-this.getX(),dy:b-this.getY()}},setState:function(a,b){this.state[a]=b},is:function(a){return this.state[a]},addShim:function(a){this.getEl&&a.applyTo(this)},render:function(){this.on("change:x",this.updateX,this),this.on("change:y",this.updateY,this),this.setState("rendered",!0),this.fireEvent("render")},destroy:function(){this.is("destroyed")||(this.children&&this.children.getCount()>0&&this.children.each(function(a){a.orphan()}),this.parent&&this.orphan(),this.fireEvent("destroy",this),this.setState("destroyed",!0))}},function(){Workspace.reg("Workspace.objects.Object",Workspace.objects.Object)});
Ext.define("Workspace.actions.Action",{alias:"WorkspaceAction",extend:"Ext.Action",constructor:function(a){Workspace.actions.Action.superclass.constructor.apply(this,arguments),Ext.apply(this,a)},handler:function(){},getUndo:function(){},serialize:function(){},attachTo:function(a){this.workspace=a},execute:function(){this.handler?this.handler.apply(this.scope):Workspace.actions.Action.superclass.execute.apply(this,arguments)}});
Ext.define("Workspace.Shim",{constructor:function(a){Workspace.Shim.superclass.constructor.apply(this,arguments),Ext.applyIf(this,a,{elementSpec:{tag:"div",cls:"workspace-label"}})},extend:"Ext.util.Observable",position:"tl-bl?",animate:!1,passThroughEvents:!0,hideOnHide:!0,showOnShow:!0,applyTo:function(a){a.getEl&&(this.object=a,a.on("move",this.onMove,this),this.hideOnHide&&a.on("hide",this.hide,this),this.showOnShow&&a.on("show",this.show,this),a.on("destroy",this.destroy,this),a.is("rendered")?this.render():a.on("render",this.render,this,{single:!0}))},onMove:function(){if(this.object){var a=this.object.getEl();if(a){var b=this.getEl();b.position("absolute"),b.setLeftTop(this.getLeft(b)+this.offsets[0],this.getTop(b)+this.offsets[1])}}},getLeft:function(a){return this.object.getX()},getTop:function(a){return this.object.getY()-a.getHeight()},render:function(){this.element=this.object.workspace.addElement(this.elementSpec),this.element.position("absolute"),this.passThroughEvents&&(this.element.on("click",this.object.click,this.object),this.element.on("mousedown",this.object.mousedown,this.object),this.element.on("mouseup",this.object.mouseup,this.object),this.element.on("mouseover",this.object.mouseover,this.object),this.element.on("mouseout",this.object.mouseout,this.object))},getEl:function(){return this.element},hide:function(){this.element&&this.getEl().hide()},show:function(){this.element&&this.getEl().show()},destroy:function(){this.element&&Ext.destroy(this.element)}}),Ext.ux.LabelEditor={},Ext.define("Ext.ux.LabelEditor",{extend:"Ext.Editor",alignment:"tl-tl",hideEl:!1,shim:!1,completeOnEnter:!0,cancelOnEsc:!0,constructor:function(a){Ext.applyIf(a,{field:{xtype:"textfield",allowBlank:!1,growMin:90,growMax:240,grow:!0,selectOnFocus:!0}}),Ext.ux.LabelEditor.superclass.constructor.call(this,a)},attachTo:function(a,b){this.targetEl=a,this.renderEl=b,a.on("click",this.startEdit,this)},startEdit:function(){this.renderEl&&Ext.ux.LabelEditor.superclass.startEdit.call(this,this.targetEl)}});
Ext.define("Workspace.FileUploader",{alias:"WorkspaceFileUploader",extend:"App.ui.FileUploader",showThrobber:function(){this.throbber=this.workspace.addElement({tag:"div",cls:"file-upload-throbber"}),this.throbber.setLeftTop(this.position.x,this.position.y)},hideThrobber:function(){this.throbber&&this.throbber.hide()}},function(){Workspace.FileUploader.addHandler(["jpg","png","gif"],function(a){this.workspace.createObject({wtype:"Workspace.objects.ImageObject",url:a,x:this.position.x,y:this.position.y}),this.hideThrobber()}),Workspace.FileUploader.addHandler(["pdf","doc","docx","ppt","pptx","xls","xlsx"],function(a){this.workspace.createObject({wtype:"Workspace.objects.PDFEmbedObject",url:a,x:this.position.x,y:this.position.y}),this.hideThrobber()})});
Ext.define("Workspace.tools.BaseTool",{constructor:function(a,b){this.callParent([b]),Ext.apply(this,b,{keyMapping:!1}),this.workspace=a,this.keyMapping&&(this.keyMap=new Ext.KeyMap(this.workspace.element,this.keyMapping),this.keyMap.stopEvent=!0,this.keyMap.disable())},extend:"Ext.util.Observable",click:function(a,b){},dblclick:function(a,b){},mousedown:function(a,b){},mouseup:function(a,b){},mousemove:function(a,b){},mouseover:function(a,b){},mouseout:function(a,b){},getAdjustedXY:function(a){return this.getAdjustedXYcoords(a.getPageX(),a.getPageY())},getAdjustedXYcoords:function(a,b){var c=this.workspace.lens.getAdjustedXYcoords(a-this.workspace.element.getX(),b-this.workspace.element.getY());return c},activate:function(){this.keyMap&&this.keyMap.enable()},deactivate:function(){this.keyMap&&this.keyMap.disable()}});
Ext.define("Workspace.tools.AlohaTool",{constructor:function(a,b){Workspace.tools.AlohaTool.superclass.constructor.call(this,a,b)},extend:"Workspace.tools.BaseTool",click:function(a,b){},dblclick:function(a,b){},mousedown:function(a,b){},mouseup:function(a,b){},mousemove:function(a,b){},attach:function(a){if(a.element){this.item=a,this.editable=new GENTICS.Aloha.Editable($(Ext.fly(a.element).dom).attr("contentEditable",!1));var b=this;return this.endEditFunction=function(){b.workspace.endEdit()},$(this.editable).bind("editableDeactivated",this.endEditFunction),this.editable.enable(),this.editable.activate(),!0}return!1},detach:function(){this.item&&($(Ext.fly(this.item.element).dom).attr("contentEditable",!1),this.endEditFunction&&($(this.editable).unbind("editableDeactivated",this.endEditFunction),this.endEditFunction=!1),this.editable&&(this.editable.disable(),this.editable.destroy(),this.editable=!1),this.item.buildEvents&&this.item.buildEvents(),this.item.set("text",this.item.getEl().dom.innerHTML),this.item=!1)},activate:function(){Workspace.tools.AlohaTool.superclass.activate.call(this)},deactivate:function(){Workspace.tools.AlohaTool.superclass.deactivate.call(this),this.detach()}},function(){Workspace.Tools.register("aloha",Workspace.tools.AlohaTool)});
Ext.define("Workspace.tools.MathQuillTool",{constructor:function(a,b){Workspace.tools.MathQuillTool.superclass.constructor.call(this,a,b)},extend:"Workspace.tools.BaseTool",click:function(a,b){},dblclick:function(a,b){(!b||b&&b.getId&&b.getId()!=this.item.getId())&&this.workspace.endEdit()},mousedown:function(a,b){},mouseup:function(a,b){},mousemove:function(a,b){},attach:function(a){return a&&a.element?(this.item=a,this.item.activate(),!0):!1},detach:function(){this.item&&(this.item.deactivate(),this.item.buildEvents&&this.item.buildEvents(),this.item=!1)},activate:function(){Workspace.tools.MathQuillTool.superclass.activate.call(this)},deactivate:function(){Workspace.tools.MathQuillTool.superclass.deactivate.call(this),this.detach()}},function(){Workspace.Tools.register("mathquill",Workspace.tools.MathQuillTool)});
Ext.define("Workspace.tools.SelectionBand",{constructor:function(a){Workspace.tools.SelectionBand.superclass.constructor.call(this),a=a||{},Ext.applyIf(a,{shape:"rect",strokeWidth:.25,padding:10,r:5}),Ext.apply(this,App.Stylesheet.Proxy),Ext.apply(this,a);var b=this.item,c=this.item.getDimensions(),d=this.item.getPosition(),e=d.x-this.padding,f=d.y-this.padding,g=c.width+2*this.padding,h=c.height+2*this.padding;this.rect=this.workspace.paper.rect(e,f,g,h),this.rect.attr({stroke:this.stroke,fill:this.fill,"fill-opacity":this.fillOpacity,"stroke-width":this.strokeWidth,opacity:this.opacity,r:this.r}),this.item.vectorElement&&this.rect.insertBefore(this.item.vectorElement),this.item.on("move",this.adjustBand,this),this.item.on("resize",this.adjustBand,this),this.adjustBand()},extend:"Ext.util.Observable",adjustBand:function(){var a=this.item,b=a.getDimensions(),c=a.getPosition(),d=c.x-this.padding,e=c.y-this.padding,f=b.width+2*this.padding,g=b.height+2*this.padding,h=a.get("rotation");this.rect.attr({x:d,y:e,width:f,height:g,rotation:h})},destroy:function(){this.rect.remove(),this.item.un("move",this.adjustBand,this),this.item.un("resize",this.adjustBand,this)}});
Ext.define("Workspace.tools.Highlightable",{constructor:function(){},accept:function(){return!0},setHoverItem:function(){},mouseover:function(a,b){b&&b.highlight&&this.accept(b)&&(b.highlight(),this.setHoverItem(b)),a&&a.stopEvent()},mouseout:function(a,b){b&&b.unhighlight&&(b.unhighlight(),this.setHoverItem(!1)),a&&a.stopEvent()}});
Ext.define("Workspace.tools.SelectorBand",{constructor:function(a,b){this.superclass.constructor.call(this),Ext.applyIf(b||{},{shape:"rect",x1:0,y1:0,width:0,height:0,anchor:"tl"}),Ext.apply(this,b,App.Stylesheet.Proxy),this.workspace=a,this.rect=a.paper.rect(this.x1,this.y1,this.width,this.height),this.rect.attr({stroke:this.stroke,"stroke-width":this.strokeWidth,fill:this.fill,"fill-opacity":this.fillOpacity,opacity:this.opacity})},extend:"Ext.util.Observable",adjustBand:function(a,b){this.x2=a,this.y2=b;var c=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,a,b);this.x=c.x,this.y=c.y,this.width=c.width,this.height=c.height,this.anchor=c.anchor,delete c.anchor,this.rect.attr(c)},getRegion:function(){var a=this.x,b=this.y,c=b+this.height,d=a+this.width;return new Ext.util.Region(b,d,c,a)},cacheRegions:function(){this.regions={},this.workspace.objects.eachKey(function(a,b){if(Ext.isFunction(b.getRegion)&!b.preventDragSelect){var c=b.getRegion();this.regions[a]=c}},this)},getItemsWithin:function(){var a=[],b=this.regions,c=this.getRegion();for(id in b)c.intersect(b[id])&&a.push(this.workspace.objects.get(id));return a},destroy:function(){this.rect.remove()},statics:{calculateBandBox:function(a,b,c,d){var e={},f,g;return e.width=Math.abs(c-a),c>a?(f="l",e.x=a):(f="r",e.x=c),e.height=Math.abs(d-b),d>b?(g="t",e.y=b):(g="b",e.y=d),e.anchor=f+g,e}}});
Ext.define("Workspace.tools.Handle",{forceFront:!1,constructor:function(a,b){Workspace.tools.Handle.superclass.constructor.call(this),this.addEvents("dragstart","drag","dragend"),Ext.applyIf(b,{x:0,y:0,x1:0,y1:0,shape:"rect",width:10,stroke:"#ccc",strokeWidth:1,fill:"#fff",r:2}),Ext.apply(this,b),this.workspace=a,this.dragging=!1,this.shape=="rect"?(this.handleShape=this.workspace.paper.rect(this.x-this.width/2,this.y-this.width/2,this.width,this.width),this.handleShape.attr({stroke:this.stroke,"stroke-width":this.strokeWidth,fill:this.fill})):this.shape=="circle"&&(this.handleShape=this.workspace.paper.circle(this.x,this.y,this.width/2),this.handleShape.attr({stroke:this.stroke,"stroke-width":this.strokeWidth,fill:this.fill})),this.item&&this.item.vectorElement?this.handleShape.insertAfter(this.item.vectorElement):this.handleShape.toFront(),this.forceFront&&this.toFront();var c=this;Ext.get(this.handleShape.node).on("mousedown",this.dragStartHandler,this),this.workspace.on("mouseup",this.dragEndHandler,this),this.workspace.on("mousemove",this.dragHandler,this)},extend:"",mixins:{highlightable:"Workspace.tools.Highlightable"},extend:"Ext.util.Observable",xMax:!1,yMax:!1,xMin:!1,yMin:!1,destroy:function(){Ext.get(this.handleShape.node).un("mousedown",this.dragStartHandler,this),this.workspace.un("mouseup",this.dragEndHandler,this),this.workspace.un("mousemove",this.dragHandler,this),this.handleShape.remove(),delete this.handleShape},getAdjustedXY:function(a){return Workspace.tools.BaseTool.prototype.getAdjustedXY.call(this,a)},getAdjustedXYcoords:function(a,b){return Workspace.tools.BaseTool.prototype.getAdjustedXYcoords.apply(this,arguments)},getPosition:function(){return{x:this.x,y:this.y}},antiAlias:function(a){return Math.round(a)+.5},setPosition:function(a,b){this.x=a,this.y=b,this.handleShape&&this.handleShape.attr({x:this.antiAlias(this.x-this.width/2),y:this.antiAlias(this.y-this.width/2)})},accept:function(){return!1},toFront:function(){this.handleShape&&this.handleShape.toFront()},dragStartHandler:function(a){this.dragging=!0;var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.fireEvent("dragstart"),this.toFront(),this.workspace.on("mouseover",this.mouseover,this),this.workspace.on("mouseout",this.mouseout,this),a.stopEvent()},dragHandler:function(a){if(this.dragging){pos=this.snap(this.getAdjustedXY(a),a);var b=pos.x-this.x1,c=pos.y-this.y1;this.x1=this.bounds(this.x1+b,this.xMax,this.xMin),this.y1=this.bounds(this.y1+c,this.yMax,this.yMin),this.setPosition(this.x1,this.y1),this.fireEvent("drag",a,pos.x,pos.y),Ext.isFunction(this.drag)&&this.drag(a,pos.x,pos.y)}},snap:function(a,b){return!b.hasModifier(),a},dragEndHandler:function(a){this.dragging&&(this.dragging=!1,this.workspace.un("mouseover",this.mouseover,this),this.workspace.un("mouseout",this.mouseout,this),this.fireEvent("dragend"))},bounds:function(a,b,c){return Workspace.Utils.bounds(a,c,b)}});
Ext.define("Workspace.objects.Object2d",{constructor:function(a){Workspace.objects.Object2d.superclass.constructor.apply(this,arguments),this.addEvents("hide","show","resize","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout"),this.expose("width",!0,!0,!0,!1),this.expose("height",!0,!0,!0,!1),this.showTitle&&(this.shimConfig=this.shimConfig||{},Ext.applyIf(this.shimConfig,{property:"name"}),this.addShim(Ext.create("Workspace.Label",this.shimConfig)))},extend:"Workspace.objects.Object",alias:"Workspace.Object2d",wtype:"Workspace.objects.Object2d",x:0,y:0,width:0,height:0,proxified:!1,render:function(){this.callParent(arguments),this.on("change:width",this.updateWidth,this),this.on("change:height",this.updateHeight,this)},getProxy:function(a,b){return a=a||{},b=b||!1,this.dragProxy?b&&this.dragProxy.setBox(this.getBox()):(Ext.applyIf(a,{workspace:this.workspace}),this.dragProxy=new Workspace.Proxy(a),this.dragProxy.render(),this.dragProxy.hide(),this.dragProxy.setBox(this.getBox())),this.dragProxy},proxify:function(){return this.applyProxy.apply(this,arguments)},deproxify:function(){return this.restoreFromProxy.apply(this,arguments)},applyProxy:function(){if(this.hide){var a=this.getProxy(!1,!0);return a.show(),this.hide(),this.proxified=!0,a}},restoreFromProxy:function(a){this.dragProxy&&(this.show(),a||this.setBox(this.dragProxy.getBox()),this.dragProxy.hide(),this.fireEvent("resize",this.getWidth(),this.getHeight()),this.fireEvent("move",this.getX(),this.getY()),this.proxified=!1)},getHighlightProxy:function(){var a=new Workspace.Proxy(Ext.applyIf({shape:"rect",workspace:this.workspace},App.Stylesheet.Highlight));return a},highlight:function(){this.is("rendered")&&(this.highlightProxy||(this.highlightProxy=this.getHighlightProxy()),this.highlightProxy.render(this.vectorElement),this.highlightProxy.attachTo(this),this.highlightProxy.show())},unhighlight:function(a){this.highlightProxy&&(this.highlightProxy.hide(),this.highlightProxy.detach(),a&&(this.highlightProxy.destroy(),this.highlightProxy=!1))},getDimensions:function(){return{width:this.getWidth(),width:this.getHeight()}},getWidth:function(){return this.get("width")},getHeight:function(){return this.get("height")},updateWidth:function(a){this.fireEvent("resize",this.width,this.height)},updateHeight:function(a){this.fireEvent("resize",this.width,this.height)},setDimensions:function(a,b){this.set("width",a),this.set("height",b)},getRegion:function(){var a=this.get("x"),b=this.get("y"),c=b+this.get("height"),d=a+this.get("width");return new Ext.util.Region(b,d,c,a)},getBBox:function(){return{x:this.getX(),y:this.getY(),width:this.getWidth(),height:this.getHeight()}},getBox:function(){return{tl:{x:this.getX(),y:this.getY()},tr:{x:this.getX()+this.getWidth(),y:this.getY()},bl:{x:this.getX(),y:this.getY()+this.getHeight()},br:{x:this.getX()+this.getWidth(),y:this.getY()+this.getHeight()}}},setBox:function(a,b,c,d){if(arguments.length==4)f=arguments[4]!==!1,this.setPosition(a,b),this.setDimensions(c-a,d-b);else{var e=arguments[0],f=arguments[1]!==!1;this.setPosition(e.tl.x,e.tl.y,f),this.setDimensions(e.tr.x-e.tl.x,e.bl.y-e.tl.y)}},show:function(){if(this.getEl&&this.is("rendered")){var a=this.getEl();a&&(a.show(),this.fireEvent("show",this)),this.children&&this.children.each(function(a){a.show()})}},hide:function(){if(this.getEl&&this.is("rendered")){var a=this.getEl();a&&(a.hide(),this.fireEvent("hide",this)),this.children&&this.children.each(function(a){a.hide()})}},click:function(a,b,c){this.fireEvent("click"),this.workspace.click(a,this)},dblclick:function(a,b,c){this.fireEvent("dblclick"),this.workspace.dblclick(a,this)},mousedown:function(a,b,c){this.fireEvent("mousedown"),this.workspace.mousedown(a,this)},mouseup:function(a,b,c){this.fireEvent("mouseup"),this.workspace.mouseup(a,this)},mousemove:function(a,b,c){this.fireEvent("mousemove"),this.workspace.mousemove(a,this)},mouseover:function(a,b,c){this.fireEvent("mouseover"),this.workspace.mouseover(a,this)},mouseout:function(a,b,c){this.fireEvent("mouseout"),this.workspace.mouseout(a,this)},destroy:function(){this.dragProxy&&(this.dragProxy.destroy(),delete this.dragProxy),Workspace.objects.Object2d.superclass.destroy.apply(this,arguments)}},function(){Workspace.reg("Workspace.objects.Object2d",Workspace.objects.Object2d)});
Ext.define("Workspace.objects.Interpolators",{statics:function(){function b(a){var b=[],c=0,d=a.length,e=a[0];b.push(e[0],",",e[1]);while(++c<d)b.push("L",(e=a[c])[0],",",e[1]);return b.join("")}function c(a){var b=[],c=0,d=a.length,e=a[0];b.push(e[0],",",e[1]);while(++c<d)b.push("V",(e=a[c])[1],"H",e[0]);return b.join("")}function d(a){var b=[],c=0,d=a.length,e=a[0];b.push(e[0],",",e[1]);while(++c<d)b.push("H",(e=a[c])[0],"V",e[1]);return b.join("")}function e(a,c){return a.length<4?b(a):a[1]+h(a.slice(1,a.length-1),i(a,c))}function f(a,c){return a.length<3?b(a):a[0]+h((a.push(a[0]),a),i([a[a.length-2]].concat(a,[a[1]]),c))}function g(a,c,d){return a.length<3?b(a):a[0]+h(a,i(a,c))}function h(a,c){if(c.length<1||a.length!=c.length&&a.length!=c.length+2)return b(a);var d=a.length!=c.length,e="",f=a[0],g=a[1],h=c[0],i=h,j=1;d&&(e+="Q"+(g[0]-h[0]*2/3)+","+(g[1]-h[1]*2/3)+","+g[0]+","+g[1],f=a[1],j=2);if(c.length>1){i=c[1],g=a[j],j++,e+="C"+(f[0]+h[0])+","+(f[1]+h[1])+","+(g[0]-i[0])+","+(g[1]-i[1])+","+g[0]+","+g[1];for(var k=2;k<c.length;k++,j++)g=a[j],i=c[k],e+="S"+(g[0]-i[0])+","+(g[1]-i[1])+","+g[0]+","+g[1]}if(d){var l=a[j];e+="Q"+(g[0]+i[0]*2/3)+","+(g[1]+i[1]*2/3)+","+l[0]+","+l[1]}return e}function i(a,b){var c=[],d=(1-b)/2,e,f=a[0],g=a[1],h=1,i=a.length;while(++h<i)e=f,f=g,g=a[h],c.push([d*(g[0]-e[0]),d*(g[1]-e[1])]);return c}function j(a){if(a.length<3)return b(a);var c=[],d=1,e=a.length,f=a[0],g=f[0],h=f[1],i=[g,g,g,(f=a[1])[0]],j=[h,h,h,f[1]];c.push(g,",",h),r(c,i,j);while(++d<e)f=a[d],i.shift(),i.push(f[0]),j.shift(),j.push(f[1]),r(c,i,j);d=-1;while(++d<2)i.shift(),i.push(f[0]),j.shift(),j.push(f[1]),r(c,i,j);return c.join("")}function k(a){if(a.length<4)return b(a);var c=[],d=-1,e=a.length,f,g=[0],h=[0];while(++d<3)f=a[d],g.push(f[0]),h.push(f[1]);c.push(n(q,g)+","+n(q,h)),--d;while(++d<e)f=a[d],g.shift(),g.push(f[0]),h.shift(),h.push(f[1]),r(c,g,h);return c.join("")}function l(a){var b,c=-1,d=a.length,e=d+4,f,g=[],h=[];while(++c<4)f=a[c%d],g.push(f[0]),h.push(f[1]);b=[n(q,g),",",n(q,h)],--c;while(++c<e)f=a[c%d],g.shift(),g.push(f[0]),h.shift(),h.push(f[1]),r(b,g,h);return b.join("")}function m(a,b){var c=a.length-1,d=a[0][0],e=a[0][1],f=a[c][0]-d,g=a[c][1]-e,h=-1,i,k;while(++h<=c)i=a[h],k=h/c,i[0]=b*i[0]+(1-b)*(d+k*f),i[1]=b*i[1]+(1-b)*(e+k*g);return j(a)}function n(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function r(a,b,c){a.push("C",n(o,b),",",n(o,c),",",n(p,b),",",n(p,c),",",n(q,b),",",n(q,c))}function s(a,b){return(b[1]-a[1])/(b[0]-a[0])}function t(a){var b=0,c=a.length-1,d=[],e=a[0],f=a[1],g=d[0]=s(e,f);while(++b<c)d[b]=g+(g=s(e=f,f=a[b+1]));return d[b]=g,d}function u(a){var b=[],c,d,e,f,g=t(a),h=-1,i=a.length-1;while(++h<i)c=s(a[h],a[h+1]),Math.abs(c)<1e-6?g[h]=g[h+1]=0:(d=g[h]/c,e=g[h+1]/c,f=d*d+e*e,f>9&&(f=c*3/Math.sqrt(f),g[h]=f*d,g[h+1]=f*e));h=-1;while(++h<=i)f=(a[Math.min(i,h+1)][0]-a[Math.max(0,h-1)][0])/(6*(1+g[h]*g[h])),b.push([f||0,g[h]*f||0]);return b}function v(a){return a.length<3?b(a):a[0]+h(a,u(a))}var a={linear:b,"step-before":c,"step-after":d,basis:j,"basis-open":k,"basis-closed":l,bundle:m,cardinal:g,"cardinal-open":e,"cardinal-closed":f,monotone:v},o=[0,2/3,1/3,0],p=[0,1/3,2/3,0],q=[0,1/6,2/3,1/6];return a}()});
Workspace.Proxy={},Ext.define("Workspace.Proxy",{constructor:function(a){Ext.apply(this,a,App.Stylesheet.Proxy),Workspace.Proxy.superclass.constructor.apply(this,arguments)},extend:"Ext.util.Observable",forceBack:!1,shape:"rect",strokeWidth:1,stroke:"#99BBE8",fill:"#99BBE8",fillOpacity:.5,opacity:.7,padding:10,x:0,y:0,rx:0,ry:0,width:0,height:0,rendered:!1,render:function(a){this.rendered||(this.vectorElement=this.workspace.paper[this.shape](this.x,this.y,this.width,this.height),a&&this.vectorElement.insertBefore(a),this.forceBack&&this.vectorElement.toBack(),this.vectorElement.attr(this.attributes()),this.rendered=!0)},getX:function(){return this.x},getY:function(){return this.y},getWidth:function(){return this.width},getHeight:function(){return this.height},updatePath:function(a){this.path=a,this.vectorElement.attr({path:a}),this.updateDimensionProps()},updateDimensionProps:function(){var a=this.vectorElement.getBBox(!0);this.x=a.x,this.y=a.y,this.height=a.height,this.width=a.width},setPosition:function(a,b){if(this.shape=="ellipse")this.vectorElement.attr({cx:a+this.width/2,cy:b+this.height/2}),this.x=a,this.y=b,this.fireEvent("move",this.x,this.y);else if(this.shape=="rect")this.vectorElement.attr({x:a,y:b}),this.x=a,this.y=b,this.fireEvent("move",this.x,this.y);else{var c=this.getDelta(a,b);this.translate(c.dx,c.dy)}},getDelta:function(a,b){return{dx:a-this.getX(),dy:b-this.getY()}},getScaleFactor:function(a,b){var c=this.getWidth(),d=this.getHeight();return{dw:c!=0?a/c:1,dh:d!=0?b/d:1}},translate:function(a,b){this.x+=a,this.y+=b;if(a!=0||b!=0)if(this.shape=="path"){var c=Raphael.pathToRelative(this.vectorElement.attr("path"));c[0][1]+=+a,c[0][2]+=+b,this.updatePath(this.path)}else this.vectorElement.attr({x:this.x,y:this.y});this.fireEvent("move",this.x,this.y)},scale:function(a,b){this.width*=a,this.height*=b,this.vectorElement.scale(a,b),this.fireEvent("resize",this.width,this.height)},setDimensions:function(a,b){this.width=a,this.height=b,this.shape=="ellipse"?this.vectorElement.attr({rx:a/2,ry:b/2}):this.vectorElement.attr({width:a,height:b}),this.fireEvent("resize",a,b)},getBox:function(){return{tl:{x:this.getX(),y:this.getY()},tr:{x:this.getX()+this.getWidth(),y:this.getY()},bl:{x:this.getX(),y:this.getY()+this.getHeight()},br:{x:this.getX()+this.getWidth(),y:this.getY()+this.getHeight()}}},setBox:function(a,b,c,d){if(arguments.length==4)this.setPosition(a,b),this.setDimensions(c-a,d-b);else{var e=arguments[0];this.setDimensions(e.tr.x-e.tl.x,e.bl.y-e.tl.y),this.setPosition(e.tl.x,e.tl.y)}},attributes:function(a){var b={};if(!a)var a=Workspace.objects.VectorObject.attrArray;for(var c=0,d=a.length;c<d;c++){var e=a[c],f=this[e.camelize().uncapitalize()];f&&(b[e]=f)}return b},updateBox:function(){this.attached&&this.setBox(Workspace.Utils.padBox(this.attached.getBox(),this.padding))},updatePosition:function(a,b){this.setPosition(a,b)},updateDimensions:function(a,b){this.setDimensions(a,b)},updateTransform:function(a){this.vectorElement.attr("transform","R"+ +a.get("rotation"))},attachTo:function(a){if(this.attached&&this.attached.getId){if(this.attached.getId()==a.getId()){this.path?this.updatePath(a.get("path")):this.setBox(Workspace.Utils.padBox(a.getBox(),this.padding));return}this.detach()}this.attached=a,a.on("move",this.updateBox,this),a.on("resize",this.updateBox,this),a.on("destroy",this.destroy,this),this.path?this.updatePath(a.get("path")):this.setBox(Workspace.Utils.padBox(a.getBox(),this.padding)),this.updateTransform(a)},detach:function(){this.attached&&(this.attached.un("move",this.updateBox,this),this.attached.un("resize",this.updateBox,this),this.attached.un("destroy",this.destroy,this),this.attached=!1)},show:function(){this.vectorElement&&(this.vectorElement.show(),this.forceBack&&this.vectorElement.toBack())},hide:function(){this.vectorElement&&this.vectorElement.hide()},destroy:function(){this.vectorElement&&(this.vectorElement.remove(),delete this.vectorElement)}});
Ext.define("Workspace.actions.ChangePropertyAction",{extend:"Workspace.actions.Action",constructor:function(a){Workspace.actions.ChangePropertyAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this})},wtype:"ChangePropertyAction",handler:function(){for(var a=0,b=this.subjects.length,c;a<b;a++){c=this.subjects[a];for(var d in this.values)c.set(d,this.values[d])}},getUndo:function(){var a={};for(var b=0,c=this.subjects.length,d;b<c;b++){d=this.subjects[b];for(var e in this.values)a[e]=d.get(e)}return new Workspace.actions.ChangePropertyAction({subjects:this.subjects.concat([]),values:a,text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,subjects:Workspace.Components.serialize(this.subjects),values:Workspace.Components.serialize(this.values)}}});
Ext.define("Workspace.actions.CreateObjectAction",{extend:"Workspace.actions.Action",constructor:function(a){Workspace.actions.CreateObjectAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this})},wtype:"CreateObjectAction",handler:function(){this.workspace.createObjects(this.objects)},getUndo:function(){return new Workspace.actions.DeleteObjectAction({subjects:this.subjects.concat([]),text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,objects:Workspace.Components.serialize(this.subjects)}}});
Ext.define("Workspace.actions.DeleteObjectAction",{extend:"Workspace.actions.Action",constructor:function(a){Workspace.actions.DeleteObjectAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this})},wtype:"DeleteObjectAction",handler:function(){this.workspace.deleteObjects(this.subjects)},getUndo:function(){return new Workspace.actions.CreateObjectAction({objects:Workspace.Components.serialize(this.subjects),text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,subjects:Workspace.Components.serialize(this.subjects)}}});
Ext.define("Workspace.actions.FormIdeaAction",{extend:"Workspace.actions.Action",constructor:function(a){Workspace.actions.FormIdeaAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this,ideaConfig:{}})},wtype:"FormIdeaAction",handler:function(){Ext.apply(this.ideaConfig,{children:this.subjects,wtype:"Workspace.IdeaObject"});var a=this.workspace.createObject(this.ideaConfig)},getUndo:function(){return new Workspace.actions.OrphanObjectAction({objects:this.subjects.concat([]),text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,subjects:Workspace.Components.serialize(this.subjects)}}});
Ext.define("Workspace.actions.DuplicateObjectAction",{extend:"Workspace.actions.Action",constructor:function(a){Workspace.actions.DuplicateObjectAction.superclass.constructor.apply(this,arguments);var b=[],c;Ext.each(a.objects,function(a){c=a.serialize(),delete c.id,c.x&&(c.x+=10),c.y&&(c.y+=10),b.push(c)}),Ext.applyIf(this,{scope:this,objects:b})},wtype:"DuplicateObjectAction",handler:function(){this.workspace.createObjects(this.objects)},getUndo:function(){return new Workspace.actions.DeleteObjectAction({subjects:this.objects.concat([]),text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,objects:Workspace.Components.serialize(this.subjects)}}});
Ext.define("Workspace.actions.AdoptObjectAction",{extend:"Workspace.actions.Action",constructor:function(a){Ext.apply(this,a),Workspace.actions.AdoptObjectAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this})},wtype:"AdoptObjectAction",handler:function(){Ext.each(this.subjects,function(a){this.parent.adopt(a)},this),this.parent.adjustSize&&this.parent.adjustSize()},getUndo:function(){return new Workspace.actions.OrphanObjectAction({objects:this.subjects.concat([]),text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,parent:Workspace.Components.serialize(this.parent),subjects:Workspace.Components.serialize(this.subjects)}}});
Ext.define("Workspace.actions.ExpandAction",{extend:"Workspace.actions.Action",constructor:function(a){Ext.apply(this,a,{size:[400,400]}),Workspace.actions.DeleteObjectAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this})},wtype:"ExpandAction",handler:function(){this.workspace.expand(this.size[0],this.size[1])},getUndo:function(){return new Workspace.actions.ExpandAction({size:[-this.size[0],-this.size[1]],text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,size:this.size}}});
Ext.define("Workspace.actions.OrphanObjectAction",{extend:"Workspace.actions.Action",constructor:function(a){Ext.apply(this,a),Workspace.actions.OrphanObjectAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this})},wtype:"OrphanObjectAction",handler:function(){Ext.each(this.subjects,function(a){a.orphan()})},getUndo:function(){return new Workspace.actions.AdoptObjectAction({objects:this.subjects.concat([]),text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,subjects:Workspace.Components.serialize(this.subjects)}}});
Ext.define("Workspace.Label",{constructor:function(a){Ext.applyIf(a,{elementSpec:{},tag:"div",cls:"workspace-label",offsets:[0,-3]}),Ext.applyIf(a.elementSpec,{tag:a.tag,cls:a.cls}),Workspace.Label.superclass.constructor.apply(this,arguments)},extend:"Workspace.Shim",property:"name",padding:5,editable:!0,textWidth:!1,textHeight:13,buildMetrics:!1,render:function(){Workspace.Label.superclass.render.apply(this,arguments),this.editable&&(this.editor=new Ext.ux.LabelEditor({labelSelector:"#"+this.getEl().id}),this.editor.attachTo(this.getEl(),this.object.workspace.getEl()),this.editor.on("complete",this.onSave,this)),this.element.unselectable(),this.buildMetrics&&(this.metrics=new Ext.util.TextMetrics(this.getEl()));var a=this.object.get(this.property);this.onChange(this.property,a),this.onMove()},format:function(a,b){return a},onSave:function(a,b){this.property&&this.object&&this.object.set(this.property,b)},applyTo:function(){Workspace.Label.superclass.applyTo.apply(this,arguments),this.object&&(this.object.on("change",this.onChange,this),this.object.on("resize",this.onMove,this))},updateSize:function(a){this.textHeight?this.getEl().setHeight(this.textHeight+this.padding):this.getEl()&&this.getEl().setHeight(this.metrics.getHeight(a)+this.padding)},onMove:function(){this.updateSize(this.getFormattedValue()),Workspace.Label.superclass.onMove.apply(this,arguments)},onChange:function(a,b){a==this.property&&!this.ignoreNext&&this.getEl()&&(b=this.getFormattedValue(b),this.getEl().update(b),this.onMove())},getFormattedValue:function(a){return this.format(a||this.object.get(this.property),this.object)},destroy:function(){this.object.un("change",this.onChange,this),this.object.un("resize",this.onMove,this),this.editor&&this.editor.destroy(),Workspace.Label.superclass.destroy.apply(this,arguments)}});
Ext.define("Workspace.tools.ResizeHandle",{constructor:function(a,b){Workspace.tools.ResizeHandle.superclass.constructor.call(this,a,b),Ext.applyIf(this,{location:"tl"}),this.item&&this.item.vectorElement&&(this.vectorElement=this.item.vectorElement),this.addEvents(),this.item.on("move",this.onItemMove,this),this.item.on("resize",this.onItemMove,this),this.proxy=this.item.getProxy(),this.proxy.on("move",this.onProxyMove,this),this.proxy.on("resize",this.onProxyMove,this),this.onItemMove()},extend:"Workspace.tools.Handle",drag:function(){var a=this.item.getBox(),b=this.getPosition();switch(this.location){case"tl":this.proxy.setBox(b.x,b.y,a.br.x,a.br.y);break;case"tr":this.proxy.setBox(a.tl.x,b.y,b.x,a.br.y);break;case"bl":this.proxy.setBox(b.x,a.tl.y,a.br.x,b.y);break;case"br":this.proxy.setBox(a.tl.x,a.tl.y,b.x,b.y)}},dragStartHandler:function(){this.item.applyProxy(),Workspace.tools.ResizeHandle.superclass.dragStartHandler.apply(this,arguments)},dragEndHandler:function(){if(this.dragging)return this.item.restoreFromProxy(),Workspace.tools.ResizeHandle.superclass.dragEndHandler.apply(this,arguments),!1},onItemMove:function(){this.move(this.item.getBox())},onProxyMove:function(){this.move(this.proxy.getBox())},move:function(a){switch(this.location){case"tl":this.setPosition(a.tl.x,a.tl.y);break;case"tr":this.setPosition(a.tr.x,a.tr.y);break;case"bl":this.setPosition(a.bl.x,a.bl.y);break;case"br":this.setPosition(a.br.x,a.br.y)}},destroy:function(){this.callParent(arguments),this.item.un("move",this.onItemMove,this),this.item.un("resize",this.onItemMove,this),this.proxy.un("move",this.onProxyMove,this),this.proxy.un("resize",this.onProxyMove,this)}});
Ext.define("Workspace.tools.PointerTool",{constructor:function(a,b){Ext.applyIf(b,{keyMap:[{key:[Ext.EventManager.BACKSPACE,Ext.EventManager.DELETE,Ext.EventManager.D],fn:this.deleteSelection,scope:this}]}),Workspace.tools.PointerTool.superclass.constructor.call(this,a,b),this.dragging=!1,this.selectorBand=!1,this.selectionBands=new Ext.util.MixedCollection,this.handles=new Ext.util.MixedCollection,this.inspectors=new Ext.util.MixedCollection,this.itemsWithinBand=new Ext.util.MixedCollection,this.mixins.highlightable.constructor.apply(this,arguments)},extend:"Workspace.tools.BaseTool",requires:["Workspace.tools.SelectionBand","Workspace.tools.SelectorBand","Workspace.tools.ResizeHandle"],mixins:{highlightable:"Workspace.tools.Highlightable"},proxified:!1,dragged:!1,threshold:10,dragCount:0,proxifyAllThreshold:5,click:function(a,b){b?a.stopEvent():(this.workspace.deselect(),a.stopEvent())},dblclick:function(a,b){console.log("Workspace.tools.PointerTool.click"),b.editor&&this.workspace.hasTool(b.editor)?(this.workspace.edit(b),a.stopEvent()):Ext.type(b.select)=="function"?(b.select(),a.stopEvent()):(this.workspace.deselect(),a.stopEvent())},mousedown:function(a,b){this.dragging=!0,pos=this.getAdjustedXY(a),this.x1=pos.x,this.y1=pos.y,this.selectorBand&&(this.selectorBand.destroy(),this.selectorBand=!1),b?(Ext.isFunction(b.select)&&!b.is("selected")&&(a.shiftKey?b.select():this.workspace.setSelection([b])),a.stopEvent()):(this.selectorBand=new Workspace.tools.SelectorBand(this.workspace,{x1:pos.x,y1:pos.y}),this.selectorBand.cacheRegions(),a.shiftKey||this.workspace.deselect(),this.itemsWithinBand.clear(),a.stopEvent())},mouseup:function(a,b){this.dragging=!1,this.selectorBand&&(this.selectorBand.destroy(),this.selectorBand=!1,a.stopEvent()),this.proxified&&this.deproxify()},mousemove:function(a,b){if(this.dragging){this.dragCount++;var c=this.workspace.getSelection();if(this.selectorBand){pos=this.getAdjustedXY(a),this.selectorBand.adjustBand(pos.x,pos.y);var d=this.selectorBand.getItemsWithin(),e=this.itemsWithinBand.clone(),f=new Ext.util.MixedCollection,b;for(var g=0,h=d.length;g<h;g++)b=d[g],this.itemsWithinBand.contains(b)||b.invertSelection(),f.add(b.getId(),b),e.removeAtKey(b.getId());e.eachKey(function(a,b){b.invertSelection()}),this.itemsWithinBand=f}else if(this.workspace.hasSelection()){this.proxified||this.proxify(c.length>this.proxifyAllThreshold),pos=this.getAdjustedXY(a);var i=pos.x-this.x1,j=pos.y-this.y1;this.x1=pos.x,this.y1=pos.y;for(var g=0,h=c.length;g<h;g++)Ext.isFunction(c[g].translate)&&(c[g].proxified?c[g].getProxy().translate(i,j):c[g].translate(i,j));a.stopEvent()}}},mouseover:function(a,b){this.mixins.highlightable.mouseover.apply(this,arguments)},mouseout:function(a,b){this.mixins.highlightable.mouseout.apply(this,arguments)},proxify:function(a){var b=this.workspace.getSelection();Ext.each(b,function(b){(a||b.get("movable")&&b.proxifyOnMove)&&b.proxify()}),this.proxified=!0},deproxify:function(){var a=this.workspace.getSelection();Ext.each(a,function(a){a.proxified&&a.deproxify(!a.get("movable"))}),this.proxified=!1},selectHandler:function(a){this.addSelectionBand(a),this.addHandles(a);var b=a.getId()},unselectHandler:function(a){this.removeSelectionBand(a.getId()),this.removeHandles(a.getId())},addSelectionBand:function(a){this.selectionBands.containsKey(a.getId())||this.selectionBands.add(a.getId(),new Workspace.tools.SelectionBand({item:a,workspace:this.workspace}))},removeSelectionBand:function(a){a?(!Ext.isString(a)&&Ext.isFunction(a.getId)&&(a=a.getId()),Ext.isString(a)&&this.selectionBands.containsKey(a)&&(this.selectionBands.get(a).destroy(),this.selectionBands.removeAtKey(a))):(this.selectionBands.each(function(a){a.destroy()}),this.selectionBands.clear())},onHandleDragEnd:function(a){var b=a.item,c,d;b&&(c=b.getId(),d=this.handles.get(c),c&&d&&this.setHandleBounds(b,d))},setHandleBounds:function(a,b){var c=a.getBox();Ext.apply(b.tl,{xMin:!1,xMax:c.tr.x,yMin:!1,yMax:c.bl.y}),Ext.apply(b.tr,{xMin:c.tl.x,xMax:!1,yMin:!1,yMax:c.bl.y}),Ext.apply(b.bl,{xMin:!1,xMax:c.tr.x,yMin:c.tl.y,yMax:!1}),Ext.apply(b.br,{xMin:c.tl.x,xMax:!1,yMin:c.tl.y,yMax:!1})},addHandles:function(a){if(!this.handles.containsKey(a.getId())){var b;if(Ext.isFunction(a.getBox)&&a.isResizable){var c=a.getBox();b={tl:new Workspace.tools.ResizeHandle(this.workspace,{location:"tl",item:a,x:c.tl.x,y:c.tl.y,item:a}),tr:new Workspace.tools.ResizeHandle(this.workspace,{location:"tr",item:a,x:c.tr.x,y:c.tr.y,item:a}),bl:new Workspace.tools.ResizeHandle(this.workspace,{location:"bl",item:a,x:c.bl.x,y:c.bl.y,item:a}),br:new Workspace.tools.ResizeHandle(this.workspace,{location:"br",item:a,x:c.br.x,y:c.br.y,item:a})},this.setHandleBounds(a,b)}else Workspace.Components.isWType(a,"Workspace.ConnectionObject")&&(b={left:new Workspace.tools.ConnectorHandle(this.workspace,{item:a,location:"left"}),right:new Workspace.tools.ConnectorHandle(this.workspace,{item:a,location:"right"})});this.handles.add(a.getId(),b)}},removeHandles:function(a){if(a){!Ext.isString(a)&&Ext.isFunction(a.getId)&&(a=a.getId());if(Ext.isString(a)&&this.handles.containsKey(a)){handles=this.handles.get(a);for(position in handles)handles[position].destroy();this.handles.removeAtKey(a)}}else this.handles.each(function(a){for(handle in a)Ext.isFunction(a[handle].destroy)&&a[handle].destroy()}),this.handles.clear()},destroyInspectors:function(a){},deleteSelection:function(a){this.workspace.deleteObjects(this.workspace.getSelection()),a.stop()},activate:function(){Workspace.tools.PointerTool.superclass.activate.call(this),this.workspace.on("select",this.selectHandler,this),this.workspace.on("unselect",this.unselectHandler,this),Ext.each(this.workspace.getSelection(),function(a){this.selectHandler(a)},this)},deactivate:function(){this.mixins.highlightable.mouseout.apply(this,arguments),Workspace.tools.PointerTool.superclass.deactivate.call(this),this.workspace.un("select",this.selectHandler,this),this.workspace.un("unselect",this.unselectHandler,this),this.selectorBand&&this.selectorBand.destoy(),this.removeHandles(),this.removeSelectionBand()}},function(){Workspace.Tools.register("pointer",Workspace.tools.PointerTool)});
Ext.define("Workspace.objects.ElementObject",{constructor:function(a,b){Workspace.objects.ElementObject.superclass.constructor.call(this,a,b),Ext.applyIf(this,{elementSpec:{}}),Ext.applyIf(this.elementSpec,{tag:"div",cls:""})},requires:["Workspace.Proxy"],alias:"Workspace.ElementObject",extend:"Workspace.objects.Object2d",wtype:"Workspace.objects.ElementObject",render:function(){this.element=this.workspace.addElement(this.elementSpec),this.element.addCls("workspace-object"),this.element.set({objectId:this.getId()}),this.element.position("absolute"),this.element.setLeft(this.x),this.element.setTop(this.y),this.element.setWidth(this.width),this.element.setHeight(this.height),this.buildEvents(),Workspace.objects.ElementObject.superclass.render.apply(this,arguments)},buildEvents:function(){this.element.un("click",this.click,this),this.element.un("dblclick",this.dblclick,this),this.element.un("mouseup",this.mouseup,this),this.element.un("mousedown",this.mousedown,this),this.element.un("mousemove",this.mousemove,this),this.element.un("mouseover",this.mouseover,this),this.element.un("mouseout",this.mouseout,this),this.element.on("click",this.click,this),this.element.on("dblclick",this.dblclick,this),this.element.on("mouseup",this.mouseup,this),this.element.on("mousedown",this.mousedown,this),this.element.on("mousemove",this.mousemove,this),this.element.on("mouseover",this.mouseover,this),this.element.on("mouseout",this.mouseout,this)},updateX:function(a){this.element.setLeft(a),Workspace.objects.ElementObject.superclass.updateX.call(this,a)},updateY:function(a){this.element.setTop(a),Workspace.objects.ElementObject.superclass.updateY.call(this,a)},updateWidth:function(a){this.element.setWidth(a),Workspace.objects.ElementObject.superclass.updateWidth.call(this,a)},updateHeight:function(a){this.element.setHeight(a),Workspace.objects.ElementObject.superclass.updateHeight.call(this,a)},getEl:function(){return this.element},destroy:function(){Ext.destroy(this.element),Workspace.objects.ElementObject.superclass.destroy.apply(this,arguments)}},function(){Workspace.reg("Workspace.objects.ElementObject",Workspace.objects.ElementObject)});
Ext.define("Workspace.objects.RichTextObject",{constructor:function(a,b){Workspace.objects.RichTextObject.superclass.constructor.call(this,a,b),Ext.apply(this.elementSpec,{tag:"div",cls:"textbox"}),this.expose("text",!0,!0,!0,!1),this.on("change:text",this.setText,this)},extend:"Workspace.objects.ElementObject",autoMaxWidth:300,wtype:"Workspace.objects.RichTextObject",isEditable:!0,isSelectable:!0,isResizable:!0,text:"",name:"New Textbox",iconCls:"text-icon",editor:"aloha",render:function(){this.elementSpec.html=this.get("text"),Workspace.objects.RichTextObject.superclass.render.call(this,arguments)},getText:function(){return this.get("text")},setText:function(a){this.text=a,this.getEl().update(a)},sizeToFit:function(){var a=Ext.util.TextMetrics.createInstance(this.getEl());text=this.get("text"),width=a.getWidth(text),width>this.autoMaxWidth?(this.set("width",this.autoMaxWidth),a.setFixedWidth(this.autoMaxWidth)):(this.set("width",width+20),a.setFixedWidth(width+20)),this.set("height",a.getHeight(text)+20)}},function(){Workspace.reg("Workspace.objects.RichTextObject",Workspace.objects.RichTextObject)});
Ext.define("Workspace.tools.TextTool",{requires:["Workspace.tools.AlohaTool","Workspace.objects.RichTextObject"],constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:{}}),Workspace.tools.TextTool.superclass.constructor.call(this,a,b),Ext.apply(this.parameters,{fill:"#fff",stroke:"#000"}),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},extend:"Workspace.tools.BaseTool",minWidth:75,maxWidth:!1,minHeight:20,maxHeight:!1,click:function(a,b){if(b&&b.wtype=="Workspace.RichTextObject")return this._item&&(this.workspace.deleteObjects(this._item),delete this._item),this.workspace.edit(b),!1;a.stopEvent()},dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.dragging=!0,this.proto&&(this.proto.remove(),this.proto=!1),a.stopEvent()},mouseup:function(a,b){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2);this._item=this.workspace.createObject({wtype:"Workspace.objects.RichTextObject",x:d.x,y:d.y,width:Workspace.Utils.bounds(d.width,this.minWidth,this.maxWidth),height:Workspace.Utils.bounds(d.height,this.minHeight,this.maxHeight)}),this.proto.remove(),this.workspace.edit(this._item)}a.stopEvent()},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2);this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this.anchor=d.anchor,delete d.anchor,this.proto.attr(d),a.stopEvent()}},createProto:function(a){var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.proto=this.workspace.paper.rect(this.x1,this.y1,0,0),this.proto.attr(this.parameters)},deactivate:function(){this.proto&&(this.proto.remove(),this.proto=!1),this._item=!1}},function(){Workspace.Tools.register("textbox",Workspace.tools.TextTool)});
Ext.define("Workspace.objects.MathEquationObject",{constructor:function(a,b){Ext.applyIf(b,{}),Workspace.objects.MathEquationObject.superclass.constructor.call(this,a,b),Ext.apply(this.elementSpec,{tag:"div",cls:"math"}),this.expose("latex",!0,!0,!0,!1)},extend:"Workspace.objects.ElementObject",wtype:"Workspace.objects.MathEquationObject",name:"New Equation",iconCls:"math-icon",isEditable:!0,isSelectable:!0,isResizable:!0,latex:"",editor:"mathquill",render:function(){Workspace.objects.MathEquationObject.superclass.render.call(this,arguments),this.showImage(this.get("latex"))},showImage:function(a){var b="http://latex.codecogs.com/gif.latex?";b+=encodeURIComponent(a),this.getEl().update('<img src="'+b+'" />')},activate:function(){var a=this.getEl();a.update(""),$(a.dom).mathquill("editable").mathquill("latex",this.get("latex"))},deactivate:function(){var a=this.getEl(),b=$(a.dom).mathquill("latex");this.set("latex",b),$(this.element.dom).mathquill("revert"),this.element=Ext.get(this.element.dom),this.showImage(b)}},function(){Workspace.reg("Workspace.objects.MathEquationObject",Workspace.objects.MathEquationObject)});
Ext.define("Workspace.tools.MathTool",{requires:["Workspace.tools.SelectorBand","Workspace.tools.MathQuillTool","Workspace.objects.MathEquationObject"],constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:{}}),Workspace.tools.MathTool.superclass.constructor.call(this,a,b),Ext.apply(this.parameters,{fill:"#fff",stroke:"#000"}),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},extend:"Workspace.tools.BaseTool",minWidth:75,maxWidth:!1,minHeight:30,maxHeight:!1,click:function(a,b){b&&b.wtype=="MathEquationObject"&&this.workspace.edit(b),a.stopEvent()},dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.dragging=!0,this.proto&&(this.proto.remove(),this.proto=!1),a.stopEvent()},mouseup:function(a,b){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2),e=this.workspace.createObject({wtype:"Workspace.objects.MathEquationObject",x:d.x,y:d.y,width:Workspace.Utils.bounds(d.width,this.minWidth,this.maxWidth),height:Workspace.Utils.bounds(d.height,this.minHeight,this.maxHeight)});this.proto.remove(),this.proto=!1,this.workspace.edit(e)}a.stopEvent()},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2);this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this.anchor=d.anchor,delete d.anchor,this.proto.attr(d),a.stopEvent()}},createProto:function(a){var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.proto=this.workspace.paper.rect(this.x1,this.y1,0,0),this.proto.attr(this.parameters)},deactivate:function(){this.proto&&(this.proto.remove(),this.proto=!1)}},function(){Workspace.Tools.register("math",Workspace.tools.MathTool)});
Ext.define("Workspace.objects.VectorObject",{alias:"Workspace.VectorObject",statics:{attrArray:["arrow-end","arrow-start","clip-rect","fill","fill-opacity","font","font-family","font-size","font-weight","height","opacity","path","r","rotation","rx","ry","src","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","translation","width","x","y"]},constructor:function(a,b){Workspace.objects.VectorObject.superclass.constructor.call(this,a,b),this.expose("fill",!0,!0,!0,!1),this.expose("fillOpacity",!0,!0,!0,!1),this.expose("opacity",!0,!0,!0,!1),this.expose("stroke",!0,!0,!0,!1),this.expose("strokeWidth",!0,!0,!0,!1),this.expose("strokeDasharray",!0,!0,!0,!1),this.expose("strokeLinecap",!0,!0,!0,!1),this.expose("strokeLinejoin",!0,!0,!0,!1),this.expose("strokeMiterlimit",!0,!0,!0,!1),this.expose("strokeOpacity",!0,!0,!0,!1),this.expose("path",!0,!0,!0,!1),this.expose("shape",!0,!0,!0,!1),this.expose("rotation",!0,!0,!0,!1),this.expose("arrowEnd",!0,!0,!0,!1),this.expose("arrowStart",!0,!0,!0,!1)},requires:["Workspace.Proxy"],extend:"Workspace.objects.Object2d",wtype:"Workspace.objects.VectorObject",iconCls:"vector",shape:"rect",arguments:[],fill:"#FFF",fillOpacity:1,stroke:"#000",strokeWidth:1,strokeDasharray:"",strokeLinecap:"square",strokeLinejoin:"",strokeMiterlimit:1,strokeOpacity:1,rotation:0,render:function(){this.buildObject(),this.buildEvents(),Workspace.objects.VectorObject.superclass.render.apply(this,arguments)},buildObject:function(){Ext.isFunction(this.workspace.paper[this.shape])&&(this.vectorElement=this.workspace.paper[this.shape].apply(this.workspace.paper,this.arguments),this.vectorElement.attr(this.attributes()),this.element=Ext.get(this.vectorElement.node),this.element.dom.className="workspace-object",this.element.set({objectId:this.getId()}),this.element.on("click",this.click,this),this.element.on("dblclick",this.dblclick,this),this.element.on("mouseup",this.mouseup,this),this.element.on("mousedown",this.mousedown,this),this.element.on("mousemove",this.mousemove,this),this.element.on("mouseover",this.mouseover,this),this.element.on("mouseout",this.mouseout,this))},buildEvents:function(){_.each(Workspace.objects.VectorObject.attrArrayCamel,function(a,b){this.on("change:"+b,_.bind(this.updateAttr,this,a))},this)},getTransform:function(){return"r"+(+this.get("rotation")||0)},updateAttr:function(a,b){if(a=="x"||a=="y"||a=="width"||a=="height"){if(!this.ignoreChangeDimensions){if(a=="x"||a=="y")b=Math.round(b)+.5;this.vectorElement.transform(""),this.vectorElement.attr(a,b),this.vectorElement.transform(this.getTransform())}return}if(a=="rotation"){this.vectorElement.transform(""),this.vectorElement.transform("r"+(+b||0));return}this.vectorElement.attr(a,b)},getHighlightProxy:function(){return Ext.create("Workspace.Proxy",Ext.applyIf({shape:this.shape,strokeWidth:this.strokeWidth+App.Stylesheet.Highlight.strokeWidth,workspace:this.workspace,stroke:App.Stylesheet.Highlight.fill},App.Stylesheet.Highlight))},toBack:function(){this.vectorElement.toBack()},insertBefore:function(a){a&&a.vectorElement&&this.vectorElement.insertBefore(a.vectorElement)},insertAfter:function(a){a&&a.vectorElement&&this.vectorElement.insertAfter(a.vectorElement)},updateObject:function(){this.vectorElement.attr(this.attributes())},updateX:function(a){Workspace.objects.VectorObject.superclass.updateX.apply(this,arguments),this.vectorElement.attr({x:Math.round(a)+.5})},updateY:function(a){Workspace.objects.VectorObject.superclass.updateY.apply(this,arguments),this.vectorElement.attr({y:Math.round(a)+.5})},updateWidth:function(a){Workspace.objects.VectorObject.superclass.updateWidth.apply(this,arguments),this.vectorElement.attr({width:a})},updateHeight:function(a){Workspace.objects.VectorObject.superclass.updateHeight.apply(this,arguments),this.vectorElement.attr({height:a})},getPosition:function(){return{x:this.getX(),y:this.getY()}},getDimensions:function(){return{width:this.getWidth(),height:this.getHeight()}},attributes:function(a){var b={};if(!a)var a=Workspace.objects.VectorObject.attrArray;for(var c=0,d=a.length;c<d;c++){var e=a[c],f=e.camelize().uncapitalize(),g=this.get(f);g&&(b[e]=g)}return b},getEl:function(){return this.vectorElement},destroy:function(){this.is("destroyed")||(this.vectorElement.remove(),this.callParent(arguments))}},function(){Workspace.reg("Workspace.objects.VectorObject",Workspace.objects.VectorObject),Workspace.objects.VectorObject.attrArrayCamel={},_.each(Workspace.objects.VectorObject.attrArray,function(a){Workspace.objects.VectorObject.attrArrayCamel[a.camelize().uncapitalize()]=a})});
Ext.define("Workspace.objects.Rectangle",{constructor:function(a,b){Workspace.objects.Rectangle.superclass.constructor.call(this,a,b),Ext.applyIf(this,{}),this.expose("r",!0,!0,!0,!1)},alias:"Workspace.VectorRectObject",extend:"Workspace.objects.VectorObject",wtype:"Workspace.objects.Rectangle",name:"New Rectangle",iconCls:"rect",shape:"rect",r:0,isResizable:!0,render:function(){this.arguments||(this.arguments=[this.x,this.y,this.width,this.height,this.r]),Workspace.objects.Rectangle.superclass.render.call(this)}},function(){Workspace.reg("Workspace.objects.Rectangle",Workspace.objects.Rectangle)});
Ext.define("Workspace.tools.RectTool",{constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:{}}),Workspace.tools.RectTool.superclass.constructor.call(this,a,b),Ext.apply(this.parameters,App.Stylesheet.Draw),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},extend:"Workspace.tools.BaseTool",requires:["Workspace.objects.Rectangle"],minWidth:10,maxWidth:!1,minHeight:10,maxHeight:!1,click:function(a,b){a.stopEvent()},dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.dragging=!0,this.proto&&this.proto.remove(),this.createProto(a)},mouseup:function(a,b){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2),e=this.workspace.createObject({wtype:"Workspace.objects.Rectangle",x:d.x,y:d.y,width:Workspace.Utils.bounds(d.width,this.minWidth,this.maxWidth),height:Workspace.Utils.bounds(d.height,this.minHeight,this.maxHeight)});this.workspace.setSelection([e]),this.proto.remove()}},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2);this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this.anchor=d.anchor,delete d.anchor,this.proto.attr(d)}},createProto:function(a){var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.proto=this.workspace.paper.rect(this.x1,this.y1,0,0),this.proto.attr(this.parameters)},deactivate:function(){}},function(){Workspace.Tools.register("rect",Workspace.tools.RectTool)});
Ext.define("Workspace.objects.Path",{extend:"Workspace.objects.VectorObject",constructor:function(a){this.callParent(arguments),this.expose("path",!0,!0,!0,!1),this.expose("points",!0,!0,!0,!1),this.expose("interpolator",!0,!0,!0,!1)},requires:["Workspace.objects.Interpolators"],alias:"Workspace.VectorPathObject",wtype:"Workspace.objects.Path",editor:"vector",name:"New Path",iconCls:"path",shape:"path",interpolator:"linear",isResizable:!1,path:[],points:[],fillOpacity:0,render:function(){(!this.path||this.points&&this.points.length>0)&&this.buildPath(this.points),this.arguments=[this.path],this.callParent(arguments),this.on("change:interpolator",this.buildPath,this),this.on("change:path",this.updatePath,this),this.on("change:points",this.buildPath,this),this.updateDimensions()},getHighlightProxy:function(){return Ext.create("Workspace.Proxy",Ext.applyIf({path:this.path,shape:this.shape,strokeWidth:this.strokeWidth+App.Stylesheet.Highlight.strokeWidth,workspace:this.workspace},App.Stylesheet.Highlight))},updateHighlightProxy:function(){this.highlightProxy&&(this.highlightProxy.path=this.path)},buildPath:function(){this.set("path",this.interpolate(this.get("points")))},interpolate:function(a){if(a){var b=this.get("interpolator");return _.isFunction(b)?["M",a[0][0],",",a[0][1]," ",b.call(this,a)].join(""):["M",a[0][0],",",a[0][1]," ",Workspace.objects.Interpolators[this.get("interpolator")](a)].join("")}return""},updatePath:function(a){this.path=a,this.vectorElement.attr({path:a}),this.updateDimensions(),this.updateHighlightProxy()},updateDimensions:function(){var a=this.vectorElement.getBBox(!0);this.set("x",a.x),this.set("y",a.y),this.set("height",a.height),this.set("width",a.width)},appendPoint:function(a){this.path.push(a),this.updatePath(this.path)},translate:function(a,b){var c;if(this.points&&this.points.length>0){var d=this.points;for(c=0;c<d.length;c++)d[c][0]+=a,d[c][1]+=b;this.set("points",d)}else this.path=Raphael.pathToRelative(this.path),this.path[0][1]=this.path[0][1]+a,this.path[0][2]=this.path[0][2]+b,this.updatePath(this.path);this.fireEvent("move",this.getX(),this.getY())},setPosition:function(a,b){var c=this.getDelta(a,b);this.translate(c.dx,c.dy)},setDimensions:function(a,b){}},function(){Workspace.reg("Workspace.objects.Path",Workspace.objects.Path)});
Ext.define("Workspace.tools.PencilTool",{constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{}),Workspace.tools.PencilTool.superclass.constructor.call(this,a,b),this.dragging=!1,this.currentPath=!1,this.currentShape=!1,this.currentPoints=!1},extend:"Workspace.tools.BaseTool",requires:["Workspace.objects.Path"],click:function(a,b){},dblclick:function(a,b){},mousedown:function(a,b){this.dragging=!0,pos=this.getAdjustedXY(a),this.currentPoints=[[pos.x,pos.y]],this.currentPath=[["M",pos.x,pos.y]],this.currentShape=this.workspace.paper.path(this.currentPath),this.currentShape.attr(App.Stylesheet.Draw),a.stopEvent()},mouseup:function(a,b){this.dragging=!1;var c=this.workspace.createObject(Workspace.objects.Path,{points:this.currentPoints,"stroke-width":"5px"});this.currentShape.remove(),this.currentPoints=!1,this.currentPath=!1,this.currentShape=!1,this.workspace.setSelection([c]),a.stopEvent()},mousemove:function(a,b){this.dragging&&(pos=this.getAdjustedXY(a),this.currentPath.push(["L",pos.x,pos.y]),this.currentPoints.push([pos.x,pos.y]),this.currentShape.attr({path:this.currentPath}))}},function(){Workspace.Tools.register("pencil",Workspace.tools.PencilTool)});
Ext.define("App.usr.viewer.Viewer",{extend:"App.usr.browser.Browser",editorType:"Viewer",iconCls:"application",autoHideLoadingMask:!0,mixins:{app:"App.ui.Application"},constructor:function(a){this.mixins.app.constructor.apply(this,arguments),this.url=Ext.urlAppend(App.getEndpoint("load"),Ext.Object.toQueryString({node:this.getPath()})),this.callParent(arguments)}});
Ext.define("App.usr.ms.Editor",{extend:"Ext.panel.Panel",layout:"border",border:!1,bodyBorder:!1,mixins:{app:"App.ui.Application",tip:"App.ui.TipHelper"},requires:["App.ui.D3Panel","App.ui.ButtonPicker","App.usr.seq.Editor","App.usr.dd.SequenceWindow","App.ui.SequenceThreader","App.ui.AddDomainButton","App.ui.StrandPreviewViewMenu","App.ui.ButtonPicker","App.usr.dil.SegmentStore","App.usr.dil.StrandStore","App.usr.dil.ComplexStore","App.usr.dil.SegmentsGrid","App.usr.dil.StrandsGrid","App.usr.dil.StrandPreviewGrid"],iconCls:"ms-icon",editorType:"MS",mode:"nupack",alias:"widget.multisubjectiveedit",requires:["App.ui.SequenceThreader","App.ui.NupackMenu"],showNupackButton:!0,showEditButton:!0,showSaveButton:!0,outputStrands:!1,dockedItems:[{xtype:"cite",cite:{authors:["John P. Sadowski","Peng Yin"],title:"Multisubjective: better nucleic acid design through fast identification and removal of undesired secondary structure",publication:"Unpublished"}}],multisubjective:!1,constructor:function(){this.mixins.app.constructor.apply(this,arguments),this.editComplexWindows={},this.callParent(arguments)},initComponent:function(){this.segmentStore=Ext.create("App.usr.dil.SegmentStore",{}),this.strandStore=Ext.create("App.usr.dil.StrandStore",{segmentStore:this.segmentStore}),this.complexStore=Ext.create("App.usr.dil.ComplexStore",{strandStore:this.strandStore}),Ext.apply(this,{tbar:[{xtype:"buttongroup",columns:3,title:"Design",items:[{xtype:"splitbutton",text:"Run",width:64,iconCls:"sequence-24",scale:"medium",iconAlign:"top",rowspan:2,handler:this.runMS,scope:this,menu:[{text:"Clean",iconCls:"clean",handler:this.clean,scope:this}]},Ext.create("App.ui.ButtonPicker",{text:"Input mode",value:"f",menu:{name:"inputMenu",defaults:{group:"inputMode",checked:!1},items:[{text:"Load sequences from DD file",value:"d",iconCls:"load-dd"},{text:"Load sequences from multiple DD files",value:"m",iconCls:"load-dd-multiple"},{text:"Fill with random bases",value:"f",checked:!0,iconCls:"random-bases"},{text:"Load sequences from NUPACK multiobjective file (.npo)",value:"n",iconCls:"load-npo"},{text:"Autofill from last NUPACK web submission",value:"a",iconCls:"load-np-web"},{text:"Load from NUPACK job number...",value:"j",iconCls:"load-np-job"}]}}),{xtype:"button",text:"Advanced options",iconCls:"wrench",handler:this.editExtraLines,scope:this},Ext.create("App.ui.ButtonPicker",{text:"Iteration mode",value:"o",menu:{name:"iterationMenu",defaults:{group:"iterationMode",checked:!1},items:[{text:"Run DD once",value:"o",checked:!0,iconCls:"run-dd-1"},{text:"Run DD 10 times",value:"l",iconCls:"run-dd-10"},{text:"Submit to NUPACK web server",value:"w",iconCls:"run-nupack-web"},{text:"Make random mutations in a loop",value:"r",iconCls:"run-random-bases"},{text:"No designer (analysis only)",value:"x",iconCls:"no-designer"}]}})]},{xtype:"buttongroup",columns:1,title:"Design",items:[{xtype:"splitbutton",text:"Load results",width:64,iconCls:"folder-open-24",scale:"medium",iconAlign:"top",rowspan:2,menu:{items:[{text:"Select file from which to load results",canActivate:!1,iconCls:"rename"},{xtype:"textfield",allowBlank:!1,iconCls:"rename",name:"msoFileNameField",indent:!0},{text:"Load results",iconCls:"folder-open",handler:function(){this.openMSO(this.msoFileNameField.getValue())},scope:this}]},handler:function(){this.openMSO(this.msoFileNameField.getValue())},scope:this}]},"->",{xtype:"buttongroup",columns:1,title:"Workspace",items:[Ext.create("App.ui.SaveButton",{app:this}),{text:"Help",iconCls:"help",handler:App.ui.Launcher.makeLauncher("help:multisubjective")}]}],items:[Ext.create("App.usr.dil.StrandsGrid",{name:"strandsGrid",store:this.strandStore,segmentStore:this.segmentStore,region:"south",collapsible:!0,titleCollapse:!0,title:"Strands",height:200,split:!0}),Ext.create("App.usr.dil.SegmentsGrid",{name:"segmentsGrid",store:this.segmentStore,title:"Segments",titleCollapse:!0,collapsible:!0,region:"east",width:200,split:!0}),{xtype:"panel",layout:"fit",region:"center",items:[Ext.create("App.usr.dil.StrandPreviewGrid",{name:"complexView",createTip:!0,store:this.complexStore,strandStore:this.strandStore,segmentStore:this.segmentStore,structureMode:"base",listeners:{itemdblclick:{fn:function(a,b,c){this.showEditComplexWindow(b,c)},scope:this}}})],bbar:[{text:"Add",iconCls:"plus",scope:this},{text:"Edit",iconCls:"pencil",scope:this},{text:"Delete",iconCls:"delete",scope:this,disabled:!0},"->",{xtype:"slider",fieldLabel:"Size",labelWidth:40,width:100,minValue:100,maxValue:400,value:200,increment:10,listeners:{changecomplete:{fn:function(a,b){this.complexView.setCellSize(b)},scope:this}}},"-",Ext.create("App.ui.StrandPreviewViewMenu",{view:null,name:"complexViewMenu"})]}]}),this.on("afterrender",this.loadFile,this),this.callParent(arguments),this.strandsGrid=this.down("[name=strandsGrid]"),this.segmentsGrid=this.down("[name=segmentsGrid]"),this.complexView=this.down("[name=complexView]"),this.down("[name=complexViewMenu]").view=this.complexView,this.iterationMenu=this.down("[name=iterationMenu]"),this.inputMenu=this.down("[name=inputMenu]"),this.msoFileNameField=this.down("[name=msoFileNameField]"),this.highlightManager=Ext.create("App.usr.dil.HighlightManager",{segmentStore:this.segmentStore,strandStore:this.strandStore,complexStore:this.complexStore,segmentsGrid:this.segmentsGrid,strandsGrid:this.strandsGrid,complexView:this.complexView}),this.on("afterrender",function(){this.highlightManager.afterrender()},this)},onLoad:function(){this.data||(this.data=""),this.loadLibrary(this.data),_.defer(_.bind(this.refresh,this)),this.msoFileNameField.setValue(this.getMSOFileName())},refresh:function(){this.complexView.refresh()},loadLibrary:function(a){var b=this.complexStore,c=this.strandStore,d=this.segmentStore,e=d3.scale.category20(),f=DNA.structureSpec(CodeMirror.tokenize(a,{name:"nupack",ms:!0}));this.extraLines=f.others,d.colorGenerator=e;var g=[],h,i;for(h in f.domains)i=f.domains[h],g.push({identity:h,sequence:i,color:e(h)});d.add(g);var j=[],k=[],l,m,n,o;for(var m in f.strands)n=f.strands[m],c.add({name:m,sequence:"AAAAA",spec:n,polarity:1});var p=d.getSegmentMapWithComplements();for(var l in f.complexes){var q=f.complexes[l]||"";q=_.compact(q.join(" ").split(" ")),o=DNA.DUtoDotParen(f.structures[l]),structMap=DNA.dotParenToBaseMap(o),k=[],m=[];if(f.strands[q[0]])k=q;else for(var r=0,s=0;r<q.length;r++){var t=q[r];s+=p[t].length,m.push(t);if(structMap.breaks[s]||r==q.length-1){var u=l+"_"+(k.length+1);k.push(u),c.add({name:u,sequence:"AAAAA",spec:m.join(" "),polarity:1}),m=[]}}j.push({name:l,polarity:1,structure:o,strands:k})}b.add(j),console.log([g,k,j])},printExtraLines:function(){return _.compact(_.map(this.extraLines||[],function(a){return a.length==0?"":a.length==1&&a[0][1]=="#`"?"":_.pluck(_.compact(a),1).join(" ")})).join("\n")},editExtraLines:function(){var a=this,b=a.printExtraLines();this.editExtraLinesWindow||(this.editExtraLinesWindow=Ext.create("App.ui.EditorWindow",{helpText:"Enter extra data to be passed to Multisubjective",mode:"txt",value:"",buttonHandler:function(){var b=this.getValue();a.updateExtraLines(b)}})),this.editExtraLinesWindow.show(),this.editExtraLinesWindow.setValue(b)},updateExtraLines:function(a){this.extraLines=CodeMirror.tokenize(a,{name:"nupack",ms:!0})},buildMS:function(){var a=this.segmentStore.getRange(),b=this.strandStore.getRange(),c=this.complexStore.getRange(),d={},e=[],f={},g={},h=[],i=[],j=[];j.push(this.printExtraLines()),j.push("#`");for(var k=0;k<a.length;k++){var l=a[k],m={identity:l.get("identity"),sequence:l.get("sequence"),color:l.get("color")};d[m.identity]=m.sequence,j.push("domain "+m.identity+" = "+m.sequence)}j.push("#`\n");for(var k=0;k<b.length;k++){var l=b[k],n,o,p=_.clone(l.getParsedSpec()),q=[],r=[];for(var s=0;s<p.length;s++)q=q.concat(p[s].segments);for(var s=0;s<q.length;s++)r.push(DNA.printIdentifier(q[s]));o=l.get("name"),n={name:o,segments:q},f[o]=n,g[o]=r.join(" "),this.outputStrands&&j.push(n.name+" = "+g[o])}j.push("\n");for(var k=0;k<c.length;k++){var t=c[k],u=t.getStrands(),v,w;w={name:t.get("name"),structure:t.get("structure"),polarity:t.get("polarity"),strands:_.map(u,function(a){return f[o]})},this.outputStrands?v=u.join(" "):v=_.map(u,function(a){return g[a]?g[a]:""}).join(" "),j.push("structure "+w.name+" = "+DNA.dotParenToDU(w.structure)),j.push(w.name+".seq = "+v)}return j.join("\n")},getSaveData:function(){return this.buildMS()},updateFromMSO:function(a){var b=_.reduce(a.blocks,function(a,b){return a[b.name]=b.sequence,a},{});this.complexView.pauseUpdates=!0,this.segmentStore.updateSegments(b);var c=_.reduce(a.immutable,function(a,b){return a[b]=!0,a},{}),d=_.reduce(a.desired,function(a,b){return a[b.pair[1]]||(a[b.pair[0]]=b.pair[1]),a},{}),e={},f=_.reduce(a.undesired,function(a,b){var c=_.clone(b);c.target=b.pair[1],a[b.pair[1]]||(a[b.pair[0]]=c);if(b.changed)for(var d in b.changed)e[d]||(e[d]={}),e[d].base=b.changed[d],e[d].reason="undesired";return a},{}),g=_.reduce(a.prevented,function(a,b){for(var c=b.range[0];c<b.range[1];c++)a[c]=b;return a},{}),h={};for(var i=0;i<a.strands.length;i++){var j=a.strands[i],k=j.range[0],l={bases:{},links:[]};for(var m=k,n=0;m<j.range[1];m++,n++){if(f[m]){var o={source:m-k,target:f[m].target-k,type:"undesired"};f[m].changed&&(o.changed=f[m].changed),l.links.push(o)}if(c[m]||g[m]||e[m])l.bases[n]={};c[m]&&(l.bases[n].immutable=!0),g[m]&&(l.bases[n].prevented=g[m].identity),e[m]&&(l.bases[n].changed=e[m])}h[j.name]=l;var p=this.complexStore.findRecord("name",j.name);p&&p.set("extraData",l)}this.complexView.pauseUpdates=!1,this.refresh()},loadMSO:function(a){try{var b=JSON.parse(a)}catch(c){App.msg("Unable to update Multisubjective view","Could not parse output from multisubjective."),console.log(c)}b&&this.updateFromMSO(b)},getMSOFileName:function(){var a=this.document,b=a.getBasename(),c="mso";return App.Path.repostfix(b,c)},openMSO:function(a){var b=this.document,c,d;d=a||this.getMSOFileName(),c=b.getSiblingByName(d),c&&c.loadBody({success:function(a){this.loadMSO(a)},failure:function(a){App.msg("Unable to update Multisubjective view","Could not load multisubjective output file")},scope:this})},runMS:function(){var a=this,b=this.buildMS(),c="";this.inputMenu.items.each(function(a){a.checked&&(c+=a.value)}),this.iterationMenu.items.each(function(a){a.checked&&(c+=a.value)}),console.log(b);var d=App.runTask("Multisubjective",{node:this.getDocumentPath(),text:b,mode:c,action:"default"},function(a,b,c){c?App.msg("Multisubjective completed","Click for details",{handler:"console"}):App.msg("Multisubjective failed","Click for details",{handler:"console"})},this,{loadOnEnd:{files:[function(){var b="mso",c;return c=App.path.repostfix(a.getDocumentPath(),b),c}()],callback:function(a){var b=a[0];b&&b.loadBody({success:function(a){this.loadMSO(a)},failure:function(a){App.msg("Unable to update Multisubjective view","Could not load multisubjective output file")},scope:this})},scope:this}});d?App.msg("Multisubjective started","Click for details",{handler:"console"}):App.msg("Multisubjective failed to start","Click for details",{handler:"console"})},clean:function(){App.runTask("Multisubjective",{node:this.getDocumentPath(),action:"clean"})}});
Ext.define("App.usr.enum.Editor",{extend:"App.usr.text.Editor",iconCls:"enum-icon",editorType:"Enum",title:"Enumerator",mode:"pepper",alias:"widget.enumedit",showEditButton:!0,showSaveButton:!0,dockedItems:[{xtype:"cite",cite:{authors:["Karthik Sarma","Brian Wolfe","Erik Winfree"],title:"Domain-based reaction enumeration",publication:"Unpublished"}}],multisubjective:!1,initComponent:function(){this.extraTbarItems=[],this.condense=Ext.create("Ext.menu.CheckItem",{text:"Condense output",name:"condense",checked:!1});var a=this.extraTbarItems.concat([{text:"Run Enumerator",iconCls:"enum-icon",handler:this.makeEnumHandler("enjs"),scope:this,xtype:"splitbutton",menu:[{text:"ENJS",handler:this.makeEnumHandler("enjs"),iconCls:"enum-icon",scope:this},{text:"PIL",handler:this.makeEnumHandler("pil"),iconCls:"pil",scope:this},{text:"Legacy",handler:this.makeEnumHandler("legacy"),iconCls:"gear",scope:this},{text:"SBML",handler:this.makeEnumHandler("sbml"),iconCls:"sbml",scope:this},{text:"Graph (EPS)",handler:this.makeEnumHandler("graph"),scope:this},"-",this.condense]}]);this.showEditButton&&a.push({text:"Edit",iconCls:"pencil",ref:"editButton",menu:[{text:"Thread segments to sequences",handler:this.threadStrands}]}),this.showSaveButton&&(a=a.concat(["->",Ext.create("App.ui.SaveButton",{app:this})])),Ext.apply(this,{tbar:a}),this.callParent(arguments)},makeEnumHandler:function(a){return function(){this.runEnum(a)}},runEnum:function(a){var b=this.doc.getDocumentPath(),c=App.path.addExt(App.path.removeExt(b,"enum")+"-enum",a);App.runTask("Enumerator",{node:this.getDocumentPath(),mode:a,condense:this.condense.checked},function(a){a?Ext.msg("Enumerator","Reaction enumeration completed."):Ext.msg("Enumerator","Reaction enumeration failed. Click for details.",{handler:"console"})},this,{openOnEnd:[c]}),Ext.msg("Enumerator","Reaction enumeration started.")},threadStrands:function(){var a=Ext.create("App.ui.SequenceThreader");a.show(),a.setStrands(this.getSelection())}});
Ext.define("App.ui.TaskManager",{extend:"Ext.panel.Panel",initComponent:function(){this.grid=Ext.create("Ext.grid.Panel",{border:!1,bodyBorder:!1,store:App.TaskRunner.taskStore,columns:[{dataIndex:"tool",renderer:function(a){return'<div style="width:18px;height:18px;" class="'+App.TaskRunner.getToolProperty(a,"iconCls")+'">&nbsp;</div>'}},{header:"Tool",dataIndex:"tool",flex:1},{header:"Date Submitted",dataIndex:"startDate"},{header:"Date Completed",dataIndex:"endDate"}]}),Ext.apply(this,{items:[this.grid]}),this.callParent(arguments)}});
Ext.define("App.ui.Dashboard",{extend:"Ext.panel.Panel",requires:["App.ui.Attribution"],overflowY:"auto",initComponent:function(){Ext.apply(this,{title:"Dashboard",bodyStyle:"padding:10px",iconCls:"dash",autoLoad:{url:"html/dashboard.html",callback:this.initDashboard,scope:this}}),App.on("userNameChanged",function(a,b){var c=Ext.get("fp-user-name");c&&c.update(App.User.name+" ("+App.User.email+")")}),this.callParent()},initDashboard:function(){if(App.User.isLoggedIn()){var a=Ext.get("fp-user-name");a&&a.update(App.User.name+" ("+App.User.email+")");if(App.User.isGuest()){var b=Ext.get("guest-user-welcome");b&&b.show()}}Ext.get("fp-citations").update(App.ui.Attribution.printAllCitations());var c=Ext.create("Ext.panel.Panel",{renderTo:Ext.get("dashboard-quickstart"),width:260,height:270,baseCls:"x-plain",layout:{type:"table",columns:3},defaults:{xtype:"button",scale:"medium",iconAlign:"top",width:70,height:50},items:[{xtype:"panel",baseCls:"x-plain",height:15,html:"<h3>Design</h3>"},{xtype:"panel",baseCls:"x-plain",height:15,html:"<h3>Testing</h3>",colspan:2,width:165,style:"text-align: center"},{text:"Behaviors",iconCls:"behavior-24",menu:[{text:"Nodal",iconCls:"nodal",menu:Ext.create("App.ui.CreateMenu",{smartCreate:!0,defaultType:"nodal",autoCreateMenu:!1})},{text:"Pepper",iconCls:"pepper",handler:App.ui.Launcher.makeLauncher("pepper")},{text:"Chemical Reaction Network (CRN)",iconCls:"crn",disabled:!0,handler:App.ui.Launcher.makeLauncher("crn")}]},{text:"Enumerate",iconCls:"enumerate-24",disabled:!0},{text:"Verify",iconCls:"verify-24",disabled:!0},{xtype:"panel",baseCls:"x-plain",height:30,cls:"overflowing",cellCls:"overflowing-top",layout:{type:"hbox",align:"middle"},items:[{xtype:"label",html:"&nbsp;&nbsp;&nbsp;&darr;&nbsp;&nbsp;&nbsp;"},{xtype:"button",iconCls:"domains",text:"Domain Design"}]},{xtype:"panel",baseCls:"x-plain",height:30},{xtype:"panel",baseCls:"x-plain",height:30},{text:"Domains",iconCls:"domains-24",menu:[{text:"Strand editor",handler:App.ui.Launcher.makeLauncher("strandedit"),iconCls:"domains",menu:Ext.create("App.ui.CreateMenu",{smartCreate:!0,defaultType:"dil",autoCreateMenu:!1})},{text:"Pepper Intermediate Language (PIL)",handler:App.ui.Launcher.makeLauncher("pepper"),iconCls:"pil"},{text:"Secondary Structure design",iconCls:"secondary"}]},{text:"Enumerate",iconCls:"enumerate-secondary-24",handler:App.ui.Launcher.makeLauncher("enumedit"),disabled:!0},{text:"Simulate",iconCls:"simulate-24",menu:[{text:"SBML",iconCls:"sbml",handler:App.ui.Launcher.makeLauncher("sbml")}]},{xtype:"panel",baseCls:"x-plain",height:30,cls:"overflowing",cellCls:"overflowing-top",layout:{type:"hbox",align:"middle"},items:[{xtype:"label",html:"&nbsp;&nbsp;&nbsp;&darr;&nbsp;&nbsp;&nbsp;"},{xtype:"button",text:"Sequence Design",iconCls:"sequence",menu:[{text:"Web DD",iconCls:"dd",handler:App.ui.Launcher.makeLauncher("dd")},{text:"NUPACK Multi-objective designer",iconCls:"nupack-icon",handler:function(){var a=Ext.create("App.ui.nupack.DesignWindow");a.show()}},{text:"Multisubjective",iconCls:"ms-icon",handler:App.ui.Launcher.makeLauncher("msedit")},{text:"Spurious C",iconCls:"spuriousC spurious",disabled:!0}]}]},{xtype:"panel",baseCls:"x-plain",height:30},{xtype:"panel",baseCls:"x-plain",height:30},{text:"Sequences",iconCls:"sequence-24",menu:[{text:"Sequence editor",iconCls:"sequence",handler:App.ui.Launcher.makeLauncher("sequence")},{text:"NUPACK",iconCls:"nupack-icon",handler:App.ui.Launcher.makeLauncher("nupack"),menu:Ext.create("App.ui.NupackMenu")},{text:"Mfold",iconCls:"mfold-icon",menu:[{text:"QuikFold",iconCls:"mfold-icon",handler:function(){var a=Ext.create("App.ui.mfold.QuikFoldWindow");a.show()}}]},{text:"Vienna RNA",iconCls:"tbi",menu:[{text:"RNAfold Server",iconCls:"tbi",handler:function(){var a=Ext.create("App.ui.vienna.RNAfoldWindow");a.show()}}]}]},{text:"Simulate",iconCls:"simulate-24",colspan:2,width:165,disabled:!0}]})}});
Ext.define("App.usr.nupack.Editor",{extend:"App.usr.text.Editor",iconCls:"nupack",editorType:"NUPACK",mode:"nupack",alias:"widget.nupack",requires:["App.ui.SequenceThreader","App.ui.NupackMenu"],showNupackButton:!0,showEditButton:!0,showSaveButton:!0,multisubjective:!1,showCite:!0,cite:"zadeh_etal_2011",initComponent:function(){this.multisubjective&&(this.mode={name:"nupack",multisubjective:!0}),this.extraTbarItems=this.extraTbarItems||[];var a=this.extraTbarItems.concat([]);this.showNupackButton&&a.push({xtype:"splitbutton",ref:"nupackButton",text:"Open NUPACK",iconCls:"nupack-icon",handler:App.ui.Launcher.makeLauncher("nupack"),menu:Ext.create("App.ui.NupackMenu",{listeners:{designwindow:{fn:this.populateDesignWindow,scope:this}}})}),this.showEditButton&&a.push({text:"Edit",iconCls:"pencil",ref:"editButton",menu:[{text:"Thread segments to strands",iconCls:"thread-sequences",handler:this.threadStrands,scope:this}]}),this.showSaveButton&&(a=a.concat(["->",Ext.create("App.ui.SaveButton",{app:this})])),Ext.apply(this,{tbar:a,bbar:Ext.create("Ext.ux.statusbar.StatusBar",{ref:"statusBar",items:[{xtype:"tbtext",baseText:"Lines: ",text:"Lines: ",name:"lineNo"},"-",{xtype:"tbtext",baseText:"Cols: ",text:"Cols: ",name:"colNo"}]})}),this.showCite&&Ext.apply(this,{dockedItems:[{xtype:"cite",cite:this.cite}]}),this.callParent(arguments),this.selField=this.down("[name=selField]"),this.lineNo=this.down("[name=lineNo]"),this.colNo=this.down("[name=colNo]"),this.editor.on("cursorchange",this.updateStatusBar,this,{buffer:500}),this.editor.on("cursorchange",this.updateHelp,this)},updateStatusBar:function(){var a=this.getSelection(),b=this.getCursorRange();b[0].line!=b[1].line||b[0].ch!=b[1].ch?(this.lineNo.setText("Lines: "+[b[0].line," &rarr; ",b[1].line," (",Math.abs(b[1].line-b[0].line)+1,")"].join("")),this.colNo.setText("Cols: "+[b[0].ch," &rarr; ",b[1].ch," (",a.length,")"].join(""))):(this.lineNo.setText("Line: "+b[0].line),this.colNo.setText("Col:"+b[0].ch))},updateHelp:function(){},populateDesignWindow:function(a,b){b.updateDesign(this.getValue())},threadStrands:function(){var a=Ext.create("App.ui.SequenceThreader");a.show();var b=_.chain(this.getValue().split("\n")).map(function(a){var b=a.match(/domain\s+([\w\d]+)\s*[=:]\s*([A-Za-z]+)/);return b!=null&&b.length>=3?b[1]+" : "+b[2]:null}).compact().value().join("\n"),c=_.chain(this.getValue().split("\n")).map(function(a){var b=a.match(/strand\s+([\w\d]+)\s*[=:]\s*(.+)/);return b!=null&&b.length>=3?b[1]+" : "+b[2]:null}).compact().value().join("\n");a.setSequences(b),a.setStrands(c)}});
Ext.define("App.usr.sbml.Editor",{extend:"App.usr.text.Editor",iconCls:"document-sbml",editorType:"SBML",title:"SBML",mode:"xml",alias:"widget.sbmledit",dockedItems:[{xtype:"cite",cite:"sbml_2003"}],url:"http://sbml.org/validator/",initComponent:function(){this.extraTbarItems=this.extraTbarItems||[];var a=[{text:"Validate SBML",href:this.url,iconCls:"tick"},"->",{text:"SBML Reference",iconCls:"help",href:"http://sbml.org/Basic_Introduction_to_SBML"},Ext.create("App.ui.SaveButton",{app:this})];Ext.apply(this,{tbar:a}),this.form=Ext.create("Ext.form.Basic",this,{}),this.callParent(arguments)},validateSBML:function(){this.form.doAction("standardsubmit",{params:this.getParams(),target:"_blank",url:this.url,clientValidation:!1,method:"post",enctype:"multipart/form-data"})},getParams:function(){return{file:this.getValue(),output:"XHTML"}}});
Ext.define("App.usr.pepper.Editor",{extend:"App.usr.text.Editor",title:"Pepper",initComponent:function(){Ext.applyIf(this,{tbar:[{text:"Save",iconCls:"save",handler:function(){this.saveFile()},scope:this},{text:"Compile",iconCls:"compile",handler:function(){App.runTask("Pepper",{node:this.getDocumentPath()})},scope:this}]}),this.callParent(arguments)}});
Ext.define("App.usr.nupack.Results",{extend:"Ext.panel.Panel",requires:["App.usr.nupack.Panel"],template:'<div class="app-nupack-complex-wrap"><div><span class="app-nupack-complex">Complex: {complex}</span>&nbsp;|&nbsp;<span class="app-nupack-order">Order: {order}</span></div><div class="app-nupack-force"></div></div>',mixins:{app:"App.ui.Application"},html:'<fieldset class="x-fieldset x-fieldset-default"><legend class="x-fieldset-header x-fieldset-header-default nupack-strand-summary-title">Distinct strands</legend><pre class="nupack-strand-summary cm-s-default"></pre></fieldset><fieldset class="x-fieldset x-fieldset-default"><legend class="x-fieldset-header x-fieldset-header-default nupack-strand-summary-title">Complex Minimum Free Energy</legend><div class="nupack-mfe-summary"></div></fieldset><div class="nupack-concentration-summary"></div>',bodyPadding:5,autoScroll:!0,requires:[""],constructor:function(a){this.callParent(arguments),this.mixins.app.constructor.apply(this,arguments)},initComponent:function(){this.callParent(arguments),this.on("afterrender",this.loadFile,this)},onLoad:function(){if(this.data){this.xt||(this.xt=new Ext.XTemplate(this.template)),this.sourceData=Ext.decode(this.data);var a=_.reduce(this.sourceData.ocx_mfe,function(a,b){var c=Math.abs(parseFloat(b.concentration)*1e3);return c>a&&(a=c),a},0),b=_.max(_.map(this.sourceData.ocx_mfe,function(a){return a.strands.length})),c=_.sortBy(this.sourceData.ocx_mfe,function(a){return-parseFloat(a.concentration)*1e3}),d=_.max(_.map(this.sourceData.ocx_mfe,function(a){return Math.abs(parseFloat(a.energy))})),e=this.getEl().down(".nupack-strand-summary"),f=this.sourceData.strandNames?this.sourceData.strandNames:_.range(1,this.sourceData.strands.length+1);CodeMirror.runMode(_.map(_.zip(f,this.sourceData.strands),function(a){return a.join(" : ")}).join("\n"),"sequence",e.dom),this.getEl().down(".nupack-strand-summary-title").update(this.sourceData.strands.length+" distinct strands");var g=600,h=10*c.length,i=pv.Scale.linear(0,d).nice().range(0,g),j=pv.Scale.ordinal(pv.range(0,c.length)).splitBanded(0,h,.8),k=(new pv.Panel).canvas(this.getEl().down(".nupack-mfe-summary").dom).width(g).height(h).top(10).bottom(20).left(50).right(10),l=k.add(pv.Bar).data(c).top(function(){return j(this.index)}).height(j.range().band).left(0).width(function(a){return i(Math.abs(parseFloat(a.energy)))});l.anchor("right").add(pv.Label).textStyle("white").text(function(a){return a.energy}),l.anchor("left").add(pv.Label).textMargin(5).textAlign("right").text(function(a){return a.strandNames.join("+")}),k.add(pv.Rule).data(i.ticks(5)).left(i).strokeStyle(function(a){return a?"rgba(255,255,255,.3)":"#000"}).add(pv.Rule).bottom(0).height(5).strokeStyle("#000").anchor("bottom").add(pv.Label).text(i.tickFormat),k.render();var m=_.map(c,Ext.bind(function(b){return Ext.create("App.usr.nupack.Panel",{xtype:"resultspanel",complexData:b,maxConcentration:a,renderTo:this.body})},this))}}},function(){});
Ext.define("App.ui.RefHelper",{init:function(){_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this)}});
Ext.define("App.usr.nodal.ws.objects.BuildManager",{extend:"Workspace.objects.Object",errorClsName:"dynaml-error-message",statics:{dynaml:{domainProperties:["name","identity","role"],nodeProperties:["name","motif","polarity"],motifProperties:["name","dynaml"]}},constructor:function(){this.callParent(arguments),this.workspace.buildManager=this,this.nodes=[],this.workspace.on("create",this.onCreate,this),this.workspace.on("destroy",this.onDestroy,this),this.addEvents("needsrebuild","beforerebuild","rebuild","error"),this.on("needsrebuild",this.buildRealtime,this,{buffer:1e3})},onCreate:function(a){if(!a)return;a.isWType("App.usr.nodal.ws.objects.Node")?(this.nodes.push(a),_.each(App.usr.nodal.ws.objects.BuildManager.dynaml.nodeProperties,function(b){a.on("change:"+b,this.needsRebuild,this)},this),this.needsRebuild()):a.isWType("App.usr.nodal.ws.objects.Complement")?this.needsRebuild():a.isWType("App.usr.nodal.ws.objects.Motif")&&(this.needsRebuild(),_.each(App.usr.nodal.ws.objects.BuildManager.dynaml.motifProperties,function(b){a.on("change:"+b,this.needsRebuild,this)},this))},onDestroy:function(a){if(!a)return;a.isWType("App.usr.nodal.ws.objects.Node")?(this.nodes=_.without(this.nodes,a),_.each(App.usr.nodal.ws.objects.BuildManager.dynaml.nodeProperties,function(b){a.un("change:"+b,this.needsRebuild,this)},this),this.needsRebuild()):a.isWType("App.usr.nodal.ws.objects.Complement")?this.needsRebuild():a.isWType("App.usr.nodal.ws.objects.Motif")&&(this.needsRebuild(),_.each(App.usr.nodal.ws.objects.BuildManager.dynaml.motifProperties,function(b){a.un("change:"+b,this.needsRebuild,this)},this))},needsRebuild:function(){this.fireEvent("needsrebuild")},buildRealtime:function(){try{var a=this.serializeDynaml();this.lastDynaml=JSON.parse(JSON.stringify(a)),this.fireEvent("beforerebuild",this,a);var b;b=App.dynamic.Compiler.compileLibrary(a),this.lastLibrary=b,this.fireEvent("rebuild",this,b);var c=_.chain(a.motifs||[]).map(function(a){return _.find(b.motifs,function(b){return b.name==a.name})}).compact().value();this.syncCustomMotifStore(c),_.each(this.workspace.getAllObjects(),function(a){a.isWType("App.usr.nodal.ws.objects.Node")&&a.hideError()})}catch(d){d.nodes&&_.each(d.nodes,function(a){var b=this.findWorkspaceObject("node",a);b&&b.highlightError()},this),d.ports&&_.each(d.ports,function(a){var b=this.findWorkspaceObject("port",a);b&&b.highlightError()},this),this.fireEvent("error",d.message,d),this.lastError=d}},syncCustomMotifStore:function(a,b){b=b||!1,_.each(a,function(a){var b=this.customMotifStore.findRecord("number",a.getName());b?b.set("spec",a):this.customMotifStore.add({number:a.getName(),spec:a})},this)},findWorkspaceObject:function(a,b){var c;b&&b.getName?c=b.getName():_.isObject(b)&&b.name?c=b.name:_.isString(b)&&(c=b);if(!c)return null;switch(a){case"node":return this.workspace.findObjectBy(function(a){return a.isWType("App.usr.nodal.ws.objects.Node")&&a.get("name")==c});case"connection":return null;case"port":return!1;case"motif":return this.workspace.findObjectBy(function(a){return a.isWType("App.usr.nodal.ws.objects.Motif")&&a.get("name")==c})}},getRealtime:function(a,b,c){if(!this.lastLibrary)return null;switch(a){case"strand":var d=this.lastLibrary.getStrand(b);if(!d)return null;switch(c){case"this":return d;case"domains":return d.getDomains();case"polarity":return d.getPolarity();case"absolutePolarity":return d.getAbsolutePolarity();case"dynaml":return this.lastDynaml&&this.lastDynaml.strands?_.find(this.lastDynaml.nodes,function(a){return a.name==b}):!1;default:return d[c]}break;case"node":var e=this.lastLibrary.getNode(b);if(!e)return null;switch(c){case"this":return e;case"domains":return e.getDomains();case"strands":return e.getStrands();case"polarity":return e.getPolarity();case"dynaml":return this.lastDynaml&&this.lastDynaml.nodes?_.find(this.lastDynaml.nodes,function(a){return a.name==b}):!1;default:return e[c]}break;case"motif":var f=this.lastLibrary.getMotif(b);if(!f)return null;switch(c){case"this":return f;case"dynaml":return this.lastDynaml&&this.lastDynaml.motifs?_.find(this.lastDynaml.motifs,function(a){return a.name==b}):!1;default:return e[c]}}},nodeIndex:0,getNextNodeName:function(){var a;do this.nodeIndex++,a="n"+this.nodeIndex;while(!!this.workspace.findObjectBy(function(b){return b.get("name")==a}));return a},motifIndex:0,getNextMotifName:function(){var a;do this.motifIndex++,a="c"+this.motifIndex;while(!!this.workspace.findObjectBy(function(b){return b.get("name")==a}));return a},buildDynaml:function(a,b){var c=this.workspace,d=[],e=[],f=[],g={},h={},i={};return b=b||!1,_.each(a,function(a){if(a.isWType("App.usr.nodal.ws.objects.Node"))h[a.get("name")]=a,e.push(a),a.get("motif")&&d.push(a.get("motif"));else if(a.isWType("App.usr.nodal.ws.objects.Complement")){var b=a.get("leftObject"),c,j;if(!b)return;c=b.getParent();if(!c)return;j=c.getId(),g[j]||(g[j]=[]),g[j].push(a)}else a.isWType("App.usr.nodal.ws.objects.Motif")&&(i[a.get("name")]=a,f.push(a))}),d=_.chain(d).uniq().filter(function(a){return!i[a]}).map(function(a){return{type:"motif",name:a}}).value(),f=_.chain(f).map(function(a){var b=a.get("nodes");if(b&&b.length>0){var c=this.buildDynaml(a.getChildren(),!0);return _.reduce(App.usr.nodal.ws.objects.BuildManager.dynaml.motifProperties,function(b,c){return a.has(c)&&(b[c]=a.get(c)),b},c)}if(a.get("dynaml")){var d;try{d=jsonlint.parse(a.get("dynaml"))}catch(e){throw{message:["In motif",a.get("name"),":\n",e.message].join(" ")}}return _.reduce(App.usr.nodal.ws.objects.BuildManager.dynaml.motifProperties,function(b,c){return a.has(c)&&(b[c]=a.get(c)),b},d)}},this).compact().value(),e=_.map(e,function(a){var c=a.get("polarity");return{name:a.get("name"),motif:a.get("motif"),polarity:isNaN(c)?0:c,complementarities:_.map(g[a.getId()]||[],function(a){return{source:a.get("leftObject").get("name"),target:a.get("rightObject").get("name"),node:a.get("rightObject").get("parent").get("name")}}),domains:_.map(a.getChildren(),function(a,c){if(a.isWType(["App.usr.nodal.ws.objects.InputPort","App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.BridgePort"]))return _.reduce(App.usr.nodal.ws.objects.BuildManager.dynaml.domainProperties,function(b,c){return a.has(c)&&(b[c]=a.get(c)),b},{name:a.get("name")||"p"+c,expose:b?function(a){return a?{role:a.get("role"),name:a.get("name")}:null}(a.get("exposure")):null})})}}),{"import":d,nodes:e,motifs:f,version:c.version}},serializeDynaml:function(){return this.buildDynaml(this.workspace.getRootObjects())},serializeTerse:function(){var a=this.workspace,b=[],c=[],d={},e=1,f=[];a.objects.each(function(a){a.isWType("App.usr.nodal.ws.objects.Node")?(d[a.getId()]=e,e++,b.push(a)):a.isWType("App.usr.nodal.ws.objects.Complement")&&c.push(a)}),f.push(b.length.toString());var g=0;return Ext.each(b,function(a){var b=a.get("motif");isNaN(parseInt(b))?b=parseInt(_.first(b.match(/\d+/g))):b=parseInt(b);var c=[a.get("name").replace(/\s/g,"_")||"Untitled_"+ ++g,b],e,h;a.children.each(function(a){if(a.isWType("App.usr.nodal.ws.objects.OutputPort")||a.isWType("App.usr.nodal.ws.objects.BridgePort")){if(a.get("complementarity")){e=a.get("complementarity");if(e.hasParent()){h=e.get("parent");if(h)return c.push(d[h.getId()]),!0}}c.push("0")}}),f.push(c.join(" "))}),f.join("\n")},buildMotif:function(a,b,c){var d,e;return a&&(a=a.serialize(),a.library=App.dynamic.Library.dummy(),a=new App.dynamic.Motif(a),e=a.name,d=this.workspace.createObject({wtype:"App.usr.nodal.ws.objects.Node",x:b,y:c,motif:e}),d.suspendLayout=!0,_.each(a.getDomains(),function(a,b){var c=_.clone(a),e={};_.isObject(c)&&App.usr.nodal.ws.objects.PortClasses[c.role]&&(e.name=c.name,e.wtype=App.usr.nodal.ws.objects.PortClasses[c.role],e.stroke=App.dynamic.Compiler.getColor(c),e.segments=c.segments,e.role=c.role,d.adopt(this.buildPort(e)))},this),d.suspendLayout=!1,d.doLayout()),d},buildPort:function(a){return a||(a={}),_.isString(a)?this.workspace.createObject(App.usr.nodal.ws.objects.Ports[a]):(!!a.name,this.workspace.createObject(a))}},function(){Workspace.reg("App.usr.nodal.ws.objects.BuildManager",App.usr.nodal.ws.objects.BuildManager),Workspace.regAlias("Workspace.objects.dna.BuildManager","App.usr.nodal.ws.objects.BuildManager")});
Ext.define("App.usr.nodal.ws.tools.PortTool",{extend:"Workspace.tools.BaseTool",require:["App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.InputPort"],mixins:{highlightable:"Workspace.tools.Highlightable"},click:function(a,b){var c=this.getAdjustedXY(a),d;if(b&&this.accept(b)){var e=b.nextPortName();a.altKey?d=this.workspace.createObject({name:e,wtype:"App.usr.nodal.ws.objects.OutputPort",x:c.x,y:c.y}):a.shiftKey?d=this.workspace.createObject({name:e,wtype:"App.usr.nodal.ws.objects.BridgePort",x:c.x,y:c.y}):d=this.workspace.createObject({name:e,wtype:"App.usr.nodal.ws.objects.InputPort",x:c.x,y:c.y}),b.adopt(d)}},accept:function(a){return a.isWType(["App.usr.nodal.ws.objects.Node","App.usr.nodal.ws.objects.Motif"])},mouseover:function(a,b){this.mixins.highlightable.mouseover.apply(this,arguments)},mouseout:function(a,b){this.mixins.highlightable.mouseout.apply(this,arguments)},buildPort:function(a){return this.workspace.buildManager.buildPort(a)}},function(){Workspace.Tools.register("port",App.usr.nodal.ws.tools.PortTool)});
Ext.define("App.usr.nodal.LibraryWindow",{extend:"Ext.window.Window",requires:["App.usr.nupack.Editor","App.ui.CodeMirror"],title:"Compiled library",minimize:function(){this.toggleCollapse()},minimizable:!0,maximizable:!0,bodyBorder:!1,border:!1,plain:!0,showTree:!1,layout:"fit",closeAction:"hide",initComponent:function(){this.lastLibrary?(Ext.apply(this,{items:[{xtype:"tabpanel",plain:!0,items:[{title:"SVG",xtype:"panel",name:"svg",html:this.lastLibrary.toSVGOutput()},{title:"DIL",xtype:"codemirror",mode:{name:"javascript",json:!0},name:"dil",value:this.lastLibrary.toDilOutput()},{title:"NUPACK",xtype:"codemirror",mode:"nupack",name:"nupack",value:this.lastLibrary.toNupackOutput()},{title:"DD",xtype:"codemirror",mode:"nupack",name:"dd",value:this.lastLibrary.toDomainsOutput()},{title:"PIL",xtype:"codemirror",mode:"pepper",name:"pil",value:this.lastLibrary.toPilOutput()},{title:"Enum",xtype:"codemirror",mode:"pepper",name:"enum",value:this.lastLibrary.toEnumOutput()},{title:"Strands",xtype:"codemirror",mode:"text",name:"strands",value:this.printStrands(this.lastLibrary)},{title:"Source",xtype:"codemirror",mode:"text",name:"source",value:this.printStrands(this.lastLibrary,{annotations:!0,originalSegmentNames:!0})}]}]}),this.sourceDynaml&&this.items[0].items.push({title:"DyNAML",xtype:"codemirror",mode:"javascript",value:this.dynamlToString()}),this.showTree&&this.items[0].items.push({title:"Tree",xtype:"objectbrowser",data:this.lastLibrary})):Ext.apply(this,{items:[{html:"No library to show.",frame:!0,border:!1,bodyBorder:!1}]}),this.callParent(arguments)},setLibrary:function(a,b){this.lastLibrary=a,this.sourceDynaml=b?b:null;var c=this.down("tabpanel"),d=this.down("objectbrowser");c.remove(d),c.add({title:"Tree",xtype:"objectbrowser",data:this.lastLibrary});var e=this.down("codemirror[name='dil']");e&&e.setValue(this.lastLibrary.toDilOutput());var f=this.down("codemirror[name='nupack']");f&&f.setValue(this.lastLibrary.toNupackOutput());var g=this.down("codemirror[name='dd']");g&&g.setValue(this.lastLibrary.toDomainsOutput());var h=this.down("codemirror[name='pil']");h&&h.setValue(this.lastLibrary.toPilOutput());var i=this.down("codemirror[name='emum']");i&&i.setValue(this.lastLibrary.toEnumOutput());var j=this.down("panel[name='svg']");j&&j.update(this.lastLibrary.toSVGOutput(!0));var k=this.down("codemirror[name='strands']");k&&k.setValue(this.printStrands(this.lastLibrary));var b=this.down("codemirror[name='source']");b&&b.setValue(this.printStrands(this.lastLibrary,{annotations:!0,originalSegmentNames:!0}));if(this.sourceDynaml){var l=this.down("codemirror[mode='javascript']");l?l.setValue(this.dynamlToString()):c.add({title:"DyNAML",xtype:"codemirror",mode:"javascript",value:this.dynamlToString()})}},dynamlToString:function(){return _.isString(this.sourceDynaml)?this.sourceDynaml:JSON.stringify(this.sourceDynaml,null,"	")},printStrands:function(a,b){return App.dynamic.Compiler.printStrands(a,b)},width:400,height:400});
Ext.define("App.usr.canvas.ObjectTree",{extend:"Ext.tree.TreePanel",useArrows:!0,initComponent:function(){App.usr.canvas.ObjectTree.superclass.initComponent.apply(this,arguments)},attachTo:function(a){this.workspace=a,this.mon(this.workspace,"instantiate",this.onCreate,this),this.mon(this.workspace,"initialize",this.bindParent,this),this.mon(this.workspace,"select",this.onWorkspaceSelect,this),this.mon(this.workspace,"unselect",this.onWorkspaceUnselect,this),this.mon(this.workspace,"destroy",this.onObjectDestroy,this);var b=this.getSelectionModel();b.on("selectionchange",this.onSelect,this)},findNodeForObject:function(a){return a&&a.getId?this.findNodeForId(a.getId()):!1},findNodeForId:function(a){return this.getStore().getRootNode().findChild("id",a,!0)},getObjectFromNode:function(a){return this.workspace.getObjectById(a.id)},onEditName:function(a,b){var c=this.getObjectFromNode(this.editor.editNode);c.set("name",b)},onSelect:function(a,b){if(!this.ignoreSelectionChange){this.ignoreSelectionChange=!0;var c=[];Ext.each(b,function(a){c.push(this.workspace.getObjectById(a.id))},this),this.workspace.setSelection(c),this.ignoreSelectionChange=!1}},onWorkspaceSelect:function(a){if(!this.ignoreSelectionChange){this.ignoreSelectionChange=!0;var b=this.findNodeForObject(a);b&&this.getSelectionModel().select(b,!0),this.ignoreSelectionChange=!1}},onWorkspaceUnselect:function(a){if(!this.ignoreSelectionChange){this.ignoreSelectionChange=!0;var b=this.findNodeForObject(a);b&&this.getSelectionModel().deselect(b,!0),this.ignoreSelectionChange=!1}},onCreate:function(a){var b;a.hasParent()&&(b=this.findNodeForObject(a.getParent())),b||(b=this.getRootNode()),b&&b.appendChild({text:a.get("name"),id:a.getId(),iconCls:a.get("iconCls"),editable:!0}),a.on("change",this.onChange,this)},bindParent:function(a){var b=this.findNodeForObject(a),c=this.findNodeForObject(a.getParent());c&&(b.remove(!1),c.appendChild(b))},onObjectDestroy:function(a){var b=this.findNodeForObject(a);b&&(b.remove(),b.destroy()),a.un("change",this.onChange,this)},onChange:function(a,b,c,d){if(!this.ignoreChange&&d&&d.getId)if(a=="name"){var e=this.findNodeForObject(d);e&&e.set("text",b)}else if(a=="parent"){var e=this.findNodeForObject(d),f=this.findNodeForObject(d.getParent());f&&(e.remove(!1),f.appendChild(e))}}});
Ext.define("App.usr.dil.HighlightManager",{mixins:{observable:"Ext.util.Observable"},constructor:function(a){this.mixins.observable.constructor.apply(this,arguments),Ext.apply(this,a),this.segmentsGrid.on("itemmouseenter",function(a,b,c,d){this.fireEvent("updateSegmentHighlight",b.get("identity"),1)},this),this.segmentsGrid.on("itemmouseleave",function(a,b,c,d){this.fireEvent("updateSegmentHighlight",null)},this),this.on("updateSegmentHighlight",this.updateSegmentHighlight,this,{buffer:10})},afterrender:function(){this.strandsGrid.getEl().on("mouseover",function(a,b){var c=b.getAttribute("data-segment-identity"),d=b.getAttribute("data-segment-polarity");this.fireEvent("updateSegmentHighlight",c,d)},this,{delegate:"span.sequence-segment"})},updateSegmentHighlight:function(a,b){a?this.highlightSegment(a,b):this.unhighlightSegment()},highlightSegment:function(a,b){this.complexView.preview.fade(),this.complexView.preview.highlight({segment_identity:a,segment_polarity:b},"node-highlight"),this.complexView.preview.highlight({segment_identity:a,segment_polarity:-1*b},"node-highlight-complement"),this.strandsGrid.unhighlightSegment(),this.strandsGrid.highlightSegment(a,b)},unhighlightSegment:function(a,b){this.complexView.preview.unfade(),this.complexView.preview.unhighlight(null,"node-highlight"),this.complexView.preview.unhighlight(null,"node-highlight-complement"),this.strandsGrid.unhighlightSegment()}});
Ext.define("App.ui.AddDomainButton",{extend:"Ext.button.Split",text:"Add",iconCls:"plus",lengthLabel:"New domain length: ",itemLabel:"Add Domain",itemIconCls:"tick",tooltip:"Click the button to add a new domain of the default length. Click the arrow to choose the default length, or add domains with specific sequences to the design. ",initComponent:function(){Ext.applyIf(this,{addDomain:function(a){}}),this.addDomLen=Ext.widget({xtype:"numberfield",name:"addDomLen",value:8,min:2,indent:!0});var a=[{text:this.lengthLabel,canActivate:!1},this.addDomLen,{text:this.itemLabel,iconCls:this.itemIconCls,name:"addDomainItem",handler:this.onClickHandler,scope:this}].concat(this.extraMenuItems||[]);Ext.apply(this,{handler:this.onClickHandler,scope:this,menu:a}),this.callParent(arguments)},onClickHandler:function(){var a=this.addDomLen.getValue();this.addDomain(a)}});
Ext.define("Workspace.actions.UnwrapObjectsAction",{extend:"Workspace.actions.Action",constructor:function(a){Ext.apply(this,a),Workspace.actions.UnwrapObjectsAction.superclass.constructor.apply(this,arguments),Ext.applyIf(this,{scope:this})},wtype:"UnwrapIdeaAction",handler:function(){Ext.each(this.subjects,function(a){var b=a.getChildren();_.each(b,function(a){a.orphan()})}),this.workspace.deleteObjects(this.subjects)},getUndo:function(){return new Workspace.actions.AdoptObjectAction({objects:this.subjects.concat([]),text:'Undo "'+this.text+'"',iconCls:this.iconCls})},serialize:function(){return{wtype:this.wtype,subjects:Workspace.Components.serialize(this.subjects)}}});
Ext.define("App.usr.dd.ScoreParametersWindow",{extend:"Ext.window.Window",title:"Score Parameters",layout:"fit",plain:!0,bodyBorder:!1,border:!1,width:730,initComponent:function(){Ext.apply(this,{items:{xtype:"form",frame:!0,defaults:{labelAlign:"right",labelWidth:250},items:[{fieldLabel:"Maximum simultaneous mutations",xtype:"numberfield",name:"MAX_MUTATIONS",labelWidth:175},{xtype:"fieldset",title:"Base composition",defaults:{labelAlign:"right",labelWidth:175},layout:{type:"table",columns:2},items:[{fieldLabel:"GC Score",xtype:"numberfield",name:"GCstr"},{fieldLabel:"GT score",xtype:"numberfield",name:"GTstr"},{fieldLabel:"AT Score",xtype:"numberfield",name:"ATstr"},{fieldLabel:"Shannon Entropy multiplier",xtype:"numberfield",name:"SHANNON_BONUS",tooltip:{html:"Amount by which to multiply the adjusted Shannon entropy. Increase to increase the importance of sequence diversity relative to other factors. Adjusted Shannon entropy = (Shannon entropy - offset) * multiplier"}},{fieldLabel:"GGGG Penalty",xtype:"numberfield",name:"GGGG_PENALTY"},{fieldLabel:"Shannon Entropy offset",xtype:"numberfield",name:"SHANNON_ADJUST",tooltip:{html:"Expected Shannon entropy for a sequence, as a percent. 1 = 100% information density. Higher values will actively penalize sequences with low entropy. "}},{fieldLabel:"6 consecutive A/T or G/C score",xtype:"numberfield",name:"ATATAT_PENALTY"}]},{xtype:"container",layout:{type:"table",columns:2},height:130,defaults:{margin:2,height:125},items:[{xtype:"fieldset",title:"Matches",defaults:{labelAlign:"right",labelWidth:175},items:[{fieldLabel:"Mismatch/bulge score",xtype:"numberfield",name:"MBstr"},{fieldLabel:"Larger loop score (per extra base)",xtype:"numberfield",name:"LLstr"},{fieldLabel:"Penalty for pairing at ends of domains",xtype:"numberfield",name:"DHstr"}]},{xtype:"fieldset",title:"Exponential Scoring",defaults:{labelAlign:"right",labelWidth:175},items:[{fieldLabel:"Number of bases before exponential score kicks in",xtype:"numberfield",name:"LHbases"},{fieldLabel:"Exponential score initial",xtype:"numberfield",name:"LHstart"},{fieldLabel:"Exponential score power",xtype:"numberfield",name:"LHpower"}]}]},{xtype:"fieldset",title:"Crosstalk",defaults:{labelAlign:"right",labelWidth:175},items:[{fieldLabel:"Intra-domain bonus score",xtype:"numberfield",name:"INTRA_SCORE"},{fieldLabel:"Crosstalk bonus score",xtype:"numberfield",name:"CROSSTALK_SCORE"},{fieldLabel:"Crosstalk score divide factor",xtype:"numberfield",name:"CROSSTALK_DIV"}]}],buttons:[{text:"Save",handler:this.save,scope:this}]}}),this.callParent(arguments),this.form=this.down("form")},save:function(){this.designer.updateParams(this.getValues()),this.hide()},getValues:function(){return this.form.getValues()},setValues:function(a){return this.form.getForm().setValues(a)}});
Ext.define("Workspace.tools.ConnectorTool",{constructor:function(a,b){this.workspace=a,Ext.applyIf(this,b),Workspace.tools.ConnectorTool.superclass.constructor.call(this,a,b),this.parameters||(this.parameters={}),Ext.applyIf(this.parameters,App.Stylesheet.Draw),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},extend:"Workspace.tools.BaseTool",mixins:{highlightable:"Workspace.tools.Highlightable"},targetWType:"Workspace.objects.Connection",showLabel:!0,accept:function(a){return this.dragging?this.acceptRight(a):this.acceptLeft(a)},acceptLeft:function(a){return!0},acceptRight:function(a){return!0},canConnect:function(a,b){return!0},onConnect:function(a,b,c){},beforeConnect:function(a,b){},buildObject:function(){return this.workspace.createObject({wtype:this.targetWType,leftObject:this.leftObject,rightObject:this.rightObject})},click:function(a,b){a.stopEvent()},dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.acceptLeft(b)?(this.dragging=!0,this.proto&&(this.proto.remove(),delete this.proto),this.createProto(a,b),a.stopEvent()):this.fireEvent("reject",b,this)},mouseup:function(a,b){if(this.dragging){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);b?this.rightObject=b:this.rightObject=Workspace.objects.Connection.getPoint(c.x,c.y);if(this.acceptRight(this.rightObject)&&this.canConnect(this.leftObject,this.rightObject)){this.beforeConnect(this.leftObject,this.rightObject);var d=this.buildObject();this.onConnect(d,this.leftObject,this.rightObject)}else this.fireEvent("reject",b,this);delete this.leftObject,delete this.rightObject,this.proto.remove(),delete this.proto}a.stopEvent()}},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a),d=8,e=Math.atan2(c.y-this.y1,c.x-this.x1);this.x2=c.x-Math.cos(e)*d,this.y2=c.y-Math.sin(e)*d,this.proto.attr({path:[["M",this.x1,this.y1],["L",this.x2,this.y2]]})}a.stopEvent()},createProto:function(a,b){var c=this.getAdjustedXY(a);this.x1=this.x2=c.x,this.y1=this.x2=c.y,b?this.leftObject=b:this.leftObject=Workspace.objects.Connection.getPoint(c.x,c.y),this.proto=this.workspace.paper.path([["M",this.x1,this.y1],["L",this.x2,this.y2]]),this.proto.attr(this.parameters)},mouseover:function(a,b){this.mixins.highlightable.mouseover.apply(this,arguments)},mouseout:function(a,b){this.mixins.highlightable.mouseout.apply(this,arguments)}},function(){Workspace.Tools.register("connector",Workspace.tools.ConnectorTool)});
Ext.define("Workspace.objects.Connection",{statics:{getPoint:function(a,b){return{x:a,y:b,width:0,height:0,getBBox:function(){return this},on:function(){},un:function(){},get:function(){},set:function(){}}}},constructor:function(){Workspace.objects.Connection.superclass.constructor.apply(this,arguments),this.expose("leftObject",!0,!0,!0,!1),this.expose("rightObject",!0,!0,!0,!1),this.expose("property",!0,!0,!0,!1),this.showLabel&&this.addShim(new Workspace.ConnectionLabel({property:"name"})),this.thetaProperty&&(this.dthetaProperty||(this.dthetaProperty="d"+this.thetaProperty))},extend:"Workspace.objects.VectorObject",requires:["Workspace.objects.Path"],shape:"path",isMovable:!1,name:"New Connection",iconCls:"connector",wtype:"Workspace.objects.Connection",fillOpacity:.1,initialize:function(){this.leftObject.id?this.set("leftObject",Workspace.Components.realize(this.leftObject)):this.leftObject=Workspace.objects.Connection.getPoint(this.leftObject.x,this.leftObject.y),this.rightObject.id?this.set("rightObject",Workspace.Components.realize(this.rightObject)):this.rightObject=Workspace.objects.Connection.getPoint(this.rightObject.x,this.rightObject.y),this.property&&this.updateProperty()},unBindObject:function(a){a.un("move",this.onObjectMove,this),a.un("hide",this.hide,this),a.un("show",this.show,this),a.un("destroy",this.destruct,this)},reBindObject:function(a,b){this.unBindObject(b),this.bindObject(a),this.updateProperty()},bindObject:function(a){a.on("move",this.onObjectMove,this),a.on("hide",this.hide,this),a.on("show",this.show,this),a.on("destroy",this.destruct,this)},updateProperty:function(){var a=this.get("leftObject"),b=this.get("rightObject");a&&a.set&&a.set(this.property,b),this.setBoth&&b&&b.set&&b.set(this.property,a)},canConnect:function(a,b){return!0},acceptLeft:function(a){return!0},acceptRight:function(a){return!0},render:function(){var a=this.get("leftObject"),b=this.get("rightObject");this.bindObject(a),this.bindObject(b),this.on("change:leftObject",this.reBindObject,this),this.on("change:rightObject",this.reBindObject,this),this.path=this.buildPath(a,b),this.arguments=[this.path],Workspace.objects.Connection.superclass.render.apply(this,arguments),this.updateDimensions()},getHighlightProxy:function(){return new Workspace.Proxy(Ext.applyIf({path:this.path,shape:this.shape,strokeWidth:this.strokeWidth+App.Stylesheet.Highlight.strokeWidth,workspace:this.workspace},App.Stylesheet.Highlight))},updateHighlightProxy:function(){this.highlightProxy&&(this.highlightProxy.path=this.path)},onObjectMove:function(){this.rebuildPath()},applyPath:function(a){this.path=a,this.vectorElement.attr({path:a}),this.updateHighlightProxy()},rebuildPath:function(){this.path=this.buildPath(this.get("leftObject"),this.get("rightObject")),this.vectorElement.attr({path:this.path}),this.updateHighlightProxy();var a=this.vectorElement.getBBox();this.set("x",a.x),this.set("y",a.y),this.set("height",a.height),this.set("width",a.width)},buildPath:function(a,b){var c=a.getBBox(),d=b.getBBox(),e=[{x:c.x+c.width/2,y:c.y-1},{x:c.x+c.width/2,y:c.y+c.height+1},{x:c.x-1,y:c.y+c.height/2},{x:c.x+c.width+1,y:c.y+c.height/2},{x:d.x+d.width/2,y:d.y-1},{x:d.x+d.width/2,y:d.y+d.height+1},{x:d.x-1,y:d.y+d.height/2},{x:d.x+d.width+1,y:d.y+d.height/2}],f={},g=[];if(this.thetaProperty&&a.has(this.thetaProperty)&&b.has(this.thetaProperty))var h={x:c.x+c.width/2,y:c.y+c.height/2,r:c.width/2},i={x:d.x+d.width/2,y:d.y+d.height/2,r:d.width/2},j=a.get(this.thetaProperty)*Math.PI/180,k=b.get(this.thetaProperty)*Math.PI/180,l=40,m=["M",h.x+Math.cos(j)*h.r,h.y+Math.sin(j)*h.r,"C",h.x+Math.cos(j)*(h.r+l),h.y+Math.sin(j)*(h.r+l),i.x+Math.cos(k)*(i.r+l),i.y+Math.sin(k)*(i.r+l),i.x+Math.cos(k)*i.r,i.y+Math.sin(k)*i.r];else{for(var n=0;n<4;n++)for(var o=4;o<8;o++){var p=Math.abs(e[n].x-e[o].x),q=Math.abs(e[n].y-e[o].y);if(n==o-4||(n!=3&&o!=6||e[n].x<e[o].x)&&(n!=2&&o!=7||e[n].x>e[o].x)&&(n!=0&&o!=5||e[n].y>e[o].y)&&(n!=1&&o!=4||e[n].y<e[o].y))g.push(p+q),f[g[g.length-1]]=[n,o]}if(g.length==0)var r=[0,4];else r=f[Math.min.apply(Math,g)];var s=e[r[0]].x,t=e[r[0]].y,u=e[r[1]].x,v=e[r[1]].y;p=Math.max(Math.abs(s-u)/2,10),q=Math.max(Math.abs(t-v)/2,10);var w=[s,s,s-p,s+p][r[0]].toFixed(3),x=[t-q,t+q,t,t][r[0]].toFixed(3),y=[0,0,0,0,u,u,u-p,u+p][r[1]].toFixed(3),z=[0,0,0,0,t+q,t-q,v,v][r[1]].toFixed(3),m=["M",s.toFixed(3),t.toFixed(3),"C",w,x,y,z,u.toFixed(3),v.toFixed(3)]}return m},getLeftPoint:function(){var a=this.path,b=[a[1],a[2]];return b},getRightPoint:function(){var a=this.path,b=[a[a.length-2],a[a.length-1]];return b},destruct:function(){this.workspace.deleteObjects([this])},destroy:function(){this.is("destroyed")||(this.property&&(this.get("leftObject").set(this.property,!1),this.setBoth&&this.get("rightObject").set(this.property,!1)),this.unBindObject(this.get("leftObject")),this.unBindObject(this.get("rightObject")),this.callParent(arguments))}},function(){Workspace.objects.Connection.borrow(Workspace.objects.Path,["updatePath","updateDimensions"]),Workspace.reg("Workspace.objects.Connection",Workspace.objects.Connection)});
Ext.define("App.ui.BoundObjectPanel",{extend:"Ext.panel.Panel",enableBoundFields:!0,initComponent:function(){this.callParent(arguments),this.initialize()},initialize:function(){this.addEvents("action"),this.boundObjects=Ext.create("Workspace.objects.ObjectCollection",{}),this.boundFields=new Ext.util.MixedCollection,this.dynamicFields=new Ext.util.MixedCollection,this.enableBoundFields&&Ext.each(this.query("component[objectBinding]"),function(a){var b=a.objectBindingEvent||"change";a.addListener(b,this.updateObjects,this);if(!this.boundFields.containsKey(a.objectBinding))this.boundFields.add(a.objectBinding,[a]);else{var c=this.boundFields.getByKey(a.objectBinding);c.push(a),this.boundFields.add(a.objectBinding,c)}},this),this.dynamicFields.addAll(this.query("component[enableIf], component[showIf]")),this.on("afterrender",this.buildTips,this),this.on("afterrender",this.updateDynamicFields,this)},buildTips:function(){},updateObjects:function(a,b,c){if(!this.ignoreNext&&a.objectBinding){var d={},e;d[a.objectBinding]=a.getValue(),e=new Workspace.actions.ChangePropertyAction({values:d,subjects:this.boundObjects.getRange()}),this.fireEvent("action",e)}},updateFields:function(a){this.boundFields.each(function(b){_.each(b,function(b){a.has(b.objectBinding)&&b.setValue(a.get(b.objectBinding))})},this)},updateFieldsHandler:function(a,b,c){if(this.boundFields.containsKey(a)){var d=this.boundFields.get(a);this.ignoreNext=!0,_.each(d,function(a){a.setValue(b)}),this.ignoreNext=!1}},updateDynamicFields:function(){var a=this.boundObjects.getCommonWType();this.dynamicFields.each(function(b){Ext.isFunction(b.showIf)&&(b.showIf(a,this.boundObjects,this)?b.show():b.hide()),Ext.isFunction(b.enableIf)&&(b.enableIf(a,this.boundObjects,this)?b.enable():b.disable())},this)},bind:function(a){this.boundObjects.containsKey(a.getId())||(this.boundObjects.length==0&&this.updateFields(a),this.boundObjects.add(a.getId(),a),this.mon(a,"change",this.updateFieldsHandler,this),this.updateDynamicFields())},unbind:function(a){a?this.boundObjects.containsKey(a.getId())&&(this.boundObjects.removeAtKey(a.getId()),this.mun(a,"change",this.updateFieldsHandler,this)):this.boundObjects.clear(),this.updateDynamicFields()},destroy:function(){Ext.each(this.tips,function(a){a.destroy()}),App.ui.BoundObjectPanel.superclass.destroy.apply(this,arguments)}});
Ext.define("App.usr.nodal.ws.objects.Exposure",{extend:"Workspace.objects.Connection",showLabel:!1,property:"exposure",render:function(){this.callParent(),this.set("strokeWidth",1.5),this.set("stroke","#aaa"),this.set("strokeDashArray","- "),this.set("arrowEnd","classic-wide-long")},strokeWidth:1.5,arrowEnd:"classic-wide-long",stroke:"#999",acceptLeft:function(a){var b=a.getParent();return a.getId&&a.isWType(["App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.BridgePort","App.usr.nodal.ws.objects.InputPort"])&&b&&b.hasParent()},acceptRight:function(a){var b=a.getParent();return a.getId&&(a.isWType(["App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.BridgePort","App.usr.nodal.ws.objects.InputPort"])&&b&&b.isWType("App.usr.nodal.ws.objects.Motif")||a.isWType("App.usr.nodal.ws.objects.Motif"))},canConnect:function(a,b){var c=a.getParent(),d=b.getParent();return a.hasWType(b.wtype)&&c&&d&&c.getParent()==d||b.isWType("App.usr.nodal.ws.objects.Motif")}},function(){Workspace.reg("App.usr.nodal.ws.objects.Exposure",App.usr.nodal.ws.objects.Exposure),Workspace.regAlias("Workspace.objects.dna.Exposure","App.usr.nodal.ws.objects.Exposure")});
Ext.define("App.usr.canvas.Palette",{extend:"Ext.panel.Panel",store:null,tpl:"",itemSelector:"",overItemClass:"x-view-over",trackOver:!0,mimeType:"",autoScroll:!0,initComponent:function(){Ext.apply(this,{items:[{xtype:"dataview",store:this.store,tpl:this.tpl,itemSelector:this.itemSelector,overItemClass:this.overItemClass,trackOver:this.trackOver,itemId:"view"}]}),this.callParent(arguments),this.view=this.getComponent("view"),this.view.on("refresh",function(){this.onRefresh()},this),this.view.on("render",function(a){this.dragZone=new Ext.dd.DragZone(a.getEl(),{mimeType:this.mimeType,getDragData:function(b){var c=b.getTarget(a.itemSelector,10);if(c)return d=c.cloneNode(!0),d.id=Ext.id(),{ddel:d,sourceEl:c,repairXY:Ext.fly(c).getXY(),sourceStore:a.store,draggedRecord:a.getRecord(c),mimeType:this.mimeType}},getRepairXY:function(){return this.dragData.repairXY}})},this)}});
Ext.define("App.usr.canvas.GeometryTab",{extend:"App.ui.BoundObjectPanel",initComponent:function(){Ext.apply(this,{tbar:[{xtype:"buttongroup",title:"Position",columns:1,defaults:{cellCls:"table-cell-padded"},items:[{ref:"../../xField",fieldLabel:"X",objectBinding:"x",xtype:"numberfield",width:100,tooltip:{title:"x position",text:"The object's x position"}},{ref:"../../yField",fieldLabel:"Y",objectBinding:"y",xtype:"numberfield",width:100,tooltip:{title:"y position",text:"The object's y position"}}]},{xtype:"buttongroup",title:"Dimensions",columns:1,defaults:{cellCls:"table-cell-padded"},items:[{ref:"../../widthField",fieldLabel:"Width",objectBinding:"width",xtype:"numberfield",width:100,tooltip:{title:"Width",text:"The object's width"}},{ref:"../../heightField",fieldLabel:"Height",objectBinding:"height",xtype:"numberfield",width:100,tooltip:{title:"Height",text:"The object's height"}}]}]}),App.usr.canvas.GeometryTab.superclass.initComponent.apply(this,arguments)},afterrender:function(){var a=[this.xField,this.tField,this.widthField,this.heightField];this.tips=[],Ext.each(a,function(a){if(a.tooltip){var b=a.tooltip;b.text&&!b.html&&(b.html=b.text),b.target=a.getEl(),this.tips.push(new Ext.ToolTip(b))}},this)}});
Ext.define("App.usr.canvas.MetaTab",{extend:"App.ui.BoundObjectPanel",initComponent:function(){Ext.apply(this,{tbar:[{xtype:"buttongroup",title:"Name",columns:1,defaults:{cellCls:"table-cell-padded"},items:[{ref:"../../nameField",fieldLabel:"Name",objectBinding:"name",xtype:"textfield",width:200,tooltip:{title:"Name",text:"The object's name"}},{ref:"../../typeField",xtype:"combo",objectBinding:"wtype",store:Workspace.Components.getTypeStore(),tpl:new Ext.XTemplate('<tpl for="."><div class="x-combo-list-item">','<img src="'+Ext.BLANK_IMAGE_URL+'" class="combo-icon {iconCls}" />&nbsp;<span>{wtype}</span>',"</div></tpl>"),valueField:"wtype",displayField:"wtype",typeAhead:!0,mode:"local",forceSelection:!0,triggerAction:"all",selectOnFocus:!0,width:200,tooltip:{title:"Type",text:"The object type."},cellCls:"table-cell-padded-right"}]},{xtype:"buttongroup",title:"Properties",columns:1,defaults:{cellCls:"table-cell-padded"},items:[]}]}),App.usr.canvas.MetaTab.superclass.initComponent.apply(this,arguments)},afterrender:function(){var a=[this.nameField];this.tips=[],Ext.each(a,function(a){if(a.tooltip){var b=a.tooltip;b.text&&!b.html&&(b.html=b.text),b.target=a.getEl(),this.tips.push(new Ext.ToolTip(b))}},this)}});
Ext.define("App.usr.dil.Segment",{extend:"Ext.data.Model",fields:[{name:"identity"},{name:"sequence"},{name:"color"}]});
Ext.define("App.usr.dil.Strand",{extend:"Ext.data.Model",fields:[{name:"id",type:"int"},{name:"name"},{name:"polarity",type:"int"},{name:"sequence"},{name:"domains"},{name:"spec"}],idgen:"sequential",set:function(a,b){a=="spec"&&b!=this.get("spec")&&this.updateCachedSpec(b),this.callParent(arguments)},getDynaml:function(a){return a.getStrand(this.get("name"))},diffSpec:function(a){var b=a,c=this.parsedSpec,d=_.comprehend(b,function(a){return a.segments}),e=_.comprehend(c,function(a){return a.segments}),f=_.difference(d,e),g=_.difference(e,d),h=_.map(f,function(a){return d.indexOf(a)}),i=_.map(g,function(a){return e.indexOf(a)});return{removed:f,added:g,removedIndices:h,addedIndices:i}},updateCachedSpec:function(a,b){a?this.parsedSpec=App.dynamic.Compiler.parseDomainOrSegmentString(a,!0):this.parsedSpec=App.dynamic.Compiler.parseDomainOrSegmentString(this.get("spec"),!0)},getParsedSpec:function(){return this.parsedSpec||this.updateCachedSpec(),this.parsedSpec},getFlatSpec:function(){return _.comprehend(this.getParsedSpec(),function(a){return a.segments})},proxy:"memory"});
Ext.define("App.ui.BasePicker",{alias:"widget.basepicker",extend:"Ext.ux.form.field.BoxSelect",displayField:"base",valueField:"value",multiSelect:!0,queryMode:"local",constructor:function(){this.store=Ext.create("Ext.data.Store",{fields:[{name:"base",type:"string"},{name:"value",type:"int"}],data:[{base:"G",value:8},{base:"A",value:4},{base:"T",value:2},{base:"C",value:1}]}),this.callParent(arguments)},getAggregate:function(){var a=this.getValue();return _.reduce(a,function(a,b){return a+parseInt(b)},0)},setAggregate:function(a){a=parseInt(a);var b=[a&8,a&4,a&2,a&1];b=_.compact(b),this.setValue(b)}});
Ext.define("Workspace.objects.IdeaObject",{constructor:function(a,b){Workspace.objects.IdeaObject.superclass.constructor.apply(this,arguments),this.autoFill&&this.set("fill",Workspace.Utils.ideaColor()),this.initLayout(this.layout),this.expose("layout",function(){return this.layout.ltype},function(a){this.initLayout(a)},!0,!1)},requires:["Workspace.Label","Ext.util.MixedCollection"],extend:"Workspace.objects.Rectangle",wtype:"Workspace.objects.IdeaObject",layout:"Workspace.idea.FreeLayout",showTitle:!0,name:"New Idea",iconCls:"idea",r:5,stroke:"#CCC",padding:50,autoFill:!0,destroyChildren:!1,suspendLayout:!1,render:function(){this.callParent(arguments),this.layout.doFirstLayout(),this.toBack()},initLayout:function(a){this.layout=Workspace.Layouts.create(a,{idea:this}),this.rendered&&this.layout.doFirstLayout()},doLayout:function(){this.layout&&this.layout.doLayout&&this.layout.doLayout()},buildChildren:function(){this.suspendLayout=!0,this.callParent(arguments),this.suspendLayout=!1,this.adjustSize()},addChild:function(a){this.callParent(arguments),a.on("move",this.adjustSize,this),a.on("resize",this.adjustSize,this),a.is("rendered")&&this.adjustSize()},removeChild:function(a){this.callParent(arguments),a.un("move",this.adjustSize,this),a.un("resize",this.adjustSize,this),this.adjustSize()},adjustSize:function(){this.is("rendered")&&(this.ignoreTranslateChildren||this.updateSize(!0,!1))},updateSize:function(a,b){this.ignoreTranslateChildren=!0,this.suspendLayout||this.layout.doLayout(b),this.ignoreTranslateChildren=!1},childCanMove:function(a){return this.layout.childrenMovable},destroy:function(){this.destroyChildren&&this.workspace.deleteObjects(this.children.getRange()),this.layout.destroy(),this.callParent(arguments)}},function(){Workspace.reg("Workspace.objects.IdeaObject",Workspace.objects.IdeaObject)});
Ext.define("Workspace.tools.IdeaAdderTool",{constructor:function(){Workspace.tools.IdeaAdderTool.superclass.constructor.apply(this,arguments)},extend:"Workspace.tools.BaseTool",mixins:{highlightable:"Workspace.tools.Highlightable"},click:function(a,b){b&&b.wtype=="Workspace.IdeaObject"&&(this.workspace.doAction(new Workspace.Actions.AdoptObjectAction({subjects:this.workspace.getSelection(),parent:b})),this.workspace.changeTool("pointer"))},dblclick:function(a,b){},mousedown:function(a,b){},mouseup:function(a,b){},mousemove:function(a,b){},accept:function(a){return a&&a.wtype=="Workspace.IdeaObject"&&a.highlight},mouseover:function(a,b){this.mixins.highlightable.mouseover.apply(this,arguments)},mouseout:function(a,b){this.mixins.highlightable.mouseout.apply(this,arguments)},deactivate:function(a,b){this.workspace.deselect()}},function(){Workspace.Tools.register("idea-add",Workspace.tools.IdeaAdderTool)});
Ext.define("App.ui.ProtovisPanel",{alias:"widget.pvpanel",extend:"Ext.panel.Panel",pan:!0,zoom:1,bpadding:20,visPadding:10,autoRender:!1,autoSize:!0,initComponent:function(){this.callParent(arguments),this.autoRender&&this.on("afterrender",this.afterrender,this,{single:!0})},afterrender:function(){this.built||(this.buildVis(),this.collapsed||this.renderVis(),this.on("collapse",this.hideVis,this),this.on("expand",this.resizeVis,this),this.on("resize",this.resizeVis,this),this.built=!0)},getBodyWidth:function(){return this.body.getWidth()},getBodyHeight:function(){return this.body.getHeight()},resizeVis:function(a,b,c){this.autoSize&&this.doAutoSize(),this.updateVis(),this.vis.render()},doAutoSize:function(){this.vis.width(this.getBodyWidth()-this.visPadding).height(this.getBodyHeight()-this.visPadding).top(this.visPadding).left(this.visPadding)},renderVis:function(){this.vis&&(this.vis.visible(!0),this.vis.render())},updateVis:function(){},hideVis:function(){this.vis&&this.vis.render()},buildVis:function(){return this.getCanvas()},getCanvas:function(){return this.vis||(this.vis=(new pv.Panel).canvas(this.body.dom),this.autoSize&&this.doAutoSize(),this.pan&&this.vis.event("mousedown",pv.Behavior.pan()),this.zoom&&this.vis.event("mousewheel",pv.Behavior.zoom(this.zoom))),this.vis}});
Ext.define("Workspace.objects.Ellipse",{constructor:function(a,b){Workspace.objects.Ellipse.superclass.constructor.call(this,a,b)},extend:"Workspace.objects.VectorObject",alias:"Workspace.VectorEllipseObject",wtype:"Workspace.objects.Ellipse",name:"New Ellipse",iconCls:"ellipse",shape:"ellipse",isResizable:!0,x:0,y:0,width:0,height:0,render:function(){this.arguments=[this.get("x")+this.getRadiusX(),this.get("y")+this.getRadiusY(),this.getRadiusX(),this.getRadiusY()],Workspace.objects.Ellipse.superclass.render.call(this)},getRadiusX:function(){return this.getWidth()/2},getRadiusY:function(){return this.getHeight()/2},getCenterX:function(){return this.getX()+this.getRadiusX()},getCenterY:function(){return this.getY()+this.getRadiusY()},updateX:function(a){Workspace.objects.VectorObject.superclass.updateX.apply(this,arguments),this.vectorElement.attr({cx:a+this.getRadiusX()})},updateY:function(a){Workspace.objects.VectorObject.superclass.updateY.apply(this,arguments),this.vectorElement.attr({cy:a+this.getRadiusY()})},updateWidth:function(a){this.vectorElement.attr({rx:this.getRadiusX()}),this.updateX(this.getX())},updateHeight:function(a){this.vectorElement.attr({ry:this.getRadiusY()}),this.updateY(this.getY())}},function(){Workspace.reg("Workspace.objects.Ellipse",Workspace.objects.Ellipse)});
Workspace.ConnectionLabel={},Ext.define("Workspace.ConnectionLabel",{extend:"Workspace.Label",constructor:function(){Ext.applyIf(this,{elementSpec:{tag:"div",cls:"workspace-label-center"},offsets:[0,0]}),this.callParent(arguments)},getLeft:function(a){return this.object.getX()+this.object.getWidth()/2-a.getWidth()/2},getTop:function(a){return this.object.getY()+this.object.getHeight()/2-a.getHeight()/2}});
Ext.define("Workspace.tools.EllipseTool",{constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:{}}),Workspace.tools.EllipseTool.superclass.constructor.call(this,a,b),Ext.apply(this.parameters,App.Stylesheet.Draw),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},require:["Workspace.objects.Ellipse"],extend:"Workspace.tools.BaseTool",click:function(a,b){a.stopEvent()},dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.dragging=!0,this.proto&&(this.proto.remove(),delete this.proto),this.createProto(a)},mouseup:function(a,b){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2),e=this.workspace.createObject(Workspace.VectorEllipseObject,{x:d.x,y:d.y,width:d.width,height:d.height,fill:this.parameters.fill,stroke:this.parameters.stroke});return this.workspace.setSelection([e]),this.proto.remove(),delete this.proto,!1}},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2),e={cx:d.x+d.width/2,cy:d.y+d.height/2,rx:d.width/2,ry:d.height/2};this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this.anchor=d.anchor,delete d.anchor,this.proto.attr(e)}},createProto:function(a){var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.proto=this.workspace.paper.ellipse(this.x1,this.y1,0,0),this.proto.attr(this.parameters)}},function(){Workspace.Tools.register("ellipse",Workspace.tools.EllipseTool)});
Ext.define("Workspace.tools.LineTool",{requires:["Workspace.objects.Path"],constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:{}}),Workspace.tools.LineTool.superclass.constructor.call(this,a,b),Ext.apply(this.parameters,App.Stylesheet.Draw),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},extend:"Workspace.tools.BaseTool",targetWType:"Workspace.objects.Path",click:function(a,b){a.stopEvent()},dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.dragging=!0,this.proto&&this.proto.remove(),this.createProto(a)},mouseup:function(a,b){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=this.workspace.createObject({wtype:this.targetWType,points:[[this.x1,this.y1],[this.x2,this.y2]]});this.proto.remove(),this.workspace.setSelection([d])}},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y,this.proto.attr({path:[["M",this.x1,this.y1],["L",this.x2,this.y2]]})}},createProto:function(a){var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.proto=this.workspace.paper.path([["M",this.x1,this.y1]]),this.proto.attr(this.parameters)}},function(){Workspace.Tools.register("line",Workspace.tools.LineTool)});
function MotifPreview(){function c(b){b.each(function(b){var c=a*.25,d=a/2,e=a/2,f=a*.05,g=d3.select(this);g.selectAll("*").remove();var h=b;g.append("circle").attr("cx",d).attr("cy",e).attr("r",c).attr("fill","#fff").attr("stroke","#000").attr("stroke-width",4),g.append("text").text(h.name).attr("font-size","2em").attr("text-anchor","middle").attr("dy",".35em").attr("x",d).attr("y",e);var i=_.filter(h.getDomains?h.getDomains():h.domains||[],function(a){return a.role!="null"&&a.role!="structural"}),j=Math.PI,k=2*Math.PI/i.length;i=_.map(i,function(a,b){var g=4,h=j+b*k,i=h*180/Math.PI;return a.role=="input"&&(i+=30),{cx:d+c*Math.cos(h),cy:e+c*Math.sin(h),x:d+c*Math.cos(h)-g,y:e+c*Math.sin(h)-g,lx:f*Math.cos(h),ly:f*Math.sin(h),width:2*g,height:2*g,rotate:i,fill:"#fff",stroke:App.dynamic.Compiler.getColor(a),role:a.role,polarity:DNA.parsePolarity(a.polarity),name:a.name}});var l=g.selectAll("g.port").data(i).enter().append("g").attr("class","port").attr("transform",function(a){return"translate("+a.x+","+a.y+") scale(3,3)"});l.append("path").attr("stroke",function(a){return a.stroke}).attr("fill",function(a){return a.fill}).attr("transform",function(a){return"rotate("+a.rotate+")"}).attr("d",d3.svg.symbol().type(function(a){switch(a.role){case"input":return"triangle-up";case"bridge":return"square";case"output":default:return"circle"}})),l.append("text").text(function(a){var b=a.polarity;return b==-1?"–":b==1?"+":"±"}).attr("dy",".35em").attr("text-anchor","middle"),l.append("text").text(function(a){return a.name}).attr("transform",function(a){return"translate("+a.lx+","+a.ly+")"}).attr("dy",".35em").attr("text-anchor","middle")})}var a=400,b=400;return c.width=function(b){return arguments.length?(a=b,c):a},c.height=function(a){return arguments.length?(b=a,c):b},c}Ext.define("App.usr.nodal.MotifPreview",{extend:"App.ui.D3Panel",alias:"widget.motifpreview",initComponent:function(){this.bbar=[{iconCls:"svg",handler:this.toSVG,scope:this}],this.callParent(arguments)},setValue:function(a){this.data=a,this.buildVis()},buildVis:function(){var a=this.getCanvas();a.selectAll().remove(),this.chart=MotifPreview(a).width(this.getWidth()).height(this.getHeight()),this.preview=this.chart(a.data([this.data]))},toSVG:function(a){this.doDisplaySVGWindow()},doDisplaySVGWindow:function(){var a='<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'+this.getCanvasMarkup();a=a.replace(/<svg(\b[^>]*)>/g,'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" $1>'),this.svgWindow=Ext.create("App.ui.StrandPreviewTextWindow",{title:"SVG"}),this.svgWindow.show(),this.svgWindow.setValue(a)}});
Ext.define("App.usr.nodal.ws.objects.NodePort",{requires:["Workspace.objects.Ellipse","Workspace.ConnectionLabel"],constructor:function(){this.expose("dynaml",!0,!0,!0,!1),this.expose("role",!0,!0,!0,!1),this.expose("identity",!0,!0,!0,!1),this.expose("type",!0,!0,!0,!1),this.expose("polarity",!0,!0,!0,!1),this.expose("exposure",!0,!0,!0,!1),this.expose("computedPolarity",function(){var a=this.getLibraryObject();return a?a.strand&&a.node?a.getAbsolutePolarity():a.getPolarity():0},!1,!1,!1),this.expose("footprint",function(){var a=this.getLibraryObject();return a?_.map(a.getSegments(),function(b){return b.getLength()}):[]},!1,!1,!1),this.expose("segments",function(){var a=this.getLibraryObject();return a?_.clone(a.getSegments()):[]},!1,!1,!1),this.workspace.buildManager&&this.workspace.buildManager.on("rebuild",this.onRebuild,this)},role:"",fill:"#fff",iconCls:"node-ports",strokeWidth:2,isResizable:!1,preventDragSelect:!0,render:function(){this.addShim(Ext.create("Workspace.ConnectionLabel",{cls:"workspace-label-plain-small workspace-label-port",offsets:[0,4],property:"computedPolarity",editable:!1,format:function(a){return a==1?"+":a==-1?"–":"ø"}})),this.footprintShim=Ext.create("Workspace.Label",{cls:"workspace-label-xsmall workspace-label-footprint",offsets:[0,4],property:"segments",editable:!1,showOnShow:!1,format:function(a,b){return _.map(a,function(b){return b.role&&b.role=="toehold"?"<u>"+b.getLength()+"</u>":b.getLength()}).join(" ")}}),this.addShim(this.footprintShim),this.hideFootprint(),this.on("mouseover",this.showFootprint,this),this.on("mouseout",this.hideFootprint,this)},hideFootprint:function(){this.footprintShim.hide()},showFootprint:function(){this.footprintShim.show()},highlightError:function(){this.errorProxy||(this.errorProxy=this.getHighlightProxy(),this.errorProxy.stroke="#aa0000"),this.errorProxy.render(this.vectorElement),this.errorProxy.attachTo(this),this.errorProxy.show()},hideError:function(){this.errorProxy&&this.errorProxy.hide()},onRebuild:function(){this.change("computedPolarity",this.get("computedPolarity")),this.change("footprint",this.get("footprint")),this.change("segments",this.get("segments"))},getRealtime:function(a){var b=this.getLibraryObject();return b?b[a]:!1},getLibraryObject:function(){if(this.parent&&(this.getParent().isWType("App.usr.nodal.ws.objects.Node")||this.getParent().isWType("App.usr.nodal.ws.objects.Motif"))){var a=this.parent.getLibraryObject(),b=this.get("name");if(a){var c=_.find(a.getDomains(),function(a){return a.getName()==b});return c}}return null}},function(){App.usr.nodal.ws.objects.NodePort.borrow(Workspace.objects.Ellipse,["getRadiusX","getRadiusY","getCenterX","getCenterY"])});
Ext.define("App.ui.EditorWindow",{extend:"Ext.window.Window",width:600,height:500,layout:"border",bodyBorder:!1,border:!1,closeAction:"hide",buttonText:"Save",buttonIconCls:"tick",value:"",helpIcon:"help",helpText:"",mode:"text",buttonHandler:function(){},initComponent:function(){this.editor=Ext.create("App.ui.CodeMirror",{mode:this.mode,border:!1,region:"center"}),Ext.apply(this,{items:[{html:this.helpText,frame:!0,region:"north"},this.editor],buttons:[{text:this.buttonText,iconCls:this.buttonIconCls,handler:this.buttonHandler,scope:this}]}),this.callParent(arguments),this.editor.setValue(this.value)},setValue:function(a){this.editor.setValue(a)},getValue:function(){return this.editor.getValue()}});
Ext.define("Workspace.idea.BaseLayout",{constructor:function(a){Workspace.idea.BaseLayout.superclass.constructor.apply(this,arguments),Ext.apply(this,a),this.defaultChildConfig={wtype:this.defaultChildType,width:100,height:100}},extend:"Ext.util.Observable",resizable:!0,childrenResizable:!0,childrenMovable:!0,defaultChildType:"Workspace.RichTextObject",doLayout:function(){},doFirstLayout:function(){this.doLayout()},addNextChild:function(){this.idea.addChild(this.idea.workspace.createChild(this.defaultChildConfig))},destroy:function(){this.fireEvent("destroy",this),delete this.idea},getObjects:function(){if(this.idea)return this.idea.children;if(this.objects)return this.objects}});
Ext.define("Workspace.tools.ChemDrawTool",{constructor:function(a,b){Workspace.tools.CodeMirrorTool.superclass.constructor.call(this,a,b)},extend:"Workspace.tools.BaseTool",click:function(a,b){},dblclick:function(a,b){},mousedown:function(a,b){},mouseup:function(a,b){},mousemove:function(a,b){},attach:function(a){if(a.element){this.item=a;var b=this;return this.endEditFunction=function(){this.workspace.endEdit()},!0}return!1},detach:function(){this.item&&(this.item=!1)},activate:function(){this.callParent(arguments)},deactivate:function(){this.callParent(arguments),this.detach()}},function(){Workspace.Tools.register("codemirror",Workspace.tools.CodeMirrorTool)});
Ext.define("Workspace.objects.ChemStructureObject",{constructor:function(a,b){this.callParent(arguments),Ext.apply(this.elementSpec,{tag:"div",cls:"chembox",children:[{tag:"canvas",id:this.getId()+"_sketcher"}]}),this.expose("mol",function(){var a=this.sketcher.getMolecule();return ChemDoodle.writeMOL(a)},function(a){var b=ChemDoodle.readMOL(a);this.sketcher.loadMolecule(b)},!0,!1)},extend:"Workspace.objects.ElementObject",wtype:"Workspace.objects.ChemStructureObject",name:"New Chemical Structure",iconCls:"chem",isEditable:!0,isSelectable:!0,isResizable:!0,padding:22,updateWidth:function(a){this.callParent(arguments),a-=this.padding,this.sketcher&&(this.sketcher.width=a),this.getCanvas().setWidth(a)},updateHeight:function(a){this.callParent(arguments),a-=this.padding,this.sketcher&&(this.sketcher.height=a),this.getCanvas().setHeight(a)},getCanvas:function(){return this.getEl().down("canvas")},render:function(){this.callParent(arguments);var a=this.getEl().down("canvas"),b=a.id;this.sketcher=new ChemDoodle.SketcherCanvas(b,this.getWidth()-this.padding,this.getHeight()-this.padding,null,ChemDoodle.featureDetection.supports_touch(),!0)},mousedown:function(a){if(a.getTarget().tagName.toLowerCase()=="canvas")return a.stopEvent(),!1;this.callParent(arguments)},destroy:function(){}},function(){Workspace.reg("Workspace.objects.ChemStructureObject",Workspace.objects.ChemStructureObject)});
Ext.define("Workspace.objects.SegmentedPath",{extend:"Workspace.objects.Path",strokeWidth:10,stroke:"#000",strokeOpacity:.5,strokeLinecap:"round",strokeLinejoin:"round",childWType:"Workspace.objects.Path",constructor:function(){this.callParent(arguments),this.indexedChildren=[]},addChild:function(a){this.callParent(arguments),a.expose("index",!0,!0,!0,!1),a.on("change:points",this.childChangePoints,this),a.on("change:path",this.childChangePath,this),this.indexedChildren[a.get("index")]=a},removeChild:function(a){this.callParent(arguments),a.un("change:points",this.childChangePoints,this);var b=a.get("index"),c=this.get("points");c.splice(b,1),this.indexedChildren.splice(b,1);for(var d=b;d<this.indexedChildren.length;d++)this.indexedChildren[d].set("index",d);this.set("points",c)},render:function(){this.callParent(arguments),this.toBack()},childChangePath:function(){!this.ignoreChangeChildPoints&&!this.ignoreChangeChildPath&&(this.ignoreChangeChildPath=!0,this.buildPath(),this.ignoreChangeChildPath=!1)},childChangePoints:function(a,b,c){if(!this.ignoreChangeChildPoints){var d=this.get("points");d[c.index]=a[0],d[c.index+1]=a[1],this.set("points",d)}},buildPath:function(){var a=this.get("points"),b,c,d,e=[];if(this.children.getCount()>0){if(this.children.getCount()==a.length-1)for(var f=0,g=a.length-1;f<g;f++)b=a[f],c=a[f+1],d=this.indexedChildren[f],this.ignoreChangeChildPoints=!0,d.set("points",[b,c]),this.ignoreChangeChildPoints=!1,e.push(d.interpolate(d.get("points")));this.set("path",e.join(" "))}else{for(var f=0,g=a.length-1;f<g;f++)b=a[f],c=a[f+1],d=this.makeChild({points:[b,c]}),e.push(d.interpolate(d.get("points")));this.set("path",e.join(" "))}},addPoint:function(a,b){var c,d,e,f=this.get("points");b>0&&(c=this.indexedChildren[b-1],c.set("points",[f[b],a])),e=this.makeChild(),b<this.indexedChildren.length&&(c=this.indexedChildren[b],c.set("points",[a,f[b+1]])),f.splice(b,0,a),this.set("points",f)},deletePoint:function(a){},makeChild:function(a){var b=this.workspace.createObject(Ext.apply(a||{},{wtype:this.childWType,strokeWidth:4,stroke:"#aaa",fillOpacity:0,index:this.getNextIndex(),showTitle:!0}));return this.addChild(b),this.is("rendered")&&b.insertAfter(this),b},getSegment:function(a){return this.indexedChildren(a)},getNextIndex:function(){return this.indexedChildren.length},childCanMove:function(){return!1}},function(){Workspace.reg("Workspace.objects.SegmentedPath",Workspace.objects.SegmentedPath)});
Ext.define("Workspace.tools.VectorHandle",{forceFront:!0,r:2,constructor:function(a,b){this.callParent(arguments),Ext.applyIf(this,{location:"tl"}),this.item&&this.item.vectorElement&&(this.vectorElement=this.item.vectorElement),this.addEvents(),this.item.on("change:points",this.onItemMove,this),this.item.on("move",this.onItemMove,this),this.item.on("resize",this.onItemMove,this),this.onItemMove()},extend:"Workspace.tools.Handle",drag:function(){},dragStartHandler:function(){this.callParent(arguments)},dragEndHandler:function(){if(this.dragging){var a=this.item.get("points"),b=this.snap(this.getPosition());a[this.index]=[b.x,b.y],this.item.set("points",a)}this.callParent(arguments)},getPoint:function(){return this.item?this.item.get("points")[this.index]:[0,0]},onItemMove:function(){this.move(this.getPoint())},move:function(a){this.setPosition(a[0],a[1])},snap:function(a){return this.constrain&&(a=this.constrain(a,this)),a},destroy:function(){this.callParent(arguments),this.item.un("move",this.onItemMove,this),this.item.un("resize",this.onItemMove,this),this.item.un("change:points",this.onItemMove,this)}});
Ext.define("Workspace.tools.CodeMirrorTool",{constructor:function(a,b){Workspace.tools.CodeMirrorTool.superclass.constructor.call(this,a,b)},extend:"Workspace.tools.BaseTool",click:function(a,b){},dblclick:function(a,b){},mousedown:function(a,b){},mouseup:function(a,b){},mousemove:function(a,b){},attach:function(a){if(a.element){this.item=a;var b=this;return this.endEditFunction=function(){this.workspace.endEdit()},this.item.codemirror.setOption("onBlur",_.bind(this.endEditFunction,this)),this.item.updateCodeMirrorOption("readOnly",!1),this.item.codemirror.focus(),!0}return!1},detach:function(){this.item&&(this.item.codemirror.setOption("onBlur",null),this.item.set("text",this.item.codemirror.getValue()),this.item.updateCodeMirrorOption("readOnly","nocursor"),this.item=!1)},activate:function(){this.callParent(arguments)},deactivate:function(){this.callParent(arguments),this.detach()}},function(){Workspace.Tools.register("codemirror",Workspace.tools.CodeMirrorTool)});
Ext.define("App.usr.js.Editor",{extend:"App.usr.text.Editor",iconCls:"js",editorType:"JS",title:"Javascript",mode:"javascript",mixins:{refHelper:"App.ui.RefHelper"},initComponent:function(){var a=this.mode;!this.json||(a={name:"javascript",json:!0},this.editorType="JSON"),Ext.applyIf(this,{tbar:[{text:"Run",iconCls:"run",ref:"runButton",xtype:"splitbutton",menu:this.buildAppMenu(),handler:function(){this.executeInContext(this)},scope:this},"->",Ext.create("App.ui.SaveButton",{text:"Save",iconCls:"save",app:this})],items:[{xtype:"codemirror",itemId:"editor",border:!1,mode:a}]}),this.callParent(arguments),this.mixins.refHelper.init.apply(this),this.runButton.on("arrowclick",function(a){a.menu=this.buildAppMenu()},this)},buildAppMenu:function(){return App.ui.Launcher.getAppMenu(Ext.bind(function(a){this.executeInContext(a)},this))},executeInContext:function(a){App.ui.Launcher.console.executeInContext(this.getValue(),a,!0)}});
Ext.define("App.usr.dynaml.Editor",{extend:"App.usr.text.Editor",iconCls:"dynaml",editorType:"DyNAML",requires:["App.usr.nodal.LibraryWindow","App.usr.nupack.Editor","App.ui.CodeMirror"],trap:!0,initComponent:function(){Ext.apply(this,{mode:{name:"javascript",json:!0},tbar:[{xtype:"splitbutton",text:"Compile",iconCls:"compile",handler:this.compileDynamicServer,scope:this,menu:[{text:"Compile locally",handler:this.compileDynamicLocal,scope:this}]},{text:"Format",iconCls:"edit",handler:function(){this.editor.autoFormatSelection()},scope:this},"->",Ext.create("App.ui.SaveButton",{app:this})]}),this.callParent(arguments)},compileDynamicServer:function(){var a=this.getValue(),b=this.doc.getDocumentPath();App.runTask("Nodal",{node:b,data:a,action:"dynamic"},_.bind(function(){Ext.msg("Nodal Build","Build of system <strong>{0}</strong> completed.",this.doc.getBasename())},this))},compileDynamicLocal:function(){var a;if(this.trap)try{a=this.compile()}catch(b){App.log(b.message,{level:"error"})}else a=this.compile();a&&(this.lastLibrary=a,this.showLibraryTreeWindow())},showLibraryTreeWindow:function(){!this.libraryTreeWindow&&this.lastLibrary?this.libraryTreeWindow=Ext.create("App.usr.nodal.LibraryWindow",{lastLibrary:this.lastLibrary}):this.lastLibrary&&this.libraryTreeWindow.setLibrary(this.lastLibrary),this.libraryTreeWindow.show()},compile:function(){var a=this.getValue(),b=jsonlint.parse(a);return App.dynamic.Compiler.compile(this.getValue())},printStrands:function(a,b){return App.dynamic.Compiler.printStrands(a,b)}});
Ext.define("App.usr.nodal.ws.objects.Complement",{extend:"Workspace.objects.Connection",showLabel:!1,property:"complementarity",thetaProperty:"rotation",dthetaProperty:"dtheta",render:function(){this.callParent(),this.set("strokeWidth",1.5),this.set("stroke","#aaa"),this.set("arrowEnd","classic-wide-long")},strokeWidth:1.5,arrowEnd:"classic-wide-long",stroke:"#999",acceptLeft:function(a){return a.getId&&a.isWType(["App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.BridgePort"])},acceptRight:function(a){return a.getId&&a.isWType(["App.usr.nodal.ws.objects.InputPort","App.usr.nodal.ws.objects.BridgePort"])},canConnect:function(a,b){var c=a.getParent(),d=b.getParent();return(a.isWType("App.usr.nodal.ws.objects.OutputPort")&&b.isWType("App.usr.nodal.ws.objects.InputPort")||a.isWType("App.usr.nodal.ws.objects.BridgePort")&&b.isWType("App.usr.nodal.ws.objects.BridgePort"))&&(c&&d?c.getParent()==d.getParent():!1)}},function(){Workspace.reg("App.usr.nodal.ws.objects.Complement",App.usr.nodal.ws.objects.Complement),Workspace.regAlias("Workspace.objects.dna.Complementarity","App.usr.nodal.ws.objects.Complement")});
Ext.define("App.usr.nodal.ws.tools.ComplementarityTool",{extend:"Workspace.tools.ConnectorTool",requires:["App.usr.nodal.ws.objects.Complement"],parameters:{"arrow-end":"classic-wide-long","stroke-dasharray":".",stroke:"#aaa","stroke-width":1.5},acceptLeft:function(){return App.usr.nodal.ws.objects.Complement.prototype.acceptLeft.apply(this,arguments)},acceptRight:function(){return App.usr.nodal.ws.objects.Complement.prototype.acceptRight.apply(this,arguments)},canConnect:function(){return App.usr.nodal.ws.objects.Complement.prototype.canConnect.apply(this,arguments)},onConnect:function(a,b,c){b.isWType("App.usr.nodal.ws.objects.BridgePort")&&c.isWType("App.usr.nodal.ws.objects.BridgePort")&&(a.setBoth=!0,a.updateProperty())},targetWType:"App.usr.nodal.ws.objects.Complement"},function(){Workspace.Tools.register("complementarity",App.usr.nodal.ws.tools.ComplementarityTool)});
Ext.define("App.usr.canvas.FillStrokeTab",{extend:"App.ui.BoundObjectPanel",alias:"widget.fillstroketab",initComponent:function(){Ext.apply(this,{tbar:[{xtype:"buttongroup",title:"Fill",columns:1,defaults:{cellCls:"table-cell-padded"},items:[new Ext.ux.ColorField({ref:"../../fillColorField",objectBinding:"fill",anchor:"left",width:100,tooltip:{title:"Fill Color",text:"Color of the object's background (fill)."},cellCls:"table-cell-padded-right"}),{ref:"../../fillOpacityField",xtype:"slider",objectBinding:"fillOpacity",objectBindingEvent:"changecomplete",minValue:0,maxValue:1,decimalPrecision:2,animate:!0,tipText:function(a){return String(a.value*100)+"%"},cellCls:"table-cell-padded-right",width:100,tooltip:{title:"Fill Opacity",text:"Opacity/transparency of the stroke."}}]},{xtype:"buttongroup",title:"Stroke",columns:2,defaults:{cellCls:"table-cell-padded"},items:[new Ext.ux.ColorField({ref:"../../strokeColorField",anchor:"left",objectBinding:"stroke",width:100,tooltip:{title:"Stroke Color",text:"Color of the object's outline (stroke)."}}),{ref:"../../strokeTypeField",xtype:"combo",objectBinding:"strokeDasharray",store:new Ext.data.ArrayStore({fields:["name","dash_array"],data:[["solid",""],["dashed","--"],["dashed","-"],["dashed","- "],["dotted","."],["dotted",". "],["dashed/dotted","-."],["dashed/dotted","-.."],["dashed/dotted","- ."],["dashed/dotted","--."],["dashed/dotted","--.."]]}),listConfig:{getInnerTpl:function(){return"<span>{name}</span>&nbsp;(<var>{dash_array}</var>)</span>"}},valueField:"dash_array",displayField:"dash_array",typeAhead:!0,mode:"local",forceSelection:!0,triggerAction:"all",selectOnFocus:!0,width:100,tooltip:{title:"Stroke Type",text:"Style of the stroke (solid, dashed, etc.)."},cellCls:"table-cell-padded-right"},{ref:"../../strokeOpacityField",xtype:"slider",objectBinding:"strokeOpacity",objectBindingEvent:"changecomplete",minValue:0,maxValue:1,decimalPrecision:2,animate:!0,tipText:function(a){return String(a.value*100)+"%"},width:100,tooltip:{title:"Stroke Opacity",text:"Opacity/transparency of the stroke."}},{ref:"../../strokeWidthField",xtype:"slider",objectBinding:"strokeWidth",objectBindingEvent:"changecomplete",minValue:0,maxValue:10,decimalPrecision:1,increment:.5,animate:!0,tipText:function(a){return String(a.value)+" px"},width:100,cellCls:"table-cell-padded-right",tooltip:{title:"Stroke Width",text:"Width of the object's outline (stroke)."}}]}]}),App.usr.canvas.FillStrokeTab.superclass.initComponent.apply(this,arguments)}});
Ext.define("App.usr.nodal.ws.tools.ExposureTool",{extend:"Workspace.tools.ConnectorTool",requires:["App.usr.nodal.ws.objects.Exposure"],parameters:{"arrow-end":"classic-wide-long","stroke-dasharray":".",stroke:"#aaa","stroke-width":1.5},acceptLeft:function(){return App.usr.nodal.ws.objects.Exposure.prototype.acceptLeft.apply(this,arguments)},acceptRight:function(){return App.usr.nodal.ws.objects.Exposure.prototype.acceptRight.apply(this,arguments)},canConnect:function(){return App.usr.nodal.ws.objects.Exposure.prototype.canConnect.apply(this,arguments)},beforeConnect:function(a,b){if(b.hasWType("App.usr.nodal.ws.objects.Motif")){var c=this.workspace.buildManager.buildPort({wtype:a.get("wtype")});b.adopt(c),this.rightObject=c}},targetWType:"App.usr.nodal.ws.objects.Exposure"},function(){Workspace.Tools.register("exposure",App.usr.nodal.ws.tools.ExposureTool)});
Ext.define("App.usr.nodal.PortInspector",{extend:"Ext.form.Panel",title:"Port",bodyPadding:5,enableBoundFields:!0,initComponent:function(){Ext.apply(this,{defaults:{xtype:"textfield"},fieldDefaults:{labelWidth:100},items:[{objectBinding:"name",anchor:"100%"},{objectBinding:"footprint",fieldLabel:"Footprint",xtype:"displayfield"},{objectBinding:"computedPolarity",fieldLabel:"Polarity",xtype:"displayfield"}],showIf:function(a){return a=="App.usr.nodal.ws.objects.InputPort"||a=="App.usr.nodal.ws.objects.OutputPort"||a=="App.usr.nodal.ws.objects.BridgePort"}}),this.callParent(arguments),this.mixins.boundObjectPanel.initialize.apply(this,arguments)},mixins:{boundObjectPanel:"App.ui.BoundObjectPanel"}});
Ext.ns("App.usr.nodal.ws.objects"),App.usr.nodal.ws.objects.Motifs=function(){var a=App.dynamic.Library.dummy();return _.reduce(_.deepClone(App.dynamic.Compiler.standardMotifs),function(b,c,d){return c.library=a,b[d]=new App.dynamic.Motif(c),b},{})}(),App.usr.nodal.ws.objects.MotifLibraries=function(){var a=[];for(var b=0,c=App.dynamic.Compiler.standardMotifsVersions.length;b<c;b++){var d=App.dynamic.Library.dummy();a.push(_.reduce(_.deepClone(App.dynamic.Compiler.standardMotifsVersions[b]),function(a,b,c){return b.library=d,a[c]=new App.dynamic.Motif(b),a},{}))}return a}(),App.usr.nodal.ws.objects.PortClasses={input:"App.usr.nodal.ws.objects.InputPort",init:"App.usr.nodal.ws.objects.OutputPort",output:"App.usr.nodal.ws.objects.OutputPort",bridge:"App.usr.nodal.ws.objects.BridgePort"},App.usr.nodal.ws.objects.Ports={input:{wtype:"App.usr.nodal.ws.objects.InputPort",stroke:"orange"},init:{wtype:"App.usr.nodal.ws.objects.OutputPort",stroke:"#553300"},green:{wtype:"App.usr.nodal.ws.objects.OutputPort",stroke:"#66ff33"},blue:{wtype:"App.usr.nodal.ws.objects.OutputPort",stroke:"#33ccff"},pink:{wtype:"App.usr.nodal.ws.objects.BridgePort",stroke:"#ff1177"},purple:{wtype:"App.usr.nodal.ws.objects.BridgePort",stroke:"#9900cc"}},App.usr.nodal.ws.objects.motifStore=function(){var a=[],b=0;for(var c in App.usr.nodal.ws.objects.Motifs)a[b]={number:c,spec:App.usr.nodal.ws.objects.Motifs[c]},b++;return Ext.define("Motif",{extend:"Ext.data.Model",fields:[{name:"number",type:"string"},{name:"spec",type:"auto"}]}),Ext.create("Ext.data.Store",{data:a,model:"Motif"})}(),Ext.define("App.usr.nodal.ws.objects.MotifStore",{extend:"Ext.data.Store",model:App.usr.nodal.ws.objects.motifStore.model,loadFromHash:function(a){var b=[];for(var c in a)b.push({number:c,spec:a[c]});this.add(b)}});
Ext.define("App.usr.nodal.MotifPalette",{extend:"App.usr.canvas.Palette",requires:["App.usr.nodal.ws.objects.Motifs"],tpl:'<tpl for="."><div class="motif-template"></div></tpl><div class="x-clear" />',itemSelector:"div.motif-template",mimeType:"ext/motif",overflow:"auto",constructor:function(a){a.store||Ext.applyIf(a,{store:App.usr.nodal.ws.objects.motifStore}),this.callParent(arguments),this.view.on("itemupdate",this.redrawMotif,this)},onRefresh:function(){this.drawMotifs()},drawMotifs:function(){var a=this.view.getStore(),b=this.view;this.papers||(this.papers={}),_.each(a.getRange(),function(a){var c=b.getNode(a);this.redrawMotif(a,null,c)},this)},redrawMotif:function(a,b,c){c=Ext.get(c);var d=c.id,e=this.papers[d]&&b==null||(this.papers[d]=Raphael(c.dom,c.getWidth(),c.getHeight()));this.drawMotif(e,a.get("spec"))},drawMotif:function(a,b){var c=a.width*.35,d=a.width/2,e=a.height/2;a.clear(),a.add([{type:"circle",cx:d,cy:e,r:c,rx:c,ry:c,stroke:"#000","stroke-width":2.5},{type:"text",text:b.name,"text-anchor":"middle",x:d,y:e}]);var f=_.filter(b.getDomains(),function(a){return a.role!="null"&&a.role!="structural"}),g=Math.PI,h=2*Math.PI/f.length,i=[];_.each(f,function(b,f){var j=4,k=g+f*h,l={cx:d+c*Math.cos(k),cy:e+c*Math.sin(k),x:d+c*Math.cos(k)-j,y:e+c*Math.sin(k)-j,transform:"r"+(k+(b.role=="input"?32:0))*180/Math.PI,width:2*j,height:2*j,fill:"#fff",stroke:App.dynamic.Compiler.getColor(b),"stroke-width":2};if(b.role=="input"){var m=a.triangle(l.cx,l.cy,j,j);m.attr(l)}else if(b.role=="bridge"){var m=a.square(l.cx,l.cy,j,j);m.attr(l)}else l.type="circle",l.r=j,i.push(l)}),a.add(i)}});
Ext.define("App.usr.nodal.StrandPreview",{extend:"App.ui.ProtovisPanel",viewBox:!0,built:!1,adjacencyMode:2,labelBases:!1,setValue:function(a,b){a?(this.adjacencyMode==2?this.nodeLayout=DNA.generateAdjacency2(a,{linkStrands:!0}):(!b||(b=["A"]),this.nodeLayout=DNA.generateAdjacency(a,b,!0)),this.built?(this.force.reset(),this.force.nodes(this.nodeLayout.nodes).links(this.nodeLayout.links)):this.buildVis(),this.vis.render()):(this.force.reset(),this.vis.render())},updateVis:function(){},buildVis:function(){this.nodeLayout||(this.value&&this.setValue(this.value),this.nodeLayout={nodes:[],links:[]}),this.getCanvas();var a=this.vis;a.fillStyle("white"),colors=pv.Colors.category10(),probColors=pv.Scale.linear(0,.5,1).range("rgba(0,0,180,1)","rgba(180,180,0,1)","rgba(180,0,0,1)"),this.force=a.add(pv.Layout.Force).chargeConstant(-250).springConstant(.95).dragConstant(.4).bound(!1),this.force.nodes(this.nodeLayout.nodes).links(this.nodeLayout.links),this.adjacencyMode==2?(this.force.link.add(pv.Line).strokeStyle(function(a,b){return b.probability?probColors(b.probability):"rgba(0,0,0,0.2)"}),this.force.node.add(pv.Dot).size(function(a){return 10}).fillStyle(function(a){return App.dynamic.Compiler.domainColors[a.role]||"#000"}).strokeStyle(function(){return this.fillStyle().darker()}).lineWidth(1).title(function(a){return a.nodeName}).event("mousedown",pv.Behavior.drag()).event("drag",this.force),this.labelBases&&this.force.label.add(pv.Label).text(function(a,b){return a.base})):(this.force.link.add(pv.Line).strokeStyle(function(a,b){return b.probability?probColors(b.probability):"rgba(0,0,0,0.2)"}),this.force.node.add(pv.Dot).size(function(a){return 10}).fillStyle(function(a){return a.fix?"brown":colors(a.strand)}).strokeStyle(function(){return this.fillStyle().darker()}).lineWidth(1).title(function(a){return a.nodeName})),this.built=!0}});
Ext.define("App.usr.enum.Viewer",{extend:"App.ui.D3Panel",requires:["App.usr.nodal.StrandPreview"],mixins:{app:"App.ui.Application"},editorType:"Enumerator",autoRender:!1,iconCls:"enum-icon",fontSize:1,linkWidth:2,arrowThreshold:.25,highlightLinkWidth:2,createTip:!0,tipDelegate:"rect",constructor:function(){this.callParent(arguments),this.mixins.app.constructor.apply(this,arguments),this.on("afterrender",this.loadFile,this),this.complexWindows={},this.previewPanels={},this.currentScale=1},onLoad:function(){this.afterrender()},redraw:function(a,b){var c=this;this.currentScale=b,this.callParent(arguments),this.node.selectAll("text.node-label").style("font-size",this.fontSize/b+"em"),this.node.selectAll("rect.complex").style("stroke-width",this.linkWidth/b),this.link.style("stroke-width",this.linkWidth/b),this.link.selectAll("link-reaction-reactant, link-reaction-product").style("stroke-width",c.highlightLinkWidth*c.linkWidth/c.currentScale),this.link.classed("link-reaction-noarrow",b<this.arrowThreshold)},initComponent:function(){this.callParent(arguments),this.on("afterrender",function(){this.createTip&&(this.tip=Ext.create("Ext.tip.ToolTip",{target:this.getEl(),delegate:this.tipDelegate,trackMouse:!0,showDelay:!1,renderTo:Ext.getBody(),listeners:{beforeshow:{fn:this.updateTipBody,scope:this}}}),this.sequenceRenderer=CodeMirror.modeRenderer("sequence"))},this)},loadData:function(){var a=this.data=JSON.parse(this.data),b=this.initial_complexes=_.reduce(a.initial_complexes,function(a,b){return a[b.name]=!0,a},{}),c=this.reactions=a.reactions,d=a.domains,e={};for(var f=0;f<d.length;f++){var g=d[f];e[g.name]={sequence:Array(g.length+1).join("N"),name:g.name}}var h=a.strands,i={};for(var f=0;f<h.length;f++){var j=h[f];j.domains=_.map(j.domains,function(a){return e[a]}),j.domains=[j.domains],i[j.name]=j}var k;a.transient_complexes?k=_.map(a.resting_complexes,function(a){return a.resting=!0,a}).concat(_.map(a.transient_complexes,function(a){return a.transient=!0,a})):k=_.map(a.resting_complexes,function(a){return a.resting=!0,a});var l=this.restingStateMap={};if(a.resting_states)for(var f=0;f<a.resting_states.length;f++){var m=a.resting_states[f];for(var n=0;n<m.complexes.length;n++)l[m.complexes[n]]=m.name}var o=this.complexData=_.map(k,function(a,c){return a._type="complex",!b[a.name]||(a.initial=!0),l[a.name]?a.group=l[a.name]:a.group=null,a._index=c,a.strands=_.map(a.strands,function(a){return i[a]}),a}),p=this.complexMap=_.reduce(o,function(a,b,c){return a[b.name]=b,a},{}),q=this.reactionData=_.map(c,function(a,b){a._type="reaction",a.name="reaction_"+b,a._index=b+o.length,a.fast=!(a.reactants.length>1),a.slow=!a.fast,a.group=p[a.reactants[0]].group;for(var c=0;c<a.reactants.length;c++)if(p[a.reactants[c]].group!=a.group){a.outgoing=!0,a.group=null;break}if(!a.outgoing)for(var c=0;c<a.products.length;c++)if(p[a.products[c]].group!=a.group){a.outgoing=!0,a.group=null;break}return a})},buildVis:function(){function b(a){return a.size?"_g_"+a.group:a.name}function c(a){var c=b(a.source),d=b(a.target);return c<d?c+"|"+d:d+"|"+c}function f(a){var b=a.dagre.points.slice(0),c=dagre.util.intersectRect(a.source.dagre,b[0]),e=dagre.util.intersectRect(a.target.dagre,b[b.length-1]);return b.unshift(c),b.push(e),d(b)}function C(a){return a._type=="complex"?a.strands.length*50:t}function D(a){var b=d3.scale.ordinal().range(colorbrewer.BuPu[4]),c=d3.scale.ordinal().range(colorbrewer.OrRd[4]);o.selectAll("path.link-reaction").classed("link-reaction-blurred",!0),o.selectAll("g.enum-node").classed("node-blurred",!0),o.selectAll('g.enum-node[name="'+a.name+'"]').classed("node-blurred",!1),o.selectAll("path.link-reaction.source-"+a.name).each(function(a,b){o.selectAll('g.enum-node[name="'+a.target.name+'"]').classed("node-blurred",!1)}).classed("link-reaction-blurred",!1).classed("link-reaction-reactant",!0).style("stroke",function(a){return c(a.target.name)}).style("stroke-width",y.highlightLinkWidth*y.linkWidth/y.currentScale),o.selectAll("path.link-reaction.target-"+a.name).each(function(a,b){o.selectAll('g.enum-node[name="'+a.source.name+'"]').classed("node-blurred",!1)}).classed("link-reaction-blurred",!1).classed("link-reaction-product",!0).style("stroke",function(a){return b(a.source.name)}).style("stroke-width",y.highlightLinkWidth*y.linkWidth/y.currentScale)}function E(){o.selectAll("path.link-reaction").classed("link-reaction-blurred",!1).classed("link-reaction-reactant",!1).classed("link-reaction-product",!1).style("stroke",null).style("stroke-width",y.linkWidth/y.currentScale),o.selectAll("g.enum-node").classed("node-blurred",!1)}function F(a,b,d){var e=a.selectAll("path.link-reaction").data(b.links,c);return e.exit().remove(),e.enter().append("path").attr("class",function(a){var b=["link-reaction"];return b.push("source-"+a.source.name),b.push("target-"+a.target.name),b.join(" ")}).attr("x1",function(a){return a.source.x}).attr("y1",function(a){return a.source.y}).attr("x2",function(a){return a.target.x}).attr("y2",function(a){return a.target.y}).style("stroke-width",function(a){return a.size||1}).style("fill","none").classed("link-reaction-noarrow",!1),e}function G(a,c,d){var e=a.selectAll("g.enum-node").data(c.nodes,b);return e.exit().remove(),e.enter().append("g").attr("class","enum-node").attr("transform",function(a){return"translate("+a.x+","+a.y+")"}).attr("name",function(a){return a.name}).on("mouseover",D).on("mouseout",E).on("dblclick",function(a){if(a._type=="complex"){var b=d3.select(this).select("svg");d.renderPreview(a,b.node()),d3.event.stopPropagation()}else a._type=="reaction"&&d.showReaction(a,this)}),e.append("text").attr("class","node-label").attr("dx",function(a){return C(a)+5}).attr("dy",".35em").text(function(a){return a._type=="complex"?a.name:""}),e.append("rect").attr("class",function(a){switch(a._type){case"complex":return"complex "+(a.resting?"complex-resting":"complex-transient");case"reaction":return""+(a.fast?"reaction-fast":"reaction-slow");default:if(a.size!=0)return"resting-state";return""}}).attr("width",C).attr("height",C).attr("rx",function(a){switch(a._type){case"complex":return 10;default:return a.size?a.size+t:t+1}}).attr("ry",function(a){switch(a._type){case"complex":return 10;default:return a.size?a.size+t:t+1}}),e.append("svg").attr("width",C).attr("height",C),e.each(function(a){var b=this.getBBox();a.bbox=b,a.width=b.width+2*x,a.height=b.height+2*x}),e}function H(a,b){var c=a.selectAll("g.legend").data([{name:"Resting Complex",type:"resting"},{name:"Transient Complex",type:"transient"},{name:"Fast (unimolecular) Reaction",type:"reaction-fast"},{name:"Slow (bimolecular) Reaction",type:"reaction-slow"},{name:"Initial Complex",type:"initial"}]).enter().append("g").attr("class","legend").attr("transform",function(a,b){return"translate(15,"+(20*b+15)+")"});return c.append("circle").attr("fill",function(a){return A[a.type]}).attr("stroke",function(a){return B[a.type]}).attr("r",8).attr("stroke-width",2),c.append("text").style("fill","#111").text(function(a){return a.name}).attr("dx",function(a){return C(a)+5}).attr("dy",".35em"),c}function I(){var a={links:m,nodes:l};y.link=F(q,a,y),y.node=G(r,a,y),dagre.layout().nodeSep(50).edgeSep(10).rankSep(50).nodes(a.nodes).edges(a.links).debugLevel(1).run(),y.link.each(function(a){var b=a.dagre.points;if(!b.length){var c=e.source.dagre,d=e.target.dagre;b.push({x:Math.abs(c.x-d.x)/2,y:Math.abs(c.y+d.y)/2})}b.length===1&&b.push({x:b[0].x,y:b[0].y})}),y.node.attr("transform",function(a){return"translate("+(a.dagre.x-a.dagre.width/2)+","+(a.dagre.y-a.dagre.height/2)+")"}),y.link.attr("id",function(a){return a.dagre.id}).attr("d",function(a){return f(a)});var b=o.node().getBBox();o.attr("width",b.width+10),o.attr("height",b.height+10),y.rect.attr("width",b.width+10),y.rect.attr("height",b.height+10)}var a=d3.scale.category20(),d=d3.svg.line().x(function(a){return a.x}).y(function(a){return a.y}).interpolate("bundle").tension(.6);this.loadData();var g=this.complexes,h=this.complexData,i=this.complexMap,j=this.reactionData,k=this.reactions,l=_.map(h.concat(j),function(a){return a.edges||(a.edges=[]),a}),m=_.flatten(_.map(k,function(a){return _.map(a.reactants,function(b){var c={source:i[b],target:a};return i[b].edges.push(c),a.edges.push(c),c}).concat(_.map(a.products,function(b){var c={source:a,target:i[b]};return a.edges.push(c),i[b].edges.push(c),c}))}),!0),n={nodes:i,links:m},o=this.getCanvas(),p="#aaa";o.append("svg:defs").selectAll("marker").data(["reaction-arrow"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",-1).attr("markerWidth",4).attr("markerHeight",4).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").style("stroke",p).style("fill",p);var q=this.linkg=o.append("g"),r=this.nodeg=o.append("g"),s=this.legendg=o.append("g"),t=50,u=100,v=15,w=50,x=0,y=this,z,A,B;A=z={reaction:"","reaction-fast":"#01c","reaction-slow":"#a00","transient":"#fff",complex:"#fff",resting:"#fff",initial:"#fff"},B={"reaction-fast":"#fff","reaction-slow":"#fff","transient":"#ddd",complex:"#ddd",initial:"yellow",resting:"#ddd"},y.legend=H(s,y),I()},showReaction:function(a,b){if(a._type=="reaction"){var c=this,d=_.map(a.reactants,function(a){return c.complexMap[a]}),e=_.map(a.reactants,function(a){return c.complexMap[a]});this.reactionPanel||(this.reactionPanel=Ext.create("App.usr.enum.ReactionViewer"),this.reactionWindow=Ext.create("Ext.window.Window",{items:[this.reactionPanel],layout:"fit",width:700,height:200,border:!1,bodyBorder:!1,segmentColors:this.getSegmentColorScale(),strandColors:this.getStrandColorScale()})),this.reactionWindow.show(),this.reactionPanel.setValue(a,d,e)}},updateTipBody:function(a){var b=Ext.get(a.triggerElement).up("g");if(b){b=d3.select(b.dom);if(!b.classed("enum-node"))return!1;var c=b.datum();a.update(this.getTipBody(c))}},getTipBody:function(a){var b="";switch(a._type){case"complex":b+="Complex <b>"+a.name+"</b><br />",b+='<div class="enum-strands-well">'+_.map(a.strands,function(a){return"<b>"+a.name+"</b>"}).join(" + ")+"</div>",a.initial&&(b+="<b>Initial Complex</b><br />"),a.resting&&(b+="<b>Resting State</b><br />"),a["transient"]&&(b+="<b>Transient</b><br />");break;case"reaction":var c;switch(a.reactants.length){case 1:c="Unimolecular";break;case 2:c="Bimolecular";break;case 3:c="Trimolecular";break;default:c="High order"}b+="<b>"+c+"</b> Reaction<br />",b+='<div class="enum-reaction-well">',b+=_.map(a.reactants,function(a){return"<b>"+a+"</b>"}).join(" + "),b+=" &rarr; ",b+=_.map(a.products,function(a){return"<b>"+a+"</b>"}).join(" + "),b+="</div><br />",a.fast&&(b+="<b>Fast</b><br />"),a.slow&&(b+="<b>Slow</b><br />")}return b},renderPreview:function(a,b){var c=a["dot-paren-full"]?a["dot-paren-full"]:a["dot-paren"],d=a.strands||null,e=d3.select(b),f={dotParen:c,strands:d};this.previewPanels[a.name]=StrandPreview(e).width(a.width).height(a.height).segmentColors(this.getSegmentColorScale()).strandColors(this.getStrandColorScale()),this.complexWindows[a.name]=this.previewPanels[a.name](e.data([f]))},getSegmentColorScale:function(){return this.segmentColors||(this.segmentColors=d3.scale.category20()),this.segmentColors},getStrandColorScale:function(){return this.strandColors||(this.strandColors=d3.scale.category20()),this.strandColors}}),Ext.define("App.ui.PlusPanel",{extend:"App.ui.D3Panel",autoRender:!0,border:!1,bodyBorder:!1,pan:!1,zoom:!1,buildVis:function(){var a=this.getCanvas(),b=d3.svg.symbol().type("cross");this.path=a.append("path").attr("d",b()).attr("transform","translate("+this.getWidth()/2+","+this.getHeight()/2+")")},updateVis:function(){this.path.attr("transform","translate("+this.getWidth()/2+","+this.getHeight()/2+")")},width:50}),Ext.define("App.ui.ArrowPanel",{extend:"App.ui.D3Panel",autoRender:!0,border:!1,bodyBorder:!1,pan:!1,zoom:!1,buildVis:function(){var a=this.getCanvas();a.append("svg:defs").selectAll("marker").data(["reaction-arrow-large"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",0).attr("refY",-1).attr("markerWidth",4).attr("markerHeight",4).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").style("stroke","#000").style("fill","#000"),this.path=a.append("path").attr("d","M-5,0L5,0").attr("marker-end","url(#reaction-arrow-large)").style("stroke-width","2px").style("stroke","#000").style("fill","#000")},updateVis:function(){this.path.attr("transform","translate("+this.getWidth()/2+","+this.getHeight()/2+")")},width:50}),Ext.define("App.usr.enum.ReactionViewer",{extend:"Ext.panel.Panel",requires:["App.usr.nodal.StrandPreview"],layout:"hbox",align:"stretch",border:!1,bodyBorder:!1,constructor:function(){this.reactant1=Ext.create("App.ui.StrandPreview",{cls:"simple-header",title:" ",autoRender:!0,value:"",adjacencyMode:2,flex:1,border:!1,bodyBorder:!1}),this.reactant_plus=Ext.create("App.ui.PlusPanel"),this.reactant2=Ext.create("App.ui.StrandPreview",{cls:"simple-header",title:" ",autoRender:!0,value:"",adjacencyMode:2,flex:1,border:!1,bodyBorder:!1}),this.reaction_arrow=Ext.create("App.ui.ArrowPanel"),this.product1=Ext.create("App.ui.StrandPreview",{cls:"simple-header",title:" ",autoRender:!0,value:"",adjacencyMode:2,flex:1,border:!1,bodyBorder:!1}),this.product_plus=Ext.create("App.ui.PlusPanel"),this.product2=Ext.create("App.ui.StrandPreview",{cls:"simple-header",title:" ",autoRender:!0,value:"",adjacencyMode:2,flex:1,border:!1,bodyBorder:!1}),Ext.apply(this,{layout:{type:"hbox",align:"stretch"},defaults:{bodyBorder:!1,border:!1},items:[this.reactant1,this.reactant_plus,this.reactant2,this.reaction_arrow,this.product1,this.product_plus,this.product2]}),this.callParent(arguments)},setValue:function(a,b,c){var d=[this.reactant1,this.reactant2],e=[this.product1,this.product2];for(var f=0;f<Math.min(d.length,b.length);f++){var g=b[f],h=g["dot-paren-full"]?g["dot-paren-full"]:g["dot-paren"],i=g.strands;d[f].setValue({dotParen:h,strands:i}),d[f].setTitle(_.map(i,function(a){return a.name}).join(" + "))}b.length<2?(this.reactant2.hide(),this.reactant_plus.hide()):(this.reactant2.show(),this.reactant_plus.show());for(var f=0;f<Math.min(e.length,c.length);f++){var g=b[f],h=g["dot-paren-full"]?g["dot-paren-full"]:g["dot-paren"],i=g.strands;e[f].setValue({dotParen:h,strands:i}),e[f].setTitle(_.map(i,function(a){return a.name}).join("+"))}c.length<2?(this.product2.hide(),this.product_plus.hide()):(this.product2.show(),this.product_plus.show())},getSegmentColorScale:function(){return this.segmentColors||(this.segmentColors=d3.scale.category20()),this.segmentColors},getStrandColorScale:function(){return this.strandColors||(this.strandColors=d3.scale.category20()),this.strandColors}});
Ext.define("App.usr.nodal.NodeInspector",{requires:["App.usr.nodal.StrandPreview"],extend:"Ext.form.Panel",title:"Node",bodyPadding:5,enableBoundFields:!0,initComponent:function(){var a=this;Ext.apply(this,{defaults:{xtype:"textfield"},fieldDefaults:{labelWidth:100},items:[{objectBinding:"name",anchor:"100%"},{xtype:"displayfield",fieldLabel:"Definition",labelAlign:"top",objectBinding:"strands",valueToRaw:function(a){return a||[]},renderer:function(a){return a||(a=[]),_.map(a,function(a){return'<div class="strand-glyph-container'+(a?"":" strand-glyph-unknown")+'">'+'<span class="strand-glyph-name">'+a.name+"</span>"+_.map(a.getDomains(),function(a){return'<div class="domain-glyph domain-glyph-'+a.role+'">'+(a.name?'<span class="domain-glyph-name">'+a.name+"</span>":"")+_.map(a.getSegments(),function(a){return'<span class="segment-glyph segment-glyph-'+a.role+'">'+a.identity+"</span>"+(a.polarity==-1?"<sup>*</sup>":"")}).join(" ")+"</div>"}).join(" ")+"</div>"}).join(" + ")}},Ext.create("App.ui.StrandPreview",{objectBinding:"annotatedStructure",loopMode:"linear",items:[],height:150,anchor:"100%",resizable:!0}),{xtype:"combo",store:App.usr.nodal.ws.objects.motifStore,queryMode:"local",displayField:"number",valueField:"number",forceSelection:!1,fieldLabel:"Motif",objectBinding:"motif",anchor:"100%",margin:"5 0 5 0"},{xtype:"numberfield",fieldLabel:"Polarity",objectBinding:"polarity",minValue:-1,maxValue:1,step:1,anchor:"100%"},{xtype:"sliderfield",fieldLabel:"Rotation",minValue:0,maxValue:360,width:100,increment:15,anchor:"100%",objectBinding:"theta",tipText:function(a){return String(a.value)+"°"}}],showIf:function(a){return a=="App.usr.nodal.ws.objects.Node"}}),this.callParent(arguments),this.mixins.boundObjectPanel.initialize.apply(this,arguments)},getBoundObject:function(){return this.boundObjects.getAt(0)},mixins:{boundObjectPanel:"App.ui.BoundObjectPanel"}});
Ext.define("App.usr.canvas.ObjectProperties",{extend:"App.ui.BoundObjectPanel",enableBoundFields:!1,constructor:function(){App.usr.canvas.ObjectProperties.superclass.constructor.apply(this,arguments)},initComponent:function(){this.grid=Ext.create("Ext.grid.property.Grid",{border:!1,bodyBorder:!1,source:{},title:"All Properties"}),this.selection=[],this.items=this.items||[],this.items.push(this.grid),Ext.apply(this,{title:"Selected Object",layout:"accordion"}),this.callParent(arguments),this.grid.on("propertychange",this.onPropertyChange,this),this.boundObjectPanels=Ext.create("Ext.util.MixedCollection"),this.boundObjectPanels.addAll(this.query("component[bind]")),this.boundObjectPanels.each(function(a){this.mon(a,"action",this.doAction,this),a.init&&a.init()},this)},doAction:function(a){var b=a.getUndo();this.workspace.doAction(a)},onSelectionChange:function(){var a=_.difference(this.workspace.getSelection(),this.selection),b=_.difference(this.selection,this.workspace.getSelection());_.each(a,function(a){this.bind(a)}),_.each(b,function(a){this.unbind(a)}),this.selection=this.workspace.getSelection()},bind:function(a){this.unbind(),this.boundObject=a,this.boundObject.on("change",this.onObjectChange,this),this.grid.setSource(a.getReadableHash()),this.callParent(arguments),this.boundObjectPanels.each(function(b){b.bind(a)})},unbind:function(a){this.boundObject&&(a==this.boundObject||!a)&&(this.boundObject.un("change",this.onObjectChange,this),this.grid.setSource({}),this.boundObject=!1),this.callParent(arguments),this.boundObjectPanels.each(function(b){b.unbind(a)})},onObjectChange:function(a,b){this.ignore||this.grid.setProperty(a,b,!0)},onPropertyChange:function(a,b,c){this.boundObject&&(this.ignore=!0,this.boundObject.set(b,c),this.ignore=!0)},attachTo:function(a){this.workspace=a,this.mon(this.workspace,"select",this.bind,this,{buffer:200}),this.mon(this.workspace,"unselect",this.unbind,this,{buffer:200})}});
Ext.define("App.usr.dil.SegmentStore",{extend:"Ext.data.Store",requires:["App.usr.dil.Segment"],model:"App.usr.dil.Segment",constructor:function(){this.callParent(arguments),this.on("update",function(a,b,c,d){d.indexOf("sequence")!=-1&&this.updateSegmentMap(b),d.indexOf("identity")!=-1&&this.updateSegmentMap(),d.indexOf("color")!=-1&&this.updateSegmentColorMap(b)},this),this.on("add",function(a,b,c){this.updateSegmentMap(b),this.updateSegmentColorMap(b)},this)},addSegment:function(a,b){return _.first(this.add({identity:a,sequence:b,color:this.getColor(a)}))},addSegments:function(a){var b=this;return this.add(_.map(a,function(a,c){return{identity:c,sequence:a,color:b.getColor(c)}}))},updateSegments:function(a){var b=this;return _.map(a,function(a,c){var d=b.findRecord("identity",c);return d?(d.set("sequence",a),d):_.first(b.add({identity:c,sequence:a,color:b.getColor(c)}))})},buildSegmentMap:function(){var a=this.getRange(),b=[],c={};for(var d=0;d<a.length;d++){var e=a[d],f={identity:e.get("identity"),sequence:e.get("sequence")};b.push(f),c[f.identity]=f.sequence}return c},getSegmentMap:function(){if(this.segmentMap)return this.segmentMap;this.segmentMap=this.buildSegmentMap()},getSegmentMapWithComplements:function(){var a=this.getSegmentMap();return DNA.hashComplements(a)},updateSegmentMap:function(a){if(a&&this.segmentMap)if(_.isArray(a))for(var b=0;b<a.length;b++)this.segmentMap[a[b].get("identity")]=a[b].get("sequence");else this.segmentMap[a.get("identity")]=a.get("sequence");else this.segmentMap=this.buildSegmentMap();return this.segmentMap},buildSegmentColorMap:function(){var a=this.getRange(),b={};for(var c=0;c<a.length;c++){var d=a[c];b[d.get("identity")]=d.get("color")}return b},getSegmentColorMap:function(){if(this.segmentColorMap)return this.segmentColorMap;this.segmentColorMap=this.buildSegmentColorMap()},updateSegmentColorMap:function(a){if(a&&this.segmentColorMap)if(_.isArray(a))for(var b=0;b<a.length;b++)this.segmentColorMap[a[b].get("identity")]=a[b].get("color");else this.segmentColorMap[a.get("identity")]=a.get("color");else this.segmentColorMap=this.buildSegmentColorMap();return this.segmentColorMap},getSegmentColorScale:function(){var a=this;return function(c){return a.segmentColorMap[c]}},getColorGenerator:function(){return this.segmentColors||(this.segmentColors=d3.scale.category20()),this.segmentColors},getColor:function(a){var b=this.getColorGenerator();return b(a)},addSegment:function(a){var b=this.getSegmentMap(),c=_.max(_.map(_.keys(b),function(a){return isNaN(+a)?0:+a}));return c<0?c=1:c+=1,this.add({identity:c,sequence:Array(a+1).join("N"),color:this.getColorGenerator()(c)})}});
Ext.define("Domain",{extend:"Ext.data.Model",fields:[{name:"name"}]}),Ext.define("App.usr.dil.StrandStore",{extend:"Ext.data.Store",model:"App.usr.dil.Strand",requres:["App.usr.dil.Strand"],constructor:function(){this.callParent(arguments),this.segmentStore&&this.segmentStore.on("update",function(a,b,c,d){d.indexOf("sequence")!=-1&&this.updateStrandSequences()},this),this.on("update",function(a,b,c,d){d.indexOf("spec")!=-1&&this.updateStrandSequence(b)},this)},updateStrandSequence:function(b){var c=this.segmentStore.getSegmentMap(),d=b,e=b.getFlatSpec();d.set("sequence",DNA.threadSegments(c,e))},updateStrandSequences:function(){var a=this.segmentStore.getSegmentMap(),b=this.getRange();for(var c=0;c<b.length;c++){var d=b[c],e=d.getFlatSpec();d.set("sequence",DNA.threadSegments(a,e))}},getSegmentMap:function(){return this.segmentStore.getSegmentMap()},getSegmentMapWithComplements:function(){return this.segmentStore.getSegmentMapWithComplements()},getSequences:function(){var a=this.getRange(),b={},c;for(var d=0;d<a.length;d++)c=a[d],b[c.get("name")]=c.get("sequence");return b},addStrand:function(){var a=_.max(_.map(this.getRange(),function(a){var b=a.get("name").match(/\d+/g);return!!b&&b.length>0&&!isNaN(b[0])?b:0}));a<0?a=0:a;var b;do a+=1,b=this.find("name",a);while(b!=-1);return this.add({name:"n"+a,spec:""})}});
Ext.define("App.usr.dil.StrandsGrid",{extend:"Ext.grid.Panel",alias:"widget.strandsgrid",requires:["App.usr.dil.StrandStore"],mixins:{tip:"App.ui.TipHelper"},initComponent:function(){this.strandEditor=Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1}),this.strandStore=this.store,this.segmentsField=Ext.create("Ext.form.field.Text",{tooltip:{html:'Describe the segments that comprise this strand, using the DyNAML short notation. For example, to describe a strand with two domains, an input A containing segments 1, 2, and 3, and an output B (containing segments 4, 5, and 6), you could write: <pre>	A[1 2 3]i B[4 5 6]o</pre> <a href="'+App.ui.Help.getLink("dynaml#short-notation")+'">Details</a>',hideDelay:2e3,anchor:"bottom",anchorToTarget:!0},validator:Ext.bind(function(a){var b=this.getSegmentMap(),c=App.dynamic.Compiler.parseDomainString(a,!0);for(var d=0;d<c.length;d++){var e=c[d].segments;for(var f=0;f<e.length;f++){var g=e[f];if(!b[g.identity])return"Unknown segment: '"+g.identity+"'"}}return!0},this)}),Ext.apply(this,{tbar:[{text:"Add",iconCls:"plus",handler:this.doAddStrand,scope:this,tooltip:"Click to add a strand. You'll also need to add a strand to a complex in order for it to appear in the design."},{text:"Edit",iconCls:"pencil",handler:this.doEditStrand,scope:this,tooltip:"Click to edit the definition of the selected strand."},{text:"Delete",iconCls:"delete",handler:this.doDeleteStrand,scope:this,tooltip:"Click to delete the selected strand(s)."}],columns:[{text:"Name",dataIndex:"name",allowBlank:!1,width:90},{text:"Sequence",dataIndex:"sequence",allowBlank:!1,renderer:function(a,b,c,d,e,f,g){var h=c.getParsedSpec(),i=0,j=c.store.getSegmentMapWithComplements(),k=[],l=CodeMirror.getModeRenderer("sequence",{renderer:function(a,b,c){var d=i+c-1;return b?"<span class='sequence-base cm-"+b+"' data-base-index='"+d+"'>"+a+"</span>":"<span class='sequence-base' data-base-index='"+d+"'>"+a+"</span>"}});for(var m=0;m<h.length;m++){var n=h[m];for(var o=0;o<n.segments.length;o++){var p=n.segments[o],q=j[DNA.makeIdentifier(p.identity,p.polarity)]||"(?)";k.push('<span class="sequence-segment" data-segment-identity="'+p.identity+'" data-segment-polarity="'+p.polarity+'">'+l(q)+"</span>")}}return k.join("")},scope:this,flex:1},{text:"Segments",dataIndex:"spec",field:this.segmentsField,renderer:function(a){var b=App.dynamic.Compiler.parseDomainOrSegmentString(a,!0);return _.map(b,function(a){return'<div class="domain-glyph domain-glyph-'+a.role+'">'+(a.name?'<span class="domain-glyph-name">'+a.name+"</span>":"")+_.map(a.segments,function(a){return'<span class="segment-glyph segment-glyph-'+a.role+'">'+a.identity+"</span>"+(a.polarity==-1?"<sup>*</sup>":"")}).join(" ")+"</div>"}).join(" ")},flex:1},{text:"Complex",dataIndex:"complex"}],plugins:[this.strandEditor]}),this.callParent(arguments),this.mixins.tip.init.call(this,[this.segmentsField]),this.on("afterrender",function(){this.tip=Ext.create("Ext.tip.ToolTip",{target:this.getEl(),delegate:"span.sequence-base",trackMouse:!0,showDelay:!1,renderTo:Ext.getBody(),listeners:{beforeshow:{fn:this.updateTipBody,scope:this}}})},this)},updateTipBody:function(a){var b=Ext.get(a.triggerElement).up("span.sequence-segment"),c=b.getAttribute("data-segment-identity"),d=b.getAttribute("data-segment-polarity"),e=parseInt(a.triggerElement.getAttribute("data-base-index"))+1;a.update(this.getTipBody(c,d,e))},getTipBody:function(a,b,c){return"Segment: <b>"+DNA.makeIdentifier(a,b)+"</b> / Base: "+c},getSegmentMap:function(){return this.segmentStore.getSegmentMapWithComplements()},highlightSegment:function(a,b){b===undefined&&(b=1);var c=this.getEl();c.select('[data-segment-identity="'+a+'"][data-segment-polarity="'+b+'"]').addCls("sequence-highlight"),c.select('[data-segment-identity="'+a+'"][data-segment-polarity="'+ -1*b+'"]').addCls("sequence-highlight-complement")},unhighlightSegment:function(){var a=this.getEl();a.select(".sequence-highlight").removeCls("sequence-highlight"),a.select(".sequence-highlight-complement").removeCls("sequence-highlight-complement")},addStrand:function(){return _.first(this.strandStore.addStrand())},doAddStrand:function(){var a=this.addStrand();this.editStrand(a)},editStrand:function(b){b||(b=this.getSelectionModel().getLastSelected()),b&&this.strandEditor.startEdit(b,this.headerCt.getHeaderAtIndex(2))},doEditStrand:function(){return this.editStrand()},deleteStrand:function(b){},doDeleteStrand:function(){return this.deleteStrand()}});
Ext.define("App.usr.dil.SegmentsGrid",{extend:"Ext.grid.Panel",alias:"widget.segmentsgrid",requires:["App.usr.dil.SegmentStore"],mixins:{tip:"App.ui.TipHelper"},initComponent:function(a){this.segmentEditor=Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:1}),this.segmentStore=this.store,Ext.apply(this,{tbar:[Ext.create("App.ui.AddDomainButton",{lengthLabel:"New segment length:",itemLabel:"Add Segment",addDomain:Ext.bind(this.createSegment,this),extraMenuItems:["-",{text:"Add many segments...",iconCls:"plus",handler:this.showAddSegmentsWindow,scope:this}]}),{xtype:"splitbutton",text:"Edit",iconCls:"pencil",handler:this.editSegment,scope:this,menu:[{text:"Edit all segments...",iconCls:"pencil",handler:this.showEditSegmentsWindow,scope:this}]},{text:"Delete",iconCls:"delete",handler:this.deleteSegment,scope:this}],columns:[{dataIndex:"color",field:{xtype:"colorfield",pickerOptions:{colors:["1F77B4","AEC7E8","FF7F0E","FFBB78","2CA02C","98DF8A","D62728","FF9896","9467BD","C5B0D5","8C564B","C49C94","E377C2","F7B6D2","7F7F7F","C7C7C7","BCBD22","DBDB8D","17BECF","9EDAE5","3182BD","6BAED6","9ECAE1","C6DBEF","E6550D","FD8D3C","FDAE6B","FDD0A2","31A354","74C476","A1D99B","C7E9C0","756BB1","9E9AC8","BCBDDC","DADAEB","636363","969696","BDBDBD","D9D9D9","393B79","5254A3","6B6ECF","9C9EDE","637939","8CA252","B5CF6B","CEDB9C","8C6D31","BD9E39","E7BA52","E7CB94","843C39","AD494A","D6616B","E7969C","7B4173","A55194","CE6DBD","DE9ED6"]}},renderer:function(a){return'<div style="width:12px;height:12px;background-color:'+a+';">&nbsp;</div>'},width:40},{text:"Name",dataIndex:"identity",flex:1,editor:{xtype:"textarea",selectOnFocus:!0}},{text:"Sequence",dataIndex:"sequence",field:"textfield",renderer:CodeMirror.modeRenderer("sequence"),flex:5},{text:"Length",dataIndex:"sequence",renderer:function(a){return a.length},flex:1}],plugins:[this.segmentEditor]}),this.callParent(arguments),this.mixins.tip.init.call(this,[])},showAddSegmentsWindow:function(){var a=this;this.addSegmentsWindow||(this.addSegmentsWindow=Ext.create("App.ui.SequenceWindow",{handler:function(b){a.updateSegments(b)},title:"Add segments to system"})),this.addSegmentsWindow.show()},showEditSegmentsWindow:function(){var a=this;this.addSegmentsWindow||(this.editSegmentsWindow=Ext.create("App.ui.SequenceWindow",{handler:function(b){a.updateSegments(b)},title:"Update segments in system"}));var b=this.store.getSegmentMap();this.editSegmentsWindow.show(),this.editSegmentsWindow.setValue(DNA.printSequences(b,":"))},addSegment:function(a,b){return this.segmentStore.addSegment(a,b)},addSegments:function(a){return this.segmentStore.addSegments(a)},updateSegments:function(a){return this.segmentStore.updateSegments(a)},createSegment:function(a){return _.first(this.segmentStore.addSegment(a))},editSegment:function(b){b||(b=this.segmentsGrid.getSelectionModel().getLastSelected()),b&&this.segmentEditor.startEdit(b,this.headerCt.getHeaderAtIndex(2))},doEditSegment:function(){return this.editSegment()},deleteSegment:function(a){},doDeleteSegment:function(){return this.deleteSegment()}});
Ext.define("App.usr.dd.RulesWindow",{extend:"Ext.window.Window",requires:["App.ui.BasePicker"],plain:!0,bodyBorder:!1,border:!1,layout:"fit",title:"Design Options",width:350,initComponent:function(){Ext.apply(this,{items:{xtype:"form",frame:!0,defaults:{labelAlign:"top"},items:[{boxLabel:"Prevent 4 G's and 4 C's in a row",xtype:"checkboxfield",name:"rule_4g",inputValue:1},{boxLabel:"Prevent 6 A/T bases in a row and 6 G/C bases in a row",xtype:"checkboxfield",name:"rule_6at",inputValue:1},{boxLabel:"Domains must start and end with C",xtype:"checkboxfield",name:"rule_ccend",inputValue:1},{boxLabel:"Minimize G's in domain design",xtype:"checkboxfield",name:"rule_ming",inputValue:1},{boxLabel:"Reward domains with higher Shannon entropy",xtype:"checkboxfield",name:"rule_shannon",inputValue:1},{boxLabel:"Target worst domain for mutations",xtype:"checkboxfield",name:"rule_targetworst",inputValue:1},Ext.create("App.ui.BasePicker",{labelAlign:"top",fieldLabel:"Constrain initial domain sequences",name:"rule_init",width:320}),Ext.create("App.ui.BasePicker",{labelAlign:"top",fieldLabel:"Constrain bases in domains",xtype:"textfield",name:"rule_gatc_avail",width:320}),{boxLabel:"Lock all bases in strands loaded from file",xtype:"checkboxfield",name:"rule_lockold",inputValue:1}],buttons:[{text:"Save",handler:this.save,scope:this}]}}),this.callParent(arguments),this.form=this.down("form")},save:function(){this.designer.updateRules(this.getValues()),this.hide()},getValues:function(){var a=this.form.getValues();return _.each(this.query("basepicker"),function(b){a[b.name]=b.getAggregate()}),_.each(this.query("checkboxfield"),function(b){b.checked||(a[b.name]=0)}),a},setValues:function(a){var b={};_.each(a,function(a,c){b[c]=a.toString()}),this.form.getForm().setValues(b),_.each(this.query("basepicker"),function(b){a[b.name]&&b.setAggregate(a[b.name])})}});
Ext.define("Workspace.tools.IdeaTool",{targetWType:"Workspace.objects.IdeaObject",constructor:function(a,b){Ext.applyIf(b,{keyMap:[]}),Workspace.tools.IdeaTool.superclass.constructor.call(this,a,b),this.dragging=!1,this.selectorBand=!1,this.selectionBands=new Ext.util.MixedCollection},requires:["Workspace.tools.IdeaAdderTool","Workspace.tools.SelectorBand","Workspace.tools.SelectionBand"],extend:"Workspace.tools.BaseTool",click:function(a,b){},dblclick:function(a,b){},mousedown:function(a,b){this.dragging=!0,pos=this.getAdjustedXY(a),this.x1=pos.x,this.y1=pos.y,this.selectorBand&&(this.selectorBand.destroy(),this.selectorBand=!1),this.selectorBand=new Workspace.tools.SelectorBand(this.workspace,{x1:pos.x,y1:pos.y}),this.selectorBand.cacheRegions(),a.stopEvent()},mouseup:function(a,b){this.dragging=!1,this.selectorBand&&(this.selectorBand.destroy(),this.selectorBand=!1),b&&Ext.type(b.select)=="function"&&b.select();var c=this.workspace.getSelection();if(c.length>0){var d=this.buildIdeaFromSelection();d&&(d.select(),this.workspace.changeTool("pointer"))}else this.alternateAction(a,b,this.getAdjustedXY(a));a.stopEvent()},alternateAction:function(a,b,c){},buildIdeaFromSelection:function(){var a=this.workspace.getSelection();if(a.length>0){var b=this.workspace.createObject({wtype:this.targetWType,children:a});b.toBack()}return b},mousemove:function(a,b){if(this.dragging){var c=this.workspace.getSelection();if(this.selectorBand){pos=this.getAdjustedXY(a),this.selectorBand.adjustBand(pos.x,pos.y);var d=this.selectorBand.getItemsWithin();this.workspace.setSelection(d)}}},selectHandler:function(a){this.addSelectionBand(a)},unselectHandler:function(a){this.removeSelectionBand(a.getId())},addSelectionBand:function(a){this.selectionBands.containsKey(a.getId())||this.selectionBands.add(a.getId(),new Workspace.tools.SelectionBand({item:a,workspace:this.workspace}))},removeSelectionBand:function(a){a?(!Ext.isString(a)&&Ext.isFunction(a.getId)&&(a=a.getId()),Ext.isString(a)&&this.selectionBands.containsKey(a)&&(this.selectionBands.get(a).destroy(),this.selectionBands.removeAtKey(a))):(this.selectionBands.each(function(a){a.destroy()}),this.selectionBands.clear())},deleteSelection:function(){this.workspace.deleteObjects(this.workspace.getSelection())},activate:function(){Workspace.tools.IdeaTool.superclass.activate.call(this),this.workspace.deselect(),this.workspace.on("select",this.selectHandler,this),this.workspace.on("unselect",this.unselectHandler,this)},deactivate:function(){Workspace.tools.IdeaTool.superclass.deactivate.call(this),this.workspace.un("select",this.selectHandler,this),this.workspace.un("unselect",this.unselectHandler,this),this.selectorBand&&this.selectorBand.destoy(),this.removeSelectionBand()}},function(){Workspace.Tools.register("idea",Workspace.tools.IdeaTool)});
Ext.define("App.usr.canvas.ToolsTab",{requires:["Workspace.tools.PointerTool","Workspace.tools.PencilTool","Workspace.tools.IdeaTool","Workspace.tools.ConnectorTool","Workspace.tools.IdeaAdderTool"],extend:"App.ui.BoundObjectPanel",tool:"pointer",border:!1,layout:"hbox",generateConfig:function(){return{items:[{xtype:"buttongroup",title:"Tools",columns:2,items:[{iconCls:"cursor-icon",enableToggle:!0,toggleGroup:"toolbox",toolName:"pointer",pressed:!0,tooltip:{title:"Pointer Tool",text:"Select, move, and resize objects. Click objects or drag boxes around them to select. Grab and drag to move. Drag hangles to resize (objects without handles can't be resized)."}},{iconCls:"pencil",enableToggle:!0,toggleGroup:"toolbox",toolName:"pencil",tooltip:{title:"Pencil Tool",text:"Draw freehand objects. Click and drag to start drawing; release to finish."}},{iconCls:"idea",toggleGroup:"toolbox",enableToggle:!0,toolName:"idea",tooltip:{title:"Idea Tool",text:"Group objects into ideas. Drag a box around a group of objects to make an idea."}},{iconCls:"connector",toggleGroup:"toolbox",enableToggle:!0,toolName:"connector",tooltip:{title:"Connector Tool",text:"Draw connections between objects. Click one point or object and drag to another point or object."}}]},{xtype:"buttongroup",title:"Object",columns:3,items:[{scale:"medium",rowspan:2,iconAlign:"top",iconCls:"delete-24",text:"Delete",handler:this.deleteObjects,scope:this,tooltip:{title:"Delete",text:"Deletes the selected objects."},enableIf:function(a,b){return b.getCount()>0}},{disabled:!0,scale:"medium",rowspan:2,iconAlign:"top",iconCls:"duplicate-24",text:"Duplicate",handler:this.duplicateObjects,scope:this,tooltip:{title:"Duplicate",text:"Inserts a copy of the selected objects."}}]},{xtype:"buttongroup",title:"Idea",columns:2,defaults:{cellCls:"table-cell-padded"},items:[{scale:"medium",rowspan:2,iconAlign:"top",iconCls:"idea-form-24",text:"Form idea",tooltip:{title:"Form idea",text:"Makes a new idea from the selected objects. Select the objects you want to add to an idea, then click this button"},handler:this.formIdea,scope:this,enableIf:function(a,b){return b.getCount()>0}},{iconCls:"idea-remove",text:"Remove from Idea",rowspan:1,handler:this.orphanObjects,scope:this,tooltip:{title:"Remove from Idea",text:"Removes the selected objects from the idea they're a part of (if any)."},enableIf:function(a,b){var c=!1;return b.each(function(a){if(a.hasParent())return c=!0,!1}),c}},{iconCls:"idea-add",text:"Add to Idea",rowspan:1,toolName:"idea-add",enableToggle:!0,toggleGroup:"toolbox",tooltip:{title:"Add this to Idea",text:"Allows you to add the selected object(s) to an idea. Select the objects you want to add to an idea, then click this button, then click an idea."}}]},{xtype:"tbfill"},{xtype:"buttongroup",title:"Workspace",columns:4,items:[{scale:"medium",iconCls:"undo-24",text:"Undo",rowspan:2,iconAlign:"top",handler:this.undo,scope:this,ref:"undoButton",disabled:!0},{scale:"medium",iconCls:"redo-24",text:"Redo",rowspan:2,iconAlign:"top",handler:this.redo,scope:this,ref:"redoButton",disabled:!0},{scale:"medium",iconCls:"save-24",text:"Save",rowspan:2,iconAlign:"top",handler:this.saveWorkspace,scope:this},{scale:"medium",iconCls:"document-24",text:"Expand",rowspan:2,iconAlign:"top",handler:this.expandWorkspace,scope:this}]}]}},initComponent:function(){this.addEvents("toolChange"),this.defaults||(this.defaults={}),Ext.applyIf(this.defaults,{xtype:"buttongroup",headerPosition:"bottom",margins:"3 0 5 3"}),Ext.apply(this,this.generateConfig()),App.usr.canvas.ToolsTab.superclass.initComponent.apply(this,arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this),this.toolButtons=new Ext.util.MixedCollection;var a=this.query("component[toolName]");Ext.each(a,function(a){a.addListener("toggle",this.onToggle,this),this.toolButtons.add(a.toolName,a)},this)},pushUndo:function(a){this.undoStack.push(a),this.rebuildUndo()},popUndo:function(){var a=this.undoStack.pop();return this.rebuildUndo(),a},rebuildUndo:function(){this.undoButton.menu.removeAll(),this.undoButton.menu.add(this.undoStack),this.undoStack.length>0?this.undoButton.enable():this.undoButton.disable()},undo:function(){this.fireEvent("undo",this)},redo:function(){this.fireEvent("redo",this)},deleteObjects:function(){var a=new Workspace.actions.DeleteObjectAction({subjects:this.boundObjects.getRange()});this.fireEvent("action",a)},duplicateObjects:function(){var a=new Workspace.actions.DuplicateObjectAction({objects:this.boundObjects.getRange()});this.fireEvent("action",a)},orphanObjects:function(){var a=new Workspace.actions.OrphanObjectAction({subjects:this.boundObjects.getRange()});this.fireEvent("action",a)},formIdea:function(){var a=new Workspace.actions.FormIdeaAction({subjects:this.boundObjects.getRange()});this.fireEvent("action",a)},expandWorkspace:function(){var a=new Workspace.actions.ExpandAction({});this.fireEvent("action",a)},saveWorkspace:function(){this.fireEvent("save",this)},onToggle:function(a,b){b&&this.setActiveTool(a.toolName)},getActiveTool:function(){return this.tool},setActiveTool:function(a){this.ignoreToolChange||(this.tool=a,this.fireEvent("toolchange",a))},onToolChange:function(a){var b=this.toolButtons.get(a);return b?(this.ignoreToolChange=!0,b.toggle(!0),this.tool=a,this.ignoreToolChange=!1,!0):!1}});
Ext.define("App.usr.nodal.HomeTab",{extend:"App.usr.canvas.ToolsTab",alias:"widget.nodal-hometab",requires:["Workspace.DDManager","Workspace.actions.UnwrapObjectsAction"],generateConfig:function(){return{defaults:{xtype:"buttongroup",headerPosition:"bottom",margins:"3 0 5 3"},items:[{xtype:"buttongroup",title:"Tools",columns:2,defaults:{},items:[{iconCls:"cursor-icon",enableToggle:!0,toggleGroup:"toolbox",toolName:"pointer",pressed:!0,tooltip:{title:"Pointer Tool",text:"Select, move, and resize objects. Click objects or drag boxes around them to select. Grab and drag to move. Drag hangles to resize (objects without handles can't be resized)."}},{iconCls:"pencil",enableToggle:!0,toggleGroup:"toolbox",toolName:"pencil",tooltip:{title:"Pencil Tool",text:"Draw freehand objects. Click and drag to start drawing; release to finish."}},{iconCls:"text-icon",enableToggle:!0,toggleGroup:"toolbox",toolName:"textbox",tooltip:{title:"Text Tool",text:"Enter and edit text. Click or click and drag to insert a textbox. Click a textbox to edit text."}},{iconCls:"math-icon",toggleGroup:"toolbox",enableToggle:!0,toolName:"math",tooltip:{title:"Equations",text:"Insert mathematical equations. Click and drag to draw an equation box."}}]},{xtype:"buttongroup",title:"Nodes",columns:2,defaults:{},items:[{enableToggle:!0,toggleGroup:"toolbox",toolName:"complementarity",rowspan:2,scale:"medium",iconCls:"arrow-24",iconAlign:"top",text:"Connect",tooltip:{title:"Complementarity",text:"Indicate complementary ports. Click and drag from an output port to an input port to create a complementarity relationship."}},{enableToggle:!0,toggleGroup:"toolbox",toolName:"node",iconCls:"node-add",text:"Add Node",rowspan:1,tooltip:{title:"Node",text:"Click to add a new node with no ports"}},{enableToggle:!0,toggleGroup:"toolbox",iconCls:"port-add",toolName:"port",text:"Add Port",rowspan:1,tooltip:{title:"Add Port",text:"Click on a node to add an input port. Hold alt and click to create an output port."}}]},{xtype:"buttongroup",title:"Motif",columns:2,items:[{toolName:"motif",enableToggle:!0,toggleGroup:"toolbox",scale:"medium",rowspan:2,iconAlign:"top",iconCls:"wrap-motif",text:"Create Motif",tooltip:{title:"Create Motif",text:'Click on the workspace to create an empty motif, or click and drag to group nodes into a motif. Your new motif will show up in the "Custom" tab of the motifs panel on the left; drag and drop it onto the workspace to create a new node of your motif. If you make an empty motif, you can enter custon DyNAML to define your motif. '}},{toolName:"exposure",enableToggle:!0,toggleGroup:"toolbox",iconCls:"port-expose",text:"Expose port",tooltip:{title:"Expose Port",text:'Click and drag from a port within a motif to the motif itself to "expose" that port as an input, output, or bridge into the motif. When you create a node with your motif, you\'ll only be able to assign complementarities to ports which have been exposed. '}},{iconCls:"unwrap-motif",text:"Unwrap motif",tooltip:{title:"Destroy motif",text:"Unwraps and destroys the selected motif(s). If there are nodes within the motif, those nodes will be re-added to the workspace as regular nodes. If you wrote custom DyNAML within the motif, it will disappear, so be careful!"},handler:this.unwrapObjects,scope:this}]},{xtype:"buttongroup",title:"Object",columns:2,defaults:{},items:[{scale:"medium",rowspan:2,iconAlign:"top",iconCls:"delete-24",text:"Delete",handler:this.deleteObjects,scope:this,tooltip:{title:"Delete",text:"Deletes the selected objects."},enableIf:function(a,b){return b.getCount()>0}}]},{xtype:"tbfill"},{xtype:"buttongroup",title:"Workspace",columns:2,defaults:{},items:[{scale:"small",iconCls:"save-24",text:"Save",scale:"medium",rowspan:2,iconAlign:"top",handler:this.saveWorkspace,scope:this},{text:"Help",iconCls:"help",handler:App.ui.Launcher.makeLauncher("help:nodal")},{scale:"small",iconCls:"expand",text:"Expand",rowspan:1,handler:this.expandWorkspace,scope:this}]}]}},unwrapObjects:function(){var a=new Workspace.actions.UnwrapObjectsAction({subjects:this.boundObjects.getRange()});this.fireEvent("action",a)}},function(){});
Ext.define("App.usr.nodal.BuildTab",{extend:"App.usr.canvas.ToolsTab",alias:"widget.nodal-buildtab",mixins:{tips:"App.ui.TipHelper"},generateConfig:function(){return{defaults:{xtype:"buttongroup",headerPosition:"bottom",margins:"3 0 3 3"},items:[{xtype:"buttongroup",title:"Implementation",ref:"implementationGroup",columns:2,defaults:{},items:[{iconCls:"domains-24",text:"Compile",rowspan:2,iconAlign:"top",scale:"medium",xtype:"splitbutton",tooltip:{title:"Compile to segments",text:"Compile the system into a segment-level representation of the required strands. The generated file can be used to generate sequences, enumerate possible reactions, and generate graphical representations of the required species. "},ref:"serializeButton",handler:this.compile,scope:this,menu:[{iconCls:"magic",text:"Build all targets",handler:this.compileAll,scope:this,tooltip:{title:"Build all targets",text:"Compiles the system into a domain-level specification, and generates several output files in this directory: a graphical representation of the included hairpins, a NUPACK multi-objective script for thermodynamic sequence design, and a Domain Design specification for interactive sequence design using Web DD. ",anchor:"top"}},{text:"Clean",iconCls:"clean",tooltip:{title:"Clean files",text:"Clears files generated by compiling thesystem, including: serialized outputs, SVG images, and sequence design specifications."},handler:this.clean,scope:this},{text:"Compile with Compiler v2b ",handler:this.compileTerse,scope:this},{text:"Compile locally ",handler:this.compileLocal,scope:this}]},{iconCls:"compile",text:"Serialize",rowspan:1,disabled:!0,ref:"serializeMenu",tooltip:{title:"Serialize System",text:"View and edit serialized forms of nodal system, including TerseML, PIL, and SVG, for further processing (must compile first). "},menu:[{text:"TerseML",iconCls:"txt",ref:"txt",disabled:!0,handler:_.bind(this.openFile,this,"txt")},{text:"DyNAML",iconCls:"dynaml",ref:"dynaml",disabled:!0,handler:_.bind(this.openFile,this,"dynaml")},{text:"PIL",iconCls:"pil",ref:"pil",disabled:!0,handler:_.bind(this.openFile,this,"pil")},{text:"SVG",iconCls:"svg",ref:"svg",disabled:!0,handler:_.bind(this.openFile,this,"svg")}]},{iconCls:"sequence",text:"Sequence",rowspan:1,disabled:!0,ref:"sequenceMenu",tooltip:{title:"Sequence System",text:"Opens the system in a sequence editor to perform sequence design. Available sequence editors: NUPACK multi-objective, Web DD, and SpuriousC."},menu:[{text:"SpuriousC",iconCls:"spurious-c",ref:"spur",disabled:!0,handler:_.bind(this.openFile,this,"spur")},{text:"NUPACK",iconCls:"nupack",ref:"nupack",disabled:!0,handler:_.bind(this.openFile,this,"nupack")},{text:"Web DD",iconCls:"seq",ref:"domains",disabled:!0,handler:_.bind(this.openFile,this,"domains")}]}]},{xtype:"buttongroup",title:"Simulation",columns:1,disabled:!0,defaults:{},items:[{text:"Enumerate",iconCls:"enumerate",iconAlign:"left"},{text:"Simulate",iconCls:"simulate",iconAlign:"left"}]}]}},getDoc:function(){return this.ribbon.canvas.doc?this.ribbon.canvas.doc:this.ribbon.canvas.document},initComponent:function(){this.callParent(arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this),this.mixins.tips.init.apply(this,arguments),this.sequenceMenu.on("click",this.doUpdateMenus,this),this.serializeMenu.on("click",this.doUpdateMenus,this)},init:function(){this.updateMenus(!0)},doUpdateMenus:function(){this.updateMenus(!1)},updateMenus:function(a){},enableMenus:function(){this.sequenceMenu.enable(),this.serializeMenu.enable()},openFile:function(a){var b=this.getDoc(),c=b.getBasename(),d=b.getSiblingByName(App.Path.repostfix(c,a));d&&App.ui.Launcher.launchDocument(d)},clean:function(){var a=this.ribbon.canvas.doc.getDocumentPath();App.runTask("Nodal",{node:a,action:"clean"},_.bind(function(){Ext.msg("Nodal Build","Build of system <strong>{0}</strong> completed.",this.getDoc().getBasename())},this))},serialize:function(){this.serializeDynaml();var a=Workspace.tools.nodal.serializeTerse(this.ribbon.canvas.workspace);console.log(a)},compile:function(){this.compileDynamicServer()},compileAll:function(){this.compileDynamicServerAllTargets()},compileLocal:function(){var a=this.compileDynamic()},compileDynamic:function(){var a=this.serializeDynaml(),b=App.dynamic.Compiler.compileLibrary(a);return b},compileDynamicServer:function(){var a=Ext.encode(this.serializeDynaml()),b=this.ribbon.canvas.doc.getDocumentPath(),c=App.path.repostfix(b,"dil");App.runTask("Nodal",{node:b,data:a,action:"dil"},function(){Ext.msg("Nodal Build","Build of system <strong>{0}</strong> completed.",this.getDoc().getBasename()),this.highlightOutput()},this,{openOnEnd:[c]})},compileDynamicServerAllTargets:function(){var a=Ext.encode(this.serializeDynaml()),b=this.ribbon.canvas.doc.getDocumentPath();App.runTask("Nodal",{node:b,data:a,action:"dynamic"},_.bind(function(){Ext.msg("Nodal Build","Build of system <strong>{0}</strong> completed.",this.getDoc().getBasename()),this.highlightOutput()},this))},compileTerse:function(){var a=this.serializeTerse(),b=this.ribbon.canvas.doc.getDocumentPath();App.runTask("Nodal",{node:b,data:a,action:"all"},_.bind(function(){Ext.msg("Nodal Build","Build of system <strong>{0}</strong> completed.",this.getDoc().getBasename()),this.highlightOutput()},this))},serializeDynaml:function(){return Workspace.tools.nodal.serializeDynaml(this.ribbon.canvas.workspace)},serializeTerse:function(){return Workspace.tools.nodal.serializeTerse(this.ribbon.canvas.workspace)},highlightOutput:function(){this.outputTip||(this.outputTip=Ext.create("Ext.tip.ToolTip",{target:this.implementationGroup.getEl(),anchor:"left",title:"View compilation results",html:'Use these buttons to quickly view the compiled system. Use the "Serialize" button to view visual and textual representations of the system. Use the Sequence button to see options for sequence design. ',closable:!0,autoHide:!0,dismissDelay:1e4,showDelay:1500})),this.serializeButton.tip&&this.serializeButton.tip.hide(),this.outputTip.show()},spuriousDesign:function(){var a=this.ribbon.canvas.doc.getSiblingByName("spurious-out");a&&App.runTask("Spurious",{node:a.getPath()})}}),Ext.ns("Workspace.tools.nodal"),Workspace.tools.nodal.serializeTerse=function(a){return a.buildManager.serializeTerse()},Workspace.tools.nodal.serializeDynaml=function(a){return a.buildManager.serializeDynaml()};
Ext.define("App.usr.canvas.CommandTab",{extend:"App.usr.canvas.ToolsTab",alias:"widget.commandtab",requires:["App.ui.CodeMirror"],generateConfig:function(){return this.codemirror=Ext.create("App.ui.CodeMirror",{style:"border-width:0;",mode:"javascript",bodyStyle:"background: #fff !important;",frame:!1,rbar:[{iconCls:"run",handler:this.runCommand,scope:this}],onKeyEvent:Ext.bind(function(a,b){if(b.keyCode==13&&b.shiftKey&&b.type=="keydown")return b.stop(),this.runCommand(),!1},this)}),{layout:"fit",items:[this.codemirror]}},runCommand:function(){var a=this.ribbon.workspace.getSelection();App.ui.Launcher.console.executeInContext(this.codemirror.getValue(),this.ribbon.workspace,!0,{selection:a})}},function(){});
Ext.define("App.usr.nodal.CommandTab",{extend:"App.usr.canvas.CommandTab",alias:"widget.nodal-commandtab"},function(){});
Ext.define("App.ui.SequenceWindow",{extend:"App.ui.EditorWindow",title:"Add sequences",closeAction:"hide",buttonText:"Add Sequences",helpText:"Type sequences in any format (NUPACK, FASTA, Multisubjective, or paste from Excel), with or without names",handler:function(a,b){},initComponent:function(){this.callParent(arguments),this.sequenceEditor=this.editor},buttonHandler:function(){var a=this.getValue(),b=DNA.parseNamedSequences(a);this.scope?this.handler.call(this.scope,a):this.handler(b,a),this.close()}});
Ext.define("App.usr.dd.SequenceWindow",{extend:"App.ui.SequenceWindow",title:"Add specific sequences to DD",buttonText:"Add Domains",value:"",handler:function(a,b){this.designer.addDomains(b.split("\n"))}});
Ext.define("App.usr.dd.DD",{extend:"Ext.panel.Panel",mixins:{app:"App.ui.Application",tip:"App.ui.TipHelper"},requires:["App.usr.seq.Editor","App.usr.dd.RulesWindow","App.usr.dd.ScoreParametersWindow","App.usr.dd.SequenceWindow","App.ui.SequenceThreader"],constructor:function(){this.mixins.app.constructor.apply(this,arguments),this.callParent(arguments)},title:"Domain Design",iconCls:"dd",editorType:"WebDD",border:!1,bodyBorder:!1,mutating:!1,scoreFormat:"0.00",dockedItems:[{xtype:"cite",cite:"zhang_2011"}],initComponent:function(){var a=this.designer=new DD;this.store=Ext.create("Ext.data.ArrayStore",{ref:"store",fields:[{name:"domain",type:"int"},{name:"name",type:"string"},{name:"sequence"},{name:"importance",type:"float"},{name:"composition",type:"int"},{name:"score",type:"float"},{name:"target",type:"bool",defaultValue:!1}],data:[]}),this.designStore=Ext.create("Ext.data.ArrayStore",{fields:[{name:"sequence"},{name:"spec"},{name:"name"}]});var b=this.cellEditor=Ext.create("Ext.grid.plugin.CellEditing2",{clicksToEdit:2,autoCancel:!1});this.cellEditor.on("edit",function(a,b){this.designer.updateDomain(this.store.indexOf(b.record),b.record.get("sequence"),b.record.get("importance"),b.record.get("composition")),this.grid.focus()},this),this.targetColumn=Ext.create("Ext.ux.CheckColumn",{header:"Target",dataIndex:"target",width:60,xtype:"checkcolumn"}),this.targetColumn.on("checkchange",function(a,b,c){var d=this.store.getAt(b);d.get("target")?this.designer.targetDomain(b):this.designer.untargetDomain(b)},this),Ext.apply(this,{layout:"border",items:[{xtype:"gridpanel",ref:"grid",region:"center",selModel:{mode:"multi"},columns:[Ext.create("Ext.grid.RowNumberer",{width:30,header:"#",hideable:!0,hidden:!0}),{header:"Name",dataIndex:"name",width:50,editor:{allowBlank:!0,tooltip:{title:"Name domain",text:"You can manually specify a name for each domain, to be used in the Structure panel. Leave this blank to automatically number the domains. Domain names/numbers are preserved when the columns of this grid are sorted by clicking the headers.",anchor:"top"}},renderer:function(a,b,c,d,e,f){return b.tdCls=Ext.baseCSSPrefix+"grid-cell-special",!a||a=="false"?f.indexOfTotal(c)+1:a}},{header:"Sequence",dataIndex:"sequence",renderer:CodeMirror.modeRenderer("dd-sequence","dd-sequence"),editor:{allowBlank:!1,selectOnFocus:!0,tooltip:{title:"Edit sequence of domain",text:'Manually set the sequence of this domain by entering a sequence of bases. Capitalized bases will be "locked", so the designer will not mutate them. ',anchor:"top",anchorOffset:10},listeners:{afterrender:{scope:this,fn:function(a){this.mixins.tip.buildTip(a)}}}},flex:1},{header:"Importance",dataIndex:"importance",width:100,editor:{xtype:"numberfield",allowBlank:!1,tooltip:{title:"Domain importance",text:"Importance is a multiplicative factor which causes the designer to weigh defects involving this domain more heavily. This allows you to (for instance) ensure that toehold domains have minimal interactions with other domains.",anchor:"top",anchorOffset:10},listeners:{afterrender:{scope:this,fn:function(a){this.mixins.tip.buildTip(a)}}}}},{header:"Composition",dataIndex:"composition",renderer:Ext.bind(function(a){return a=this.designer.printComposition(a),CodeMirror.renderMode("sequence",a.toUpperCase())},this),width:100,editor:{xtype:"combobox",typeAhead:!0,triggerAction:"all",allowBlank:!1,forceSelection:!0,selectOnTab:!0,store:[[15,"GATC"],[7,"ATC"],[11,"GTC"],[14,"GAT"],[13,"GAC"],[12,"GA"],[6,"AT"],[9,"GC"],[10,"GT"],[5,"AC"],[3,"TC"],[8,"G"],[4,"A"],[2,"T"],[1,"C"]],lazyRender:!0,listClass:"x-combo-list-small",tooltip:{title:"Domain base composition",text:"Specify which bases (ATCG) may be included in this domain; the designer will only accept mutations which contain only the specified bases.",anchor:"top",anchorOffset:10},listeners:{afterrender:{scope:this,fn:function(a){this.mixins.tip.buildTip(a)}}}}},{header:"Score",dataIndex:"score",xtype:"numbercolumn",format:this.scoreFormat,width:100,editable:!1},this.targetColumn],store:this.store,plugins:[this.cellEditor],tbar:{items:[{text:"Mutate",iconCls:"play",ref:"mutateButton",handler:this.toggleMutation,disabled:!0,scope:this,tooltip:"Click to start/pause mutations. Must add domains first."},"-",{text:"Add",ref:"addDomainButton",handler:this.doAddDomain,scope:this,iconCls:"plus",xtype:"splitbutton",tooltip:"Click the button to add a new domain of the default length. Click the arrow to choose the default length, or add domains with specific sequences to the design. ",menu:[{text:"New domain length: ",canActivate:!1},{xtype:"numberfield",ref:"addDomLen",value:8,min:2,indent:!0},{text:"Add Domain",iconCls:"tick",ref:"addDomainItem",handler:this.doAddDomain,scope:this},"-",{text:"Add specific domains...",handler:function(){this.addManyDomains("")},scope:this,tooltip:"Open a window to add domains with specific sequences to the design."},{text:"Add domains from DD file...",handler:function(){this.loadFromDDFile("")},scope:this,tooltip:"Open a window to add domains using a file created by a legacy version of DD. This also allows you to specify the importance and composition of each of the added domains."}]},{text:"Modify",ref:"modDomainButton",iconCls:"edit",xtype:"splitbutton",handler:function(){var a=this.grid.getSelectionModel().getLastSelected();a&&this.cellEditor.startEdit(a,this.grid.headerCt.getHeaderAtIndex(1))},scope:this,tooltip:"Click the button to edit the sequence of the selected domain. Click the arrow to see options to lock/unlock and reseed existing domains.",menu:[{text:"Unlock all bases in domain",iconCls:"unlock",handler:this.unlock,scope:this},{text:"Lock all bases in domain",iconCls:"lock",handler:this.lock,scope:this},"-",{text:"Reseed Domain",iconCls:"reseed",handler:this.reseed,scope:this},{text:"Reseed All Domains",iconCls:"reseed-all",handler:this.reseedAll,scope:this}]},{text:"Delete",ref:"delDomainButton",handler:this.doDeleteDomains,scope:this,iconCls:"cross",tooltip:"Delete the selected domain(s)"},"-",{text:"Advanced",iconCls:"tools",menu:[{text:"Design options",iconCls:"wrench",handler:this.designOptions,scope:this,tooltip:"Change options about how DD picks sequences, such as which bases are permitted and particular motifs to penalize. "},{text:"Tweak score parameters",iconCls:"tweak-score-params",handler:this.scoreParams,scope:this,tooltip:"Change DD's objective (scoring) function."},"-",{text:"Thread sequences",iconCls:"thread-sequence",handler:this.threadStrands,scope:this},"-",{text:"View DD file",iconCls:"dd",handler:this.showDDFile,scope:this,tooltip:"Show the raw DD file containing each of the sequences, their importances and compositions as plain text."},{text:"View Sequences",iconCls:"seq",handler:this.showDomainsPlaintext,scope:this,tooltip:"Show the sequences sequence of each domain as plain text suitable for copying and pasting into other programs."}]},"->",Ext.create("App.ui.SaveButton",{text:"Save Domains",iconCls:"save",app:this,defaultExtension:"ddjs",forceDefaultExtension:!1}),{text:"Help",iconCls:"help",handler:App.ui.Launcher.makeLauncher("help:web-dd")}]},bbar:{ref:"statusBar",items:[{baseText:"Attempts: ",text:"Attempts: ",ref:"attemptCount"},{baseText:"Mutations: ",text:"Mutations: ",ref:"mutCount"},{baseText:"Flux: ",text:"Flux: ",ref:"mutFlux"},{baseText:"Bored: ",text:"Bored: ",ref:"boredField"},{baseText:"∆: ",text:"∆: ",ref:"deltaField"},"->","->",{baseText:"Score: ",text:"Score: ",ref:"scoreField"}]},margin:0,bodyBorder:!1,border:!0,split:!0},Ext.create("App.usr.nupack.Editor",{region:"east",title:"Structure",editorType:"Structure",saveButtonText:"Save Strands",iconCls:"domains",ref:"structPane",collapsible:!0,collapsed:!0,width:200,split:!0,margin:0,border:!0,bodyBorder:!0,showCite:!1,showNupackButton:!1,showEditButton:!1,extraTbarItems:[{text:"Update",iconCls:"refresh",xtype:"splitbutton",menu:[{text:"Reseed existing domains",ref:"clobberOnUpdate",checked:!1}],handler:this.updateDomainsFromSpec,scope:this}],listeners:{afterrender:{scope:this,fn:function(a){a.header.tooltip={title:"Structure",text:'Use this pane to thread your domains onto strands. You can use a NUPACK-like syntax to describe your strands. For example, to describe strand "M1" containing domains 1, 2, and 3*, simply enter "M1 : 1 2 3*" then click "Update." Your changes will be reflected in the "Strands" pane below'},this.mixins.tip.buildTip(a.header)}}}}),Ext.create("App.usr.seq.Editor",{region:"south",title:"Strands",editorType:"Strands",saveButtonText:"Save Sequences",ref:"strandsPane",collapsible:!0,collapsed:!0,height:200,split:!0,border:!0,bodyBorder:!0,margin:0,listeners:{afterrender:{scope:this,fn:function(a){a.header.tooltip={title:"Strands",text:'This pane shows the sequences of the strands described in the "Structure" pane on the right. '},this.mixins.tip.buildTip(a.header)}}}})]}),this.on("afterrender",this.loadFile,this),this.on("afterrender",function(){this.targetColumnTip=Ext.create("Ext.tip.ToolTip",{target:this.grid.getEl(),delegate:".x-grid-checkheader",title:"Target Domain",html:"Select one or more domains to specifically target them for mutations. If you check multiple domains, the worst among them will be selected for mutation If you don't target any specific domains, the worst domain among the entire ensemble will be targeted by default.",anchor:"top",renderTo:Ext.getBody()})},this),this.callParent(arguments),this.mixins.tip.init.apply(this,arguments),_.each(this.query("*[ref]"),function(a){this[a.ref]=a},this)},updateDomainsFromSpec:function(){var a=this.structPane.getValue(),b=DNA.structureSpec(CodeMirror.tokenize(a,"nupack"));this.syncDomains(b.domains,this.clobberOnUpdate.checked),this.setStrands(b.strands);var c=this;_.defer(function(){c.structPane.on("expand",function(){c.structPane.setValue(a),c.strandsPane.expand(),c.strandsPane.on("expand",function(){c.updateStrandsPane()})}),c.structPane.expand()})},setStrands:function(a){this.strands=a},getSaveData:function(a){a||(a=this.document.getExt());if(a=="ddjs")return{structure:this.structPane.getValue()||"",state:this.designer.saveState()};if(a=="nupack"||a=="domains")return this.structPane.getValue();if(a=="seq")this.designer.printDomains().join("\n");else if(a=="dd")return this.designer.saveFile()},onLoad:function(){if(!!this.data){var a=this.document.getExt();a=="ddjs"?(this.data=Ext.decode(this.data),this.structPane.setValue(this.data.structure||""),this.designer.loadState(this.data.state||{}),this.addDomains(this.designer.printfDomains(),[],this.designer.getImportances(),this.designer.getCompositions(),!0),this.updateDomainsFromSpec()):a=="nupack"||a=="domains"?(this.structPane.setValue(this.data),this.updateDomainsFromSpec(),this.structPane.bindDocument(this.document),this.unbindDocument()):a=="seq"?this.addManyDomains(this.data):a=="dd"&&(this.designer.loadFile(this.data),this.addDomains(this.designer.printfDomains(),[],this.designer.getImportances(),this.designer.getCompositions(),!0))}},eachSelected:function(a){var b=this;a=a.bind(b);var c=this.grid.getSelectionModel().getSelection();return c?(_.each(c,function(c,d){var e=b.store.indexOf(c);a(c,e)}),!0):!1},reseed:function(){var a=this.grid.getSelectionModel().getLastSelected(),b=this.store.indexOf(a);a&&(this.designer.reseedDomain(b),a.set("sequence",this.designer.printfDomainById(b)))},reseedAll:function(){this.designer.reseed(),this.updateInterface(!0)},lock:function(){this.eachSelected(function(a,b){if(a){var c=a.get("sequence").toUpperCase();this.designer.updateDomain(b,c,a.get("importance"),a.get("composition")),a.set("sequence",c)}})},unlock:function(){this.eachSelected(function(a,b){if(a){var c=a.get("sequence").toLowerCase();this.designer.updateDomain(b,c,a.get("importance"),a.get("composition")),a.set("sequence",c)}})},updateDomain:function(a){this.designer.updateDomain(this.store.indexOf(a),a.get("sequence"),a.get("importance"),a.get("composition"))},updateParams:function(a){this.designer.updateParams(a)},updateRules:function(){this.designer.updateRules(v)},designOptions:function(){this.designOptionsWindow||(this.designOptionsWindow=Ext.create("App.usr.dd.RulesWindow",{designer:this.designer,closeAction:"hide"})),this.designOptionsWindow.setValues(this.designer.getRules()),this.designOptionsWindow.show()},scoreParams:function(){this.scoreParamsWindow||(this.scoreParamsWindow=Ext.create("App.usr.dd.ScoreParametersWindow",{designer:this.designer,closeAction:"hide"})),this.scoreParamsWindow.setValues(this.designer.getParams()),this.scoreParamsWindow.show()},updateStatusBar:function(){var a=this.designer.getMutationAttempts(),b=this.designer.getMutationCount(),c=this.designer.getWorstScore(),d=this.designer.getMutationFlux(),e=this.designer.getMutationDelta(),f=this.designer.getBoredMutations();this.attemptCount.setText(this.attemptCount.baseText+a),this.mutCount.setText(this.mutCount.baseText+b),this.scoreField.setText(this.scoreField.baseText+Ext.util.Format.number(c,this.scoreFormat)),this.mutFlux.setText(this.mutFlux.baseText+Ext.util.Format.number(d,this.scoreFormat)),this.deltaField.setText(this.deltaField.baseText+Ext.util.Format.number(e,this.scoreFormat)),this.boredField.setText(this.boredField.baseText+f)},doDeleteDomains:function(){this.eachSelected(function(a,b){this.designer.removeDomain(this.store.indexOf(a)),this.store.remove(a)})},syncDomains:function(a,b){b=b||!1,_.each(a,function(a,c){var d=this.store.findRecord("name",c);d||(d=this.store.getAt(parseInt(c)-1)),d?b&&(d.set("sequence",a),this.updateDomain(d)):this.addDomains([a],[c])},this)},addManyDomains:function(a){this.addDomainsWindow||(this.addDomainsWindow=Ext.create("App.usr.dd.SequenceWindow",{designer:this,value:a||""})),this.addDomainsWindow.show()},loadFromDDFile:function(a){this.loadDDFileWindow||(this.loadDDFileWindow=Ext.create("App.usr.dd.SequenceWindow",{designer:this,value:a||"",handler:function(a){this.designer.loadFile(a),this.addDomains(this.designer.printfDomains(),[],this.designer.getCompositions(),this.designer.getImportances())},scope:this})),this.loadDDFileWindow.show()},showDDFile:function(){var a=this.designer.saveFile();this.showDDFileWindow?this.showDDFileWindow.setValue(a):this.showDDFileWindow=Ext.create("App.usr.dd.SequenceWindow",{designer:this,title:"Raw DD file",buttonText:"Close",buttonIconCls:"cross",value:a||"",handler:function(a){this.close()}}),this.showDDFileWindow.show()},showDomainsPlaintext:function(){var a=this.designer.printfDomains().join("\n");this.showDomainsWindow?this.showDomainsWindow.setValue(a):this.showDomainsWindow=Ext.create("App.usr.dd.SequenceWindow",{designer:this,title:"Raw domain sequences",buttonText:"Close",buttonIconCls:"cross",value:a||"",handler:function(a){this.close()}}),this.showDomainsWindow.show()},addDomains:function(a,b,c,d,e){c||(c=1),d||(d=15),e=e||!1,e||this.designer.addDomains(a,c,d),this.addDomainsToStore(a,b,c,d),this.scoresDirty=!0,this.designer.evaluateIntrinsicScores(),this.mutateButton.enable()},addDomainsToStore:function(a,b,c,d){this.store.add(_.map(a,function(a,e){return{sequence:a,importance:_.isArray(c)?c[e]:c,composition:_.isArray(d)?d[e]:d,name:b&&b[e]?b[e]:""}},this))},doAddDomain:function(){var a=this.grid.getSelectionModel().getLastSelected();if(a)var b=a.get("composition");else b=15;var c=this.addDomLen.getValue(),d=this.designer.randomSequence(1,c)[0];this.addDomain(this.designer.printfDomain(d),1,b)},addDomain:function(a,b,c,d){d||(d=""),this.designer.addDomains([a],b,c,!1);var a=this.designer.printfDomainById(this.designer.getDomainCount()-1);this.store.add({sequence:a,importance:b,composition:c,name:d}),this.designer.evaluateIntrinsicScores(),this.scoresDirty=!0,this.mutateButton.enable()},toggleMutation:function(){this.mutating?this.pauseMutation():this.startMutation()},mutationStep:50,mutationCount:0,mutationLoop:function(){this.mutationCount>this.mutationStep&&(this.updateInterface(),this.mutationCount=0),this.mutationCount++,this.doMutation()},doMutation:function(){this.designer.mutate()},updateInterface:function(a,b){a||(a=!1),b||(b=!0),this.updateStatusBar();var c=this.designer.getScores(!0),d=this.designer.getMutatedDomain(),e=this.designer.printfDomainById(d),f=a?this.designer.printfDomains():null,g;for(var h=0;h<c.length;h++)g=this.store.getAt(h),b&&(!(g.get("score")!=0&&g.get("score")<c[h]),g.set("score",c[h])),a&&g.set("sequence",f[h]);g=this.store.getAt(d),g.set("sequence",e),this.store.sync();if(this.strands){var i=_.reduce(this.store.getRange(),function(a,b){var c=b.get("name"),d=this.store.indexOf(b);return a[c?c:d+1]=this.designer.printDomainById(d),a},{},this);this.strandsPane.setValue(_.map(this.strands,function(a,b){return b+" : "+DNA.threadSegments(i,a)}).join("\n"))}},updateStrandsPane:function(){var a=_.reduce(this.store.getRange(),function(a,b){var c=b.get("name"),d=this.store.indexOf(b);return a[c?c:d+1]=this.designer.printDomainById(d),a},{},this);this.strandsPane.setValue(_.map(this.strands,function(b,c){return c+" : "+DNA.threadSegments(a,b)}).join("\n"))},threadStrands:function(){var a=Ext.create("App.ui.SequenceThreader");a.show();var b=_.map(this.store.getRange(),function(a){var b=a.get("name"),c=this.store.indexOf(a);return b=b?b:c+1,b+" : "+this.designer.printDomainById(c)},this),c=_.map(this.strands,function(a,b){return b+" : "+spec});a.setSequences(b.join("\n")),a.setStrands(c.join("\n"))},startMutation:function(){this.mutateButton.setIconCls("pause"),_.invoke([this.modDomainButton,this.addDomainButton,this.delDomainButton],"disable");if(!this.mutationTask||this.scoresDirty)this.designer.evaluateAllScores(),this.scoresDirty=!1;var a=this.designer.printfDomains();_.each(a,function(a,b){this.store.getAt(b).set("sequence",a)},this),this.mutationTask?this.mutationTask=Ext.TaskManager.start(this.mutationTask):this.mutationTask=Ext.TaskManager.start({run:this.mutationLoop,interval:.1,scope:this}),this.mutating=!0},pauseMutation:function(){this.mutateButton.setIconCls("play"),_.invoke([this.modDomainButton,this.addDomainButton,this.delDomainButton],"enable"),this.mutationTask&&Ext.TaskManager.stop(this.mutationTask),this.mutating=!1}});
Ext.define("App.usr.dil.Complex",{extend:"Ext.data.Model",requires:["App.usr.dil.StrandStore","App.usr.dil.SegmentStore"],fields:[{name:"id",type:"int"},{name:"name"},{name:"polarity",type:"int"},{name:"strands"},{name:"specs"},{name:"sequences"},{name:"structure"},{name:"extraData"},{name:"type"}],idgen:"sequential",getDynaml:function(a){return a.getNode(this.get("name"))},getStrands:function(){return this.get("strands")},getStructures:function(){var a=this.get("structure")||"";return _.map(a.split("+"),function(a){return a.trim()})},fixStructure:function(a,b,c){var d=this.getStructures(),e=d[a];if(e){e=e.split("");for(var f=e.length-1;f>=0;f--)c.indexOf(f)!=-1&&delete e[f],b.indexOf(f)!=-1&&e.splice(f,0,".");d[a]=_.compact(e).join(""),this.set("structure",d.join("+"))}},proxy:"memory"});
Ext.define("App.usr.dil.ComplexStore",{requires:["App.usr.dil.Complex"],extend:"Ext.data.Store",model:"App.usr.dil.Complex",constructor:function(){this.callParent(arguments),this.strandStore&&this.strandStore.on("update",function(a,b,c,d){(d.indexOf("sequence")!=-1||d.indexOf("spec")!=-1)&&this.updateComplexes()},this)},updateComplexes:function(a){var b={},c={},d=this.strandStore.getRange(),e=this.getRange();for(var f=0;f<d.length;f++){var g=d[f],h=g.get("name");b[h]=g.get("spec"),c[h]=g.get("seq")}var i=a?a.get("name"):null;for(var f=0;f<e.length;f++){var j=e[f],k=j.get("strands"),l=[],m=[],n=null,o=null;for(var p=0;p<k.length;p++){var q=k[p];l.push(b[q]),m.push(c[q])}j.beginEdit(),j.set("spec",l),j.set("seqs",m),j.endEdit()}},addComplex:function(){var a=_.max(_.map(this.getRange(),function(a){var b=a.get("name").match(/\d+/g);return!!b&&b.length>0&&!isNaN(b[0])?b:0}));a<0?a=0:a;var b;do a+=1,b=this.find("name",a);while(b!=-1);return this.add({name:"n"+a,strands:[],specs:[],struture:""})}});
Ext.define("App.usr.dil.StrandPreviewGrid",{extend:"Ext.view.View",requires:["App.usr.dil.SegmentStore","App.usr.dil.ComplexStore"],cellWidth:200,cellHeight:200,itemSelector:"div.complex-wrap",trackOver:!0,overItemCls:"x-view-over",multiSelect:!1,singleSelect:!0,autoScroll:!0,paddingWidth:6,paddingHeight:14,nodeFillMode:"segment",nodeStrokeMode:"segment",lineStrokeMode:"default",textFillMode:"default",showBubbles:!0,loopMode:"linear",showBases:!0,showIndexes:!0,showSegments:!0,structureMode:"segment",createTip:!1,tipDelegate:"circle",zoom:-1,initComponent:function(){this.strandPreviews={},this.tpl=this.generateTemplate(),this.on("itemadd",this.addComplexes),this.on("itemupdate",this.updateComplex),this.on("itemremove",this.removeComplex),this.on("itemmouseenter",function(a,b,c,d){this.fireEvent("updateToolbar",c)},this),this.segmentStore.on("update",function(a,b,c,d){d.indexOf("color")!=-1&&this.refresh()},this,{buffer:100}),this.on("afterrender",function(){this.createTip&&(this.tip=Ext.create("Ext.tip.ToolTip",{target:this.getEl(),delegate:this.tipDelegate,trackMouse:!0,showDelay:!1,renderTo:Ext.getBody(),listeners:{beforeshow:{fn:this.updateTipBody,scope:this}}}),this.sequenceRenderer=CodeMirror.modeRenderer("sequence"))},this),this.callParent(arguments)},updateTipBody:function(a){var b=Ext.get(a.triggerElement).up("g");if(b){b=d3.select(b.dom);var c=b.datum();a.update(this.getTipBody(c))}},getTipBody:function(a){var b="<b>"+this.sequenceRenderer(a.base)+"</b> | <b>"+a.strand+"</b> / <b>"+a.segment+"</b> / "+a.segment_index+"<br />";return a.immutable&&(b+="<b>Immutable</b><br />"),a.prevented&&(b+="<b>Prevented</b> ("+this.sequenceRenderer(a.prevented)+")<br />"),a.changed&&(b+="<b>Changed</b> ("+a.changed.reason+")"),b},getChart:function(a){a||(a=!1);if(!this.chart||a)this.chart=StrandPreview().width(this.cellWidth-this.paddingWidth).height(this.cellHeight-this.paddingHeight).showBubbles(this.showBubbles).showBases(this.showBases).showIndexes(this.showIndexes).showSegments(this.showSegments).loopMode(this.loopMode).nodeStrokeMode(this.nodeStrokeMode).nodeFillMode(this.nodeFillMode).lineStrokeMode(this.lineStrokeMode).textFillMode(this.textFillMode),this.chart.segmentColors(this.getSegmentColorScale());return this.chart},updateChartProperties:function(){this.tpl=new Ext.XTemplate(this.generateTemplate()),this.getChart(!0),this.refresh()},setCellSize:function(a,b){arguments.length<2&&(b=a),this.cellWidth=a,this.cellHeight=b,this.updateChartProperties()},setZoom:function(a){this.zoom=a,this.updateChartProperties()},refresh:function(){if(this.pauseUpdates)return;this.callParent(arguments);var a=this,b=[],c=a.store.getRange(),d=[],e=a.getSegmentMap();for(var f=0;f<c.length;f++){var g=c[f],h=this.getNode(g);h&&(b.push(h),d.push(a.getComplexData(g,e)))}if(b.length>0){var i=a.getChart(),j=d3.selectAll(b).data(d).append("svg");this.preview=i(j)}},addComplexes:function(a,b,c){if(this.pauseUpdates)return;var d=this,e=[],f=d.getSegmentMap();for(var g=0;g<a.length;g++){var h=a[g];e.push(d.getComplexData(h,f))}if(c.length>0){var i=d.getChart(),j=d3.selectAll(c).data(e).append("svg");this.preview=i(j)}},updateComplex:function(a,b,c){if(this.pauseUpdates)return;var d=this,e=a,f=this.getSegmentMap(),g=[d.getComplexData(e,f)],h=d.getChart(),i=d3.select(c).data(g).append("svg");h(i),this.preview.expandSelection(i)},removeComplex:function(a,b){if(this.pauseUpdates)return},getComplexData:function(a,b){var c=this;return b=b||c.getSegmentMap(),{strands:_.map(a.getStrands(),function(a){return{name:a,domains:c.strandStore.findRecord("name",a).getParsedSpec()}}),structure:this.structureMode=="segment"?a.get("structure"):undefined,dotParen:this.structureMode=="base"?a.get("structure"):undefined,sequences:b,extraData:a.get("extraData")||null}},getSegmentMap:function(){if(this.segmentMap)return this.segmentMap;if(this.segmentStore)return this.segmentStore.getSegmentMap()},getSegmentColorScale:function(){return this.segmentStore.getSegmentColorScale()},highlight:function(a){this.preview.highlight(a)},unhighlight:function(a){this.preview.unhighlight(a)},generateTemplate:function(){return['<tpl for=".">','<div style="border:solid 1px white;padding:4px;margin:10px;float:left;width:'+this.cellWidth+"px;height:"+(this.cellHeight+this.paddingHeight)+'px;" class="complex-wrap">','<span style="position:absolute;">{name}</span>',"</div>","</tpl>"].join("")},getMarkup:function(a){this.svgStyles?this.doGetMarkup(a):Ext.Ajax.request({url:"styles/strand-preview.css",success:function(b){this.svgStyles=b.responseText,this.doGetMarkup(a)},scope:this})},doGetMarkup:function(a){var b=this,c=6,d=10,e=10,f=_.map(this.getNodes(),function(a,f){var g=f%c,h=Math.floor(f/c),i=a.innerHTML.replace(/<span(\b[^>]*)>([^<]*)<\/span>/g,'<text class="complex-label">$2</text>').replace(/<svg(\b[^>]*)>/g,"").replace("</svg>","");return'<g transform="translate('+[d+g*b.cellWidth,e+h*b.cellHeight]+')">'+i+"</g>"}).join("\n"),g='<?xml version="1.0" encoding="UTF-8" ?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css"><![CDATA['+this.svgStyles+"]]></style>"+f+"</svg>";a(g)}});
Ext.define("App.usr.dil.EditComplexPanel",{extend:"Ext.panel.Panel",alias:"widget.editcomplexpanel",requires:["App.usr.dil.SegmentStore","App.usr.dil.StrandStore","App.usr.dil.ComplexStore"],mixins:{tip:"App.ui.TipHelper"},layout:"border",border:!1,bodyBorder:!1,initComponent:function(){Ext.apply(this,{items:[{xtype:"strandpreview",name:"strandPreview",region:"center"},{xtype:"form",name:"formPanel",region:"west",width:200,split:!0,frame:!0,defaults:{labelAlign:"top",anchor:"100%"},items:[{xtype:"textarea",name:"strandsField",validator:Ext.bind(this.validateStrands,this),minHeight:20,tooltip:"Enter the name(s) of your strand(s) order in which they should appear in the complex. Separate strand names with + signs.If you do not enter a strand's name here, it will not appear in the complex. Strand names can be used multiple times—this will create a complex with multiple copies of that strand. "},{fieldLabel:"Strand Order",xtype:"displayfield",name:"segmentsField",cls:"strand-glyph-well",minHeight:20,tooltip:"Click to edit the order in which strands will appear in the complex. If you do not enter a strand's name here, it will not appear in the complex."},{fieldLabel:"Structure",xtype:"textarea",name:"structureField",validator:Ext.bind(this.validateStructure,this),tooltip:"Enter the structure for the complex in dot-parenthesis notation."}]}]}),this.callParent(arguments),this.formPanel=this.down("[name=formPanel]"),this.strandPreview=this.down("[name=strandPreview]"),this.segmentsField=this.down("[name=segmentsField]"),this.structureField=this.down("[name=structureField]"),this.strandsField=this.down("[name=strandsField]"),this.strandsField.on("blur",function(){this.updateSegmentsView()},this),this.strandsFieldEditor=Ext.create("Ext.Editor",{field:this.strandsField,hideEl:!1,autoSize:{width:"boundEl",height:"boundEl"},alignment:"tl-tl?"}),this.on("afterrender",function(){this.segmentsField.getEl().on("click",function(){this.strandsFieldEditor.startEdit(this.segmentsField.inputEl,this.complex.getStrands().join("+"))},this)}),this.on("afterrender",this.loadData,this),this.on("show",this.loadData,this),this.formPanel.on("validitychange",function(a,b){b&&this.updateComplex()},this,{buffer:100}),this.mixins.tip.init.call(this,[])},loadData:function(){this.complexData=this.strandManager.getComplexData(this.complex),this.strandsField.setValue(this.complex.getStrands().join("+")),this.structureField.setValue(this.complexData.structure),this.updateView()},updateComplex:function(){this.complex.beginEdit(),this.complex.set("strands",this.getStrands()),this.complex.set("structure",this.getStructure()),this.complex.endEdit(),this.complexData=this.getComplexData(this.complex),this.updateView()},updateView:function(){var a=this;!this.segmentColors||(this.strandPreview.segmentColors=this.segmentColors),this.strandPreview.setValue(this.complexData),this.segmentsField.setValue(_.map(this.complexData.strands,function(b){return a.buildStrandGlyph(b)}).join(" + ")||"(click to edit)")},updateSegmentsView:function(){var a=this,b=this.getStrands();b.length>0?this.segmentsField.setValue(_.map(b,function(b){var c=a.getStrandData(b);return a.buildStrandGlyph(c,b)}).join(" + ")):this.segmentsField.setValue("(click to edit)")},buildStrandGlyph:function(a,b){var c='<div class="strand-glyph'+(a?"":" strand-glyph-unknown")+'">';return a?c+='<span class="strand-glyph-name">'+a.name+"</span>"+_.map(a.segments,function(a){return DNA.makeIdentifier(a.identity,a.polarity)}).join(" "):c+='<span class="strand-glyph-name">'+b+"</span>"+" ? ",c+="</div>",c},getStrands:function(){var a=this.strandsField.getValue()||"";return _.map(a.split("+"),function(a){return a.trim()})},getStructure:function(){return this.structureField.getValue()||""},getStrandData:function(){return this.strandManager.getStrandData.apply(this.strandManager,arguments)},getComplexData:function(){return this.strandManager.getComplexData.apply(this.strandManager,arguments)},validateStrands:function(){var a=this.getStrands();for(var b=0;b<a.length;b++){var c=this.getStrandData(a[b]);if(!c)return"Unknown strand '"+a[b]+"'"}return this.structureField.validate(),!0},validateStructure:function(){var a=this.getStrands(),b=this.getStructure(),c=DNA.validateDotParen(b,!0,!0);if(c!==!0)return c;structures=b.split("+");if(a.length!=structures.length)return Ext.String.format("Strand count and structure count do not match; {0} strands and {1} structures. Make sure to separate structures for different strands with + signs.",a.length,structures.length);for(var d=0;d<a.length;d++){var e=this.getStrandData(a[d]);if(!e)return"Please correct strand field to remove unrecognized strand.";if(e.segments.length!=structures[d].length)return Ext.String.format("Strand length mismatch; strand '{0}' has {1} segments, but its structure has {2} elements.",a[d],e.segments.length,structures[d].length)}return!0}});
Ext.define("App.usr.dil.EditComplexWindow",{extend:"Ext.window.Window",requires:["App.usr.dil.EditComplexPanel"],closable:!0,closeAction:"hide",maximizable:!0,width:500,height:300,renderTo:Ext.getBody(),autoRender:!1,layout:"fit",border:!1,bodyBorder:!1,initComponent:function(){Ext.apply(this,{items:[Ext.create("App.usr.dil.EditComplexPanel",{complex:this.complex,strandManager:this.strandManager,segmentColors:this.segmentColors})]}),this.callParent(arguments)}});
Ext.define("App.usr.dil.DilEditor",{extend:"Ext.panel.Panel",layout:"border",border:!1,bodyBorder:!1,alias:"widget.strandedit",mixins:{app:"App.ui.Application",tip:"App.ui.TipHelper"},requires:["App.ui.D3Panel","App.usr.seq.Editor","App.usr.dil.HighlightManager","App.usr.dil.EditComplexWindow","App.usr.dd.SequenceWindow","App.ui.SequenceThreader","App.ui.AddDomainButton","App.ui.StrandPreviewViewMenu","App.usr.dil.SegmentStore","App.usr.dil.StrandStore","App.usr.dil.ComplexStore","App.usr.dil.SegmentsGrid","App.usr.dil.StrandsGrid","App.usr.dil.StrandPreviewGrid"],constructor:function(){this.mixins.app.constructor.apply(this,arguments),this.editComplexWindows={},this.callParent(arguments)},title:"Strand Editor",iconCls:"domains",editorType:"System",initComponent:function(){this.segmentStore=Ext.create("App.usr.dil.SegmentStore",{}),this.strandStore=Ext.create("App.usr.dil.StrandStore",{segmentStore:this.segmentStore}),this.complexStore=Ext.create("App.usr.dil.ComplexStore",{strandStore:this.strandStore}),Ext.apply(this,{tbar:[{xtype:"buttongroup",columns:2,title:"Design Sequences",items:[{text:"DD",width:64,iconCls:"sequence-24",scale:"medium",iconAlign:"top",rowspan:2,handler:this.buildDD,scope:this},{text:"NUPACK",iconCls:"nupack-icon",handler:this.buildNupack,scope:this},{text:"Multisubjective",iconCls:"ms-icon",handler:this.buildMS,scope:this}]},{xtype:"buttongroup",columns:2,title:"Kinetics",items:[{text:"Enumerate",scale:"medium",rowspan:2,iconAlign:"top",iconCls:"enumerate-24",handler:this.buildEnum,scope:this},{text:"to PIL",iconCls:"pil"},{text:"to SBML",iconCls:"sbml"}]},{xtype:"buttongroup",columns:1,title:"Thermodynamics",items:[{xtype:"splitbutton",text:"Predict",scale:"medium",rowspan:2,iconAlign:"top",iconCls:"secondary-24",handler:this.buildTherm,scope:this,menu:[{handler:function(){this.buildTherm("nupack")},scope:this,text:"Predict structures with NUPACK",iconCls:"nupack"},{handler:function(){this.buildTherm("vienna")},scope:this,text:"Predict structures with RNAfold",iconCls:"tbi"},{handler:function(){this.buildTherm("mfold")},scope:this,text:"Predict structures with Mfold",iconCls:"mfold"}]}]},{xtype:"buttongroup",columns:2,title:"Export",items:[{text:"SVG",iconCls:"svg",scale:"medium",iconAlign:"top",rowspan:2,handler:this.displaySVGWindow,scope:this},{text:"PIL",iconCls:"pil",handler:this.buildPil,scope:this},{text:"DyNAML",iconCls:"dynaml",disabled:!0}]},"->",{xtype:"buttongroup",columns:1,title:"Workspace",items:[Ext.create("App.ui.SaveButton",{app:this}),{text:"Help",iconCls:"help",handler:App.ui.Launcher.makeLauncher("help:dil")}]}],items:[{xtype:"strandsgrid",name:"strandsGrid",store:this.strandStore,segmentStore:this.segmentStore,region:"south",collapsible:!0,titleCollapse:!0,title:"Strands",height:200,split:!0},{xtype:"segmentsgrid",name:"segmentsGrid",store:this.segmentStore,title:"Segments",titleCollapse:!0,collapsible:!0,region:"east",width:200,split:!0},{xtype:"panel",layout:"fit",region:"center",items:[Ext.create("App.usr.dil.StrandPreviewGrid",{name:"complexView",store:this.complexStore,strandStore:this.strandStore,segmentStore:this.segmentStore,listeners:{itemdblclick:{fn:function(a,b,c){this.showEditComplexWindow(b,c)},scope:this}}})],bbar:[{text:"Add",iconCls:"plus",handler:this.doAddComplex,scope:this},{text:"Edit",iconCls:"pencil",handler:this.doEditComplex,scope:this},{text:"Delete",iconCls:"delete",handler:this.doDeleteComplex,scope:this,disabled:!0},"->",{xtype:"slider",fieldLabel:"Size",labelWidth:40,width:100,minValue:100,maxValue:400,value:200,increment:10,listeners:{changecomplete:{fn:function(a,b){this.complexView.setCellSize(b)},scope:this}}},"-",Ext.create("App.ui.StrandPreviewViewMenu",{view:null,name:"complexViewMenu"})]}]}),this.on("afterrender",this.loadFile,this),this.callParent(arguments),this.strandsGrid=this.down("[name=strandsGrid]"),this.segmentsGrid=this.down("[name=segmentsGrid]"),this.complexView=this.down("[name=complexView]"),this.down("[name=complexViewMenu]").view=this.complexView,this.segmentStore.on("update",function(a,b,c,d){this.updateStrandSequences()},this),this.highlightManager=Ext.create("App.usr.dil.HighlightManager",{segmentStore:this.segmentStore,strandStore:this.strandStore,complexStore:this.complexStore,segmentsGrid:this.segmentsGrid,strandsGrid:this.strandsGrid,complexView:this.complexView}),this.on("afterrender",function(){this.highlightManager.afterrender()},this)},onLoad:function(){if(!_.isObject(this.data)&&_.isString(this.data)&&!!this.data)try{this.data=JSON.parse(this.data)}catch(a){Ext.msg("Unable to load strand data."),console.error(a)}else this.data={};this.library=App.dynamic.Library.fromDil(this.data),this.loadLibrary(this.library),_.defer(_.bind(this.complexView.refresh,this.complexView))},addComplex:function(){return _.first(this.complexStore.addComplex())},doAddComplex:function(){var a=this.addComplex();this.editComplex(a)},editComplex:function(b){b||(b=this.complexView.getSelectionModel().getLastSelected()),b&&this.showEditComplexWindow(b)},doEditComplex:function(){this.editComplex()},getComplexData:function(a){_.isString(a)&&(a=this.complexStore.findRecord("name",a));if(a)return{strands:_.map(a.getStrands(),this.getStrandData,this),structure:a.get("structure"),sequences:this.getSegmentMap()}},getStrandData:function(a){_.isString(a)&&(a=this.strandStore.findRecord("name",a));if(a)return{name:a.get("name"),domains:_.clone(a.getParsedSpec()),segments:_.clone(a.getFlatSpec())}},getSegmentMap:function(){return this.segmentStore.getSegmentMap()},getSegmentColorScale:function(){return this.complexView.getSegmentColorScale()},updateStrandSequences:function(){var a=this.getSegmentMap();this.strandStore.each(function(b){var c=b.getFlatSpec();b.set("sequence",DNA.threadSegments(a,c))},this)},showEditComplexWindow:function(a,b){var c=a.get("name");b||this.complexView.getNode(a),this.editComplexWindows[c]||(this.editComplexWindows[c]=Ext.create("App.usr.dil.EditComplexWindow",{complex:a,renderTo:Ext.getBody(),title:c,strandManager:this,segmentColors:this.getSegmentColorScale()})),this.editComplexWindows[c].show(),b&&this.editComplexWindows[c].alignTo(b,"tl-tl")},buildTarget:function(a){this.requestDocument(function(b){var c=this.serializeDil(),d=this.getDocumentPath(),e,f,g;switch(a){case"dd":f="dd",g="domains",a="DD";break;case"nupack":f="nupack",g="np",a="NUPACK";break;case"ms":f="ms",g="ms",a="Multisubjective";break;case"pil":f="pil",g="pil",a="PIL";break;case"enum":f="enum",g="enum","Enumerator";break;case"svg":f="svg",g="svg","SVG"}e=App.path.repostfix(d,g),App.runTask("Nodal",{node:d,data:c,action:f},function(c,d,e){e?App.msg("DIL Output","Output of system <strong>{0}</strong> to {1} completed.",b.getBasename(),a):App.msg("DIL Output error","Output of system <strong>{0}</strong> to {1} failed! See Console for details.",{params:[b.getBasename(),a],handler:"console"})},this,{openOnEnd:[e]})},this)},buildDD:function(){this.buildTarget("dd")},buildNupack:function(){this.buildTarget("nupack")},buildMS:function(){this.buildTarget("ms")},buildPil:function(){this.buildTarget("pil")},buildSVG:function(){this.buildTarget("svg")},buildEnum:function(){this.buildTarget("enum")},displaySVGWindow:function(){this.complexView.getMarkup(Ext.bind(this.doDisplaySVGWindow,this))},doDisplaySVGWindow:function(a){this.svgWindow=Ext.create("App.ui.StrandPreviewTextWindow",{title:"SVG"}),this.svgWindow.show(),this.svgWindow.setValue(a)},loadLibrary:function(a){a||(a={});var b=this.complexStore,c=this.strandStore,d=this.segmentStore,e=d3.scale.category20();d.colorGenerator=e,d.add(_.map(a.segments||[],function(a){return{identity:a.getIdentity(),sequence:a.getSequence(),color:a.color?a.color:e(a.getIdentity())}})),b.add(_.map(a.nodes||[],function(a){return c.add(_.map(a.getStrands()||[],function(a){return{name:a.getQualifiedName(),sequence:a.getSequence(),complex:a.getNode().getName(),spec:a.printDomains(!0),polarity:a.getPolarity()}})),{name:a.getName(),polarity:a.getPolarity(),type:a.type,structure:a.getOrderedSegmentwiseStructure().toDotParen(),strands:_.map(a.getStrands(),function(a){return a.getQualifiedName()})}}))},buildLibrary:function(){var a=this.segmentStore.getRange(),b=this.strandStore.getRange(),c=this.complexStore.getRange(),d={},e=[],f={},g=[],h=[];for(var i=0;i<a.length;i++){var j=a[i],k={identity:j.get("identity"),sequence:j.get("sequence"),color:j.get("color")};e.push(k),d[k.identity]=k.sequence}for(var i=0;i<b.length;i++){var j=b[i],l,m=_.clone(j.getParsedSpec());for(var n=0;n<m.length;n++){var o=m[n];for(var p=0;p<o.segments.length;p++){var k=o.segments[p];k.sequence=d[k.identity]}}l={name:j.get("name"),domains:m},g.push(l),f[l.name]=l}for(var i=0;i<c.length;i++){var q=c[i],r=q.getStrands(),s;s={name:q.get("name"),structure:q.get("structure"),polarity:q.get("polarity"),strands:_.map(r,function(a){return f[a]}),type:q.get("type")},h.push(s)}return new App.dynamic.Library({nodes:h,allSegments:e})},getStrandSequences:function(){return this.strandStore.getSequences()},buildTherm:function(a){var b=this.getStrandSequences(),c;a=a||"nupack";switch(a){case"mfold":c=Ext.create("App.ui.mfold.QuikFoldWindow");break;case"vienna":c=Ext.create("App.ui.vienna.RNAfoldWindow");break;case"nupack":default:c=Ext.create("App.ui.nupack.PartitionWindow")}c.show(),c.setValue(DNA.printSequences(b,":"))},serializeDil:function(){var a=this.buildLibrary();return a.toDilOutput()},getSaveData:function(){return this.serializeDil()}});
Ext.define("App.usr.nodal.MotifEditor",{extend:"Ext.panel.Panel",mixins:{tip:"App.ui.TipHelper"},requires:["App.usr.dil.SegmentStore","App.usr.dil.StrandStore","App.usr.dil.ComplexStore","App.usr.dil.StrandsGrid","App.usr.dil.SegmentsGrid","App.usr.nodal.MotifPreview","App.usr.dil.EditComplexPanel"],layout:"border",border:!1,bodyBorder:!1,initComponent:function(){this.segmentStore=Ext.create("App.usr.dil.SegmentStore",{}),this.strandStore=Ext.create("App.usr.dil.StrandStore",{segmentStore:this.segmentStore}),this.complexStore=Ext.create("App.usr.dil.ComplexStore",{strandStore:this.strandStore}),this.loadDynaml(this.data),this.segmentStore.on("update",this.refresh,this),this.strandStore.on("update",this.refresh,this),this.complexStore.on("update",this.refresh,this),Ext.apply(this,{items:[{region:"north",layout:"border",height:200,split:!0,border:!1,bodyBorder:!1,items:[{region:"west",xtype:"segmentsgrid",name:"segmentsGrid",store:this.segmentStore,title:"Segments",width:200,split:!0},{region:"center",xtype:"strandsgrid",name:"strandsGrid",store:this.strandStore,segmentStore:this.segmentStore,collapsible:!0,titleCollapse:!0,title:"Strands"}]},{region:"center",title:"Structure",layout:"border",border:!1,bodyBorder:!1,items:[{region:"center",xtype:"editcomplexpanel",name:"complexPanel",strandManager:this,complex:this.complex,border:!1,bodyBorder:!1},{region:"east",xtype:"motifpreview",name:"motifPreview",width:200,border:!0,bodyBorder:!1,split:!0}]}]}),this.callParent(arguments),this.strandsGrid=this.down("[name=strandsGrid]"),this.segmentsGrid=this.down("[name=segmentsGrid]"),this.complexPanel=this.down("[name=complexPanel]"),this.motifPreview=this.down("[name=motifPreview]")},refresh:function(){if(!this.suspendRefresh){var a=this.buildMotif();this.motifPreview.setValue(a)}},getComplexData:function(a){_.isString(a)&&(a=this.complexStore.findRecord("name",a));if(a)return{strands:_.map(a.getStrands(),this.getStrandData,this),structure:a.get("structure"),sequences:this.getSegmentMap()}},getStrandData:function(a){_.isString(a)&&(a=this.strandStore.findRecord("name",a));if(a)return{name:a.get("name"),domains:_.clone(a.getParsedSpec()),segments:_.clone(a.getFlatSpec())}},getSegmentMap:function(){return this.segmentStore.getSegmentMap()},updateStrandSequences:function(){var a=this.getSegmentMap();this.strandStore.each(function(b){var c=b.getFlatSpec();b.set("sequence",DNA.threadSegments(a,c))},this)},loadDynaml:function(a){a||(a="{}");var b;try{b=JSON.parse(a)}catch(c){}_.defaults(a,{name:"",structure:""}),this.library=App.dynamic.Library.dummy(),b.library=this.library;var d=new App.dynamic.Motif(b);this.loadMotif(d),this.complex=this.complexStore.getAt(0)||_.first(this.complexStore.addComplex())},loadMotif:function(a){a||(a={});var b=this.complexStore,c=this.strandStore,d=this.segmentStore,e=d3.scale.category20();d.colorGenerator=e,this.suspendRefresh=!0;var f=_.map(a.getSegments()||[],function(a){return{identity:a.getIdentity(),sequence:a.getSequence(),color:a.color?a.color:e(a.getIdentity())}}),g=[];for(var h=0;h<f.length;h++){var i=f[h],j=d.findRecord("identity",i.identity);j?(j.beginEdit(),j.set("identity",i.identity),j.set("sequence",i.sequence),j.set("color",i.color),j.endEdit()):g.push(i)}d.add(g),b.add([function(a){var b=_.map(a.getStrands()||[],function(b){return{name:b.getName(),sequence:b.getSequence(),complex:a.getName(),spec:b.printDomains(!0),polarity:b.getPolarity()}}),d=[];for(var e=0;e<b.length;e++){var f=b[e],g=c.findRecord("name",f.name);g?(g.beginEdit(),g.set("name",f.name),g.set("sequence",f.sequence),g.set("complex",f.complex),g.set("spec",f.spec),g.set("polarity",f.polarity),g.endEdit()):d.push(f)}c.add(d);var h;try{h=a.getSegmentwiseStructure().toDotParen()}catch(i){h=""}return{name:a.getName(),polarity:a.getPolarity(),structure:h,strands:_.map(a.getStrands(),function(a){return a.getName()})}}(a)]),this.suspendRefresh=!1},buildMotif:function(){var a=this.segmentStore.getRange(),b=this.strandStore.getRange(),c=this.complexStore.getRange(),d={},e=[],f={},g=[],h=[];for(var i=0;i<a.length;i++){var j=a[i],k={identity:j.get("identity"),sequence:j.get("sequence"),color:j.get("color")};e.push(k),d[k.identity]=k.sequence}for(var i=0;i<b.length;i++){var j=b[i],l,m=_.clone(j.getParsedSpec());for(var n=0;n<m.length;n++){var o=m[n];for(var p=0;p<o.segments.length;p++){var k=o.segments[p];k.sequence=d[k.identity]}}l={name:j.get("name"),domains:m},g.push(l),f[l.name]=l}var q=c[0],r=q.getStrands(),s;s={name:q.get("name"),structure:q.get("structure"),polarity:q.get("polarity"),strands:_.map(r,function(a){return f[a]})},h.push(s);var t=App.dynamic.Library.dummy();return s.library=t,new App.dynamic.Motif(s)},getValue:function(){var a=this.buildMotif();return JSON.stringify(a.serialize(),null,"	")},setValue:function(a){this.complexStore.remove(this.complexStore.getRange()),this.data=a,this.loadDynaml(this.data)}}),Ext.define("App.usr.nodal.MotifEditorWindow",{extend:"Ext.window.Window",requires:["App.usr.nodal.MotifEditor"],border:!1,bodyBorder:!1,width:600,height:400,layout:"fit",initComponent:function(){this.nodeTypeEditor=Ext.create("App.usr.nodal.MotifEditor",{data:this.data}),this.items=[this.nodeTypeEditor],this.buttons||(this.buttons=[]),this.buttons.unshift(Ext.create("App.ui.HelpButton",{topic:"nodal#motif-editor"})),this.callParent(arguments)},getValue:function(){return this.nodeTypeEditor.getValue()},setValue:function(a){this.nodeTypeEditor.setValue(a)}});
Ext.define("App.usr.nodal.MotifInspector",{requires:["App.ui.CodeMirror","App.usr.nodal.MotifEditor"],extend:"Ext.form.Panel",mixins:{boundObjectPanel:"App.ui.BoundObjectPanel",tip:"App.ui.TipHelper"},title:"Motif",bodyPadding:5,enableBoundFields:!0,initComponent:function(){var a=this;Ext.apply(this,{defaults:{xtype:"textfield"},fieldDefaults:{labelWidth:100},items:[{objectBinding:"name",anchor:"100%"},{xtype:"sliderfield",fieldLabel:"Rotation",minValue:0,maxValue:360,width:100,increment:15,anchor:"95%",objectBinding:"theta",tipText:function(a){return String(a.value)+"°"}},{xtype:"fieldset",layout:"anchor",title:"Motif Definition",items:[{xtype:"button",text:"Edit Motif",iconCls:"edit",handler:this.showMotifEditor,scope:this,margin:"0 3 3 0",tooltip:"Edit this motif using the graphical motif editor."},{xtype:"button",text:"Copy from Built-in",iconCls:"duplicate",tooltip:"Update the definition of this motif to duplicate one of the built-in motifs. You can then use the graphical Motif Editor (left) or directly edit the DyNAML code (below) to make changes to this new motif.",margin:"0 3 3 0",menu:_.map(App.dynamic.Compiler.standardMotifs,function(b){return function(b){return{text:b.name,handler:function(){a.codeEditor.setValue(JSON.stringify(b,null,"	"))}}}(b)})},{xtype:"codemirror",objectBinding:"dynaml",objectBindingEvent:"blur",anchor:"100%",height:300,title:"DyNAML Code",collapsed:!0,collapsible:!0,resizable:!0,cls:"simple-header",mode:{name:"javascript",json:!0}}]}],showIf:function(a){return a=="App.usr.nodal.ws.objects.Motif"}}),this.callParent(arguments),this.mixins.boundObjectPanel.initialize.apply(this,arguments),this.mixins.tip.init.apply(this,arguments),this.motifEditors={},this.codeEditor=this.down("[xtype=codemirror]")},showMotifEditor:function(){var a=this.getBoundObject();if(!this.motifEditors[a.getId()]){var b=function(a){return function(){var b=this.motifEditors[a.getId()];a.set("dynaml",b.getValue())}}(a),c=a.get("dynaml"),d;try{d=JSON.parse(c||"{}"),d.name=d.name||a.get("name"),c=JSON.stringify(d)}catch(e){return}this.motifEditors[a.getId()]=Ext.create("App.usr.nodal.MotifEditorWindow",{width:700,height:500,closeAction:"hide",title:"Edit Motif: "+a.get("name"),data:c,buttons:["->",{text:"Save",iconCls:"tick",handler:b,scope:this}]})}else this.motifEditors[a.getId()].setValue(a.get("dynaml"));this.motifEditors[a.getId()].show()},getBoundObject:function(){return this.boundObjects.getAt(0)}});
Ext.define("App.usr.nodal.ws.objects.BridgePort",{extend:"Workspace.objects.Rectangle",mixins:{port:"App.usr.nodal.ws.objects.NodePort"},wtype:"App.usr.nodal.ws.objects.BridgePort",width:8,height:8,polarity:1,shape:"square",stroke:"purple",strokeWidth:2,name:"Bridge Port",role:"bridge",isResizable:!1,path:!1,constructor:function(){App.usr.nodal.ws.objects.BridgePort.superclass.constructor.apply(this,arguments),this.mixins.port.constructor.apply(this,arguments),this.expose("complementarity",!0,!0,!0,!1)},render:function(){this.arguments=[this.get("x")+this.getRadiusX(),this.get("y")+this.getRadiusY(),this.getRadiusX()],Workspace.objects.Rectangle.superclass.render.call(this),this.mixins.port.render.apply(this,arguments)},initialize:function(){this.complementarity&&this.set("complementarity",Workspace.Components.realize(this.complementarity)),this.callParent(arguments)}},function(){Workspace.reg("App.usr.nodal.ws.objects.BridgePort",App.usr.nodal.ws.objects.BridgePort),Workspace.regAlias("Workspace.objects.dna.BridgePort","App.usr.nodal.ws.objects.BridgePort")});
Ext.define("App.usr.nodal.ws.objects.OutputPort",{extend:"Workspace.objects.Ellipse",mixins:{port:"App.usr.nodal.ws.objects.NodePort"},wtype:"App.usr.nodal.ws.objects.OutputPort",shape:"ellipse",stroke:"#33ccff",strokeWidth:2,name:"Output Port",role:"output",width:8,height:8,polarity:1,rotation:0,isResizable:!1,preventRotate:!0,constructor:function(){this.callParent(arguments),this.mixins.port.constructor.apply(this,arguments),this.expose("complementarity",!0,!0,!0,!1)},initialize:function(){this.complementarity&&this.set("complementarity",Workspace.Components.realize(this.complementarity)),this.callParent(arguments)},getTransform:function(){return""},render:function(){this.callParent(arguments),this.mixins.port.render.apply(this,arguments),Workspace.objects.VectorObject.prototype.updateAttr.call(this,"rotation",0)},updateAttr:function(a,b){return a!="rotation"?this.callParent(arguments):this.callParent([a,0])},attributes:function(a){return a?a=_.filter(a,function(a){return a!="rotation"}):a=_.clone(App.usr.nodal.ws.objects.OutputPort.attrArray),this.callParent([a])}},function(){App.usr.nodal.ws.objects.OutputPort.attrArray=_.filter(Workspace.objects.VectorObject.attrArray,function(a){return a!="rotation"}),Workspace.reg("App.usr.nodal.ws.objects.OutputPort",App.usr.nodal.ws.objects.OutputPort),Workspace.regAlias("Workspace.objects.dna.OutputPort","App.usr.nodal.ws.objects.OutputPort")});
Ext.define("App.usr.nodal.ws.objects.InputPort",{extend:"Workspace.objects.Path",mixins:{port:"App.usr.nodal.ws.objects.NodePort"},constructor:function(){this.callParent(arguments),this.mixins.port.constructor.apply(this,arguments)},wtype:"App.usr.nodal.ws.objects.InputPort",role:"input",width:12,height:12,polarity:1,shape:"triangle2",dtheta:0,stroke:"orange",strokeWidth:2,name:"Input Port",path:!1,render:function(){this.arguments=[this.get("x")+this.getRadiusX(),this.get("y")+this.getRadiusY(),this.getRadiusX()],Workspace.objects.Path.superclass.render.call(this),this.path=this.vectorElement.attr("path"),this.updateDimensions(),this.mixins.port.render.apply(this,arguments)}},function(){Workspace.reg("App.usr.nodal.ws.objects.InputPort",App.usr.nodal.ws.objects.InputPort),Workspace.regAlias("Workspace.objects.dna.InputPort","App.usr.nodal.ws.objects.InputPort")});
Ext.define("App.usr.nodal.ws.objects.NodeLayout",{extend:"Workspace.idea.BaseLayout",doLayout:function(){if(!this.ignore){var a=this.getObjects().getCount(),b=this.idea.get("theta"),c=360/a,d=this.idea.getCenterX(),e=this.idea.getCenterY(),f=this.idea.getRadiusX(),g=this.idea.getRadiusY();this.ignore=!0,this.getObjects().each(function(a){a.is("rendered")&&(a.setPosition(parseInt(d+Math.cos(Raphael.rad(b))*f-a.getWidth())+this.paddingTop,parseInt(e+Math.sin(Raphael.rad(b))*g-a.getHeight())+this.paddingLeft),a.set("rotation",b+(a.dtheta?a.dtheta:0)),b=(b+c)%360)},this),this.ignore=!1}},childrenMovable:!1,paddingTop:5,paddingLeft:5},function(){Workspace.Layouts.register("App.usr.nodal.ws.objects.NodeLayout",App.usr.nodal.ws.objects.NodeLayout),Workspace.Layouts.register("Workspace.objects.dna.NodeLayout",App.usr.nodal.ws.objects.NodeLayout)});
Ext.define("App.usr.nodal.ws.objects.AbstractNode",{extend:"Workspace.objects.IdeaObject",wtype:"App.usr.nodal.ws.objects.AbstractNode",layout:"App.usr.nodal.ws.objects.NodeLayout",requires:["Workspace.objects.Ellipse","App.usr.nodal.ws.objects.NodeLayout","App.usr.nodal.ws.objects.InputPort","App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.BridgePort","App.usr.nodal.ws.objects.Motifs","Workspace.ConnectionLabel"],statics:{nextName:function(){var a=-1,b="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return function(){a++;var c="",d=a;do c+=b.charAt(d%26),d-=25;while(d>0);return c}}()},motif:"0",name:!1,shape:"ellipse",width:30,height:30,strokeWidth:2.5,autoFill:!1,fill:"#ffffff",stroke:"#000000",theta:180,destroyChildren:!0,isResizable:!1,polarity:0,portCounter:-1,constructor:function(){this.shimConfig={cls:"workspace-label-callout",offsets:[0,-5]},this.callParent(arguments),this.expose("polarity",!0,!0,!0,!1),this.expose("theta",!0,!0,!0,!1),this.workspace.buildManager&&this.workspace.buildManager.on("rebuild",this.onRebuild,this),this.name||(this.name=this.nextName()),this.on("change:theta",function(){this.layout.doLayout()},this)},render:function(){this.arguments=[this.get("x")+this.getRadiusX(),this.get("y")+this.getRadiusY(),this.getRadiusX(),this.getRadiusY()],this.callParent(arguments),this.toBack(),this.layout.doFirstLayout()},highlightError:function(){this.errorProxy||(this.errorProxy=this.getHighlightProxy(),this.errorProxy.stroke="#aa0000"),this.errorProxy.render(this.vectorElement),this.errorProxy.attachTo(this),this.errorProxy.show()},hideError:function(){this.errorProxy&&this.errorProxy.hide()},nextPortName:function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",b,c=_.filter(this.getChidren,function(a){return a.isWType(["App.usr.nodal.ws.objects.InputPort","App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.BridgePort"])});do this.portCounter++,b=a[this.portCounter];while(!!_.find(c,function(a){return a.get("name")==b}));return b},nextName:function(){},onRebuild:function(){},getRealtime:function(a){},getLibraryObject:function(){},destroy:function(){this.errorProxy&&(this.errorProxy.destroy(),delete this.errorProxy),this.callParent(arguments)}},function(){App.usr.nodal.ws.objects.AbstractNode.borrow(Workspace.objects.Ellipse,["getRadiusX","getRadiusY","getCenterX","getCenterY","updateX","updateY","updateWidth","updateHeight"]),Workspace.reg("App.usr.nodal.ws.objects.AbstractNode",App.usr.nodal.ws.objects.AbstractNode),Workspace.regAlias("Workspace.objects.dna.AbstractNode","App.usr.nodal.ws.objects.AbstractNode")});
Ext.define("App.usr.nodal.ws.objects.Node",{extend:"App.usr.nodal.ws.objects.AbstractNode",wtype:"App.usr.nodal.ws.objects.Node",motif:"0",name:!1,polarity:0,iconCls:"node",render:function(){this.callParent(arguments),this.addShim(new Workspace.ConnectionLabel({cls:"workspace-label-plain workspace-label-small",offsets:[0,2],property:"motif",editable:!1}))},constructor:function(){this.callParent(arguments),this.expose("motif",!0,!0,!0,!1),this.expose("computedPolarity",function(){return this.getRealtime("polarity")},!1,!1,!1),this.expose("structure",function(){var a=this.getLibraryObject(),b=a?a.getStructure():null;try{return b?b.toDotParen():""}catch(c){return""}},!1,!1,!1),this.expose("annotatedStructure",function(){var a=this.getLibraryObject();return a?{structure:a.getSegmentwiseStructure().toDotParen(),strands:a.getStrands(),sequences:a.getSequences()}:null}),this.expose("strands",function(){return this.getRealtime("strands")},!1,!1,!1)},isReal:function(){var a=this.getParent();return a?a.isWType("App.usr.nodal.ws.objects.Motif"):!1},nextName:function(){return this.workspace.buildManager.getNextNodeName()},onRebuild:function(){this.change("computedPolarity",this.get("computedPolarity")),this.change("structure",this.get("structure")),this.change("strands",this.get("strands"))},getRealtime:function(a){if(this.workspace.buildManager)return this.workspace.buildManager.getRealtime("node",this.get("name"),a)},getLibraryObject:function(){if(this.workspace.buildManager)return this.workspace.buildManager.getRealtime("node",this.get("name"),"this")}},function(){Workspace.reg("App.usr.nodal.ws.objects.Node",App.usr.nodal.ws.objects.Node),Workspace.regAlias("Workspace.objects.dna.Node","App.usr.nodal.ws.objects.Node")});
Ext.define("App.usr.nodal.ws.tools.NodeTool",{extend:"Workspace.tools.BaseTool",defaultMotif:"0",statics:{},requires:["App.usr.nodal.ws.objects.Node","App.usr.nodal.ws.tools.PortTool"],click:function(a,b){var c=this.getAdjustedXY(a);this.buildMotif(this.defaultMotif,c.x,c.y)},buildMotif:function(a,b,c){return this.workspace.buildManager.buildMotif(a,b,c)},buildPort:function(a){return this.workspace.buildManager.buildPort(a)}},function(){Workspace.Tools.register("node",App.usr.nodal.ws.tools.NodeTool)});
Ext.define("App.usr.nodal.ws.objects.MotifLayout",{extend:"Workspace.idea.BaseLayout",doLayout:function(){if(!this.ignore){var a=this.getObjects().getRange(),b=_.groupBy(a,function(a){return a.hasWType(["App.usr.nodal.ws.objects.InputPort","App.usr.nodal.ws.objects.OutputPort","App.usr.nodal.ws.objects.BridgePort"])?"ports":"others"}),c=b.ports||[],d=b.others||[];if(d.length>0){var e=!1;applyToChildren=!1,box=Workspace.Utils.getBox(d),box=Workspace.Utils.padBox(box,this.idea.padding),e&&(box=Workspace.Utils.boxUnion(box,this.idea.getBox())),this.ignore=!0,this.idea.setBox(box,applyToChildren),this.ignore=!1}var f=c.length;if(f>0){var g=this.idea.get("theta"),h=360/f,i=this.idea.getCenterX(),j=this.idea.getCenterY(),k=this.idea.getRadiusX(),l=this.idea.getRadiusY();this.ignore=!0,_.each(c,function(a){a.is("rendered")&&(a.setPosition(parseInt(i+Math.cos(Raphael.rad(g))*k-a.getWidth())+this.paddingTop,parseInt(j+Math.sin(Raphael.rad(g))*l-a.getHeight())+this.paddingLeft),a.set("rotation",g+(a.dtheta?a.dtheta:0)),g=(g+h)%360)},this),this.ignore=!1}}},childrenMovable:!1,paddingTop:5,paddingLeft:5},function(){Workspace.Layouts.register("App.usr.nodal.ws.objects.MotifLayout",App.usr.nodal.ws.objects.MotifLayout),Workspace.Layouts.register("Workspace.objects.dna.MotifLayout",App.usr.nodal.ws.objects.MotifLayout)});
Ext.define("App.usr.nodal.ws.objects.Motif",{extend:"App.usr.nodal.ws.objects.AbstractNode",wtype:"App.usr.nodal.ws.objects.Motif",layout:"App.usr.nodal.ws.objects.MotifLayout",name:!1,proxifyOnMove:!0,polarity:0,stroke:"#888",strokeDasharray:"5,5",requires:["App.usr.nodal.ws.objects.MotifLayout"],constructor:function(){this.callParent(arguments),this.expose("nodes",function(){return _.filter(this.getChildren(),function(a){return a.hasWType("App.usr.nodal.ws.objects.Node")})},!1,!1,!1),this.workspace.buildManager&&this.workspace.buildManager.on("rebuild",this.onRebuild,this),this.expose("dynaml",!0,!0,!0,!1),this.on("change:dynaml",this.syncDynaml,this)},render:function(){this.callParent(arguments)},syncDynaml:function(){var a=this.get("dynaml"),b;if(a){try{_.isString(a)&&(a=JSON.parse(a))}catch(c){return console.log(c)}a.library=App.dynamic.Library.dummy();var d=new App.dynamic.Motif(a),e=_.groupBy(d.getDomains(),"role"),f=_.groupBy(this.getChildren(),"wtype"),g={input:_.groupBy(f["App.usr.nodal.ws.objects.InputPort"]||[],function(a){return a.get("name")}),output:_.groupBy(f["App.usr.nodal.ws.objects.OutputPort"]||[],function(a){return a.get("name")}),bridge:_.groupBy(f["App.usr.nodal.ws.objects.BridgePort"]||[],function(a){return a.get("name")})},h=[],i=[];_.each(e,function(a,b){g[b]&&(_.each(a,function(a,c){g[b][c]?delete g[b][a.getName()]:i.push(a)}),h=_.chain(g[b]).values().flatten().concat(h).value())}),this.workspace.deleteObjects(h),this.suspendLayout=!0,_.each(i,function(a){a=this.makePort(a),!a||this.addChild(a)},this),this.suspendLayout=!1,this.doLayout()}},makePort:function(a){var b=_.clone(a),c={};if(_.isObject(b)&&App.usr.nodal.ws.objects.PortClasses[b.role])return c.name=b.name,c.wtype=App.usr.nodal.ws.objects.PortClasses[b.role],c.stroke=App.dynamic.Compiler.getColor(b),c.segments=b.segments,c.role=b.role,this.workspace.buildManager.buildPort(c)},nextName:function(){return this.workspace.buildManager.getNextMotifName()},onRebuild:function(){},getRealtime:function(a){if(this.workspace.buildManager)return this.workspace.buildManager.getRealtime("motif",this.get("name"),a)},getLibraryObject:function(){if(this.workspace.buildManager)return this.workspace.buildManager.getRealtime("motif",this.get("name"),"this")}},function(){Workspace.reg("App.usr.nodal.ws.objects.Motif",App.usr.nodal.ws.objects.Motif),Workspace.regAlias("Workspace.objects.dna.Motif","App.usr.nodal.ws.objects.Motif")});
Ext.define("App.usr.nodal.ws.tools.MotifTool",{targetWType:"App.usr.nodal.ws.objects.Motif",constructor:function(a,b){this.callParent(arguments)},requires:["App.usr.nodal.ws.objects.Motif"],extend:"Workspace.tools.IdeaTool",alternateAction:function(a,b,c){var d=this.workspace.createObject({wtype:this.targetWType,children:[],x:c.x,y:c.y});d.toBack(),d.select(),this.workspace.changeTool("pointer")},buildIdeaFromSelection:function(){function e(a,b){return a?!b:b}var a=_.groupBy(this.workspace.getSelection(),"wtype"),b=a["App.usr.nodal.ws.objects.Node"],c=a["App.usr.nodal.ws.objects.Complement"],d=_.reduce(b,function(a,b){return a[b.getId()]=b,a},{});c=_.filter(c,function(a){if(a.hasWType("App.usr.nodal.ws.objects.Complement")){var b=a.get("leftObject"),c=a.get("rightObject");return b&&c&&!!d[b.getParent().getId()]&&!!d[c.getParent().getId()]}return!1});var f=this.workspace.filterObjectsBy(function(a){if(a.hasWType("App.usr.nodal.ws.objects.Complement")){var b=a.get("leftObject"),c=a.get("rightObject");return b&&c&&e(!!d[b.getParent().getId()],!!d[c.getParent().getId()])}return!1});this.workspace.deleteObjects(f),children=b.concat(c);if(children.length>0){var g=this.workspace.createObject({wtype:this.targetWType,children:children});g.toBack()}return g}},function(){Workspace.Tools.register("motif",App.usr.nodal.ws.tools.MotifTool)});
Ext.define("Workspace.tools.ChemTool",{requires:["Workspace.tools.SelectorBand","Workspace.objects.ChemStructureObject","Workspace.tools.ChemDrawTool"],constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:{}}),this.callParent(arguments),Ext.apply(this.parameters,{fill:"#fff",stroke:"#000"}),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},extend:"Workspace.tools.BaseTool",minWidth:75,maxWidth:!1,minHeight:30,maxHeight:!1,dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.dragging=!0,this.proto&&(this.proto.remove(),this.proto=!1),a.stopEvent()},mouseup:function(a,b){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2),e=this.workspace.createObject({wtype:"Workspace.objects.ChemStructureObject",x:d.x,y:d.y,width:Workspace.Utils.bounds(d.width,this.minWidth,this.maxWidth),height:Workspace.Utils.bounds(d.height,this.minHeight,this.maxHeight)});this.proto.remove(),this.proto=!1,this.workspace.edit(e),this.workspace.setActiveTool("pointer")}a.stopEvent()},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2);this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this.anchor=d.anchor,delete d.anchor,this.proto.attr(d),a.stopEvent()}},createProto:function(a){var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.proto=this.workspace.paper.rect(this.x1,this.y1,0,0),this.proto.attr(this.parameters)},deactivate:function(){this.proto&&(this.proto.remove(),this.proto=!1)}},function(){Workspace.Tools.register("chem",Workspace.tools.ChemTool)});
Ext.define("Workspace.tools.VectorTool",{constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{}),this.callParent(arguments),this.dragging=!1,this.handles=Ext.create("Ext.util.MixedCollection")},extend:"Workspace.tools.BaseTool",requires:["Workspace.tools.VectorHandle"],attach:function(a){return a.editable&&a.element?(a.unhighlight&&a.unhighlight(),this.addHandles(a),this.item=a,!0):!1},detach:function(){this.item&&(this.removeHandles(this.item),this.item=!1)},createHandle:function(a,b,c){var d={item:a,index:b,forceFront:!0};return a.constrain&&(d.constrain=_.bind(a.constrain,a)),Ext.create("Workspace.tools.VectorHandle",this.workspace,d)},addHandles:function(a){if(!this.handles.containsKey(a.getId())){var b=[],c=a.get("points");c&&(_.each(c,function(d,e){b.push(this.createHandle(a,e,c))},this),this.handles.add(a.getId(),b))}},removeHandles:function(a){a?(!Ext.isString(a)&&Ext.isFunction(a.getId)&&(a=a.getId()),Ext.isString(a)&&this.handles.containsKey(a)&&(handles=this.handles.get(a),_.each(handles,function(a){a&&a.destroy()}),this.handles.removeAtKey(a))):(this.handles.each(function(a){for(handle in a)Ext.isFunction(a[handle].destroy)&&a[handle].destroy()}),this.handles.clear())},click:function(a,b){},dblclick:function(a,b){(!b||b&&b.getId&&b.getId()!=this.item.getId())&&this.workspace.endEdit()},mousedown:function(a,b){},mouseup:function(a,b){},mousemove:function(a,b){},deactivate:function(){this.detach(),this.callParent(arguments)}},function(){Workspace.Tools.register("vector",Workspace.tools.VectorTool)});
Ext.define("Workspace.tools.PolyLineTool",{targetWType:"Workspace.objects.Path",constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:App.Stylesheet.Draw}),Workspace.tools.PolyLineTool.superclass.constructor.call(this,a,b),this.drawing=!1,this.dragging=!1,this.currentPath=!1,this.currentPoints=!1,this.currentShape=!1},extend:"Workspace.tools.BaseTool",requires:["Workspace.tools.VectorTool","Workspace.objects.Path","Workspace.objects.SegmentedPath"],startDrawing:function(a){this.drawing=!0,this.x1=parseInt(a.x),this.y1=parseInt(a.y),this.lastPos=a,this.currentPoints=[[this.x1,this.y1]],this.currentPath=[["M",this.x1,this.y1]],this.currentPath.push(["L",this.x1,this.y1]),this.points=[[this.x1,this.y1]],this.currentShape=this.workspace.paper.path(this.currentPath),this.currentShape.attr(this.parameters)},addPoint:function(a){this.x=parseInt(a.x),this.y=parseInt(a.y),this.lastPos={x:this.x,y:this.y},this.currentPoints.push([this.x,this.y]),this.currentPath.push(["L",this.x,this.y]),this.points.push([this.x,this.y]),this.currentShape.attr({path:this.currentPath})},mousedown:function(a,b){this.dragging=!0;var c=this.snapXY(this.getAdjustedXY(a),this.lastPos);this.mousedownPos=c,a.stopEvent()},mouseup:function(a,b){this.dragging=!1;var c=this.snapXY(this.getAdjustedXY(a),this.lastPos);this.mouseupPos=c,this.drawing?this.addPoint(this.mouseupPos,this.mousedownPos):this.startDrawing(c),a.stopEvent(),this.mousedownPos=!1,this.mouseupPos=!1},dblclick:function(a,b){this.currentPoints.pop(),this.currentPath.pop(),this.points.pop();var c=this.workspace.createObject(this.buildObject());this.stopDrawing(),this.workspace.setSelection([c]),a.stopEvent()},stopDrawing:function(){this.drawing=!1,this.dragging=!1,this.currentShape&&this.currentShape.remove(),this.currentPath=!1,this.currentShape=!1,this.currentPoints=!1,this.lastPos=null,this.points=!1},buildObject:function(){return{wtype:this.targetWType,points:this.currentPoints,fillOpacity:.1}},mousemove:function(a,b){if(this.drawing){var c=this.snapXY(this.getAdjustedXY(a),this.lastPos);this.updateDrawing(c,this.mousedownPos)}a.stopEvent()},updateDrawing:function(a,b){this.currentPath.pop(),this.currentPath.push(["L",parseInt(a.x),parseInt(a.y)]),this.currentShape.attr({path:this.currentPath})},deactivate:function(){this.stopDrawing(),this.callParent(arguments)},snapXY:function(a,b){return a}},function(){Workspace.Tools.register("polyline",Workspace.tools.PolyLineTool)});
Ext.define("Workspace.tools.PolygonTool",{constructor:function(a,b){this.workspace=a,Workspace.tools.PolygonTool.superclass.constructor.call(this,a,b),Ext.apply(this.protoProps,App.Stylesheet.Draw)},extend:"Workspace.tools.PolyLineTool",dblclick:function(a,b){this.drawing=!1,this.dragging=!1,this.currentPath.pop(),this.currentPath.pop(),this.currentPath.push(["L",this.x1,this.y1]);var c=this.workspace.createObject(Workspace.objects.Path,{path:this.currentPath,fillOpacity:1});this.currentShape.remove(),this.currentPath=!1,this.currentShape=!1,this.workspace.setSelection([c]),a.stopEvent()}},function(){Workspace.Tools.register("polygon",Workspace.tools.PolygonTool)});
Ext.define("Workspace.objects.CodeObject",{requires:["Workspace.tools.CodeMirrorTool"],constructor:function(a,b){Workspace.objects.CodeObject.superclass.constructor.call(this,a,b),Ext.apply(this,{lineNumbers:!1,lineWrapping:!1}),Ext.apply(this.elementSpec,{tag:"div",cls:"textbox",children:[{tag:"textarea"}]}),this.expose("text",!0,!0,!0,!1),this.expose("mode",!0,!0,!0,!1),this.expose("theme",!0,!0,!0,!1),this.expose("lineNumbers",!0,!0,!0,!1),this.expose("lineWrapping",!0,!0,!0,!1),this.on("change:text",this.setText,this),this.on("change:mode",this.updateMode,this),this.on("change:theme",this.updateTheme,this),this.on("change:lineNumbers",_.bind(this.updateCodeMirrorOption,this,"lineNumbers")),this.on("change:lineWrapping",_.bind(this.updateCodeMirrorOption,this,"lineWrapping"))},enableLineNumbers:!1,enableLineWrapping:!1,updateCodeMirrorOption:function(a,b){this.codemirror.setOption(a,b)},updateMode:function(a){this.updateCodeMirrorOption("mode",a)},updateTheme:function(a){this.updateCodeMirrorOption("theme",a)},theme:"default",mode:"text",extend:"Workspace.objects.ElementObject",autoMaxWidth:300,wtype:"Workspace.objects.CodeObject",isEditable:!0,isSelectable:!0,isResizable:!0,text:"",name:"New Code box",iconCls:"text-icon",editor:"codemirror",render:function(){this.elementSpec.html=this.get("text"),this.callParent(arguments);var a=this.getEl().down("textarea").dom;if(a){var b=this;this.codemirror=CodeMirror.fromTextArea(a,{lineNumbers:b.get("lineNumbers"),lineWrapping:b.get("lineWrapping"),theme:b.get("theme"),mode:b.get("mode"),readOnly:"nocursor",value:b.get("text"),onCursorActivity:Ext.bind(this.onCursorActivity,this)},this)}},onCursorActivity:function(){},getText:function(){return this.get("text")},setText:function(a){this.text=a,this.codemirror.setValue(a)},sizeToFit:function(){var a=Ext.util.TextMetrics.createInstance(this.getEl());text=this.get("text"),width=a.getWidth(text),width>this.autoMaxWidth?(this.set("width",this.autoMaxWidth),a.setFixedWidth(this.autoMaxWidth)):(this.set("width",width+20),a.setFixedWidth(width+20)),this.set("height",a.getHeight(text)+20)}},function(){Workspace.reg("Workspace.objects.CodeObject",Workspace.objects.CodeObject)});
Ext.define("Workspace.tools.CodeTool",{requires:["Workspace.tools.SelectorBand","Workspace.objects.CodeObject","Workspace.tools.CodeMirrorTool"],constructor:function(a,b){this.workspace=a,Ext.apply(this,b,{parameters:{}}),this.callParent(arguments),Ext.apply(this.parameters,{fill:"#fff",stroke:"#000"}),this.dragging=!1,this.proto=!1,this.x1=0,this.y1=0},extend:"Workspace.tools.BaseTool",minWidth:75,maxWidth:!1,minHeight:30,maxHeight:!1,dblclick:function(a,b){a.stopEvent()},mousedown:function(a,b){this.dragging=!0,this.proto&&(this.proto.remove(),this.proto=!1),a.stopEvent()},mouseup:function(a,b){this.dragging=!1;if(this.proto){var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2),e=this.workspace.createObject({wtype:"Workspace.objects.CodeObject",x:d.x,y:d.y,width:Workspace.Utils.bounds(d.width,this.minWidth,this.maxWidth),height:Workspace.Utils.bounds(d.height,this.minHeight,this.maxHeight)});this.proto.remove(),this.proto=!1,this.workspace.edit(e),this.workspace.setActiveTool("pointer")}a.stopEvent()},mousemove:function(a,b){if(this.dragging){this.proto||this.createProto(a);var c=this.getAdjustedXY(a);this.x2=c.x,this.y2=c.y;var d=Workspace.tools.SelectorBand.calculateBandBox(this.x1,this.y1,this.x2,this.y2);this.x=d.x,this.y=d.y,this.width=d.width,this.height=d.height,this.anchor=d.anchor,delete d.anchor,this.proto.attr(d),a.stopEvent()}},createProto:function(a){var b=this.getAdjustedXY(a);this.x1=b.x,this.y1=b.y,this.proto=this.workspace.paper.rect(this.x1,this.y1,0,0),this.proto.attr(this.parameters)},deactivate:function(){this.proto&&(this.proto.remove(),this.proto=!1)}},function(){Workspace.Tools.register("code",Workspace.tools.CodeTool)});
Ext.define("App.usr.canvas.InsertTab",{extend:"App.usr.canvas.ToolsTab",requires:["Workspace.tools.LineTool","Workspace.tools.RectTool","Workspace.tools.EllipseTool","Workspace.tools.PolyLineTool","Workspace.tools.PolygonTool","Workspace.tools.TextTool","Workspace.tools.MathTool","Workspace.tools.CodeTool","Workspace.tools.ChemTool"],generateConfig:function(){return{items:[{xtype:"buttongroup",title:"Insert",columns:5,defaults:{cellCls:"table-cell-padded"},items:[{iconCls:"line",enableToggle:!0,toggleGroup:"toolbox",toolName:"line",tooltip:{title:"Line",text:"Draw straight lines. Click and drag to draw a line; release to finish."}},{iconCls:"rect",enableToggle:!0,toggleGroup:"toolbox",toolName:"rect",tooltip:{title:"Rectangle",text:"Draw rectangles. Click and drag a box to draw; release to finish."}},{iconCls:"ellipse",toggleGroup:"toolbox",enableToggle:!0,toolName:"ellipse",tooltip:{title:"Ellipse",text:"Draw ellipses. Click and drag to draw; release to finish."}},{iconCls:"polygon",toggleGroup:"toolbox",enableToggle:!0,tooltip:{title:"Polygon",text:"Draw closed polygons. Click once to start drawing; each click adds a point. Double-click to finish"},toolName:"polygon"},{iconCls:"path",toggleGroup:"toolbox",enableToggle:!0,toolName:"polyline",tooltip:{title:"Polylines",text:"Draw open polygons. Click once to start drawing; each click adds a point. Double-click to finish"}},{iconCls:"text-icon",enableToggle:!0,toggleGroup:"toolbox",toolName:"textbox",tooltip:{title:"Text Tool",text:"Enter and edit text. Click or click and drag to insert a textbox. Click a textbox to edit text."}},{iconCls:"math-icon",toggleGroup:"toolbox",enableToggle:!0,toolName:"math",tooltip:{title:"Equations",text:"Insert mathematical equations. Click and drag to draw an equation box."}},{iconCls:"code-icon",toggleGroup:"toolbox",enableToggle:!0,toolName:"code",tooltip:{title:"Code",text:"Insert syntax-highlighted source code. Click and drag to draw an source code textbox."}},{iconCls:"chem-icon",toggleGroup:"toolbox",enableToggle:!0,toolName:"chem",tooltip:{title:"Organic Structures",text:"Insert a box to draw organic structures. Click and drag to draw a structure box."}}]}]}}});
Ext.define("App.usr.canvas.Ribbon",{extend:"Ext.tab.Panel",alias:"widget.ribbon",requires:["App.usr.canvas.ToolsTab","App.usr.canvas.InsertTab","App.usr.canvas.FillStrokeTab","App.usr.canvas.GeometryTab","App.usr.canvas.MetaTab"],cls:"ui-ribbonbar",activeTab:0,plain:!0,margin:"5 0 0 0",autoHeight:!0,border:!1,bodyBorder:"0 1 1 1",bodyCls:"noborder-top",autoHeight:!0,initComponent:function(){Ext.applyIf(this,{activeTab:0,defaults:{border:!1,bodyBorder:!1,bodyCls:"tab-panel-body-toolbar"},tabBar:{border:!1,bodyBorder:!1}}),this.items||(this.items=[new App.usr.canvas.ToolsTab({title:"Tools",ref:"toolsTab"}),new App.usr.canvas.InsertTab({title:"Insert",ref:"insertTab"}),new App.usr.canvas.FillStrokeTab({title:"Fill and Stroke",ref:"fillStroke"}),new App.usr.canvas.GeometryTab({title:"Geometry",ref:"geometry"}),new App.usr.canvas.MetaTab({title:"Meta",ref:"metaTab"})]),Ext.each(this.items,function(a){Ext.applyIf(a,{border:!1,bodyBorder:!1})}),this.selection=[],App.usr.canvas.Ribbon.superclass.initComponent.apply(this,arguments),_.each(["toolsTab","insertTab","fillStroke","geometry","metaTab"],function(a){this[a]=this.down("*[ref="+a+"]")},this),this.items.each(function(a){a.ribbon=this,this.mon(a,"action",this.doAction,this),a.getActiveTool&&(this.mon(a,"toolchange",this.setActiveTool,this),this.mon(a,"save",this.saveWorkspace,this)),a.init&&a.init()},this)},attachTo:function(a){this.workspace=a,this.mon(this.workspace,"select",this.onSelectionChange,this,{buffer:500}),this.mon(this.workspace,"unselect",this.onSelectionChange,this,{buffer:500}),this.mon(this.workspace,"toolchange",this.onToolChange,this,{buffer:500})},setActiveTool:function(a){this.ignoreToolChange=!0,this.workspace.setActiveTool(a),this.ignoreToolChange=!1},onToolChange:function(a,b){if(!this.ignoreToolChange){var c=[];this.items.each(function(d){d.onToolChange&&d.onToolChange(a,b)&&c.push(d)}),c.length==1?this.setActiveTab(c[0]):c.length>1&&this.setActiveTab(c[0])}},doAction:function(a){var b=a.getUndo();this.workspace.doAction(a)},onSelectionChange:function(){var a=_.difference(this.workspace.getSelection(),this.selection),b=_.difference(this.selection,this.workspace.getSelection());this.bind(a),this.unbind(b),this.selection=this.workspace.getSelection()},bind:function(a){_.isArray(a)||(a=[a]),this.items.each(function(b){b.bind&&Ext.isFunction(b.bind)&&_.each(a,function(a){b.bind(a)})})},unbind:function(a){_.isArray(a)||(a=[a]),this.items.each(function(b){b.unbind&&Ext.isFunction(b.unbind)&&_.each(a,function(a){b.unbind(a)})})},saveWorkspace:function(){this.canvas.saveWorkspace()}});
Ext.define("App.usr.canvas.Canvas",{extend:"Ext.panel.Panel",layout:"border",alias:"widget.canvas",editorType:"Whiteboard",iconCls:"whiteboard",requires:["App.usr.canvas.Ribbon","App.usr.canvas.ObjectTree","App.usr.nodal.MotifPalette","App.usr.canvas.ObjectProperties"],border:!1,mixins:{app:"App.ui.Application"},constructor:function(a){this.callParent(arguments),this.mixins.app.constructor.apply(this,arguments)},initComponent:function(a){Ext.applyIf(this,{workspaceData:{},palettes:[],inspectors:[],bbarItems:[]}),Ext.apply(this,{items:[{xtype:"ribbon",region:"north",height:100,ref:"ribbon",collapseMode:"mini",canvas:this,items:this.ribbonItems||null,margins:"0 0 5 0"},{region:"center",xtype:"panel",ref:"bodyPanel",autoScroll:!0,bbar:{items:this.bbarItems.concat(["->","Zoom:&nbsp;",{ref:"zoomField",xtype:"slider",value:1,minValue:.2,maxValue:4,decimalPrecision:2,increment:.1,animate:!0,plugins:Ext.create("Ext.slider.Tip",{getText:function(a){return Ext.String.format("{0}%",a.value*100)}}),width:100,tooltip:{title:"Zoom",text:"Workspace zoom"}}])}},{region:"west",split:!0,collapseMode:"mini",collapsible:!0,preventHeader:!0,border:!1,width:200,layout:"border",items:[Ext.create("App.usr.canvas.ObjectTree",{region:"center",ref:"objectTree",border:!0,frame:!1,split:!0,collapsible:!0,collapseMode:"header",titleCollapse:!0,title:"Objects",root:{text:"Workspace",id:"workspace",nodeType:"node"}}),{xtype:"tabpanel",preventHeader:!0,plain:!0,title:"Palettes",ref:"palettes",region:"south",height:400,split:!0,collapsible:!0,titleCollapse:!0,border:!0,frame:!1,items:this.palettes,collapsed:this.palettes.length==0}]},Ext.create("App.usr.canvas.ObjectProperties",{ref:"objectProperties",width:250,split:!0,collapseMode:"mini",collapsible:!0,titleCollapse:!0,border:!0,frame:!1,region:"east",items:this.inspectors})]}),this.callParent(arguments),_.each(["ribbon","bodyPanel","zoomField","objectTree","palatte","objectProperties"],function(a){this[a]=this.down("*[ref="+a+"]")},this),this.bodyPanel.on("render",function(){this.loadWorkspace(),this.zoomField.on("change",this.zoomWorkspace,this)},this)},loadWorkspace:function(){this.loadFile()},autoHideLoadingMask:!1,createBlankWorkspace:function(){return{}},onLoad:function(){this.workspaceData=Ext.isEmpty(this.data)?this.createBlankWorkspace():Ext.decode(this.data),this.workspaceData.path=this.getPath(),this.workspace=new Workspace(this.bodyPanel.body,this.workspaceData),this.workspace.on("afterload",function(){this.setupWorkspace(),this.loadingMask.hide(),this.bodyPanel.on("bodyresize",function(a,b,c){this.workspace.bodyResize(a,b,c)},this),this.bodyPanel.on("resize",function(a,b,c){this.workspace.bodyResize(a,this.bodyPanel.body.getWidth(),this.bodyPanel.body.getHeight())},this),App.defaultWorkspace=this.workspace,this.ribbon.attachTo(this.workspace),this.objectProperties.attachTo(this.workspace),this.objectTree.attachTo(this.workspace),this.workspace.bodyResize(this.bodyPanel,this.bodyPanel.body.getWidth()-10,this.bodyPanel.body.getHeight()-10)},this,{single:!0})},setupWorkspace:function(){},saveWorkspace:function(){this.saveFile()},getSaveData:function(){return this.workspace.serialize()},zoomWorkspace:function(a,b){this.workspace.zoomTo(b)}});
Ext.define("App.usr.nodal.Canvas",{extend:"App.usr.canvas.Canvas",editorType:"Nodal",title:"Nodal",iconCls:"nodal",requires:["App.usr.nodal.HomeTab","App.usr.nodal.BuildTab","App.usr.nodal.CommandTab","App.usr.canvas.FillStrokeTab","App.usr.nodal.ws.objects.BuildManager","App.usr.nodal.ws.objects.Node","App.usr.nodal.ws.objects.Complement","App.usr.nodal.ws.tools.NodeTool","App.usr.nodal.ws.tools.PortTool","App.usr.nodal.ws.tools.ComplementarityTool","App.usr.nodal.ws.tools.MotifTool","App.usr.nodal.ws.tools.ExposureTool","App.usr.nodal.NodeInspector","App.usr.nodal.PortInspector","App.usr.nodal.MotifInspector","App.usr.nodal.MotifPalette","App.usr.nodal.LibraryWindow"],border:!1,mixins:{refHelper:"App.ui.RefHelper"},constructor:function(){Ext.applyIf(this,{ribbonItems:[{xtype:"nodal-hometab",title:"Home",border:!1},{xtype:"nodal-buildtab",title:"Build",border:!1},{xtype:"fillstroketab",title:"Style",border:!1},{xtype:"nodal-commandtab",title:"Command",border:!1}]}),this.customMotifStore=Ext.create("App.usr.nodal.ws.objects.MotifStore"),this.motifStore=Ext.create("App.usr.nodal.ws.objects.MotifStore"),this.palettes=[Ext.create("App.usr.nodal.MotifPalette",{ref:"palatte",title:"Standard",store:this.motifStore}),Ext.create("App.usr.nodal.MotifPalette",{ref:"customPalatte",title:"Custom",store:this.customMotifStore})],this.inspectors=[Ext.create("App.usr.nodal.NodeInspector",{ref:"nodeInspector"}),Ext.create("App.usr.nodal.PortInspector",{ref:"portInspector"}),Ext.create("App.usr.nodal.MotifInspector",{ref:"motifInspector"})],this.bbarItems=[{iconCls:"",ref:"buildStatusButton",text:"Waiting for input...",iconCls:"progress",menu:[{text:"Check for errors",handler:this.forceRebuild,scope:this},{text:"Show full results",handler:this.showLibraryTreeWindow,scope:this}]}],this.callParent(arguments),this.mixins.refHelper.init.apply(this)},createBlankWorkspace:function(){return{version:App.dynamic.Compiler.standardMotifsCurrentVersion}},setupWorkspace:function(){this.workspace.buildManager||(this.workspace.buildManager=this.workspace.createObject({wtype:"App.usr.nodal.ws.objects.BuildManager"})),this.workspace.buildManager.customMotifStore=this.customMotifStore,this.workspace.version!=App.dynamic.Compiler.standardMotifsCurrentVersion?("version"in this.workspace||(this.workspace.version=0),this.motifStore.loadFromHash(App.usr.nodal.ws.objects.MotifLibraries[this.workspace.version])):this.motifStore.loadFromHash(App.usr.nodal.ws.objects.Motifs),this.workspace.expose("version",!0,!0,!0),this.workspace.buildManager.on("beforerebuild",this.beforeRebuild,this),this.workspace.buildManager.on("rebuild",this.onRebuild,this),this.workspace.buildManager.on("error",this.showError,this)},forceRebuild:function(){this.workspace.buildManager.needsRebuild()},showLibraryTreeWindow:function(){this.workspace.buildManager.lastLibrary&&(this.libraryTreeWindow||(this.libraryTreeWindow=Ext.create("App.usr.nodal.LibraryWindow",{lastLibrary:this.workspace.buildManager.lastLibrary,sourceDynaml:this.workspace.buildManager.lastDynaml})),this.libraryTreeWindow.show())},makeBuildStatusTip:function(){this.buildStatusTip||(this.buildStatusTip=Ext.create("Ext.tip.ToolTip",{target:this.buildStatusButton.getEl(),renderTo:Ext.getBody(),anchor:"top",cls:"build-tip",dismissDelay:0}))},showBuildStatus:function(){this.makeBuildStatusTip(),this.buildStatusTip.show()},updateBuildStatus:function(a,b,c){this.makeBuildStatusTip(),this.buildStatusButton.state=a;var d,e;switch(a){case"done":e="build-done-tip",d="tick";break;case"building":e="build-building-tip",d="progress";break;case"error":e="build-error-tip",d="error"}this.buildStatusButton.setIconCls(d),this.buildStatusButton.setText(b),this.buildStatusTip.removeCls("build-done-tip").removeCls("build-building-tip").removeCls("build-error-tip").addCls(e),this.buildStatusTip.update(c)},beforeRebuild:function(){this.updateBuildStatus("building","Building system","Building system to check for errors...")},onRebuild:function(){this.updateBuildStatus("done","Build completed","Build completed successfully."),this.libraryTreeWindow&&this.libraryTreeWindow.setLibrary(this.workspace.buildManager.lastLibrary,this.workspace.buildManager.lastDynaml)},showError:function(a,b){this.updateBuildStatus("error","Errors",a)}},function(){Workspace.DDManager.addHandler("ext/motif",function(a,b){var c=this.getAdjustedXY(b),d;d=this.workspace.activeTool,this.workspace.setActiveTool("node"),this.workspace.getActiveTool().buildMotif(a.draggedRecord.get("spec"),c.x,c.y),this.workspace.setActiveTool(d)})});
var console,cp;Ext.ns("App.ui"),Ext.Loader.setPath("App","client"),Ext.require(["App.ui.Launcher","App.ui.Application","App.ui.FilesTree","App.ui.TabPanel","App.ui.NupackMenu","App.ui.mfold.QuikFoldWindow","App.ui.vienna.RNAfoldWindow","App.ui.StrandPreviewWindow","App.ui.SequenceThreader","App.ui.ButtonPicker","App.ui.Help","App.ui.console.ScriptsPanel","App.ui.console.LogPanel","App.ui.Attribution","App.ui.CitationBar"]),App.ui.buildInterface=function(){Ext.QuickTips.init(),Ext.get("loading").remove(),Ext.get("loading_mask").fadeOut({remove:!0});var a=Ext.create("App.ui.console.ScriptsPanel"),b=Ext.create("App.ui.console.LogPanel");cp=b,App.ui.Launcher.console=Ext.create("Ext.panel.Panel",{ref:"console",iconCls:"terminal",region:"south",height:200,split:!0,collapsible:!0,collapsed:!0,collapseMode:"mini",titleCollapse:!0,title:"Console",layout:"border",items:[a,b],scriptPanel:a,logView:b,executeInContext:function(){this.scriptPanel.executeInContext.apply(this.scriptPanel,arguments)}});var c=Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:2});App.DocumentStore=Ext.create("App.DocumentTreeStore",{root:{text:App.User.home,id:App.User.home,expanded:!0,iconCls:"folder",node:App.User.home}});var d=Ext.create("App.ui.FilesTree",{region:"west",split:!0,width:300,collapsible:!0,autoScroll:!0}),e=Ext.create("App.ui.TabPanel",{region:"center",border:!1,bodyBorder:!1}),f=Ext.create("App.ui.Attribution",{renderTo:Ext.getBody()}),g=new Ext.Viewport({layout:"fit",border:!1,items:[{layout:"border",border:!1,bodyBorder:!1,tbar:{cls:"toolbar-background",items:[{text:App.getFullTitleFormatted()+(App.isPreRelease?'&nbsp;|&nbsp;<strong class="pre-release">Pre-release. Do not distribute</strong>':""),handler:f.show,scope:f},"-",{text:"New",iconCls:"plus",menu:Ext.create("App.ui.CreateMenu",{})},{text:"Open",iconCls:"folder-open",handler:function(){App.ui.filesTree.openSelection()}},{text:"Tools",iconCls:"tools",menu:[{text:"Console",iconCls:"terminal",handler:App.ui.Launcher.toggleConsole,scope:App.ui.Launcher},{text:"Dashboard",iconCls:"dash",handler:App.ui.Launcher.makeLauncher("dashboard")},"-",{canActivate:!1,plain:!0,html:"<b>Domains and Structures</b>"},{text:"Strand Editor",iconCls:"domains",handler:App.ui.Launcher.makeLauncher("strandedit")},{text:"Structure Editor",iconCls:"secondary",handler:function(){var a=Ext.create("App.ui.StrandPreviewWindow");a.show()}},{text:"Segment Threader",iconCls:"thread-sequences",handler:function(){var a=Ext.create("App.ui.SequenceThreader");a.show()}},"-",{canActivate:!1,plain:!0,html:"<b>Sequence Design and Analysis</b>"},{text:"Sequence Editor",iconCls:"seq",handler:App.ui.Launcher.makeLauncher("sequence")},{text:"DD",iconCls:"dd",handler:App.ui.Launcher.makeLauncher("dd")},{text:"NUPACK",iconCls:"nupack-icon",handler:App.ui.Launcher.makeLauncher("nupack"),menu:Ext.create("App.ui.NupackMenu")},{text:"Mfold",iconCls:"mfold-icon",menu:[{text:"QuikFold",iconCls:"mfold-icon",handler:function(){var a=Ext.create("App.ui.mfold.QuikFoldWindow");a.show()}}]},{text:"Vienna RNA",iconCls:"tbi",menu:[{text:"RNAfold Server",iconCls:"tbi",handler:function(){var a=Ext.create("App.ui.vienna.RNAfoldWindow");a.show()}}]},"-",{text:"Help",iconCls:"help",handler:App.ui.Launcher.makeLauncher("help")}]},{text:"Help",iconCls:"help",handler:App.ui.Launcher.makeLauncher("help")},"->",{scale:"small",iconCls:"system",text:"System",menu:[{text:"Preferences",iconCls:"wrench",disabled:!0},{text:"Installed Applications",iconCls:"applications",disabled:!0},{text:"Run",iconCls:"run",disabled:!0},{text:"Tasks",iconCls:"system",handler:App.ui.Launcher.makeLauncher("taskmanager")}]},"-",{scale:"small",iconCls:"user",text:App.User.isLoggedIn()?App.User.name:"Not logged in",disabled:!App.User.isLoggedIn(),iconAlign:"left"},{scale:"small",iconCls:"key",text:"Logout",disabled:!App.User.isLoggedIn(),iconAlign:"left",handler:function(){window.location="/logout"}}]},items:[d,e,App.ui.Launcher.console]}]});App.ui.Launcher.filesTree=App.ui.filesTree=d,App.ui.Launcher.tabPanel=e,App.ui.Launcher.launch("dashboard")},App.on("load",function(){App.ui.buildInterface()})
