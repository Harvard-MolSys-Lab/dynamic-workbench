//
// ChemDoodle Web Components 4.3.1
//
// http://web.chemdoodle.com
//
// Copyright 2009 iChemLabs, LLC.  All rights reserved.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// As a special exception to the GPL, any HTML file in a public website
// or any free web service which merely makes function calls to this
// code, and for that purpose includes it by reference, shall be deemed
// a separate work for copyright law purposes. If you modify this code,
// you may extend this exception to your version of the code, but you
// are not obligated to do so. If you do not wish to do so, delete this
// exception statement from your version.
//
// As an additional exception to the GPL, you may distribute this
// packed form of the code without the copy of the GPL license normally
// required, provided you include this license notice and a URL through
// which recipients can access the corresponding unpacked source code.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact> for
// alternate licensing options.
//
var ChemDoodle=function(){var c={};c.structures={};c.iChemLabs={};c.informatics={};c.io={};c.getVersion=function(){return"4.3.1"};return c}();
(function(c,a,h,b,g){a.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/ICL_servlets/WebHQ1";a.inRelay=false;a.INFO={userAgent:navigator.userAgent,v_cwc:c.getVersion(),v_jQuery:g.version,v_jQuery_ui:g.ui?g.ui.version:"N/A"};a.contactServer=function(d,k,e,j){if(this.inRelay)alert("Already connecting to the server, please wait for the first request to finish.");else{a.inRelay=true;g.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:d,content:k,info:a.INFO}),url:this.SERVER_URL,success:function(f){a.inRelay=
false;o=JSON.parse(f);o.message&&alert(o.message);e!=null&&o.content&&!o.stop&&e(o.content);o.stop&&j!=null&&j()},error:function(){a.inRelay=false;alert("Server connectivity failed. Please try again or update this browser to the latest version. (XHR2 not supported)");j!=null&&j()},beforeSend:function(f){f.withCredentials=true}})}};a.optimize=function(d,k,e,j){this.contactServer("optimize",{mol:h.toJSONDummy(d),dimension:k},function(f){f=h.fromJSONDummy(f.mol);if(k==2){for(var l=0,m=f.atoms.length;l<
m;l++){d.atoms[l].x=f.atoms[l].x;d.atoms[l].y=f.atoms[l].y}e()}else if(k==3){l=0;for(m=f.atoms.length;l<m;l++){f.atoms[l].x/=20;f.atoms[l].y/=20;f.atoms[l].z/=20}e(f)}},j)};a.readSMILES=function(d,k,e){this.contactServer("readSMILES",{smiles:d},function(j){k(h.fromJSONDummy(j.mol))},e)};a.writeSMILES=function(d,k,e){this.contactServer("writeSMILES",{mol:h.toJSONDummy(d)},function(j){k(j.smiles)},e)};a.saveFile=function(d,k,e,j){this.contactServer("saveFile",{mol:h.toJSONDummy(d),ext:k},function(f){e(f.link)},
j)};a.getMoleculeFromDatabase=function(d,k,e,j,f){this.contactServer("getMoleculeFromDatabase",{database:d,dimension:j?j:2,query:k},function(l){if(j==3)for(var m=0,n=l.mol.a.length;m<n;m++){l.mol.a[m].x/=20;l.mol.a[m].y/=20;l.mol.a[m].z/=20}e(h.fromJSONDummy(l.mol))},f)};a.calculate=function(d,k,e,j){this.contactServer("calculate",{mol:h.toJSONDummy(d),descriptors:k},function(f){e(f)},j)};a.simulate1HNMR=function(d,k,e){this.contactServer("simulateNMR",{mol:h.toJSONDummy(d),nucleus:"H",isotope:1},
function(j){k(c.readJCAMP(j.jcamp))},e)};a.simulate13CNMR=function(d,k,e){this.contactServer("simulateNMR",{mol:h.toJSONDummy(d),nucleus:"C",isotope:13},function(j){k(c.readJCAMP(j.jcamp))},e)};a.simulateMassParentPeak=function(d,k,e){this.contactServer("simulateMassParentPeak",{mol:h.toJSONDummy(d)},function(j){k(c.readJCAMP(j.jcamp))},e)};a.getOptimizedPDBStructure=function(d,k,e,j){this.contactServer("getOptimizedPDBStructure",{id:d,withAtoms:k},function(f){var l=null;l=f.mol?h.fromJSONDummy(f.mol):
new b.Molecule;l.chains=h.fromJSONChains(f.ribbons);if(!f.mol){f=l.getCenter3D();for(var m=0,n=l.chains.length;m<n;m++)for(var r=l.chains[m],p=0,u=r.length;p<u;p++){var q=r[p];q.alphaCarbon.x-=f.x;q.alphaCarbon.y-=f.y;q.alphaCarbon.z-=f.z;q.carbonylOxygen.x-=f.x;q.carbonylOxygen.y-=f.y;q.carbonylOxygen.z-=f.z}}e(l)},j)};a.getAd=function(d,k){this.contactServer("getAd",{},function(e){d(e.image_url,e.target_url)},k)}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery);
ChemDoodle.extensions=function(c,a,h){var b={};b.stringStartsWith=function(g,d){return g.match("^"+d)==d};b.vec3AngleFrom=function(g,d){var k=a.length(g),e=a.length(d);k=a.dot(g,d)/k/e;return h.acos(k)};b.contextHashTo=function(g,d,k,e,j,f,l){var m=0,n=(new c.Point(d,k)).distance(new c.Point(e,j)),r=false,p=d,u=k;d=e-d;for(k=j-k;m<n;){if(r)if(m+l>n){g.moveTo(e,j);break}else{var q=l/n;p+=q*d;u+=q*k;g.moveTo(p,u);m+=l}else if(m+f>n){g.lineTo(e,j);break}else{q=f/n;p+=q*d;u+=q*k;g.lineTo(p,u);m+=f}r=
!r}};b.contextRoundRect=function(g,d,k,e,j,f){g.beginPath();g.moveTo(d+f,k);g.lineTo(d+e-f,k);g.quadraticCurveTo(d+e,k,d+e,k+f);g.lineTo(d+e,k+j-f);g.quadraticCurveTo(d+e,k+j,d+e-f,k+j);g.lineTo(d+f,k+j);g.quadraticCurveTo(d,k+j,d,k+j-f);g.lineTo(d,k+f);g.quadraticCurveTo(d,k,d+f,k);g.closePath()};b.contextEllipse=function(g,d,k,e,j){var f=e/2*0.5522848,l=j/2*0.5522848,m=d+e,n=k+j;e=d+e/2;j=k+j/2;g.beginPath();g.moveTo(d,j);g.bezierCurveTo(d,j-l,e-f,k,e,k);g.bezierCurveTo(e+f,k,m,j-l,m,j);g.bezierCurveTo(m,
j+l,e+f,n,e,n);g.bezierCurveTo(e-f,n,d,j+l,d,j);g.closePath()};return b}(ChemDoodle.structures,vec3,Math);
ChemDoodle.math=function(c,a,h){var b={},g={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};b.angleBetweenLargest=function(d){if(d.length==0)return 0;if(d.length==1)return d[0]+h.PI;for(var k=0,e=0,j=0,f=d.length-1;j<f;j++){var l=d[j+1]-d[j];if(l>k){k=l;e=(d[j+1]+d[j])/2}}j=d[0]+h.PI*
2-d[d.length-1];if(j>k){e=d[0]-j/2;if(e<0)e+=h.PI*2}return e};b.isBetween=function(d,k,e){return d>=k&&d<=e};b.getRGB=function(d,k){var e=[0,0,0];if(g[d.toLowerCase()]!=null)d=g[d.toLowerCase()];if(d.charAt(0)=="#"){if(d.length==4)d="#"+d.charAt(1)+d.charAt(1)+d.charAt(2)+d.charAt(2)+d.charAt(3)+d.charAt(3);return[parseInt(d.substring(1,3),16)/255*k,parseInt(d.substring(3,5),16)/255*k,parseInt(d.substring(5,7),16)/255*k]}else if(c.stringStartsWith(d,"rgb")){var j=d.replace(/rgb\(|\)/g,"").split(",");
if(j.length!=3)return e;return[parseInt(j[0])/255*k,parseInt(j[1])/255*k,parseInt(j[2])/255*k]}return e};b.distanceFromPointToLineInclusive=function(d,k,e){var j=k.distance(e);e=k.angle(e);e=h.PI/2-e;new a.Point(d.x-k.x,d.y-k.x);new a.Point;e=k.angle(d)+e;d=k.distance(d);pcopRot=new a.Point(d*h.cos(e),-d*h.sin(e));if(b.isBetween(-pcopRot.y,0,j))return h.abs(pcopRot.x);return-1};return b}(ChemDoodle.extensions,ChemDoodle.structures,Math);
ChemDoodle.featureDetection=function(c,a,h,b){var g={};g.supports_canvas=function(){return!!h.createElement("canvas").getContext};g.supports_canvas_text=function(){if(!g.supports_canvas())return false;return typeof h.createElement("canvas").getContext("2d").fillText=="function"};g.supports_webgl=function(){var d=h.createElement("canvas");try{if(d.getContext("webgl"))return true;if(d.getContext("experimental-webgl"))return true}catch(k){}return false};g.supports_xhr2=function(){return a.support.cors};
g.supports_touch=function(){return"ontouchstart"in b};return g}(ChemDoodle.iChemLabs,jQuery,document,window);
ChemDoodle.ELEMENT=function(){function c(h,b,g){this.symbol=h;this.name=b;this.atomicNumber=g;return true}var a=[];a.H=new c("H","Hydrogen",1);a.He=new c("He","Helium",2);a.Li=new c("Li","Lithium",3);a.Be=new c("Be","Beryllium",4);a.B=new c("B","Boron",5);a.C=new c("C","Carbon",6);a.N=new c("N","Nitrogen",7);a.O=new c("O","Oxygen",8);a.F=new c("F","Fluorine",9);a.Ne=new c("Ne","Neon",10);a.Na=new c("Na","Sodium",11);a.Mg=new c("Mg","Magnesium",12);a.Al=new c("Al","Aluminum",13);a.Si=new c("Si","Silicon",
14);a.P=new c("P","Phosphorus",15);a.S=new c("S","Sulfur",16);a.Cl=new c("Cl","Chlorine",17);a.Ar=new c("Ar","Argon",18);a.K=new c("K","Potassium",19);a.Ca=new c("Ca","Calcium",20);a.Sc=new c("Sc","Scandium",21);a.Ti=new c("Ti","Titanium",22);a.V=new c("V","Vanadium",23);a.Cr=new c("Cr","Chromium",24);a.Mn=new c("Mn","Manganese",25);a.Fe=new c("Fe","Iron",26);a.Co=new c("Co","Cobalt",27);a.Ni=new c("Ni","Nickel",28);a.Cu=new c("Cu","Copper",29);a.Zn=new c("Zn","Zinc",30);a.Ga=new c("Ga","Gallium",
31);a.Ge=new c("Ge","Germanium",32);a.As=new c("As","Arsenic",33);a.Se=new c("Se","Selenium",34);a.Br=new c("Br","Bromine",35);a.Kr=new c("Kr","Krypton",36);a.Rb=new c("Rb","Rubidium",37);a.Sr=new c("Sr","Strontium",38);a.Y=new c("Y","Yttrium",39);a.Zr=new c("Zr","Zirconium",40);a.Nb=new c("Nb","Niobium",41);a.Mo=new c("Mo","Molybdenum",42);a.Tc=new c("Tc","Technetium",43);a.Ru=new c("Ru","Ruthenium",44);a.Rh=new c("Rh","Rhodium",45);a.Pd=new c("Pd","Palladium",46);a.Ag=new c("Ag","Silver",47);a.Cd=
new c("Cd","Cadmium",48);a.In=new c("In","Indium",49);a.Sn=new c("Sn","Tin",50);a.Sb=new c("Sb","Antimony",51);a.Te=new c("Te","Tellurium",52);a.I=new c("I","Iodine",53);a.Xe=new c("Xe","Xenon",54);a.Cs=new c("Cs","Cesium",55);a.Ba=new c("Ba","Barium",56);a.La=new c("La","Lanthanum",57);a.Ce=new c("Ce","Cerium",58);a.Pr=new c("Pr","Praseodymium",59);a.Nd=new c("Nd","Neodymium",60);a.Pm=new c("Pm","Promethium",61);a.Sm=new c("Sm","Samarium",62);a.Eu=new c("Eu","Europium",63);a.Gd=new c("Gd","Gadolinium",
64);a.Tb=new c("Tb","Terbium",65);a.Dy=new c("Dy","Dysprosium",66);a.Ho=new c("Ho","Holmium",67);a.Er=new c("Er","Erbium",68);a.Tm=new c("Tm","Thulium",69);a.Yb=new c("Yb","Ytterbium",70);a.Lu=new c("Lu","Lutetium",71);a.Hf=new c("Hf","Hafnium",72);a.Ta=new c("Ta","Tantalum",73);a.W=new c("W","Tungsten",74);a.Re=new c("Re","Rhenium",75);a.Os=new c("Os","Osmium",76);a.Ir=new c("Ir","Iridium",77);a.Pt=new c("Pt","Platinum",78);a.Au=new c("Au","Gold",79);a.Hg=new c("Hg","Mercury",80);a.Tl=new c("Tl",
"Thallium",81);a.Pb=new c("Pb","Lead",82);a.Bi=new c("Bi","Bismuth",83);a.Po=new c("Po","Polonium",84);a.At=new c("At","Astatine",85);a.Rn=new c("Rn","Radon",86);a.Fr=new c("Fr","Francium",87);a.Ra=new c("Ra","Radium",88);a.Ac=new c("Ac","Actinium",89);a.Th=new c("Th","Thorium",90);a.Pa=new c("Pa","Protactinium",91);a.U=new c("U","Uranium",92);a.Np=new c("Np","Neptunium",93);a.Pu=new c("Pu","Plutonium",94);a.Am=new c("Am","Americium",95);a.Cm=new c("Cm","Curium",96);a.Bk=new c("Bk","Berkelium",97);
a.Cf=new c("Cf","Californium",98);a.Es=new c("Es","Einsteinium",99);a.Fm=new c("Fm","Fermium",100);a.Md=new c("Md","Mendelevium",101);a.No=new c("No","Nobelium",102);a.Lr=new c("Lr","Lawrencium",103);a.Rf=new c("Rf","Rutherfordium",104);a.Db=new c("Db","Dubnium",105);a.Sg=new c("Sg","Seaborgium",106);a.Bh=new c("Bh","Bohrium",107);a.Hs=new c("Hs","Hassium",108);a.Mt=new c("Mt","Meitnerium",109);a.Ds=new c("Ds","Darmstadtium",110);a.Rg=new c("Rg","Roentgenium",111);a.Cn=new c("Cn","Copernicium",112);
a.Uut=new c("Uut","Ununtrium",113);a.Uuq=new c("Uuq","Ununquadium",114);a.Uup=new c("Uup","Ununpentium",115);a.Uuh=new c("Uuh","Ununhexium",116);a.Uus=new c("Uus","Ununseptium",117);a.Uuo=new c("Uuo","Ununoctium",118);a.H.jmolColor="#FFFFFF";a.He.jmolColor="#D9FFFF";a.Li.jmolColor="#CC80FF";a.Be.jmolColor="#C2FF00";a.B.jmolColor="#FFB5B5";a.C.jmolColor="#909090";a.N.jmolColor="#3050F8";a.O.jmolColor="#FF0D0D";a.F.jmolColor="#90E050";a.Ne.jmolColor="#B3E3F5";a.Na.jmolColor="#AB5CF2";a.Mg.jmolColor=
"#8AFF00";a.Al.jmolColor="#BFA6A6";a.Si.jmolColor="#F0C8A0";a.P.jmolColor="#FF8000";a.S.jmolColor="#FFFF30";a.Cl.jmolColor="#1FF01F";a.Ar.jmolColor="#80D1E3";a.K.jmolColor="#8F40D4";a.Ca.jmolColor="#3DFF00";a.Sc.jmolColor="#E6E6E6";a.Ti.jmolColor="#BFC2C7";a.V.jmolColor="#A6A6AB";a.Cr.jmolColor="#8A99C7";a.Mn.jmolColor="#9C7AC7";a.Fe.jmolColor="#E06633";a.Co.jmolColor="#F090A0";a.Ni.jmolColor="#50D050";a.Cu.jmolColor="#C88033";a.Zn.jmolColor="#7D80B0";a.Ga.jmolColor="#C28F8F";a.Ge.jmolColor="#668F8F";
a.As.jmolColor="#BD80E3";a.Se.jmolColor="#FFA100";a.Br.jmolColor="#A62929";a.Kr.jmolColor="#5CB8D1";a.Rb.jmolColor="#702EB0";a.Sr.jmolColor="#00FF00";a.Y.jmolColor="#94FFFF";a.Zr.jmolColor="#94E0E0";a.Nb.jmolColor="#73C2C9";a.Mo.jmolColor="#54B5B5";a.Tc.jmolColor="#3B9E9E";a.Ru.jmolColor="#248F8F";a.Rh.jmolColor="#0A7D8C";a.Pd.jmolColor="#006985";a.Ag.jmolColor="#C0C0C0";a.Cd.jmolColor="#FFD98F";a.In.jmolColor="#A67573";a.Sn.jmolColor="#668080";a.Sb.jmolColor="#9E63B5";a.Te.jmolColor="#D47A00";a.I.jmolColor=
"#940094";a.Xe.jmolColor="#429EB0";a.Cs.jmolColor="#57178F";a.Ba.jmolColor="#00C900";a.La.jmolColor="#70D4FF";a.Ce.jmolColor="#FFFFC7";a.Pr.jmolColor="#D9FFC7";a.Nd.jmolColor="#C7FFC7";a.Pm.jmolColor="#A3FFC7";a.Sm.jmolColor="#8FFFC7";a.Eu.jmolColor="#61FFC7";a.Gd.jmolColor="#45FFC7";a.Tb.jmolColor="#30FFC7";a.Dy.jmolColor="#1FFFC7";a.Ho.jmolColor="#00FF9C";a.Er.jmolColor="#00E675";a.Tm.jmolColor="#00D452";a.Yb.jmolColor="#00BF38";a.Lu.jmolColor="#00AB24";a.Hf.jmolColor="#4DC2FF";a.Ta.jmolColor="#4DA6FF";
a.W.jmolColor="#2194D6";a.Re.jmolColor="#267DAB";a.Os.jmolColor="#266696";a.Ir.jmolColor="#175487";a.Pt.jmolColor="#D0D0E0";a.Au.jmolColor="#FFD123";a.Hg.jmolColor="#B8B8D0";a.Tl.jmolColor="#A6544D";a.Pb.jmolColor="#575961";a.Bi.jmolColor="#9E4FB5";a.Po.jmolColor="#AB5C00";a.At.jmolColor="#754F45";a.Rn.jmolColor="#428296";a.Fr.jmolColor="#420066";a.Ra.jmolColor="#007D00";a.Ac.jmolColor="#70ABFA";a.Th.jmolColor="#00BAFF";a.Pa.jmolColor="#00A1FF";a.U.jmolColor="#008FFF";a.Np.jmolColor="#0080FF";a.Pu.jmolColor=
"#006BFF";a.Am.jmolColor="#545CF2";a.Cm.jmolColor="#785CE3";a.Bk.jmolColor="#8A4FE3";a.Cf.jmolColor="#A136D4";a.Es.jmolColor="#B31FD4";a.Fm.jmolColor="#B31FBA";a.Md.jmolColor="#B30DA6";a.No.jmolColor="#BD0D87";a.Lr.jmolColor="#C70066";a.Rf.jmolColor="#CC0059";a.Db.jmolColor="#D1004F";a.Sg.jmolColor="#D90045";a.Bh.jmolColor="#E00038";a.Hs.jmolColor="#E6002E";a.Mt.jmolColor="#EB0026";a.Ds.jmolColor="#000000";a.Rg.jmolColor="#000000";a.Cn.jmolColor="#000000";a.Uut.jmolColor="#000000";a.Uuq.jmolColor=
"#000000";a.Uup.jmolColor="#000000";a.Uuh.jmolColor="#000000";a.Uus.jmolColor="#000000";a.Uuo.jmolColor="#000000";a.H.covalentRadius=0.31;a.He.covalentRadius=0.28;a.Li.covalentRadius=1.28;a.Be.covalentRadius=0.96;a.B.covalentRadius=0.84;a.C.covalentRadius=0.76;a.N.covalentRadius=0.71;a.O.covalentRadius=0.66;a.F.covalentRadius=0.57;a.Ne.covalentRadius=0.58;a.Na.covalentRadius=1.66;a.Mg.covalentRadius=1.41;a.Al.covalentRadius=1.21;a.Si.covalentRadius=1.11;a.P.covalentRadius=1.07;a.S.covalentRadius=
1.05;a.Cl.covalentRadius=1.02;a.Ar.covalentRadius=1.06;a.K.covalentRadius=2.03;a.Ca.covalentRadius=1.76;a.Sc.covalentRadius=1.7;a.Ti.covalentRadius=1.6;a.V.covalentRadius=1.53;a.Cr.covalentRadius=1.39;a.Mn.covalentRadius=1.39;a.Fe.covalentRadius=1.32;a.Co.covalentRadius=1.26;a.Ni.covalentRadius=1.24;a.Cu.covalentRadius=1.32;a.Zn.covalentRadius=1.22;a.Ga.covalentRadius=1.22;a.Ge.covalentRadius=1.2;a.As.covalentRadius=1.19;a.Se.covalentRadius=1.2;a.Br.covalentRadius=1.2;a.Kr.covalentRadius=1.16;a.Rb.covalentRadius=
2.2;a.Sr.covalentRadius=1.95;a.Y.covalentRadius=1.9;a.Zr.covalentRadius=1.75;a.Nb.covalentRadius=1.64;a.Mo.covalentRadius=1.54;a.Tc.covalentRadius=1.47;a.Ru.covalentRadius=1.46;a.Rh.covalentRadius=1.42;a.Pd.covalentRadius=1.39;a.Ag.covalentRadius=1.45;a.Cd.covalentRadius=1.44;a.In.covalentRadius=1.42;a.Sn.covalentRadius=1.39;a.Sb.covalentRadius=1.39;a.Te.covalentRadius=1.38;a.I.covalentRadius=1.39;a.Xe.covalentRadius=1.4;a.Cs.covalentRadius=2.44;a.Ba.covalentRadius=2.15;a.La.covalentRadius=2.07;a.Ce.covalentRadius=
2.04;a.Pr.covalentRadius=2.03;a.Nd.covalentRadius=2.01;a.Pm.covalentRadius=1.99;a.Sm.covalentRadius=1.98;a.Eu.covalentRadius=1.98;a.Gd.covalentRadius=1.96;a.Tb.covalentRadius=1.94;a.Dy.covalentRadius=1.92;a.Ho.covalentRadius=1.92;a.Er.covalentRadius=1.89;a.Tm.covalentRadius=1.9;a.Yb.covalentRadius=1.87;a.Lu.covalentRadius=1.87;a.Hf.covalentRadius=1.75;a.Ta.covalentRadius=1.7;a.W.covalentRadius=1.62;a.Re.covalentRadius=1.51;a.Os.covalentRadius=1.44;a.Ir.covalentRadius=1.41;a.Pt.covalentRadius=1.36;
a.Au.covalentRadius=1.36;a.Hg.covalentRadius=1.32;a.Tl.covalentRadius=1.45;a.Pb.covalentRadius=1.46;a.Bi.covalentRadius=1.48;a.Po.covalentRadius=1.4;a.At.covalentRadius=1.5;a.Rn.covalentRadius=1.5;a.Fr.covalentRadius=2.6;a.Ra.covalentRadius=2.21;a.Ac.covalentRadius=2.15;a.Th.covalentRadius=2.06;a.Pa.covalentRadius=2;a.U.covalentRadius=1.96;a.Np.covalentRadius=1.9;a.Pu.covalentRadius=1.87;a.Am.covalentRadius=1.8;a.Cm.covalentRadius=1.69;a.Bk.covalentRadius=0;a.Cf.covalentRadius=0;a.Es.covalentRadius=
0;a.Fm.covalentRadius=0;a.Md.covalentRadius=0;a.No.covalentRadius=0;a.Lr.covalentRadius=0;a.Rf.covalentRadius=0;a.Db.covalentRadius=0;a.Sg.covalentRadius=0;a.Bh.covalentRadius=0;a.Hs.covalentRadius=0;a.Mt.covalentRadius=0;a.Ds.covalentRadius=0;a.Rg.covalentRadius=0;a.Cn.covalentRadius=0;a.Uut.covalentRadius=0;a.Uuq.covalentRadius=0;a.Uup.covalentRadius=0;a.Uuh.covalentRadius=0;a.Uus.covalentRadius=0;a.Uuo.covalentRadius=0;a.H.vdWRadius=1.2;a.He.vdWRadius=1.4;a.Li.vdWRadius=1.82;a.Be.vdWRadius=0;a.B.vdWRadius=
0;a.C.vdWRadius=1.7;a.N.vdWRadius=1.55;a.O.vdWRadius=1.52;a.F.vdWRadius=1.47;a.Ne.vdWRadius=1.54;a.Na.vdWRadius=2.27;a.Mg.vdWRadius=1.73;a.Al.vdWRadius=0;a.Si.vdWRadius=2.1;a.P.vdWRadius=1.8;a.S.vdWRadius=1.8;a.Cl.vdWRadius=1.75;a.Ar.vdWRadius=1.88;a.K.vdWRadius=2.75;a.Ca.vdWRadius=0;a.Sc.vdWRadius=0;a.Ti.vdWRadius=0;a.V.vdWRadius=0;a.Cr.vdWRadius=0;a.Mn.vdWRadius=0;a.Fe.vdWRadius=0;a.Co.vdWRadius=0;a.Ni.vdWRadius=1.63;a.Cu.vdWRadius=1.4;a.Zn.vdWRadius=1.39;a.Ga.vdWRadius=1.87;a.Ge.vdWRadius=0;a.As.vdWRadius=
1.85;a.Se.vdWRadius=1.9;a.Br.vdWRadius=1.85;a.Kr.vdWRadius=2.02;a.Rb.vdWRadius=0;a.Sr.vdWRadius=0;a.Y.vdWRadius=0;a.Zr.vdWRadius=0;a.Nb.vdWRadius=0;a.Mo.vdWRadius=0;a.Tc.vdWRadius=0;a.Ru.vdWRadius=0;a.Rh.vdWRadius=0;a.Pd.vdWRadius=1.63;a.Ag.vdWRadius=1.72;a.Cd.vdWRadius=1.58;a.In.vdWRadius=1.93;a.Sn.vdWRadius=2.17;a.Sb.vdWRadius=0;a.Te.vdWRadius=2.06;a.I.vdWRadius=1.98;a.Xe.vdWRadius=2.16;a.Cs.vdWRadius=0;a.Ba.vdWRadius=0;a.La.vdWRadius=0;a.Ce.vdWRadius=0;a.Pr.vdWRadius=0;a.Nd.vdWRadius=0;a.Pm.vdWRadius=
0;a.Sm.vdWRadius=0;a.Eu.vdWRadius=0;a.Gd.vdWRadius=0;a.Tb.vdWRadius=0;a.Dy.vdWRadius=0;a.Ho.vdWRadius=0;a.Er.vdWRadius=0;a.Tm.vdWRadius=0;a.Yb.vdWRadius=0;a.Lu.vdWRadius=0;a.Hf.vdWRadius=0;a.Ta.vdWRadius=0;a.W.vdWRadius=0;a.Re.vdWRadius=0;a.Os.vdWRadius=0;a.Ir.vdWRadius=0;a.Pt.vdWRadius=1.75;a.Au.vdWRadius=1.66;a.Hg.vdWRadius=1.55;a.Tl.vdWRadius=1.96;a.Pb.vdWRadius=2.02;a.Bi.vdWRadius=0;a.Po.vdWRadius=0;a.At.vdWRadius=0;a.Rn.vdWRadius=0;a.Fr.vdWRadius=0;a.Ra.vdWRadius=0;a.Ac.vdWRadius=0;a.Th.vdWRadius=
0;a.Pa.vdWRadius=0;a.U.vdWRadius=1.86;a.Np.vdWRadius=0;a.Pu.vdWRadius=0;a.Am.vdWRadius=0;a.Cm.vdWRadius=0;a.Bk.vdWRadius=0;a.Cf.vdWRadius=0;a.Es.vdWRadius=0;a.Fm.vdWRadius=0;a.Md.vdWRadius=0;a.No.vdWRadius=0;a.Lr.vdWRadius=0;a.Rf.vdWRadius=0;a.Db.vdWRadius=0;a.Sg.vdWRadius=0;a.Bh.vdWRadius=0;a.Hs.vdWRadius=0;a.Mt.vdWRadius=0;a.Ds.vdWRadius=0;a.Rg.vdWRadius=0;a.Cn.vdWRadius=0;a.Uut.vdWRadius=0;a.Uuq.vdWRadius=0;a.Uup.vdWRadius=0;a.Uuh.vdWRadius=0;a.Uus.vdWRadius=0;a.Uuo.vdWRadius=0;a.H.valency=1;a.He.valency=
0;a.Li.valency=1;a.Be.valency=2;a.B.valency=3;a.C.valency=4;a.N.valency=3;a.O.valency=2;a.F.valency=1;a.Ne.valency=0;a.Na.valency=1;a.Mg.valency=0;a.Al.valency=0;a.Si.valency=4;a.P.valency=3;a.S.valency=2;a.Cl.valency=1;a.Ar.valency=0;a.K.valency=0;a.Ca.valency=0;a.Sc.valency=0;a.Ti.valency=1;a.V.valency=1;a.Cr.valency=2;a.Mn.valency=3;a.Fe.valency=2;a.Co.valency=1;a.Ni.valency=1;a.Cu.valency=0;a.Zn.valency=0;a.Ga.valency=0;a.Ge.valency=4;a.As.valency=3;a.Se.valency=2;a.Br.valency=1;a.Kr.valency=
0;a.Rb.valency=0;a.Sr.valency=0;a.Y.valency=0;a.Zr.valency=0;a.Nb.valency=1;a.Mo.valency=2;a.Tc.valency=3;a.Ru.valency=2;a.Rh.valency=1;a.Pd.valency=0;a.Ag.valency=0;a.Cd.valency=0;a.In.valency=0;a.Sn.valency=4;a.Sb.valency=3;a.Te.valency=2;a.I.valency=1;a.Xe.valency=0;a.Cs.valency=0;a.Ba.valency=0;a.La.valency=0;a.Ce.valency=0;a.Pr.valency=0;a.Nd.valency=0;a.Pm.valency=0;a.Sm.valency=0;a.Eu.valency=0;a.Gd.valency=0;a.Tb.valency=0;a.Dy.valency=0;a.Ho.valency=0;a.Er.valency=0;a.Tm.valency=0;a.Yb.valency=
0;a.Lu.valency=0;a.Hf.valency=0;a.Ta.valency=1;a.W.valency=2;a.Re.valency=3;a.Os.valency=2;a.Ir.valency=3;a.Pt.valency=0;a.Au.valency=1;a.Hg.valency=0;a.Tl.valency=0;a.Pb.valency=4;a.Bi.valency=3;a.Po.valency=2;a.At.valency=1;a.Rn.valency=0;a.Fr.valency=0;a.Ra.valency=0;a.Ac.valency=0;a.Th.valency=0;a.Pa.valency=0;a.U.valency=0;a.Np.valency=0;a.Pu.valency=0;a.Am.valency=0;a.Cm.valency=0;a.Bk.valency=0;a.Cf.valency=0;a.Es.valency=0;a.Fm.valency=0;a.Md.valency=0;a.No.valency=0;a.Lr.valency=0;a.Rf.valency=
0;a.Db.valency=0;a.Sg.valency=0;a.Bh.valency=0;a.Hs.valency=0;a.Mt.valency=0;a.Ds.valency=0;a.Rg.valency=0;a.Cn.valency=0;a.Uut.valency=0;a.Uuq.valency=0;a.Uup.valency=0;a.Uuh.valency=0;a.Uus.valency=0;a.Uuo.valency=0;a.H.mass=1;a.He.mass=4;a.Li.mass=7;a.Be.mass=9;a.B.mass=11;a.C.mass=12;a.N.mass=14;a.O.mass=16;a.F.mass=19;a.Ne.mass=20;a.Na.mass=23;a.Mg.mass=24;a.Al.mass=27;a.Si.mass=28;a.P.mass=31;a.S.mass=32;a.Cl.mass=35;a.Ar.mass=40;a.K.mass=39;a.Ca.mass=40;a.Sc.mass=45;a.Ti.mass=48;a.V.mass=51;
a.Cr.mass=52;a.Mn.mass=55;a.Fe.mass=56;a.Co.mass=59;a.Ni.mass=58;a.Cu.mass=63;a.Zn.mass=64;a.Ga.mass=69;a.Ge.mass=74;a.As.mass=75;a.Se.mass=80;a.Br.mass=79;a.Kr.mass=84;a.Rb.mass=85;a.Sr.mass=88;a.Y.mass=89;a.Zr.mass=90;a.Nb.mass=93;a.Mo.mass=98;a.Tc.mass=0;a.Ru.mass=102;a.Rh.mass=103;a.Pd.mass=106;a.Ag.mass=107;a.Cd.mass=114;a.In.mass=115;a.Sn.mass=120;a.Sb.mass=121;a.Te.mass=130;a.I.mass=127;a.Xe.mass=132;a.Cs.mass=133;a.Ba.mass=138;a.La.mass=139;a.Ce.mass=140;a.Pr.mass=141;a.Nd.mass=142;a.Pm.mass=
0;a.Sm.mass=152;a.Eu.mass=153;a.Gd.mass=158;a.Tb.mass=159;a.Dy.mass=164;a.Ho.mass=165;a.Er.mass=166;a.Tm.mass=169;a.Yb.mass=174;a.Lu.mass=175;a.Hf.mass=180;a.Ta.mass=181;a.W.mass=184;a.Re.mass=187;a.Os.mass=192;a.Ir.mass=193;a.Pt.mass=195;a.Au.mass=197;a.Hg.mass=202;a.Tl.mass=205;a.Pb.mass=208;a.Bi.mass=209;a.Po.mass=0;a.At.mass=0;a.Rn.mass=0;a.Fr.mass=0;a.Ra.mass=0;a.Ac.mass=0;a.Th.mass=232;a.Pa.mass=231;a.U.mass=238;a.Np.mass=0;a.Pu.mass=0;a.Am.mass=0;a.Cm.mass=0;a.Bk.mass=0;a.Cf.mass=0;a.Es.mass=
0;a.Fm.mass=0;a.Md.mass=0;a.No.mass=0;a.Lr.mass=0;a.Rf.mass=0;a.Db.mass=0;a.Sg.mass=0;a.Bh.mass=0;a.Hs.mass=0;a.Mt.mass=0;a.Ds.mass=0;a.Rg.mass=0;a.Cn.mass=0;a.Uut.mass=0;a.Uuq.mass=0;a.Uup.mass=0;a.Uuh.mass=0;a.Uus.mass=0;a.Uuo.mass=0;return a}();
ChemDoodle.SYMBOLS=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es",
"Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Uut","Uuq","Uup","Uuh","Uus","Uuo"];
ChemDoodle.RESIDUE=function(){function c(h,b){this.symbol=h;this.name=b;return true}var a=[];a.Ala=new c("Ala","Alanine");a.Arg=new c("Arg","Arginine");a.Asn=new c("Asn","Asparagine");a.Asp=new c("Asp","Aspartic Acid");a.Cys=new c("Cys","Cysteine");a.Gln=new c("Gln","Glutamine");a.Glu=new c("Glu","Glutamic Acid");a.Gly=new c("Gly","Glycine");a.His=new c("His","Histidine");a.Ile=new c("Ile","Isoleucine");a.Leu=new c("Leu","Leucine");a.Lys=new c("Lys","Lysine");a.Met=new c("Met","Methionine");a.Phe=
new c("Phe","Phenylalanine");a.Pro=new c("Pro","Proline");a.Ser=new c("Ser","Serine");a.Thr=new c("Thr","Threonine");a.Trp=new c("Trp","Tryptophan");a.Tyr=new c("Tyr","Tyrosine");a.Val=new c("Val","Valine");a.Asx=new c("Asx","Asparagine/Aspartic Acid");a.Glx=new c("Glx","Glutamine/Glutamic Acid");a["*"]=new c("*","Other");a.A=new c("A","Adenine");a.G=new c("G","Guanine");a.I=new c("I","");a.C=new c("C","Cytosine");a.T=new c("T","Thymine");a.U=new c("U","Uracil");a.Ala.aminoColor="#C8C8C8";a.Arg.aminoColor=
"#145AFF";a.Asn.aminoColor="#00DCDC";a.Asp.aminoColor="#E60A0A";a.Cys.aminoColor="#E6E600";a.Gln.aminoColor="#00DCDC";a.Glu.aminoColor="#E60A0A";a.Gly.aminoColor="#EBEBEB";a.His.aminoColor="#8282D2";a.Ile.aminoColor="#0F820F";a.Leu.aminoColor="#0F820F";a.Lys.aminoColor="#145AFF";a.Met.aminoColor="#E6E600";a.Phe.aminoColor="#3232AA";a.Pro.aminoColor="#DC9682";a.Ser.aminoColor="#FA9600";a.Thr.aminoColor="#FA9600";a.Trp.aminoColor="#B45AB4";a.Tyr.aminoColor="#3232AA";a.Val.aminoColor="#0F820F";a.Asx.aminoColor=
"#FF69B4";a.Glx.aminoColor="#FF69B4";a["*"].aminoColor="#BEA06E";a.A.aminoColor="#BEA06E";a.G.aminoColor="#BEA06E";a.I.aminoColor="#BEA06E";a.C.aminoColor="#BEA06E";a.T.aminoColor="#BEA06E";a.U.aminoColor="#BEA06E";a.Ala.shapelyColor="#8CFF8C";a.Arg.shapelyColor="#00007C";a.Asn.shapelyColor="#FF7C70";a.Asp.shapelyColor="#A00042";a.Cys.shapelyColor="#FFFF70";a.Gln.shapelyColor="#FF4C4C";a.Glu.shapelyColor="#660000";a.Gly.shapelyColor="#FFFFFF";a.His.shapelyColor="#7070FF";a.Ile.shapelyColor="#004C00";
a.Leu.shapelyColor="#455E45";a.Lys.shapelyColor="#4747B8";a.Met.shapelyColor="#B8A042";a.Phe.shapelyColor="#534C52";a.Pro.shapelyColor="#525252";a.Ser.shapelyColor="#FF7042";a.Thr.shapelyColor="#B84C00";a.Trp.shapelyColor="#4F4600";a.Tyr.shapelyColor="#8C704C";a.Val.shapelyColor="#FF8CFF";a.Asx.shapelyColor="#FF00FF";a.Glx.shapelyColor="#FF00FF";a["*"].shapelyColor="#FF00FF";a.A.shapelyColor="#A0A0FF";a.G.shapelyColor="#FF7070";a.I.shapelyColor="#80FFFF";a.C.shapelyColor="#FF8C4B";a.T.shapelyColor=
"#A0FFA0";a.U.shapelyColor="#FF8080";return a}();(function(c){c.Queue=function(){var a=[],h=0;this.getSize=function(){return a.length-h};this.isEmpty=function(){return a.length==0};this.enqueue=function(b){a.push(b)};this.dequeue=function(){var b=undefined;if(a.length){b=a[h];if(++h*2>=a.length){a=a.slice(h);h=0}}return b};this.getOldestElement=function(){var b=undefined;if(a.length)b=a[h];return b}}})(ChemDoodle.structures);
(function(c,a){c.Point=function(h,b){this.x=h?h:0;this.y=b?b:0;this.sub=function(g){this.x-=g.x;this.y-=g.y};this.add=function(g){this.x+=g.x;this.y+=g.y};this.distance=function(g){return a.sqrt(a.pow(g.x-this.x,2)+a.pow(g.y-this.y,2))};this.angleForStupidCanvasArcs=function(g){var d=g.x-this.x;g=g.y-this.y;var k=0;for(k=d==0?g==0?0:g>0?a.PI/2:3*a.PI/2:g==0?d>0?0:a.PI:d<0?a.atan(g/d)+a.PI:g<0?a.atan(g/d)+2*a.PI:a.atan(g/d);k<0;)k+=a.PI*2;k%=a.PI*2;return k};this.angle=function(g){var d=g.x-this.x;
g=this.y-g.y;var k=0;for(k=d==0?g==0?0:g>0?a.PI/2:3*a.PI/2:g==0?d>0?0:a.PI:d<0?a.atan(g/d)+a.PI:g<0?a.atan(g/d)+2*a.PI:a.atan(g/d);k<0;)k+=a.PI*2;k%=a.PI*2;return k};return true}})(ChemDoodle.structures,Math);
(function(c,a,h,b,g){h.Atom=function(d,k,e,j){this.x=k?k:0;this.y=e?e:0;this.z=j?j:0;this.charge=0;this.mass=-1;this.angleOfLeastInterference=this.bondNumber=this.coordinationNumber=0;this.isHidden=false;this.label=d?d.replace(/\s/g,""):"C";if(!c[this.label])this.label="C";this.isSelected=this.isHover=this.isLone=false;this.add3D=function(f){this.x+=f.x;this.y+=f.y;this.z+=f.z};this.sub3D=function(f){this.x-=f.x;this.y-=f.y;this.z-=f.z};this.distance3D=function(f){return b.sqrt(b.pow(f.x-this.x,2)+
b.pow(f.y-this.y,2)+b.pow(f.z-this.z,2))};this.draw=function(f,l){var m=l.getFontString(l.atoms_font_size_2D,l.atoms_font_families_2D,l.atoms_font_bold_2D,l.atoms_font_italic_2D);f.font=m;f.fillStyle=l.atoms_color;if(l.atoms_useJMOLColors)f.fillStyle=c[this.label].jmolColor;if(this.isLone||l.atoms_circles_2D){f.beginPath();f.arc(this.x,this.y,l.atoms_circleDiameter_2D/2,0,b.PI*2,false);f.fill();if(l.atoms_circleBorderWidth_2D>0){f.lineWidth=l.atoms_circleBorderWidth_2D;f.strokeStyle="black";f.stroke(this.x,
this.y,0,b.PI*2,l.atoms_circleDiameter_2D/2)}}else if(this.isLabelVisible(l)){f.textAlign="center";f.textBaseline="middle";f.fillText(this.label,this.x,this.y);if(this.mass!=-1){var n=f.measureText(this.label).width,r=l.getFontString(l.atoms_font_size_2D*0.7,l.atoms_font_families_2D,l.atoms_font_bold_2D,l.atoms_font_italic_2D),p=f.font;f.font=r;r=f.measureText(this.mass).width;f.fillText(this.mass,this.x-r-0.5,this.y-l.atoms_font_size_2D*0.3);f.font=p}p=this.getImplicitHydrogenCount();if(l.atoms_implicitHydrogens_2D&&
p>0){n=f.measureText(this.label).width;var u=f.measureText("H").width;if(p>1){var q=n/2+u/2,t=0;r=l.getFontString(l.atoms_font_size_2D*0.8,l.atoms_font_families_2D,l.atoms_font_bold_2D,l.atoms_font_italic_2D);f.font=r;var x=f.measureText(p).width;if(this.bondNumber==1){if(this.angleOfLeastInterference>b.PI/2&&this.angleOfLeastInterference<3*b.PI/2)q=-n/2-x-u/2}else if(!(this.angleOfLeastInterference<=b.PI/4))if(this.angleOfLeastInterference<3*b.PI/4){q=0;t=-l.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=
5*b.PI/4)q=-n/2-x-u/2;else if(this.angleOfLeastInterference<7*b.PI/4){q=0;t=l.atoms_font_size_2D*0.9}f.font=m;f.fillText("H",this.x+q,this.y+t);f.font=r;f.fillText(p,this.x+q+u/2+x/2,this.y+t+l.atoms_font_size_2D*0.3)}else{q=n/2+u/2;t=0;if(this.bondNumber==1){if(this.angleOfLeastInterference>b.PI/2&&this.angleOfLeastInterference<3*b.PI/2)q=-n/2-u/2}else if(!(this.angleOfLeastInterference<=b.PI/4))if(this.angleOfLeastInterference<3*b.PI/4){q=0;t=-l.atoms_font_size_2D*0.9}else if(this.angleOfLeastInterference<=
5*b.PI/4)q=-n/2-u/2;else if(this.angleOfLeastInterference<7*b.PI/4){q=0;t=l.atoms_font_size_2D*0.9}f.fillText("H",this.x+q,this.y+t)}}}if(this.charge!=null&&this.charge!=0){m=this.charge.toFixed(0);if(m=="1")m="+";else if(m=="-1")m="\u2013";else if(a.stringStartsWith(m,"-"))m=m.substring(1)+"\u2013";else m+="+";r=this.angleOfLeastInterference;n=l.atoms_font_size_2D;if(this.isLabelVisible(l)&&p>0)r+=b.PI/4;f.textAlign="center";f.textBaseline="middle";f.fillText(m,this.x+n*b.cos(r),this.y-n*b.sin(r))}};
this.drawDecorations=function(f){if(this.isHover||this.isSelected){f.strokeStyle=this.isHover?"#885110":"#0060B2";f.lineWidth=1.2;f.beginPath();f.arc(this.x,this.y,this.isHover?7:15,0,b.PI*2,false);f.stroke()}};this.render=function(f,l){var m=g.translate(f.modelViewMatrix,[this.x,this.y,this.z],[]),n=l.atoms_useVDWDiameters_3D?c[this.label].vdWRadius*l.atoms_vdwMultiplier_3D:l.atoms_sphereDiameter_3D/2;if(n==0)n=1;g.scale(m,[n,n,n]);f.material.setDiffuseColor(f,l.atoms_useJMOLColors?c[this.label].jmolColor:
l.atoms_color);f.setMatrixUniforms(m);f.drawElements(f.TRIANGLES,f.sphereBuffer.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0)};this.isLabelVisible=function(f){return this.label!="C"||this.mass!=-1||this.isHidden&&f.atoms_showHiddenCarbons_2D||f.atoms_displayTerminalCarbonLabels_2D&&this.bondNumber==1};this.getImplicitHydrogenCount=function(){if(this.label=="H"||c[this.label]==null)return 0;var f=c[this.label].valency,l=f-this.coordinationNumber;if(this.charge>0){f=4-f;if(this.charge<=f)l+=this.charge;
else l=4-this.coordinationNumber-this.charge+f}else l+=this.charge;return l<0?0:l};return true};h.Atom.prototype=new h.Point(0,0)})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4);
(function(c,a,h,b,g,d){h.Bond=function(k,e,j){this.a1=k;this.a2=e;this.bondOrder=j?j:1;this.stereo=h.Bond.STEREO_NONE;this.isHover=false;this.ring=null;this.getCenter=function(){return new h.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};this.getLength=function(){return this.a1.distance(this.a2)};this.getLength3D=function(){return this.a1.distance3D(this.a2)};this.contains=function(f){return f==this.a1||f==this.a2};this.getNeighbor=function(f){if(f==this.a1)return this.a2;else if(f==this.a2)return this.a1;
return null};this.draw=function(f,l){var m=this.a1.x,n=this.a2.x,r=this.a1.y,p=this.a2.y,u=n-m,q=p-r;if(l.atoms_display&&!l.atoms_circles_2D&&this.a1.isLabelVisible(l)){m+=u*l.bonds_atomLabelBuffer_2D;r+=q*l.bonds_atomLabelBuffer_2D}if(l.atoms_display&&!l.atoms_circles_2D&&this.a2.isLabelVisible(l)){n-=u*l.bonds_atomLabelBuffer_2D;p-=q*l.bonds_atomLabelBuffer_2D}if(l.bonds_clearOverlaps_2D){var t=m+u*0.15,x=r+q*0.15,v=n-u*0.15,z=p-q*0.15;f.strokeStyle=l.backgroundColor;f.lineWidth=l.bonds_width_2D+
l.bonds_overlapClearWidth_2D*2;f.lineCap="round";f.beginPath();f.moveTo(t,x);f.lineTo(v,z);f.closePath();f.stroke()}f.strokeStyle=l.bonds_color;f.fillStyle=l.bonds_color;f.lineWidth=l.bonds_width_2D;f.lineCap=l.bonds_ends_2D;if(l.bonds_useJMOLColors){t=f.createLinearGradient(m,r,n,p);t.addColorStop(0,c[this.a1.label].jmolColor);t.addColorStop(1,c[this.a2.label].jmolColor);f.strokeStyle=t;f.fillStyle=t}switch(this.bondOrder){case 0.5:f.beginPath();f.moveTo(m,r);a.contextHashTo(f,m,r,n,p,l.bonds_hashSpacing_2D,
l.bonds_hashSpacing_2D);f.stroke();break;case 1:if(this.stereo==h.Bond.STEREO_PROTRUDING||this.stereo==h.Bond.STEREO_RECESSED){var w=l.bonds_width_2D/2;q=this.a1.distance(this.a2)*l.bonds_wedgeThickness_2D/2;t=this.a1.angle(this.a2)+b.PI/2;x=b.cos(t);t=b.sin(t);u=m-x*w;v=r+t*w;z=m+x*w;w=r-t*w;var B=n+x*q,C=p-t*q;x=n-x*q;t=p+t*q;f.beginPath();f.moveTo(u,v);f.lineTo(z,w);f.lineTo(B,C);f.lineTo(x,t);f.closePath();if(this.stereo==h.Bond.STEREO_PROTRUDING)f.fill();else{f.save();f.clip();f.lineWidth=q*
2;f.lineCap="butt";f.beginPath();f.moveTo(m,r);a.contextHashTo(f,m,r,n,p,l.bonds_hashWidth_2D,l.bonds_hashSpacing_2D);f.stroke();f.restore()}}else if(this.stereo==h.Bond.STEREO_AMBIGUOUS){f.beginPath();f.moveTo(m,r);p=b.floor(b.sqrt(u*u+q*q)/l.bonds_wavyLength_2D);m=m;r=r;t=this.a1.angle(this.a2)+b.PI/2;x=b.cos(t);t=b.sin(t);n=u/p;q=q/p;for(B=0;B<p;B++){m+=n;r+=q;u=l.bonds_wavyLength_2D*x+m-n*0.5;z=l.bonds_wavyLength_2D*-t+r-q*0.5;v=l.bonds_wavyLength_2D*-x+m-n*0.5;w=l.bonds_wavyLength_2D*t+r-q*0.5;
B%2==0?f.quadraticCurveTo(u,z,m,r):f.quadraticCurveTo(v,w,m,r)}f.stroke();break}else{f.beginPath();f.moveTo(m,r);f.lineTo(n,p);f.stroke()}break;case 1.5:f.beginPath();f.moveTo(m,r);f.lineTo(n,p);f.stroke();break;case 2:if(this.stereo==h.Bond.STEREO_AMBIGUOUS){q=this.a1.distance(this.a2)*l.bonds_saturationWidth_2D/2;t=this.a1.angle(this.a2)+b.PI/2;u=m-b.cos(t)*q;v=r+b.sin(t)*q;z=m+b.cos(t)*q;w=r-b.sin(t)*q;B=n+b.cos(t)*q;C=p-b.sin(t)*q;x=n-b.cos(t)*q;t=p+b.sin(t)*q;f.beginPath();f.moveTo(u,v);f.lineTo(B,
C);f.moveTo(z,w);f.lineTo(x,t);f.stroke()}else if(!l.bonds_symmetrical_2D&&(this.ring!=null||this.a1.label=="C"&&this.a2.label=="C")){f.beginPath();f.moveTo(m,r);f.lineTo(n,p);x=0;v=this.a1.distance(this.a2);u=this.a1.angle(this.a2);t=u+b.PI/2;q=v*l.bonds_saturationWidth_2D;z=l.bonds_saturationAngle_2D;if(z<b.PI/2)x=-(q/b.tan(z));if(b.abs(x)<v/2){z=m-b.cos(u)*x;m=n+b.cos(u)*x;n=r+b.sin(u)*x;r=p-b.sin(u)*x;u=z-b.cos(t)*q;v=n+b.sin(t)*q;z=z+b.cos(t)*q;w=n-b.sin(t)*q;B=m-b.cos(t)*q;C=r+b.sin(t)*q;x=
m+b.cos(t)*q;t=r-b.sin(t)*q;if(this.ring==null||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>b.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-b.PI){f.moveTo(u,v);f.lineTo(B,C)}else{f.moveTo(z,w);f.lineTo(x,t)}f.stroke()}}else{q=this.a1.distance(this.a2)*l.bonds_saturationWidth_2D/2;t=this.a1.angle(this.a2)+b.PI/2;u=m-b.cos(t)*q;v=r+b.sin(t)*q;z=m+b.cos(t)*q;w=r-b.sin(t)*q;B=n+b.cos(t)*q;C=
p-b.sin(t)*q;x=n-b.cos(t)*q;t=p+b.sin(t)*q;f.beginPath();f.moveTo(u,v);f.lineTo(x,t);f.moveTo(z,w);f.lineTo(B,C);f.stroke()}break;case 3:q=this.a1.distance(this.a2)*l.bonds_saturationWidth_2D;t=this.a1.angle(this.a2)+b.PI/2;u=m-b.cos(t)*q;v=r+b.sin(t)*q;z=m+b.cos(t)*q;w=r-b.sin(t)*q;B=n+b.cos(t)*q;C=p-b.sin(t)*q;x=n-b.cos(t)*q;t=p+b.sin(t)*q;f.beginPath();f.moveTo(u,v);f.lineTo(x,t);f.moveTo(z,w);f.lineTo(B,C);f.moveTo(m,r);f.lineTo(n,p);f.stroke();break}};this.drawDecorations=function(f){if(this.isHover||
this.isSelected){var l=2*b.PI,m=(this.a1.angleForStupidCanvasArcs(this.a2)+b.PI/2)%l;f.strokeStyle=this.isHover?"#885110":"#0060B2";f.lineWidth=1.2;f.beginPath();var n=(m+b.PI)%l;n%=b.PI*2;f.arc(this.a1.x,this.a1.y,7,m,n,false);f.stroke();f.beginPath();m+=b.PI;n=(m+b.PI)%l;f.arc(this.a2.x,this.a2.y,7,m,n,false);f.stroke()}};this.render=function(f,l){var m=1.001*this.a1.distance3D(this.a2)/(l.bonds_useJMOLColors?2:1);if(m==0)return false;m=[l.bonds_cylinderDiameter_3D/2,m,l.bonds_cylinderDiameter_3D/
2];var n=g.translate(f.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),r=null,p=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];if(l.bonds_useJMOLColors){d.scale(p,0.5);r=g.translate(f.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[])}var u=[0],q=null;if(l.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:u=[-l.bonds_cylinderDiameter_3D,l.bonds_cylinderDiameter_3D];break;case 3:u=[-1.2*l.bonds_cylinderDiameter_3D,0,1.2*l.bonds_cylinderDiameter_3D];break}if(u.length>1){q=[0,
0,1];var t=g.inverse(f.rotationMatrix,[]);g.multiplyVec3(t,q);q=d.cross(p,q,[]);d.normalize(q)}}var x=[0,1,0];t=0;var v=null;if(this.a1.x==this.a2.x&&this.a1.z==this.a2.z){v=[0,0,1];if(this.a2.y<this.a1.y)t=b.PI}else{t=a.vec3AngleFrom(x,p);v=d.cross(x,p,[])}p=0;for(x=u.length;p<x;p++){var z=g.set(n,[]);u[p]!=0&&g.translate(z,d.scale(q,u[p],[]));t!=0&&g.rotate(z,t,v);g.scale(z,m);f.material.setDiffuseColor(f,l.bonds_useJMOLColors?c[this.a1.label].jmolColor:l.bonds_color);f.setMatrixUniforms(z);f.drawArrays(f.TRIANGLE_STRIP,
0,f.cylinderBuffer.vertexPositionBuffer.numItems);if(l.bonds_useJMOLColors){g.set(r,z);u[p]!=0&&g.translate(z,d.scale(q,u[p],[]));g.rotate(z,t+b.PI,v);g.scale(z,m);f.material.setDiffuseColor(f,c[this.a2.label].jmolColor);f.setMatrixUniforms(z);f.drawArrays(f.TRIANGLE_STRIP,0,f.cylinderBuffer.vertexPositionBuffer.numItems)}}};return true};h.Bond.STEREO_NONE="none";h.Bond.STEREO_PROTRUDING="protruding";h.Bond.STEREO_RECESSED="recessed";h.Bond.STEREO_AMBIGUOUS="ambiguous"})(ChemDoodle.ELEMENT,ChemDoodle.extensions,
ChemDoodle.structures,Math,mat4,vec3);
(function(c,a){c.Ring=function(){this.atoms=[];this.bonds=[];this.center=null;this.setupBonds=function(){for(var h=0,b=this.bonds.length;h<b;h++)this.bonds[h].ring=this;this.center=this.getCenter()};this.getCenter=function(){for(var h=minY=Infinity,b=maxY=-Infinity,g=0,d=this.atoms.length;g<d;g++){h=a.min(this.atoms[g].x,h);minY=a.min(this.atoms[g].y,minY);b=a.max(this.atoms[g].x,b);maxY=a.max(this.atoms[g].y,maxY)}return new c.Point((b+h)/2,(maxY+minY)/2)};return true}})(ChemDoodle.structures,Math);
(function(c,a,h){a.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[];this.findRings=true;this.draw=function(b,g){if(g.bonds_display)for(var d=0,k=this.bonds.length;d<k;d++)this.bonds[d].draw(b,g);if(g.atoms_display){d=0;for(k=this.atoms.length;d<k;d++)this.atoms[d].draw(b,g)}};this.render=function(b,g){if(g.bonds_display){if(this.bonds.length>0){b.bindBuffer(b.ARRAY_BUFFER,b.cylinderBuffer.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,b.cylinderBuffer.vertexPositionBuffer.itemSize,
b.FLOAT,false,0,0);b.bindBuffer(b.ARRAY_BUFFER,b.cylinderBuffer.vertexNormalBuffer);b.vertexAttribPointer(b.shader.vertexNormalAttribute,b.cylinderBuffer.vertexNormalBuffer.itemSize,b.FLOAT,false,0,0);b.material.setTempColors(b,g.bonds_materialAmbientColor_3D,null,g.bonds_materialSpecularColor_3D,g.bonds_materialShininess_3D)}for(var d=0,k=this.bonds.length;d<k;d++)this.bonds[d].render(b,g)}if(g.atoms_display){if(this.atoms.length>0){b.bindBuffer(b.ARRAY_BUFFER,b.sphereBuffer.vertexPositionBuffer);
b.vertexAttribPointer(b.shader.vertexPositionAttribute,b.sphereBuffer.vertexPositionBuffer.itemSize,b.FLOAT,false,0,0);b.bindBuffer(b.ARRAY_BUFFER,b.sphereBuffer.vertexNormalBuffer);b.vertexAttribPointer(b.shader.vertexNormalAttribute,b.sphereBuffer.vertexNormalBuffer.itemSize,b.FLOAT,false,0,0);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,b.sphereBuffer.vertexIndexBuffer);b.material.setTempColors(b,g.atoms_materialAmbientColor_3D,null,g.atoms_materialSpecularColor_3D,g.atoms_materialShininess_3D)}d=0;for(k=
this.atoms.length;d<k;d++)this.atoms[d].render(b,g)}if(g.ribbons_display&&this.chains){b.setMatrixUniforms(b.modelViewMatrix);b.material.setTempColors(b,g.ribbons_materialAmbientColor_3D,null,g.ribbons_materialSpecularColor_3D,g.bonds_materialShininess_3D);for(var e=0,j=this.chains.length;e<j;e++)if(g.ribbons_useShapelyColors||g.ribbons_useAminoColors){var f=g.ribbons_cartoonize?this.cartoons[e]:this.ribbons[e];b.bindBuffer(b.ARRAY_BUFFER,f.front.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,
f.front.vertexPositionBuffer.itemSize,b.FLOAT,false,0,0);b.bindBuffer(b.ARRAY_BUFFER,f.front.vertexNormalBuffer);b.vertexAttribPointer(b.shader.vertexNormalAttribute,f.front.vertexNormalBuffer.itemSize,b.FLOAT,false,0,0);d=0;for(k=f.front.segments.length;d<k;d++)f.front.segments[d].render(b,g);b.bindBuffer(b.ARRAY_BUFFER,f.back.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,f.back.vertexPositionBuffer.itemSize,b.FLOAT,false,0,0);b.bindBuffer(b.ARRAY_BUFFER,f.back.vertexNormalBuffer);
b.vertexAttribPointer(b.shader.vertexNormalAttribute,f.back.vertexNormalBuffer.itemSize,b.FLOAT,false,0,0);d=0;for(k=f.back.segments.length;d<k;d++)f.back.segments[d].render(b,g)}else if(g.ribbons_cartoonize){f=this.cartoons[e];b.bindBuffer(b.ARRAY_BUFFER,f.front.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,f.front.vertexPositionBuffer.itemSize,b.FLOAT,false,0,0);b.bindBuffer(b.ARRAY_BUFFER,f.front.vertexNormalBuffer);b.vertexAttribPointer(b.shader.vertexNormalAttribute,
f.front.vertexNormalBuffer.itemSize,b.FLOAT,false,0,0);d=0;for(k=f.front.cartoonSegments.length;d<k;d++)f.front.cartoonSegments[d].render(b,g);b.bindBuffer(b.ARRAY_BUFFER,f.back.vertexPositionBuffer);b.vertexAttribPointer(b.shader.vertexPositionAttribute,f.back.vertexPositionBuffer.itemSize,b.FLOAT,false,0,0);b.bindBuffer(b.ARRAY_BUFFER,f.back.vertexNormalBuffer);b.vertexAttribPointer(b.shader.vertexNormalAttribute,f.back.vertexNormalBuffer.itemSize,b.FLOAT,false,0,0);d=0;for(k=f.back.cartoonSegments.length;d<
k;d++)f.back.cartoonSegments[d].render(b,g)}else{f=this.ribbons[e];f.front.render(b,g);f.back.render(b,g)}}};this.getCenter3D=function(){if(this.atoms.length==1)return new a.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var b=minY=minZ=Infinity,g=maxY=maxZ=-Infinity;if(this.atoms.length==0&&this.chains.length>0)for(var d=0,k=this.chains.length;d<k;d++)for(var e=this.chains[d],j=0,f=e.length;j<f;j++){var l=e[j];b=h.min(l.alphaCarbon.x,b);minY=h.min(l.alphaCarbon.y,minY);minZ=h.min(l.alphaCarbon.z,
minZ);g=h.max(l.alphaCarbon.x,g);maxY=h.max(l.alphaCarbon.y,maxY);maxZ=h.max(l.alphaCarbon.z,maxZ);b=h.min(l.carbonylOxygen.x,b);minY=h.min(l.carbonylOxygen.y,minY);minZ=h.min(l.carbonylOxygen.z,minZ);g=h.max(l.carbonylOxygen.x,g);maxY=h.max(l.carbonylOxygen.y,maxY);maxZ=h.max(l.carbonylOxygen.z,maxZ)}else{d=0;for(k=this.atoms.length;d<k;d++){b=h.min(this.atoms[d].x,b);minY=h.min(this.atoms[d].y,minY);minZ=h.min(this.atoms[d].z,minZ);g=h.max(this.atoms[d].x,g);maxY=h.max(this.atoms[d].y,maxY);maxZ=
h.max(this.atoms[d].z,maxZ)}}return new a.Atom("C",(g+b)/2,(maxY+minY)/2,(maxZ+minZ)/2)};this.getCenter=function(){if(this.atoms.length==1)return new a.Point(this.atoms[0].x,this.atoms[0].y);for(var b=minY=Infinity,g=maxY=-Infinity,d=0,k=this.atoms.length;d<k;d++){b=h.min(this.atoms[d].x,b);minY=h.min(this.atoms[d].y,minY);g=h.max(this.atoms[d].x,g);maxY=h.max(this.atoms[d].y,maxY)}return new a.Point((g+b)/2,(maxY+minY)/2)};this.getDimension=function(){if(this.atoms.length==1)return new a.Point(0,
0);var b=minY=Infinity,g=maxY=-Infinity;if(this.atoms.length==0&&this.chains.length>0)for(var d=0,k=this.chains.length;d<k;d++)for(var e=this.chains[d],j=0,f=e.length;j<f;j++){var l=e[j];b=h.min(l.alphaCarbon.x,b);minY=h.min(l.alphaCarbon.y,minY);g=h.max(l.alphaCarbon.x,g);maxY=h.max(l.alphaCarbon.y,maxY);b=h.min(l.carbonylOxygen.x,b);minY=h.min(l.carbonylOxygen.y,minY);g=h.max(l.carbonylOxygen.x,g);maxY=h.max(l.carbonylOxygen.y,maxY)}else{d=0;for(k=this.atoms.length;d<k;d++){b=h.min(this.atoms[d].x,
b);minY=h.min(this.atoms[d].y,minY);g=h.max(this.atoms[d].x,g);maxY=h.max(this.atoms[d].y,maxY)}}return new a.Point(g-b,maxY-minY)};this.check=function(){for(var b=0,g=this.atoms.length;b<g;b++){this.atoms[b].isLone=false;if(this.atoms[b].label=="C"){for(var d=0,k=0,e=this.bonds.length;k<e;k++)if(this.bonds[k].a1==this.atoms[b]||this.bonds[k].a2==this.atoms[b])d++;if(d==0)this.atoms[b].isLone=true}}if(this.findRings){this.rings=(new c.informatics.SSSRFinder(this)).rings;b=0;for(g=this.bonds.length;b<
g;b++)this.bonds[b].ring=null;b=0;for(g=this.rings.length;b<g;b++)this.rings[b].setupBonds()}d=false;b=0;for(g=this.atoms.length;b<g;b++)if(this.atoms[b].z!=0)d=true;if(d){this.sortAtomsByZ();this.sortBondsByZ()}this.setupMetaData()};this.getAngles=function(b){for(var g=[],d=0,k=this.bonds.length;d<k;d++)this.bonds[d].contains(b)&&g.push(b.angle(this.bonds[d].getNeighbor(b)));g.sort();return g};this.getCoordinationNumber=function(b){for(var g=0,d=0,k=b.length;d<k;d++)g+=b[d].bondOrder;return g};this.getBonds=
function(b){for(var g=[],d=0,k=this.bonds.length;d<k;d++)this.bonds[d].contains(b)&&g.push(this.bonds[d]);return g};this.sortAtomsByZ=function(){for(var b=1,g=this.atoms.length;b<g;b++)for(var d=b;d>0&&this.atoms[d].z<this.atoms[d-1].z;){var k=this.atoms[d];this.atoms[d]=this.atoms[d-1];this.atoms[d-1]=k;d--}};this.sortBondsByZ=function(){for(var b=1,g=this.bonds.length;b<g;b++)for(var d=b;d>0&&this.bonds[d].a1.z+this.bonds[d].a2.z<this.bonds[d-1].a1.z+this.bonds[d-1].a2.z;){var k=this.bonds[d];this.bonds[d]=
this.bonds[d-1];this.bonds[d-1]=k;d--}};this.setupMetaData=function(){for(var b=0,g=this.atoms.length;b<g;b++){var d=this.atoms[b],k=this.getBonds(d),e=this.getAngles(d);d.isHidden=k.length==2&&h.abs(h.abs(e[1]-e[0])-h.PI)<h.PI/30&&k[0].bondOrder==k[1].bondOrder;d.angleOfLeastInterference=c.math.angleBetweenLargest(e)%(h.PI*2);d.coordinationNumber=this.getCoordinationNumber(k);d.bondNumber=k.length}};this.scaleToAverageBondLength=function(b){var g=this.getAverageBondLength();if(g!=0){b=b/g;g=0;for(var d=
this.atoms.length;g<d;g++){this.atoms[g].x*=b;this.atoms[g].y*=b}}};this.getAverageBondLength=function(){if(this.bonds.length==0)return 0;for(var b=0,g=0,d=this.bonds.length;g<d;g++)b+=this.bonds[g].getLength();b/=this.bonds.length;return b};return true}})(ChemDoodle,ChemDoodle.structures,Math);
(function(c,a,h,b){var g=[6/a.pow(10,3),0,0,0,6/a.pow(10,3),2/a.pow(10,2),0,0,1/a.pow(10,3),1/a.pow(10,2),0.1,0,0,0,0,1],d=h.multiply([-1/6,0.5,-0.5,1/6,0.5,-1,0.5,0,-0.5,0,0.5,0,1/6,2/3,1/6,0],g,[]);c.Residue=function(k){this.alphaCarbon=k;this.setup=function(e){var j=[e.x-this.alphaCarbon.x,e.y-this.alphaCarbon.y,e.z-this.alphaCarbon.z],f=b.cross(j,[this.carbonylOxygen.x-this.alphaCarbon.x,this.carbonylOxygen.y-this.alphaCarbon.y,this.carbonylOxygen.z-this.alphaCarbon.z],[]);this.D=b.cross(f,j,
[]);b.normalize(f);b.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=[];e=[(e.x+this.alphaCarbon.x)/2,(e.y+this.alphaCarbon.y)/2,(e.z+this.alphaCarbon.z)/2];if(this.helix){b.scale(f,1.5);b.add(e,f)}this.guidePointsSmall[0]=new c.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2);for(f=1;f<9;f++)this.guidePointsSmall[f]=new c.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/9,this.guidePointsSmall[0].y+this.D[1]*f/9,this.guidePointsSmall[0].z+this.D[2]*f/9);b.scale(this.D,4);
this.guidePointsLarge[0]=new c.Atom("",e[0]-this.D[0]/2,e[1]-this.D[1]/2,e[2]-this.D[2]/2);for(f=1;f<9;f++)this.guidePointsLarge[f]=new c.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/9,this.guidePointsLarge[0].y+this.D[1]*f/9,this.guidePointsLarge[0].z+this.D[2]*f/9)};this.getGuidePointSet=function(e){if(e==0)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;else if(e==1)return this.guidePointsSmall;else if(e==2)return this.guidePointsLarge};this.computeLineSegments=function(e,
j,f){this.split=j.helix!=this.helix||j.sheet!=this.sheet;this.lineSegments=this.innerCompute(0,e,j,f,false);this.lineSegmentsCartoon=this.innerCompute(j.helix||j.sheet?2:1,e,j,f,true)};this.innerCompute=function(e,j,f,l,m){var n=[],r=this.getGuidePointSet(e);j=j.getGuidePointSet(e);f=f.getGuidePointSet(e);for(var p=l.getGuidePointSet(e),u=0,q=this.guidePointsLarge.length;u<q;u++){for(var t=h.multiply([j[u].x,j[u].y,j[u].z,1,r[u].x,r[u].y,r[u].z,1,f[u].x,f[u].y,f[u].z,1,p[u].x,p[u].y,p[u].z,1],d,[]),
x=[],v=0;v<10;v++){for(e=3;e>0;e--)for(l=0;l<4;l++)t[e*4+l]+=t[(e-1)*4+l];x[v]=new c.Atom("",t[12]/t[15],t[13]/t[15],t[14]/t[15])}n[u]=x}if(m&&this.arrow)for(e=0;e<10;e++){m=1.5-1.3*e/10;r=a.floor(4.5);j=n[r];l=0;for(f=n.length;l<f;l++)if(l!=r){p=j[e];u=n[l][e];q=[u.x-p.x,u.y-p.y,u.z-p.z];b.scale(q,m);u.x=p.x+q[0];u.y=p.y+q[1];u.z=p.z+q[2]}}return n}}})(ChemDoodle.structures,Math,mat4,vec3);
(function(c,a,h,b,g){a.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.yUnit=this.xUnit=this.title=null;this.continuous=true;this.integrationSensitivity=0.01;var d=0,k=false;this.draw=function(e,j,f,l){var m=5,n=0,r=0;e.fillStyle=j.text_color;e.textAlign="center";e.textBaseline="alphabetic";e.font=j.getFontString(j.text_font_size,j.text_font_families);if(this.xUnit){r+=j.text_font_size;e.fillText(this.xUnit,f/2,l-2)}if(this.yUnit&&j.plots_showYAxis){n+=j.text_font_size;
e.save();e.translate(j.text_font_size,l/2);e.rotate(-g.PI/2);e.fillText(this.yUnit,0,0);e.restore()}if(this.title!=null){m+=j.text_font_size;e.fillText(this.title,f/2,j.text_font_size)}r+=5+j.text_font_size;if(j.plots_showYAxis)n+=5+e.measureText("1000").width;if(j.plots_showGrid){e.strokeStyle=j.plots_gridColor;e.lineWidth=j.plots_gridLineWidth;e.strokeRect(n,m,f-n,l-r-m)}e.textAlign="center";e.textBaseline="top";for(var p=this.maxX-this.minX,u=p/100,q=0.0010;q<u||p/q>25;)q*=10;var t=0,x=j.plots_flipXAxis?
f:0;for(p=g.round(this.minX/q)*q;p<=this.maxX;p+=q/2){u=this.getTransformedX(p,j,f,n);if(u>n){e.strokeStyle="black";e.lineWidth=1;if(t%2==0){e.beginPath();e.moveTo(u,l-r);e.lineTo(u,l-r+2);e.stroke();for(var v=p.toFixed(5);v.charAt(v.length-1)=="0";)v=v.substring(0,v.length-1);if(v.charAt(v.length-1)==".")v=v.substring(0,v.length-1);var z=e.measureText(v).width;if(j.plots_flipXAxis)z*=-1;var w=u-z/2;if(j.plots_flipXAxis?w<x:w>x){e.fillText(v,u,l-r+2);x=u+z/2}if(j.plots_showGrid){e.strokeStyle=j.plots_gridColor;
e.lineWidth=j.plots_gridLineWidth;e.beginPath();e.moveTo(u,l-r);e.lineTo(u,m);e.stroke()}}else{e.beginPath();e.moveTo(u,l-r);e.lineTo(u,l-r+2);e.stroke()}}t++}if(j.plots_showYAxis||j.plots_showGrid){u=1/j.scale;e.textAlign="right";e.textBaseline="middle";for(p=0;p<=10;p++){v=u/10*p;q=m+(l-r-m)*(1-v*j.scale);if(j.plots_showGrid){e.strokeStyle=j.plots_gridColor;e.lineWidth=j.plots_gridLineWidth;e.beginPath();e.moveTo(n,q);e.lineTo(f,q);e.stroke()}if(j.plots_showYAxis){e.strokeStyle="black";e.lineWidth=
1;e.beginPath();e.moveTo(n,q);e.lineTo(n-3,q);e.stroke();v=v*100;t=g.max(0,3-g.floor(v).toString().length);v=v.toFixed(t);if(t>0)for(;v.charAt(v.length-1)=="0";)v=v.substring(0,v.length-1);if(v.charAt(v.length-1)==".")v=v.substring(0,v.length-1);e.fillText(v,n-3,q)}}}e.strokeStyle="black";e.lineWidth=1;e.beginPath();e.moveTo(f,l-r);e.lineTo(n,l-r);j.plots_showYAxis&&e.lineTo(n,m);e.stroke();if(this.dataDisplay.length>0){e.textAlign="left";e.textBaseline="top";p=u=0;for(v=this.dataDisplay.length;p<
v;p++)if(this.dataDisplay[p].value){e.fillText([this.dataDisplay[p].display,": ",this.dataDisplay[p].value].join(""),n+10,m+10+u*(j.text_font_size+5));u++}else if(this.dataDisplay[p].tag){q=0;for(t=this.metadata.length;q<t;q++)if(c.stringStartsWith(this.metadata[q],this.dataDisplay[p].tag)){t=this.metadata[q];if(this.dataDisplay[p].display){t=b.inArray("=",this.metadata[q]);t=[this.dataDisplay[p].display,": ",t>-1?this.metadata[q].substring(t+2):this.metadata[q]].join("")}e.fillText(t,n+10,m+10+u*
(j.text_font_size+5));u++;break}}}e.strokeStyle=j.plots_color;e.lineWidth=j.plots_width;t=[];e.beginPath();if(this.continuous){x=false;p=0;for(v=this.data.length;p<v;p++){u=this.getTransformedX(this.data[p].x,j,f,n);if(u>=n&&u<f){q=this.getTransformedY(this.data[p].y,j,l,r,m);j.plots_showIntegration&&g.abs(this.data[p].y)>this.integrationSensitivity&&t.push(new a.Point(this.data[p].x,this.data[p].y));if(!x){e.moveTo(u,q);x=true}e.lineTo(u,q)}else if(x)break}}else{p=0;for(v=this.data.length;p<v;p++){u=
this.getTransformedX(this.data[p].x,j,f,n);if(u>=n&&u<f){e.moveTo(u,l-r);e.lineTo(u,this.getTransformedY(this.data[p].y,j,l,r,m))}}}e.stroke();if(j.plots_showIntegration&&t.length>1){e.strokeStyle=j.plots_integrationColor;e.lineWidth=j.plots_integrationLineWidth;e.beginPath();p=t[1].x>t[0].x;if(this.flipXAxis&&!p||!this.flipXAxis&&p){for(p=t.length-2;p>=0;p--)t[p].y+=t[p+1].y;x=t[0].y}else{p=1;for(v=t.length;p<v;p++)t[p].y+=t[p-1].y;x=t[t.length-1].y}p=0;for(v=t.length;p<v;p++){u=this.getTransformedX(t[p].x,
j,f,n);q=this.getTransformedY(t[p].y/j.scale/x,j,l,r,m);p==0?e.moveTo(u,q):e.lineTo(u,q)}e.stroke()}d=n;k=j.plots_flipXAxis};this.getTransformedY=function(e,j,f,l,m){return m+(f-l-m)*(1-e*j.scale)};this.getTransformedX=function(e,j,f,l){e=l+(e-this.minX)/(this.maxX-this.minX)*(f-l);if(j.plots_flipXAxis)e=f+l-e;return e};this.getInverseTransformedX=function(e,j,f){if(k)e=j+f-e;return(e-f)*(this.maxX-this.minX)/(j-f)+this.minX};this.setup=function(){for(var e=Number.MAX_VALUE,j=Number.MIN_VALUE,f=Number.MIN_VALUE,
l=0,m=this.data.length;l<m;l++){e=g.min(e,this.data[l].x);j=g.max(j,this.data[l].x);f=g.max(f,this.data[l].y)}if(this.continuous){this.minX=e;this.maxX=j}else{this.minX=e-1;this.maxX=j+1}l=0;for(m=this.data.length;l<m;l++)this.data[l].y/=f};this.zoom=function(e,j,f,l){e=this.getInverseTransformedX(e,f,d);j=this.getInverseTransformedX(j,f,d);this.minX=g.min(e,j);this.maxX=g.max(e,j);if(l){l=Number.MIN_VALUE;j=0;for(f=this.data.length;j<f;j++)if(h.isBetween(this.data[j].x,this.minX,this.maxX))l=g.max(l,
this.data[j].y);return 1/l}};this.translate=function(e,j){var f=e/(j-d)*(this.maxX-this.minX)*(k?1:-1);this.minX+=f;this.maxX+=f};this.alertMetadata=function(){alert(this.metadata.join("\n"))};return true}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math);
(function(c){c.Cube=function(a){this.vertexPositionBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer);vertices=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];a.bufferData(a.ARRAY_BUFFER,new Float32Array(vertices),a.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=24;this.vertexColorBuffer=a.createBuffer();
a.bindBuffer(a.ARRAY_BUFFER,this.vertexColorBuffer);var h=[[1,0,0,1],[1,1,0,1],[0,1,0,1],[1,0.5,0.5,1],[1,0,1,1],[0,0,1,1]],b=[];for(var g in h)for(var d=h[g],k=0;k<4;k++)b=b.concat(d);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);this.vertexColorBuffer.itemSize=4;this.vertexColorBuffer.numItems=24;this.vertexNormalBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer);a.bufferData(a.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,
0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),a.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=24;this.vertexIndexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),a.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=
36;return true}})(ChemDoodle.structures);
(function(c,a){c.Cylinder=function(h,b,g,d){for(var k=[],e=[],j=0;j<d;j++){var f=j*2*a.PI/d,l=a.cos(f);f=a.sin(f);e.push(l,0,f);k.push(b*l,0,b*f);e.push(l,0,f);k.push(b*l,g,b*f)}e.push(1,0,0);k.push(b,0,0);e.push(1,0,0);k.push(b,g,0);this.vertexNormalBuffer=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,this.vertexNormalBuffer);h.bufferData(h.ARRAY_BUFFER,new Float32Array(e),h.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=e.length/3;this.vertexPositionBuffer=h.createBuffer();
h.bindBuffer(h.ARRAY_BUFFER,this.vertexPositionBuffer);h.bufferData(h.ARRAY_BUFFER,new Float32Array(k),h.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=k.length/3;return true}})(ChemDoodle.structures,Math);
(function(c,a){c.Sphere=function(h,b,g,d){for(var k=[],e=[],j=0;j<=g;j++){var f=j*a.PI/g,l=a.sin(f),m=a.cos(f);for(f=0;f<=d;f++){var n=f*2*a.PI/d,r=a.sin(n);n=a.cos(n)*l;var p=m;r=r*l;e.push(n);e.push(p);e.push(r);k.push(b*n);k.push(b*p);k.push(b*r)}}b=[];d+=1;for(j=0;j<g;j++)for(f=0;f<d;f++){l=j*d+f%d;m=l+d;b.push(l);b.push(m);b.push(l+1);if(f<d-1){b.push(m);b.push(m+1);b.push(l+1)}}this.vertexNormalBuffer=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,this.vertexNormalBuffer);h.bufferData(h.ARRAY_BUFFER,
new Float32Array(e),h.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=e.length/3;this.vertexPositionBuffer=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,this.vertexPositionBuffer);h.bufferData(h.ARRAY_BUFFER,new Float32Array(k),h.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=k.length/3;this.vertexIndexBuffer=h.createBuffer();h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);h.bufferData(h.ELEMENT_ARRAY_BUFFER,new Uint16Array(b),
h.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=b.length;return true}})(ChemDoodle.structures,Math);
(function(c,a,h,b){function g(d,k,e,j){this.name=e;this.entire=k;this.vertexIndexBuffer=d.createBuffer();d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);d.bufferData(d.ELEMENT_ARRAY_BUFFER,new Uint16Array(j),d.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=j.length;this.getColor=function(f){return this.name?c[this.name]==null?f.ribbons_useShapelyColors?c["*"].shapelyColor:c["*"].aminoColor:f.ribbons_useShapelyColors?c[this.name].shapelyColor:c[this.name].aminoColor:
this.helix?k.front?f.ribbons_cartoonHelixFrontColor:f.ribbons_cartoonHelixBackColor:this.sheet?f.ribbons_cartoonSheetColor:k.front?f.ribbons_frontColor:f.ribbons_backColor};this.render=function(f,l){f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);f.material.setDiffuseColor(f,this.getColor(l));f.drawElements(f.TRIANGLES,this.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0)}}a.Ribbon=function(d,k,e,j){var f=k[0].lineSegments.length,l=k[0].lineSegments[0].length,m=[],n=[];this.front=true;for(var r=
0,p=k.length-1;r<p;r++)for(var u=k[r],q=0;q<f;q++)for(var t=j?u.lineSegmentsCartoon[q]:u.lineSegments[q],x=0;x<l;x++){var v=t[x],z=r,w=x+1;if(r==k.length-2&&x==l-1)w--;else if(x==l-1){z++;w=0}w=j?k[z].lineSegmentsCartoon[q][w]:k[z].lineSegments[q][w];z=false;var B=q+1;if(q==f-1){B-=2;z=true}B=j?u.lineSegmentsCartoon[B][x]:u.lineSegments[B][x];w=b.cross([w.x-v.x,w.y-v.y,w.z-v.z],[B.x-v.x,B.y-v.y,B.z-v.z],[]);b.normalize(w);z&&b.scale(w,-1);if(e<0){this.front=false;b.scale(w,-1)}n.push(w[0]);n.push(w[1]);
n.push(w[2]);b.scale(w,h.abs(e));m.push(v.x+w[0]);m.push(v.y+w[1]);m.push(v.z+w[2])}this.segments=[];var C;if(j){this.cartoonSegments=[];C=[]}e=[];r=0;for(p=k.length-1;r<p;r++){if(r>0&&C)if(k[r].split){q=new g(d,this,null,C);if(k[r].helix)q.helix=true;if(k[r].sheet)q.sheet=true;this.cartoonSegments.push(q);C=[]}j=r*f*l;u=[];q=0;for(t=f-1;q<t;q++){v=j+q*l;for(x=0;x<l;x++){z=1;if(r==k.length-2)z=0;else if(x==l-1)z=f*l-x;z=[v+x,v+l+x,v+l+x+z,v+x,v+x+z,v+l+x+z];for(w=0;w<6;w++)e.push(z[w]);if(x!=l-1)for(w=
0;w<6;w++)u.push(z[w]);if(C)for(w=0;w<6;w++)C.push(z[w])}}this.segments.push(new g(d,this,k[r+1].name,u))}C&&this.cartoonSegments.push(new g(d,this,null,C));this.vertexNormalBuffer=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,this.vertexNormalBuffer);d.bufferData(d.ARRAY_BUFFER,new Float32Array(n),d.STATIC_DRAW);this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=n.length/3;this.vertexPositionBuffer=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,this.vertexPositionBuffer);d.bufferData(d.ARRAY_BUFFER,
new Float32Array(m),d.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=m.length/3;this.vertexIndexBuffer=d.createBuffer();d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);d.bufferData(d.ELEMENT_ARRAY_BUFFER,new Uint16Array(e),d.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=e.length;this.render=function(D,E){D.bindBuffer(D.ARRAY_BUFFER,this.vertexPositionBuffer);D.vertexAttribPointer(D.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,
D.FLOAT,false,0,0);D.bindBuffer(D.ARRAY_BUFFER,this.vertexNormalBuffer);D.vertexAttribPointer(D.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,D.FLOAT,false,0,0);D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);D.material.setDiffuseColor(D,this.front?E.ribbons_frontColor:E.ribbons_backColor);D.drawElements(D.TRIANGLES,this.vertexIndexBuffer.numItems,D.UNSIGNED_SHORT,0)};return true}})(ChemDoodle.RESIDUE,ChemDoodle.structures,Math,vec3);
(function(c,a,h){a.Light=function(b,g,d){this.diffuseRGB=c.getRGB(b,1);this.specularRGB=c.getRGB(g,1);this.direction=d;this.lightScene=function(k){k.uniform3f(k.getUniformLocation(k.program,"u_light.diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]);k.uniform3f(k.getUniformLocation(k.program,"u_light.specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var e=h.create(this.direction);h.normalize(e);h.negate(e);k.uniform3f(k.getUniformLocation(k.program,
"u_light.direction"),e[0],e[1],e[2]);var j=[0,0,0];e=[j[0]+e[0],j[1]+e[1],j[2]+e[2]];j=h.length(e);if(j==0)e=[0,0,1];else h.scale(1/j);k.uniform3f(k.getUniformLocation(k.program,"u_light.half_vector"),e[0],e[1],e[2])};return true}})(ChemDoodle.math,ChemDoodle.structures,vec3);
(function(c,a){a.Material=function(h){var b=h.getUniformLocation(h.program,"u_material.ambient_color"),g=h.getUniformLocation(h.program,"u_material.diffuse_color"),d=h.getUniformLocation(h.program,"u_material.specular_color"),k=h.getUniformLocation(h.program,"u_material.shininess");this.setTempColors=function(e,j,f,l,m){if(!this.aCache||this.aCache!=j){this.aCache=j;j=c.getRGB(j,1);e.uniform3f(b,j[0],j[1],j[2])}if(f!=null&&(!this.dCache||this.dCache!=f)){this.dCache=f;j=c.getRGB(f,1);e.uniform3f(g,
j[0],j[1],j[2])}if(!this.sCache||this.sCache!=l){this.sCache=l;j=c.getRGB(l,1);e.uniform3f(d,j[0],j[1],j[2])}if(!this.snCache||this.snCache!=m){this.snCache=m;e.uniform1f(k,m)}};this.setDiffuseColor=function(e,j){if(!this.dCache||this.dCache!=j){this.dCache=j;var f=c.getRGB(j,1);e.uniform3f(g,f[0],f[1],f[2])}};return true}})(ChemDoodle.math,ChemDoodle.structures);
(function(c,a){c.Shader=function(){this.init=function(h){var b=this.getShader(h,"vertex-shader");if(b==null)b=this.loadDefaultVertexShader(h);var g=this.getShader(h,"fragment-shader");if(g==null)g=this.loadDefaultFragmentShader(h);h.attachShader(h.program,b);h.attachShader(h.program,g);h.linkProgram(h.program);h.getProgramParameter(h.program,h.LINK_STATUS)||alert("Could not initialize shaders!");h.useProgram(h.program);this.vertexPositionAttribute=h.getAttribLocation(h.program,"a_vertex_position");
h.enableVertexAttribArray(this.vertexPositionAttribute);this.vertexNormalAttribute=h.getAttribLocation(h.program,"a_vertex_normal");h.enableVertexAttribArray(this.vertexNormalAttribute)};this.getShader=function(h,b){var g=a.getElementById(b);if(!g)return null;for(var d=[],k=g.firstChild;k;){k.nodeType==3&&d.push(k.textContent);k=k.nextSibling}if(g.type=="x-shader/x-fragment")g=h.createShader(h.FRAGMENT_SHADER);else if(g.type=="x-shader/x-vertex")g=h.createShader(h.VERTEX_SHADER);else return null;
h.shaderSource(g,d.join(""));h.compileShader(g);if(!h.getShaderParameter(g,h.COMPILE_STATUS)){alert(h.getShaderInfoLog(g));return null}return g};this.loadDefaultVertexShader=function(h){var b=[];b.push("#ifdef GL_ES\n");b.push("precision highp float;\n");b.push("#endif\n");b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");b.push("{");b.push("vec3 ambient_color;");
b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("float shininess;");b.push("};");b.push("attribute vec3 a_vertex_position;");b.push("attribute vec3 a_vertex_normal;");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("uniform mat4 u_model_view_matrix;");b.push("uniform mat4 u_projection_matrix;");b.push("uniform mat3 u_normal_matrix;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");
b.push("void main(void)");b.push("{");b.push("v_normal = normalize(u_normal_matrix * a_vertex_normal);");b.push("vec4 diffuse = vec4(u_light.diffuse_color, 1.0);");b.push("v_light_direction = u_light.direction;");b.push("v_ambient = vec4(u_material.ambient_color, 1.0);");b.push("v_diffuse = vec4(u_material.diffuse_color, 1.0) * diffuse;");b.push("gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);");b.push("}");var g=h.createShader(h.VERTEX_SHADER);h.shaderSource(g,
b.join(""));h.compileShader(g);if(!h.getShaderParameter(g,h.COMPILE_STATUS)){alert(h.getShaderInfoLog(g));return null}return g};this.loadDefaultFragmentShader=function(h){var b=[];b.push("#ifdef GL_ES\n");b.push("precision highp float;\n");b.push("#endif\n");b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");b.push("{");b.push("vec3 ambient_color;");b.push("vec3 diffuse_color;");
b.push("vec3 specular_color;");b.push("float shininess;");b.push("};");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");b.push("void main(void)");b.push("{");b.push("float nDotL = max(dot(v_normal, v_light_direction), 0.0);");b.push("vec4 color = vec4(v_diffuse.rgb*nDotL, v_diffuse.a);");b.push("float nDotHV = max(dot(v_normal, u_light.half_vector), 0.0);");
b.push("vec4 specular = vec4(u_material.specular_color * u_light.specular_color, 1.0);");b.push("color+=vec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);");b.push("gl_FragColor = color+v_ambient;");b.push("}");var g=h.createShader(h.FRAGMENT_SHADER);h.shaderSource(g,b.join(""));h.compileShader(g);if(!h.getShaderParameter(g,h.COMPILE_STATUS)){alert(h.getShaderInfoLog(g));return null}return g};return true}})(ChemDoodle.structures,document);
(function(c,a,h){c.Plate=function(b){this.lanes=Array(b);i=0;for(ii=b;i<ii;i++)this.lanes[i]=[];this.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(g,d){return g-d})};this.draw=function(g){var d=g.canvas.width,k=g.canvas.height;this.origin=9*k/10;this.front=k/10;this.laneLength=this.origin-this.front;g.strokeStyle="#000000";g.beginPath();g.moveTo(0,this.front);a.contextHashTo(g,0,this.front,d,this.front,3,3);g.closePath();g.stroke();g.beginPath();g.moveTo(0,this.origin);
g.lineTo(d,this.origin);g.closePath();g.stroke();i=0;for(ii=this.lanes.length;i<ii;i++){k=(i+1)*d/(ii+1);g.beginPath();g.moveTo(k,this.origin);g.lineTo(k,this.origin+3);g.closePath();g.stroke();s=0;for(ss=this.lanes[i].length;s<ss;s++){var e=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":g.beginPath();g.arc(k,e,3,0,2*h.PI,false);g.closePath();break;case "expanded":g.beginPath();g.arc(k,e,7,0,2*h.PI,false);g.closePath();break;case "trailing":break;case "widened":a.contextOval(g,
k-18,e-10,36,10);break;case "cresent":g.beginPath();g.arc(k,e,9,0,h.PI,true);g.closePath();break}switch(this.lanes[i][s].style){case "solid":g.fillStyle="#000000";g.fill();break;case "transparent":g.stroke();break;case "gradient":break}}}};return true};c.Plate.Spot=function(b,g,d){this.type=b;this.rf=g;this.style=d?d:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(c,a,h){c.default_backgroundColor="#FFFFFF";c.default_scale=1;c.default_rotateAngle=0;c.default_bondLength_2D=20;c.default_angstromsPerBondLength=1.25;c.default_lightDirection_3D=[-0.1,-0.1,-1];c.default_lightDiffuseColor_3D="#FFFFFF";c.default_lightSpecularColor_3D="#FFFFFF";c.default_projectionVerticalFieldOfView_3D=45;c.default_projectionWidthHeightRatio_3D=1;c.default_projectionFrontCulling_3D=0.1;c.default_projectionBackCulling_3D=1E4;c.default_atoms_display=true;c.default_atoms_color=
"#000000";c.default_atoms_font_size_2D=12;c.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"];c.default_atoms_font_bold_2D=false;c.default_atoms_font_italic_2D=false;c.default_atoms_circles_2D=false;c.default_atoms_circleDiameter_2D=10;c.default_atoms_circleBorderWidth_2D=1;c.default_atoms_useJMOLColors=false;c.default_atoms_resolution_3D=60;c.default_atoms_sphereDiameter_3D=0.8;c.default_atoms_useVDWDiameters_3D=false;c.default_atoms_vdwMultiplier_3D=1;c.default_atoms_materialAmbientColor_3D=
"#000000";c.default_atoms_materialSpecularColor_3D="#555555";c.default_atoms_materialShininess_3D=32;c.default_atoms_implicitHydrogens_2D=true;c.default_atoms_displayTerminalCarbonLabels_2D=false;c.default_atoms_showHiddenCarbons_2D=true;c.default_bonds_display=true;c.default_bonds_color="#000000";c.default_bonds_width_2D=1;c.default_bonds_saturationWidth_2D=0.2;c.default_bonds_ends_2D="round";c.default_bonds_useJMOLColors=false;c.default_bonds_saturationAngle_2D=h.PI/3;c.default_bonds_symmetrical_2D=
false;c.default_bonds_clearOverlaps_2D=false;c.default_bonds_overlapClearWidth_2D=0.5;c.default_bonds_atomLabelBuffer_2D=0.25;c.default_bonds_wedgeThickness_2D=0.22;c.default_bonds_hashWidth_2D=1;c.default_bonds_hashSpacing_2D=2.5;c.default_bonds_showBondOrders_3D=false;c.default_bonds_resolution_3D=60;c.default_bonds_cylinderDiameter_3D=0.3;c.default_bonds_materialAmbientColor_3D="#222222";c.default_bonds_materialSpecularColor_3D="#555555";c.default_bonds_materialShininess_3D=32;c.default_ribbons_display=
true;c.default_ribbons_cartoonize=false;c.default_ribbons_useShapelyColors=false;c.default_ribbons_useAminoColors=false;c.default_ribbons_frontColor="#FF0D0D";c.default_ribbons_backColor="#FFFF30";c.default_ribbons_cartoonHelixFrontColor="#00E740";c.default_ribbons_cartoonHelixBackColor="#9905FF";c.default_ribbons_cartoonSheetColor="#E8BB99";c.default_ribbons_materialAmbientColor_3D="#222222";c.default_ribbons_materialSpecularColor_3D="#555555";c.default_ribbons_materialShininess_3D=32;c.default_plots_color=
"#000000";c.default_plots_width=1;c.default_plots_showIntegration=false;c.default_plots_integrationColor="#c10000";c.default_plots_integrationLineWidth=1;c.default_plots_showGrid=false;c.default_plots_gridColor="gray";c.default_plots_gridLineWidth=0.5;c.default_plots_showYAxis=true;c.default_plots_flipXAxis=false;c.default_text_font_size=12;c.default_text_font_families=["Helvetica","Arial","Dialog"];c.default_text_color="#000000";a.VisualSpecifications=function(){this.backgroundColor=c.default_backgroundColor;
this.scale=c.default_scale;this.rotateAngle=c.default_rotateAngle;this.bondLength=c.default_bondLength_2D;this.angstromsPerBondLength=c.default_angstromsPerBondLength;this.lightDirection_3D=c.default_lightDirection_3D;this.lightDiffuseColor_3D=c.default_lightDiffuseColor_3D;this.lightSpecularColor_3D=c.default_lightSpecularColor_3D;this.projectionVerticalFieldOfView_3D=c.default_projectionVerticalFieldOfView_3D;this.projectionWidthHeightRatio_3D=c.default_projectionWidthHeightRatio_3D;this.projectionFrontCulling_3D=
c.default_projectionFrontCulling_3D;this.projectionBackCulling_3D=c.default_projectionBackCulling_3D;this.atoms_display=c.default_atoms_display;this.atoms_color=c.default_atoms_color;this.atoms_font_size_2D=c.default_atoms_font_size_2D;this.atoms_font_families_2D=[];for(var b=0,g=c.default_atoms_font_families_2D.length;b<g;b++)this.atoms_font_families_2D[b]=c.default_atoms_font_families_2D[b];this.atoms_font_bold_2D=c.default_atoms_font_bold_2D;this.atoms_font_italic_2D=c.default_atoms_font_italic_2D;
this.atoms_circles_2D=c.default_atoms_circles_2D;this.atoms_circleDiameter_2D=c.default_atoms_circleDiameter_2D;this.atoms_circleBorderWidth_2D=c.default_atoms_circleBorderWidth_2D;this.atoms_useJMOLColors=c.default_atoms_useJMOLColors;this.atoms_resolution_3D=c.default_atoms_resolution_3D;this.atoms_sphereDiameter_3D=c.default_atoms_sphereDiameter_3D;this.atoms_useVDWDiameters_3D=c.default_atoms_useVDWDiameters_3D;this.atoms_vdwMultiplier_3D=c.default_atoms_vdwMultiplier_3D;this.atoms_materialAmbientColor_3D=
c.default_atoms_materialAmbientColor_3D;this.atoms_materialSpecularColor_3D=c.default_atoms_materialSpecularColor_3D;this.atoms_materialShininess_3D=c.default_atoms_materialShininess_3D;this.atoms_implicitHydrogens_2D=c.default_atoms_implicitHydrogens_2D;this.atoms_displayTerminalCarbonLabels_2D=c.default_atoms_displayTerminalCarbonLabels_2D;this.atoms_showHiddenCarbons_2D=c.default_atoms_showHiddenCarbons_2D;this.bonds_display=c.default_bonds_display;this.bonds_color=c.default_bonds_color;this.bonds_width_2D=
c.default_bonds_width_2D;this.bonds_saturationWidth_2D=c.default_bonds_saturationWidth_2D;this.bonds_ends_2D=c.default_bonds_ends_2D;this.bonds_useJMOLColors=c.default_bonds_useJMOLColors;this.bonds_saturationAngle_2D=c.default_bonds_saturationAngle_2D;this.bonds_symmetrical_2D=c.default_bonds_symmetrical_2D;this.bonds_clearOverlaps_2D=c.default_bonds_clearOverlaps_2D;this.bonds_overlapClearWidth_2D=c.default_bonds_overlapClearWidth_2D;this.bonds_atomLabelBuffer_2D=c.default_bonds_atomLabelBuffer_2D;
this.bonds_wedgeThickness_2D=c.default_bonds_wedgeThickness_2D;this.bonds_hashWidth_2D=c.default_bonds_hashWidth_2D;this.bonds_hashSpacing_2D=c.default_bonds_hashSpacing_2D;this.bonds_showBondOrders_3D=c.default_bonds_showBondOrders_3D;this.bonds_resolution_3D=c.default_bonds_resolution_3D;this.bonds_cylinderDiameter_3D=c.default_bonds_cylinderDiameter_3D;this.bonds_materialAmbientColor_3D=c.default_bonds_materialAmbientColor_3D;this.bonds_materialSpecularColor_3D=c.default_bonds_materialSpecularColor_3D;
this.bonds_materialShininess_3D=c.default_bonds_materialShininess_3D;this.ribbons_display=c.default_ribbons_display;this.ribbons_cartoonize=c.default_ribbons_cartoonize;this.ribbons_useShapelyColors=c.default_ribbons_useShapelyColors;this.ribbons_useAminoColors=c.default_ribbons_useAminoColors;this.ribbons_frontColor=c.default_ribbons_frontColor;this.ribbons_backColor=c.default_ribbons_backColor;this.ribbons_cartoonHelixFrontColor=c.default_ribbons_cartoonHelixFrontColor;this.ribbons_cartoonHelixBackColor=
c.default_ribbons_cartoonHelixBackColor;this.ribbons_cartoonSheetColor=c.default_ribbons_cartoonSheetColor;this.ribbons_materialAmbientColor_3D=c.default_ribbons_materialAmbientColor_3D;this.ribbons_materialSpecularColor_3D=c.default_ribbons_materialSpecularColor_3D;this.ribbons_materialShininess_3D=c.default_ribbons_materialShininess_3D;this.plots_color=c.default_plots_color;this.plots_width=c.default_plots_width;this.plots_showIntegration=c.default_plots_showIntegration;this.plots_integrationColor=
c.default_plots_integrationColor;this.plots_integrationLineWidth=c.default_plots_integrationLineWidth;this.plots_showGrid=c.default_plots_showGrid;this.plots_gridColor=c.default_plots_gridColor;this.plots_gridLineWidth=c.default_plots_gridLineWidth;this.plots_showYAxis=c.default_plots_showYAxis;this.plots_flipXAxis=c.default_plots_flipXAxis;this.text_font_size=c.default_text_font_size;this.text_font_families=[];b=0;for(g=c.default_text_font_families.length;b<g;b++)this.text_font_families[b]=c.default_text_font_families[b];
this.text_color=c.default_text_color;this.set3DRepresentation=function(d){this.bonds_display=this.atoms_display=true;this.bonds_color="#777777";this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=true;if(d=="Ball and Stick"){this.atoms_vdwMultiplier_3D=0.3;this.bonds_useJMOLColors=false;this.bonds_cylinderDiameter_3D=0.3;this.bonds_materialAmbientColor_3D=c.default_atoms_materialAmbientColor_3D}else if(d=="van der Waals Spheres"){this.bonds_display=
false;this.atoms_vdwMultiplier_3D=1}else if(d=="Stick"){this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=false;this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=0.8;this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D}else if(d=="Wireframe"){this.atoms_useVDWDiameters_3D=false;this.bonds_cylinderDiameter_3D=0.05;this.atoms_sphereDiameter_3D=0.15;this.bonds_materialAmbientColor_3D=c.default_atoms_materialAmbientColor_3D}else alert('"'+d+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n')};
this.getFontString=function(d,k,e,j){var f=[];e&&f.push("bold ");j&&f.push("italic ");f.push(d+"px ");d=0;for(e=k.length;d<e;d++){j=k[d];if(j.indexOf(" ")!=-1)j='"'+j+'"';f.push((d!=0?",":"")+j)}return f.join("")}}})(ChemDoodle,ChemDoodle.structures,Math);
(function(c,a,h,b){h.getPointsPerAngstrom=function(){return c.default_bondLength_2D/c.default_angstromsPerBondLength};h.BondDeducer=function(){this.margin=1.1;this.deduceCovalentBonds=function(g,d){var k=h.getPointsPerAngstrom();if(d)k=d;for(var e=0,j=g.atoms.length;e<j;e++)for(var f=e+1;f<j;f++){var l=g.atoms[e],m=g.atoms[f];l.distance3D(m)<(a[l.label].covalentRadius+a[m.label].covalentRadius)*k*this.margin&&g.bonds.push(new b.Bond(l,m,1))}};return true}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,
ChemDoodle.structures);(function(c){c.HydrogenDeducer=function(){this.removeHydrogens=function(a){for(var h=[],b=[],g=0,d=a.bonds.length;g<d;g++)a.bonds[g].a1.label!="H"&&a.bonds[g].a2.label!="H"&&b.push(a.bonds[g]);g=0;for(d=a.atoms.length;g<d;g++)a.atoms[g].label!="H"&&h.push(a.atoms[g]);a.atoms=h;a.bonds=b};return true}})(ChemDoodle.informatics);
(function(c,a){c.StructureBuilder=function(){this.copy=function(h){for(var b=0,g=h.atoms.length;b<g;b++)h.atoms[b].metaID=b;var d=new a.Molecule;b=0;for(g=h.atoms.length;b<g;b++)d.atoms[b]=new a.Atom(h.atoms[b].label,h.atoms[b].x,h.atoms[b].y,h.atoms[b].z);b=0;for(g=h.bonds.length;b<g;b++)d.bonds[b]=new a.Bond(d.atoms[h.bonds[b].a1.metaID],d.atoms[h.bonds[b].a2.metaID],h.bonds[b].bondOrder);return d};return true}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(c){c._Counter=function(){this.value=0;this.molecule=null;this.setMolecule=function(a){this.value=0;this.molecule=a;this.innerCalculate&&this.innerCalculate()};return true}})(ChemDoodle.informatics);(function(c){c.FrerejacqueNumberCounter=function(a){this.setMolecule(a);return true};c.FrerejacqueNumberCounter.prototype=new c._Counter;c.FrerejacqueNumberCounter.prototype.innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new c.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(c,a){a.NumberOfMoleculesCounter=function(h){this.setMolecule(h);return true};a.NumberOfMoleculesCounter.prototype=new a._Counter;a.NumberOfMoleculesCounter.prototype.innerCalculate=function(){for(var h=0,b=this.molecule.atoms.length;h<b;h++)this.molecule.atoms[h].visited=false;h=0;for(b=this.molecule.atoms.length;h<b;h++)if(!this.molecule.atoms[h].visited){this.value++;var g=new c.Queue;this.molecule.atoms[h].visited=true;for(g.enqueue(this.molecule.atoms[h]);!g.isEmpty();)for(var d=g.dequeue(),
k=0,e=this.molecule.bonds.length;k<e;k++)if(this.molecule.bonds[k].contains(d)){var j=this.molecule.bonds[k].getNeighbor(d);if(!j.visited){j.visited=true;g.enqueue(j)}}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(c,a){c._RingFinder=function(){this.rings=this.bonds=this.atoms=null;this.reduce=function(h){for(var b=0,g=h.atoms.length;b<g;b++)h.atoms[b].visited=false;b=0;for(g=h.bonds.length;b<g;b++)h.bonds[b].visited=false;for(var d=true;d;){d=false;b=0;for(g=h.atoms.length;b<g;b++){for(var k=0,e=null,j=0,f=h.bonds.length;j<f;j++)if(h.bonds[j].contains(h.atoms[b])&&!h.bonds[j].visited){k++;if(k==2)break;e=h.bonds[j]}if(k==1){d=true;e.visited=true;h.atoms[b].visited=true}}}b=0;for(g=h.atoms.length;b<
g;b++)h.atoms[b].visited||this.atoms.push(h.atoms[b]);b=0;for(g=h.bonds.length;b<g;b++)h.bonds[b].visited||this.bonds.push(h.bonds[b]);if(this.bonds.length==0&&this.atoms.length!=0)this.atoms=[]};this.setMolecule=function(h){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(h);this.atoms.length>2&&this.innerGetRings&&this.innerGetRings()};this.fuse=function(){for(var h=0,b=this.rings.length;h<b;h++)for(var g=0,d=this.bonds.length;g<d;g++)a(this.bonds[g].a1,this.rings[h].atoms)!=-1&&a(this.bonds[g].a2,
this.rings[h].atoms)!=-1&&this.rings[h].bonds.push(this.bonds[g])};return true}})(ChemDoodle.informatics,jQuery.inArray);
(function(c,a,h){function b(g,d){this.atoms=[];if(d)for(var k=0,e=d.atoms.length;k<e;k++)this.atoms[k]=d.atoms[k];this.atoms.push(g);this.grow=function(j,f){for(var l=this.atoms[this.atoms.length-1],m=[],n=0,r=j.length;n<r;n++)if(j[n].contains(l)){var p=j[n].getNeighbor(l);h(p,f)==-1&&m.push(p)}l=[];n=0;for(r=m.length;n<r;n++)l.push(new b(m[n],this));return l};this.check=function(j,f,l){for(var m=0,n=f.atoms.length-1;m<n;m++)if(h(f.atoms[m],this.atoms)!=-1)return null;var r=null;if(f.atoms[f.atoms.length-
1]==this.atoms[this.atoms.length-1]){r=new a.Ring;r.atoms[0]=l;m=0;for(n=this.atoms.length;m<n;m++)r.atoms.push(this.atoms[m]);for(m=f.atoms.length-2;m>=0;m--)r.atoms.push(f.atoms[m])}else{var p=[];m=0;for(n=j.length;m<n;m++)j[m].contains(f.atoms[f.atoms.length-1])&&p.push(j[m]);m=0;for(n=p.length;m<n;m++)if((f.atoms.length==1||!p[m].contains(f.atoms[f.atoms.length-2]))&&p[m].contains(this.atoms[this.atoms.length-1])){r=new a.Ring;r.atoms[0]=l;j=0;for(l=this.atoms.length;j<l;j++)r.atoms.push(this.atoms[j]);
for(j=f.atoms.length-1;j>=0;j--)r.atoms.push(f.atoms[j]);break}}return r};return true}c.EulerFacetRingFinder=function(g){this.fingerBreak=5;this.setMolecule(g);return true};c.EulerFacetRingFinder.prototype=new c._RingFinder;c.EulerFacetRingFinder.prototype.innerGetRings=function(){for(var g=0,d=this.atoms.length;g<d;g++){for(var k=[],e=0,j=this.bonds.length;e<j;e++)this.bonds[e].contains(this.atoms[g])&&k.push(this.bonds[e].getNeighbor(this.atoms[g]));e=0;for(j=k.length;e<j;e++)for(var f=e+1;f<k.length;f++){var l=
[];l[0]=new b(k[e]);l[1]=new b(k[f]);var m=[];m[0]=this.atoms[g];for(var n=0,r=k.length;n<r;n++)n!=e&&n!=f&&m.push(k[n]);var p=[];if(n=l[0].check(this.bonds,l[1],this.atoms[g]))p[0]=n;for(;p.length==0&&l.length>0&&l[0].atoms.length<this.fingerBreak;){var u=[];n=0;for(r=l.length;n<r;n++)for(var q=l[n].grow(this.bonds,m),t=0,x=q.length;t<x;t++)u.push(q[t]);l=u;n=0;for(r=l.length;n<r;n++)for(t=n+1;t<r;t++)(x=l[n].check(this.bonds,l[t],this.atoms[g]))&&p.push(x);if(p.length==0){u=[];n=0;for(r=m.length;n<
r;n++){t=0;for(x=this.bonds.length;t<x;t++)if(this.bonds[t].contains(m[n])){k=this.bonds[t].getNeighbor(m[n]);h(k,m)==-1&&h(k,u)==-1&&u.push(k)}}n=0;for(r=u.length;n<r;n++)m.push(u[n])}}if(p.length>0){l=null;n=0;for(r=p.length;n<r;n++)if(!l||l.atoms.length>p[n].atoms.length)l=p[n];p=false;n=0;for(r=this.rings.length;n<r;n++){m=true;t=0;for(x=l.atoms.length;t<x;t++)if(h(l.atoms[t],this.rings[n].atoms)==-1){m=false;break}if(m){p=true;break}}p||this.rings.push(l)}}}this.fuse()}})(ChemDoodle.informatics,
ChemDoodle.structures,jQuery.inArray);
(function(c){c.SSSRFinder=function(a){this.rings=[];if(a.atoms.length>0){var h=(new c.FrerejacqueNumberCounter(a)).value,b=(new c.EulerFacetRingFinder(a)).rings;b.sort(function(j,f){return j.atoms.length-f.atoms.length});for(var g=0,d=a.bonds.length;g<d;g++)a.bonds[g].visited=false;g=0;for(d=b.length;g<d;g++){a=false;for(var k=0,e=b[g].bonds.length;k<e;k++)if(!b[g].bonds[k].visited){a=true;break}if(a){k=0;for(e=b[g].bonds.length;k<e;k++)b[g].bonds[k].visited=true;this.rings.push(b[g])}if(this.rings.length==
h)break}}return true}})(ChemDoodle.informatics);
(function(c,a,h,b,g){function d(e,j){for(var f=e.length,l="",m=0;m<j-f;m++)l+=" ";return l+e}h.MOLInterpreter=function(){this.read=function(e,j){var f=c.default_bondLength_2D;if(j)c.default_bondLength_2D=j;var l=new b.Molecule;if(e==null||e.length==0)return l;var m=e.split("\n"),n=m[3],r=parseInt(n.substring(0,3));n=parseInt(n.substring(3,6));for(var p=0;p<r;p++){var u=m[4+p];l.atoms[p]=new b.Atom(u.substring(31,34),parseFloat(u.substring(0,10))*c.default_bondLength_2D,-parseFloat(u.substring(10,
20))*c.default_bondLength_2D,parseFloat(u.substring(20,30))*c.default_bondLength_2D);var q=parseInt(u.substring(34,36));if(q!=0&&a[l.atoms[p].label]!=null)l.atoms[p].mass=a[l.atoms[p].label].mass+q;switch(parseInt(u.substring(36,39))){case 1:l.atoms[p].charge=3;break;case 2:l.atoms[p].charge=2;break;case 3:l.atoms[p].charge=1;break;case 5:l.atoms[p].charge=-1;break;case 6:l.atoms[p].charge=-2;break;case 7:l.atoms[p].charge=-3;break}}for(p=0;p<n;p++){u=m[4+r+p];var t=parseInt(u.substring(6,9));q=parseInt(u.substring(9,
12));if(t>3)switch(t){case 4:t=1.5;break;default:t=1;break}u=new b.Bond(l.atoms[parseInt(u.substring(0,3))-1],l.atoms[parseInt(u.substring(3,6))-1],t);switch(q){case 3:u.stereo=b.Bond.STEREO_AMBIGUOUS;break;case 1:u.stereo=b.Bond.STEREO_PROTRUDING;break;case 6:u.stereo=b.Bond.STEREO_RECESSED;break}l.bonds[p]=u}if(j)c.default_bondLength_2D=f;return l};this.write=function(e){var j="Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n";j=j+d(e.atoms.length.toString(),3)+d(e.bonds.length.toString(),
3)+"  0  0  0  0            999 v2000\n";for(var f=e.getCenter(),l=0,m=e.atoms.length;l<m;l++){var n=e.atoms[l],r=" 0";if(n.mass!=-1&&a[n.label]!=null){var p=n.mass-a[n.label].mass;if(p<5&&p>-4)r=(p>-1?" ":"")+p}p="  0";if(n.charge!=0)switch(n.charge){case 3:p="  1";break;case 2:p="  2";break;case 1:p="  3";break;case -1:p="  5";break;case -2:p="  6";break;case -3:p="  7";break}j=j+d(((n.x-f.x)/c.default_bondLength_2D).toFixed(4),10)+d((-(n.y-f.y)/c.default_bondLength_2D).toFixed(4),10)+d((n.z/c.default_bondLength_2D).toFixed(4),
10)+" "+d(n.label,3)+r+p+"  0  0  0  0\n"}l=0;for(m=e.bonds.length;l<m;l++){f=e.bonds[l];n=0;if(f.stereo==b.Bond.STEREO_AMBIGUOUS)n=3;else if(f.stereo==b.Bond.STEREO_PROTRUDING)n=1;else if(f.stereo==b.Bond.STEREO_RECESSED)n=6;j=j+d((g(f.a1,e.atoms)+1).toString(),3)+d((g(f.a2,e.atoms)+1).toString(),3)+d(f.bondOrder.toString(),3)+"  "+n+"     0  0\n"}j+="M  END";return j}};var k=new h.MOLInterpreter;c.readMOL=function(e,j){return k.read(e,j)};c.writeMOL=function(e){return k.write(e)}})(ChemDoodle,ChemDoodle.ELEMENT,
ChemDoodle.io,ChemDoodle.structures,jQuery.inArray);
(function(c,a,h,b,g){h.PDBInterpreter=function(){function k(e,j,f,l,m){for(var n=0,r=j.length;n<r;n++){var p=j[n];if(p.id==f&&l>=p.start&&l<=p.end){if(m)e.helix=true;else e.sheet=true;if(l+1==p.end)e.arrow=true;return}}}this.read=function(e,j){var f=new b.Molecule;f.chains=[];if(e==null||e.length==0)return f;var l=e.split("\n");j||(j=1);for(var m=[],n=[],r=null,p=null,u=null,q=[],t=0,x=l.length;t<x;t++){var v=l[t];if(a.stringStartsWith(v,"HELIX"))m.push({id:v.substring(19,20),start:parseInt(v.substring(21,
25)),end:parseInt(v.substring(33,37))});else if(a.stringStartsWith(v,"SHEET"))n.push({id:v.substring(21,22),start:parseInt(v.substring(22,26)),end:parseInt(v.substring(33,37))});else if(a.stringStartsWith(v,"ATOM")){var z=v.substring(16,17);if(z==" "||z=="A"){z=g(v.substring(76,78));if(z.length==0){var w=g(v.substring(12,14));if(w=="HD")z="H";else if(w.length>0)z=w.length>1?w.charAt(0)+w.substring(1).toLowerCase():w}z=new b.Atom(z,parseFloat(v.substring(30,38))*j,parseFloat(v.substring(38,46))*j,
parseFloat(v.substring(46,54))*j);z.resSeq=parseInt(v.substring(22,26));f.atoms.push(z);w=g(v.substring(12,16));if(w=="CA"||w=="C3'"){if(w=="C3'")r=z;if(q.length==0)for(w=0;w<2;w++){var B=new b.Residue(r);B.carbonylOxygen=z;q.push(B)}w=new b.Residue(z);w.name=g(v.substring(17,20));if(w.name.length==3)w.name=w.name.substring(0,1)+w.name.substring(1).toLowerCase();else if(w.name.length==2&&w.name.charAt(0)=="D")w.name=w.name.substring(1);if(u!=null&&u.resSeq==z.resSeq)w.carbonylOxygen=z;u=null;q.push(w);
v=v.substring(21,22);k(w,m,v,z.resSeq,true);k(w,n,v,z.resSeq,false)}else if(w=="O"||w=="C1'"){if(q.length>0){if(w=="C1'")p=z;if(q[q.length-1].alphaCarbon.resSeq==z.resSeq)q[q.length-1].carbonylOxygen=z;else u=z}}else if(w=="N"&&!r)r=z;else if(w=="C")p=z}}else if(a.stringStartsWith(v,"HETATM")){z=g(v.substring(76,78));if(z.length>1)z=z.substring(0,1)+z.substring(1).toLowerCase();f.atoms.push(new b.Atom(z,parseFloat(v.substring(30,38))*j,parseFloat(v.substring(38,46))*j,parseFloat(v.substring(46,54))*
j))}else if(a.stringStartsWith(v,"TER")){this.endChain(f,q,p);q=[];r=null}else if(a.stringStartsWith(v,"ENDMDL"))break}this.endChain(f,q,p);(new c.informatics.BondDeducer).deduceCovalentBonds(f,j);return f};this.endChain=function(e,j,f){if(j.length>0){if(!j[j.length-1].carbonylOxygen)j[j.length-1].carbonylOxygen=j[j.length-1];for(var l=0;l<4;l++){var m=new b.Residue(f);m.carbonylOxygen=j[j.length-1].carbonylOxygen;j.push(m)}e.chains.push(j)}}};var d=new h.PDBInterpreter;c.readPDB=function(k,e){return d.read(k,
e)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery.trim);
(function(c,a,h,b,g,d){var k={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},e={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},j={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};h.JCAMPInterpreter=function(){this.convertHZ2PPM=false;this.read=function(l){this.isBreak=function(J){return k[J]!=null||e[J]!=null||j[J]!=null||J==" "||J=="-"||J=="+"};this.getValue=function(J,V){var P=J.charAt(0),Q=J.substring(1);if(k[P]!=null)return parseFloat(k[P]+
Q);else if(e[P]!=null)return parseFloat(e[P]+Q)+V;return parseFloat(Q)};var m=new b.Spectrum;if(l==null||l.length==0)return m;l=l.split("\n");for(var n=[],r,p,u,q,t=1,x=1,v=1,z=-1,w=true,B=false,C=0,D=l.length;C<D;C++){var E=d(l[C]),A=g.inArray("$$",E);if(A!=-1)E=E.substring(0,A);if(n.length==0||!a.stringStartsWith(l[C],"##")){n.length!=0&&n.push("\n");n.push(d(E))}else{A=n.join("");w&&A.length<100&&m.metadata.push(A);n=[E];if(a.stringStartsWith(A,"##TITLE="))m.title=d(A.substring(8));else if(a.stringStartsWith(A,
"##XUNITS=")){m.xUnit=d(A.substring(9));if(this.convertHZ2PPM&&m.xUnit.toUpperCase()=="HZ"){m.xUnit="PPM";B=true}}else if(a.stringStartsWith(A,"##YUNITS="))m.yUnit=d(A.substring(9));else if(!a.stringStartsWith(A,"##XYPAIRS="))if(a.stringStartsWith(A,"##FIRSTX="))p=parseFloat(d(A.substring(9)));else if(a.stringStartsWith(A,"##LASTX="))r=parseFloat(d(A.substring(8)));else if(a.stringStartsWith(A,"##FIRSTY="))u=parseFloat(d(A.substring(9)));else if(a.stringStartsWith(A,"##NPOINTS="))q=parseFloat(d(A.substring(10)));
else if(a.stringStartsWith(A,"##XFACTOR="))t=parseFloat(d(A.substring(10)));else if(a.stringStartsWith(A,"##YFACTOR="))x=parseFloat(d(A.substring(10)));else if(a.stringStartsWith(A,"##DELTAX="))z=parseFloat(d(A.substring(9)));else if(a.stringStartsWith(A,"##.OBSERVE FREQUENCY=")){if(this.convertHZ2PPM)v=parseFloat(d(A.substring(21)))}else if(a.stringStartsWith(A,"##XYDATA=")){B||(v=1);E=w=false;A=A.split("\n");var L=(r-p)/(q-1);if(z!=-1)for(var I=1,M=A.length;I<M;I++)if(A[I].charAt(0)=="|"){L=z;break}var H=
p-L,F=u,K=0,S;I=1;for(M=A.length;I<M;I++){var N=[];H=d(A[I]);n=[];for(var T=false,G=0,O=H.length;G<O;G++)if(this.isBreak(H.charAt(G))){n.length>0&&!(n.length==1&&n[0]==" ")&&N.push(n.join(""));n=[H.charAt(G)]}else if(H.charAt(G)=="|")T=true;else n.push(H.charAt(G));N.push(n.join(""));H=parseFloat(N[0])*t-L;G=1;for(O=N.length;G<O;G++){F=N[G];if(j[F.charAt(0)]!=null)for(var W=parseInt(j[F.charAt(0)]+F.substring(1))-1,U=0;U<W;U++){H+=L;K=this.getValue(S,K);F=K*x;R++;m.data[m.data.length-1]=new b.Point(H/
v,F)}else if(k[F.charAt(0)]!=null&&E){F=this.getValue(F,K)*x;if(T){H+=L;m.data.push(new b.Point(H/v,F))}}else{E=e[F.charAt(0)]!=null;S=F;H+=L;K=this.getValue(F,K);F=K*x;R++;m.data.push(new b.Point(H/v,F))}}}}else if(a.stringStartsWith(A,"##PEAK TABLE=")){w=false;m.continuous=false;A=A.split("\n");var R=0;I=1;for(M=A.length;I<M;I++){E=A[I].split(/[\s,]+/);R+=E.length/2;G=0;for(O=E.length;G+1<O;G+=2)m.data.push(new b.Point(parseFloat(d(E[G])),parseFloat(d(E[G+1]))))}}}}m.setup();return m}};var f=new h.JCAMPInterpreter;
f.convertHZ2PPM=true;c.readJCAMP=function(l){return f.read(l)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim);
(function(c,a,h){c.fromJSONChains=function(b){for(var g=[],d=0,k=b.cs.length;d<k;d++){for(var e=b.cs[d],j=[],f=0,l=e.length;f<l;f++){var m=e[f],n=new a.Residue;n.name=m.n;n.alphaCarbon={x:m.x1,y:m.y1,z:m.z1};n.carbonylOxygen={x:m.x2,y:m.y2,z:m.z2};n.helix=m.h;n.sheet=m.s;n.arrow=m.a;j.push(n)}g.push(j)}return g};c.fromJSONDummy=function(b){for(var g=new a.Molecule,d=0,k=b.a.length;d<k;d++){var e=b.a[d],j=new a.Atom(e.l?e.l:"C",e.x,e.y);if(e.z)j.z=e.z;if(e.c)j.charge=e.c;if(e.m)j.mass=e.m;g.atoms.push(j)}d=
0;for(k=b.b.length;d<k;d++){e=b.b[d];j=new a.Bond(g.atoms[e.b],g.atoms[e.e],e.o?e.o:1);if(e.s)j.stereo=e.s;g.bonds.push(j)}return g};c.toJSONDummy=function(b){for(var g={a:[],b:[]},d=0,k=b.atoms.length;d<k;d++){var e=b.atoms[d];g.a[d]={x:e.x,y:e.y};if(e.label!="C")g.a[d].l=e.label;if(e.z!=0)g.a[d].z=e.z;if(e.charge!=0)g.a[d].c=e.charge;if(e.mass!=-1)g.a[d].m=e.mass}d=0;for(k=b.bonds.length;d<k;d++){e=b.bonds[d];g.b[d]={b:h(e.a1,b.atoms),e:h(e.a2,b.atoms)};if(e.bondOrder!=1)g.b[d].o=e.bondOrder;if(e.stereo!=
a.Bond.STEREO_NONE)g.b[d].s=e.stereo}return g}})(ChemDoodle.io,ChemDoodle.structures,jQuery.inArray);
ChemDoodle.monitor=function(c,a){var h={};h.CANVAS_DRAGGING=null;h.CANVAS_OVER=null;h.ALT=false;h.SHIFT=false;h.META=false;c(a).ready(function(){c(a).mousemove(function(b){if(h.CANVAS_DRAGGING!=null)if(h.CANVAS_DRAGGING.drag){h.CANVAS_DRAGGING.prehandleEvent(b);h.CANVAS_DRAGGING.drag(b)}});c(a).mouseup(function(b){if(h.CANVAS_DRAGGING!=null&&h.CANVAS_DRAGGING!=h.CANVAS_OVER)if(h.CANVAS_DRAGGING.mouseup){h.CANVAS_DRAGGING.prehandleEvent(b);h.CANVAS_DRAGGING.mouseup(b)}h.CANVAS_DRAGGING=null});c(a).keydown(function(b){h.SHIFT=
b.shiftKey;h.ALT=b.altKey;h.META=b.metaKey;var g=h.CANVAS_OVER;if(h.CANVAS_DRAGGING!=null)g=h.CANVAS_DRAGGING;if(g!=null)if(g.keydown){g.prehandleEvent(b);g.keydown(b)}});c(a).keypress(function(b){var g=h.CANVAS_OVER;if(h.CANVAS_DRAGGING!=null)g=h.CANVAS_DRAGGING;if(g!=null)if(g.keypress){g.prehandleEvent(b);g.keypress(b)}});c(a).keyup(function(b){h.SHIFT=b.shiftKey;h.ALT=b.altKey;h.META=b.metaKey;var g=h.CANVAS_OVER;if(h.CANVAS_DRAGGING!=null)g=h.CANVAS_DRAGGING;if(g!=null)if(g.keyup){g.prehandleEvent(b);
g.keyup(b)}})});return h}(jQuery,document);
(function(c,a,h,b,g,d,k){c._Canvas=function(){this.image=this.emptyMessage=this.molecule=null;return true};c._Canvas.prototype.repaint=function(){var e=k.getElementById(this.id);if(e.getContext){e=e.getContext("2d");if(this.image==null){if(this.specs.backgroundColor!=null){e.fillStyle=this.specs.backgroundColor;e.fillRect(0,0,this.width,this.height)}}else e.drawImage(this.image,0,0);if(this.molecule!=null&&this.molecule.atoms.length>0){e.save();e.translate(this.width/2,this.height/2);e.rotate(this.specs.rotateAngle);
e.scale(this.specs.scale,this.specs.scale);e.translate(-this.width/2,-this.height/2);this.molecule.draw(e,this.specs);e.restore()}else if(this.emptyMessage!=null){e.fillStyle="#737683";e.textAlign="center";e.textBaseline="middle";e.font="18px Helvetica, Verdana, Arial, Sans-serif";e.fillText(this.emptyMessage,this.width/2,this.height/2)}this.drawChildExtras&&this.drawChildExtras(e)}};c._Canvas.prototype.setBackgroundImage=function(e){this.image=new Image;var j=this;this.image.onload=function(){j.repaint()};
this.image.src=e};c._Canvas.prototype.loadMolecule=function(e){this.molecule=e;this.center();this.molecule.check();this.afterLoadMolecule&&this.afterLoadMolecule();this.repaint()};c._Canvas.prototype.center=function(){k.getElementById(this.id);var e=this.molecule.getCenter3D(),j=new h.Atom("C",this.width/2,this.height/2,0);j.sub3D(e);e=0;for(var f=this.molecule.atoms.length;e<f;e++)this.molecule.atoms[e].add3D(j);j=this.molecule.getDimension();this.specs.scale=1;if(j.x>this.width||j.y>this.height)this.specs.scale=
d.min(this.width/j.x,this.height/j.y)*0.85};c._Canvas.prototype.create=function(e,j,f){this.id=e;this.width=j;this.height=f;if(k.getElementById(e)){var l=b("#"+e);if(j)l.attr("width",j);else this.width=l.attr("width");if(f)l.attr("height",f);else this.height=l.attr("height")}else!c.featureDetection.supports_canvas_text()&&g.msie&&g.version>="6"?k.writeln('<div style="border: 1px solid black;" width="'+j+'" height="'+f+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>'):
k.writeln('<canvas class="ChemDoodleWebComponent" id="'+e+'" width="'+j+'" height="'+f+'">This browser does not support HTML5/Canvas.</canvas>');this.specs=new h.VisualSpecifications;var m=this;b("#"+e).bind("touchstart",function(n){var r=(new Date).getTime();if(m.lastTouch&&n.originalEvent.touches.length==1&&r-m.lastTouch<500)if(m.dbltap){m.prehandleEvent(n);m.dbltap(n)}else if(m.dblclick){m.prehandleEvent(n);m.dblclick(n)}else if(m.touchstart){m.prehandleEvent(n);m.touchstart(n)}else{if(m.mousedown){m.prehandleEvent(n);
m.mousedown(n)}}else if(m.touchstart){m.prehandleEvent(n);m.touchstart(n)}else if(m.mousedown){m.prehandleEvent(n);m.mousedown(n)}m.lastTouch=r});b("#"+e).bind("touchmove",function(n){if(n.originalEvent.touches.length>1&&m.multitouchmove){var r=n.originalEvent.touches.length;m.prehandleEvent(n);for(var p=new h.Point(-n.offset.left*r,-n.offset.top*r),u=0;u<r;u++){p.x+=n.originalEvent.changedTouches[u].pageX;p.y+=n.originalEvent.changedTouches[u].pageY}p.x/=r;p.y/=r;n.p=p;m.multitouchmove(n,r)}else if(m.touchmove){m.prehandleEvent(n);
m.touchmove(n)}else if(m.drag){m.prehandleEvent(n);m.drag(n)}});b("#"+e).bind("touchend",function(n){if(m.touchend){m.prehandleEvent(n);m.touchend(n)}else if(m.mouseup){m.prehandleEvent(n);m.mouseup(n)}});b("#"+e).bind("gesturestart",function(n){if(m.gesturestart){m.prehandleEvent(n);m.gesturestart(n)}});b("#"+e).bind("gesturechange",function(n){if(m.gesturechange){m.prehandleEvent(n);m.gesturechange(n)}});b("#"+e).bind("gestureend",function(n){if(m.gestureend){m.prehandleEvent(n);m.gestureend(n)}});
b("#"+e).click(function(n){switch(n.which){case 1:if(m.click){m.prehandleEvent(n);m.click(n)}break;case 2:if(m.middleclick){m.prehandleEvent(n);m.middleclick(n)}break;case 3:if(m.rightclick){m.prehandleEvent(n);m.rightclick(n)}break}});b("#"+e).dblclick(function(n){if(m.dblclick){m.prehandleEvent(n);m.dblclick(n)}});b("#"+e).mousedown(function(n){switch(n.which){case 1:a.CANVAS_DRAGGING=m;if(m.mousedown){m.prehandleEvent(n);m.mousedown(n)}break;case 2:if(m.middlemousedown){m.prehandleEvent(n);m.middlemousedown(n)}break;
case 3:if(m.rightmousedown){m.prehandleEvent(n);m.rightmousedown(n)}break}});b("#"+e).mousemove(function(n){if(a.CANVAS_DRAGGING==null&&m.mousemove){m.prehandleEvent(n);m.mousemove(n)}});b("#"+e).mouseout(function(n){a.CANVAS_OVER=null;if(m.mouseout){m.prehandleEvent(n);m.mouseout(n)}});b("#"+e).mouseover(function(n){a.CANVAS_OVER=m;if(m.mouseover){m.prehandleEvent(n);m.mouseover(n)}});b("#"+e).mouseup(function(n){switch(n.which){case 1:if(m.mouseup){m.prehandleEvent(n);m.mouseup(n)}break;case 2:if(m.middlemouseup){m.prehandleEvent(n);
m.middlemouseup(n)}break;case 3:if(m.rightmouseup){m.prehandleEvent(n);m.rightmouseup(n)}break}});b("#"+e).mousewheel(function(n,r){if(m.mousewheel){m.prehandleEvent(n);m.mousewheel(n,r)}});this.subCreate&&this.subCreate()};c._Canvas.prototype.getMolecule=function(){return this.molecule};c._Canvas.prototype.prehandleEvent=function(e){if(e.originalEvent.changedTouches){e.pageX=e.originalEvent.changedTouches[0].pageX;e.pageY=e.originalEvent.changedTouches[0].pageY}e.preventDefault();e.offset=b("#"+
this.id).offset();e.p=new h.Point(e.pageX-e.offset.left,e.pageY-e.offset.top)}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,jQuery,jQuery.browser,Math,document);
(function(c){c._AnimatorCanvas=function(a,h,b){a&&this.create(a,h,b);this.timeout=33;return true};c._AnimatorCanvas.prototype=new c._Canvas;c._AnimatorCanvas.prototype.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var a=this;if(this.nextFrame)this.handle=setInterval(function(){var h=(new Date).getTime();a.nextFrame(h-a.lastTime);a.repaint();a.lastTime=h},this.timeout)};c._AnimatorCanvas.prototype.stopAnimation=function(){if(this.handle!=null){clearInterval(this.handle);
this.handle=null}};c._AnimatorCanvas.prototype.isRunning=function(){return this.handle!=null}})(ChemDoodle);
(function(c,a){c.FileCanvas=function(h,b,g,d){h&&this.create(h,b,g);form='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+d+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+h+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+h+"', "+h+')"></iframe>';a.writeln(form);this.emptyMessage="Click below to load file";this.repaint();
return true};c.FileCanvas.prototype=new c._Canvas})(ChemDoodle,document);
(function(c){c.HyperlinkCanvas=function(a,h,b,g,d,k){a&&this.create(a,h,b);this.urlOrFunction=g;this.color=d?d:"blue";this.size=k?k:2;this.openInNewWindow=true;this.e=this.hoverImage=null;return true};c.HyperlinkCanvas.prototype=new c._Canvas;c.HyperlinkCanvas.prototype.drawChildExtras=function(a){if(this.e!=null)if(this.hoverImage==null){a.strokeStyle=this.color;a.lineWidth=this.size*2;a.strokeRect(0,0,this.width,this.height)}else a.drawImage(this.hoverImage,0,0)};c.HyperlinkCanvas.prototype.setHoverImage=
function(a){this.hoverImage=new Image;this.hoverImage.src=a};c.HyperlinkCanvas.prototype.click=function(){this.e=null;this.repaint();if(this.urlOrFunction instanceof Function)this.urlOrFunction();else if(this.openInNewWindow)window.open(this.urlOrFunction);else location.href=this.urlOrFunction};c.HyperlinkCanvas.prototype.mouseout=function(){this.e=null;this.repaint()};c.HyperlinkCanvas.prototype.mouseover=function(a){this.e=a;this.repaint()}})(ChemDoodle);
(function(c,a,h,b){c.MolGrabberCanvas=function(g,d,k){g&&this.create(g,d,k);d=[];d.push('<br><input type="text" id="');d.push(g);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(g);d.push('_select">');d.push('<option value="chemexper">ChemExper');d.push('<option value="chemspider">ChemSpider');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button id="');d.push(g);d.push('_submit">Show Molecule</button>');d.push("</nobr>");
b.writeln(d.join(""));var e=this;h("#"+g+"_submit").click(function(){e.search()});h("#"+g+"_query").keypress(function(j){j.which==13&&e.search()});this.emptyMessage="Enter search term below";this.repaint();return true};c.MolGrabberCanvas.prototype=new c._Canvas;c.MolGrabberCanvas.prototype.setSearchTerm=function(g){h("#"+this.id+"_query").val(g);this.search()};c.MolGrabberCanvas.prototype.search=function(){this.emptyMessage="Searching...";this.molecule=null;this.repaint();var g=this;a.getMoleculeFromDatabase(h("#"+
this.id+"_select").val(),h("#"+this.id+"_query").val(),function(d){g.loadMolecule(d)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(c,a,h){c.RotatorCanvas=function(b,g,d,k){b&&this.create(b,g,d);this.rotate3D=k;this.zIncrement=this.yIncrement=this.xIncrement=b=a.PI/15;return true};c.RotatorCanvas.prototype=new c._AnimatorCanvas;c.RotatorCanvas.prototype.nextFrame=function(b){if(this.molecule==null)this.stopAnimation();else{var g=b/1E3;if(this.rotate3D){b=[];h.identity(b);h.rotate(b,this.xIncrement*g,[1,0,0]);h.rotate(b,this.yIncrement*g,[0,1,0]);h.rotate(b,this.zIncrement*g,[0,0,1]);g=0;for(var d=this.molecule.atoms.length;g<
d;g++){var k=this.molecule.atoms[g],e=[k.x-this.width/2,k.y-this.height/2,k.z];h.multiplyVec3(b,e);k.x=e[0]+this.width/2;k.y=e[1]+this.height/2;k.z=e[2]}g=0;for(d=this.molecule.rings.length;g<d;g++)this.molecule.rings[g].center=this.molecule.rings[g].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else this.specs.rotateAngle+=this.zIncrement*g}};c.RotatorCanvas.prototype.dblclick=
function(){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,mat4);
(function(c){c.SlideshowCanvas=function(a,h,b){a&&this.create(a,h,b);this.molecules=[];this.curIndex=0;this.timeout=5E3;this.alpha=0;this.innerHandle=null;this.phase=0;return true};c.SlideshowCanvas.prototype=new c._AnimatorCanvas;c.SlideshowCanvas.prototype.drawChildExtras=function(a){a.fillStyle="rgba("+parseInt(this.specs.backgroundColor.substring(1,3),16)+", "+parseInt(this.specs.backgroundColor.substring(3,5),16)+", "+parseInt(this.specs.backgroundColor.substring(5,7),16)+", "+this.alpha+")";
a.fillRect(0,0,this.width,this.height)};c.SlideshowCanvas.prototype.nextFrame=function(){if(this.molecules.length==0)this.stopAnimation();else{this.phase=0;var a=this,h=1;this.innerHandle=setInterval(function(){a.alpha=h/15;a.repaint();h==15&&a.breakInnerHandle();h++},33)}};c.SlideshowCanvas.prototype.breakInnerHandle=function(){if(this.innerHandle!=null){clearInterval(this.innerHandle);this.innerHandle=null}if(this.phase==0){this.curIndex++;if(this.curIndex>this.molecules.length-1)this.curIndex=
0;this.alpha=1;this.loadMolecule(this.molecules[this.curIndex]);this.phase=1;var a=this,h=1;this.innerHandle=setInterval(function(){a.alpha=(15-h)/15;a.repaint();h==15&&a.breakInnerHandle();h++},33)}else if(this.phase==1){this.alpha=0;this.repaint()}};c.SlideshowCanvas.prototype.addMolecule=function(a){this.molecules.length==0&&this.loadMolecule(a);this.molecules.push(a)}})(ChemDoodle);
(function(c,a,h,b,g){c.TransformCanvas=function(d,k,e,j){d&&this.create(d,k,e);this.lastPoint=null;this.rotate3D=j;this.rotationMultMod=1.3;this.lastPinchScale=1;this.lastGestureRotate=0;return true};c.TransformCanvas.prototype=new c._Canvas;c.TransformCanvas.prototype.mousedown=function(d){this.lastPoint=d.p};c.TransformCanvas.prototype.dblclick=function(){var d=new h.Point(this.width/2,this.height/2);d.sub(this.molecule.getCenter());for(var k=0,e=this.molecule.atoms.length;k<e;k++)this.molecule.atoms[k].add(d);
this.molecule.check();this.repaint()};c.TransformCanvas.prototype.drag=function(d){if(!this.lastPoint.multi){if(a.ALT){var k=new h.Point(d.p.x,d.p.y);k.sub(this.lastPoint);for(var e=0,j=this.molecule.atoms.length;e<j;e++)this.molecule.atoms[e].add(k);this.lastPoint=d.p;this.molecule.check()}else if(this.rotate3D==true){k=b.max(this.width/4,this.height/4);e=(d.p.x-this.lastPoint.x)/k*this.rotationMultMod;j=-(d.p.y-this.lastPoint.y)/k*this.rotationMultMod;k=[];g.identity(k);g.rotate(k,j,[1,0,0]);g.rotate(k,
e,[0,1,0]);e=0;for(j=this.molecule.atoms.length;e<j;e++){var f=this.molecule.atoms[e],l=[f.x-this.width/2,f.y-this.height/2,f.z];g.multiplyVec3(k,l);f.x=l[0]+this.width/2;f.y=l[1]+this.height/2;f.z=l[2]}e=0;for(j=this.molecule.rings.length;e<j;e++)this.molecule.rings[e].center=this.molecule.rings[e].getCenter();this.lastPoint=d.p;this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else{k=
new h.Point(this.width/2,this.height/2);e=k.angle(this.lastPoint);this.specs.rotateAngle-=k.angle(d.p)-e;this.lastPoint=d.p}this.repaint()}};c.TransformCanvas.prototype.mousewheel=function(d,k){this.specs.scale+=k/10;if(this.specs.scale<0.01)this.specs.scale=0.01;this.repaint()};c.TransformCanvas.prototype.multitouchmove=function(d,k){if(k==2)if(this.lastPoint.multi){var e=new h.Point(d.p.x,d.p.y);e.sub(this.lastPoint);for(var j=0,f=this.molecule.atoms.length;j<f;j++)this.molecule.atoms[j].add(e);
this.lastPoint=d.p;this.lastPoint.multi=true;this.molecule.check();this.repaint()}else{this.lastPoint=d.p;this.lastPoint.multi=true}};c.TransformCanvas.prototype.gesturechange=function(d){if(d.originalEvent.scale-this.lastPinchScale!=0){this.specs.scale*=d.originalEvent.scale/this.lastPinchScale;if(this.specs.scale<0.01)this.specs.scale=0.01;this.lastPinchScale=d.originalEvent.scale}if(this.lastGestureRotate-d.originalEvent.rotation!=0){for(var k=(this.lastGestureRotate-d.originalEvent.rotation)/
180*b.PI,e=new h.Point(this.width/2,this.height/2),j=0,f=this.molecule.atoms.length;j<f;j++){var l=e.distance(this.molecule.atoms[j]),m=e.angle(this.molecule.atoms[j])+k;this.molecule.atoms[j].x=e.x+l*b.cos(m);this.molecule.atoms[j].y=e.y-l*b.sin(m)}this.lastGestureRotate=d.originalEvent.rotation;this.molecule.check()}this.repaint()};c.TransformCanvas.prototype.gestureend=function(){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,mat4);
(function(c){c.ViewerCanvas=function(a,h,b){a&&this.create(a,h,b);return true};c.ViewerCanvas.prototype=new c._Canvas})(ChemDoodle);
(function(c,a){c._SpectrumCanvas=function(h,b,g){h&&this.create(h,b,g);this.spectrum=null;this.emptyMessage="No Spectrum Loaded or Recognized";this.getMolecule=this.loadMolecule=null;return true};c._SpectrumCanvas.prototype=new c._Canvas;c._SpectrumCanvas.prototype.repaint=function(){var h=a.getElementById(this.id);if(h.getContext){h=h.getContext("2d");if(this.image==null){if(this.specs.backgroundColor!=null){h.fillStyle=this.specs.backgroundColor;h.fillRect(0,0,this.width,this.height)}}else h.drawImage(this.image,
0,0);if(this.spectrum!=null&&this.spectrum.data.length>0)this.spectrum.draw(h,this.specs,this.width,this.height);else if(this.emptyMessage!=null){h.fillStyle="#737683";h.textAlign="center";h.textBaseline="middle";h.font="18px Helvetica, Verdana, Arial, Sans-serif";h.fillText(this.emptyMessage,this.width/2,this.height/2)}this.drawChildExtras&&this.drawChildExtras(h)}};c._SpectrumCanvas.prototype.loadSpectrum=function(h){this.spectrum=h;this.repaint()};c._SpectrumCanvas.prototype.getSpectrum=function(){return this.spectrum}})(ChemDoodle,
document);(function(c){c.ObserverCanvas=function(a,h,b){a&&this.create(a,h,b);return true};c.ObserverCanvas.prototype=new c._SpectrumCanvas})(ChemDoodle);
(function(c,a,h){c.PerspectiveCanvas=function(b,g,d){b&&this.create(b,g,d);this.dragRange=null;this.rescaleYAxisOnZoom=true;this.lastPinchScale=1;return true};c.PerspectiveCanvas.prototype=new c._SpectrumCanvas;c.PerspectiveCanvas.prototype.mousedown=function(b){this.dragRange=new c.structures.Point(b.p.x,b.p.x)};c.PerspectiveCanvas.prototype.mouseup=function(b){if(this.dragRange!=null&&this.dragRange.x!=this.dragRange.y){if(!this.dragRange.multi){b=this.spectrum.zoom(this.dragRange.x,b.p.x,this.width,
this.rescaleYAxisOnZoom);if(this.rescaleYAxisOnZoom)this.specs.scale=b}this.dragRange=null;this.repaint()}};c.PerspectiveCanvas.prototype.drag=function(b){if(this.dragRange!=null){if(this.dragRange.multi)this.dragRange=null;else{if(a.SHIFT){this.spectrum.translate(b.p.x-this.dragRange.x,this.width);this.dragRange.x=b.p.x}this.dragRange.y=b.p.x}this.repaint()}};c.PerspectiveCanvas.prototype.drawChildExtras=function(b){if(this.dragRange!=null){var g=h.min(this.dragRange.x,this.dragRange.y),d=h.max(this.dragRange.x,
this.dragRange.y);b.strokeStyle="gray";b.lineStyle=1;b.beginPath();b.moveTo(g,this.height/2);for(g=g;g<=d;g++)g%10<5?b.lineTo(g,h.round(this.height/2)):b.moveTo(g,h.round(this.height/2));b.stroke()}};c.PerspectiveCanvas.prototype.mousewheel=function(b,g){this.specs.scale+=g/10;if(this.specs.scale<0.01)this.specs.scale=0.01;this.repaint()};c.PerspectiveCanvas.prototype.dblclick=function(){this.spectrum.setup();this.specs.scale=1;this.repaint()};c.PerspectiveCanvas.prototype.multitouchmove=function(b,
g){if(g==2)if(this.dragRange==null||!this.dragRange.multi){this.dragRange=new c.structures.Point(b.p.x,b.p.x);this.dragRange.multi=true}else{this.spectrum.translate(b.p.x-this.dragRange.x,this.width);this.dragRange.x=b.p.x;this.dragRange.y=b.p.x;this.repaint()}};c.PerspectiveCanvas.prototype.gesturechange=function(b){this.specs.scale*=b.originalEvent.scale/this.lastPinchScale;if(this.specs.scale<0.01)this.specs.scale=0.01;this.lastPinchScale=b.originalEvent.scale;this.repaint()};c.PerspectiveCanvas.prototype.gestureend=
function(){this.lastPinchScale=1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(c,a,h,b,g,d,k,e,j){c._Canvas3D=function(f,l,m){f&&this.create(f,l,m);this.rotationMatrix=k.identity([]);this.translationMatrix=k.identity([]);this.lastPoint=null;this.emptyMessage="WebGL is Unavailable!";return true};c._Canvas3D.prototype=new c._Canvas;c._Canvas3D.prototype.afterLoadMolecule=function(){var f=this.molecule.getDimension();this.translationMatrix=k.translate(k.identity([]),[0,0,-g.max(f.x,f.y)-10]);this.setupScene()};c._Canvas3D.prototype.setViewDistance=function(f){this.translationMatrix=
k.translate(k.identity([]),[0,0,-f])};c._Canvas3D.prototype.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.modelViewMatrix=k.multiply(this.translationMatrix,this.rotationMatrix,[]);this.gl.rotationMatrix=this.rotationMatrix;this.molecule!=null&&this.molecule.render(this.gl,this.specs);this.gl.flush()}};c._Canvas3D.prototype.center=function(){d.getElementById(this.id);var f=this.molecule.getCenter3D(),l=new b.Atom("C",0,0,0);l.sub3D(f);f=0;for(var m=
this.molecule.atoms.length;f<m;f++)this.molecule.atoms[f].add3D(l)};c._Canvas3D.prototype.subCreate=function(){try{this.gl=d.getElementById(this.id).getContext("webgl");if(!this.gl)this.gl=d.getElementById(this.id).getContext("experimental-webgl")}catch(f){}if(this.gl){this.gl.viewport(0,0,this.width,this.height);this.gl.program=this.gl.createProgram();this.gl.shader=new b.Shader;this.gl.shader.init(this.gl);this.setupScene()}else{this.molecule=null;this.displayMessage()}};c._Canvas.prototype.displayMessage=
function(){var f=d.getElementById(this.id);if(f.getContext){f=f.getContext("2d");if(this.specs.backgroundColor!=null){f.fillStyle=this.specs.backgroundColor;f.fillRect(0,0,this.width,this.height)}if(this.emptyMessage!=null){f.fillStyle="#737683";f.textAlign="center";f.textBaseline="middle";f.font="18px Helvetica, Verdana, Arial, Sans-serif";f.fillText(this.emptyMessage,this.width/2,this.height/2)}}};c._Canvas3D.prototype.setupScene=function(){if(this.gl){var f=h.getRGB(this.specs.backgroundColor,
1);this.gl.clearColor(f[0],f[1],f[2],1);this.gl.clearDepth(1);this.gl.enable(this.gl.DEPTH_TEST);this.gl.depthFunc(this.gl.LEQUAL);this.gl.sphereBuffer=new b.Sphere(this.gl,1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D);this.gl.cylinderBuffer=new b.Cylinder(this.gl,1,1,this.specs.bonds_resolution_3D);if(this.molecule&&this.molecule.chains){this.molecule.ribbons=[];this.molecule.cartoons=[];f=0;for(var l=this.molecule.chains.length;f<l;f++){var m=this.molecule.chains[f];if(m.length>
0&&!m[0].lineSegments){for(var n=0,r=m.length-1;n<r;n++)m[n].setup(m[n+1].alphaCarbon);n=1;for(r=m.length-1;n<r;n++)if(a.vec3AngleFrom(m[n-1].D,m[n].D)>g.PI/2){m[n].guidePointsSmall.reverse();m[n].guidePointsLarge.reverse();j.scale(m[n].D,-1)}n=1;for(r=m.length-3;n<r;n++)m[n].computeLineSegments(m[n-1],m[n+1],m[n+2]);m.pop();m.pop();m.pop();m.shift()}this.molecule.ribbons.push({front:new b.Ribbon(this.gl,m,0.02,false),back:new b.Ribbon(this.gl,m,-0.02,false)});this.molecule.cartoons.push({front:new b.Ribbon(this.gl,
m,0.02,true),back:new b.Ribbon(this.gl,m,-0.02,true)})}}this.gl.lighting=new b.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D);this.gl.lighting.lightScene(this.gl);this.gl.material=new b.Material(this.gl);this.gl.projectionMatrix=k.perspective(this.specs.projectionVerticalFieldOfView_3D,this.specs.projectionWidthHeightRatio_3D,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.gl.program,
"u_projection_matrix"),false,this.gl.projectionMatrix);var p=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),u=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(q){this.uniformMatrix4fv(p,false,q);q=e.transpose(k.toInverseMat3(q,[]));this.uniformMatrix3fv(u,false,q)}}};c._Canvas3D.prototype.mousedown=function(f){this.lastPoint=f.p};c._Canvas3D.prototype.rightmousedown=function(f){this.lastPoint=f.p};c._Canvas3D.prototype.drag=function(f){if(c.monitor.ALT){var l=
new b.Point(f.p.x,f.p.y);l.sub(this.lastPoint);k.translate(this.translationMatrix,[l.x/20,-l.y/20,0])}else{g.max(this.width/4,this.height/4);var m=f.p.x-this.lastPoint.x;l=f.p.y-this.lastPoint.y;m=k.rotate(k.identity([]),m*g.PI/180,[0,1,0]);k.rotate(m,l*g.PI/180,[1,0,0]);this.rotationMatrix=k.multiply(m,this.rotationMatrix)}this.lastPoint=f.p;this.repaint()};c._Canvas3D.prototype.mousewheel=function(f,l){k.translate(this.translationMatrix,[0,0,l*2]);this.repaint()}})(ChemDoodle,ChemDoodle.extensions,
ChemDoodle.math,ChemDoodle.structures,Math,document,mat4,mat3,vec3);
(function(c,a,h,b){c.MolGrabberCanvas3D=function(g,d,k){g&&this.create(g,d,k);d=[];d.push('<br><input type="text" id="');d.push(g);d.push('_query" size="32" value="" />');d.push("<br><nobr>");d.push('<select id="');d.push(g);d.push('_select">');d.push('<option value="pubchem" selected>PubChem');d.push("</select>");d.push('<button id="');d.push(g);d.push('_submit">Show Molecule</button>');d.push("</nobr>");b.writeln(d.join(""));var e=this;h("#"+g+"_submit").click(function(){e.search()});h("#"+g+"_query").keypress(function(j){j.which==
13&&e.search()});return true};c.MolGrabberCanvas3D.prototype=new c._Canvas3D;c.MolGrabberCanvas3D.prototype.setSearchTerm=function(g){h("#"+this.id+"_query").val(g);this.search()};c.MolGrabberCanvas3D.prototype.search=function(){var g=this;a.getMoleculeFromDatabase(h("#"+this.id+"_select").val(),h("#"+this.id+"_query").val(),function(d){g.loadMolecule(d)},3)}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(c,a,h){c.RotatorCanvas3D=function(b,g,d){b&&this.create(b,g,d);this.timeout=33;this.zIncrement=this.yIncrement=this.xIncrement=b=a.PI/15;return true};c.RotatorCanvas3D.prototype=new c._Canvas3D;c.RotatorCanvas3D.prototype.startAnimation=c._AnimatorCanvas.prototype.startAnimation;c.RotatorCanvas3D.prototype.stopAnimation=c._AnimatorCanvas.prototype.stopAnimation;c.RotatorCanvas3D.prototype.isRunning=c._AnimatorCanvas.prototype.isRunning;c.RotatorCanvas3D.prototype.dblclick=c.RotatorCanvas.prototype.dblclick;
c.RotatorCanvas3D.prototype.mousedown=null;c.RotatorCanvas3D.prototype.rightmousedown=null;c.RotatorCanvas3D.prototype.drag=null;c.RotatorCanvas3D.prototype.mousewheel=null;c.RotatorCanvas3D.prototype.nextFrame=function(b){if(this.molecule==null)this.stopAnimation();else{var g=[];h.identity(g);b=b/1E3;h.rotate(g,this.xIncrement*b,[1,0,0]);h.rotate(g,this.yIncrement*b,[0,1,0]);h.rotate(g,this.zIncrement*b,[0,0,1]);h.multiply(this.rotationMatrix,g)}}})(ChemDoodle,Math,mat4);
(function(c){c.TransformCanvas3D=function(a,h,b){a&&this.create(a,h,b);return true};c.TransformCanvas3D.prototype=new c._Canvas3D})(ChemDoodle);(function(c){c.ViewerCanvas3D=function(a,h,b){a&&this.create(a,h,b);return true};c.ViewerCanvas3D.prototype=new c._Canvas3D;c.ViewerCanvas3D.prototype.mousedown=null;c.ViewerCanvas3D.prototype.rightmousedown=null;c.ViewerCanvas3D.prototype.drag=null;c.ViewerCanvas3D.prototype.mousewheel=null})(ChemDoodle);
(function(c,a,h,b){function g(d,k,e,j){this.element=d;this.x=k;this.y=e;this.dimension=j}c.PeriodicTableCanvas=function(d,k){this.padding=5;d&&this.create(d,k*18+this.padding*2,k*10+this.padding*2);this.getMolecule=this.loadMolecule=null;this.cellDimension=k?k:20;this.setupTable();this.repaint();return true};c.PeriodicTableCanvas.prototype=new c._Canvas;c.PeriodicTableCanvas.prototype.getHoveredElement=function(){if(this.hovered!=null)return this.hovered.element;return null};c.PeriodicTableCanvas.prototype.repaint=
function(){var d=b.getElementById(this.id);if(d.getContext){d=d.getContext("2d");if(this.image==null){if(this.specs.backgroundColor!=null){d.fillStyle=this.specs.backgroundColor;d.fillRect(0,0,this.width,this.height)}}else d.drawImage(this.image,0,0);for(var k=0,e=this.cells.length;k<e;k++)this.drawCell(d,this.specs,this.cells[k]);this.hovered!=null&&this.drawCell(d,this.specs,this.hovered);this.selected!=null&&this.drawCell(d,this.specs,this.selected);this.drawChildExtras&&this.drawChildExtras(d)}};
c.PeriodicTableCanvas.prototype.setupTable=function(){this.cells=[];for(var d=y=this.padding,k=0,e=0,j=c.SYMBOLS.length;e<j;e++){if(k==18){k=0;y+=this.cellDimension;d=this.padding}var f=c.ELEMENT[c.SYMBOLS[e]];if(f.atomicNumber==2){d+=16*this.cellDimension;k+=16}else if(f.atomicNumber==5||f.atomicNumber==13){d+=10*this.cellDimension;k+=10}if((f.atomicNumber<58||f.atomicNumber>71&&f.atomicNumber<90||f.atomicNumber>103)&&f.atomicNumber<113){this.cells.push(new g(f,d,y,this.cellDimension));d+=this.cellDimension;
k++}}y+=2*this.cellDimension;d=3*this.cellDimension+this.padding;for(e=57;e<104;e++){f=c.ELEMENT[c.SYMBOLS[e]];if(f.atomicNumber==90){y+=this.cellDimension;d=3*this.cellDimension+this.padding}if(f.atomicNumber>=58&&f.atomicNumber<=71||f.atomicNumber>=90&&f.atomicNumber<=103){this.cells.push(new g(f,d,y,this.cellDimension));d+=this.cellDimension}}};c.PeriodicTableCanvas.prototype.drawCell=function(d,k,e){var j=d.createRadialGradient(e.x+e.dimension/3,e.y+e.dimension/3,e.dimension*1.5,e.x+e.dimension/
3,e.y+e.dimension/3,e.dimension/10);j.addColorStop(0,"#000000");j.addColorStop(0.7,e.element.jmolColor);j.addColorStop(1,"#FFFFFF");d.fillStyle=j;a.contextRoundRect(d,e.x,e.y,e.dimension,e.dimension,e.dimension/8);if(e==this.hovered||e==this.selected){d.lineWidth=2;d.strokeStyle="#c10000";d.stroke();d.fillStyle="white"}d.fill();d.font=k.getFontString(k.text_font_size,k.text_font_families);d.fillStyle=k.text_color;d.textAlign="center";d.textBaseline="middle";d.fillText(e.element.symbol,e.x+e.dimension/
2,e.y+e.dimension/2)};c.PeriodicTableCanvas.prototype.click=function(){if(this.hovered!=null){this.selected=this.hovered;this.repaint()}};c.PeriodicTableCanvas.prototype.mousemove=function(d){var k=d.p.x;d=d.p.y;this.hovered=null;for(var e=0,j=this.cells.length;e<j;e++){var f=this.cells[e];if(h.isBetween(k,f.x,f.x+f.dimension)&&h.isBetween(d,f.y,f.y+f.dimension)){this.hovered=f;break}}this.repaint()};c.PeriodicTableCanvas.prototype.mouseout=function(){this.hovered=null;this.repaint()}})(ChemDoodle,
ChemDoodle.extensions,ChemDoodle.math,document);(function(c,a){c._Layout=function(){return true};c._Layout.prototype.layout=function(){this.innerLayout&&this.innerLayout()};c._Layout.prototype.create=function(h){this.name=h;this.specs=new a.VisualSpecifications}})(ChemDoodle,ChemDoodle.structures);
(function(c,a,h){c.SimpleReactionLayout=function(b){this.reactants=[];this.products=[];this.textBelow=this.textAbove=null;this.arrow="&rarr;";this.plus="+";this.create(b);return true};c.SimpleReactionLayout.prototype=new c._Layout;c.SimpleReactionLayout.prototype.addReactant=function(b){this.reactants.push(b)};c.SimpleReactionLayout.prototype.addProduct=function(b){this.products.push(b)};c.SimpleReactionLayout.prototype.innerLayout=function(){h.writeln("<table><tr>");for(var b=0,g=this.reactants.length;b<
g;b++){b>0&&h.writeln('<td><span style="font-size:25px;">'+this.plus+"</span></td>");h.writeln("<td>");var d=this.reactants[b].getDimension();d=new c.ViewerCanvas(this.name+"_reactant"+b,d.x+60,d.y+60);this.specs.backgroundColor==null&&a("#"+this.name+"_reactant"+b).css("border","0px");d.specs=this.specs;d.loadMolecule(this.reactants[b]);h.writeln("</td>")}h.writeln("<td>");h.writeln("<table>");h.writeln("<tr><td>");this.textAbove!=null?h.writeln("<center>"+this.textAbove+"</center>"):h.writeln("&nbsp;");
h.writeln("</td></tr>");h.writeln('<tr><td><center><span style="font-size:25px;">'+this.arrow+"</span></center></td></tr>");h.writeln("<tr><td>");this.textBelow!=null?h.writeln("<center>"+this.textBelow+"</center>"):h.writeln("&nbsp;");h.writeln("</td></tr>");h.writeln("</table>");h.writeln("</td>");b=0;for(g=this.products.length;b<g;b++){b>0&&h.writeln('<td><span style="font-size:25px;">'+this.plus+"</td>");h.writeln("<td>");d=this.products[b].getDimension();d=new c.ViewerCanvas(this.name+"_product"+
b,d.x+60,d.y+60);this.specs.backgroundColor==null&&a("#"+this.name+"_product"+b).css("border","0px");d.specs=this.specs;d.loadMolecule(this.products[b]);h.writeln("</td>")}h.writeln("</tr></table>")}})(ChemDoodle,jQuery,document);(function(c,a,h){c.png={};c.png.create=function(b){h.open(a.getElementById(b.id).toDataURL("image/png"))}})(ChemDoodle.io,document,window);
